;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	0D1411EC843C9060DAA94317B0EDBDC6
; Input	CRC32 :	47592904

; File Name   :	c:\Users\farhadi\Desktop\Sample\samples\0d1411ec843c9060daa94317b0edbdc6
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00000BA0 (   2976.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 00001000
; Flags	60000020: Text Executable Readable
; Alignment	: default
;
; Imports from MSVBVM60.DLL
;

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Externs
; _idata
		extrn _CIcos:dword	; DATA XREF: .text:004010E6r
					; .text:00401964o
		extrn _adj_fptan:dword	; DATA XREF: .text:004010DAr
		extrn _adj_fdiv_m64:dword ; DATA XREF: .text:004010A4r
		extrn _adj_fprem1:dword	; DATA XREF: .text:004010D4r
		extrn _adj_fdiv_m32:dword ; DATA XREF: .text:00401098r
		extrn _adj_fdiv_m16i:dword ; DATA XREF:	.text:00401092r
		extrn _adj_fdivr_m16i:dword ; DATA XREF: .text:004010B0r
		extrn _CIsin:dword	; DATA XREF: .text:004010F8r
		extrn __vbaChkstk:dword	; DATA XREF: .text:00401080r
		extrn EVENT_SINK_AddRef:dword ;	DATA XREF: .text:loc_401116r
		extrn _adj_fpatan:dword	; DATA XREF: .text:004010C8r
		extrn EVENT_SINK_Release:dword ; DATA XREF: .text:loc_40111Cr
		extrn _CIsqrt:dword	; DATA XREF: .text:004010FEr
		extrn EVENT_SINK_QueryInterface:dword ;	DATA XREF: .text:loc_401110r
		extrn __vbaExceptHandler:dword ; DATA XREF: .text:00401086r
		extrn _adj_fprem:dword	; DATA XREF: .text:004010CEr
		extrn _adj_fdivr_m64:dword ; DATA XREF:	.text:004010C2r
		extrn __vbaFPException:dword ; DATA XREF: .text:0040108Cr
		extrn _CIlog:dword	; DATA XREF: .text:004010F2r
		extrn _adj_fdiv_m32i:dword ; DATA XREF:	.text:0040109Er
		extrn _adj_fdivr_m32i:dword ; DATA XREF: .text:004010BCr
		extrn _adj_fdivr_m32:dword ; DATA XREF:	.text:004010B6r
		extrn _adj_fdiv_r:dword	; DATA XREF: .text:004010AAr
		extrn __imp_ThunRTMain:dword ; DATA XREF: ThunRTMainr
		extrn _CIatan:dword	; DATA XREF: .text:004010E0r
		extrn _allmul:dword	; DATA XREF: .text:0040110Ar
		extrn _CItan:dword	; DATA XREF: .text:00401104r
		extrn _CIexp:dword	; DATA XREF: .text:004010ECr


; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401074h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
		align 10h
		jmp	ds:__vbaChkstk
; ---------------------------------------------------------------------------
		jmp	ds:__vbaExceptHandler
; ---------------------------------------------------------------------------
		jmp	ds:__vbaFPException
; ---------------------------------------------------------------------------
		jmp	ds:_adj_fdiv_m16i
; ---------------------------------------------------------------------------
		jmp	ds:_adj_fdiv_m32
; ---------------------------------------------------------------------------
		jmp	ds:_adj_fdiv_m32i
; ---------------------------------------------------------------------------
		jmp	ds:_adj_fdiv_m64
; ---------------------------------------------------------------------------
		jmp	ds:_adj_fdiv_r
; ---------------------------------------------------------------------------
		jmp	ds:_adj_fdivr_m16i
; ---------------------------------------------------------------------------
		jmp	ds:_adj_fdivr_m32
; ---------------------------------------------------------------------------
		jmp	ds:_adj_fdivr_m32i
; ---------------------------------------------------------------------------
		jmp	ds:_adj_fdivr_m64
; ---------------------------------------------------------------------------
		jmp	ds:_adj_fpatan
; ---------------------------------------------------------------------------
		jmp	ds:_adj_fprem
; ---------------------------------------------------------------------------
		jmp	ds:_adj_fprem1
; ---------------------------------------------------------------------------
		jmp	ds:_adj_fptan
; ---------------------------------------------------------------------------
		jmp	ds:_CIatan
; ---------------------------------------------------------------------------
		jmp	ds:_CIcos
; ---------------------------------------------------------------------------
		jmp	ds:_CIexp
; ---------------------------------------------------------------------------
		jmp	ds:_CIlog
; ---------------------------------------------------------------------------
		jmp	ds:_CIsin
; ---------------------------------------------------------------------------
		jmp	ds:_CIsqrt
; ---------------------------------------------------------------------------
		jmp	ds:_CItan
; ---------------------------------------------------------------------------
		jmp	ds:_allmul
; ---------------------------------------------------------------------------

loc_401110:				; DATA XREF: .text:0040158Co
					; .text:004015ECo
		jmp	ds:EVENT_SINK_QueryInterface
; ---------------------------------------------------------------------------

loc_401116:				; DATA XREF: .text:00401590o
					; .text:004015F0o
		jmp	ds:EVENT_SINK_AddRef
; ---------------------------------------------------------------------------

loc_40111C:				; DATA XREF: .text:00401594o
					; .text:004015F4o
		jmp	ds:EVENT_SINK_Release
; [00000006 BYTES: COLLAPSED FUNCTION ThunRTMain. PRESS	KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------
		assume fs:nothing, gs:nothing

		public start
start:
		push	offset dword_40128C
		call	ThunRTMain
; ---------------------------------------------------------------------------
		dw 0
		align 8
		dd 30h,	40h, 0
		dd 0A4D5CF22h, 41BC9211h, 0AC104281h, 0AA2C1120h, 0
		dd 10000h, 2 dup(0)
aProject1	db 'Project1',0
		align 10h
		dd 2 dup(0)
dword_401178	dd 31CCFFh, 0E516BA01h,	2E456E6Ch, 0DA84Ch, 92199A1Ch
					; DATA XREF: .text:00401284o
		dd 43C51BD7h, 44D9280Fh, 3DD3824Eh, 2B57799Dh, 0AD4F3AB5h
		dd 0CF669933h, 0CB711h,	0D36000AAh, 93h, 8 dup(0)
dword_4011D0	dd 6B00h, 3E00h, 30000h, 6E6977h, 5010Dh, 6D726F46h, 1190031h
		dd 23004200h, 0FFFFFFFFh, 46000524h, 316D726Fh,	35002E00h
		dd 78h,	1C2h, 11D0h, 0BD6h, 1FF0346h, 26h, 4C000601h, 6C656261h
		dd 1010031h, 614C0006h,	316C6562h, 4380500h, 87F02D0h
		dd 120357h, 402FF00h, 50h, 6CE516BAh, 4C2E456Eh, 1C000DA8h
		dd 0D792199Ah, 5 dup(0)
		db 90h
		align 4
		dd 5 dup(0)
		dd 0C4h, 0
		dd offset dword_401178
		dd 4Ch
dword_40128C	dd 21354256h, 2A1FF0h, 3 dup(0)	; DATA XREF: .text:starto
		dd 7Eh,	2 dup(0)
		dd 0A0000h, 409h, 2 dup(0)
		dd offset dword_401674
		dd 30F002h, 0FFFFFF00h,	8, 2 dup(1), 0E9h, 2 dup(40123Ch)
		dd 401134h, 78h, 81h, 8Ah, 8Bh,	4 dup(0)
aProject1_0	db 'Project1',0
aProject1_1	db 'Project1',0
		dw 5000h
aRoject1	db 'roject1',0
dword_401320	dd 0			; DATA XREF: .text:004018B8o
		dd offset dword_40202C
		dd offset dword_4018B4
		dd 0FFFFFFFFh, 0
		dd offset dword_40201C
		dd 7CDF446Ah, 4D1B16C9h, 65E7A4ABh, 0F97069F6h,	1000Ah
		dd 10004h, 401374h, 3 dup(0)
		dd offset aProject1_2	; "Project1"
		dd 2 dup(409h),	0
dword_401370	dd 2, 4014B0h, 0FFFFFFFFh, 4014A4h, 3 dup(0) ; DATA XREF: .text:004014C8o
		dd offset aWin		; "win"
		dd 0
		db 90h
		align 2
		dw 550h
		dd 0FFFFh, 18083h, 2 dup(0)
aProject1_2	db 'Project1',0         ; DATA XREF: .text:00401360o
		align 4
aForm1		db 'Form1',0
		align 4
aWin		db 'win',0              ; DATA XREF: .text:0040138Co
dword_4013C0	dd 0F43C51Bh, 4E44D928h, 9D3DD382h, 0B52B5779h,	2DEAB531h
		dd 437FB439h, 9A7D95B8h, 425FAF8Fh, 6CE516BAh, 4C2E456Eh
		dd 1C000DA8h, 0D792199Ah, 9F3959C9h, 42DC9B54h,	0CC0F1788h
		dd 6A3FAB8Dh, 33AD4EDAh, 11CF6699h, 0AA000CB7h,	93D36000h
		dd 6562614Ch, 316Ch, 0FCFB3D2Eh, 1068A0FAh, 838A7h, 0B571332Bh
		dd 505C3A43h, 72676F72h, 46206D61h, 73656C69h, 63694D5Ch
		dd 6F736F72h, 56207466h, 61757369h, 7453206Ch, 6F696475h
		dd 3942565Ch, 42565C38h, 4C4F2E36h, 42h, 4256h,	401418h
		dd 0
		dd 6, 9, 401428h, 401460h, 4022D0h, 2 dup(0)
dword_401488	dd 5B56EE0h, 33AD4F3Ah,	11CF6699h, 0AA000CB7h, 93D36000h
					; DATA XREF: .text:004018ECo
		dd 6D726F46h, 0
		dd 44000Ch, 2 dup(0)
dword_4014B0	dd 1, 401320h, 0	; DATA XREF: .text:00401588o
					; .text:004015E8o ...
		dd offset dword_4018F4
		dd 0FFFFFFFFh, 0
		dd offset dword_401370+4
		dd offset dword_402008
		dd 0
		dd 550CCC0h, 3 dup(0)
		dd offset off_401528
		dd 1, 4013D0h, 0
		dd offset off_401528
		dd 1, 401530h, 0
		dd offset off_40152C
		dd 2, 401530h, 1B70000h, 6C0068h, 401580h, 4022DCh, 0
		dd 5B41120h
off_401528	dd offset dword_4013C0+20h ; DATA XREF:	.text:004014E4o
					; .text:004014F4o
off_40152C	dd offset dword_4013C0+30h ; DATA XREF:	.text:00401504o
dword_401530	dd 120040h, 34h, 401400h, 30001h, 2 dup(0) ; DATA XREF:	.text:00401584o
		dd offset dword_401580
dword_40154C	dd 54521A8h, 401410h, 30001h, 1F0040h, 38h, 40148Ch, 0FFFFFFFFh
					; DATA XREF: .text:004015E4o
		dd 2 dup(0)
		dd offset dword_4015E0
		dd 54521B8h, 40149Ch, 0FFFFFFFFh
dword_401580	dd 0			; DATA XREF: .text:00401548o
		dd offset dword_401530
		dd offset dword_4014B0
		dd offset loc_401110
		dd offset loc_401116
		dd offset loc_40111C
		dd 12h dup(0)
dword_4015E0	dd 0			; DATA XREF: .text:00401570o
		dd offset dword_40154C+0Ch
		dd offset dword_4014B0
		dd offset loc_401110
		dd offset loc_401116
		dd offset loc_40111C
		dd 1Fh dup(0)
dword_401674	dd 1F4h, 401320h, 0	; DATA XREF: .text:004012BCo
		dd offset dword_401940
		dd offset dword_401950
		dd 9D8h, 402008h, 401086h, 402000h, 5C002Ah, 500041h, 6F0072h
		dd 65006Ah, 740063h, 31h, 7Eh dup(0)
		dd offset dword_4011D0+6Ch
		align 10h
off_4018B0	dd offset dword_4018F4	; DATA XREF: .text:004018C4o
					; .text:0040190Co ...
dword_4018B4	dd 0			; DATA XREF: .text:00401328o
		dd offset dword_401320
		dd 0FFFFFFFFh, 0
		dd offset off_4018B0
		dd 3 dup(0)
		dd 0FFFFFFFFh, 0
		dd offset dword_4013C0+0A4h
		dd offset dword_4013C0+40h
		dd offset dword_4022D4
		dd offset dword_4013C0+0A4h
		dd offset dword_401488+4
		dd offset dword_4022D8
dword_4018F4	dd 0			; DATA XREF: .text:004014BCo
					; .text:off_4018B0o
		dd offset dword_4014B0
		dd 0FFFFFFFFh, 3 dup(0)
		dd offset off_4018B0
		dd 0
		dd offset off_4018B0
		dd offset off_4018B0
		dd offset off_4018B0
		dd 3 dup(0)
		dd 44h,	4, 3 dup(0CCCCCCCCh)
dword_401940	dd 0E9E9E9E9h, 3 dup(0CCCCCCCCh) ; DATA	XREF: .text:00401680o
dword_401950	dd 9E9E9E9Eh		; DATA XREF: .text:00401684o
__IMPORT_DESCRIPTOR_MSVBVM60 dd	rva off_40197C ; Import	Name Table
		dd 0FFFFFFFFh		; Time stamp
		dd 0FFFFFFFFh		; Forwarder Chain
		dd rva aMsvbvm60_dll	; DLL Name
		dd rva _CIcos		; Import Address Table
		dd 5 dup(0)
;
; Import names for MSVBVM60.DLL
;
off_40197C	dd rva word_4019FE	; DATA XREF: .text:__IMPORT_DESCRIPTOR_MSVBVM60o
		dd rva word_401A08
		dd rva word_401A16
		dd rva word_401A26
		dd rva word_401A34
		dd rva word_401A44
		dd rva word_401A56
		dd rva word_401A68
		dd rva word_401A72
		dd rva word_401A80
		dd rva word_401A94
		dd rva word_401AA2
		dd rva word_401AB8
		dd rva word_401AC2
		dd rva word_401ADE
		dd rva word_401AF4
		dd rva word_401B02
		dd rva word_401B14
		dd rva word_401B28
		dd rva word_401B32
		dd rva word_401B44
		dd rva word_401B56
		dd rva word_401B68
		dd 80000064h
		dd rva word_401B76
		dd rva word_401B80
		dd rva word_401B8A
		dd rva word_401B94
		dd 0
aMsvbvm60_dll	db 'MSVBVM60.DLL',0     ; DATA XREF: .text:00401960o
		align 2
word_4019FE	dw 0			; DATA XREF: .text:off_40197Co
		db '_CIcos',0
		align 4
word_401A08	dw 0			; DATA XREF: .text:00401980o
		db '_adj_fptan',0
		align 2
word_401A16	dw 0			; DATA XREF: .text:00401984o
		db '_adj_fdiv_m64',0
word_401A26	dw 0			; DATA XREF: .text:00401988o
		db '_adj_fprem1',0
word_401A34	dw 0			; DATA XREF: .text:0040198Co
		db '_adj_fdiv_m32',0
word_401A44	dw 0			; DATA XREF: .text:00401990o
		db '_adj_fdiv_m16i',0
		align 2
word_401A56	dw 0			; DATA XREF: .text:00401994o
		db '_adj_fdivr_m16i',0
word_401A68	dw 0			; DATA XREF: .text:00401998o
		db '_CIsin',0
		align 2
word_401A72	dw 0			; DATA XREF: .text:0040199Co
		db '__vbaChkstk',0
word_401A80	dw 0			; DATA XREF: .text:004019A0o
		db 'EVENT_SINK_AddRef',0
word_401A94	dw 0			; DATA XREF: .text:004019A4o
		db '_adj_fpatan',0
word_401AA2	dw 0			; DATA XREF: .text:004019A8o
		db 'EVENT_SINK_Release',0
		align 4
word_401AB8	dw 0			; DATA XREF: .text:004019ACo
		db '_CIsqrt',0
word_401AC2	dw 0			; DATA XREF: .text:004019B0o
		db 'EVENT_SINK_QueryInterface',0
word_401ADE	dw 0			; DATA XREF: .text:004019B4o
		db '__vbaExceptHandler',0
		align 4
word_401AF4	dw 0			; DATA XREF: .text:004019B8o
		db '_adj_fprem',0
		align 2
word_401B02	dw 0			; DATA XREF: .text:004019BCo
		db '_adj_fdivr_m64',0
		align 4
word_401B14	dw 0			; DATA XREF: .text:004019C0o
		db '__vbaFPException',0
		align 4
word_401B28	dw 0			; DATA XREF: .text:004019C4o
		db '_CIlog',0
		align 2
word_401B32	dw 0			; DATA XREF: .text:004019C8o
		db '_adj_fdiv_m32i',0
		align 4
word_401B44	dw 0			; DATA XREF: .text:004019CCo
		db '_adj_fdivr_m32i',0
word_401B56	dw 0			; DATA XREF: .text:004019D0o
		db '_adj_fdivr_m32',0
		align 4
word_401B68	dw 0			; DATA XREF: .text:004019D4o
		db '_adj_fdiv_r',0
word_401B76	dw 0			; DATA XREF: .text:004019DCo
		db '_CIatan',0
word_401B80	dw 0			; DATA XREF: .text:004019E0o
		db '_allmul',0
word_401B8A	dw 0			; DATA XREF: .text:004019E4o
		db '_CItan',0
		align 4
word_401B94	dw 0			; DATA XREF: .text:004019E8o
		db '_CIexp',0
		align 800h
_text		ends

; Section 2. (virtual address 00002000)
; Virtual size			: 000009E0 (   2528.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 00002000
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 402000h
		dd 2 dup(0)
dword_402008	dd 5 dup(0)		; DATA XREF: .text:004014CCo
dword_40201C	dd 4 dup(0)		; DATA XREF: .text:00401334o
dword_40202C	dd 0AAh	dup(0)		; DATA XREF: .text:00401324o
dword_4022D4	dd 0			; DATA XREF: .text:004018E4o
dword_4022D8	dd 34Ah	dup(0)		; DATA XREF: .text:004018F0o
_data		ends


		end start
