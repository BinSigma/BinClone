;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	1B7EF4E251F5BBD43342D6BC065175A1
; Input	CRC32 :	CB7DC6EE

; File Name   :	c:\Users\farhadi\Desktop\Sample\samples\1b7ef4e251f5bbd43342d6bc065175a1
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 0000775A (  30554.)
; Section size in file		: 00008000 (  32768.)
; Offset to raw	data for section: 00001000
; Flags	60000020: Text Executable Readable
; Alignment	: default
; OS type	  :  MS	Windows
; Application type:  Executable	32bit

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401000(LPCSTR	lpMultiByteStr)
sub_401000	proc near		; CODE XREF: sub_401201+D1p
					; sub_4013A9+11Bp ...

cbMultiByte	= dword	ptr -4
lpMultiByteStr	= dword	ptr  4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	[esp+10h+lpMultiByteStr] ; lpString
		call	ds:lstrlenA
		xor	ebp, ebp
		mov	ebx, ds:MultiByteToWideChar
		push	ebp		; cchWideChar
		push	ebp		; lpWideCharStr
		push	eax		; cbMultiByte
		mov	[esp+1Ch+cbMultiByte], eax
		push	[esp+1Ch+lpMultiByteStr] ; lpMultiByteStr
		push	ebp		; dwFlags
		push	ebp		; CodePage
		call	ebx ; MultiByteToWideChar
		mov	esi, eax
		cmp	esi, ebp
		jle	short loc_401050
		lea	eax, [esi+esi+2]
		push	edi
		push	eax		; Size
		call	_malloc
		pop	ecx
		mov	edi, eax
		push	esi		; cchWideChar
		push	edi		; lpWideCharStr
		push	[esp+1Ch+cbMultiByte] ;	cbMultiByte
		push	[esp+20h+lpMultiByteStr] ; lpMultiByteStr
		push	ebp		; dwFlags
		push	ebp		; CodePage
		call	ebx ; MultiByteToWideChar
		mov	[edi+esi*2], bp
		mov	eax, edi
		pop	edi
		jmp	short loc_401052
; ---------------------------------------------------------------------------

loc_401050:				; CODE XREF: sub_401000+29j
		xor	eax, eax

loc_401052:				; CODE XREF: sub_401000+4Ej
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_401000	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401057(LPCWSTR lpWideCharStr)
sub_401057	proc near		; CODE XREF: sub_401AC8+10Bp
					; sub_402BBD+23p ...

cchWideChar	= dword	ptr -4
lpWideCharStr	= dword	ptr  4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	[esp+10h+lpWideCharStr]	; lpString
		call	ds:lstrlenW
		xor	ebx, ebx
		mov	ebp, ds:WideCharToMultiByte
		push	ebx		; lpUsedDefaultChar
		push	ebx		; lpDefaultChar
		push	ebx		; cbMultiByte
		push	ebx		; lpMultiByteStr
		push	eax		; cchWideChar
		mov	[esp+24h+cchWideChar], eax
		push	[esp+24h+lpWideCharStr]	; lpWideCharStr
		push	ebx		; dwFlags
		push	ebx		; CodePage
		call	ebp ; WideCharToMultiByte
		mov	esi, eax
		cmp	esi, ebx
		jle	short loc_4010A9
		lea	eax, [esi+1]
		push	edi
		push	eax		; Size
		call	_malloc
		pop	ecx
		mov	edi, eax
		push	ebx		; lpUsedDefaultChar
		push	ebx		; lpDefaultChar
		push	esi		; cbMultiByte
		push	edi		; lpMultiByteStr
		push	[esp+24h+cchWideChar] ;	cchWideChar
		push	[esp+28h+lpWideCharStr]	; lpWideCharStr
		push	ebx		; dwFlags
		push	ebx		; CodePage
		call	ebp ; WideCharToMultiByte
		mov	[edi+esi], bl
		mov	eax, edi
		pop	edi
		jmp	short loc_4010AB
; ---------------------------------------------------------------------------

loc_4010A9:				; CODE XREF: sub_401057+2Bj
		xor	eax, eax

loc_4010AB:				; CODE XREF: sub_401057+50j
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_401057	endp


; =============== S U B	R O U T	I N E =======================================


sub_4010B0	proc near		; CODE XREF: sub_4019A6+1Fp

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		or	eax, 0FFFFFFFFh

loc_4010B7:				; CODE XREF: sub_4010B0+Dj
		mov	dl, [ecx]
		inc	eax
		inc	ecx
		test	dl, dl
		jnz	short loc_4010B7
		retn
sub_4010B0	endp


; =============== S U B	R O U T	I N E =======================================


sub_4010C0	proc near		; CODE XREF: sub_401201+C3p

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		or	eax, 0FFFFFFFFh

loc_4010C7:				; CODE XREF: sub_4010C0+10j
		mov	dx, [ecx]
		inc	eax
		inc	ecx
		inc	ecx
		test	dx, dx
		jnz	short loc_4010C7
		retn
sub_4010C0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4010D3	proc near		; CODE XREF: WinMain(x,x,x,x)+13Fp

var_24		= byte ptr -24h
var_23		= byte ptr -23h
var_22		= byte ptr -22h
var_21		= byte ptr -21h
var_20		= byte ptr -20h
var_1F		= byte ptr -1Fh
var_1E		= byte ptr -1Eh
var_1D		= byte ptr -1Dh
var_1C		= byte ptr -1Ch
var_1B		= byte ptr -1Bh
var_1A		= byte ptr -1Ah
var_19		= byte ptr -19h
var_18		= byte ptr -18h
var_17		= byte ptr -17h
var_16		= byte ptr -16h
var_15		= byte ptr -15h
var_14		= byte ptr -14h
var_13		= byte ptr -13h
var_12		= byte ptr -12h
var_11		= byte ptr -11h
var_10		= byte ptr -10h
var_F		= byte ptr -0Fh
var_E		= byte ptr -0Eh
var_D		= byte ptr -0Dh
var_C		= byte ptr -0Ch
var_B		= byte ptr -0Bh
var_A		= byte ptr -0Ah
var_9		= byte ptr -9
var_8		= byte ptr -8
var_7		= byte ptr -7
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		lea	eax, [ebp+var_10]
		push	ebx
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_24]
		push	eax
		lea	eax, [ebp+var_4]
		xor	ebx, ebx
		push	0Ah
		push	eax
		mov	[ebp+var_24], 30h
		mov	[ebp+var_23], 76h
		mov	[ebp+var_22], 4Ch
		mov	[ebp+var_21], 6Dh
		mov	[ebp+var_20], 55h
		mov	[ebp+var_1F], 6Dh
		mov	[ebp+var_1E], 53h
		mov	[ebp+var_1D], 73h
		mov	[ebp+var_1C], 78h
		mov	[ebp+var_1B], 6Ah
		mov	[ebp+var_1A], 62h
		mov	[ebp+var_19], 4Fh
		mov	[ebp+var_18], 64h
		mov	[ebp+var_17], 66h
		mov	[ebp+var_16], 34h
		mov	[ebp+var_15], 77h
		mov	[ebp+var_14], 45h
		mov	[ebp+var_13], 55h
		mov	[ebp+var_12], 6Eh
		mov	[ebp+var_11], bl
		mov	[ebp+var_10], 52h
		mov	[ebp+var_F], 7Ch
		mov	[ebp+var_E], 0FDh
		mov	[ebp+var_D], 0C8h
		mov	[ebp+var_C], 0A2h
		mov	[ebp+var_B], 32h
		mov	[ebp+var_A], 22h
		mov	[ebp+var_9], 29h
		mov	[ebp+var_8], 0E7h
		mov	[ebp+var_7], 27h
		call	sub_4019A6
		push	ebx
		push	ebx
		push	ebx
		lea	eax, [ebp+var_10]
		push	ebx
		push	eax
		push	5
		push	offset byte_40ABBD
		push	offset word_40ABB2
		call	sub_401FCF
		add	esp, 2Ch
		pop	ebx
		leave
		retn
sub_4010D3	endp


; =============== S U B	R O U T	I N E =======================================


sub_401187	proc near		; CODE XREF: WinMain(x,x,x,x)+132p
		push	0
		push	offset word_40A8D2
		push	offset dword_40A898
		call	sub_401FCF
		add	esp, 0Ch
		retn
sub_401187	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40119C	proc near		; CODE XREF: WinMain(x,x,x,x)+14Cp

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, large fs:30h
		add	eax, 68h
		db	3Eh
		mov	eax, [eax]
		cmp	eax, 70h
		jz	short loc_4011BA
		mov	[ebp+var_4], 0
		jmp	short loc_4011C1
; ---------------------------------------------------------------------------

loc_4011BA:				; CODE XREF: sub_40119C+13j
		mov	[ebp+var_4], 1

loc_4011C1:				; CODE XREF: sub_40119C+1Cj
		mov	eax, [ebp+var_4]
		leave
		retn
sub_40119C	endp


; =============== S U B	R O U T	I N E =======================================


sub_4011C6	proc near		; CODE XREF: WinMain(x,x,x,x)+159p
		push	1
		push	offset byte_40AD21
		call	sub_402322
		pop	ecx
		test	eax, eax
		pop	ecx
		jnz	short loc_4011FD
		push	1
		push	offset byte_40AD31
		call	sub_402322
		pop	ecx
		test	eax, eax
		pop	ecx
		jnz	short loc_4011FD
		push	1
		push	offset byte_40AD41
		call	sub_402322
		pop	ecx
		test	eax, eax
		pop	ecx
		jnz	short loc_4011FD
		retn
; ---------------------------------------------------------------------------

loc_4011FD:				; CODE XREF: sub_4011C6+10j
					; sub_4011C6+22j ...
		push	1
		pop	eax
		retn
sub_4011C6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401201	proc near		; CODE XREF: WinMain(x,x,x,x)+11Cp

var_2C		= byte ptr -2Ch
var_2B		= byte ptr -2Bh
var_2A		= byte ptr -2Ah
var_29		= byte ptr -29h
var_28		= byte ptr -28h
var_27		= byte ptr -27h
var_26		= byte ptr -26h
var_25		= byte ptr -25h
var_24		= byte ptr -24h
var_23		= byte ptr -23h
var_22		= byte ptr -22h
var_21		= byte ptr -21h
var_20		= byte ptr -20h
var_1F		= byte ptr -1Fh
var_1E		= byte ptr -1Eh
var_1D		= byte ptr -1Dh
var_1C		= byte ptr -1Ch
var_1B		= byte ptr -1Bh
var_1A		= byte ptr -1Ah
var_19		= byte ptr -19h
var_18		= byte ptr -18h
var_17		= byte ptr -17h
var_16		= byte ptr -16h
var_15		= byte ptr -15h
var_14		= byte ptr -14h
var_13		= byte ptr -13h
var_12		= byte ptr -12h
var_11		= byte ptr -11h
var_10		= byte ptr -10h
var_F		= byte ptr -0Fh
var_E		= byte ptr -0Eh
var_D		= byte ptr -0Dh
var_C		= byte ptr -0Ch
var_B		= byte ptr -0Bh
var_8		= dword	ptr -8
MultiByteStr	= byte ptr -4
var_3		= byte ptr -3
var_2		= byte ptr -2
var_1		= byte ptr -1

		push	ebp
		mov	ebp, esp
		sub	esp, 2Ch
		and	[ebp+var_B], 0
		push	esi
		mov	[ebp+var_2C], 42h
		mov	[ebp+var_2B], 30h
		mov	[ebp+var_2A], 32h
		mov	[ebp+var_29], 4Bh
		mov	[ebp+var_28], 78h
		mov	[ebp+var_27], 44h
		mov	[ebp+var_26], 61h
		mov	[ebp+var_25], 57h
		mov	[ebp+var_24], 6Bh
		mov	[ebp+var_23], 41h
		mov	[ebp+var_22], 5Ah
		mov	[ebp+var_21], 6Ch
		mov	[ebp+var_20], 53h
		mov	[ebp+var_1F], 52h
		mov	[ebp+var_1E], 6Bh
		mov	[ebp+var_1D], 37h
		mov	[ebp+var_1C], 63h
		mov	[ebp+var_1B], 55h
		mov	[ebp+var_1A], 30h
		mov	[ebp+var_19], 56h
		mov	[ebp+var_18], 55h
		mov	[ebp+var_17], 68h
		mov	[ebp+var_16], 68h
		mov	[ebp+var_15], 58h
		mov	[ebp+var_14], 78h
		mov	[ebp+var_13], 38h
		mov	[ebp+var_12], 54h
		mov	[ebp+var_11], 46h
		mov	[ebp+var_10], 52h
		mov	[ebp+var_F], 6Dh
		mov	[ebp+var_E], 54h
		mov	[ebp+var_D], 63h
		mov	[ebp+var_C], 75h
		mov	[ebp+MultiByteStr], 0ADh
		mov	[ebp+var_3], 31h
		mov	[ebp+var_2], 0BCh
		mov	[ebp+var_1], 2Ch
		call	sub_402CC7
		mov	esi, eax
		lea	eax, [ebp+MultiByteStr]
		mov	[ebp+var_8], eax
		lea	eax, [ebp+var_2C]
		push	eax
		lea	eax, [ebp+var_8]
		push	4
		push	eax
		call	sub_4019A6
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_4012CE
		push	esi
		call	sub_4010C0
		test	eax, eax
		pop	ecx
		jbe	short loc_4012EC

loc_4012CE:				; CODE XREF: sub_401201+C0j
		lea	eax, [ebp+MultiByteStr]
		push	eax		; lpMultiByteStr
		call	sub_401000
		push	eax		; Buf2
		push	esi		; int
		push	1		; Buf1
		call	sub_402E37
		add	esp, 10h
		test	eax, eax
		jz	short loc_4012EC
		push	1
		pop	eax
		jmp	short loc_4012EE
; ---------------------------------------------------------------------------

loc_4012EC:				; CODE XREF: sub_401201+CBj
					; sub_401201+E4j
		xor	eax, eax

loc_4012EE:				; CODE XREF: sub_401201+E9j
		pop	esi
		leave
		retn
sub_401201	endp


; =============== S U B	R O U T	I N E =======================================


sub_4012F1	proc near		; CODE XREF: WinMain(x,x,x,x)+16Fp
		push	esi
		push	edi
		push	1
		mov	esi, offset byte_40AD63
		pop	edi
		push	edi
		push	esi
		call	sub_402322
		pop	ecx
		test	eax, eax
		pop	ecx
		jnz	short loc_401348
		push	edi
		push	esi
		call	sub_402322
		pop	ecx
		test	eax, eax
		pop	ecx
		jnz	short loc_401348
		push	edi
		push	offset byte_40AD7B
		call	sub_402322
		pop	ecx
		test	eax, eax
		pop	ecx
		jnz	short loc_401348
		push	edi
		push	offset byte_40AD8D
		call	sub_402322
		pop	ecx
		test	eax, eax
		pop	ecx
		jnz	short loc_401348
		push	edi
		push	offset byte_40AD9F
		call	sub_402322
		pop	ecx
		test	eax, eax
		pop	ecx
		jz	short loc_40134A

loc_401348:				; CODE XREF: sub_4012F1+15j
					; sub_4012F1+22j ...
		mov	eax, edi

loc_40134A:				; CODE XREF: sub_4012F1+55j
		pop	edi
		pop	esi
		retn
sub_4012F1	endp


; =============== S U B	R O U T	I N E =======================================


sub_40134D	proc near		; CODE XREF: WinMain(x,x,x,x)+185p
		push	1
		push	offset byte_40ADC9
		call	sub_402322
		pop	ecx
		test	eax, eax
		pop	ecx
		jnz	short loc_4013A5
		push	1
		push	offset byte_40ADE5
		call	sub_402322
		pop	ecx
		test	eax, eax
		pop	ecx
		jnz	short loc_4013A5
		push	1
		push	offset byte_40AE09
		call	sub_402322
		pop	ecx
		test	eax, eax
		pop	ecx
		jnz	short loc_4013A5
		push	1
		push	offset byte_40AE23
		call	sub_402322
		pop	ecx
		test	eax, eax
		pop	ecx
		jnz	short loc_4013A5
		push	offset byte_40AE3D ; lpString2
		call	sub_40237D
		test	eax, eax
		pop	ecx
		jnz	short loc_4013A5
		retn
; ---------------------------------------------------------------------------

loc_4013A5:				; CODE XREF: sub_40134D+10j
					; sub_40134D+22j ...
		push	1
		pop	eax
		retn
sub_40134D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4013A9	proc near		; CODE XREF: WinMain(x,x,x,x)+DBp

var_44		= byte ptr -44h
var_43		= byte ptr -43h
var_42		= byte ptr -42h
var_41		= byte ptr -41h
var_40		= byte ptr -40h
var_3F		= byte ptr -3Fh
var_3E		= byte ptr -3Eh
var_3D		= byte ptr -3Dh
var_3C		= byte ptr -3Ch
var_3B		= byte ptr -3Bh
var_3A		= byte ptr -3Ah
var_39		= byte ptr -39h
var_38		= byte ptr -38h
var_37		= byte ptr -37h
var_36		= byte ptr -36h
var_35		= byte ptr -35h
var_34		= byte ptr -34h
var_33		= byte ptr -33h
var_32		= byte ptr -32h
var_31		= byte ptr -31h
var_30		= byte ptr -30h
var_2F		= byte ptr -2Fh
var_2E		= byte ptr -2Eh
var_2D		= byte ptr -2Dh
var_2C		= byte ptr -2Ch
var_2B		= byte ptr -2Bh
var_2A		= byte ptr -2Ah
var_29		= byte ptr -29h
var_28		= byte ptr -28h
var_27		= byte ptr -27h
var_26		= byte ptr -26h
var_25		= byte ptr -25h
var_24		= byte ptr -24h
var_23		= byte ptr -23h
var_22		= byte ptr -22h
var_21		= byte ptr -21h
var_20		= byte ptr -20h
var_1F		= byte ptr -1Fh
var_1E		= byte ptr -1Eh
var_1D		= byte ptr -1Dh
var_1C		= byte ptr -1Ch
var_1B		= byte ptr -1Bh
var_1A		= byte ptr -1Ah
var_19		= byte ptr -19h
var_18		= byte ptr -18h
var_17		= byte ptr -17h
var_16		= byte ptr -16h
var_15		= byte ptr -15h
var_14		= byte ptr -14h
var_13		= byte ptr -13h
var_12		= byte ptr -12h
MultiByteStr	= byte ptr -10h
var_F		= byte ptr -0Fh
var_E		= byte ptr -0Eh
var_D		= byte ptr -0Dh
var_C		= byte ptr -0Ch
var_B		= byte ptr -0Bh
var_A		= byte ptr -0Ah
var_9		= byte ptr -9
var_8		= byte ptr -8
var_7		= byte ptr -7
var_6		= byte ptr -6
var_5		= byte ptr -5
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		lea	eax, [ebp+MultiByteStr]
		and	[ebp+var_12], 0
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_44]
		push	eax
		lea	eax, [ebp+var_4]
		push	0Ch
		push	eax
		mov	[ebp+var_44], 47h
		mov	[ebp+var_43], 63h
		mov	[ebp+var_42], 71h
		mov	[ebp+var_41], 71h
		mov	[ebp+var_40], 72h
		mov	[ebp+var_3F], 47h
		mov	[ebp+var_3E], 55h
		mov	[ebp+var_3D], 49h
		mov	[ebp+var_3C], 57h
		mov	[ebp+var_3B], 37h
		mov	[ebp+var_3A], 48h
		mov	[ebp+var_39], 69h
		mov	[ebp+var_38], 66h
		mov	[ebp+var_37], 32h
		mov	[ebp+var_36], 44h
		mov	[ebp+var_35], 34h
		mov	[ebp+var_34], 59h
		mov	[ebp+var_33], 65h
		mov	[ebp+var_32], 48h
		mov	[ebp+var_31], 36h
		mov	[ebp+var_30], 6Ch
		mov	[ebp+var_2F], 6Bh
		mov	[ebp+var_2E], 51h
		mov	[ebp+var_2D], 44h
		mov	[ebp+var_2C], 46h
		mov	[ebp+var_2B], 76h
		mov	[ebp+var_2A], 59h
		mov	[ebp+var_29], 57h
		mov	[ebp+var_28], 66h
		mov	[ebp+var_27], 62h
		mov	[ebp+var_26], 61h
		mov	[ebp+var_25], 74h
		mov	[ebp+var_24], 69h
		mov	[ebp+var_23], 31h
		mov	[ebp+var_22], 47h
		mov	[ebp+var_21], 52h
		mov	[ebp+var_20], 63h
		mov	[ebp+var_1F], 68h
		mov	[ebp+var_1E], 34h
		mov	[ebp+var_1D], 51h
		mov	[ebp+var_1C], 4Eh
		mov	[ebp+var_1B], 75h
		mov	[ebp+var_1A], 68h
		mov	[ebp+var_19], 7Ah
		mov	[ebp+var_18], 31h
		mov	[ebp+var_17], 4Fh
		mov	[ebp+var_16], 54h
		mov	[ebp+var_15], 53h
		mov	[ebp+var_14], 57h
		mov	[ebp+var_13], 46h
		mov	[ebp+MultiByteStr], 70h
		mov	[ebp+var_F], 68h
		mov	[ebp+var_E], 9Bh
		mov	[ebp+var_D], 0F4h
		mov	[ebp+var_C], 0Ah
		mov	[ebp+var_B], 31h
		mov	[ebp+var_A], 0EDh
		mov	[ebp+var_9], 0C3h
		mov	[ebp+var_8], 51h
		mov	[ebp+var_7], 53h
		mov	[ebp+var_6], 4Ch
		mov	[ebp+var_5], 32h
		call	sub_4019A6
		lea	eax, [ebp+MultiByteStr]
		push	eax		; lpMultiByteStr
		call	sub_401000
		push	eax
		push	1
		push	offset byte_40A8C1
		push	offset dword_40A898
		call	sub_401FCF
		add	esp, 20h
		leave
		retn
sub_4013A9	endp


; =============== S U B	R O U T	I N E =======================================


sub_4014E0	proc near		; CODE XREF: WinMain(x,x,x,x)+E8p
		push	esi
		mov	esi, 208h
		push	edi
		push	esi		; Size
		call	_malloc
		mov	edi, eax
		push	esi		; Size
		push	0		; Val
		push	edi		; Dst
		call	_memset
		push	esi
		push	edi
		push	0
		push	3
		push	offset byte_40A989
		push	offset dword_40A898
		call	sub_401FCF
		add	esp, 28h
		test	eax, eax
		jz	short loc_401541
		push	offset Buf2	; Buf2
		push	edi		; int
		push	1		; Buf1
		call	sub_402E37
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_40153C
		push	offset byte_40AEAB ; Buf2
		push	edi		; int
		push	1		; Buf1
		call	sub_402E37
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_401541

loc_40153C:				; CODE XREF: sub_4014E0+46j
		push	1
		pop	eax
		jmp	short loc_401543
; ---------------------------------------------------------------------------

loc_401541:				; CODE XREF: sub_4014E0+32j
					; sub_4014E0+5Aj
		xor	eax, eax

loc_401543:				; CODE XREF: sub_4014E0+5Fj
		pop	edi
		pop	esi
		retn
sub_4014E0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401546	proc near		; CODE XREF: WinMain(x,x,x,x)+F5p

var_1		= byte ptr -1

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_1], 0
		push	esi
		mov	esi, offset dword_40A898
		push	esi
		push	1
		push	offset byte_40A8C1
		push	esi
		call	sub_401FCF
		add	esp, 10h
		test	eax, eax
		jz	short loc_4015B6
		push	edi
		push	offset dword_40A8E4
		push	eax
		push	2
		push	offset byte_40A8A5
		push	esi
		call	sub_401FCF
		push	0
		push	offset word_40A9D6
		push	esi
		mov	edi, eax
		call	sub_401FCF
		push	0
		lea	ecx, [ebp+var_1]
		push	1
		push	ecx
		push	edi
		push	eax
		push	5
		push	offset word_40A906
		push	esi
		call	sub_401FCF
		add	esp, 40h
		test	eax, eax
		pop	edi
		jz	short loc_4015B6
		cmp	[ebp+var_1], 0E9h
		jnz	short loc_4015B6
		push	1
		pop	eax
		jmp	short loc_4015B8
; ---------------------------------------------------------------------------

loc_4015B6:				; CODE XREF: sub_401546+21j
					; sub_401546+63j ...
		xor	eax, eax

loc_4015B8:				; CODE XREF: sub_401546+6Ej
		pop	esi
		leave
		retn
sub_401546	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4015BB	proc near		; CODE XREF: WinMain(x,x,x,x)+102p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, 208h
		push	edi
		push	esi		; Size
		call	_malloc
		mov	edi, eax
		push	esi		; Size
		push	0		; Val
		push	edi		; Dst
		call	_memset
		lea	eax, [ebp+var_4]
		mov	[ebp+var_4], esi
		push	eax
		push	edi
		push	2
		push	offset byte_40AB19
		push	offset dword_40AB0C
		call	sub_401FCF
		add	esp, 24h
		test	eax, eax
		jz	short loc_401614
		mov	eax, [ebp+var_4]
		push	offset String2	; lpString2
		push	edi		; lpString1
		and	word ptr [edi+eax*2], 0
		call	ds:lstrcmpiW
		test	eax, eax
		jnz	short loc_401614
		push	1
		pop	eax
		jmp	short loc_401616
; ---------------------------------------------------------------------------

loc_401614:				; CODE XREF: sub_4015BB+3Aj
					; sub_4015BB+52j
		xor	eax, eax

loc_401616:				; CODE XREF: sub_4015BB+57j
		pop	edi
		pop	esi
		leave
		retn
sub_4015BB	endp


; =============== S U B	R O U T	I N E =======================================


sub_40161A	proc near		; CODE XREF: WinMain(x,x,x,x)+10Fp
		push	esi
		mov	esi, 208h
		push	edi
		push	esi		; Size
		call	_malloc
		mov	edi, eax
		push	esi		; Size
		push	0		; Val
		push	edi		; Dst
		call	_memset
		push	esi
		push	edi
		push	0
		push	3
		push	offset byte_40A989
		push	offset dword_40A898
		call	sub_401FCF
		add	esp, 28h
		test	eax, eax
		jle	short loc_401668
		and	word ptr [edi+eax*2], 0
		push	offset word_40AE81 ; lpString2
		push	edi		; lpString1
		call	ds:lstrcmpiW
		test	eax, eax
		jnz	short loc_401668
		push	1
		pop	eax
		jmp	short loc_40166A
; ---------------------------------------------------------------------------

loc_401668:				; CODE XREF: sub_40161A+32j
					; sub_40161A+47j
		xor	eax, eax

loc_40166A:				; CODE XREF: sub_40161A+4Cj
		pop	edi
		pop	esi
		retn
sub_40161A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40166D	proc near		; CODE XREF: WinMain(x,x,x,x)+B8p

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		push	ebx
		push	esi
		mov	esi, 208h
		push	edi
		push	esi		; Size
		mov	[ebp+var_1C], offset byte_40AEB9
		mov	[ebp+var_18], offset byte_40AEC7
		mov	[ebp+var_14], offset byte_40AED1
		mov	[ebp+var_10], offset byte_40AEE1
		call	_malloc
		xor	edi, edi
		mov	ebx, eax
		push	esi		; Size
		push	edi		; Val
		push	ebx		; Dst
		call	_memset
		lea	eax, [ebp+var_8]
		mov	[ebp+var_C], esi
		push	eax
		push	20019h
		push	edi
		push	offset byte_40AEEB
		push	80000002h
		push	5
		mov	esi, offset dword_40AB0C
		push	offset word_40AB32
		push	esi
		call	sub_401FCF
		add	esp, 30h
		test	eax, eax
		jnz	short loc_401753
		lea	eax, [ebp+var_C]
		push	eax
		push	ebx
		push	edi
		push	edi
		push	offset dword_40A030
		push	[ebp+var_8]
		push	6
		push	offset dword_40AB40
		push	esi
		call	sub_401FCF
		add	esp, 24h
		test	eax, eax
		jnz	short loc_401740
		push	ebx		; lpString
		call	ds:lstrlenW
		push	eax
		push	ebx
		push	2
		push	offset word_40ABF6
		push	offset word_40ABB2
		call	sub_401FCF
		add	esp, 14h
		test	eax, eax
		jz	short loc_401740
		mov	[ebp+var_4], edi
		lea	edi, [ebp+var_1C]

loc_401723:				; CODE XREF: sub_40166D+D1j
		push	dword ptr [edi]	; Buf2
		push	ebx		; int
		push	1		; Buf1
		call	sub_402E37
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_40175A
		inc	[ebp+var_4]
		add	edi, 4
		cmp	[ebp+var_4], 4
		jb	short loc_401723

loc_401740:				; CODE XREF: sub_40166D+8Dj
					; sub_40166D+AEj
		push	[ebp+var_8]
		push	1
		push	offset dword_40AB70
		push	esi
		call	sub_401FCF
		add	esp, 10h

loc_401753:				; CODE XREF: sub_40166D+6Aj
		xor	eax, eax

loc_401755:				; CODE XREF: sub_40166D+103j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
; ---------------------------------------------------------------------------

loc_40175A:				; CODE XREF: sub_40166D+C5j
		push	[ebp+var_8]
		push	1
		push	offset dword_40AB70
		push	esi
		call	sub_401FCF
		add	esp, 10h
		push	1
		pop	eax
		jmp	short loc_401755
sub_40166D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401772	proc near		; CODE XREF: WinMain(x,x,x,x)+9Ep

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		call	ds:GetFocus
		mov	ecx, eax

loc_40177F:				; CODE XREF: sub_401772+19j
		rdtsc
		mov	ebx, eax
		rdtsc
		sub	eax, ebx
		push	eax
		cmp	eax, 1
		jz	short loc_40177F
		pop	eax
		cmp	eax, 200h
		jb	short loc_40179E
		mov	[ebp+var_4], 1
		jmp	short loc_4017A5
; ---------------------------------------------------------------------------

loc_40179E:				; CODE XREF: sub_401772+21j
		mov	[ebp+var_4], 0

loc_4017A5:				; CODE XREF: sub_401772+2Aj
		push	ecx		; hWnd
		call	ds:SetFocus
		mov	eax, [ebp+var_4]
		pop	ebx
		leave
		retn
sub_401772	endp ; sp-analysis failed

; ---------------------------------------------------------------------------

loc_4017B2:				; CODE XREF: WinMain(x,x,x,x)+ABp
		push	ebp
		mov	ebp, esp
		push	0FFFFFFFFh
		push	offset dword_409100
		push	offset unknown_libname_1 ; Microsoft VisualC 2-10/net runtime
		mov	eax, large fs:0
		push	eax
		mov	large fs:0, esp
		push	ecx
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	[ebp-18h], esp
		and	dword ptr [ebp-4], 0
		mov	eax, 1
; ---------------------------------------------------------------------------
		dd 0B073F0Fh, 0FFFC45C7h, 83FFFFFFh, 6AFFFC4Dh,	0DEB5801h
		dd 0C358016Ah, 83E8658Bh, 33FFFC4Dh, 0F04D8BC0h, 0D8964h
		dd 5F000000h, 0C3C95B5Eh

; =============== S U B	R O U T	I N E =======================================


sub_401810	proc near		; CODE XREF: WinMain(x,x,x,x)+C5p

var_4		= byte ptr -4

		push	ecx
		lea	eax, [esp+4+var_4]
		push	eax
		push	offset byte_40AF3B
		push	80000002h
		push	3
		push	offset word_40AB26
		push	offset dword_40AB0C
		call	sub_401FCF
		neg	eax
		sbb	eax, eax
		inc	eax
		add	esp, 1Ch
		retn
sub_401810	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40183A	proc near		; CODE XREF: sub_403967+105p
					; sub_403967+15Ap ...

NewSize		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+arg_0]
		and	[ebp+NewSize], 0
		mov	eax, [edi]
		lea	esi, [eax+eax*2]
		shl	esi, 2
		jz	short loc_40189F
		cmp	[ebp+arg_4], 0
		jz	short loc_40189F
		push	esi		; Size
		call	_malloc
		mov	ebx, [ebp+arg_8]
		lea	ecx, [ebp+NewSize]
		push	ecx
		mov	[ebx], eax
		push	dword ptr [edi]
		push	[ebp+arg_4]
		push	esi
		push	eax
		push	[ebp+arg_C]
		push	6
		push	offset word_40AAAE
		push	offset dword_40AAA4
		call	sub_401FCF
		add	esp, 28h
		test	eax, eax
		jnz	short loc_40189F
		mov	eax, [ebp+NewSize]
		push	eax		; NewSize
		mov	[edi], eax
		push	dword ptr [ebx]	; Memory
		call	_realloc
		pop	ecx
		mov	[ebx], eax
		pop	ecx
		push	1
		pop	eax
		jmp	short loc_4018A1
; ---------------------------------------------------------------------------

loc_40189F:				; CODE XREF: sub_40183A+16j
					; sub_40183A+1Cj ...
		xor	eax, eax

loc_4018A1:				; CODE XREF: sub_40183A+63j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_40183A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4018A6	proc near		; CODE XREF: sub_403967+53p

Dst		= byte ptr -818h
var_18		= dword	ptr -18h
Size		= dword	ptr -14h
var_10		= dword	ptr -10h
Memory		= dword	ptr -0Ch
var_8		= dword	ptr -8
NewSize		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 818h
		push	esi
		push	edi
		xor	edi, edi
		mov	esi, offset byte_40ACB1
		push	edi
		push	edi
		push	edi
		push	1
		push	edi
		push	5
		push	offset byte_40ACDF
		push	esi
		mov	[ebp+var_10], edi
		mov	[ebp+Size], edi
		mov	[ebp+NewSize], edi
		mov	[ebp+Memory], edi
		mov	[ebp+var_8], edi
		call	sub_401FCF
		add	esp, 20h
		cmp	eax, edi
		mov	[ebp+var_18], eax
		jz	loc_401977
		push	edi
		push	80000000h
		push	edi
		push	edi
		push	[ebp+arg_0]
		push	eax
		push	6
		push	offset word_40ACCE
		push	esi
		call	sub_401FCF
		add	esp, 24h
		cmp	eax, edi
		mov	[ebp+var_10], eax
		jz	short loc_401977
		push	ebx
		mov	ebx, 800h

loc_401911:				; CODE XREF: sub_4018A6+CEj
		push	ebx		; Size
		lea	eax, [ebp+Dst]
		push	edi		; Val
		push	eax		; Dst
		call	_memset
		lea	eax, [ebp+Size]
		push	eax
		lea	eax, [ebp+Dst]
		push	ebx
		push	eax
		push	[ebp+var_10]
		push	4
		push	offset byte_40ACBD
		push	esi
		call	sub_401FCF
		mov	eax, [ebp+Size]
		add	esp, 28h
		cmp	eax, edi
		jbe	short loc_401976
		add	[ebp+NewSize], eax
		push	[ebp+NewSize]	; NewSize
		push	[ebp+Memory]	; Memory
		call	_realloc
		push	[ebp+Size]	; Size
		lea	ecx, [ebp+Dst]
		mov	[ebp+Memory], eax
		push	ecx		; Src
		mov	ecx, [ebp+var_8]
		add	ecx, eax
		push	ecx		; Dst
		call	_memcpy
		mov	eax, [ebp+NewSize]
		add	esp, 14h
		mov	[ebp+var_8], eax
		jmp	short loc_401911
; ---------------------------------------------------------------------------

loc_401976:				; CODE XREF: sub_4018A6+9Dj
		pop	ebx

loc_401977:				; CODE XREF: sub_4018A6+3Cj
					; sub_4018A6+63j
		push	[ebp+var_18]
		mov	edi, offset byte_40ACED
		push	1
		push	edi
		push	esi
		call	sub_401FCF
		push	[ebp+var_10]
		push	1
		push	edi
		push	esi
		call	sub_401FCF
		mov	eax, [ebp+arg_4]
		mov	ecx, [ebp+var_8]
		add	esp, 20h
		mov	[eax], ecx
		mov	eax, [ebp+Memory]
		pop	edi
		pop	esi
		leave
		retn
sub_4018A6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4019A6	proc near		; CODE XREF: sub_4010D3+90p
					; sub_401201+B6p ...

var_80C		= dword	ptr -80Ch
var_40C		= dword	ptr -40Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 80Ch
		push	ebx
		push	esi
		push	edi
		xor	ebx, ebx
		push	[ebp+arg_8]
		mov	[ebp+var_4], 2
		mov	[ebp+var_C], 3
		call	sub_4010B0
		pop	ecx
		mov	[ebp+var_8], eax
		xor	eax, eax
		mov	ecx, 100h

loc_4019D5:				; CODE XREF: sub_4019A6+57j
		mov	esi, eax
		lea	edi, [eax+1]
		shl	esi, 2
		xor	[ebp+var_C], edi
		mov	[ebp+esi+var_40C], eax
		cdq
		idiv	[ebp+var_8]
		mov	eax, [ebp+arg_8]
		movsx	eax, byte ptr [edx+eax]
		mov	[ebp+esi+var_80C], eax
		mov	eax, edi
		cmp	eax, ecx
		jl	short loc_4019D5
		xor	esi, esi

loc_401A01:				; CODE XREF: sub_4019A6+ABj
		lea	eax, [esi+1]
		mov	[ebp+arg_8], eax
		mov	edi, eax
		mov	eax, [ebp+var_4]
		xor	edi, [ebp+var_C]
		cdq
		idiv	edi
		mov	eax, esi
		shl	eax, 2
		mov	edi, [ebp+eax+var_40C]
		lea	esi, [ebp+eax+var_40C]
		mov	eax, [ebp+eax+var_80C]
		add	eax, edi
		add	eax, ebx
		mov	ebx, ecx
		mov	[ebp+var_4], edx
		cdq
		idiv	ebx
		mov	ebx, edx
		mov	edx, [ebp+ebx*4+var_40C]
		mov	[esi], edx
		mov	esi, [ebp+arg_8]
		lea	eax, [ebp+ebx*4+var_40C]
		cmp	esi, ecx
		mov	[eax], edi
		jl	short loc_401A01
		xor	eax, eax
		xor	ebx, ebx
		cmp	[ebp+arg_4], eax
		mov	[ebp+arg_8], eax
		jle	short loc_401AC3
		jmp	short loc_401A67
; ---------------------------------------------------------------------------

loc_401A61:				; CODE XREF: sub_4019A6+11Bj
		mov	eax, [ebp+var_8]
		mov	ebx, [ebp+var_4]

loc_401A67:				; CODE XREF: sub_4019A6+B9j
		inc	eax
		mov	esi, ecx
		cdq
		idiv	esi
		mov	edi, [ebp+edx*4+var_40C]
		lea	eax, [edi+ebx]
		mov	ebx, ecx
		mov	[ebp+var_8], edx
		lea	esi, [ebp+edx*4+var_40C]
		cdq
		idiv	ebx
		mov	[ebp+var_4], edx
		lea	eax, [ebp+edx*4+var_40C]
		mov	edx, [ebp+edx*4+var_40C]
		mov	[esi], edx
		mov	edx, [ebp+arg_8]
		mov	[eax], edi
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		lea	ebx, [eax+edx]
		mov	eax, [esi]
		add	eax, edi
		mov	esi, ecx
		cdq
		idiv	esi
		mov	al, byte ptr [ebp+edx*4+var_40C]
		xor	[ebx], al
		inc	[ebp+arg_8]
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+arg_4]
		jl	short loc_401A61

loc_401AC3:				; CODE XREF: sub_4019A6+B7j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_4019A6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401AC8	proc near		; CODE XREF: WinMain(x,x,x,x)+3D9p

Dst		= dword	ptr -64h
var_20		= byte ptr -20h
var_18		= dword	ptr -18h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
lpWideCharStr	= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 64h
		push	ebx
		push	esi
		push	edi
		push	44h
		pop	esi
		xor	edi, edi
		push	esi		; Size
		lea	eax, [ebp+Dst]
		push	edi		; Val
		push	eax		; Dst
		call	_memset
		push	10h		; Size
		lea	eax, [ebp+var_20]
		push	edi		; Val
		push	eax		; Dst
		call	_memset
		mov	ebx, 208h
		mov	[ebp+Dst], esi
		push	ebx		; Size
		call	_malloc
		push	24h
		mov	[ebp+lpWideCharStr], eax
		call	sub_402893
		mov	esi, ds:lstrcatW
		add	esp, 20h
		push	eax		; lpString2
		push	[ebp+lpWideCharStr] ; lpString1
		call	esi ; lstrcatW
		push	offset word_40AF57 ; lpString2
		push	[ebp+lpWideCharStr] ; lpString1
		call	esi ; lstrcatW
		lea	eax, [ebp+var_20]
		mov	esi, offset dword_40A898
		push	eax
		lea	eax, [ebp+Dst]
		push	eax
		push	edi
		push	edi
		push	4
		push	edi
		push	edi
		push	edi
		push	[ebp+lpWideCharStr]
		push	edi
		push	0Ah
		push	offset dword_40A8E4
		push	esi
		call	sub_401FCF
		add	esp, 34h
		test	eax, eax
		jz	loc_401C2B
		push	ebx		; Size
		push	edi		; Val
		push	[ebp+lpWideCharStr] ; Dst
		call	_memset
		push	ebx
		push	[ebp+lpWideCharStr]
		push	edi
		push	3
		push	offset byte_40A989
		push	esi
		call	sub_401FCF
		push	[ebp+var_18]
		mov	ebx, eax
		mov	[ebp+var_10], ebx
		push	1
		push	7FAh
		push	3
		push	offset word_40A9B6
		push	esi
		call	sub_401FCF
		push	40h
		add	ebx, 0D7h
		push	1000h
		push	ebx
		push	edi
		push	eax
		push	5
		push	offset byte_40A939
		push	esi
		mov	[ebp+var_8], eax
		call	sub_401FCF
		add	esp, 5Ch
		mov	ebx, offset byte_40A8F3
		mov	[ebp+var_C], eax
		push	edi
		push	0D7h
		push	offset byte_40B143
		push	eax
		push	[ebp+var_8]
		push	5
		push	ebx
		push	esi
		call	sub_401FCF
		add	esp, 20h
		push	edi
		push	[ebp+var_10]
		push	[ebp+lpWideCharStr] ; lpWideCharStr
		call	sub_401057
		pop	ecx
		push	eax
		mov	eax, [ebp+var_C]
		add	eax, 0D7h
		push	eax
		push	[ebp+var_8]
		push	5
		push	ebx
		push	esi
		call	sub_401FCF
		push	edi
		push	edi
		push	edi
		push	[ebp+var_C]
		push	edi
		push	edi
		push	[ebp+var_8]
		push	7
		push	offset byte_40A919
		push	esi
		call	sub_401FCF
		add	esp, 48h
		push	3E8h
		push	1
		push	offset word_40A966
		push	esi
		call	sub_401FCF
		push	edi
		push	offset dword_40A96C
		push	esi
		call	sub_401FCF
		add	esp, 1Ch

loc_401C2B:				; CODE XREF: sub_401AC8+80j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_401AC8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401C30(LPCWSTR lpString2, int, void *Src, __int16)
sub_401C30	proc near		; CODE XREF: sub_403967:loc_403C08p

var_4A4		= dword	ptr -4A4h
var_4A0		= dword	ptr -4A0h
var_494		= dword	ptr -494h
var_490		= dword	ptr -490h
var_48A		= word ptr -48Ah
var_468		= dword	ptr -468h
var_45C		= dword	ptr -45Ch
var_440		= dword	ptr -440h
var_43C		= dword	ptr -43Ch
Dst		= dword	ptr -398h
var_36C		= dword	ptr -36Ch
var_368		= word ptr -368h
var_354		= dword	ptr -354h
var_350		= byte ptr -350h
var_34C		= word ptr -34Ch
var_310		= dword	ptr -310h
var_30C		= byte ptr -30Ch
var_300		= dword	ptr -300h
var_2FC		= dword	ptr -2FCh
var_2F8		= dword	ptr -2F8h
var_2E4		= dword	ptr -2E4h
var_240		= dword	ptr -240h
var_234		= dword	ptr -234h
var_18		= dword	ptr -18h
var_10		= dword	ptr -10h
var_4		= dword	ptr -4
lpString2	= dword	ptr  8
arg_4		= dword	ptr  0Ch
Src		= dword	ptr  10h
arg_C		= word ptr  14h

		push	ebp
		mov	ebp, esp
		push	0FFFFFFFFh
		push	offset dword_409110
		push	offset unknown_libname_1 ; Microsoft VisualC 2-10/net runtime
		mov	eax, large fs:0
		push	eax
		mov	large fs:0, esp
		sub	esp, 494h
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_18], esp
		xor	ebx, ebx
		mov	[ebp+var_4], ebx
		push	40h		; Size
		mov	esi, [ebp+Src]
		push	esi		; Src
		lea	eax, [ebp+var_34C]
		push	eax		; Dst
		call	_memcpy
		push	0F8h		; Size
		mov	eax, [ebp+var_310]
		add	eax, esi
		push	eax		; Src
		lea	eax, [ebp+var_490]
		push	eax		; Dst
		call	_memcpy
		add	esp, 18h
		cmp	[ebp+var_34C], 5A4Dh
		jnz	loc_401FBA
		cmp	[ebp+var_490], 4550h
		jnz	loc_401FBA
		push	44h
		pop	esi
		push	esi		; Size
		push	ebx		; Val
		lea	eax, [ebp+Dst]
		push	eax		; Dst
		call	_memset
		push	10h		; Size
		push	ebx		; Val
		lea	eax, [ebp+var_4A4]
		push	eax		; Dst
		call	_memset
		mov	[ebp+Dst], esi
		mov	[ebp+var_36C], 1
		mov	ax, [ebp+arg_C]
		mov	[ebp+var_368], ax
		mov	esi, 208h
		push	esi		; Size
		call	_malloc
		mov	edi, eax
		mov	[ebp+var_494], edi
		push	esi		; Size
		push	ebx		; Val
		push	edi		; Dst
		call	_memset
		add	esp, 28h
		push	[ebp+lpString2]	; lpString2
		push	edi		; lpString1
		mov	esi, ds:lstrcatW
		call	esi ; lstrcatW
		push	[ebp+arg_4]	; lpString2
		push	edi		; lpString1
		call	esi ; lstrcatW
		lea	eax, [ebp+var_4A4]
		push	eax
		lea	eax, [ebp+Dst]
		push	eax
		push	ebx
		push	ebx
		push	84h
		push	ebx
		push	ebx
		push	ebx
		push	edi
		push	ebx
		push	0Ah
		push	offset dword_40A8E4
		mov	esi, offset dword_40A898
		push	esi
		call	sub_401FCF
		add	esp, 34h
		test	eax, eax
		jz	loc_401FBA
		push	3E8h
		push	1
		push	offset word_40A966
		push	esi
		call	sub_401FCF
		push	[ebp+var_45C]
		push	[ebp+var_4A4]
		push	2
		push	offset word_40AAC2
		mov	edi, offset dword_40AAA4
		push	edi
		call	sub_401FCF
		add	esp, 24h
		test	eax, eax
		jnz	short loc_401DA1
		push	[ebp+var_45C]
		push	[ebp+var_4A4]
		push	2
		push	offset word_40AAC2
		push	edi
		call	sub_401FCF
		add	esp, 14h

loc_401DA1:				; CODE XREF: sub_401C30+153j
		push	40h
		push	3000h
		push	[ebp+var_440]
		push	[ebp+var_45C]
		push	[ebp+var_4A4]
		push	5
		push	offset byte_40A939
		push	esi
		call	sub_401FCF
		add	esp, 20h
		test	eax, eax
		jz	loc_401F44
		lea	eax, [ebp+var_350]
		push	eax
		push	[ebp+var_43C]
		push	[ebp+Src]
		push	[ebp+var_45C]
		push	[ebp+var_4A4]
		push	5
		mov	ebx, offset byte_40A8F3
		push	ebx
		push	esi
		call	sub_401FCF
		add	esp, 20h
		xor	eax, eax
		mov	[ebp+var_354], eax

loc_401E07:				; CODE XREF: sub_401C30+24Dj
		movzx	ecx, [ebp+var_48A]
		cmp	eax, ecx
		jnb	short loc_401E7F
		push	28h		; Size
		lea	eax, [eax+eax*4]
		mov	ecx, [ebp+var_310]
		lea	eax, [ecx+eax*8]
		mov	ecx, [ebp+Src]
		lea	eax, [eax+ecx+0F8h]
		push	eax		; Src
		lea	eax, [ebp+var_30C]
		push	eax		; Dst
		call	_memcpy
		lea	eax, [ebp+var_350]
		push	eax
		push	[ebp+var_2FC]
		mov	eax, [ebp+var_2F8]
		mov	ecx, [ebp+Src]
		add	eax, ecx
		push	eax
		mov	eax, [ebp+var_300]
		mov	ecx, [ebp+var_45C]
		add	eax, ecx
		push	eax
		push	[ebp+var_4A4]
		push	5
		push	ebx
		push	esi
		call	sub_401FCF
		add	esp, 2Ch
		inc	[ebp+var_354]
		mov	eax, [ebp+var_354]
		jmp	short loc_401E07
; ---------------------------------------------------------------------------

loc_401E7F:				; CODE XREF: sub_401C30+1E0j
		push	2CCh		; Size
		push	0		; Val
		lea	eax, [ebp+var_2E4]
		push	eax		; Dst
		call	_memset
		mov	[ebp+var_2E4], 10007h
		lea	eax, [ebp+var_2E4]
		push	eax
		push	[ebp+var_4A0]
		push	2
		push	offset byte_40AAD7
		push	edi
		call	sub_401FCF
		lea	eax, [ebp+var_350]
		push	eax
		push	4
		lea	eax, [ebp+var_45C]
		push	eax
		mov	eax, [ebp+var_240]
		add	eax, 8
		push	eax
		push	[ebp+var_4A4]
		push	5
		push	ebx
		push	esi
		call	sub_401FCF
		add	esp, 40h
		mov	eax, [ebp+var_468]
		mov	ecx, [ebp+var_45C]
		add	eax, ecx
		mov	[ebp+var_234], eax
		lea	eax, [ebp+var_2E4]
		push	eax
		push	[ebp+var_4A0]
		push	2
		push	offset word_40AAEA
		push	edi
		call	sub_401FCF
		push	[ebp+var_4A0]
		push	1
		push	offset dword_40A92C
		push	esi
		call	sub_401FCF
		push	3E8h
		push	1
		push	offset word_40A966
		push	esi
		call	sub_401FCF
		add	esp, 34h
		mov	eax, [ebp+var_4A4]
		or	[ebp+var_4], 0FFFFFFFFh
		jmp	short loc_401FC0
; ---------------------------------------------------------------------------

loc_401F44:				; CODE XREF: sub_401C30+19Cj
		push	[ebp+var_4A4]
		push	1
		mov	edi, offset dword_40AA20
		push	edi
		push	esi
		call	sub_401FCF
		push	[ebp+var_4A0]
		push	1
		push	edi
		push	esi
		call	sub_401FCF
		push	ebx
		jmp	short loc_401FA4
; ---------------------------------------------------------------------------
		push	1
		pop	eax
		retn
; ---------------------------------------------------------------------------
		mov	esp, [ebp+var_18]
		cmp	[ebp+var_4A4], 0
		jz	short loc_401FBA
		push	[ebp+var_4A4]
		push	1
		mov	edi, offset dword_40AA20
		push	edi
		mov	esi, offset dword_40A898
		push	esi
		call	sub_401FCF
		push	[ebp+var_4A0]
		push	1
		push	edi
		push	esi
		call	sub_401FCF
		push	0

loc_401FA4:				; CODE XREF: sub_401C30+338j
		push	[ebp+var_4A4]
		push	2
		push	offset dword_40A978
		push	esi
		call	sub_401FCF
		add	esp, 34h

loc_401FBA:				; CODE XREF: sub_401C30+66j
					; sub_401C30+76j ...
		or	[ebp+var_4], 0FFFFFFFFh
		xor	eax, eax

loc_401FC0:				; CODE XREF: sub_401C30+312j
		mov	ecx, [ebp+var_10]
		mov	large fs:0, ecx
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_401C30	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401FCF	proc near		; CODE XREF: sub_4010D3+A9p
					; sub_401187+Cp ...

var_100D0	= dword	ptr -100D0h
var_100CC	= dword	ptr -100CCh
var_100C8	= dword	ptr -100C8h
var_100C4	= dword	ptr -100C4h
var_100C0	= byte ptr -100C0h
var_100BC	= byte ptr -100BCh
var_100BA	= byte ptr -100BAh
var_C0		= byte ptr -0C0h
Dst		= byte ptr -0BCh
var_44		= dword	ptr -44h
Src		= dword	ptr -38h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_10		= dword	ptr -10h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	0FFFFFFFFh
		push	offset dword_409120
		push	offset unknown_libname_1 ; Microsoft VisualC 2-10/net runtime
		mov	eax, large fs:0
		push	eax
		mov	large fs:0, esp
		push	ecx
		push	ecx
		mov	eax, 100B8h
		call	__alloca_probe
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_18], esp
		or	[ebp+var_1C], 0FFFFFFFFh
		push	[ebp+arg_0]
		call	dword_40B550
		test	eax, eax
		jbe	loc_40219E
		push	[ebp+arg_4]
		push	eax
		call	dword_40B54C
		mov	ebx, eax
		mov	[ebp+var_44], ebx
		test	ebx, ebx
		jbe	loc_40219E
		push	78h		; Size
		push	0		; Val
		lea	eax, [ebp+Dst]
		push	eax		; Dst
		call	_memset
		push	0FFFFh		; Size
		push	0		; Val
		lea	eax, [ebp+var_100C0]
		push	eax		; Dst
		call	_memset
		mov	[ebp+Src], 59595958h
		push	4
		pop	edi
		push	edi		; Size
		lea	eax, [ebp+Src]
		push	eax		; Src
		lea	eax, [ebp+var_100C0]
		push	eax		; Dst
		call	_memcpy
		mov	[ebp+Src], 5059h
		push	2		; Size
		lea	eax, [ebp+Src]
		push	eax		; Src
		lea	eax, [ebp+var_100BC]
		push	eax		; Dst
		call	_memcpy
		add	esp, 30h
		push	6
		pop	esi
		mov	edx, [ebp+arg_8]
		test	edx, edx
		jle	short loc_402107
		lea	eax, [ebp+arg_8]
		lea	ecx, [ebp+Dst]
		mov	[ebp+var_100C8], edx

loc_40209D:				; CODE XREF: sub_401FCF+DCj
		add	eax, edi
		mov	edx, [eax]
		mov	[ecx], edx
		add	ecx, edi
		dec	[ebp+var_100C8]
		jnz	short loc_40209D
		mov	edx, [ebp+arg_8]
		test	edx, edx
		jle	short loc_402107
		lea	ebx, [ebp+var_100BA]
		lea	eax, [ebp+edx*4+var_C0]
		mov	[ebp+var_100CC], eax
		mov	[ebp+var_100D0], edx

loc_4020CD:				; CODE XREF: sub_401FCF+133j
		mov	[ebp+Src], 68h
		push	1		; Size
		lea	eax, [ebp+Src]
		push	eax		; Src
		push	ebx		; Dst
		call	_memcpy
		inc	esi
		inc	ebx
		push	edi		; Size
		push	[ebp+var_100CC]	; Src
		push	ebx		; Dst
		call	_memcpy
		add	esp, 18h
		add	esi, edi
		add	ebx, edi
		sub	[ebp+var_100CC], edi
		dec	[ebp+var_100D0]
		jnz	short loc_4020CD
		mov	ebx, [ebp+var_44]

loc_402107:				; CODE XREF: sub_401FCF+BDj
					; sub_401FCF+E3j
		mov	[ebp+Src], 0E8h
		push	1		; Size
		lea	eax, [ebp+Src]
		push	eax		; Src
		lea	eax, [ebp+esi+var_100C0]
		push	eax		; Dst
		call	_memcpy
		inc	esi
		sub	ebx, esi
		lea	eax, [ebp+var_100C0]
		sub	ebx, eax
		sub	ebx, edi
		mov	[ebp+Src], ebx
		push	edi		; Size
		lea	eax, [ebp+Src]
		push	eax		; Src
		lea	eax, [ebp+esi+var_100C0]
		push	eax		; Dst
		call	_memcpy
		add	esi, edi
		mov	[ebp+Src], 0C3h
		push	1		; Size
		lea	eax, [ebp+Src]
		push	eax		; Src
		lea	eax, [ebp+esi+var_100C0]
		push	eax		; Dst
		call	_memcpy
		add	esp, 24h
		xor	esi, esi
		mov	[ebp+var_4], esi
		mov	[ebp+var_2C], 0Bh
		call	ds:GetFocus
		mov	[ebp+var_100C4], eax
		push	esi
		push	esi
		push	esi
		push	esi
		lea	eax, [ebp+var_100C0]
		push	eax
		call	dword_40B554
		mov	[ebp+var_1C], eax
		mov	[ebp+var_30], edi
		jmp	short loc_40219A
; ---------------------------------------------------------------------------
		push	1
		pop	eax
		retn
; ---------------------------------------------------------------------------
		mov	esp, [ebp+var_18]

loc_40219A:				; CODE XREF: sub_401FCF+1C2j
		or	[ebp+var_4], 0FFFFFFFFh

loc_40219E:				; CODE XREF: sub_401FCF+3Ej
					; sub_401FCF+55j
		mov	eax, [ebp+var_1C]
		mov	ecx, [ebp+var_10]
		mov	large fs:0, ecx
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_401FCF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4021B0(void *Src, void *Str)
sub_4021B0	proc near		; CODE XREF: sub_4034DF+1DAp

var_278		= dword	ptr -278h
var_174		= dword	ptr -174h
var_140		= dword	ptr -140h
var_FC		= dword	ptr -0FCh
Dst		= word ptr -7Ch
var_40		= dword	ptr -40h
var_3C		= byte ptr -3Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
Src		= dword	ptr  8
Str		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 278h
		push	ebx
		push	esi
		push	edi
		call	ds:GetFocus
		xor	ebx, ebx
		push	40h		; Size
		lea	eax, [ebp+Dst]
		push	ebx		; Val
		push	eax		; Dst
		call	_memset
		mov	esi, [ebp+Src]
		push	40h		; Size
		lea	eax, [ebp+Dst]
		push	esi		; Src
		push	eax		; Dst
		call	_memcpy
		add	esp, 18h
		cmp	[ebp+Dst], 5A4Dh
		mov	[ebp+Src], 2
		jnz	loc_40231B
		mov	edi, ds:SetFocus
		push	ebx		; hWnd
		call	edi ; SetFocus
		push	0F8h		; Size
		lea	eax, [ebp+var_174]
		push	ebx		; Val
		push	eax		; Dst
		call	_memset
		mov	eax, [ebp+var_40]
		push	0F8h		; Size
		add	eax, esi
		push	eax		; Src
		lea	eax, [ebp+var_174]
		push	eax		; Dst
		call	_memcpy
		add	esp, 18h
		cmp	[ebp+var_174], 4550h
		jnz	loc_40231B
		mov	eax, [ebp+var_FC]
		push	28h		; Size
		add	eax, esi
		mov	esi, [ebp+var_140]
		mov	[ebp+var_14], eax
		lea	eax, [ebp+var_3C]
		push	ebx		; Val
		push	eax		; Dst
		mov	[ebp+var_4], 3
		call	_memset
		push	28h		; Size
		lea	eax, [ebp+var_3C]
		push	[ebp+var_14]	; Src
		push	eax		; Dst
		call	_memcpy
		add	esp, 18h
		push	ebx		; hWnd
		call	edi ; SetFocus
		push	104h		; Size
		lea	eax, [ebp+var_278]
		push	ebx		; Val
		push	eax		; Dst
		call	_memset
		add	esp, 0Ch
		xor	edi, edi
		cmp	[ebp+var_24], ebx
		jbe	loc_40231B

loc_402292:				; CODE XREF: sub_4021B0+134j
		mov	eax, [ebp+var_1C]
		push	4		; Size
		lea	eax, [eax+edi*4]
		add	eax, esi
		push	eax		; Src
		lea	eax, [ebp+var_10]
		push	eax		; Dst
		call	_memcpy
		mov	eax, [ebp+var_10]
		push	0FFh		; Size
		add	eax, esi
		push	eax		; Src
		lea	eax, [ebp+var_278]
		push	eax		; Dst
		call	_memcpy
		push	[ebp+Str]	; Str
		lea	eax, [ebp+var_278]
		push	eax		; int
		push	1		; int
		call	sub_402DC1
		add	esp, 24h
		test	eax, eax
		jnz	short loc_4022E6
		inc	[ebp+Src]
		mov	eax, [ebp+Src]
		xor	[ebp+var_4], eax
		inc	edi
		cmp	edi, [ebp+var_24]
		jnb	short loc_40231B
		jmp	short loc_402292
; ---------------------------------------------------------------------------

loc_4022E6:				; CODE XREF: sub_4021B0+123j
		mov	eax, [ebp+var_18]
		push	2		; Size
		lea	eax, [eax+edi*2]
		add	eax, esi
		push	eax		; Src
		lea	eax, [ebp+var_C]
		push	eax		; Dst
		call	_memcpy
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+var_20]
		push	4		; Size
		lea	eax, [ecx+eax*4]
		add	eax, esi
		push	eax		; Src
		lea	eax, [ebp+var_8]
		push	eax		; Dst
		call	_memcpy
		mov	eax, [ebp+var_8]
		add	esp, 18h
		add	eax, esi
		jmp	short loc_40231D
; ---------------------------------------------------------------------------

loc_40231B:				; CODE XREF: sub_4021B0+3Fj
					; sub_4021B0+84j ...
		xor	eax, eax

loc_40231D:				; CODE XREF: sub_4021B0+169j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_4021B0	endp


; =============== S U B	R O U T	I N E =======================================


sub_402322	proc near		; CODE XREF: sub_4011C6+7p
					; sub_4011C6+19p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		xor	eax, eax
		cmp	[esp+arg_4], eax
		jz	short loc_402331
		push	eax
		push	[esp+4+arg_0]
		jmp	short loc_402336
; ---------------------------------------------------------------------------

loc_402331:				; CODE XREF: sub_402322+6j
		push	[esp+arg_0]
		push	eax

loc_402336:				; CODE XREF: sub_402322+Dj
		push	2
		push	offset byte_40ABD9
		push	offset word_40ABB2
		call	sub_401FCF
		add	esp, 14h
		retn
sub_402322	endp


; =============== S U B	R O U T	I N E =======================================


sub_40234B	proc near		; CODE XREF: WinMain(x,x,x,x)+37Ap
					; sub_403967+226p ...

arg_0		= dword	ptr  4

		push	[esp+arg_0]
		push	1
		push	offset dword_40AC90
		push	offset word_40AC72
		call	sub_401FCF
		add	esp, 10h
		retn
sub_40234B	endp


; =============== S U B	R O U T	I N E =======================================


sub_402364	proc near		; CODE XREF: sub_403967+375p

arg_0		= dword	ptr  4

		push	[esp+arg_0]
		push	1
		push	offset dword_40ACA0
		push	offset word_40AC72
		call	sub_401FCF
		add	esp, 10h
		retn
sub_402364	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40237D(LPCWSTR lpString2)
sub_40237D	proc near		; CODE XREF: sub_40134D+4Dp
					; WinMain(x,x,x,x)+1FBp

var_230		= dword	ptr -230h
var_22C		= dword	ptr -22Ch
String1		= word ptr -208h
lpString2	= dword	ptr  4

		sub	esp, 230h
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	0
		push	2
		pop	ebx
		mov	esi, offset dword_40A898
		push	ebx
		push	ebx
		push	offset dword_40A9E8
		push	esi
		call	sub_401FCF
		lea	ecx, [esp+254h+var_22C]
		mov	[esp+254h+var_230], eax
		push	ecx
		push	eax
		push	ebx
		push	offset byte_40AA01
		push	esi
		mov	[esp+268h+var_22C], 22Ch
		call	sub_401FCF
		add	esp, 28h
		test	eax, eax
		jz	loc_402470
		push	[esp+240h+lpString2] ; lpString
		mov	edi, ds:lstrlenW
		call	edi ; lstrlenW
		push	eax
		mov	ebp, offset word_40ABF6
		push	[esp+244h+lpString2]
		push	ebx
		mov	ebx, offset word_40ABB2
		push	ebp
		push	ebx
		call	sub_401FCF
		lea	eax, [esp+254h+var_22C]
		push	eax
		push	[esp+258h+var_230]
		push	2
		push	offset byte_40AA11
		push	esi
		call	sub_401FCF
		add	esp, 28h

loc_402409:				; CODE XREF: sub_40237D+D8j
		test	eax, eax
		jz	short loc_40245C
		lea	eax, [esp+240h+String1]
		push	eax		; lpString
		call	edi ; lstrlenW
		push	eax
		lea	eax, [esp+244h+String1]
		push	eax
		push	2
		push	ebp
		push	ebx
		call	sub_401FCF
		add	esp, 14h
		lea	eax, [esp+240h+String1]
		push	[esp+240h+lpString2] ; lpString2
		push	eax		; lpString1
		call	ds:lstrcmpiW
		test	eax, eax
		jz	short loc_402457
		lea	eax, [esp+240h+var_22C]
		push	eax
		push	[esp+244h+var_230]
		push	2
		push	offset byte_40AA11
		push	esi
		call	sub_401FCF
		add	esp, 14h
		jmp	short loc_402409
; ---------------------------------------------------------------------------

loc_402457:				; CODE XREF: sub_40237D+BDj
		push	1
		pop	eax
		jmp	short loc_402472
; ---------------------------------------------------------------------------

loc_40245C:				; CODE XREF: sub_40237D+8Ej
		push	[esp+240h+var_230]
		push	1
		push	offset dword_40AA20
		push	esi
		call	sub_401FCF
		add	esp, 10h

loc_402470:				; CODE XREF: sub_40237D+44j
		xor	eax, eax

loc_402472:				; CODE XREF: sub_40237D+DDj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 230h
		retn
sub_40237D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40247D	proc near		; CODE XREF: sub_4034DF+26Dp
					; sub_403967+BDp

var_A4		= byte ptr -0A4h
var_A3		= byte ptr -0A3h
var_A2		= byte ptr -0A2h
var_A1		= byte ptr -0A1h
var_A0		= byte ptr -0A0h
var_9F		= byte ptr -9Fh
var_9E		= byte ptr -9Eh
var_9D		= byte ptr -9Dh
var_9C		= byte ptr -9Ch
var_9B		= byte ptr -9Bh
var_9A		= byte ptr -9Ah
var_99		= byte ptr -99h
var_98		= byte ptr -98h
var_97		= byte ptr -97h
var_96		= byte ptr -96h
var_95		= byte ptr -95h
var_94		= byte ptr -94h
var_90		= byte ptr -90h
var_8F		= byte ptr -8Fh
var_8E		= byte ptr -8Eh
var_8D		= byte ptr -8Dh
var_8C		= byte ptr -8Ch
var_8B		= byte ptr -8Bh
var_8A		= byte ptr -8Ah
var_89		= byte ptr -89h
var_88		= byte ptr -88h
var_87		= byte ptr -87h
var_86		= byte ptr -86h
var_85		= byte ptr -85h
var_84		= byte ptr -84h
var_83		= byte ptr -83h
var_82		= byte ptr -82h
var_80		= byte ptr -80h
var_7F		= byte ptr -7Fh
var_7E		= byte ptr -7Eh
var_7D		= byte ptr -7Dh
var_7C		= byte ptr -7Ch
var_7B		= byte ptr -7Bh
var_7A		= byte ptr -7Ah
var_79		= byte ptr -79h
var_78		= byte ptr -78h
var_77		= byte ptr -77h
var_76		= byte ptr -76h
var_75		= byte ptr -75h
var_74		= byte ptr -74h
var_73		= byte ptr -73h
var_70		= byte ptr -70h
var_6F		= byte ptr -6Fh
var_6E		= byte ptr -6Eh
var_6D		= byte ptr -6Dh
var_6C		= byte ptr -6Ch
var_6B		= byte ptr -6Bh
var_6A		= byte ptr -6Ah
var_69		= byte ptr -69h
var_68		= byte ptr -68h
var_67		= byte ptr -67h
var_66		= byte ptr -66h
var_65		= byte ptr -65h
var_64		= byte ptr -64h
var_60		= byte ptr -60h
var_5F		= byte ptr -5Fh
var_5E		= byte ptr -5Eh
var_5D		= byte ptr -5Dh
var_5C		= byte ptr -5Ch
var_5B		= byte ptr -5Bh
var_5A		= byte ptr -5Ah
var_59		= byte ptr -59h
var_58		= byte ptr -58h
var_57		= byte ptr -57h
var_56		= byte ptr -56h
var_55		= byte ptr -55h
var_54		= byte ptr -54h
var_50		= byte ptr -50h
var_4F		= byte ptr -4Fh
var_4E		= byte ptr -4Eh
var_4D		= byte ptr -4Dh
var_4C		= byte ptr -4Ch
var_4B		= byte ptr -4Bh
var_4A		= byte ptr -4Ah
var_49		= byte ptr -49h
var_48		= byte ptr -48h
var_47		= byte ptr -47h
var_46		= byte ptr -46h
var_45		= byte ptr -45h
var_44		= byte ptr -44h
var_40		= byte ptr -40h
var_3F		= byte ptr -3Fh
var_3E		= byte ptr -3Eh
var_3D		= byte ptr -3Dh
var_3C		= byte ptr -3Ch
var_3B		= byte ptr -3Bh
var_3A		= byte ptr -3Ah
var_39		= byte ptr -39h
var_38		= byte ptr -38h
var_37		= byte ptr -37h
var_36		= byte ptr -36h
var_35		= byte ptr -35h
var_34		= byte ptr -34h
var_33		= byte ptr -33h
var_32		= byte ptr -32h
var_31		= byte ptr -31h
var_30		= byte ptr -30h
var_2F		= byte ptr -2Fh
var_2E		= byte ptr -2Eh
var_2D		= byte ptr -2Dh
var_2C		= byte ptr -2Ch
var_2B		= byte ptr -2Bh
var_2A		= byte ptr -2Ah
var_29		= byte ptr -29h
var_28		= byte ptr -28h
var_27		= byte ptr -27h
var_26		= byte ptr -26h
var_25		= byte ptr -25h
var_24		= byte ptr -24h
var_23		= byte ptr -23h
var_22		= byte ptr -22h
var_21		= byte ptr -21h
var_20		= byte ptr -20h
var_1F		= byte ptr -1Fh
var_1E		= byte ptr -1Eh
var_1D		= byte ptr -1Dh
var_1C		= byte ptr -1Ch
var_1B		= byte ptr -1Bh
var_1A		= byte ptr -1Ah
var_19		= byte ptr -19h
var_18		= byte ptr -18h
var_17		= byte ptr -17h
var_16		= byte ptr -16h
var_14		= byte ptr -14h
var_13		= byte ptr -13h
var_12		= byte ptr -12h
var_11		= byte ptr -11h
var_10		= byte ptr -10h
var_F		= byte ptr -0Fh
var_E		= byte ptr -0Eh
var_D		= byte ptr -0Dh
var_C		= byte ptr -0Ch
var_B		= byte ptr -0Bh
var_A		= byte ptr -0Ah
var_9		= byte ptr -9
var_8		= byte ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 0A4h
		and	[ebp+var_16], 0
		push	esi
		push	edi
		mov	[ebp+var_40], 6Ch
		mov	[ebp+var_3F], 5Ah
		mov	[ebp+var_3E], 33h
		mov	[ebp+var_3D], 65h
		mov	[ebp+var_3C], 4Dh
		mov	[ebp+var_3B], 4Fh
		mov	[ebp+var_3A], 69h
		mov	[ebp+var_39], 30h
		mov	[ebp+var_38], 77h
		mov	[ebp+var_37], 56h
		mov	[ebp+var_36], 79h
		mov	[ebp+var_35], 74h
		mov	[ebp+var_34], 66h
		mov	[ebp+var_33], 34h
		mov	[ebp+var_32], 65h
		mov	[ebp+var_31], 37h
		mov	[ebp+var_30], 79h
		mov	[ebp+var_2F], 61h
		mov	[ebp+var_2E], 56h
		mov	[ebp+var_2D], 42h
		mov	[ebp+var_2C], 32h
		mov	[ebp+var_2B], 7Ah
		mov	[ebp+var_2A], 4Eh
		mov	[ebp+var_29], 47h
		mov	[ebp+var_28], 31h
		mov	[ebp+var_27], 56h
		mov	[ebp+var_26], 63h
		mov	[ebp+var_25], 32h
		mov	[ebp+var_24], 4Fh
		mov	[ebp+var_23], 32h
		mov	[ebp+var_22], 68h
		mov	[ebp+var_21], 4Bh
		mov	[ebp+var_20], 4Fh
		mov	[ebp+var_1F], 36h
		mov	[ebp+var_1E], 48h
		mov	[ebp+var_1D], 39h
		mov	[ebp+var_1C], 67h
		mov	[ebp+var_1B], 70h
		mov	[ebp+var_1A], 53h
		mov	[ebp+var_19], 41h
		mov	[ebp+var_18], 33h
		mov	[ebp+var_17], 59h
		mov	[ebp+var_14], 82h
		mov	[ebp+var_13], 0Bh
		mov	[ebp+var_12], 0B8h
		mov	[ebp+var_11], 4Eh
		mov	[ebp+var_10], 7Ch
		mov	[ebp+var_F], 8Ah
		mov	[ebp+var_E], 0Fh
		mov	[ebp+var_D], 6Ah
		mov	[ebp+var_C], 0DEh
		mov	[ebp+var_B], 8Ah
		mov	[ebp+var_A], 86h
		mov	[ebp+var_9], 3Dh
		mov	[ebp+var_8], 5Eh
		mov	[ebp+var_80], 0AFh
		mov	[ebp+var_7F], 7
		mov	[ebp+var_7E], 0A4h
		mov	[ebp+var_7D], 44h
		mov	[ebp+var_7C], 4Bh
		mov	[ebp+var_7B], 83h
		mov	[ebp+var_7A], 4Fh
		mov	[ebp+var_79], 37h
		mov	[ebp+var_78], 85h
		mov	[ebp+var_77], 9Ch
		mov	[ebp+var_76], 89h
		mov	[ebp+var_75], 34h
		mov	[ebp+var_74], 1Fh
		mov	[ebp+var_73], 63h
		mov	[ebp+var_60], 0A5h
		mov	[ebp+var_5F], 1
		mov	[ebp+var_5E], 0ABh
		mov	[ebp+var_5D], 44h
		mov	[ebp+var_5C], 4Bh
		mov	[ebp+var_5B], 83h
		mov	[ebp+var_5A], 4Fh
		mov	[ebp+var_59], 37h
		mov	[ebp+var_58], 85h
		lea	eax, [ebp+var_14]
		mov	[ebp+var_57], 9Ch
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_40]
		push	eax
		push	0Dh
		pop	esi
		lea	eax, [ebp+var_4]
		push	esi
		push	eax
		mov	[ebp+var_56], 89h
		mov	[ebp+var_55], 34h
		mov	[ebp+var_54], 5Eh
		mov	[ebp+var_70], 0A5h
		mov	[ebp+var_6F], 1
		mov	[ebp+var_6E], 0A9h
		mov	[ebp+var_6D], 4Bh
		mov	[ebp+var_6C], 4Bh
		mov	[ebp+var_6B], 83h
		mov	[ebp+var_6A], 4Fh
		mov	[ebp+var_69], 37h
		mov	[ebp+var_68], 85h
		mov	[ebp+var_67], 9Ch
		mov	[ebp+var_66], 89h
		mov	[ebp+var_65], 34h
		mov	[ebp+var_64], 5Eh
		mov	[ebp+var_90], 0BAh
		mov	[ebp+var_8F], 7
		mov	[ebp+var_8E], 0B0h
		mov	[ebp+var_8D], 45h
		mov	[ebp+var_8C], 76h
		mov	[ebp+var_8B], 80h
		mov	[ebp+var_8A], 6Eh
		mov	[ebp+var_89], 3Dh
		mov	[ebp+var_88], 83h
		mov	[ebp+var_87], 81h
		mov	[ebp+var_86], 9Fh
		mov	[ebp+var_85], 23h
		mov	[ebp+var_84], 3Dh
		mov	[ebp+var_83], 6
		mov	[ebp+var_82], 7Fh
		mov	[ebp+var_50], 0AFh
		mov	[ebp+var_4F], 1Ch
		mov	[ebp+var_4E], 0AFh
		mov	[ebp+var_4D], 45h
		mov	[ebp+var_4C], 4Bh
		mov	[ebp+var_4B], 83h
		mov	[ebp+var_4A], 4Fh
		mov	[ebp+var_49], 37h
		mov	[ebp+var_48], 85h
		mov	[ebp+var_47], 9Ch
		mov	[ebp+var_46], 89h
		mov	[ebp+var_45], 34h
		mov	[ebp+var_44], 5Eh
		mov	[ebp+var_A4], 0AEh
		mov	[ebp+var_A3], 0Bh
		mov	[ebp+var_A2], 0BEh
		mov	[ebp+var_A1], 6Dh
		mov	[ebp+var_A0], 76h
		mov	[ebp+var_9F], 82h
		mov	[ebp+var_9E], 49h
		mov	[ebp+var_9D], 34h
		mov	[ebp+var_9C], 95h
		mov	[ebp+var_9B], 0A6h
		mov	[ebp+var_9A], 8Bh
		mov	[ebp+var_99], 3Fh
		mov	[ebp+var_98], 3Ah
		mov	[ebp+var_97], 0Fh
		mov	[ebp+var_96], 1Ah
		mov	[ebp+var_95], 82h
		mov	[ebp+var_94], 4
		call	sub_4019A6
		lea	eax, [ebp+var_80]
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_40]
		push	eax
		lea	eax, [ebp+var_4]
		push	0Eh
		push	eax
		call	sub_4019A6
		lea	eax, [ebp+var_60]
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_40]
		push	eax
		lea	eax, [ebp+var_4]
		push	esi
		push	eax
		call	sub_4019A6
		lea	eax, [ebp+var_70]
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_40]
		push	eax
		lea	eax, [ebp+var_4]
		push	esi
		push	eax
		call	sub_4019A6
		lea	eax, [ebp+var_90]
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_40]
		push	eax
		lea	eax, [ebp+var_4]
		push	0Fh
		push	eax
		call	sub_4019A6
		lea	eax, [ebp+var_50]
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_40]
		push	eax
		lea	eax, [ebp+var_4]
		push	esi
		push	eax
		call	sub_4019A6
		lea	eax, [ebp+var_A4]
		add	esp, 48h
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_40]
		push	eax
		lea	eax, [ebp+var_4]
		push	11h
		push	eax
		call	sub_4019A6
		movzx	eax, word ptr [ebp+arg_0]
		push	[ebp+arg_4]
		push	eax
		push	0
		lea	eax, [ebp+var_80]
		push	3
		push	eax
		lea	eax, [ebp+var_14]
		push	eax
		call	sub_401FCF
		mov	esi, eax
		add	esp, 24h
		test	esi, esi
		jz	short loc_40282A
		push	esi
		push	0
		lea	eax, [ebp+var_90]
		push	2
		push	eax
		lea	eax, [ebp+var_14]
		push	eax
		call	sub_401FCF
		add	esp, 14h
		mov	[ebp+arg_0], eax
		test	eax, eax
		jbe	short loc_40282A
		push	esi
		push	0
		lea	eax, [ebp+var_60]
		push	2
		push	eax
		lea	eax, [ebp+var_14]
		push	eax
		call	sub_401FCF
		add	esp, 14h
		test	eax, eax
		jz	short loc_40282A
		push	eax
		lea	eax, [ebp+var_70]
		push	1
		push	eax
		lea	eax, [ebp+var_14]
		push	eax
		call	sub_401FCF
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_40282E

loc_40282A:				; CODE XREF: sub_40247D+35Aj
					; sub_40247D+379j ...
		xor	eax, eax
		jmp	short loc_40284B
; ---------------------------------------------------------------------------

loc_40282E:				; CODE XREF: sub_40247D+3ABj
		push	esi
		lea	eax, [ebp+var_50]
		push	1
		push	eax
		lea	eax, [ebp+var_14]
		push	eax
		call	sub_401FCF
		mov	eax, [ebp+arg_8]
		mov	ecx, [ebp+arg_0]
		add	esp, 10h
		mov	[eax], ecx
		mov	eax, edi

loc_40284B:				; CODE XREF: sub_40247D+3AFj
		pop	edi
		pop	esi
		leave
		retn
sub_40247D	endp


; =============== S U B	R O U T	I N E =======================================


sub_40284F	proc near		; CODE XREF: WinMain(x,x,x,x)+233p
					; sub_403967+258p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, 208h
		push	edi
		push	esi		; Size
		call	_malloc
		mov	edi, eax
		push	esi		; Size
		push	0		; Val
		push	edi		; Dst
		call	_memset
		push	esi
		push	edi
		push	[esp+20h+arg_0]
		push	3
		push	offset byte_40A989
		push	offset dword_40A898
		call	sub_401FCF
		add	esp, 28h
		test	eax, eax
		jle	short loc_40288E
		and	word ptr [edi+eax*2], 0
		mov	eax, edi
		jmp	short loc_402890
; ---------------------------------------------------------------------------

loc_40288E:				; CODE XREF: sub_40284F+34j
		xor	eax, eax

loc_402890:				; CODE XREF: sub_40284F+3Dj
		pop	edi
		pop	esi
		retn
sub_40284F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402893	proc near		; CODE XREF: sub_401AC8+38p
					; WinMain(x,x,x,x)+365p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, 208h
		push	edi
		push	esi		; Size
		call	_malloc
		mov	edi, eax
		push	esi		; Size
		push	0		; Val
		push	edi		; Dst
		call	_memset
		lea	eax, [ebp+var_4]
		mov	esi, offset byte_40AC05
		push	eax
		push	[ebp+arg_0]
		push	0
		push	3
		push	offset byte_40AC1F
		push	esi
		call	sub_401FCF
		add	esp, 28h
		test	eax, eax
		jnz	short loc_4028ED
		push	edi
		push	[ebp+var_4]
		push	2
		push	offset word_40AC3A
		push	esi
		call	sub_401FCF
		add	esp, 14h
		test	eax, eax
		jz	short loc_4028ED
		mov	eax, edi
		jmp	short loc_4028EF
; ---------------------------------------------------------------------------

loc_4028ED:				; CODE XREF: sub_402893+3Cj
					; sub_402893+54j
		xor	eax, eax

loc_4028EF:				; CODE XREF: sub_402893+58j
		pop	edi
		pop	esi
		leave
		retn
sub_402893	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4028F3	proc near		; CODE XREF: sub_403967+277p

var_38		= byte ptr -38h
var_37		= byte ptr -37h
var_36		= byte ptr -36h
var_35		= byte ptr -35h
var_34		= byte ptr -34h
var_33		= byte ptr -33h
var_32		= byte ptr -32h
var_31		= byte ptr -31h
var_30		= byte ptr -30h
var_2F		= byte ptr -2Fh
var_2E		= byte ptr -2Eh
var_2D		= byte ptr -2Dh
var_2C		= byte ptr -2Ch
var_2B		= byte ptr -2Bh
var_2A		= byte ptr -2Ah
var_29		= byte ptr -29h
var_28		= byte ptr -28h
var_27		= byte ptr -27h
var_26		= byte ptr -26h
var_25		= byte ptr -25h
var_24		= byte ptr -24h
var_23		= byte ptr -23h
var_22		= byte ptr -22h
var_21		= byte ptr -21h
var_20		= byte ptr -20h
var_1F		= byte ptr -1Fh
var_1E		= byte ptr -1Eh
var_1D		= byte ptr -1Dh
var_1C		= byte ptr -1Ch
var_1B		= byte ptr -1Bh
var_1A		= byte ptr -1Ah
var_18		= byte ptr -18h
var_17		= byte ptr -17h
var_16		= byte ptr -16h
var_15		= byte ptr -15h
var_14		= byte ptr -14h
MultiByteStr	= byte ptr -10h
var_F		= byte ptr -0Fh
var_E		= byte ptr -0Eh
var_D		= byte ptr -0Dh
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		lea	eax, [ebp+var_18]
		and	[ebp+var_1A], 0
		mov	[ebp+var_4], eax
		push	esi
		lea	eax, [ebp+var_38]
		push	edi
		push	eax
		lea	eax, [ebp+var_4]
		mov	esi, 208h
		push	5
		push	eax
		mov	[ebp+var_38], 65h
		mov	[ebp+var_37], 42h
		mov	[ebp+var_36], 69h
		mov	[ebp+var_35], 44h
		mov	[ebp+var_34], 6Fh
		mov	[ebp+var_33], 42h
		mov	[ebp+var_32], 74h
		mov	[ebp+var_31], 34h
		mov	[ebp+var_30], 77h
		mov	[ebp+var_2F], 67h
		mov	[ebp+var_2E], 6Ch
		mov	[ebp+var_2D], 67h
		mov	[ebp+var_2C], 4Fh
		mov	[ebp+var_2B], 30h
		mov	[ebp+var_2A], 57h
		mov	[ebp+var_29], 34h
		mov	[ebp+var_28], 43h
		mov	[ebp+var_27], 4Ch
		mov	[ebp+var_26], 58h
		mov	[ebp+var_25], 78h
		mov	[ebp+var_24], 4Fh
		mov	[ebp+var_23], 41h
		mov	[ebp+var_22], 35h
		mov	[ebp+var_21], 43h
		mov	[ebp+var_20], 36h
		mov	[ebp+var_1F], 43h
		mov	[ebp+var_1E], 37h
		mov	[ebp+var_1D], 30h
		mov	[ebp+var_1C], 39h
		mov	[ebp+var_1B], 51h
		mov	[ebp+var_18], 69h
		mov	[ebp+var_17], 2Eh
		mov	[ebp+var_16], 0D0h
		mov	[ebp+var_15], 8Dh
		mov	[ebp+var_14], 0AEh
		mov	[ebp+MultiByteStr], 6Eh
		mov	[ebp+var_F], 2Ah
		mov	[ebp+var_E], 0C1h
		mov	[ebp+var_D], 93h
		mov	[ebp+var_C], 0AEh
		mov	[ebp+var_8], esi
		call	sub_4019A6
		lea	eax, [ebp+MultiByteStr]
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_38]
		push	eax
		lea	eax, [ebp+var_4]
		push	5
		push	eax
		call	sub_4019A6
		push	esi		; Size
		call	_malloc
		mov	edi, eax
		push	esi		; Size
		push	0		; Val
		push	edi		; Dst
		call	_memset
		add	esp, 28h
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+MultiByteStr]
		push	edi
		push	eax		; lpMultiByteStr
		call	sub_401000
		pop	ecx
		push	eax
		lea	eax, [ebp+var_18]
		push	eax		; lpMultiByteStr
		call	sub_401000
		pop	ecx
		push	eax
		push	2
		push	4
		push	6
		push	offset word_40AC7E
		push	offset word_40AC72
		call	sub_401FCF
		add	esp, 24h
		neg	eax
		sbb	eax, eax
		not	eax
		and	eax, edi
		pop	edi
		pop	esi
		leave
		retn
sub_4028F3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402A24(LPCWSTR lpString2, LPWSTR lpString, int)
sub_402A24	proc near		; CODE XREF: sub_403967+2E1p

var_254		= dword	ptr -254h
String2		= word ptr -228h
var_4		= dword	ptr -4
lpString2	= dword	ptr  8
lpString	= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 254h
		lea	eax, [ebp+var_254]
		push	esi
		push	eax
		mov	esi, offset dword_40A898
		push	[ebp+lpString2]
		push	2
		push	offset byte_40AA95
		push	esi
		call	sub_401FCF
		add	esp, 14h
		cmp	eax, 0FFFFFFFFh
		mov	[ebp+var_4], eax
		jz	loc_402B58
		mov	esi, [ebp+arg_8]
		push	ebx
		push	edi
		inc	dword ptr [esi]
		mov	eax, [esi]
		shl	eax, 2
		push	eax		; Size
		call	_malloc
		mov	edi, [ebp+lpString]
		mov	[edi], eax
		mov	ecx, [esi]
		shl	ecx, 2
		push	ecx		; Size
		push	0		; Val
		push	eax		; Dst
		call	_memset
		mov	ebx, 208h
		push	ebx		; Size
		call	_malloc
		push	ebx		; Size
		push	0		; Val
		push	eax		; Dst
		mov	[ebp+lpString],	eax
		call	_memset
		mov	ebx, ds:lstrlenW
		add	esp, 20h

loc_402A9E:				; CODE XREF: sub_402A24+111j
		cmp	[ebp+var_254], 10h
		jnz	short loc_402B15
		push	[ebp+lpString2]	; lpString
		call	ebx ; lstrlenW
		push	eax		; iMaxLength
		push	[ebp+lpString2]	; lpString2
		push	[ebp+lpString]	; lpString1
		call	ds:lstrcpynW
		lea	eax, [ebp+String2]
		push	eax		; lpString2
		push	[ebp+lpString]	; lpString1
		call	ds:lstrcatW
		push	[ebp+lpString]	; lpString
		call	ebx ; lstrlenW
		lea	eax, [eax+eax+2]
		push	eax		; Size
		call	_malloc
		mov	edx, [edi]
		pop	ecx
		mov	ecx, [esi]
		push	[ebp+lpString]	; lpString2
		mov	[edx+ecx*4-4], eax
		mov	eax, [esi]
		mov	ecx, [edi]
		push	dword ptr [ecx+eax*4-4]	; lpString1
		call	ds:lstrcpyW
		inc	dword ptr [esi]
		mov	eax, [esi]
		shl	eax, 2
		push	eax		; NewSize
		push	dword ptr [edi]	; Memory
		call	_realloc
		push	104h		; Size
		push	0		; Val
		push	[ebp+lpString]	; Dst
		mov	[edi], eax
		call	_memset
		add	esp, 14h

loc_402B15:				; CODE XREF: sub_402A24+81j
		lea	eax, [ebp+var_254]
		push	eax
		push	[ebp+var_4]
		push	2
		push	offset byte_40AA87
		push	offset dword_40A898
		call	sub_401FCF
		add	esp, 14h
		test	eax, eax
		jnz	loc_402A9E
		push	[ebp+var_4]
		dec	dword ptr [esi]
		push	1
		push	offset dword_40AA20
		push	offset dword_40A898
		call	sub_401FCF
		add	esp, 10h
		pop	edi
		pop	ebx
		jmp	short loc_402B76
; ---------------------------------------------------------------------------

loc_402B58:				; CODE XREF: sub_402A24+2Fj
		mov	eax, [ebp+lpString]
		push	0FFFFFFFFh
		push	1
		push	offset dword_40AA20
		and	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		push	esi
		and	dword ptr [eax], 0
		call	sub_401FCF
		add	esp, 10h

loc_402B76:				; CODE XREF: sub_402A24+132j
		pop	esi
		leave
		retn
sub_402A24	endp


; =============== S U B	R O U T	I N E =======================================


sub_402B79	proc near		; CODE XREF: sub_403967+21Ep
					; sub_403967+36Ap

arg_0		= dword	ptr  4

		push	esi
		mov	esi, 208h
		push	edi
		push	esi		; Size
		call	_malloc
		mov	edi, eax
		push	esi		; Size
		push	0		; Val
		push	edi		; Dst
		call	_memset
		push	esi
		push	edi
		push	[esp+20h+arg_0]
		push	3
		push	offset dword_40A99C
		push	offset dword_40A898
		call	sub_401FCF
		add	esp, 28h
		test	eax, eax
		jle	short loc_402BB8
		and	word ptr [edi+eax*2], 0
		mov	eax, edi
		jmp	short loc_402BBA
; ---------------------------------------------------------------------------

loc_402BB8:				; CODE XREF: sub_402B79+34j
		xor	eax, eax

loc_402BBA:				; CODE XREF: sub_402B79+3Dj
		pop	edi
		pop	esi
		retn
sub_402B79	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402BBD(int, LPCWSTR lpWideCharStr, int, LPCWSTR lpString)
sub_402BBD	proc near		; CODE XREF: WinMain(x,x,x,x)+2A3p
					; WinMain(x,x,x,x):loc_403362p	...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
lpWideCharStr	= dword	ptr  0Ch
arg_8		= dword	ptr  10h
lpString	= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		lea	eax, [ebp+var_8]
		push	edi
		push	eax
		lea	eax, [ebp+var_4]
		xor	edi, edi
		push	eax
		push	edi
		push	0F013Fh
		push	edi
		push	edi
		push	edi
		push	[ebp+lpWideCharStr] ; lpWideCharStr
		mov	[ebp+var_4], edi
		mov	[ebp+var_8], edi
		call	sub_401057
		pop	ecx
		mov	esi, offset dword_40AB0C
		push	eax
		push	[ebp+arg_0]
		push	9
		push	offset byte_40AB51
		push	esi
		call	sub_401FCF
		add	esp, 30h
		test	eax, eax
		jnz	short loc_402C3B
		push	[ebp+lpString]	; lpString
		call	ds:lstrlenW
		shl	eax, 1
		push	eax
		push	[ebp+lpString]
		push	1
		push	edi
		push	[ebp+arg_8]
		push	[ebp+var_4]
		push	6
		push	offset byte_40AB61
		push	esi
		call	sub_401FCF
		push	[ebp+var_4]
		push	1
		push	offset dword_40AB70
		push	esi
		call	sub_401FCF
		add	esp, 34h

loc_402C3B:				; CODE XREF: sub_402BBD+44j
		pop	edi
		pop	esi
		leave
		retn
sub_402BBD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402C3F(wchar_t *Filename, void *Str, size_t Size, wchar_t *Mode, int)
sub_402C3F	proc near		; CODE XREF: WinMain(x,x,x,x)+3BEp
					; sub_403967+3E8p

Filename	= dword	ptr  8
Str		= dword	ptr  0Ch
Size		= dword	ptr  10h
Mode		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		mov	esi, offset dword_40A898
		push	[ebp+Filename]
		push	1
		push	offset dword_40AA2C
		push	esi
		call	sub_401FCF
		add	esp, 10h
		cmp	eax, 0FFh
		mov	edi, offset byte_40AA3F
		jnz	short loc_402C7D
		push	80h
		push	[ebp+Filename]
		push	2
		push	edi
		push	esi
		call	sub_401FCF
		add	esp, 14h

loc_402C7D:				; CODE XREF: sub_402C3F+28j
		push	[ebp+Mode]	; Mode
		push	[ebp+Filename]	; Filename
		call	__wfopen
		mov	ebx, eax
		pop	ecx
		test	ebx, ebx
		pop	ecx
		jz	short loc_402CC2
		push	ebx		; File
		push	1		; Count
		push	[ebp+Size]	; Size
		push	[ebp+Str]	; Str
		call	_fwrite
		push	ebx		; File
		call	_fclose
		add	esp, 14h
		cmp	[ebp+arg_10], 0
		jz	short loc_402CBF
		push	[ebp+arg_10]
		push	[ebp+Filename]
		push	2
		push	edi
		push	esi
		call	sub_401FCF
		add	esp, 14h

loc_402CBF:				; CODE XREF: sub_402C3F+6Cj
		push	1
		pop	eax

loc_402CC2:				; CODE XREF: sub_402C3F+4Fj
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_402C3F	endp


; =============== S U B	R O U T	I N E =======================================


sub_402CC7	proc near		; CODE XREF: sub_401201+9Fp
					; sub_403967:loc_403CFFp
		push	esi
		mov	esi, 208h
		push	edi
		push	esi		; Size
		call	_malloc
		mov	edi, eax
		push	esi		; Size
		push	0		; Val
		push	edi		; Dst
		call	_memset
		push	edi
		push	esi
		push	2
		push	offset word_40AA52
		push	offset dword_40A898
		call	sub_401FCF
		add	esp, 24h
		push	edi		; lpString
		call	ds:lstrlenW
		cmp	eax, 3
		jnz	short loc_402D06
		and	word ptr [edi+4], 0

loc_402D06:				; CODE XREF: sub_402CC7+38j
		mov	eax, edi
		pop	edi
		pop	esi
		retn
sub_402CC7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402D0B(LPCWSTR Src, int)
sub_402D0B	proc near		; CODE XREF: sub_402F0C+74p

Src		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 1
		jge	short loc_402D18
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_402D18:				; CODE XREF: sub_402D0B+7j
		push	esi
		mov	esi, ds:lstrlenW
		push	edi
		push	[ebp+Src]	; lpString
		call	esi ; lstrlenW
		cmp	[ebp+arg_4], eax
		jle	short loc_402D31
		push	[ebp+Src]	; lpString
		call	esi ; lstrlenW
		jmp	short loc_402D34
; ---------------------------------------------------------------------------

loc_402D31:				; CODE XREF: sub_402D0B+1Dj
		mov	eax, [ebp+arg_4]

loc_402D34:				; CODE XREF: sub_402D0B+24j
		lea	esi, [eax+eax]
		push	esi		; Size
		call	_malloc
		mov	edi, eax
		push	esi		; Size
		push	0		; Val
		push	edi		; Dst
		call	_memset
		push	esi		; Size
		push	[ebp+Src]	; Src
		push	edi		; Dst
		call	_memcpy_0
		add	esp, 1Ch
		and	word ptr [esi+edi], 0
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_402D0B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402D60(LPCWSTR lpString, int)
sub_402D60	proc near		; CODE XREF: sub_402F0C+50p

lpString	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		mov	esi, [ebp+arg_4]
		cmp	esi, 1
		jge	short loc_402D71
		xor	eax, eax
		jmp	short loc_402DBD
; ---------------------------------------------------------------------------

loc_402D71:				; CODE XREF: sub_402D60+Bj
		push	[ebp+lpString]	; lpString
		mov	ebx, ds:lstrlenW
		call	ebx ; lstrlenW
		cmp	esi, eax
		jle	short loc_402D85
		mov	eax, [ebp+lpString]
		jmp	short loc_402DBD
; ---------------------------------------------------------------------------

loc_402D85:				; CODE XREF: sub_402D60+1Ej
		add	esi, esi
		push	edi
		push	esi		; Size
		call	_malloc
		mov	edi, eax
		push	esi		; Size
		push	0		; Val
		push	edi		; Dst
		call	_memset
		add	esp, 10h
		push	esi		; Size
		push	[ebp+lpString]	; lpString
		call	ebx ; lstrlenW
		sub	eax, [ebp+arg_4]
		mov	ecx, [ebp+lpString]
		lea	eax, [ecx+eax*2]
		push	eax		; Src
		push	edi		; Dst
		call	_memcpy_0
		add	esp, 0Ch
		and	word ptr [esi+edi], 0
		mov	eax, edi
		pop	edi

loc_402DBD:				; CODE XREF: sub_402D60+Fj
					; sub_402D60+23j
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_402D60	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402DC1(int, int, void	*Str)
sub_402DC1	proc near		; CODE XREF: sub_4021B0+119p

Buf1		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
Str		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		push	[ebp+Str]	; Str
		call	_strlen
		mov	ebx, eax
		push	ebx		; Size
		call	_malloc
		push	ebx		; Size
		push	0		; Val
		push	eax		; Dst
		mov	[ebp+Buf1], eax
		call	_memset
		mov	esi, [ebp+arg_0]
		add	esp, 14h
		test	esi, esi
		jbe	short loc_402E2B
		mov	edi, [ebp+arg_4]
		dec	esi
		push	edi		; Str
		call	_strlen
		cmp	esi, eax
		pop	ecx
		jnb	short loc_402E2B
		add	edi, esi

loc_402DFF:				; CODE XREF: sub_402DC1+68j
		push	ebx		; Size
		push	edi		; Src
		push	[ebp+Buf1]	; Dst
		call	_memcpy_0
		push	ebx		; Size
		push	[ebp+Str]	; Buf2
		push	[ebp+Buf1]	; Buf1
		call	_memcmp
		add	esp, 18h
		test	eax, eax
		jz	short loc_402E32
		push	[ebp+arg_4]	; Str
		inc	esi
		inc	edi
		call	_strlen
		cmp	esi, eax
		pop	ecx
		jb	short loc_402DFF

loc_402E2B:				; CODE XREF: sub_402DC1+2Bj
					; sub_402DC1+3Aj
		xor	eax, eax

loc_402E2D:				; CODE XREF: sub_402DC1+74j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
; ---------------------------------------------------------------------------

loc_402E32:				; CODE XREF: sub_402DC1+59j
		lea	eax, [esi+1]
		jmp	short loc_402E2D
sub_402DC1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402E37(void *Buf1, int, LPCWSTR Buf2)
sub_402E37	proc near		; CODE XREF: sub_401201+DAp
					; sub_4014E0+3Cp ...

Buf1		= dword	ptr  8
arg_4		= dword	ptr  0Ch
Buf2		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		mov	esi, ds:lstrlenW
		push	edi
		push	[ebp+Buf2]	; lpString
		call	esi ; lstrlenW
		lea	ebx, [eax+eax]
		push	ebx		; Size
		call	_malloc
		push	ebx		; Size
		push	0		; Val
		push	eax		; Dst
		call	_memset
		mov	eax, [ebp+Buf1]
		add	esp, 10h
		test	eax, eax
		jle	short loc_402E9A
		push	[ebp+arg_4]	; lpString
		lea	edi, [eax-1]
		call	esi ; lstrlenW
		cmp	edi, eax
		jge	short loc_402E9A
		mov	eax, [ebp+arg_4]
		lea	eax, [eax+edi*2]
		mov	[ebp+Buf1], eax

loc_402E79:				; CODE XREF: sub_402E37+61j
		push	ebx		; Size
		push	[ebp+Buf2]	; Buf2
		push	[ebp+Buf1]	; Buf1
		call	_memcmp
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_402EA1
		push	[ebp+arg_4]	; lpString
		add	[ebp+Buf1], 2
		inc	edi
		call	esi ; lstrlenW
		cmp	edi, eax
		jl	short loc_402E79

loc_402E9A:				; CODE XREF: sub_402E37+2Bj
					; sub_402E37+37j
		xor	eax, eax

loc_402E9C:				; CODE XREF: sub_402E37+6Dj
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_402EA1:				; CODE XREF: sub_402E37+53j
		lea	eax, [edi+1]
		jmp	short loc_402E9C
sub_402E37	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_402EA6(int, LPCWSTR Buf2, int)
sub_402EA6	proc near		; CODE XREF: sub_402F0C+3Fp
					; sub_402F0C+6Cp

arg_0		= dword	ptr  4
Buf2		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	esi
		mov	esi, ds:lstrlenW
		push	edi
		push	[esp+0Ch+Buf2]	; lpString
		call	esi ; lstrlenW
		lea	edi, [eax+eax]
		push	edi		; Size
		call	_malloc
		push	edi		; Size
		push	0		; Val
		push	eax		; Dst
		call	_memset
		mov	ebx, [esp+1Ch+arg_0]
		add	esp, 10h
		push	ebx		; lpString
		call	esi ; lstrlenW
		mov	ecx, [esp+0Ch+arg_8]
		cmp	ecx, eax
		jle	short loc_402EDF
		push	ebx		; lpString
		call	esi ; lstrlenW
		mov	ecx, eax
		dec	ecx

loc_402EDF:				; CODE XREF: sub_402EA6+31j
		test	ecx, ecx
		mov	esi, ecx
		jbe	short loc_402F01
		lea	ebx, [ebx+ecx*2]

loc_402EE8:				; CODE XREF: sub_402EA6+59j
		push	edi		; Size
		push	[esp+10h+Buf2]	; Buf2
		push	ebx		; Buf1
		call	_memcmp
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_402F07
		dec	esi
		dec	ebx
		dec	ebx
		test	esi, esi
		ja	short loc_402EE8

loc_402F01:				; CODE XREF: sub_402EA6+3Dj
		xor	eax, eax

loc_402F03:				; CODE XREF: sub_402EA6+64j
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_402F07:				; CODE XREF: sub_402EA6+52j
		lea	eax, [esi+1]
		jmp	short loc_402F03
sub_402EA6	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_402F0C(LPCWSTR lpString, int,	int)
sub_402F0C	proc near		; CODE XREF: WinMain(x,x,x,x)+326p
					; WinMain(x,x,x,x)+33Cp ...

lpString	= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	esi
		mov	esi, 208h
		push	edi
		push	esi		; Size
		call	_malloc
		push	esi		; Size
		push	0		; Val
		push	eax		; Dst
		call	_memset
		mov	edi, [esp+1Ch+lpString]
		mov	esi, ds:lstrlenW
		add	esp, 10h
		cmp	[esp+0Ch+arg_4], 0
		push	edi		; lpString
		jz	short loc_402F42
		call	esi ; lstrlenW
		push	eax		; lpString
		push	offset word_40A03C
		jmp	short loc_402F4A
; ---------------------------------------------------------------------------

loc_402F42:				; CODE XREF: sub_402F0C+2Aj
		call	esi ; lstrlenW
		push	eax		; int
		push	offset dword_40A038 ; Buf2

loc_402F4A:				; CODE XREF: sub_402F0C+34j
		push	edi		; int
		call	sub_402EA6
		add	esp, 0Ch
		mov	ebx, eax
		push	edi		; lpString
		call	esi ; lstrlenW
		sub	eax, ebx
		push	eax		; int
		push	edi		; lpString
		call	sub_402D60
		cmp	[esp+14h+arg_8], 0
		pop	ecx
		pop	ecx
		mov	edi, eax
		jnz	short loc_402F6E
		jmp	short loc_402F88
; ---------------------------------------------------------------------------

loc_402F6E:				; CODE XREF: sub_402F0C+5Ej
		push	edi		; lpString
		call	esi ; lstrlenW
		push	eax		; int
		push	offset dword_40A034 ; Buf2
		push	edi		; int
		call	sub_402EA6
		dec	eax
		push	eax		; int
		push	edi		; Src
		call	sub_402D0B
		add	esp, 14h

loc_402F88:				; CODE XREF: sub_402F0C+60j
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_402F0C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402F8C	proc near		; CODE XREF: WinMain(x,x,x,x)+88p

var_10		= byte ptr -10h
var_F		= byte ptr -0Fh
var_E		= byte ptr -0Eh
var_D		= byte ptr -0Dh
var_C		= byte ptr -0Ch
var_B		= byte ptr -0Bh
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	ebx
		lea	eax, [ebp+var_8]
		push	esi
		xor	ebx, ebx
		push	eax
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	220h
		push	20h
		lea	eax, [ebp+var_10]
		push	2
		push	eax
		push	0Bh
		mov	esi, offset dword_40AB0C
		push	offset dword_40AB7C
		push	esi
		mov	[ebp+var_10], bl
		mov	[ebp+var_F], bl
		mov	[ebp+var_E], bl
		mov	[ebp+var_D], bl
		mov	[ebp+var_C], bl
		mov	[ebp+var_B], 5
		call	sub_401FCF
		add	esp, 38h
		cmp	eax, ebx
		mov	[ebp+var_4], eax
		jz	short loc_40300E
		lea	eax, [ebp+var_4]
		push	eax
		push	[ebp+var_8]
		push	ebx
		push	3
		push	offset byte_40AB95
		push	esi
		call	sub_401FCF
		add	esp, 18h
		test	eax, eax
		jnz	short loc_402FFB
		mov	[ebp+var_4], ebx

loc_402FFB:				; CODE XREF: sub_402F8C+6Aj
		push	[ebp+var_8]
		push	1
		push	offset word_40ABAA
		push	esi
		call	sub_401FCF
		add	esp, 10h

loc_40300E:				; CODE XREF: sub_402F8C+4Ej
		mov	eax, [ebp+var_4]
		pop	esi
		pop	ebx
		leave
		retn
sub_402F8C	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
_WinMain@16	proc near		; CODE XREF: start+C9p

hWnd		= dword	ptr -4
hInstance	= dword	ptr  4
hPrevInstance	= dword	ptr  8
lpCmdLine	= dword	ptr  0Ch
nShowCmd	= dword	ptr  10h

		push	ecx
		push	ebp
		push	esi
		mov	esi, ds:GetFocus
		push	edi
		call	esi ; GetFocus
		push	1Eh		; nHeight
		xor	edi, edi
		mov	ebp, eax
		push	1Eh		; nWidth
		push	edi		; hBitmap
		push	ebp		; hWnd
		mov	[esp+20h+hWnd],	ebp
		call	ds:CreateCaret
		push	ebp		; hWnd
		call	ds:ShowCaret
		call	sub_4034DF
		test	eax, eax
		jz	loc_403407
		push	ebx
		call	esi ; GetFocus
		push	edi
		push	offset word_40AD0E
		push	offset byte_40AD01
		call	sub_401FCF
		add	esp, 0Ch
		push	edi		; nNumWindows
		call	ds:BeginDeferWindowPos
		cmp	byte_40B240, 0
		jz	short loc_403091
		push	43h
		push	1
		pop	ebx
		push	ebx
		push	offset byte_40ABE5
		push	offset word_40ABB2
		call	sub_401FCF
		add	esp, 10h
		test	eax, eax
		jnz	loc_4033F3
		jmp	short loc_403094
; ---------------------------------------------------------------------------

loc_403091:				; CODE XREF: WinMain(x,x,x,x)+58j
		push	1
		pop	ebx

loc_403094:				; CODE XREF: WinMain(x,x,x,x)+7Aj
		cmp	byte_40B23F, 0
		jz	short loc_4030AA
		call	sub_402F8C
		test	eax, eax
		jz	loc_4033F3

loc_4030AA:				; CODE XREF: WinMain(x,x,x,x)+86j
		cmp	byte_40B232, 0
		jz	short loc_4030E7
		call	sub_401772
		test	eax, eax
		jnz	loc_4032CA
		call	loc_4017B2
		test	eax, eax
		jnz	loc_4032CA
		call	sub_40166D
		test	eax, eax
		jnz	loc_4032CA
		call	sub_401810
		test	eax, eax
		jnz	loc_4032CA

loc_4030E7:				; CODE XREF: WinMain(x,x,x,x)+9Cj
		cmp	byte_40B231, 0
		jz	short loc_40313E
		call	sub_4013A9
		test	eax, eax
		jnz	loc_4032CA
		call	sub_4014E0
		test	eax, eax
		jnz	loc_4032CA
		call	sub_401546
		test	eax, eax
		jnz	loc_4032CA
		call	sub_4015BB
		test	eax, eax
		jnz	loc_4032CA
		call	sub_40161A
		test	eax, eax
		jnz	loc_4032CA
		call	sub_401201
		test	eax, eax
		jnz	loc_4032CA

loc_40313E:				; CODE XREF: WinMain(x,x,x,x)+D9j
		cmp	byte_40B234, 0
		jz	short loc_40317B
		call	sub_401187
		test	eax, eax
		jnz	loc_4032CA
		call	sub_4010D3
		test	eax, eax
		jnz	loc_4032CA
		call	sub_40119C
		test	eax, eax
		jnz	loc_4032CA
		call	sub_4011C6
		test	eax, eax
		jnz	loc_4032CA

loc_40317B:				; CODE XREF: WinMain(x,x,x,x)+130j
		cmp	byte_40B235, 0
		jz	short loc_403191
		call	sub_4012F1
		test	eax, eax
		jnz	loc_4032CA

loc_403191:				; CODE XREF: WinMain(x,x,x,x)+16Dj
		cmp	byte_40B236, 0
		jz	short loc_4031A7
		call	sub_40134D
		test	eax, eax
		jnz	loc_4032CA

loc_4031A7:				; CODE XREF: WinMain(x,x,x,x)+183j
		push	edi		; lpPoint
		call	ds:GetCursorPos
		cmp	byte_40B230, 0
		jz	short loc_403228
		mov	ax, word_40B22E
		cmp	ax, di
		jbe	short loc_403228
		xor	esi, esi
		cmp	ax, di
		jbe	short loc_403228

loc_4031C9:				; CODE XREF: WinMain(x,x,x,x)+211j
		movzx	eax, si
		imul	eax, 101h
		mov	ecx, dword_40A890
		add	eax, ecx
		movzx	ecx, byte ptr [eax]
		dec	ecx
		jz	short loc_40320E
		dec	ecx
		jz	short loc_403203
		dec	ecx
		jz	short loc_403200
		dec	ecx
		jnz	short loc_40321E
		inc	eax
		push	eax
		push	ebx
		push	offset byte_40A8C1
		push	offset dword_40A898
		call	sub_401FCF
		add	esp, 10h
		jmp	short loc_403216
; ---------------------------------------------------------------------------

loc_403200:				; CODE XREF: WinMain(x,x,x,x)+1CFj
		push	edi
		jmp	short loc_403204
; ---------------------------------------------------------------------------

loc_403203:				; CODE XREF: WinMain(x,x,x,x)+1CCj
		push	ebx

loc_403204:				; CODE XREF: WinMain(x,x,x,x)+1ECj
		inc	eax
		push	eax
		call	sub_402322
		pop	ecx
		jmp	short loc_403215
; ---------------------------------------------------------------------------

loc_40320E:				; CODE XREF: WinMain(x,x,x,x)+1C9j
		inc	eax
		push	eax		; lpString2
		call	sub_40237D

loc_403215:				; CODE XREF: WinMain(x,x,x,x)+1F7j
		pop	ecx

loc_403216:				; CODE XREF: WinMain(x,x,x,x)+1E9j
		test	eax, eax
		jnz	loc_4032CA

loc_40321E:				; CODE XREF: WinMain(x,x,x,x)+1D2j
		inc	esi
		cmp	si, word_40B22E
		jb	short loc_4031C9

loc_403228:				; CODE XREF: WinMain(x,x,x,x)+1A0j
					; WinMain(x,x,x,x)+1ABj ...
		push	ebp		; hWnd
		call	ds:BringWindowToTop
		push	edi
		push	edi

loc_403231:				; CODE XREF: WinMain(x,x,x,x)+31Ej
		movzx	eax, word_40B22C
		push	dword_40B21C
		push	eax
		call	sub_403410
		add	esp, 10h

loc_403247:				; CODE XREF: WinMain(x,x,x,x)+2F9j
					; WinMain(x,x,x,x)+316j
		push	edi
		call	sub_40284F
		pop	ecx
		mov	ebp, eax
		push	edi		; bMenu
		push	edi		; dwStyle
		push	edi		; lpRect
		call	ds:AdjustWindowRect
		movzx	eax, byte_40B244
		mov	esi, ds:lstrcatW
		dec	eax
		jz	loc_40334E
		dec	eax
		jz	loc_403338
		dec	eax
		jnz	loc_40336A
		mov	ebx, 208h
		push	ebx		; Size
		call	_malloc
		mov	edi, eax
		push	ebx		; Size
		push	0		; Val
		push	edi		; Dst
		call	_memset
		add	esp, 10h
		push	offset word_40B03B ; lpString2
		push	edi		; lpString1
		call	esi ; lstrcatW
		push	ebp		; lpString2
		push	edi		; lpString1
		call	esi ; lstrcatW
		push	offset asc_40A050 ; ","
		push	edi		; lpString1
		call	esi ; lstrcatW
		push	edi		; lpString
		push	offset byte_40B07F ; int
		push	offset WideCharStr ; lpWideCharStr
		push	80000002h	; int
		call	sub_402BBD
		add	esp, 10h
		xor	edi, edi
		push	1
		pop	ebx
		jmp	loc_40336A
; ---------------------------------------------------------------------------

loc_4032CA:				; CODE XREF: WinMain(x,x,x,x)+A5j
					; WinMain(x,x,x,x)+B2j	...
		cmp	byte_40B246, 0
		jz	short loc_403307
		movzx	eax, byte_40B247
		movzx	ecx, byte_40B248
		inc	eax
		shl	eax, 4
		add	eax, ecx
		push	eax
		push	offset byte_40B249
		push	offset byte_40B349
		push	edi
		push	4
		push	offset byte_40ABCD
		push	offset word_40ABB2
		call	sub_401FCF
		add	esp, 1Ch

loc_403307:				; CODE XREF: WinMain(x,x,x,x)+2BCj
		cmp	byte_40B241, 0
		jz	loc_403247
		movzx	eax, byte_40B242
		sub	eax, edi
		jz	loc_4033F3
		dec	eax
		jz	loc_403228
		dec	eax
		jnz	loc_403247
		push	ebx
		push	ebx
		jmp	loc_403231
; ---------------------------------------------------------------------------

loc_403338:				; CODE XREF: WinMain(x,x,x,x)+259j
		push	ebx		; int
		push	ebx		; int
		push	ebp		; lpString
		call	sub_402F0C
		push	ebp
		push	eax
		push	offset byte_40AF73
		push	80000002h
		jmp	short loc_403362
; ---------------------------------------------------------------------------

loc_40334E:				; CODE XREF: WinMain(x,x,x,x)+252j
		push	ebx		; int
		push	ebx		; int
		push	ebp		; lpString
		call	sub_402F0C
		push	ebp		; lpString
		push	eax		; int
		push	offset byte_40AF73 ; lpWideCharStr
		push	80000001h	; int

loc_403362:				; CODE XREF: WinMain(x,x,x,x)+337j
		call	sub_402BBD
		add	esp, 1Ch

loc_40336A:				; CODE XREF: WinMain(x,x,x,x)+260j
					; WinMain(x,x,x,x)+2B0j
		cmp	byte_40B23D, 0
		jz	short loc_4033DB
		push	offset word_40B0E1 ; lpString2
		push	24h
		call	sub_402893
		pop	ecx
		push	eax		; lpString1
		call	esi ; lstrcatW
		mov	esi, eax
		mov	al, byte_40B23E
		cmp	al, 1
		jnz	short loc_4033B5
		push	esi
		call	sub_40234B
		test	eax, eax
		pop	ecx
		jz	short loc_4033AD
		push	esi
		push	ebx
		push	offset byte_40AA67
		push	offset dword_40A898
		call	sub_401FCF
		add	esp, 10h

loc_4033AD:				; CODE XREF: WinMain(x,x,x,x)+382j
		push	edi
		push	offset aWb	; "wb"
		jmp	short loc_4033BF
; ---------------------------------------------------------------------------

loc_4033B5:				; CODE XREF: WinMain(x,x,x,x)+377j
		cmp	al, 2
		jnz	short loc_4033DB
		push	edi		; int
		push	offset Mode	; "ab"

loc_4033BF:				; CODE XREF: WinMain(x,x,x,x)+39Ej
		push	lpString	; lpString
		call	ds:lstrlenA
		push	eax		; Size
		push	lpString	; Str
		push	esi		; Filename
		call	sub_402C3F
		add	esp, 14h

loc_4033DB:				; CODE XREF: WinMain(x,x,x,x)+35Cj
					; WinMain(x,x,x,x)+3A2j
		push	[esp+14h+hWnd]	; hWnd
		call	ds:CloseWindow
		cmp	byte_40B243, 0
		jz	short loc_4033F3
		call	sub_401AC8

loc_4033F3:				; CODE XREF: WinMain(x,x,x,x)+74j
					; WinMain(x,x,x,x)+8Fj	...
		push	edi
		push	offset dword_40A96C
		push	offset dword_40A898
		call	sub_401FCF
		add	esp, 0Ch
		pop	ebx

loc_403407:				; CODE XREF: WinMain(x,x,x,x)+2Ej
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		pop	ecx
		retn	10h
_WinMain@16	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403410	proc near		; CODE XREF: WinMain(x,x,x,x)+22Ap

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	ebx
		push	esi
		push	edi
		xor	edi, edi
		mov	ebx, offset byte_40A959
		push	edi
		mov	esi, offset dword_40A898
		push	ebx
		push	esi
		mov	[ebp+var_8], edi
		call	sub_401FCF
		add	esp, 0Ch
		cmp	[ebp+arg_0], edi
		mov	[ebp+var_C], eax
		jbe	loc_4034DA

loc_40343F:				; CODE XREF: sub_403410+C4j
		cmp	[ebp+arg_0], edi
		mov	[ebp+var_4], edi
		jbe	short loc_4034AD
		mov	ecx, [ebp+var_10]
		xor	eax, eax
		sub	ecx, [ebp+var_C]
		mov	[ebp+var_10], ecx
		jmp	short loc_403457
; ---------------------------------------------------------------------------

loc_403454:				; CODE XREF: sub_403410+99j
		mov	ecx, [ebp+var_10]

loc_403457:				; CODE XREF: sub_403410+42j
		imul	eax, 629h
		mov	edx, [ebp+arg_4]
		lea	edi, [eax+edx]
		mov	eax, [eax+edx]
		imul	eax, 3E8h
		cmp	ecx, eax
		jl	short loc_40349F
		cmp	byte ptr [edi+428h], 0
		jnz	short loc_40349F
		cmp	[ebp+arg_8], 0
		jz	short loc_40348E
		cmp	[ebp+arg_C], 0
		jz	short loc_403495
		cmp	byte ptr [edi+427h], 1
		jnz	short loc_403495

loc_40348E:				; CODE XREF: sub_403410+6Dj
		push	edi		; lpString
		call	sub_403967
		pop	ecx

loc_403495:				; CODE XREF: sub_403410+73j
					; sub_403410+7Cj
		inc	[ebp+var_8]
		mov	byte ptr [edi+428h], 1

loc_40349F:				; CODE XREF: sub_403410+5Ej
					; sub_403410+67j
		inc	[ebp+var_4]
		movzx	eax, word ptr [ebp+var_4]
		cmp	eax, [ebp+arg_0]
		jb	short loc_403454
		xor	edi, edi

loc_4034AD:				; CODE XREF: sub_403410+35j
		push	3E8h
		push	1
		push	offset word_40A966
		push	esi
		call	sub_401FCF
		push	edi
		push	ebx
		push	esi
		call	sub_401FCF
		mov	[ebp+var_10], eax
		add	esp, 1Ch
		movzx	eax, word ptr [ebp+var_8]
		cmp	[ebp+arg_0], eax
		ja	loc_40343F

loc_4034DA:				; CODE XREF: sub_403410+29j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_403410	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4034DF	proc near		; CODE XREF: WinMain(x,x,x,x)+27p

var_74		= byte ptr -74h
var_73		= byte ptr -73h
var_72		= byte ptr -72h
var_71		= byte ptr -71h
var_70		= byte ptr -70h
var_6F		= byte ptr -6Fh
var_6E		= byte ptr -6Eh
var_6D		= byte ptr -6Dh
var_6C		= byte ptr -6Ch
var_6B		= byte ptr -6Bh
var_6A		= byte ptr -6Ah
var_69		= byte ptr -69h
var_68		= byte ptr -68h
var_67		= byte ptr -67h
var_66		= byte ptr -66h
var_65		= byte ptr -65h
var_64		= byte ptr -64h
var_63		= byte ptr -63h
var_62		= byte ptr -62h
var_61		= byte ptr -61h
var_60		= byte ptr -60h
var_5F		= byte ptr -5Fh
var_5E		= byte ptr -5Eh
var_5D		= byte ptr -5Dh
var_5C		= byte ptr -5Ch
var_5B		= byte ptr -5Bh
var_5A		= byte ptr -5Ah
var_59		= byte ptr -59h
var_58		= byte ptr -58h
var_57		= byte ptr -57h
var_56		= byte ptr -56h
var_55		= byte ptr -55h
Str		= byte ptr -54h
var_53		= byte ptr -53h
var_52		= byte ptr -52h
var_51		= byte ptr -51h
var_50		= byte ptr -50h
var_4F		= byte ptr -4Fh
var_4E		= byte ptr -4Eh
var_4D		= byte ptr -4Dh
var_4C		= byte ptr -4Ch
var_4B		= byte ptr -4Bh
var_4A		= byte ptr -4Ah
var_49		= byte ptr -49h
var_48		= byte ptr -48h
var_47		= byte ptr -47h
var_46		= byte ptr -46h
var_44		= byte ptr -44h
var_43		= byte ptr -43h
var_42		= byte ptr -42h
var_41		= byte ptr -41h
var_40		= byte ptr -40h
var_3F		= byte ptr -3Fh
var_3E		= byte ptr -3Eh
var_3D		= byte ptr -3Dh
var_3C		= byte ptr -3Ch
var_3B		= byte ptr -3Bh
var_3A		= byte ptr -3Ah
var_39		= byte ptr -39h
var_38		= byte ptr -38h
LibFileName	= byte ptr -34h
var_33		= byte ptr -33h
var_32		= byte ptr -32h
var_31		= byte ptr -31h
var_30		= byte ptr -30h
var_2F		= byte ptr -2Fh
var_2E		= byte ptr -2Eh
var_2D		= byte ptr -2Dh
var_2C		= byte ptr -2Ch
var_2B		= byte ptr -2Bh
var_2A		= byte ptr -2Ah
var_29		= byte ptr -29h
var_28		= byte ptr -28h
var_24		= byte ptr -24h
var_23		= byte ptr -23h
var_22		= byte ptr -22h
var_21		= byte ptr -21h
var_20		= byte ptr -20h
var_1F		= byte ptr -1Fh
var_1E		= byte ptr -1Eh
var_1D		= byte ptr -1Dh
var_1C		= byte ptr -1Ch
var_1B		= byte ptr -1Bh
var_1A		= byte ptr -1Ah
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Memory		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 74h
		push	ebx
		xor	ebx, ebx
		push	esi
		push	edi
		mov	[ebp+var_64], 77h
		mov	[ebp+var_63], 38h
		mov	[ebp+var_62], 45h
		mov	[ebp+var_61], 77h
		mov	[ebp+var_60], 4Ch
		mov	[ebp+var_5F], 65h
		mov	[ebp+var_5E], 61h
		mov	[ebp+var_5D], 46h
		mov	[ebp+var_5C], 41h
		mov	[ebp+var_5B], 4Dh
		mov	[ebp+var_5A], 46h
		mov	[ebp+var_59], 62h
		mov	[ebp+var_58], 49h
		mov	[ebp+var_57], 59h
		mov	[ebp+var_56], 64h
		mov	[ebp+var_55], bl
		mov	[ebp+var_18], ebx
		mov	[ebp+LibFileName], 0ADh
		mov	[ebp+var_33], 16h
		mov	[ebp+var_32], 0F6h
		mov	[ebp+var_31], 25h
		mov	[ebp+var_30], 0DCh
		mov	[ebp+var_2F], 0A9h
		mov	[ebp+var_2E], 3Bh
		mov	[ebp+var_2D], 36h
		mov	[ebp+var_2C], 42h
		mov	[ebp+var_2B], 0DDh
		mov	[ebp+var_2A], 0FEh
		mov	[ebp+var_29], 9Dh
		mov	[ebp+var_28], 0C7h
		mov	[ebp+var_24], 0B3h
		mov	[ebp+var_23], bl
		mov	[ebp+var_22], 0E1h
		mov	[ebp+var_21], 39h
		mov	[ebp+var_20], 8Ah
		mov	[ebp+var_1F], 0F7h
		mov	[ebp+var_1E], 26h
		mov	[ebp+var_1D], 60h
		mov	[ebp+var_1C], bl
		mov	[ebp+var_1B], 0D5h
		mov	[ebp+var_1A], 92h
		mov	[ebp+Str], 81h
		mov	[ebp+var_53], 16h
		mov	[ebp+var_52], 0F0h
		mov	[ebp+var_51], 1Bh
		mov	[ebp+var_50], 0CBh
		mov	[ebp+var_4F], 0AAh
		mov	[ebp+var_4E], 6Bh
		mov	[ebp+var_4D], 45h
		mov	[ebp+var_4C], 8
		mov	[ebp+var_4B], 0DDh
		mov	[ebp+var_4A], 0E0h
		mov	[ebp+var_49], 94h
		mov	[ebp+var_48], 0B4h
		mov	[ebp+var_47], 0B3h
		mov	[ebp+var_46], 0E1h
		mov	[ebp+var_44], 8Ah
		mov	[ebp+var_43], 1Ch
		mov	[ebp+var_42], 0E5h
		mov	[ebp+var_41], 2Fh
		mov	[ebp+var_40], 0F5h
		mov	[ebp+var_3F], 0ACh
		mov	[ebp+var_3E], 6Ah
		mov	[ebp+var_3D], 76h
		mov	[ebp+var_3C], 0Dh
		mov	[ebp+var_3B], 0CBh
		mov	[ebp+var_3A], 0EBh
		mov	[ebp+var_39], 0B0h
		mov	[ebp+var_38], 0C7h
		mov	[ebp+var_74], 85h
		mov	[ebp+var_73], 12h
		mov	[ebp+var_72], 0E8h
		mov	[ebp+var_71], 27h
		mov	[ebp+var_70], 0EEh
		mov	[ebp+var_6F], 0ACh
		mov	[ebp+var_6E], 66h
		mov	[ebp+var_6D], 60h
		push	1
		mov	[ebp+var_6C], 3
		mov	[ebp+var_6B], 0CEh
		mov	[ebp+var_6A], 0C2h
		mov	[ebp+var_69], 83h
		mov	[ebp+var_68], 0A8h
		mov	[ebp+var_67], 0A3h
		mov	[ebp+var_66], 0A0h
		mov	[ebp+var_65], 76h
		mov	esi, 200Dh
		pop	ecx

loc_403642:				; CODE XREF: sub_4034DF+18Cj
		mov	eax, ecx
		mov	edi, 2670h
		cdq
		idiv	edi
		test	edx, edx
		jz	short loc_403654
		xor	esi, ecx
		jmp	short loc_40365D
; ---------------------------------------------------------------------------

loc_403654:				; CODE XREF: sub_4034DF+16Fj
		mov	eax, ecx
		xor	eax, 4BAh
		add	esi, eax

loc_40365D:				; CODE XREF: sub_4034DF+173j
		mov	eax, esi
		cdq
		idiv	ecx
		inc	ecx
		cmp	ecx, 466362Ah
		mov	esi, edx
		jl	short loc_403642
		lea	eax, [ebp+LibFileName]
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_64]
		push	eax
		lea	eax, [ebp+var_4]
		push	0Dh
		push	eax
		call	sub_4019A6
		add	esp, 0Ch
		lea	eax, [ebp+LibFileName]
		push	eax		; lpLibFileName
		call	ds:LoadLibraryA
		mov	esi, eax
		cmp	esi, ebx
		jz	loc_403960
		call	ds:GetFocus
		lea	eax, [ebp+Str]
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_64]
		push	eax
		lea	eax, [ebp+var_4]
		push	0Fh
		push	eax
		call	sub_4019A6
		lea	eax, [ebp+Str]
		push	eax		; Str
		push	esi		; Src
		call	sub_4021B0
		add	esp, 14h
		cmp	eax, ebx
		mov	dword_40B54C, eax
		jz	loc_403960
		push	ebx		; hWnd
		call	ds:SetFocus
		lea	eax, [ebp+var_44]
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_64]
		push	eax
		lea	eax, [ebp+var_4]
		push	0Dh
		push	eax
		call	sub_4019A6
		add	esp, 0Ch
		lea	eax, [ebp+var_44]
		push	eax
		push	esi
		call	dword_40B54C
		mov	dword_40B550, eax
		lea	eax, [ebp+var_24]
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_64]
		push	eax
		lea	eax, [ebp+var_4]
		push	0Bh
		push	eax
		call	sub_4019A6
		lea	eax, [ebp+var_74]
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_64]
		push	eax
		lea	eax, [ebp+var_4]
		push	10h
		push	eax
		call	sub_4019A6
		add	esp, 18h
		lea	eax, [ebp+var_74]
		push	eax
		lea	eax, [ebp+var_24]
		push	eax
		call	dword_40B550
		push	eax
		call	dword_40B54C
		mov	dword_40B554, eax
		lea	eax, [ebp+var_18]
		push	eax
		push	0Ah
		push	7
		call	sub_40247D
		add	esp, 0Ch
		cmp	eax, ebx
		mov	[ebp+Memory], eax
		jz	loc_403960
		cmp	[ebp+var_18], ebx
		jbe	loc_403960
		call	ds:GetCursor
		lea	eax, [ebp+var_64]
		push	eax
		lea	eax, [ebp+Memory]
		push	[ebp+var_18]
		push	eax
		call	sub_4019A6
		mov	edi, 329h
		mov	esi, offset dword_40B220
		push	edi		; Size
		push	ebx		; Val
		push	esi		; Dst
		call	_memset
		push	edi		; Size
		push	[ebp+Memory]	; Src
		push	esi		; Dst
		call	_memcpy
		add	esp, 24h
		cmp	dword_40B220, 31584343h
		jnz	loc_403953
		cmp	dword_40B224, 1
		jnz	loc_403953
		mov	edi, 982h
		mov	esi, offset dword_40A898
		push	edi		; Size
		push	ebx		; Val
		push	esi		; Dst
		call	_memset
		mov	eax, [ebp+Memory]
		push	edi		; Size
		add	eax, 329h
		push	eax		; Src
		push	esi		; Dst
		call	_memcpy
		add	esp, 18h
		cmp	byte_40B230, 1
		mov	[ebp+var_14], 0CABh
		jnz	loc_403884
		mov	ax, word_40B22E
		cmp	ax, bx
		jbe	loc_403884
		movzx	eax, ax
		imul	eax, 101h
		push	eax		; Size
		call	_malloc
		cmp	word_40B22E, bx
		pop	ecx
		mov	dword_40A890, eax
		mov	[ebp+var_8], ebx
		jbe	short loc_403876
		xor	eax, eax
		mov	edi, 101h
		mov	[ebp+var_10], eax
		jmp	short loc_403832
; ---------------------------------------------------------------------------

loc_40382F:				; CODE XREF: sub_4034DF+393j
		mov	eax, [ebp+var_10]

loc_403832:				; CODE XREF: sub_4034DF+34Ej
		mov	ecx, dword_40A890
		lea	esi, [eax+0CABh]
		push	edi		; Size
		add	eax, ecx
		push	ebx		; Val
		push	eax		; Dst
		call	_memset
		mov	eax, [ebp+Memory]
		mov	ecx, [ebp+var_10]
		add	eax, esi
		push	edi		; Size
		push	eax		; Src
		mov	eax, dword_40A890
		add	ecx, eax
		push	ecx		; Dst
		call	_memcpy
		movzx	eax, word_40B22E
		add	[ebp+var_10], edi
		add	esp, 18h
		inc	[ebp+var_8]
		cmp	[ebp+var_8], eax
		jb	short loc_40382F
		jmp	short loc_403879
; ---------------------------------------------------------------------------

loc_403876:				; CODE XREF: sub_4034DF+342j
		mov	esi, [ebp+var_18]

loc_403879:				; CODE XREF: sub_4034DF+395j
		lea	eax, [esi+101h]
		mov	[ebp+var_14], eax
		jmp	short loc_403887
; ---------------------------------------------------------------------------

loc_403884:				; CODE XREF: sub_4034DF+30Ej
					; sub_4034DF+31Dj
		mov	esi, [ebp+var_18]

loc_403887:				; CODE XREF: sub_4034DF+3A3j
		mov	ax, word_40B22C
		cmp	ax, bx
		jbe	short loc_40390D
		movzx	eax, ax
		imul	eax, 629h
		push	eax		; Size
		call	_malloc
		cmp	word_40B22C, bx
		pop	ecx
		mov	dword_40B21C, eax
		mov	[ebp+var_8], ebx
		jbe	short loc_403904
		xor	eax, eax
		mov	edi, 629h
		mov	[ebp+var_10], eax
		jmp	short loc_4038C2
; ---------------------------------------------------------------------------

loc_4038BF:				; CODE XREF: sub_4034DF+423j
		mov	eax, [ebp+var_10]

loc_4038C2:				; CODE XREF: sub_4034DF+3DEj
		mov	ecx, [ebp+var_14]
		push	edi		; Size
		push	ebx		; Val
		lea	esi, [eax+ecx]
		mov	ecx, dword_40B21C
		add	eax, ecx
		push	eax		; Dst
		call	_memset
		mov	eax, [ebp+Memory]
		mov	ecx, [ebp+var_10]
		add	eax, esi
		push	edi		; Size
		push	eax		; Src
		mov	eax, dword_40B21C
		add	ecx, eax
		push	ecx		; Dst
		call	_memcpy
		movzx	eax, word_40B22C
		add	[ebp+var_10], edi
		add	esp, 18h
		inc	[ebp+var_8]
		cmp	[ebp+var_8], eax
		jb	short loc_4038BF

loc_403904:				; CODE XREF: sub_4034DF+3D2j
		add	esi, 629h
		mov	[ebp+var_14], esi

loc_40390D:				; CODE XREF: sub_4034DF+3B1j
		cmp	byte_40B23D, 1
		jnz	short loc_403950
		push	Size		; Size
		call	_malloc
		push	Size		; Size
		mov	lpString, eax
		push	ebx		; Val
		push	eax		; Dst
		call	_memset
		mov	eax, [ebp+Memory]
		mov	ecx, [ebp+var_14]
		push	Size		; Size
		add	ecx, eax
		push	ecx		; Src
		push	lpString	; Dst
		call	_memcpy
		add	esp, 1Ch

loc_403950:				; CODE XREF: sub_4034DF+435j
		push	1
		pop	ebx

loc_403953:				; CODE XREF: sub_4034DF+2C8j
					; sub_4034DF+2D5j
		push	[ebp+Memory]	; Memory
		call	_free
		pop	ecx
		mov	eax, ebx
		jmp	short loc_403962
; ---------------------------------------------------------------------------

loc_403960:				; CODE XREF: sub_4034DF+1B4j
					; sub_4034DF+1E9j ...
		xor	eax, eax

loc_403962:				; CODE XREF: sub_4034DF+47Fj
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_4034DF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403967(LPWSTR	lpString)
sub_403967	proc near		; CODE XREF: sub_403410+7Fp

var_14		= dword	ptr -14h
String		= word ptr -10h
Src		= dword	ptr -0Ch
Size		= dword	ptr -8
Str		= dword	ptr -4
lpString	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		push	ebx
		push	esi
		push	edi
		mov	esi, 208h
		xor	edi, edi
		push	esi		; Size
		mov	[ebp+Size], edi
		mov	[ebp+Str], edi
		mov	[ebp+Src], edi
		mov	[ebp+var_14], edi
		mov	dword ptr [ebp+String],	edi
		call	_malloc
		mov	ebx, eax
		push	esi		; Size
		push	edi		; Val
		push	ebx		; Dst
		call	_memset
		mov	edi, [ebp+lpString]
		mov	esi, ds:lstrcatW
		add	esp, 10h
		cmp	byte ptr [edi+6], 3
		jnz	short loc_403A19
		lea	ecx, [ebp+Size]
		lea	eax, [edi+429h]
		push	ecx
		push	eax		; lpWideCharStr
		call	sub_401057
		pop	ecx
		push	eax
		call	sub_4018A6
		pop	ecx
		mov	[ebp+Str], eax
		pop	ecx
		push	offset word_40A03C ; lpString2
		push	ebx		; lpString1
		call	esi ; lstrcatW
		push	0		; int
		lea	eax, [edi+429h]
		push	0		; int
		push	eax		; lpString
		call	sub_402F0C
		add	esp, 0Ch
		push	eax		; lpString2
		push	ebx		; lpString1
		call	esi ; lstrcatW
		push	200h		; Size
		lea	eax, [edi+429h]
		push	0		; Val
		push	eax		; Dst
		call	_memset
		add	esp, 0Ch
		lea	eax, [edi+429h]
		push	ebx		; lpString2
		push	eax		; lpString1
		call	ds:lstrcpyW
		push	208h		; Size
		push	0		; Val
		push	ebx		; Dst
		call	_memset
		add	esp, 0Ch
		jmp	short loc_403A2F
; ---------------------------------------------------------------------------

loc_403A19:				; CODE XREF: sub_403967+3Fj
		lea	eax, [ebp+Size]
		push	eax
		mov	ax, [edi+4]
		push	0Ah
		push	eax
		call	sub_40247D
		add	esp, 0Ch
		mov	[ebp+Str], eax

loc_403A2F:				; CODE XREF: sub_403967+B0j
		movzx	eax, byte ptr [edi+6]
		dec	eax
		jz	loc_403B2A
		dec	eax
		jz	loc_403B09
		dec	eax
		dec	eax
		jz	short loc_403AB1
		dec	eax
		jnz	loc_403B3D
		lea	eax, [edi+7]
		push	eax
		lea	eax, [ebp+Str]
		push	[ebp+Size]
		push	eax
		call	sub_4019A6
		lea	eax, [ebp+Src]
		push	102h
		push	eax
		lea	eax, [ebp+Size]
		push	[ebp+Str]
		push	eax
		call	sub_40183A
		add	esp, 1Ch
		test	eax, eax
		jz	loc_403B3D
		call	ds:GetFocus

loc_403A82:				; CODE XREF: sub_403967+1BEj
		push	[ebp+Str]	; Memory
		call	_free
		push	[ebp+Size]	; Size
		call	_malloc
		push	[ebp+Size]	; Size
		mov	[ebp+Str], eax
		push	[ebp+Src]	; Src
		push	eax		; Dst
		call	_memcpy
		push	[ebp+Src]	; Memory
		call	_free
		add	esp, 18h
		jmp	loc_403B3D
; ---------------------------------------------------------------------------

loc_403AB1:				; CODE XREF: sub_403967+DCj
		lea	eax, [ebp+Src]
		push	102h
		push	eax
		lea	eax, [ebp+Size]
		push	[ebp+Str]
		push	eax
		call	sub_40183A
		add	esp, 10h
		test	eax, eax
		jz	short loc_403B2A
		push	[ebp+Str]	; Memory
		call	_free
		push	[ebp+Size]	; Size
		call	_malloc
		push	[ebp+Size]	; Size
		mov	[ebp+Str], eax
		push	[ebp+Src]	; Src
		push	eax		; Dst
		call	_memcpy
		lea	eax, [edi+7]
		push	eax
		lea	eax, [ebp+Str]
		push	[ebp+Size]
		push	eax
		call	sub_4019A6
		push	[ebp+Src]	; Memory
		call	_free
		add	esp, 24h
		jmp	short loc_403B3D
; ---------------------------------------------------------------------------

loc_403B09:				; CODE XREF: sub_403967+D4j
		lea	eax, [ebp+Src]
		push	102h
		push	eax
		lea	eax, [ebp+Size]
		push	[ebp+Str]
		push	eax
		call	sub_40183A
		add	esp, 10h
		test	eax, eax
		jz	short loc_403B3D
		jmp	loc_403A82
; ---------------------------------------------------------------------------

loc_403B2A:				; CODE XREF: sub_403967+CDj
					; sub_403967+164j
		lea	eax, [edi+7]
		push	eax
		lea	eax, [ebp+Str]
		push	[ebp+Size]
		push	eax
		call	sub_4019A6
		add	esp, 0Ch

loc_403B3D:				; CODE XREF: sub_403967+DFj
					; sub_403967+10Fj ...
		movzx	eax, byte ptr [edi+20h]
		xor	ecx, ecx
		sub	eax, ecx
		jz	loc_403CB4
		dec	eax
		jnz	loc_403E35
		movzx	eax, byte ptr [edi+21h]
		sub	eax, 8
		jz	loc_403C15
		dec	eax
		jz	short loc_403BC8
		dec	eax
		jz	short loc_403B95
		dec	eax
		jnz	loc_403E35
		cmp	[edi+224h], cl
		jz	loc_403E35
		cmp	[ebp+Str], ecx
		jz	loc_403E35
		lea	eax, [edi+22h]
		push	eax
		call	sub_402B79
		mov	ebx, eax
		push	ebx
		call	sub_40234B
		pop	ecx
		jmp	short loc_403BEB
; ---------------------------------------------------------------------------

loc_403B95:				; CODE XREF: sub_403967+1FCj
		cmp	byte ptr [edi+224h], 0
		jz	loc_403E35
		cmp	[ebp+Str], ecx
		jz	loc_403E35
		movzx	ax, byte ptr [edi+425h]
		push	eax
		add	edi, 225h
		push	[ebp+Str]
		push	edi
		push	ecx
		call	sub_40284F
		pop	ecx
		push	eax
		jmp	short loc_403C08
; ---------------------------------------------------------------------------

loc_403BC8:				; CODE XREF: sub_403967+1F9j
		cmp	byte ptr [edi+224h], 0
		jz	loc_403E35
		cmp	[ebp+Str], ecx
		jz	loc_403E35
		call	sub_4028F3
		mov	ebx, eax
		push	ebx
		call	sub_40234B

loc_403BEB:				; CODE XREF: sub_403967+22Cj
		test	eax, eax
		pop	ecx
		jz	loc_403E35

loc_403BF4:				; CODE XREF: sub_403967+339j
		movzx	ax, byte ptr [edi+425h]
		push	eax		; __int16
		add	edi, 225h
		push	[ebp+Str]	; Src
		push	edi		; int
		push	ebx		; lpString2

loc_403C08:				; CODE XREF: sub_403967+25Fj
		call	sub_401C30

loc_403C0D:				; CODE XREF: sub_403967+493j
		add	esp, 10h
		jmp	loc_403E35
; ---------------------------------------------------------------------------

loc_403C15:				; CODE XREF: sub_403967+1F2j
		cmp	byte ptr [edi+224h], 0
		jz	loc_403E35
		cmp	[ebp+Str], ecx
		jz	loc_403E35
		push	24h
		call	sub_402893
		pop	ecx
		push	eax		; lpString2
		push	ebx		; lpString1
		call	esi ; lstrcatW
		push	offset word_40B091 ; lpString2
		push	ebx		; lpString1
		call	esi ; lstrcatW
		lea	eax, [ebp+var_14]
		push	eax		; int
		lea	eax, [ebp+String]
		push	eax		; lpString
		push	ebx		; lpString2
		call	sub_402A24
		add	esp, 0Ch
		cmp	dword ptr [ebp+String],	0
		jz	loc_403E35
		mov	eax, [ebp+var_14]
		cmp	eax, 0FFFFFFFFh
		jz	loc_403E35
		dec	eax
		cmp	eax, 0FFFFFFFFh
		mov	[ebp+lpString],	eax
		jle	loc_403E35

loc_403C73:				; CODE XREF: sub_403967+346j
		push	208h		; Size
		push	0		; Val
		push	ebx		; Dst
		call	_memset
		mov	eax, dword ptr [ebp+String]
		mov	ecx, [ebp+lpString]
		add	esp, 0Ch
		push	dword ptr [eax+ecx*4] ;	lpString2
		push	ebx		; lpString1
		call	esi ; lstrcatW
		push	offset word_40B0C7 ; lpString2
		push	ebx		; lpString1
		call	esi ; lstrcatW
		push	ebx
		call	sub_40234B
		test	eax, eax
		pop	ecx
		jnz	loc_403BF4
		dec	[ebp+lpString]
		cmp	[ebp+lpString],	0FFFFFFFFh
		jg	short loc_403C73
		jmp	loc_403E35
; ---------------------------------------------------------------------------

loc_403CB4:				; CODE XREF: sub_403967+1DEj
		movzx	eax, byte ptr [edi+21h]
		dec	eax
		jz	short loc_403D25
		dec	eax
		jz	short loc_403D21
		dec	eax
		jz	short loc_403D1D
		dec	eax
		jz	short loc_403D0A
		dec	eax
		jz	short loc_403D06
		dec	eax
		jz	short loc_403CFF
		dec	eax
		jnz	short loc_403D3B
		lea	eax, [edi+22h]
		push	eax
		call	sub_402B79
		pop	ecx
		push	eax		; lpString2
		push	ebx		; lpString1
		call	esi ; lstrcatW
		push	ebx
		call	sub_402364
		test	eax, eax
		pop	ecx
		jnz	short loc_403D31
		push	eax
		push	ebx
		push	eax
		push	3
		push	offset byte_40AC4F
		push	offset byte_40AC05
		call	sub_401FCF
		add	esp, 18h
		jmp	short loc_403D31
; ---------------------------------------------------------------------------

loc_403CFF:				; CODE XREF: sub_403967+361j
		call	sub_402CC7
		jmp	short loc_403D2D
; ---------------------------------------------------------------------------

loc_403D06:				; CODE XREF: sub_403967+35Ej
		push	24h
		jmp	short loc_403D27
; ---------------------------------------------------------------------------

loc_403D0A:				; CODE XREF: sub_403967+35Bj
		push	28h
		call	sub_402893
		pop	ecx
		push	eax		; lpString2
		push	ebx		; lpString1
		call	esi ; lstrcatW
		push	offset byte_40B119
		jmp	short loc_403D2E
; ---------------------------------------------------------------------------

loc_403D1D:				; CODE XREF: sub_403967+358j
		push	25h
		jmp	short loc_403D27
; ---------------------------------------------------------------------------

loc_403D21:				; CODE XREF: sub_403967+355j
		push	26h
		jmp	short loc_403D27
; ---------------------------------------------------------------------------

loc_403D25:				; CODE XREF: sub_403967+352j
		push	1Ah

loc_403D27:				; CODE XREF: sub_403967+3A1j
					; sub_403967+3B8j ...
		call	sub_402893
		pop	ecx

loc_403D2D:				; CODE XREF: sub_403967+39Dj
		push	eax		; lpString2

loc_403D2E:				; CODE XREF: sub_403967+3B4j
		push	ebx		; lpString1
		call	esi ; lstrcatW

loc_403D31:				; CODE XREF: sub_403967+37Dj
					; sub_403967+396j
		lea	eax, [edi+429h]
		push	eax		; lpString2
		push	ebx		; lpString1
		call	esi ; lstrcatW

loc_403D3B:				; CODE XREF: sub_403967+364j
		movzx	eax, byte ptr [edi+222h]
		push	eax		; int
		push	offset aWb	; "wb"
		push	[ebp+Size]	; Size
		push	[ebp+Str]	; Str
		push	ebx		; Filename
		call	sub_402C3F
		add	esp, 14h
		test	eax, eax
		jz	loc_403E35
		push	ebx
		call	sub_40234B
		test	eax, eax
		pop	ecx
		jz	loc_403E35
		cmp	byte ptr [edi+224h], 0
		jz	short loc_403DA0
		movzx	eax, byte ptr [edi+425h]
		push	eax
		xor	eax, eax
		lea	ecx, [edi+225h]
		push	eax
		push	ecx
		push	ebx
		push	eax
		push	eax
		push	6
		push	offset byte_40AC11
		push	offset byte_40AC05
		call	sub_401FCF
		add	esp, 24h

loc_403DA0:				; CODE XREF: sub_403967+40Ej
		movzx	eax, byte ptr [edi+426h]
		dec	eax
		jz	short loc_403E17
		dec	eax
		jz	short loc_403DFF
		dec	eax
		jnz	loc_403E35
		mov	edi, 208h
		push	edi		; Size
		call	_malloc
		push	edi		; Size
		push	0		; Val
		push	eax		; Dst
		mov	[ebp+lpString],	eax
		call	_memset
		mov	edi, [ebp+lpString]
		add	esp, 10h
		push	offset word_40B03B ; lpString2
		push	edi		; lpString1
		call	esi ; lstrcatW
		push	ebx		; lpString2
		push	edi		; lpString1
		call	esi ; lstrcatW
		push	offset asc_40A050 ; ","
		push	edi		; lpString1
		call	esi ; lstrcatW
		push	edi		; lpString
		push	offset byte_40B07F ; int
		push	offset WideCharStr ; lpWideCharStr
		push	80000002h	; int
		call	sub_402BBD
		jmp	loc_403C0D
; ---------------------------------------------------------------------------

loc_403DFF:				; CODE XREF: sub_403967+444j
		push	1		; int
		push	1		; int
		push	ebx		; lpString
		call	sub_402F0C
		push	ebx
		push	eax
		push	offset byte_40AF73
		push	80000002h
		jmp	short loc_403E2D
; ---------------------------------------------------------------------------

loc_403E17:				; CODE XREF: sub_403967+441j
		push	1		; int
		push	1		; int
		push	ebx		; lpString
		call	sub_402F0C
		push	ebx		; lpString
		push	eax		; int
		push	offset byte_40AF73 ; lpWideCharStr
		push	80000001h	; int

loc_403E2D:				; CODE XREF: sub_403967+4AEj
		call	sub_402BBD
		add	esp, 1Ch

loc_403E35:				; CODE XREF: sub_403967+1E5j
					; sub_403967+1FFj ...
		test	ebx, ebx
		jz	short loc_403E40
		push	ebx		; Memory
		call	_free
		pop	ecx

loc_403E40:				; CODE XREF: sub_403967+4D0j
		cmp	[ebp+Str], 0
		pop	edi
		pop	esi
		pop	ebx
		jz	short locret_403E52
		push	[ebp+Str]	; Memory
		call	_free
		pop	ecx

locret_403E52:				; CODE XREF: sub_403967+4E0j
		leave
		retn
sub_403967	endp

; ---------------------------------------------------------------------------
		jmp	ds:MultiByteToWideChar
; ---------------------------------------------------------------------------
		jmp	ds:lstrlenA
; ---------------------------------------------------------------------------
		jmp	ds:WideCharToMultiByte
; ---------------------------------------------------------------------------
		jmp	ds:lstrlenW
; ---------------------------------------------------------------------------
		jmp	ds:lstrcmpiW
; ---------------------------------------------------------------------------
		jmp	ds:lstrcatW
; ---------------------------------------------------------------------------
		jmp	ds:lstrcpyW
; ---------------------------------------------------------------------------
		jmp	ds:lstrcpynW
; ---------------------------------------------------------------------------
		jmp	ds:LoadLibraryA
; ---------------------------------------------------------------------------
		jmp	ds:SetFocus
; ---------------------------------------------------------------------------
		jmp	ds:GetFocus
; ---------------------------------------------------------------------------
		jmp	ds:CloseWindow
; ---------------------------------------------------------------------------
		jmp	ds:AdjustWindowRect
; ---------------------------------------------------------------------------
		jmp	ds:BringWindowToTop
; ---------------------------------------------------------------------------
		jmp	ds:GetCursorPos
; ---------------------------------------------------------------------------
		jmp	ds:BeginDeferWindowPos
; ---------------------------------------------------------------------------
		jmp	ds:ShowCaret
; ---------------------------------------------------------------------------
		jmp	ds:CreateCaret
; ---------------------------------------------------------------------------
		jmp	ds:GetCursor
; [00000012 BYTES: COLLAPSED FUNCTION _malloc. PRESS KEYPAD "+"	TO EXPAND]
; [0000002C BYTES: COLLAPSED FUNCTION __nh_malloc. PRESS KEYPAD	"+" TO EXPAND]
; [00000036 BYTES: COLLAPSED FUNCTION __heap_alloc. PRESS KEYPAD "+" TO	EXPAND]
		align 10h
; [00000058 BYTES: COLLAPSED FUNCTION _memset. PRESS KEYPAD "+"	TO EXPAND]
; [00000020 BYTES: COLLAPSED FUNCTION __global_unwind2.	PRESS KEYPAD "+" TO EXPAND]
; [00000022 BYTES: COLLAPSED FUNCTION __unwind_handler.	PRESS KEYPAD "+" TO EXPAND]
; [00000068 BYTES: COLLAPSED FUNCTION __local_unwind2. PRESS KEYPAD "+"	TO EXPAND]
; [00000023 BYTES: COLLAPSED FUNCTION __abnormal_termination. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------

__NLG_Notify1:
		push	ebx
		push	ecx
		mov	ebx, offset dword_40A060
		jmp	short loc_404078
; [00000018 BYTES: COLLAPSED FUNCTION __NLG_Notify. PRESS KEYPAD "+" TO	EXPAND]
		align 4
		push	esi
		inc	ebx
		xor	dh, [eax]
		pop	eax
		inc	ebx
		xor	[eax], dh
; [000000BD BYTES: COLLAPSED FUNCTION unknown_libname_1. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------

unknown_libname_2:			; Microsoft VisualC 2-10/net runtime
		push	ebp
		mov	ecx, [esp+8]
		mov	ebp, [ecx]
		mov	eax, [ecx+1Ch]
		push	eax
		mov	eax, [ecx+18h]
		push	eax
		call	__local_unwind2
		add	esp, 8
		pop	ebp
		retn	4
; [00000120 BYTES: COLLAPSED FUNCTION _realloc.	PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000335 BYTES: COLLAPSED FUNCTION _memcpy. PRESS KEYPAD "+"	TO EXPAND]
		align 10h
; [0000002F BYTES: COLLAPSED FUNCTION __alloca_probe. PRESS KEYPAD "+" TO EXPAND]
; [00000056 BYTES: COLLAPSED FUNCTION _fclose. PRESS KEYPAD "+"	TO EXPAND]
; [0000010A BYTES: COLLAPSED FUNCTION _fwrite. PRESS KEYPAD "+"	TO EXPAND]
; [00000020 BYTES: COLLAPSED FUNCTION __wfsopen. PRESS KEYPAD "+" TO EXPAND]
; [00000013 BYTES: COLLAPSED FUNCTION __wfopen.	PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000335 BYTES: COLLAPSED FUNCTION _memcpy_0. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [000000AC BYTES: COLLAPSED FUNCTION _memcmp. PRESS KEYPAD "+"	TO EXPAND]
		align 10h
; [0000007B BYTES: COLLAPSED FUNCTION _strlen. PRESS KEYPAD "+"	TO EXPAND]
; [0000002F BYTES: COLLAPSED FUNCTION _free. PRESS KEYPAD "+" TO EXPAND]
; [000000D7 BYTES: COLLAPSED FUNCTION start. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-68h], ecx
		push	eax
		push	ecx
		call	__XcptFilter
		pop	ecx
		pop	ecx
		retn
; ---------------------------------------------------------------------------
		mov	esp, [ebp-18h]
		push	dword ptr [ebp-68h]
		call	__exit
; [00000022 BYTES: COLLAPSED FUNCTION __amsg_exit. PRESS KEYPAD	"+" TO EXPAND]
; ---------------------------------------------------------------------------
		pop	ecx
		pop	ecx
		retn
; [00000023 BYTES: COLLAPSED FUNCTION _fast_error_exit.	PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		mov	ecx, [esp+4]
		mov	eax, dword_40B568
		mov	dword_40B568, ecx
		retn
; ---------------------------------------------------------------------------
		mov	eax, dword_40B568
		retn
; [0000001B BYTES: COLLAPSED FUNCTION __callnewh. PRESS	KEYPAD "+" TO EXPAND]
; [0000003C BYTES: COLLAPSED FUNCTION __heap_init. PRESS KEYPAD	"+" TO EXPAND]
; ---------------------------------------------------------------------------

__heap_term:
		push	ebx
		xor	ebx, ebx
		cmp	dword_40CA88, ebx
		push	ebp
		mov	ebp, ds:HeapFree
		jle	short loc_404E3C
		mov	eax, lpMem
		push	esi
		push	edi
		mov	edi, ds:VirtualFree
		lea	esi, [eax+0Ch]

loc_404E08:				; CODE XREF: .text:00404E38j
		push	4000h
		push	100000h
		push	dword ptr [esi]
		call	edi ; VirtualFree
		push	8000h
		push	0
		push	dword ptr [esi]
		call	edi ; VirtualFree
		push	dword ptr [esi+4]
		push	0
		push	hHeap
		call	ebp ; HeapFree
		add	esi, 14h
		inc	ebx
		cmp	ebx, dword_40CA88
		jl	short loc_404E08
		pop	edi
		pop	esi

loc_404E3C:				; CODE XREF: .text:00404DF6j
		push	lpMem
		push	0
		push	hHeap
		call	ebp ; HeapFree
		push	hHeap
		call	ds:HeapDestroy
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		mov	eax, dword_40A07C
		retn
; [00000017 BYTES: COLLAPSED FUNCTION __set_sbh_threshold. PRESS KEYPAD	"+" TO EXPAND]
; [0000003E BYTES: COLLAPSED FUNCTION ___sbh_heap_init.	PRESS KEYPAD "+" TO EXPAND]
; [0000002B BYTES: COLLAPSED FUNCTION ___sbh_find_block. PRESS KEYPAD "+" TO EXPAND]
; [0000032B BYTES: COLLAPSED FUNCTION ___sbh_free_block. PRESS KEYPAD "+" TO EXPAND]
; [00000309 BYTES: COLLAPSED FUNCTION ___sbh_alloc_block. PRESS	KEYPAD "+" TO EXPAND]
; [000000B1 BYTES: COLLAPSED FUNCTION ___sbh_alloc_new_region. PRESS KEYPAD "+"	TO EXPAND]
; [000000FB BYTES: COLLAPSED FUNCTION ___sbh_alloc_new_group. PRESS KEYPAD "+" TO EXPAND]
; [000002F6 BYTES: COLLAPSED FUNCTION ___sbh_resize_block. PRESS KEYPAD	"+" TO EXPAND]
; ---------------------------------------------------------------------------

___sbh_heapmin:
		mov	eax, Dst
		test	eax, eax
		jz	locret_405A87
		mov	ecx, dword_40CA7C
		push	4000h
		shl	ecx, 0Fh
		add	ecx, [eax+0Ch]
		push	8000h
		push	ecx
		call	ds:VirtualFree
		mov	ecx, dword_40CA7C
		mov	eax, Dst
		mov	edx, 80000000h
		shr	edx, cl
		or	[eax+8], edx
		mov	eax, Dst
		mov	ecx, dword_40CA7C
		mov	eax, [eax+10h]
		and	dword ptr [eax+ecx*4+0C4h], 0
		mov	eax, Dst
		mov	eax, [eax+10h]
		dec	byte ptr [eax+43h]
		mov	eax, Dst
		mov	ecx, [eax+10h]
		cmp	byte ptr [ecx+43h], 0
		jnz	short loc_405A2E
		and	dword ptr [eax+4], 0FFFFFFFEh
		mov	eax, Dst

loc_405A2E:				; CODE XREF: .text:00405A23j
		cmp	dword ptr [eax+8], 0FFFFFFFFh
		jnz	short loc_405A80
		cmp	dword_40CA88, 1
		jle	short loc_405A80
		push	dword ptr [eax+10h]
		push	0
		push	hHeap
		call	ds:HeapFree
		mov	eax, dword_40CA88
		mov	edx, lpMem
		lea	eax, [eax+eax*4]
		shl	eax, 2
		mov	ecx, eax
		mov	eax, Dst
		sub	ecx, eax
		lea	ecx, [ecx+edx-14h]
		push	ecx
		lea	ecx, [eax+14h]
		push	ecx
		push	eax
		call	_memcpy_0
		add	esp, 0Ch
		dec	dword_40CA88

loc_405A80:				; CODE XREF: .text:00405A32j
					; .text:00405A3Bj
		and	Dst, 0

locret_405A87:				; CODE XREF: .text:004059BEj
		retn
; [0000032F BYTES: COLLAPSED FUNCTION ___sbh_heap_check. PRESS KEYPAD "+" TO EXPAND]
; [000000B3 BYTES: COLLAPSED FUNCTION __close. PRESS KEYPAD "+"	TO EXPAND]
; [0000002B BYTES: COLLAPSED FUNCTION __freebuf. PRESS KEYPAD "+" TO EXPAND]
; [0000003B BYTES: COLLAPSED FUNCTION _fflush. PRESS KEYPAD "+"	TO EXPAND]
; [0000005C BYTES: COLLAPSED FUNCTION __flush. PRESS KEYPAD "+"	TO EXPAND]

; =============== S U B	R O U T	I N E =======================================


sub_405F2C	proc near		; CODE XREF: ___endstdiop
		push	1
		call	_flsall
		pop	ecx
		retn
sub_405F2C	endp

; [0000006D BYTES: COLLAPSED FUNCTION _flsall. PRESS KEYPAD "+"	TO EXPAND]
; [00000115 BYTES: COLLAPSED FUNCTION __flsbuf.	PRESS KEYPAD "+" TO EXPAND]
; [000001AD BYTES: COLLAPSED FUNCTION __write. PRESS KEYPAD "+"	TO EXPAND]
; [00000176 BYTES: COLLAPSED FUNCTION __wopenfile. PRESS KEYPAD	"+" TO EXPAND]
; [00000078 BYTES: COLLAPSED FUNCTION __getstream. PRESS KEYPAD	"+" TO EXPAND]
; [0000002D BYTES: COLLAPSED FUNCTION __cinit. PRESS KEYPAD "+"	TO EXPAND]
; [00000011 BYTES: COLLAPSED FUNCTION _exit. PRESS KEYPAD "+" TO EXPAND]
; [00000011 BYTES: COLLAPSED FUNCTION __exit. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------

__cexit:
		push	1
		push	0
		push	0
		call	_doexit
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

__c_exit:
		push	1
		push	1
		push	0
		call	_doexit
		add	esp, 0Ch
		retn
; [00000099 BYTES: COLLAPSED FUNCTION _doexit. PRESS KEYPAD "+"	TO EXPAND]
; [0000001A BYTES: COLLAPSED FUNCTION __initterm. PRESS	KEYPAD "+" TO EXPAND]
; [00000141 BYTES: COLLAPSED FUNCTION __XcptFilter. PRESS KEYPAD "+" TO	EXPAND]
; [00000043 BYTES: COLLAPSED FUNCTION _xcptlookup. PRESS KEYPAD	"+" TO EXPAND]
; [00000058 BYTES: COLLAPSED FUNCTION __wincmdln. PRESS	KEYPAD "+" TO EXPAND]
; [000000B9 BYTES: COLLAPSED FUNCTION __setenvp. PRESS KEYPAD "+" TO EXPAND]
; [00000099 BYTES: COLLAPSED FUNCTION __setargv. PRESS KEYPAD "+" TO EXPAND]
; [000001B4 BYTES: COLLAPSED FUNCTION _parse_cmdline. PRESS KEYPAD "+" TO EXPAND]
; [00000132 BYTES: COLLAPSED FUNCTION ___crtGetEnvironmentStringsA. PRESS KEYPAD "+" TO	EXPAND]
; [000001AB BYTES: COLLAPSED FUNCTION __ioinit.	PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------

__ioterm:
		push	esi
		mov	esi, offset dword_40C960

loc_406D37:				; CODE XREF: .text:00406D50j
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_406D47
		push	eax
		call	_free
		and	dword ptr [esi], 0
		pop	ecx

loc_406D47:				; CODE XREF: .text:00406D3Bj
		add	esi, 4
		cmp	esi, offset uNumber
		jl	short loc_406D37
		pop	esi
		retn
; [00000039 BYTES: COLLAPSED FUNCTION __FF_MSGBANNER. PRESS KEYPAD "+" TO EXPAND]
; [00000153 BYTES: COLLAPSED FUNCTION __NMSG_WRITE. PRESS KEYPAD "+" TO	EXPAND]
; ---------------------------------------------------------------------------

__GET_RTERRMSG:
		mov	ecx, [esp+4]
		xor	edx, edx
		mov	eax, offset dword_40A110

loc_406EEB:				; CODE XREF: .text:00406EF8j
		cmp	ecx, [eax]
		jz	short loc_406EFA
		add	eax, 8
		inc	edx
		cmp	eax, offset dword_40A1A0
		jl	short loc_406EEB

loc_406EFA:				; CODE XREF: .text:00406EEDj
		mov	eax, edx
		shl	eax, 3
		cmp	ecx, dword_40A110[eax]
		jnz	short loc_406F0E
		mov	eax, off_40A114[eax]
		retn
; ---------------------------------------------------------------------------

loc_406F0E:				; CODE XREF: .text:00406F05j
		xor	eax, eax
		retn
; [00000067 BYTES: COLLAPSED FUNCTION __dosmaperr. PRESS KEYPAD	"+" TO EXPAND]
; [00000095 BYTES: COLLAPSED FUNCTION __alloc_osfhnd. PRESS KEYPAD "+" TO EXPAND]
; [00000077 BYTES: COLLAPSED FUNCTION __set_osfhnd. PRESS KEYPAD "+" TO	EXPAND]
; [0000007A BYTES: COLLAPSED FUNCTION __free_osfhnd. PRESS KEYPAD "+" TO EXPAND]
; [0000003D BYTES: COLLAPSED FUNCTION __get_osfhandle. PRESS KEYPAD "+"	TO EXPAND]
; [0000009D BYTES: COLLAPSED FUNCTION __open_osfhandle.	PRESS KEYPAD "+" TO EXPAND]
; [00000057 BYTES: COLLAPSED FUNCTION __commit.	PRESS KEYPAD "+" TO EXPAND]
; [000000A5 BYTES: COLLAPSED FUNCTION ___initstdio. PRESS KEYPAD "+" TO	EXPAND]
; [00000014 BYTES: COLLAPSED FUNCTION ___endstdio. PRESS KEYPAD	"+" TO EXPAND]
; [0000009A BYTES: COLLAPSED FUNCTION __lseek. PRESS KEYPAD "+"	TO EXPAND]
; [00000044 BYTES: COLLAPSED FUNCTION __getbuf.	PRESS KEYPAD "+" TO EXPAND]
; [00000026 BYTES: COLLAPSED FUNCTION __isatty.	PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------
		push	dword ptr [esp+0Ch]
		push	40h
		push	dword ptr [esp+10h]
		push	dword ptr [esp+10h]
		call	__wsopen
		add	esp, 10h
		retn
; [000002BA BYTES: COLLAPSED FUNCTION __wsopen.	PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------
		push	1
		push	0
		push	dword ptr [esp+0Ch]
		call	_x_ismbbtype
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

__ismbbkprint:
		push	3
		push	0
		push	dword ptr [esp+0Ch]
		call	_x_ismbbtype
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

__ismbbkpunct:
		push	2
		push	0
		push	dword ptr [esp+0Ch]
		call	_x_ismbbtype
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

__ismbbalnum:
		push	1
		push	107h
		push	dword ptr [esp+0Ch]
		call	_x_ismbbtype
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

__ismbbalpha:
		push	1
		push	103h
		push	dword ptr [esp+0Ch]
		call	_x_ismbbtype
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

__ismbbgraph:
		push	3
		push	117h
		push	dword ptr [esp+0Ch]
		call	_x_ismbbtype
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

__ismbbprint:
		push	3
		push	157h
		push	dword ptr [esp+0Ch]
		call	_x_ismbbtype
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

__ismbbpunct:
		push	2
		push	10h
		push	dword ptr [esp+0Ch]
		call	_x_ismbbtype
		add	esp, 0Ch
		retn
; [00000011 BYTES: COLLAPSED FUNCTION __ismbblead. PRESS KEYPAD	"+" TO EXPAND]
; ---------------------------------------------------------------------------

__ismbbtrail:
		push	8
		push	0
		push	dword ptr [esp+0Ch]
		call	_x_ismbbtype
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

__ismbbkana:
		cmp	CodePage, 3A4h
		jnz	short loc_407797
		push	3
		push	0
		push	dword ptr [esp+0Ch]
		call	_x_ismbbtype
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_407797
		push	1
		pop	eax
		retn
; ---------------------------------------------------------------------------

loc_407797:				; CODE XREF: .text:0040777Dj
					; .text:00407791j
		xor	eax, eax
		retn
; [00000031 BYTES: COLLAPSED FUNCTION _x_ismbbtype. PRESS KEYPAD "+" TO	EXPAND]
; [00000199 BYTES: COLLAPSED FUNCTION __setmbcp. PRESS KEYPAD "+" TO EXPAND]
; [0000004A BYTES: COLLAPSED FUNCTION _getSystemCP. PRESS KEYPAD "+" TO	EXPAND]
; [00000033 BYTES: COLLAPSED FUNCTION _CPtoLCID. PRESS KEYPAD "+" TO EXPAND]
; [00000029 BYTES: COLLAPSED FUNCTION _setSBCS.	PRESS KEYPAD "+" TO EXPAND]
; [00000185 BYTES: COLLAPSED FUNCTION _setSBUpLow. PRESS KEYPAD	"+" TO EXPAND]
; ---------------------------------------------------------------------------

__getmbcp:
		mov	eax, dword_40B71C
		neg	eax
		sbb	eax, eax
		and	eax, CodePage
		retn
; [0000001C BYTES: COLLAPSED FUNCTION ___initmbctable. PRESS KEYPAD "+"	TO EXPAND]
		align 10h
; [00000007 BYTES: COLLAPSED FUNCTION _strcpy. PRESS KEYPAD "+"	TO EXPAND]
		align 10h
; [000000E0 BYTES: COLLAPSED FUNCTION _strcat. PRESS KEYPAD "+"	TO EXPAND]
; [00000089 BYTES: COLLAPSED FUNCTION ___crtMessageBoxA. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [000000FE BYTES: COLLAPSED FUNCTION _strncpy.	PRESS KEYPAD "+" TO EXPAND]
; [0000007D BYTES: COLLAPSED FUNCTION _calloc. PRESS KEYPAD "+"	TO EXPAND]
; [00000058 BYTES: COLLAPSED FUNCTION __fcloseall. PRESS KEYPAD	"+" TO EXPAND]
; [00000146 BYTES: COLLAPSED FUNCTION __chsize.	PRESS KEYPAD "+" TO EXPAND]
; [000001F6 BYTES: COLLAPSED FUNCTION __read. PRESS KEYPAD "+" TO EXPAND]
; [00000224 BYTES: COLLAPSED FUNCTION ___crtLCMapStringA. PRESS	KEYPAD "+" TO EXPAND]
; [0000002B BYTES: COLLAPSED FUNCTION _strncnt.	PRESS KEYPAD "+" TO EXPAND]
; [00000149 BYTES: COLLAPSED FUNCTION ___crtGetStringTypeA. PRESS KEYPAD "+" TO	EXPAND]
; [00000076 BYTES: COLLAPSED FUNCTION __setmode. PRESS KEYPAD "+" TO EXPAND]
		align 2
		jmp	ds:HeapAlloc
; [00000006 BYTES: COLLAPSED FUNCTION RtlUnwind. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------
		jmp	ds:HeapReAlloc
; ---------------------------------------------------------------------------
		jmp	ds:HeapFree
; ---------------------------------------------------------------------------
		jmp	ds:GetModuleHandleA
; ---------------------------------------------------------------------------
		jmp	ds:GetStartupInfoA
; ---------------------------------------------------------------------------
		jmp	ds:GetCommandLineA
; ---------------------------------------------------------------------------
		jmp	ds:GetVersion
; ---------------------------------------------------------------------------
		jmp	ds:ExitProcess
; ---------------------------------------------------------------------------
		jmp	ds:HeapDestroy
; ---------------------------------------------------------------------------
		jmp	ds:HeapCreate
; ---------------------------------------------------------------------------
		jmp	ds:VirtualFree
; ---------------------------------------------------------------------------
		jmp	ds:VirtualAlloc
; ---------------------------------------------------------------------------
		jmp	ds:IsBadWritePtr
; ---------------------------------------------------------------------------
		jmp	ds:GetLastError
; ---------------------------------------------------------------------------
		jmp	ds:CloseHandle
; ---------------------------------------------------------------------------
		jmp	ds:WriteFile
; ---------------------------------------------------------------------------
		jmp	ds:TerminateProcess
; ---------------------------------------------------------------------------
		jmp	ds:GetCurrentProcess
; ---------------------------------------------------------------------------
		jmp	ds:UnhandledExceptionFilter
; ---------------------------------------------------------------------------
		jmp	ds:GetModuleFileNameA
; ---------------------------------------------------------------------------
		jmp	ds:FreeEnvironmentStringsA
; ---------------------------------------------------------------------------
		jmp	ds:FreeEnvironmentStringsW
; ---------------------------------------------------------------------------
		jmp	ds:GetEnvironmentStrings
; ---------------------------------------------------------------------------
		jmp	ds:GetEnvironmentStringsW
; ---------------------------------------------------------------------------
		jmp	ds:SetHandleCount
; ---------------------------------------------------------------------------
		jmp	ds:GetStdHandle
; ---------------------------------------------------------------------------
		jmp	ds:GetFileType
; ---------------------------------------------------------------------------
		jmp	ds:SetStdHandle
; ---------------------------------------------------------------------------
		jmp	ds:FlushFileBuffers
; ---------------------------------------------------------------------------
		jmp	ds:SetFilePointer
; ---------------------------------------------------------------------------
		jmp	ds:CreateFileW
; ---------------------------------------------------------------------------
		jmp	ds:GetCPInfo
; ---------------------------------------------------------------------------
		jmp	ds:GetACP
; ---------------------------------------------------------------------------
		jmp	ds:GetOEMCP
; ---------------------------------------------------------------------------
		jmp	ds:GetProcAddress
; ---------------------------------------------------------------------------
		jmp	ds:SetEndOfFile
; ---------------------------------------------------------------------------
		jmp	ds:ReadFile
; ---------------------------------------------------------------------------
		jmp	ds:LCMapStringA
; ---------------------------------------------------------------------------
		jmp	ds:LCMapStringW
; ---------------------------------------------------------------------------
		jmp	ds:GetStringTypeA
; ---------------------------------------------------------------------------
		jmp	ds:GetStringTypeW
; ---------------------------------------------------------------------------
		align 1000h
_text		ends

; Section 2. (virtual address 00009000)
; Virtual size			: 000009C6 (   2502.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 00009000
; Flags	40000040: Data Readable
; Alignment	: default
;
; Imports from KERNEL32.dll
;
; ===========================================================================

; Segment type:	Externs
; _idata
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn MultiByteToWideChar:dword	; CODE XREF: sub_401000+23p
					; sub_401000+45p ...
; int __stdcall	lstrlenA(LPCSTR	lpString)
		extrn lstrlenA:dword	; CODE XREF: sub_401000+8p
					; WinMain(x,x,x,x)+3B0p
					; DATA XREF: ...
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword	; CODE XREF: sub_401057+25p
					; sub_401057+48p ...
; int __stdcall	lstrlenW(LPCWSTR lpString)
		extrn lstrlenW:dword	; CODE XREF: sub_401057+8p
					; sub_40166D+90p ...
; int __stdcall	lstrcmpiW(LPCWSTR lpString1, LPCWSTR lpString2)
		extrn lstrcmpiW:dword	; CODE XREF: sub_4015BB+4Ap
					; sub_40161A+3Fp ...
; LPWSTR __stdcall lstrcatW(LPWSTR lpString1, LPCWSTR lpString2)
		extrn lstrcatW:dword	; CODE XREF: sub_401AC8+4Ap
					; sub_401AC8+54p ...
; LPWSTR __stdcall lstrcpyW(LPWSTR lpString1, LPCWSTR lpString2)
		extrn lstrcpyW:dword	; CODE XREF: sub_402A24+C8p
					; sub_403967+9Ap
					; DATA XREF: ...
; LPWSTR __stdcall lstrcpynW(LPWSTR lpString1, LPCWSTR lpString2, int iMaxLength)
		extrn lstrcpynW:dword	; CODE XREF: sub_402A24+8Fp
					; DATA XREF: sub_402A24+8Fr ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: sub_4034DF+1AAp
					; ___crtMessageBoxA+12p
					; DATA XREF: ...
; BOOL __stdcall GetStringTypeA(LCID Locale, DWORD dwInfoType, LPCSTR lpSrcStr,	int cchSrc, LPWORD lpCharType)
		extrn GetStringTypeA:dword ; CODE XREF:	___crtGetStringTypeA+59p
					; ___crtGetStringTypeA+8Dp
					; DATA XREF: ...
; int __stdcall	LCMapStringW(LCID Locale, DWORD	dwMapFlags, LPCWSTR lpSrcStr, int cchSrc, LPWSTR lpDestStr, int	cchDest)
		extrn LCMapStringW:dword ; CODE	XREF: ___crtLCMapStringA+42p
					; ___crtLCMapStringA+14Dp ...
; int __stdcall	LCMapStringA(LCID Locale, DWORD	dwMapFlags, LPCSTR lpSrcStr, int cchSrc, LPSTR lpDestStr, int cchDest)
		extrn LCMapStringA:dword ; CODE	XREF: ___crtLCMapStringA+5Ep
					; ___crtLCMapStringA+A7p
					; DATA XREF: ...
; BOOL __stdcall ReadFile(HANDLE hFile,	LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped)
		extrn ReadFile:dword	; CODE XREF: __read+84p __read+155p
					; DATA XREF: ...
; BOOL __stdcall SetEndOfFile(HANDLE hFile)
		extrn SetEndOfFile:dword ; CODE	XREF: __chsize+F9p
					; DATA XREF: __chsize+F9r ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	___crtMessageBoxA+2Ap
					; ___crtMessageBoxA+3Bp ...
; UINT __stdcall GetOEMCP()
		extrn GetOEMCP:dword	; DATA XREF: _getSystemCP+1Ar
					; .text:0040872Ar
; UINT __stdcall GetACP()
		extrn GetACP:dword	; DATA XREF: _getSystemCP+2Fr
					; .text:00408724r
; BOOL __stdcall GetCPInfo(UINT	CodePage, LPCPINFO lpCPInfo)
		extrn GetCPInfo:dword	; CODE XREF: __setmbcp+48p
					; _setSBUpLow+14p
					; DATA XREF: ...
; HANDLE __stdcall CreateFileW(LPCWSTR lpFileName, DWORD dwDesiredAccess, DWORD	dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile)
		extrn CreateFileW:dword	; CODE XREF: __wsopen+1ACp
					; DATA XREF: __wsopen+1ACr ...
; DWORD	__stdcall SetFilePointer(HANDLE	hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod)
		extrn SetFilePointer:dword ; CODE XREF:	__lseek+4Fp
					; DATA XREF: __lseek+4Fr ...
; LPVOID __stdcall HeapAlloc(HANDLE hHeap, DWORD dwFlags, SIZE_T dwBytes)
		extrn HeapAlloc:dword	; CODE XREF: __heap_alloc+2Ep
					; _realloc+AFp	...
		extrn __imp_RtlUnwind:dword ; DATA XREF: RtlUnwindr
; LPVOID __stdcall HeapReAlloc(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem, SIZE_T dwBytes)
		extrn HeapReAlloc:dword	; CODE XREF: _realloc+F0p
					; ___sbh_alloc_new_region+28p
					; DATA XREF: ...
; BOOL __stdcall HeapFree(HANDLE hHeap,	DWORD dwFlags, LPVOID lpMem)
		extrn HeapFree:dword	; CODE XREF: _free+27p	.text:00404E2Cp ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: start+C2p
					; DATA XREF: start+C2r	...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: start+9Fp
					; __ioinit+59p
					; DATA XREF: ...
; LPSTR	__stdcall GetCommandLineA()
		extrn GetCommandLineA:dword ; CODE XREF: start+74p
					; DATA XREF: start+74r	...
; DWORD	__stdcall GetVersion()
		extrn GetVersion:dword	; CODE XREF: start+26p
					; DATA XREF: start+26r	...
; void __stdcall ExitProcess(UINT uExitCode)
		extrn ExitProcess:dword	; CODE XREF: _fast_error_exit+1Dp
					; _doexit+91p
					; DATA XREF: ...
; BOOL __stdcall HeapDestroy(HANDLE hHeap)
		extrn HeapDestroy:dword	; CODE XREF: __heap_init+2Fp
					; .text:00404E52p
					; DATA XREF: ...
; HANDLE __stdcall HeapCreate(DWORD flOptions, SIZE_T dwInitialSize, SIZE_T dwMaximumSize)
		extrn HeapCreate:dword	; CODE XREF: __heap_init+11p
					; DATA XREF: __heap_init+11r ...
; BOOL __stdcall VirtualFree(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType)
		extrn VirtualFree:dword	; CODE XREF: .text:00404E14p
					; .text:00404E1Fp ...
; LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect)
		extrn VirtualAlloc:dword ; CODE	XREF: ___sbh_alloc_new_region+76p
					; ___sbh_alloc_new_group+51p
					; DATA XREF: ...
; BOOL __stdcall IsBadWritePtr(LPVOID lp, UINT_PTR ucb)
		extrn IsBadWritePtr:dword ; CODE XREF: ___sbh_heap_check+1Ep
					; ___sbh_heap_check+57p ...
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: __close+6Fp
					; __write:loc_4061DCp ...
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: __close+65p __wsopen+1C4p
					; DATA XREF: ...
; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
		extrn WriteFile:dword	; CODE XREF: __write+D8p __write+13Dp	...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: _doexit+17p
					; DATA XREF: _doexit+17r ...
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: _doexit+10p
					; DATA XREF: _doexit+10r ...
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: __XcptFilter+138p
					; DATA XREF: __XcptFilter+138r	...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPCH lpFilename, DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: __setargv+23p
					; __NMSG_WRITE+6Dp
					; DATA XREF: ...
; BOOL __stdcall FreeEnvironmentStringsA(LPCH)
		extrn FreeEnvironmentStringsA:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+11Fp
					; DATA XREF: ___crtGetEnvironmentStringsA+11Fr	...
; BOOL __stdcall FreeEnvironmentStringsW(LPWCH)
		extrn FreeEnvironmentStringsW:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+CEp
					; DATA XREF: ___crtGetEnvironmentStringsA+CEr ...
; LPCH __stdcall GetEnvironmentStrings()
		extrn GetEnvironmentStrings:dword
					; CODE XREF: ___crtGetEnvironmentStringsA:loc_406A83p
					; ___crtGetEnvironmentStringsA+E1p
					; DATA XREF: ...
; LPWCH	__stdcall GetEnvironmentStringsW()
		extrn GetEnvironmentStringsW:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+1Bp
					; ___crtGetEnvironmentStringsA+5Bp
					; DATA XREF: ...
; UINT __stdcall SetHandleCount(UINT uNumber)
		extrn SetHandleCount:dword ; CODE XREF:	__ioinit+19Dp
					; DATA XREF: __ioinit+19Dr ...
; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
		extrn GetStdHandle:dword ; CODE	XREF: __ioinit+158p
					; __NMSG_WRITE+143p
					; DATA XREF: ...
; DWORD	__stdcall GetFileType(HANDLE hFile)
		extrn GetFileType:dword	; CODE XREF: __ioinit+FFp
					; __ioinit+166p ...
; BOOL __stdcall SetStdHandle(DWORD nStdHandle,	HANDLE hHandle)
		extrn SetStdHandle:dword ; CODE	XREF: __set_osfhnd:loc_40705Dp
					; __free_osfhnd:loc_4070D7p
					; DATA XREF: ...
; BOOL __stdcall FlushFileBuffers(HANDLE hFile)
		extrn FlushFileBuffers:dword ; CODE XREF: __commit+2Cp
					; DATA XREF: __commit+2Cr ...
; BOOL __stdcall GetStringTypeW(DWORD dwInfoType, LPCWSTR lpSrcStr, int	cchSrc,	LPWORD lpCharType)
		extrn GetStringTypeW:dword ; CODE XREF:	___crtGetStringTypeA+3Fp
					; ___crtGetStringTypeA+12Dp
					; DATA XREF: ...

;
; Imports from USER32.dll
;
; HCURSOR __stdcall GetCursor()
		extrn GetCursor:dword	; CODE XREF: sub_4034DF+289p
					; DATA XREF: sub_4034DF+289r ...
; BOOL __stdcall CreateCaret(HWND hWnd,	HBITMAP	hBitmap, int nWidth, int nHeight)
		extrn CreateCaret:dword	; CODE XREF: WinMain(x,x,x,x)+1Ap
					; DATA XREF: WinMain(x,x,x,x)+1Ar ...
; BOOL __stdcall ShowCaret(HWND	hWnd)
		extrn ShowCaret:dword	; CODE XREF: WinMain(x,x,x,x)+21p
					; DATA XREF: WinMain(x,x,x,x)+21r ...
; HDWP __stdcall BeginDeferWindowPos(int nNumWindows)
		extrn BeginDeferWindowPos:dword	; CODE XREF: WinMain(x,x,x,x)+4Bp
					; DATA XREF: WinMain(x,x,x,x)+4Br ...
; BOOL __stdcall GetCursorPos(LPPOINT lpPoint)
		extrn GetCursorPos:dword ; CODE	XREF: WinMain(x,x,x,x)+193p
					; DATA XREF: WinMain(x,x,x,x)+193r ...
; BOOL __stdcall BringWindowToTop(HWND hWnd)
		extrn BringWindowToTop:dword ; CODE XREF: WinMain(x,x,x,x)+214p
					; DATA XREF: WinMain(x,x,x,x)+214r ...
; BOOL __stdcall AdjustWindowRect(LPRECT lpRect, DWORD dwStyle,	BOOL bMenu)
		extrn AdjustWindowRect:dword ; CODE XREF: WinMain(x,x,x,x)+23Ep
					; DATA XREF: WinMain(x,x,x,x)+23Er ...
; BOOL __stdcall CloseWindow(HWND hWnd)
		extrn CloseWindow:dword	; CODE XREF: WinMain(x,x,x,x)+3CAp
					; DATA XREF: WinMain(x,x,x,x)+3CAr ...
; HWND __stdcall GetFocus()
		extrn GetFocus:dword	; CODE XREF: sub_401772+5p
					; sub_401FCF+19Fp ...
; HWND __stdcall SetFocus(HWND hWnd)
		extrn SetFocus:dword	; CODE XREF: sub_401772+34p
					; sub_4021B0+4Cp ...


; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 4090FCh
		align 10h
dword_409100	dd 0FFFFFFFFh, 4017F4h,	4017F8h, 0 ; DATA XREF:	.text:004017B7o
dword_409110	dd 0FFFFFFFFh, 401F6Ah,	401F6Eh, 0 ; DATA XREF:	sub_401C30+5o
dword_409120	dd 0FFFFFFFFh, 402193h,	402197h, 0 ; DATA XREF:	sub_401FCF+5o
dword_409130	dd 0FFFFFFFFh, 404D11h,	404D25h, 746E7572h, 20656D69h ;	DATA XREF: start+5o
		dd 6F727265h, 2072h, 0A0Dh, 534F4C54h, 72652053h, 0D726F72h
		dd 0Ah,	474E4953h, 72726520h, 0A0D726Fh, 0
aDomainError	db 'DOMAIN error',0Dh,0Ah,0
		align 10h
aR6028UnableToI	db 'R6028',0Dh,0Ah
		db '- unable to initialize heap',0Dh,0Ah,0
		align 4
aR6027NotEnough	db 'R6027',0Dh,0Ah
		db '- not enough space for lowio initialization',0Dh,0Ah,0
		align 10h
aR6026NotEnough	db 'R6026',0Dh,0Ah
		db '- not enough space for stdio initialization',0Dh,0Ah,0
		align 4
aR6025PureVirtu	db 'R6025',0Dh,0Ah
		db '- pure virtual function call',0Dh,0Ah,0
		align 10h
aR6024NotEnough	db 'R6024',0Dh,0Ah
		db '- not enough space for _onexit/atexit table',0Dh,0Ah,0
		align 4
aR6019UnableToO	db 'R6019',0Dh,0Ah
		db '- unable to open console device',0Dh,0Ah,0
		align 4
aR6018Unexpecte	db 'R6018',0Dh,0Ah
		db '- unexpected heap error',0Dh,0Ah,0
		align 4
aR6017Unexpecte	db 'R6017',0Dh,0Ah
		db '- unexpected multithread lock error',0Dh,0Ah,0
		align 4
aR6016NotEnough	db 'R6016',0Dh,0Ah
		db '- not enough space for thread data',0Dh,0Ah,0
aAbnormalProgra	db 0Dh,0Ah
		db 'abnormal program termination',0Dh,0Ah,0
		align 4
aR6009NotEnough	db 'R6009',0Dh,0Ah
		db '- not enough space for environment',0Dh,0Ah,0
aR6008NotEnough	db 'R6008',0Dh,0Ah
		db '- not enough space for arguments',0Dh,0Ah,0
		align 10h
aR6002FloatingP	db 'R6002',0Dh,0Ah      ; DATA XREF: .data:off_40A114o
		db '- floating point not loaded',0Dh,0Ah,0
		align 4
aMicrosoftVisua	db 'Microsoft Visual C++ Runtime Library',0 ; DATA XREF: __NMSG_WRITE+119o
		align 10h
; char asc_4093F0[]
asc_4093F0	db 0Ah			; DATA XREF: __NMSG_WRITE+F1o
		db 0Ah,0
		align 4
; char aRuntimeErrorPr[]
aRuntimeErrorPr	db 'Runtime Error!',0Ah ; DATA XREF: __NMSG_WRITE+D3o
		db 0Ah
		db 'Program: ',0
		align 10h
; char a___[]
a___		db '...',0              ; DATA XREF: __NMSG_WRITE+BFo
; char Source[]
Source		db '<program name unknown>',0 ; DATA XREF: __NMSG_WRITE+7Do
		align 4
; char aGetlastactivep[]
aGetlastactivep	db 'GetLastActivePopup',0 ; DATA XREF: ___crtMessageBoxA+3Do
		align 10h
; char aGetactivewindo[]
aGetactivewindo	db 'GetActiveWindow',0  ; DATA XREF: ___crtMessageBoxA+35o
; char ProcName[]
ProcName	db 'MessageBoxA',0      ; DATA XREF: ___crtMessageBoxA+24o
; char LibFileName[]
LibFileName	db 'user32.dll',0       ; DATA XREF: ___crtMessageBoxA+Do
		align 4
; char byte_409468[]
byte_409468	db 4 dup(0)		; DATA XREF: ___crtLCMapStringA+57o
					; ___crtGetStringTypeA+52o
; const	WCHAR SrcStr
SrcStr		dw 0			; DATA XREF: ___crtLCMapStringA+36o
					; ___crtGetStringTypeA+39o
		align 10h
dword_409470	dd 0FFFFFFFFh, 40835Fh,	408363h, 0FFFFFFFFh, 408413h, 408417h
					; DATA XREF: ___crtLCMapStringA+5o
dword_409488	dd 0FFFFFFFFh, 408597h,	40859Bh	; DATA XREF: ___crtGetStringTypeA+5o
__IMPORT_DESCRIPTOR_KERNEL32 dd	rva off_4094D0 ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aKernel32_dll	; DLL Name
		dd rva MultiByteToWideChar ; Import Address Table
__IMPORT_DESCRIPTOR_USER32 dd rva off_4095A0 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aUser32_dll	; DLL Name
		dd rva GetCursor	; Import Address Table
		dd 5 dup(0)
;
; Import names for KERNEL32.dll
;
off_4094D0	dd rva word_4095CC	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_KERNEL32o
		dd rva word_4095E2
		dd rva word_4095EE
		dd rva word_409604
		dd rva word_409610
		dd rva word_40961C
		dd rva word_409628
		dd rva word_409634
		dd rva word_409640
		dd rva word_4099A2
		dd rva word_409992
		dd rva word_409982
		dd rva word_409976
		dd rva word_409966
		dd rva word_409954
		dd rva word_409948
		dd rva word_40993E
		dd rva word_409932
		dd rva word_409924
		dd rva word_409912
		dd rva word_409704
		dd rva word_409710
		dd rva word_40971C
		dd rva word_40972A
		dd rva word_409736
		dd rva word_40974A
		dd rva word_40975C
		dd rva word_40976E
		dd rva word_40977C
		dd rva word_40978A
		dd rva word_409798
		dd rva word_4097A6
		dd rva word_4097B4
		dd rva word_4097C4
		dd rva word_4097D4
		dd rva word_4097E4
		dd rva word_4097F2
		dd rva word_4097FE
		dd rva word_409812
		dd rva word_409826
		dd rva word_409842
		dd rva word_409858
		dd rva word_409872
		dd rva word_40988C
		dd rva word_4098A4
		dd rva word_4098BE
		dd rva word_4098D0
		dd rva word_4098E0
		dd rva word_4098EE
		dd rva word_4098FE
		dd rva word_4099B4
		dd 0
;
; Import names for USER32.dll
;
off_4095A0	dd rva word_4096EC	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_USER32o
		dd rva word_4096DE
		dd rva word_4096D2
		dd rva word_4096BC
		dd rva word_4096AC
		dd rva word_409698
		dd rva word_409684
		dd rva word_409676
		dd rva word_40966A
		dd rva word_40965E
		dd 0
word_4095CC	dw 1E4h			; DATA XREF: .rdata:off_4094D0o
		db 'MultiByteToWideChar',0
word_4095E2	dw 308h			; DATA XREF: .rdata:004094D4o
		db 'lstrlenA',0
		align 2
word_4095EE	dw 2D2h			; DATA XREF: .rdata:004094D8o
		db 'WideCharToMultiByte',0
word_409604	dw 309h			; DATA XREF: .rdata:004094DCo
		db 'lstrlenW',0
		align 10h
word_409610	dw 300h			; DATA XREF: .rdata:004094E0o
		db 'lstrcmpiW',0
word_40961C	dw 2FAh			; DATA XREF: .rdata:004094E4o
		db 'lstrcatW',0
		align 4
word_409628	dw 303h			; DATA XREF: .rdata:004094E8o
		db 'lstrcpyW',0
		align 4
word_409634	dw 306h			; DATA XREF: .rdata:004094ECo
		db 'lstrcpynW',0
word_409640	dw 1C2h			; DATA XREF: .rdata:004094F0o
		db 'LoadLibraryA',0
		align 10h
aKernel32_dll	db 'KERNEL32.dll',0     ; DATA XREF: .rdata:004094A0o
		align 2
word_40965E	dw 22Fh			; DATA XREF: .rdata:004095C4o
		db 'SetFocus',0
		align 2
word_40966A	dw 107h			; DATA XREF: .rdata:004095C0o
		db 'GetFocus',0
		align 2
word_409676	dw 3Eh			; DATA XREF: .rdata:004095BCo
		db 'CloseWindow',0
word_409684	dw 1			; DATA XREF: .rdata:004095B8o
		db 'AdjustWindowRect',0
		align 4
word_409698	dw 0Eh			; DATA XREF: .rdata:004095B4o
		db 'BringWindowToTop',0
		align 4
word_4096AC	dw 0FCh			; DATA XREF: .rdata:004095B0o
		db 'GetCursorPos',0
		align 4
word_4096BC	dw 0Bh			; DATA XREF: .rdata:004095ACo
		db 'BeginDeferWindowPos',0
word_4096D2	dw 265h			; DATA XREF: .rdata:004095A8o
		db 'ShowCaret',0
word_4096DE	dw 48h			; DATA XREF: .rdata:004095A4o
		db 'CreateCaret',0
word_4096EC	dw 0F9h			; DATA XREF: .rdata:off_4095A0o
		db 'GetCursor',0
aUser32_dll	db 'USER32.dll',0       ; DATA XREF: .rdata:004094B4o
		align 4
word_409704	dw 199h			; DATA XREF: .rdata:00409520o
		db 'HeapAlloc',0
word_409710	dw 22Fh			; DATA XREF: .rdata:00409524o
		db 'RtlUnwind',0
word_40971C	dw 1A2h			; DATA XREF: .rdata:00409528o
		db 'HeapReAlloc',0
word_40972A	dw 19Fh			; DATA XREF: .rdata:0040952Co
		db 'HeapFree',0
		align 2
word_409736	dw 126h			; DATA XREF: .rdata:00409530o
		db 'GetModuleHandleA',0
		align 2
word_40974A	dw 150h			; DATA XREF: .rdata:00409534o
		db 'GetStartupInfoA',0
word_40975C	dw 0CAh			; DATA XREF: .rdata:00409538o
		db 'GetCommandLineA',0
word_40976E	dw 174h			; DATA XREF: .rdata:0040953Co
		db 'GetVersion',0
		align 4
word_40977C	dw 7Dh			; DATA XREF: .rdata:00409540o
		db 'ExitProcess',0
word_40978A	dw 19Dh			; DATA XREF: .rdata:00409544o
		db 'HeapDestroy',0
word_409798	dw 19Bh			; DATA XREF: .rdata:00409548o
		db 'HeapCreate',0
		align 2
word_4097A6	dw 2BFh			; DATA XREF: .rdata:0040954Co
		db 'VirtualFree',0
word_4097B4	dw 2BBh			; DATA XREF: .rdata:00409550o
		db 'VirtualAlloc',0
		align 4
word_4097C4	dw 1B8h			; DATA XREF: .rdata:00409554o
		db 'IsBadWritePtr',0
word_4097D4	dw 11Ah			; DATA XREF: .rdata:00409558o
		db 'GetLastError',0
		align 4
word_4097E4	dw 1Bh			; DATA XREF: .rdata:0040955Co
		db 'CloseHandle',0
word_4097F2	dw 2DFh			; DATA XREF: .rdata:00409560o
		db 'WriteFile',0
word_4097FE	dw 29Eh			; DATA XREF: .rdata:00409564o
		db 'TerminateProcess',0
		align 2
word_409812	dw 0F7h			; DATA XREF: .rdata:00409568o
		db 'GetCurrentProcess',0
word_409826	dw 2ADh			; DATA XREF: .rdata:0040956Co
		db 'UnhandledExceptionFilter',0
		align 2
word_409842	dw 124h			; DATA XREF: .rdata:00409570o
		db 'GetModuleFileNameA',0
		align 4
word_409858	dw 0B2h			; DATA XREF: .rdata:00409574o
		db 'FreeEnvironmentStringsA',0
word_409872	dw 0B3h			; DATA XREF: .rdata:00409578o
		db 'FreeEnvironmentStringsW',0
word_40988C	dw 106h			; DATA XREF: .rdata:0040957Co
		db 'GetEnvironmentStrings',0
word_4098A4	dw 108h			; DATA XREF: .rdata:00409580o
		db 'GetEnvironmentStringsW',0
		align 2
word_4098BE	dw 26Dh			; DATA XREF: .rdata:00409584o
		db 'SetHandleCount',0
		align 10h
word_4098D0	dw 152h			; DATA XREF: .rdata:00409588o
		db 'GetStdHandle',0
		align 10h
word_4098E0	dw 115h			; DATA XREF: .rdata:0040958Co
		db 'GetFileType',0
word_4098EE	dw 27Ch			; DATA XREF: .rdata:00409590o
		db 'SetStdHandle',0
		align 2
word_4098FE	dw 0AAh			; DATA XREF: .rdata:00409594o
		db 'FlushFileBuffers',0
		align 2
word_409912	dw 26Ah			; DATA XREF: .rdata:0040951Co
		db 'SetFilePointer',0
		align 4
word_409924	dw 37h			; DATA XREF: .rdata:00409518o
		db 'CreateFileW',0
word_409932	dw 0BFh			; DATA XREF: .rdata:00409514o
		db 'GetCPInfo',0
word_40993E	dw 0B9h			; DATA XREF: .rdata:00409510o
		db 'GetACP',0
		align 4
word_409948	dw 131h			; DATA XREF: .rdata:0040950Co
		db 'GetOEMCP',0
		align 4
word_409954	dw 13Eh			; DATA XREF: .rdata:00409508o
		db 'GetProcAddress',0
		align 2
word_409966	dw 261h			; DATA XREF: .rdata:00409504o
		db 'SetEndOfFile',0
		align 2
word_409976	dw 218h			; DATA XREF: .rdata:00409500o
		db 'ReadFile',0
		align 2
word_409982	dw 1BFh			; DATA XREF: .rdata:004094FCo
		db 'LCMapStringA',0
		align 2
word_409992	dw 1C0h			; DATA XREF: .rdata:004094F8o
		db 'LCMapStringW',0
		align 2
word_4099A2	dw 153h			; DATA XREF: .rdata:004094F4o
		db 'GetStringTypeA',0
		align 4
word_4099B4	dw 156h			; DATA XREF: .rdata:00409598o
		db 'GetStringTypeW',0
		align 800h
_rdata		ends

; Section 3. (virtual address 0000A000)
; Virtual size			: 00002A98 (  10904.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 0000A000
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 40A000h
dword_40A000	dd 0			; DATA XREF: __cinit+1Fo
dword_40A004	dd 0			; DATA XREF: __cinit+1Ao
dword_40A008	dd 0			; DATA XREF: __cinit+10o
		dd offset ___initstdio
		dd offset ___initmbctable
dword_40A014	dd 0			; DATA XREF: __cinit:loc_40645Do
dword_40A018	dd 0			; DATA XREF: _doexit+65o
		dd offset ___endstdio
dword_40A020	dd 0			; DATA XREF: _doexit:loc_40651Fo
dword_40A024	dd 0			; DATA XREF: _doexit+76o
dword_40A028	dd 2 dup(0)		; DATA XREF: _doexit:loc_406530o
dword_40A030	dd 30h			; DATA XREF: sub_40166D+73o
; const	WCHAR dword_40A034
dword_40A034	dd 2Eh			; DATA XREF: sub_402F0C+66o
; const	WCHAR dword_40A038
dword_40A038	dd 2Fh			; DATA XREF: sub_402F0C+39o
; const	WCHAR word_40A03C
word_40A03C	dw 5Ch			; DATA XREF: sub_402F0C+2Fo
					; sub_403967+5Do
		align 10h
; wchar_t Mode
Mode:					; DATA XREF: WinMain(x,x,x,x)+3A5o
		unicode	0, <ab>,0
		align 4
; wchar_t aWb
aWb:					; DATA XREF: WinMain(x,x,x,x)+399o
					; sub_403967+3DCo
		unicode	0, <wb>,0
		align 10h
; const	WCHAR asc_40A050
asc_40A050:				; DATA XREF: WinMain(x,x,x,x)+28Bo
					; sub_403967+476o
		unicode	0, <,>,0
		align 10h
dword_40A060	dd 19930520h, 3	dup(0)	; DATA XREF: .text:00404067o
					; __NLG_Notify+2o
off_40A070	dd offset __exit	; DATA XREF: __amsg_exit+1Cr
dword_40A074	dd 2			; DATA XREF: __FF_MSGBANNER+Er
					; __NMSG_WRITE+46r ...
		dd 10h
dword_40A07C	dd 3F8h			; DATA XREF: __heap_alloc+5r
					; _realloc+4Dr	...
dword_40A080	dd 0C0000005h		; DATA XREF: _xcptlookup+Ar
					; _xcptlookup+11o
		dd 0Bh,	0
		dd 0C000001Dh, 4, 0
		dd 0C0000096h, 4, 0
		dd 0C000008Dh, 8, 0
		dd 0C000008Eh, 8, 0
		dd 0C000008Fh, 8, 0
		dd 0C0000090h, 8, 0
		dd 0C0000091h, 8, 0
		dd 0C0000092h, 8, 0
		dd 0C0000093h, 8, 0
dword_40A0F8	dd 3			; DATA XREF: __XcptFilter+58r
dword_40A0FC	dd 7			; DATA XREF: __XcptFilter+5Er
dword_40A100	dd 0Ah			; DATA XREF: _xcptlookup+4r
dword_40A104	dd 8Ch			; DATA XREF: __XcptFilter+82r
					; __XcptFilter+8Fw ...
dword_40A108	dd 0FFFFFFFFh, 0A00h	; DATA XREF: __flsbuf:loc_40605Fo
dword_40A110	dd 2			; DATA XREF: __NMSG_WRITE+Eo
					; __NMSG_WRITE+28r ...
off_40A114	dd offset aR6002FloatingP ; DATA XREF: __NMSG_WRITE+FCr
					; __NMSG_WRITE+12Do ...
					; "R6002\r\n- floating point not loaded\r\n"
		dd 8, 409374h, 9, 409348h, 0Ah,	409324h, 10h, 4092F8h
		dd 11h,	4092C8h, 12h, 4092A4h, 13h, 409278h, 18h, 409240h
		dd 19h,	409218h, 1Ah, 4091E0h, 1Bh, 4091A8h, 1Ch, 409180h
		dd 78h,	409170h, 79h, 409160h, 7Ah, 409150h, 0FCh, 40914Ch
		dd 0FFh, 40913Ch
dword_40A1A0	dd 1			; DATA XREF: __NMSG_WRITE+1Bo
					; .text:00406EF3o ...
dword_40A1A4	dd 16h			; DATA XREF: __dosmaperr:loc_406F46r
		dd 2 dup(2), 3,	2, 4, 18h, 5, 0Dh, 6, 9, 7, 0Ch, 8, 0Ch
		dd 9, 0Ch, 0Ah,	7, 0Bh,	8, 0Ch,	16h, 0Dh, 16h, 0Fh, 2
		dd 10h,	0Dh, 11h, 2 dup(12h), 2, 21h, 0Dh, 35h,	2, 41h
		dd 0Dh,	43h, 2,	50h, 11h, 52h, 0Dh, 53h, 0Dh, 57h, 16h
		dd 59h,	0Bh, 6Ch, 0Dh, 6Dh, 20h, 70h, 1Ch, 72h,	9, 6, 16h
		dd 80h,	0Ah, 81h, 0Ah, 82h, 9, 83h, 16h, 84h, 0Dh, 91h
		dd 29h,	9Eh, 0Dh, 0A1h,	2, 0A4h, 0Bh, 0A7h, 0Dh, 0B7h
		dd 11h,	0CEh, 2, 0D7h, 0Bh, 718h, 0Ch
off_40A308	dd offset dword_40B940	; DATA XREF: __dosmaperr+19o
					; ___initstdio+55o
		align 10h
		dd offset dword_40B940
		dd 101h
dword_40A318	dd 2 dup(0)		; DATA XREF: ___initstdio+72o
		dd 1000h, 0
dword_40A328	dd 3 dup(0)		; DATA XREF: __flsbuf+50o
		dd 2, 1, 3 dup(0)
dword_40A348	dd 3 dup(0)		; DATA XREF: __flsbuf+58o
		dd 2 dup(2), 7 dup(0)
dword_40A378	dd 84h dup(0)		; DATA XREF: ___initstdio+9Bo
byte_40A588	db 1			; DATA XREF: ___initstdio+69o
					; __setmbcp+E1r
		db 2, 4, 8
		align 10h
dword_40A590	dd 3A4h			; DATA XREF: __setmbcp+2Fo
aVyv		db '`y!',0            ; DATA XREF: __setmbcp+11Do
		align 10h
aJ		db '',0               ; DATA XREF: __setmbcp+C0o
		align 8
aBe		db '',0
		align 10h
		dd 0FCE09F81h, 0
		dd 0FC807E40h, 0
		dd 3A8h, 0A3DAA3C1h, 20h, 5 dup(0)
		dd 0FE81h, 0
		dd 0FE40h, 0
		dd 3B5h, 0A3DAA3C1h, 20h, 5 dup(0)
		dd 0FE81h, 0
		dd 0FE41h, 0
		dd 3B6h, 0A2E4A2CFh, 0A2E5001Ah, 5BA2E8h, 4 dup(0)
		dd 0FE81h, 0
		dd 0FEA17E40h, 0
		dd 551h, 0DA5EDA51h, 0DA5F0020h, 32DA6Ah, 4 dup(0)
		dd 0DED8D381h, 0F9E0h, 0FE817E31h, 0
off_40A680	dd offset __ctype+2	; DATA XREF: __setmbcp+3Co
		dd offset __ctype+2
		public __ctype
__ctype		dd    200000h		; DATA XREF: _x_ismbbtype+18r
					; .data:off_40A680o ...
		unicode	0, <	    (((((		   H>
		dd 7 dup(100010h), 840010h, 4 dup(840084h), 100084h, 3 dup(100010h)
		dd 3 dup(810081h), 0Ah dup(10001h), 3 dup(100010h), 3 dup(820082h)
		dd 0Ah dup(20002h), 2 dup(100010h), 20h, 41h dup(0)
dword_40A890	dd 0			; DATA XREF: WinMain(x,x,x,x)+1BDr
					; sub_4034DF+33Aw ...
; LPCSTR lpString
lpString	dd 0			; DATA XREF: WinMain(x,x,x,x):loc_4033BFr
					; WinMain(x,x,x,x)+3B7r ...
dword_40A898	dd 3 dup(0)		; DATA XREF: sub_401187+7o
					; sub_4013A9+128o ...
		db 0
byte_40A8A5	db 3 dup(0)		; DATA XREF: sub_401546+2Co
		dd 6 dup(0)
		db 0
byte_40A8C1	db 3 dup(0)		; DATA XREF: sub_4013A9+123o
					; sub_401546+11o ...
		dd 3 dup(0)
		db 2 dup(0)
word_40A8D2	dw 0			; DATA XREF: sub_401187+2o
		dd 4 dup(0)
dword_40A8E4	dd 3 dup(0)		; DATA XREF: sub_401546+24o
					; sub_401AC8+70o ...
		db 3 dup(0)
byte_40A8F3	db 0			; DATA XREF: sub_401AC8+E1o
					; sub_401C30+1C0o
		dd 4 dup(0)
		db 2 dup(0)
word_40A906	dw 0			; DATA XREF: sub_401546+52o
		dd 4 dup(0)
		db 0
byte_40A919	db 3 dup(0)		; DATA XREF: sub_401AC8+134o
		dd 4 dup(0)
dword_40A92C	dd 3 dup(0)		; DATA XREF: sub_401C30+2E8o
		db 0
byte_40A939	db 3 dup(0)		; DATA XREF: sub_401AC8+D0o
					; sub_401C30+18Co
		dd 7 dup(0)
		db 0
byte_40A959	db 3 dup(0)		; DATA XREF: sub_403410+Bo
		dd 2 dup(0)
		db 2 dup(0)
word_40A966	dw 0			; DATA XREF: sub_401AC8+149o
					; sub_401C30+125o ...
		dd 0
dword_40A96C	dd 3 dup(0)		; DATA XREF: sub_401AC8+155o
					; WinMain(x,x,x,x)+3DFo
dword_40A978	dd 4 dup(0)		; DATA XREF: sub_401C30+37Co
		db 0
byte_40A989	db 3 dup(0)		; DATA XREF: sub_4014E0+1Eo
					; sub_40161A+1Eo ...
		dd 4 dup(0)
dword_40A99C	dd 6 dup(0)		; DATA XREF: sub_402B79+20o
		db 2 dup(0)
word_40A9B6	dw 0			; DATA XREF: sub_401AC8+B3o
		dd 7 dup(0)
		db 2 dup(0)
word_40A9D6	dw 0			; DATA XREF: sub_401546+39o
		dd 4 dup(0)
dword_40A9E8	dd 6 dup(0)		; DATA XREF: sub_40237D+16o
		db 0
byte_40AA01	db 3 dup(0)		; DATA XREF: sub_40237D+2Co
		dd 3 dup(0)
		db 0
byte_40AA11	db 3 dup(0)		; DATA XREF: sub_40237D+7Eo
					; sub_40237D+CAo
		align 10h
dword_40AA20	dd 3 dup(0)		; DATA XREF: sub_401C30+31Co
					; sub_401C30+352o ...
dword_40AA2C	dd 4 dup(0)		; DATA XREF: sub_402C3F+10o
		db 3 dup(0)
byte_40AA3F	db 0			; DATA XREF: sub_402C3F+23o
		dd 4 dup(0)
		db 2 dup(0)
word_40AA52	dw 0			; DATA XREF: sub_402CC7+1Co
		dd 4 dup(0)
		db 3 dup(0)
byte_40AA67	db 0			; DATA XREF: WinMain(x,x,x,x)+386o
		dd 7 dup(0)
		db 3 dup(0)
byte_40AA87	db 0			; DATA XREF: sub_402A24+FDo
		dd 3 dup(0)
		db 0
byte_40AA95	db 3 dup(0)		; DATA XREF: sub_402A24+1Bo
		dd 3 dup(0)
dword_40AAA4	dd 2 dup(0)		; DATA XREF: sub_40183A+3Eo
					; sub_401C30+143o
		db 2 dup(0)
word_40AAAE	dw 0			; DATA XREF: sub_40183A+39o
		dd 4 dup(0)
		db 2 dup(0)
word_40AAC2	dw 0			; DATA XREF: sub_401C30+13Eo
					; sub_401C30+163o
		dd 4 dup(0)
		db 3 dup(0)
byte_40AAD7	db 0			; DATA XREF: sub_401C30+27Bo
		dd 4 dup(0)
		db 2 dup(0)
word_40AAEA	dw 0			; DATA XREF: sub_401C30+2D5o
		dd 8 dup(0)
dword_40AB0C	dd 3 dup(0)		; DATA XREF: sub_4015BB+2Bo
					; sub_40166D+55o ...
		db 0
byte_40AB19	db 3 dup(0)		; DATA XREF: sub_4015BB+26o
		dd 2 dup(0)
		db 2 dup(0)
word_40AB26	dw 0			; DATA XREF: sub_401810+12o
		dd 2 dup(0)
		db 2 dup(0)
word_40AB32	dw 0			; DATA XREF: sub_40166D+5Ao
		align 10h
dword_40AB40	dd 4 dup(0)		; DATA XREF: sub_40166D+7Do
		db 0
byte_40AB51	db 3 dup(0)		; DATA XREF: sub_402BBD+34o
		dd 3 dup(0)
		db 0
byte_40AB61	db 3 dup(0)		; DATA XREF: sub_402BBD+60o
		align 10h
dword_40AB70	dd 3 dup(0)		; DATA XREF: sub_40166D+D8o
					; sub_40166D+F2o ...
dword_40AB7C	dd 6 dup(0)		; DATA XREF: sub_402F8C+28o
		db 0
byte_40AB95	db 3 dup(0)		; DATA XREF: sub_402F8C+5Ao
		dd 4 dup(0)
		db 2 dup(0)
word_40ABAA	dw 0			; DATA XREF: sub_402F8C+74o
		dd 0
		db 2 dup(0)
word_40ABB2	dw 0			; DATA XREF: sub_4010D3+A4o
					; sub_40166D+9Fo ...
		dd 2 dup(0)
		db 0
byte_40ABBD	db 3 dup(0)		; DATA XREF: sub_4010D3+9Fo
		dd 3 dup(0)
		db 0
byte_40ABCD	db 3 dup(0)		; DATA XREF: WinMain(x,x,x,x)+2E0o
		dd 2 dup(0)
		db 0
byte_40ABD9	db 3 dup(0)		; DATA XREF: sub_402322+16o
		dd 2 dup(0)
		db 0
byte_40ABE5	db 3 dup(0)		; DATA XREF: WinMain(x,x,x,x)+60o
		dd 3 dup(0)
		db 2 dup(0)
word_40ABF6	dw 0			; DATA XREF: sub_40166D+9Ao
					; sub_40237D+5Ao
		dd 3 dup(0)
		db 0
byte_40AC05	db 3 dup(0)		; DATA XREF: sub_402893+1Fo
					; sub_403967+389o ...
		dd 2 dup(0)
		db 0
byte_40AC11	db 3 dup(0)		; DATA XREF: sub_403967+427o
		dd 2 dup(0)
		db 3 dup(0)
byte_40AC1F	db 0			; DATA XREF: sub_402893+2Co
		dd 6 dup(0)
		db 2 dup(0)
word_40AC3A	dw 0			; DATA XREF: sub_402893+44o
		dd 4 dup(0)
		db 3 dup(0)
byte_40AC4F	db 0			; DATA XREF: sub_403967+384o
		dd 8 dup(0)
		db 2 dup(0)
word_40AC72	dw 0			; DATA XREF: sub_40234B+Bo
					; sub_402364+Bo ...
		dd 2 dup(0)
		db 2 dup(0)
word_40AC7E	dw 0			; DATA XREF: sub_4028F3+113o
		dd 4 dup(0)
dword_40AC90	dd 4 dup(0)		; DATA XREF: sub_40234B+6o
dword_40ACA0	dd 4 dup(0)		; DATA XREF: sub_402364+6o
		db 0
byte_40ACB1	db 3 dup(0)		; DATA XREF: sub_4018A6+Do
		dd 2 dup(0)
		db 0
byte_40ACBD	db 3 dup(0)		; DATA XREF: sub_4018A6+8Ao
		dd 3 dup(0)
		db 2 dup(0)
word_40ACCE	dw 0			; DATA XREF: sub_4018A6+50o
		dd 3 dup(0)
		db 3 dup(0)
byte_40ACDF	db 0			; DATA XREF: sub_4018A6+1Ao
		dd 3 dup(0)
		db 0
byte_40ACED	db 3 dup(0)		; DATA XREF: sub_4018A6+D4o
		dd 4 dup(0)
		db 0
byte_40AD01	db 3 dup(0)		; DATA XREF: WinMain(x,x,x,x)+3Do
		dd 2 dup(0)
		db 2 dup(0)
word_40AD0E	dw 0			; DATA XREF: WinMain(x,x,x,x)+38o
		dd 4 dup(0)
		db 0
byte_40AD21	db 3 dup(0)		; DATA XREF: sub_4011C6+2o
		dd 3 dup(0)
		db 0
byte_40AD31	db 3 dup(0)		; DATA XREF: sub_4011C6+14o
		dd 3 dup(0)
		db 0
byte_40AD41	db 3 dup(0)		; DATA XREF: sub_4011C6+26o
		dd 7 dup(0)
		db 3 dup(0)
byte_40AD63	db 0			; DATA XREF: sub_4012F1+4o
		dd 5 dup(0)
		db 3 dup(0)
byte_40AD7B	db 0			; DATA XREF: sub_4012F1+25o
		dd 4 dup(0)
		db 0
byte_40AD8D	db 3 dup(0)		; DATA XREF: sub_4012F1+36o
		dd 3 dup(0)
		db 3 dup(0)
byte_40AD9F	db 0			; DATA XREF: sub_4012F1+47o
		dd 0Ah dup(0)
		db 0
byte_40ADC9	db 3 dup(0)		; DATA XREF: sub_40134D+2o
		dd 6 dup(0)
		db 0
byte_40ADE5	db 3 dup(0)		; DATA XREF: sub_40134D+14o
		dd 8 dup(0)
		db 0
byte_40AE09	db 3 dup(0)		; DATA XREF: sub_40134D+26o
		dd 5 dup(0)
		db 3 dup(0)
byte_40AE23	db 0			; DATA XREF: sub_40134D+38o
		dd 6 dup(0)
		db 0
; const	WCHAR byte_40AE3D
byte_40AE3D	db 3 dup(0)		; DATA XREF: sub_40134D+48o
		dd 0Ah dup(0)
		db 0
; const	WCHAR String2
String2		dw 0			; DATA XREF: sub_4015BB+3Fo
		align 4
		dd 5 dup(0)
		db 0
; const	WCHAR word_40AE81
word_40AE81	dw 0			; DATA XREF: sub_40161A+39o
		align 4
		dd 5 dup(0)
		db 0
; const	WCHAR Buf2
Buf2		db 3 dup(0)		; DATA XREF: sub_4014E0+34o
		dd 3 dup(0)
		db 3 dup(0)
; const	WCHAR byte_40AEAB
byte_40AEAB	db 0			; DATA XREF: sub_4014E0+48o
		dd 3 dup(0)
		db 0
byte_40AEB9	db 3 dup(0)		; DATA XREF: sub_40166D+Fo
		dd 2 dup(0)
		db 3 dup(0)
byte_40AEC7	db 0			; DATA XREF: sub_40166D+16o
		dd 2 dup(0)
		db 0
byte_40AED1	db 3 dup(0)		; DATA XREF: sub_40166D+1Do
		dd 3 dup(0)
		db 0
byte_40AEE1	db 3 dup(0)		; DATA XREF: sub_40166D+24o
		dd 0
		db 3 dup(0)
byte_40AEEB	db 0			; DATA XREF: sub_40166D+49o
		dd 13h dup(0)
		db 3 dup(0)
byte_40AF3B	db 0			; DATA XREF: sub_401810+6o
		dd 6 dup(0)
		db 3 dup(0)
; const	WCHAR word_40AF57
word_40AF57	dw 0			; DATA XREF: sub_401AC8+4Co
		align 4
		dd 5 dup(0)
		db 3 dup(0)
; const	WCHAR byte_40AF73
byte_40AF73	db 0			; DATA XREF: WinMain(x,x,x,x)+32Do
					; WinMain(x,x,x,x)+343o ...
		dd 16h dup(0)
		db 3 dup(0)
; const	WCHAR WideCharStr
WideCharStr	db 0			; DATA XREF: WinMain(x,x,x,x)+299o
					; sub_403967+484o
		dd 0Ch dup(0)
		dd 0Eh dup(?)
		db 3 dup(?)
; const	WCHAR word_40B03B
word_40B03B	dw ?			; DATA XREF: WinMain(x,x,x,x)+27Fo
					; sub_403967+46Ao
		align 10h
		dd 0Fh dup(?)
		db 3 dup(?)
byte_40B07F	db ?			; DATA XREF: WinMain(x,x,x,x)+294o
					; sub_403967+47Fo
		dd 4 dup(?)
		db ?
; const	WCHAR word_40B091
word_40B091	dw ?			; DATA XREF: sub_403967+2D0o
		align 4
		dd 0Ch dup(?)
		db 3 dup(?)
; const	WCHAR word_40B0C7
word_40B0C7	dw ?			; DATA XREF: sub_403967+328o
		align 4
		dd 5 dup(?)
		db ?
; const	WCHAR word_40B0E1
word_40B0E1	dw ?			; DATA XREF: WinMain(x,x,x,x)+35Eo
		align 4
		dd 0Dh dup(?)
		db ?
byte_40B119	db 3 dup(?)		; DATA XREF: sub_403967+3AFo
		dd 9 dup(?)
		db 3 dup(?)
byte_40B143	db ?			; DATA XREF: sub_401AC8+EFo
		dd 36h dup(?)
dword_40B21C	dd ?			; DATA XREF: WinMain(x,x,x,x)+223r
					; sub_4034DF+3CAw ...
dword_40B220	dd ?			; DATA XREF: sub_4034DF+2A4o
					; sub_4034DF+2BEr
dword_40B224	dd ?			; DATA XREF: sub_4034DF+2CEr
; size_t Size
Size		dd ?			; DATA XREF: sub_4034DF+437r
					; sub_4034DF+442r ...
word_40B22C	dw ?			; DATA XREF: WinMain(x,x,x,x):loc_403231r
					; sub_4034DF:loc_403887r ...
word_40B22E	dw ?			; DATA XREF: WinMain(x,x,x,x)+1A2r
					; WinMain(x,x,x,x)+20Ar ...
byte_40B230	db ?			; DATA XREF: WinMain(x,x,x,x)+199r
					; sub_4034DF+300r
byte_40B231	db ?			; DATA XREF: WinMain(x,x,x,x):loc_4030E7r
byte_40B232	db ?			; DATA XREF: WinMain(x,x,x,x):loc_4030AAr
		align 4
byte_40B234	db ?			; DATA XREF: WinMain(x,x,x,x):loc_40313Er
byte_40B235	db ?			; DATA XREF: WinMain(x,x,x,x):loc_40317Br
byte_40B236	db ?			; DATA XREF: WinMain(x,x,x,x):loc_403191r
		align 4
		dd ?
		db ?
byte_40B23D	db ?			; DATA XREF: WinMain(x,x,x,x):loc_40336Ar
					; sub_4034DF:loc_40390Dr
byte_40B23E	db ?			; DATA XREF: WinMain(x,x,x,x)+370r
byte_40B23F	db ?			; DATA XREF: WinMain(x,x,x,x):loc_403094r
byte_40B240	db ?			; DATA XREF: WinMain(x,x,x,x)+51r
byte_40B241	db ?			; DATA XREF: WinMain(x,x,x,x):loc_403307r
byte_40B242	db ?			; DATA XREF: WinMain(x,x,x,x)+2FFr
byte_40B243	db ?			; DATA XREF: WinMain(x,x,x,x)+3D0r
byte_40B244	db ?			; DATA XREF: WinMain(x,x,x,x)+244r
		align 2
byte_40B246	db ?			; DATA XREF: WinMain(x,x,x,x):loc_4032CAr
byte_40B247	db ?			; DATA XREF: WinMain(x,x,x,x)+2BEr
byte_40B248	db ?			; DATA XREF: WinMain(x,x,x,x)+2C5r
byte_40B249	db 3 dup(?)		; DATA XREF: WinMain(x,x,x,x)+2D3o
		dd 3Fh dup(?)
		db ?
byte_40B349	db 3 dup(?)		; DATA XREF: WinMain(x,x,x,x)+2D8o
		dd 80h dup(?)
dword_40B54C	dd ?			; DATA XREF: sub_401FCF+48r
					; sub_4034DF+1E4w ...
dword_40B550	dd ?			; DATA XREF: sub_401FCF+36r
					; sub_4034DF+219w ...
dword_40B554	dd ?			; DATA XREF: sub_401FCF+1B6r
					; sub_4034DF+260w
; char *Str
Str		dd ?			; DATA XREF: start+84w
					; __setenvp:loc_406760r ...
		align 10h
dword_40B560	dd ?			; DATA XREF: __amsg_exitr
					; _fast_error_exitr ...
dword_40B564	dd ?			; DATA XREF: _mallocr
					; _realloc:loc_404264r	...
dword_40B568	dd ?			; DATA XREF: .text:00404D7Dr
					; .text:00404D82w ...
dword_40B56C	dd ?			; DATA XREF: __close+A1w __write+111w	...
dword_40B570	dd ?			; DATA XREF: __close:loc_405E51w
					; __write+11Bw	...
dword_40B574	dd ?			; DATA XREF: __wsopen+13Ar
dword_40B578	dd ?			; DATA XREF: start+52w
dword_40B57C	dd ?			; DATA XREF: start+49w
dword_40B580	dd ?			; DATA XREF: start+3Ew
dword_40B584	dd ?			; DATA XREF: start+30w
dword_40B588	dd ?			; DATA XREF: __setargv+91w
dword_40B58C	dd ?			; DATA XREF: __setargv+89w
		dd ?
dword_40B594	dd ?			; DATA XREF: __setenvp+44w
		dd 3 dup(?)
dword_40B5A4	dd ?			; DATA XREF: __setargv+2Ew
		dd ?
byte_40B5AC	db ?			; DATA XREF: _doexit+2Dw
					; ___endstdio+5r
		align 10h
dword_40B5B0	dd ?			; DATA XREF: _doexit+27w
dword_40B5B4	dd ?			; DATA XREF: _doexit+4r _doexit+8Bw
dword_40B5B8	dd ?			; DATA XREF: __XcptFilter+3Ar
					; __XcptFilter+46w ...
; char Filename[260]
Filename	db 104h	dup(?)		; DATA XREF: __setargv:loc_40681Eo
dword_40B6C0	dd ?			; DATA XREF: ___crtGetEnvironmentStringsA+2r
					; ___crtGetEnvironmentStringsA+23w ...
dword_40B6C4	dd ?			; DATA XREF: __FF_MSGBANNER+21r
dword_40B6C8	dd ?			; DATA XREF: __wopenfile+15Bw
					; __getbufw
dword_40B6CC	dd ?			; DATA XREF: __wopenfile+Fr
dword_40B6D0	dd ?			; DATA XREF: __setmbcp:loc_407946r
					; _getSystemCP+4w ...
dword_40B6D4	dd ?			; DATA XREF: ___crtMessageBoxA+3r
					; ___crtMessageBoxA+2Ew ...
dword_40B6D8	dd ?			; DATA XREF: ___crtMessageBoxA+43w
					; ___crtMessageBoxA:loc_407CFFr
dword_40B6DC	dd ?			; DATA XREF: ___crtMessageBoxA+4Aw
					; ___crtMessageBoxA+60r
dword_40B6E0	dd ?			; DATA XREF: __wsopen+3Fr
		dd 2 dup(?)
dword_40B6EC	dd ?			; DATA XREF: ___crtGetStringTypeA+7Br
		dd 3 dup(?)
dword_40B6FC	dd ?			; DATA XREF: _getSystemCP+3Ar
					; ___crtLCMapStringA+C0r ...
		dd ?
dword_40B704	dd ?			; DATA XREF: ___crtLCMapStringA+28r
					; ___crtLCMapStringA+4Cw ...
dword_40B708	dd ?			; DATA XREF: ___crtGetStringTypeA+26r
					; ___crtGetStringTypeA:loc_408508w
; UINT CodePage
CodePage	dd ?			; DATA XREF: .text:__ismbbkanar
					; __setmbcp+14r ...
dword_40B710	dd 3 dup(?)		; DATA XREF: __setmbcp+123o
					; __setmbcp+171o ...
dword_40B71C	dd ?			; DATA XREF: __setmbcp+108w
					; __setmbcp+15Dw ...
byte_40B720	db ?			; DATA XREF: _setSBUpLow:loc_407B16w
					; _setSBUpLow:loc_407B33w ...
		align 4
		dd 3Fh dup(?)
byte_40B820	db ?			; DATA XREF: __setmbcp+5Co
					; __setmbcp+AFo ...
byte_40B821	db ?			; DATA XREF: _parse_cmdline+3Fr
					; _parse_cmdline+84r ...
		align 4
		dd 40h dup(?)
; LCID Locale
Locale		dd ?			; DATA XREF: __setmbcp+6Ew
					; __setmbcp+12Bw ...
dword_40B928	dd ?			; DATA XREF: _flsall:loc_405F46r
					; __getstream+14r ...
		dd 5 dup(?)
dword_40B940	dd 400h	dup(?)		; DATA XREF: .data:off_40A308o
					; .data:0040A310o
; size_t NumOfElements
NumOfElements	dd ?			; DATA XREF: _flsall+9r _flsall+56r ...
		dd 7 dup(?)
dword_40C960	dd ?			; DATA XREF: __flsbuf+B1r
					; __ioinit:loc_406BA6w	...
dword_40C964	dd 3Fh dup(?)		; DATA XREF: __ioinit+92o
; UINT uNumber
uNumber		dd ?			; DATA XREF: __close+8r __write+Dr ...
dword_40CA64	dd ?			; DATA XREF: __setenvp+ADw
dword_40CA68	dd ?			; DATA XREF: __wincmdlnr __setenvp+3r	...
dword_40CA6C	dd ?			; DATA XREF: _doexit+3Er
dword_40CA70	dd ?			; DATA XREF: _doexit+35r _doexit+57r
dword_40CA74	dd ?			; DATA XREF: __cinitr
dword_40CA78	dd ?			; DATA XREF: ___sbh_heap_init+32w
					; ___sbh_alloc_new_region+5r ...
dword_40CA7C	dd ?			; DATA XREF: ___sbh_free_block+239r
					; ___sbh_free_block+259r ...
dword_40CA80	dd ?			; DATA XREF: ___sbh_heap_init+2Dw
					; ___sbh_free_block+310w ...
; void *Dst
Dst		dd ?			; DATA XREF: ___sbh_heap_init:loc_404E95w
					; ___sbh_free_block+22Cr ...
dword_40CA88	dd ?			; DATA XREF: .text:00404DE9r
					; .text:00404E32r ...
; LPVOID lpMem
lpMem		dd ?			; DATA XREF: .text:00404DF8r
					; .text:loc_404E3Cr ...
; HANDLE hHeap
hHeap		dd ?			; DATA XREF: __heap_alloc+28r
					; _realloc+A9r	...
dword_40CA94	dd ?			; DATA XREF: start+7Aw	__wincmdln+Fr ...
		align 800h
_data		ends


		end start
