;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	AC2FFF0BD380E527BB94D547B7D0CA9E
; Input	CRC32 :	210A3C9B

; File Name   :	c:\Users\farhadi\Desktop\dll4\shlwapi.dll
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	BFE50000
; Section 1. (virtual address 00001000)
; Virtual size			: 00004B5E (  19294.)
; Section size in file		: 00004C00 (  19456.)
; Offset to raw	data for section: 00001000
; Flags	60000020: Text Executable Readable
; Alignment	: default

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 0BFE51000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_BFE51000	proc near		; CODE XREF: DllEntryPoint+15p

VersionInformation= _OSVERSIONINFOA ptr	-94h

		push	ebp
		mov	ebp, esp
		sub	esp, 94h
		mov	[ebp+VersionInformation.dwOSVersionInfoSize], 94h
		lea	eax, [ebp+VersionInformation]
		push	eax		; lpVersionInformation
		call	ds:GetVersionExA
		cmp	[ebp+VersionInformation.dwPlatformId], 2
		jnz	short loc_BFE51044
		cmp	[ebp+VersionInformation.dwBuildNumber],	522h
		mov	eax, 1
		mov	dword_BFE58000,	eax
		jnz	short loc_BFE51044
		mov	dword_BFE58004,	eax

loc_BFE51044:				; CODE XREF: sub_BFE51000+27j
					; sub_BFE51000+3Dj
		mov	eax, 1
		mov	esp, ebp
		pop	ebp
		retn	4
sub_BFE51000	endp
